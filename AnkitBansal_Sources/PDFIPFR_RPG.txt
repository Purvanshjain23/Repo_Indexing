     H/TITLE PRT Sales Ton Report   PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Print file
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 01/25/05  Time  : 10:15:49
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State                     Retrieval index       NV
      *
     FPDLWREL3IF  E           K        DISK
      * RSQ : Territory State           State Code
      *
     FOMHSTPLTIF  E           K        DISK
      * RSQ : Sales History             Co/Parent#/AR#/Sls Rt
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FPDLVREL1IF  E           K        DISK
      * RTV : Territory                 Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FCAAJREL1IF  E           K        DISK
      * RTV : Type Codes                Retrieval index       NV
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
     FPDFIPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Sales Ton Report   PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1   6  6   @CN    25
     E                    YK01      100  7  A            Territory/State
      *
     E                    YDOW        7  1               *Days of week
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
     IYD01        DS
     I                                        1   2 YI0101
     I                                        3   70YI01
      *
     IYM01        DS                        100
     I                                        1   2 WABGCD
     I                                        3   8 WAX3CD
      *
     IYW01        DS
     I                                        1   2 XABGCD
     I                                        3   8 XAX3CD
      *
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Parent Customer
     I                                    P   3   60P1BTC7
      * I :  A/R Customer Number
     I                                    P   7  100P1ANC7
      * I :  Ship To Customer
     I                                    P  11  140P1BKC7
      * I :  Sales Route Code
     I                                       15  17 P1R4CD
      * I :  Territory Code
     I                                       18  23 P1X3CD
      * I :  Date - ATR
     I                                    P  24  270P1MUDT
      * I :  Print Yes/No          USR
     I                                       28  28 P1B5SX
      * I :  Sale Type             USR
     I                                       29  29 P1DASX
      * I :  Report Type Both      USR
     I                                       30  30 P1DBSX
     IP2PARM      DS
      * FLD: *Arrays
      * B :  Alpha Zeroes 3        USR
     I                                        1   3 P2NHTX
      * B :  USR Work Field 3A
     I                                        4   6 P2EZTX
      * N :  Record Status
     I                                        7   7 P2VSST
      * N :  Sales Route Code Ref  USR
     I                                        8  10 P2YGCD
      * N :  State Code
     I                                       11  12 P2BGCD
      * N :  Maximum pounds
     I                                    P  13  160P2RSNB
     IP3PARM      DS
      * N :  Record Selected       USR
     I                                        1   1 P3ZZST
     IP4PARM      DS
      * N :  Type Code
     I                                        1   2 P4BOCD
     IP5PARM      DS
      * FLD: *Arrays
      * N :  Current Year  USR
     I                                    P   1   30P5I0NX
      * N :  Current Month USR
     I                                    P   4   50P5I1NX
      * N :  This Year (YYYY) USR
     I                                        6   90P5I3NX
      * N :  Last Year (YYYY) USR
     I                                       10  130P5I2NX
      * N :  This Month  (MM) USR
     I                                    P  14  150P5I4NX
      * N :  Actual Shipped Month USR
     I                                    P  16  170P5I5NX
      * N :  Actual Shipped Day USR
     I                                    P  18  190P5I7NX
      * N :  Actual Shipped Year USR
     I                                    P  20  220P5I6NX
      * N :  Year Alpha (YYYY) USR
     I                                       23  26 P5T9TX
      * N :  Year Alpha (YY) USR
     I                                       27  28 P5UATX
      * N :  Year  NBR USR
     I                                       29  300P5I8NX
      * N :  Month NBR USR
     I                                       31  320P5I9NX
      * N :  TXT Year Number       USR
     I                                       33  34 P5OPTX
      * N :  TXT Month Number      USR
     I                                       35  36 P5ONTX
      * N :  TXT MM/YY             USR
     I                                       37  41 P5ORTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1BTC7    PARM           WP0002  70       Parent Customer
     C           P1ANC7    PARM           WP0003  70       A/R Customer Nu
     C           P1BKC7    PARM           WP0004  70       Ship To Custome
     C           P1R4CD    PARM           WP0005  3        Sales Route Cod
     C           P1X3CD    PARM           WP0006  6        Territory Code
     C           P1MUDT    PARM           WP0007  70       Date - ATR
     C           P1B5SX    PARM           WP0008  1        Print Yes/No
     C           P1DASX    PARM           WP0009  1        Sale Type
     C           P1DBSX    PARM           WP0010  1        Report Type Bot
     C           P2NHTX    PARM P2NHTX    WP0011  3        Alpha Zeroes 3
     C           P2EZTX    PARM P2EZTX    WP0012  3        USR Work Field
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Sales Ton Report   PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$HENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Sales Ton Report   PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@HSTPW8                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Parent Customer
     C                     MOVEL'Y'       W0AL02  1        A/R Customer Nu
     C                     MOVEL'Y'       W0AL03  1        Sales Route Cod
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $CAIC3           Company Number
     C                     MOVEL*BLANK    $CAPTX           Company Name
     C                     MOVEL*BLANK    $CORTX           TXT MM/YY
     C                     MOVEL*BLANK    $COLTX           USR Work Field
     C                     MOVEL*BLANK    $CE2TX           USR Work Field
     C                     Z-ADD*ZERO     $CLBDT           @Date MMDD
     C                     MOVEL*BLANK    $CB5SX           Print Yes/No
     C                     MOVEL*BLANK    $CEZTX           USR Work Field
     C                     Z-ADD*ZERO     $CBTC7           Parent Customer
     C                     MOVEL*BLANK    $CADTX           Name
     C                     Z-ADD*ZERO     $CANC7           A/R Customer Nu
     C                     MOVEL*BLANK    $CAQTX           A/R Customer Na
     C                     Z-ADD*ZERO     $CBKC7           Ship To Custome
     C                     MOVEL*BLANK    $CUWTX           Ship To Name
     C                     MOVEL*BLANK    $CX3CD           Territory Code
     C                     MOVEL*BLANK    $COKNA           Territory Descr
     C                     MOVEL*BLANK    $CR4CD           Sales Route Cod
     C                     MOVEL*BLANK    $CMZNA           Sales Route Des
     C                     Z-ADD*ZERO     $CAADT           @Date - ATR
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDF4AIC3    $DAIC3           Company Number
     C                     Z-ADDF4C4NB    $DC4NB           Order Number
     C                     Z-ADDF4DPNB    $DDPNB           Order Sequence
     C                     Z-ADDF4UENB    $DUENB           Order Secondary
     C                     MOVELF4MONA    $DMONA           A/R City
     C                     MOVELF4RJCD    $DRJCD           A/R State
     C                     MOVELF4RKCD    $DRKCD           A/R County Code
     C                     MOVELF4GPTX    $DGPTX           A/R Zip/Postal
     C                     MOVELF4ABTX    $DABTX           Alpha Search
     C                     MOVELF4KXCD    $DKXCD           Country Code
     C                     MOVELF4BOCD    $DBOCD           Type Code
     C                     Z-ADDF4BTC7    $DBTC7           Parent Customer
     C                     Z-ADDF4ANC7    $DANC7           A/R Customer Nu
     C                     MOVELF4AQTX    $DAQTX           A/R Customer Na
     C                     Z-ADDF4BKC7    $DBKC7           Ship To Custome
     C                     MOVELF4BRTX    $DBRTX           Ship To Name
     C                     MOVELF4HNNA    $DHNNA           Ship To City
     C                     MOVELF4DBCD    $DDBCD           Ship To State C
     C                     MOVELF4CKTX    $DCKTX           Ship To Zip/Pos
     C                     MOVELF4BCNA    $DBCNA           Customer Purcha
     C                     Z-ADDF4A0DT    $DA0DT           Order Date
     C                     Z-ADDF4ACDT    $DACDT           Cancel Date
     C                     MOVELF4R4CD    $DR4CD           Sales Route Cod
     C                     MOVELF4R5CD    $DR5CD           Original Salesp
     C                     MOVELF4BFCD    $DBFCD           Manager Level C
     C                     MOVELF4Q4CD    $DQ4CD           VP Level Code
     C                     MOVELF4AQCD    $DAQCD           Terms Code
     C                     Z-ADDF4TBNB    $DTBNB           Absorbed Freigh
     C                     MOVELF4BZNA    $DBZNA           Carrier Code
     C                     MOVELF4RLCD    $DRLCD           Order Header Re
     C                     MOVELF4JNCD    $DJNCD           Order Type - Sa
     C                     MOVELF4Q2CD    $DQ2CD           Shipping Method
     C                     MOVELF4U2ST    $DU2ST           Export Status
     C                     Z-ADDF4ATIN    $DATIN           Attach to Invoi
     C                     Z-ADDF4T3NB    $DT3NB           Attach to Order
     C                     Z-ADDF4RSRN    $DRSRN           Resell Referenc
     C                     Z-ADDF4ORIT    $DORIT           Original Item
     C                     MOVELF4AJCD    $DAJCD           Warehouse Code
     C                     Z-ADDF4AVQT    $DAVQT           Quantity Ordere
     C                     Z-ADDF4D0WG    $DD0WG           Weight Ordered
     C                     Z-ADDF4CCQT    $DCCQT           Quantity Schedu
     C                     Z-ADDF4AUWG    $DAUWG           Weight Schedule
     C                     MOVELF4AGCD    $DAGCD           U/M - Ordered
     C                     Z-ADDF4AKPR    $DAKPR           Unit Price
     C                     Z-ADDF4AUPR    $DAUPR           Unit Price Orde
     C                     MOVELF4CRCD    $DCRCD           U/M - Base Pric
     C                     Z-ADDF4A5DT    $DA5DT           Requested Ship
     C                     Z-ADDF4AWDT    $DAWDT           Invoice Date
     C                     Z-ADDF4HDDT    $DHDDT           Deadline Depart
     C                     Z-ADDF4AGCS    $DAGCS           Unit Cost Per P
     C                     Z-ADDF4AQCS    $DAQCS           Unit Cost Order
     C                     Z-ADDF4AVWG    $DAVWG           Unit Weight Ord
     C                     MOVELF4AMST    $DAMST           Affect Inventor
     C                     MOVELF4ANST    $DANST           Affect Sales Do
     C                     MOVELF4VAST    $DVAST           Affect Sales Pn
     C                     Z-ADDF4L6NB    $DL6NB           Contract Number
     C                     MOVELF4UMCD    $DUMCD           Export Country
     C                     Z-ADDF4HCDT    $DHCDT           LD Arrival Date
     C                     Z-ADDF4ESNB    $DESNB           Accounting Year
     C                     Z-ADDF4ETNB    $DETNB           Accounting Peri
     C                     Z-ADDF4BZNB    $DBZNB           OM Week
     C                     Z-ADDF4EXQT    $DEXQT           Quantity Billed
     C                     Z-ADDF4BYWG    $DBYWG           Weight Billed
     C                     Z-ADDF4S5NB    $DS5NB           Shipped Item Co
     C                     Z-ADDF4MAVA    $DMAVA           Billing Detail
     C                     Z-ADDF4KDVA    $DKDVA           Billing Detail
     C                     Z-ADDF4USVA    $DUSVA           FOB Gross Amoun
     C                     Z-ADDF4UTVA    $DUTVA           Standard Overag
     C                     Z-ADDF4A4WG    $DA4WG           Tare Weight Tot
     C                     Z-ADDF4CKNB    $DCKNB           G/L Document Nu
     C                     MOVELF4BMST    $DBMST           G/L Update Stat
     C                     Z-ADDF4R8NB    $DR8NB           Original Order
     C                     MOVELF4RMCD    $DRMCD           Order Detail Re
     C                     Z-ADDF4BZPR    $DBZPR           Price Overage O
     C                     MOVELF4RDCD    $DRDCD           Date Method Cod
     C                     MOVELF4Q7CD    $DQ7CD           Price Method Co
     C                     Z-ADDF4EXDT    $DEXDT           Market Pricing
     C                     MOVELF4LQCD    $DLQCD           Commodity Marke
     C                     MOVELF4HICD    $DHICD           Quality Level
     C                     MOVELF4RBCD    $DRBCD           Item Level
     C                     Z-ADDF4RGNB    $DRGNB           Item Structure
     C                     Z-ADDF4RHNB    $DRHNB           Item Structure
     C                     Z-ADDF4RINB    $DRINB           Item Structure
     C                     Z-ADDF4R1NB    $DR1NB           Rated Freight
     C                     Z-ADDF4CONB    $DCONB           Invoice Number
     C                     MOVELF4CEST    $DCEST           Invoice Suffix
     C                     Z-ADDF4GNDT    $DGNDT           Actual Shipped
     C                     Z-ADDF4RMNB    $DRMNB           Load ID
     C                     Z-ADDF4AODT    $DAODT           Scheduled Ship
     C                     MOVELF4LLCD    $DLLCD           Packaging Code
     C                     MOVELF4LMCD    $DLMCD           Grade Code
     C                     Z-ADDF4SKNB    $DSKNB           Agrimetrics gro
     C                     Z-ADDF4SLNB    $DSLNB           Agrimetrics pac
     C                     Z-ADDF4SMNB    $DSMNB           Agrimetrics gra
     C                     MOVELF4G7NA    $DG7NA           Order Desc. Lin
     C                     Z-ADDF4ONVA    $DONVA           Actual Freight
     C                     MOVELF4N0CD    $DN0CD           Item Type Code
     C                     Z-ADDF4B4NB    $DB4NB           PM R/M Type Cod
     C                     Z-ADDF4B5NB    $DB5NB           PM Line Number
     C                     MOVELF4N1CD    $DN1CD           SH Broker Code
     C                     Z-ADDF4GIDT    $DGIDT           Pricing Date Us
     C                     MOVELF4Z1ST    $DZ1ST           Modified Flag
     C                     Z-ADDF4ULVA    $DULVA           Absorbed Freigh
     C                     Z-ADDF4UNVA    $DUNVA           Trade Fund Accr
     C                     Z-ADDF4UOVA    $DUOVA           Commission Amou
     C                     Z-ADDF4UPVA    $DUPVA           Financials Amou
     C                     Z-ADDF4UQVA    $DUQVA           Financials Amou
     C                     MOVELF4SDCD    $DSDCD           Group for Packa
     C                     MOVELF4QZCD    $DQZCD           Base/Conv/Loss
     C                     MOVELF4XWST    $DXWST           Variety/Rendere
     C                     MOVELF4T9CD    $DT9CD           Customer Group
     C                     MOVELF4UBCD    $DUBCD           Customer Group
     C                     Z-ADDF4CFC7    $DCFC7           Order Group Cod
     C                     MOVELF4X1CD    $DX1CD           Shipping Zone C
     C                     MOVELF4UVST    $DUVST           EDI Status 1
     C                     MOVELF4UWST    $DUWST           EDI Status 2
     C                     MOVELF4UXST    $DUXST           EDI Status 3
     C                     Z-ADDF4AATM    $DAATM           Job Time
     C                     MOVELF4AYNA    $DAYNA           User Id
     C                     MOVELF4A0NA    $DA0NA           Job Name
     C                     Z-ADDF4AXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDF4AIC3    $GAIC3           Company Number
     C                     Z-ADDF4BTC7    $GBTC7           Parent Customer
     C                     MOVELF4R4CD    $GR4CD           Sales Route Cod
     C                     MOVEL*BLANK    $GALTX           Salesperson Nam
     C                     MOVEL*BLANK    $GPHTX           Parent Customer
     C                     MOVEL*BLANK    $GX3CD           Territory Code
     C                     MOVEL*BLANK    $GOKNA           Territory Descr
     C                     MOVEL*BLANK    $GAJNA           City
     C                     MOVEL*BLANK    $GEINA           State
     C                     MOVELF4BOCD    $GBOCD           Type Code
     C                     MOVEL*BLANK    $GAUNA           Description
     C                     Z-ADD*ZERO     $GO1NB           Weight 1.1
     C                     Z-ADD*ZERO     $GO3NB           Weight 1.2
     C                     Z-ADD*ZERO     $GO4NB           Weight 1.3
     C                     Z-ADD*ZERO     $GO5NB           Weight 1.4
     C                     Z-ADD*ZERO     $GO7NB           Weight 1.5
     C                     Z-ADD*ZERO     $GVLNB           Last Jan Weight
     C                     Z-ADD*ZERO     $GO8NB           Weight 2.1
     C                     Z-ADD*ZERO     $GO9NB           Weight 2.2
     C                     Z-ADD*ZERO     $GPANB           Weight 2.3
     C                     Z-ADD*ZERO     $GPBNB           Weight 2.4
     C                     Z-ADD*ZERO     $GPCNB           Weight 2.5
     C                     Z-ADD*ZERO     $GV1NB           Last Feb Weight
     C                     Z-ADD*ZERO     $GPDNB           Weight 3.1
     C                     Z-ADD*ZERO     $GPENB           Weight 3.2
     C                     Z-ADD*ZERO     $G               Weight 3.3
     C                     Z-ADD*ZERO     $GJETI           Weight 3.4
     C                     Z-ADD*ZERO     $GJTII           Weight 3.5
     C                     Z-ADD*ZERO     $GV3NB           Last Mar Weight
     C                     Z-ADD*ZERO     $GJTIV           Weight 4.1
     C                     Z-ADD*ZERO     $GJETV           Weight 4.2
     C                     Z-ADD*ZERO     $GJTVI           Weight 4.3
     C                     Z-ADD*ZERO     $GJVII           Weight 4.4
     C                     Z-ADD*ZERO     $GQNNB           Weight 4.5
     C                     Z-ADD*ZERO     $GWSNB           Last Apr Weight
     C                     Z-ADD*ZERO     $GRENB           Weight 5.1
     C                     Z-ADD*ZERO     $GRJNB           Weight 5.2
     C                     Z-ADD*ZERO     $GJTIX           Weight 5.3
     C                     Z-ADD*ZERO     $GJTXI           Weight 5.4
     C                     Z-ADD*ZERO     $GRYNB           Weight 5.5
     C                     Z-ADD*ZERO     $GWXNB           Last May Weight
     C                     Z-ADD*ZERO     $GR2NB           Weight 6.1
     C                     Z-ADD*ZERO     $GJXII           Weight 6.2
     C                     Z-ADD*ZERO     $GXIII           Weight 6.3
     C                     Z-ADD*ZERO     $GJXIV           Weight 6.4
     C                     Z-ADD*ZERO     $GJTXV           Weight 6.5
     C                     Z-ADD*ZERO     $GV4NB           Last Jun Weight
     C                     Z-ADD*ZERO     $GSVNB           Weight 7.1
     C                     Z-ADD*ZERO     $GSWNB           Weight 7.2
     C                     Z-ADD*ZERO     $GJXVI           Weight 7.3
     C                     Z-ADD*ZERO     $GS3NB           Weight 7.4
     C                     Z-ADD*ZERO     $GS4NB           Weight 7.5
     C                     Z-ADD*ZERO     $GV7NB           Last Jul Weight
     C                     Z-ADD*ZERO     $GVIII           Weight 8.1
     C                     Z-ADD*ZERO     $GQUNB           Weight 8.2
     C                     Z-ADD*ZERO     $GQVNB           Weight 8.3
     C                     Z-ADD*ZERO     $GQYNB           Weight 8.4
     C                     Z-ADD*ZERO     $GQZNB           Weight 8.5
     C                     Z-ADD*ZERO     $GV8NB           Last Aug Weight
     C                     Z-ADD*ZERO     $GSONB           Weight 9.1
     C                     Z-ADD*ZERO     $GSPNB           Weight 9.2
     C                     Z-ADD*ZERO     $GSSNB           Weight 9.3
     C                     Z-ADD*ZERO     $GSTNB           Weight 9.4
     C                     Z-ADD*ZERO     $GSUNB           Weight 9.5
     C                     Z-ADD*ZERO     $GWDNB           Last Sep Weight
     C                     Z-ADD*ZERO     $GTUNB           Weight 10.1
     C                     Z-ADD*ZERO     $GTXNB           Weight 10.2
     C                     Z-ADD*ZERO     $GTYNB           Weight 10.3
     C                     Z-ADD*ZERO     $GTZNB           Weight 10.4
     C                     Z-ADD*ZERO     $GT2NB           Weight 10.5
     C                     Z-ADD*ZERO     $GJXXX           Last Oct Weight
     C                     Z-ADD*ZERO     $GT6NB           Weight 11.1
     C                     Z-ADD*ZERO     $GT7NB           Weight 11.2
     C                     Z-ADD*ZERO     $GT8NB           Weight 11.3
     C                     Z-ADD*ZERO     $GUANB           Weight 11.4
     C                     Z-ADD*ZERO     $GUBNB           Weight 11.5
     C                     Z-ADD*ZERO     $GJXX9           Last Nov Weight
     C                     Z-ADD*ZERO     $GUFNB           Weight 12.1
     C                     Z-ADD*ZERO     $GJXX3           Weight 12.2
     C                     Z-ADD*ZERO     $GJXX4           Weight 12.3
     C                     Z-ADD*ZERO     $GJXX5           Weight 12.4
     C                     Z-ADD*ZERO     $GJXX6           Weight 12.5
     C                     Z-ADD*ZERO     $GJXX8           Last Dec Weight
     C                     MOVEL*BLANK    $GOLTX           USR Work Field
     C                     MOVEL*BLANK    $GSATX           USR Work Field
     C                     Z-ADDF4ESNB    $GESNB           Accounting Year
     C                     Z-ADD*ZERO     $GE8NB           USR Accounting
     C                     MOVEL*BLANK    $GNHTX           Alpha Zeroes 3
     C                     MOVEL*BLANK    $GEZTX           USR Work Field
     C                     Z-ADD*ZERO     $GLWNB           Weight 1.1
     C                     Z-ADD*ZERO     $GLXNB           Weight 1.2
     C                     Z-ADD*ZERO     $GLYNB           Weight 1.3
     C                     Z-ADD*ZERO     $GL1NB           Weight 1.4
     C                     Z-ADD*ZERO     $GL4NB           Weight 1.5
     C                     Z-ADD*ZERO     $GVRNB           Current Jan Wei
     C                     Z-ADD*ZERO     $GJXX7           Last Jan Weight
     C                     Z-ADD*ZERO     $GXSNB           Last Jan Change
     C                     Z-ADD*ZERO     $GZFVA           Current Jan Cha
     C                     Z-ADD*ZERO     $GMDNB           Weight 2.1
     C                     Z-ADD*ZERO     $GMENB           Weight 2.2
     C                     Z-ADD*ZERO     $GMGNB           Weight 2.3
     C                     Z-ADD*ZERO     $GMINB           Weight 2.4
     C                     Z-ADD*ZERO     $GMLNB           Weight 2.5
     C                     Z-ADD*ZERO     $GWZNB           Current Feb Wei
     C                     Z-ADD*ZERO     $GXHNB           Last Feb Weight
     C                     Z-ADD*ZERO     $GXUNB           Last Feb Change
     C                     Z-ADD*ZERO     $GZGVA           Current Feb Cha
     C                     Z-ADD*ZERO     $GMVNB           Weight 3.1
     C                     Z-ADD*ZERO     $GMWNB           Weight 3.2
     C                     Z-ADD*ZERO     $GMYNB           Weight 3.3
     C                     Z-ADD*ZERO     $GMZNB           Weight 3.4
     C                     Z-ADD*ZERO     $GM2NB           Weight 3.5
     C                     Z-ADD*ZERO     $GW3NB           Current Mar Wei
     C                     Z-ADD*ZERO     $GXINB           Last Mar Weight
     C                     Z-ADD*ZERO     $GXVNB           Last Mar Change
     C                     Z-ADD*ZERO     $GZHVA           Current Mar Cha
     C                     Z-ADD*ZERO     $GJIII           Weight 4.1
     C                     Z-ADD*ZERO     $GNFNB           Weight 4.2
     C                     Z-ADD*ZERO     $GNHNB           Weight 4.3
     C                     Z-ADD*ZERO     $GNKNB           Weight 4.4
     C                     Z-ADD*ZERO     $GNMNB           Weight 4.5
     C                     Z-ADD*ZERO     $GW6NB           Current Apr Wei
     C                     Z-ADD*ZERO     $GXJNB           Last Apr Weight
     C                     Z-ADD*ZERO     $GXWNB           Last Apr Change
     C                     Z-ADD*ZERO     $GZIVA           Current Apr Cha
     C                     Z-ADD*ZERO     $GNRNB           Weight 5.1
     C                     Z-ADD*ZERO     $GNSNB           Weight 5.2
     C                     Z-ADD*ZERO     $GNUNB           Weight 5.3
     C                     Z-ADD*ZERO     $GNVNB           Weight 5.4
     C                     Z-ADD*ZERO     $GNWNB           Weight 5.5
     C                     Z-ADD*ZERO     $GW7NB           Current May Wei
     C                     Z-ADD*ZERO     $GXKNB           Last May Weight
     C                     Z-ADD*ZERO     $GXXNB           Last May Change
     C                     Z-ADD*ZERO     $GZJVA           Current May Cha
     C                     Z-ADD*ZERO     $GN0NB           Weight 6.1
     C                     Z-ADD*ZERO     $GN1NB           Weight 6.2
     C                     Z-ADD*ZERO     $GN3NB           Weight 6.3
     C                     Z-ADD*ZERO     $GN4NB           Weight 6.4
     C                     Z-ADD*ZERO     $GN5NB           Weight 6.5
     C                     Z-ADD*ZERO     $GW8NB           Current Jun Wei
     C                     Z-ADD*ZERO     $GXLNB           Last Jun Weight
     C                     Z-ADD*ZERO     $GXYNB           Last Jun Change
     C                     Z-ADD*ZERO     $GZKVA           Current Jun Cha
     C                     Z-ADD*ZERO     $GOBNB           Weight 7.1
     C                     Z-ADD*ZERO     $GOENB           Weight 7.2
     C                     Z-ADD*ZERO     $GOFNB           Weight 7.3
     C                     Z-ADD*ZERO     $GOGNB           Weight 7.4
     C                     Z-ADD*ZERO     $GOHNB           Weight 7.5
     C                     Z-ADD*ZERO     $GW9NB           Current Jul Wei
     C                     Z-ADD*ZERO     $GXMNB           Last Jul Weight
     C                     Z-ADD*ZERO     $GXZNB           Last Jul Change
     C                     Z-ADD*ZERO     $GZLVA           Current Jul Cha
     C                     Z-ADD*ZERO     $GQ3NB           Weight 8.1
     C                     Z-ADD*ZERO     $GQ4NB           Weight 8.2
     C                     Z-ADD*ZERO     $GQ5NB           Weight 8.3
     C                     Z-ADD*ZERO     $GRANB           Weight 8.4
     C                     Z-ADD*ZERO     $GRBNB           Weight 8.5
     C                     Z-ADD*ZERO     $GXANB           Current Aug Wei
     C                     Z-ADD*ZERO     $GXONB           Last Aug Weight
     C                     Z-ADD*ZERO     $GX0NB           Last Aug Change
     C                     Z-ADD*ZERO     $GZMVA           Current Aug Cha
     C                     Z-ADD*ZERO     $GXVII           Weight 9.1
     C                     Z-ADD*ZERO     $GTCNB           Weight 9.2
     C                     Z-ADD*ZERO     $GJXIX           Weight 9.3
     C                     Z-ADD*ZERO     $GJTXX           Weight 9.4
     C                     Z-ADD*ZERO     $GJXXI           Weight 9.5
     C                     Z-ADD*ZERO     $GXBNB           Current Sep Wei
     C                     Z-ADD*ZERO     $GXPNB           Last Sep Weight
     C                     Z-ADD*ZERO     $GX1NB           Last Sep Change
     C                     Z-ADD*ZERO     $GZNVA           Current Sep Cha
     C                     Z-ADD*ZERO     $GU1NB           Weight 10.1
     C                     Z-ADD*ZERO     $GU5NB           Weight 10.2
     C                     Z-ADD*ZERO     $GU2NB           Weight 10.3
     C                     Z-ADD*ZERO     $GU3NB           Weight 10.4
     C                     Z-ADD*ZERO     $GU4NB           Weight 10.5
     C                     Z-ADD*ZERO     $GXCNB           Current Oct Wei
     C                     Z-ADD*ZERO     $GXQNB           Last Oct Weight
     C                     Z-ADD*ZERO     $GX4NB           Last Oct Change
     C                     Z-ADD*ZERO     $GZOVA           Current Oct Cha
     C                     Z-ADD*ZERO     $GU6NB           Weight 11.1
     C                     Z-ADD*ZERO     $GVBNB           Weight 11.2
     C                     Z-ADD*ZERO     $GVCNB           Weight 11.3
     C                     Z-ADD*ZERO     $GVDNB           Weight 11.4
     C                     Z-ADD*ZERO     $GVENB           Weight 11.5
     C                     Z-ADD*ZERO     $GXDNB           Current Nov Wei
     C                     Z-ADD*ZERO     $GXRNB           Last Nov Weight
     C                     Z-ADD*ZERO     $GX2NB           Last Nov Change
     C                     Z-ADD*ZERO     $GZPVA           Current Nov Cha
     C                     Z-ADD*ZERO     $GVFNB           Weight 12.1
     C                     Z-ADD*ZERO     $GVGNB           Weight 12.2
     C                     Z-ADD*ZERO     $GVHNB           Weight 12.3
     C                     Z-ADD*ZERO     $GVINB           Weight 12.4
     C                     Z-ADD*ZERO     $GVJNB           Weight 12.5
     C                     Z-ADD*ZERO     $GVYNB           Current Dec Wei
     C                     Z-ADD*ZERO     $GVZNB           Last Dec Weight
     C                     Z-ADD*ZERO     $GX3NB           Last Dec Change
     C                     Z-ADD*ZERO     $GZQVA           Current Dec Cha
     C                     Z-ADD*ZERO     $GZRVA           Current Load To
     C                     Z-ADD*ZERO     $GZSVA           Last Load Total
     C                     MOVELF4HNNA    $GHNNA           Ship To City
     C                     MOVELF4DBCD    $GDBCD           Ship To State C
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDF4AIC3    $EAIC3           Company Number
     C                     Z-ADDF4BTC7    $EBTC7           Parent Customer
     C                     Z-ADDF4ANC7    $EANC7           A/R Customer Nu
      * USER: Process before print of A/R Customer Number format
     C                     MOVEL'N'       W0PFM            *Print format
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDF4AIC3    $FAIC3           Company Number
     C                     Z-ADDF4C4NB    $FC4NB           Order Number
     C                     Z-ADDF4DPNB    $FDPNB           Order Sequence
     C                     Z-ADDF4UENB    $FUENB           Order Secondary
     C                     MOVELF4MONA    $FMONA           A/R City
     C                     MOVELF4RJCD    $FRJCD           A/R State
     C                     MOVELF4RKCD    $FRKCD           A/R County Code
     C                     MOVELF4GPTX    $FGPTX           A/R Zip/Postal
     C                     MOVELF4ABTX    $FABTX           Alpha Search
     C                     MOVELF4KXCD    $FKXCD           Country Code
     C                     MOVELF4BOCD    $FBOCD           Type Code
     C                     Z-ADDF4BTC7    $FBTC7           Parent Customer
     C                     Z-ADDF4ANC7    $FANC7           A/R Customer Nu
     C                     MOVELF4AQTX    $FAQTX           A/R Customer Na
     C                     Z-ADDF4BKC7    $FBKC7           Ship To Custome
     C                     MOVELF4BRTX    $FBRTX           Ship To Name
     C                     MOVELF4HNNA    $FHNNA           Ship To City
     C                     MOVELF4DBCD    $FDBCD           Ship To State C
     C                     MOVELF4CKTX    $FCKTX           Ship To Zip/Pos
     C                     MOVELF4BCNA    $FBCNA           Customer Purcha
     C                     Z-ADDF4A0DT    $FA0DT           Order Date
     C                     Z-ADDF4ACDT    $FACDT           Cancel Date
     C                     MOVELF4R4CD    $FR4CD           Sales Route Cod
     C                     MOVELF4R5CD    $FR5CD           Original Salesp
     C                     MOVELF4BFCD    $FBFCD           Manager Level C
     C                     MOVELF4Q4CD    $FQ4CD           VP Level Code
     C                     MOVELF4AQCD    $FAQCD           Terms Code
     C                     Z-ADDF4TBNB    $FTBNB           Absorbed Freigh
     C                     MOVELF4BZNA    $FBZNA           Carrier Code
     C                     MOVELF4RLCD    $FRLCD           Order Header Re
     C                     MOVELF4JNCD    $FJNCD           Order Type - Sa
     C                     MOVELF4Q2CD    $FQ2CD           Shipping Method
     C                     MOVELF4U2ST    $FU2ST           Export Status
     C                     Z-ADDF4ATIN    $FATIN           Attach to Invoi
     C                     Z-ADDF4T3NB    $FT3NB           Attach to Order
     C                     Z-ADDF4RSRN    $FRSRN           Resell Referenc
     C                     Z-ADDF4ORIT    $FORIT           Original Item
     C                     MOVELF4AJCD    $FAJCD           Warehouse Code
     C                     Z-ADDF4AVQT    $FAVQT           Quantity Ordere
     C                     Z-ADDF4D0WG    $FD0WG           Weight Ordered
     C                     Z-ADDF4CCQT    $FCCQT           Quantity Schedu
     C                     Z-ADDF4AUWG    $FAUWG           Weight Schedule
     C                     MOVELF4AGCD    $FAGCD           U/M - Ordered
     C                     Z-ADDF4AKPR    $FAKPR           Unit Price
     C                     Z-ADDF4AUPR    $FAUPR           Unit Price Orde
     C                     MOVELF4CRCD    $FCRCD           U/M - Base Pric
     C                     Z-ADDF4A5DT    $FA5DT           Requested Ship
     C                     Z-ADDF4AWDT    $FAWDT           Invoice Date
     C                     Z-ADDF4HDDT    $FHDDT           Deadline Depart
     C                     Z-ADDF4AGCS    $FAGCS           Unit Cost Per P
     C                     Z-ADDF4AQCS    $FAQCS           Unit Cost Order
     C                     Z-ADDF4AVWG    $FAVWG           Unit Weight Ord
     C                     MOVELF4AMST    $FAMST           Affect Inventor
     C                     MOVELF4ANST    $FANST           Affect Sales Do
     C                     MOVELF4VAST    $FVAST           Affect Sales Pn
     C                     Z-ADDF4L6NB    $FL6NB           Contract Number
     C                     MOVELF4UMCD    $FUMCD           Export Country
     C                     Z-ADDF4HCDT    $FHCDT           LD Arrival Date
     C                     Z-ADDF4ESNB    $FESNB           Accounting Year
     C                     Z-ADDF4ETNB    $FETNB           Accounting Peri
     C                     Z-ADDF4BZNB    $FBZNB           OM Week
     C                     Z-ADDF4EXQT    $FEXQT           Quantity Billed
     C                     Z-ADDF4BYWG    $FBYWG           Weight Billed
     C                     Z-ADDF4S5NB    $FS5NB           Shipped Item Co
     C                     Z-ADDF4MAVA    $FMAVA           Billing Detail
     C                     Z-ADDF4KDVA    $FKDVA           Billing Detail
     C                     Z-ADDF4USVA    $FUSVA           FOB Gross Amoun
     C                     Z-ADDF4UTVA    $FUTVA           Standard Overag
     C                     Z-ADDF4A4WG    $FA4WG           Tare Weight Tot
     C                     Z-ADDF4CKNB    $FCKNB           G/L Document Nu
     C                     MOVELF4BMST    $FBMST           G/L Update Stat
     C                     Z-ADDF4R8NB    $FR8NB           Original Order
     C                     MOVELF4RMCD    $FRMCD           Order Detail Re
     C                     Z-ADDF4BZPR    $FBZPR           Price Overage O
     C                     MOVELF4RDCD    $FRDCD           Date Method Cod
     C                     MOVELF4Q7CD    $FQ7CD           Price Method Co
     C                     Z-ADDF4EXDT    $FEXDT           Market Pricing
     C                     MOVELF4LQCD    $FLQCD           Commodity Marke
     C                     MOVELF4HICD    $FHICD           Quality Level
     C                     MOVELF4RBCD    $FRBCD           Item Level
     C                     Z-ADDF4RGNB    $FRGNB           Item Structure
     C                     Z-ADDF4RHNB    $FRHNB           Item Structure
     C                     Z-ADDF4RINB    $FRINB           Item Structure
     C                     Z-ADDF4R1NB    $FR1NB           Rated Freight
     C                     Z-ADDF4CONB    $FCONB           Invoice Number
     C                     MOVELF4CEST    $FCEST           Invoice Suffix
     C                     Z-ADDF4GNDT    $FGNDT           Actual Shipped
     C                     Z-ADDF4RMNB    $FRMNB           Load ID
     C                     Z-ADDF4AODT    $FAODT           Scheduled Ship
     C                     MOVELF4LLCD    $FLLCD           Packaging Code
     C                     MOVELF4LMCD    $FLMCD           Grade Code
     C                     Z-ADDF4SKNB    $FSKNB           Agrimetrics gro
     C                     Z-ADDF4SLNB    $FSLNB           Agrimetrics pac
     C                     Z-ADDF4SMNB    $FSMNB           Agrimetrics gra
     C                     MOVELF4G7NA    $FG7NA           Order Desc. Lin
     C                     Z-ADDF4ONVA    $FONVA           Actual Freight
     C                     MOVELF4N0CD    $FN0CD           Item Type Code
     C                     Z-ADDF4B4NB    $FB4NB           PM R/M Type Cod
     C                     Z-ADDF4B5NB    $FB5NB           PM Line Number
     C                     MOVELF4N1CD    $FN1CD           SH Broker Code
     C                     Z-ADDF4GIDT    $FGIDT           Pricing Date Us
     C                     MOVELF4Z1ST    $FZ1ST           Modified Flag
     C                     Z-ADDF4ULVA    $FULVA           Absorbed Freigh
     C                     Z-ADDF4UNVA    $FUNVA           Trade Fund Accr
     C                     Z-ADDF4UOVA    $FUOVA           Commission Amou
     C                     Z-ADDF4UPVA    $FUPVA           Financials Amou
     C                     Z-ADDF4UQVA    $FUQVA           Financials Amou
     C                     MOVELF4SDCD    $FSDCD           Group for Packa
     C                     MOVELF4QZCD    $FQZCD           Base/Conv/Loss
     C                     MOVELF4XWST    $FXWST           Variety/Rendere
     C                     MOVELF4T9CD    $FT9CD           Customer Group
     C                     MOVELF4UBCD    $FUBCD           Customer Group
     C                     Z-ADDF4CFC7    $FCFC7           Order Group Cod
     C                     MOVELF4X1CD    $FX1CD           Shipping Zone C
     C                     MOVELF4GASX    $FGASX           Invoice Price T
     C                     Z-ADDF4DUPR    $FDUPR           Invoice Unit Pr
     C                     Z-ADDF4B6VL    $FB6VL           Invoice Extende
     C                     Z-ADDF4IANX    $FIANX           Req Shipping Te
     C                     Z-ADDF4IBNX    $FIBNX           Actual Shipping
     C                     MOVELF4RPCD    $FRPCD           Age Code
     C                     Z-ADDF4NYDT    $FNYDT           Req Delivery Da
     C                     Z-ADDF4BZTM    $FBZTM           Req Delivery Ti
     C                     Z-ADDF4Z4NB    $FZ4NB           MPC Number
     C                     MOVELF4XACD    $FXACD           Shipping Line
     C                     MOVELF4OANA    $FOANA           Sail Port Delv
     C                     MOVELF4OKTX    $FOKTX           Sail Port City
     C                     MOVELF4K4TX    $FK4TX           Vessel Name
     C                     MOVELF4NBBO    $FNBBO           Booking Number
     C                     Z-ADDF4OCFR    $FOCFR           Ocean Freight
     C                     Z-ADDF4C0C7    $FC0C7           Claim Number
     C                     Z-ADDF4A1AA    $FA1AA           Ham Group Numbe
     C                     MOVELF4VEST    $FVEST           Palletize
     C                     Z-ADDF4A5PR    $FA5PR           Commodity Marke
     C                     Z-ADDF4CDPR    $FCDPR           Market Value
     C                     Z-ADDF4D0PR    $FD0PR           Default Cmdty M
     C                     Z-ADDF4D0VL    $FD0VL           Raw Material Co
     C                     MOVELF4IRSX    $FIRSX           Sales Expense P
     C                     Z-ADDF4CEVL    $FCEVL           Sales Expense T
     C                     MOVELF4ISSX    $FISSX           Data Mart Proce
     C                     MOVELF4ITSX    $FITSX           LH Load Type
     C                     MOVELF4IUSX    $FIUSX           Sale Country
     C                     Z-ADDF4OHDT    $FOHDT           LD Sail Date
     C                     Z-ADDF4D9PR    $FD9PR           HST Unused Pric
     C                     Z-ADDF4CFVL    $FCFVL           HST Item Target
     C                     MOVELF4UVST    $FUVST           EDI Status 1
     C                     MOVELF4UWST    $FUWST           EDI Status 2
     C                     MOVELF4UXST    $FUXST           EDI Status 3
     C                     Z-ADDF4AATM    $FAATM           Job Time
     C                     MOVELF4AYNA    $FAYNA           User Id
     C                     MOVELF4A0NA    $FA0NA           Job Name
     C                     Z-ADDF4AXDT    $FAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * This Year.
     C                     EXSR UESUBR                     This Year.
      * Last Year.
     C                     EXSR UFSUBR                     Last Year.
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN F4AIC3    WZA001           Company Number
     C                     Z-ADDF4AIC3    WZA001
     C           *LIKE     DEFN F4BTC7    WZA002           Parent Customer
     C                     Z-ADDF4BTC7    WZA002
     C           *LIKE     DEFN F4ANC7    WZA003           A/R Customer Nu
     C                     Z-ADDF4ANC7    WZA003
     C           *LIKE     DEFN F4R4CD    WZA004           Sales Route Cod
     C                     MOVELF4R4CD    WZA004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @HSTPW8                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * PAR.Actual Shipped Month USR = DB1.Actual Shipped Date *MONTH
     C           F4GNDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    P5I5NX
      * PAR.Actual Shipped Day USR = DB1.Actual Shipped Date *DAY OF MONT
     C           F4GNDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     P5I7NX
      * PAR.Actual Shipped Year USR = DB1.Actual Shipped Date *YEAR
     C           F4GNDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    P5I6NX
      * Current Year Check
      * CASE: PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY) USR
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY) USR
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
      * Company Number Check
      * CASE: PAR.Record Selected       USR is yes
     C           P3ZZST    IFEQ 'Y'                        *IF
      * CASE: PAR.Company Number is Equal to zero
     C           P1AIC3    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Company Number EQ DB1.Company Number
     C           P1AIC3    IFEQ F4AIC3                     *IF
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Parent Number Check
      * CASE: PAR.A/R Customer Number is equal to zero
     C           P1ANC7    IFEQ *ZERO                      *IF
      * Parent Customer Check
      * CASE: PAR.Record Selected       USR is yes
     C           P3ZZST    IFEQ 'Y'                        *IF
      * CASE: PAR.Parent Customer is equal to zero
     C           P1BTC7    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Parent Customer EQ DB1.Parent Customer
     C           P1BTC7    IFEQ F4BTC7                     *IF
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * A/R Customer Number
      * CASE: PAR.Record Selected       USR is yes
     C           P3ZZST    IFEQ 'Y'                        *IF
      * CASE: PAR.A/R Customer Number is equal to zero
     C           P1ANC7    IFEQ *ZERO                      *IF
      * RTV All fields - Company/Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDF4AIC3    WL0014           Company Number
     C                     Z-ADDF4ANC7    WL0015           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    WUG0TX    P      Terms Code
     C                     MOVELWL0017    P2YGCD    P      Sales Route Cod
     C                     MOVELWL0018    WUG0TX    P      Special Instruc
     C                     MOVELWL0019    WUG0TX    P      Special Instruc
     C                     MOVELWL0020    WUG0TX    P      Carrier Code
     C                     MOVELWL0021    WUG0TX    P      Broker
     C                     MOVELWL0022    WUG0TX    P      P.O. Required F
     C                     Z-ADDWL0023    WUNFNN           Deliver after t
     C                     Z-ADDWL0024    WUNFNN           Deliver before
     C                     MOVELWL0025    WUG0TX    P      Alt Remittance
     C                     MOVELWL0026    P4BOCD    P      Type Code
     C                     Z-ADDWL0027    WUNFNN           Absorbed Freigh
     C                     Z-ADDWL0028    WUNFNN           Mileage To Cust
     C                     Z-ADDWL0029    WUNFNN           Freight Overate
     C                     MOVELWL0030    WUG0TX    P      Age Code
     C                     MOVELWL0031    WUG0TX    P      Warehouse Code
     C                     MOVELWL0032    WUG0TX    P      Outside Warehou
     C                     MOVELWL0033    WUG0TX    P      Customer Group
     C                     MOVELWL0034    WUG0TX    P      Customer Group
     C                     MOVELWL0035    WUG0TX    P      G/L Code
     C                     MOVELWL0036    WUG0TX    P      Commodity Marke
     C                     MOVELWL0037    WUG0TX    P      Credit Contact
     C                     MOVELWL0038    WUG0TX    P      Credit Contact
     C                     MOVELWL0039    WUG0TX    P      Credit Contact
     C                     MOVELWL0040    WUG0TX    P      Credit Contact
     C                     MOVELWL0041    WUG0TX    P      Allow Man/Qt WO
     C                     MOVELWL0042    WUG0TX    P      Fax Invoice Fla
     C                     MOVELWL0043    WUG0TX    P      Fax Invoice Fax
     C                     MOVELWL0044    WUG0TX    P      Fax Invoice Con
     C                     MOVELWL0045    WUG0TX    P      Distributor
     C                     MOVELWL0046    WUG0TX    P      Default Shippin
     C                     MOVELWL0047    WUG0TX    P      Unused Co/Cust
     C                     MOVELWL0048    WUG0TX    P      Unused Co/Cust
     C                     MOVELWL0049    WUG0TX    P      EDI Status 1
     C                     MOVELWL0050    WUG0TX    P      EDI Status 2
     C                     MOVELWL0051    WUG0TX    P      EDI Status 3
     C                     MOVELWL0052    P2VSST    P      Record Status
     C                     Z-ADDWL0053    WUNFNN           Job Time
     C                     MOVELWL0054    WUBOCD    P      User Id
     C                     MOVELWL0055    WUG0TX    P      Job Name
     C                     Z-ADDWL0056    WUNFNN           Job Date
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.A/R Customer Number EQ DB1.A/R Customer Number
     C           P1ANC7    IFEQ F4ANC7                     *IF
      * RTV All fields - Company/Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDF4AIC3    WL0014           Company Number
     C                     Z-ADDF4ANC7    WL0015           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    WUG0TX    P      Terms Code
     C                     MOVELWL0017    P2YGCD    P      Sales Route Cod
     C                     MOVELWL0018    WUG0TX    P      Special Instruc
     C                     MOVELWL0019    WUG0TX    P      Special Instruc
     C                     MOVELWL0020    WUG0TX    P      Carrier Code
     C                     MOVELWL0021    WUG0TX    P      Broker
     C                     MOVELWL0022    WUG0TX    P      P.O. Required F
     C                     Z-ADDWL0023    WUNFNN           Deliver after t
     C                     Z-ADDWL0024    WUNFNN           Deliver before
     C                     MOVELWL0025    WUG0TX    P      Alt Remittance
     C                     MOVELWL0026    P4BOCD    P      Type Code
     C                     Z-ADDWL0027    WUNFNN           Absorbed Freigh
     C                     Z-ADDWL0028    WUNFNN           Mileage To Cust
     C                     Z-ADDWL0029    WUNFNN           Freight Overate
     C                     MOVELWL0030    WUG0TX    P      Age Code
     C                     MOVELWL0031    WUG0TX    P      Warehouse Code
     C                     MOVELWL0032    WUG0TX    P      Outside Warehou
     C                     MOVELWL0033    WUG0TX    P      Customer Group
     C                     MOVELWL0034    WUG0TX    P      Customer Group
     C                     MOVELWL0035    WUG0TX    P      G/L Code
     C                     MOVELWL0036    WUG0TX    P      Commodity Marke
     C                     MOVELWL0037    WUG0TX    P      Credit Contact
     C                     MOVELWL0038    WUG0TX    P      Credit Contact
     C                     MOVELWL0039    WUG0TX    P      Credit Contact
     C                     MOVELWL0040    WUG0TX    P      Credit Contact
     C                     MOVELWL0041    WUG0TX    P      Allow Man/Qt WO
     C                     MOVELWL0042    WUG0TX    P      Fax Invoice Fla
     C                     MOVELWL0043    WUG0TX    P      Fax Invoice Fax
     C                     MOVELWL0044    WUG0TX    P      Fax Invoice Con
     C                     MOVELWL0045    WUG0TX    P      Distributor
     C                     MOVELWL0046    WUG0TX    P      Default Shippin
     C                     MOVELWL0047    WUG0TX    P      Unused Co/Cust
     C                     MOVELWL0048    WUG0TX    P      Unused Co/Cust
     C                     MOVELWL0049    WUG0TX    P      EDI Status 1
     C                     MOVELWL0050    WUG0TX    P      EDI Status 2
     C                     MOVELWL0051    WUG0TX    P      EDI Status 3
     C                     MOVELWL0052    P2VSST    P      Record Status
     C                     Z-ADDWL0053    WUNFNN           Job Time
     C                     MOVELWL0054    WUBOCD    P      User Id
     C                     MOVELWL0055    WUG0TX    P      Job Name
     C                     Z-ADDWL0056    WUNFNN           Job Date
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Verify Record Status
      * CASE: PAR.Record Selected       USR is yes
     C           P3ZZST    IFEQ 'Y'                        *IF
      * CASE: PAR.Record Status is Active
     C           P2VSST    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
      * Improved State Code Selection
      * CASE: PAR.Record Selected       USR is yes
     C           P3ZZST    IFEQ 'Y'                        *IF
      * CASE: PAR.Territory Code is *All
     C           P1X3CD    IFEQ '*ALL'                     *IF
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.A/R State EQ PAR.Z Ship to State Code
     C           F4RJCD    IFEQ P2BGCD                     *IF
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV State/Territory    RT - *Arrays  * 
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Territory Code EQ WRK.Territory Code
     C           P1X3CD    IFEQ WUX3CD                     *IF
     C                     MOVELF4RJCD    P2BGCD           State Code
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Debit/Credit
      * CASE: PAR.Record Selected       USR is yes
     C           P3ZZST    IFEQ 'Y'                        *IF
      * RTV Billing Type       RT - OP Order Types  * 
     C                     EXSR SMRVGN
      * CASE: WRK.Billing Activity Type is Credit or Debit Memo
     C           WUOBST    IFEQ '2'                        *IF
     C           WUOBST    OREQ '3'
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P3ZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
      * Sales Route Select
      * CASE: PAR.Record Selected       USR is yes
     C           P3ZZST    IFEQ 'Y'                        *IF
      * CASE: PAR.Sales Route Code is *All
     C           P1R4CD    IFEQ 'ALL'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Sales Route Code EQ PAR.Sales Route Code Ref  USR
     C           P1R4CD    IFEQ P2YGCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company
      * CASE: PAR.Record Selected       USR is yes
     C           P3ZZST    IFEQ 'Y'                        *IF
      * RTV Check Existence    RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDF4BTC7    WL0057           Ship To Custome
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Check Existence    RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDF4ANC7    WL0057           Ship To Custome
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'N'       P3ZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Select Record or Not.
      * CASE: PAR.Record Selected       USR is yes
     C           P3ZZST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Parent Customer
     C                     MOVEL*BLANK    W0AL02  1        A/R Customer Nu
     C                     MOVEL*BLANK    W0AL03  1        Sales Route Cod
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Parent Customer
     C                     MOVEL'Y'       W0AL02  1        A/R Customer Nu
     C                     MOVEL'Y'       W0AL03  1        Sales Route Cod
     C                     ELSE
      * Next record - Detect level breaks
     C           F4AIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           F4BTC7    IFNE WZA002                     Parent Customer
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           F4ANC7    IFNE WZA003                     A/R Customer Nu
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           F4R4CD    IFNE WZA004                     Sales Route Cod
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL03    IFEQ 'Y'
      * USER: On print of Sales Route Code format
     C                     MOVEL'N'       W0PFM            *Print format
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * USER: On print of A/R Customer Number format
     C                     MOVEL'N'       W0PFM            *Print format
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Parent Customer format
      * CASE: PAR.Parent Customer is equal to zero
     C           P1BTC7    IFEQ *ZERO                      *IF
      * CASE: PAR.A/R Customer Number is equal to zero
     C           P1ANC7    IFEQ *ZERO                      *IF
      * CASE: PAR.Ship To Customer is not equal to zero
     C           P1BKC7    IFNE *ZERO                      *IF
     C                     Z-ADDP1BKC7    $GBTC7           Parent Customer
      * RTV Name.Address,Fax   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0058           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0059    $GPHTX    P      Customer Name
     C                     MOVELWL0060    WUG0TX    P      Address Line 1
     C                     MOVELWL0061    WUG0TX    P      Address Line 2
     C                     MOVELWL0062    $GAJNA    P      City
     C                     MOVELWL0063    $GEINA    P      State Code
     C                     MOVELWL0064    WUG0TX    P      Zip/Postal Code
     C                     MOVELWL0065    WUG0TX    P      Fax Number FF
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *** Print Zeroes??? ***
      * CASE: PAR.Print Yes/No          USR is Yes
     C           P1B5SX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Print Yes/No          USR is Yes
     C           WUB5SX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C                     END                             *FI
      * Print Headers
     C                     EXSR UGSUBR                     Print Headers
      * Retrieving Truck Size
      * CASE: PAR.Sale Type             USR is Loads
     C           P1DASX    IFEQ 'L'                        *IF
      * RTV Truck Size         RT - OM Truck Size  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
      * Calculate Weights.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.This Month  (MM) USR LE PAR.Current Month USR
      *   |- c2    : PAR.Actual Shipped Year USR LE PAR.Current Year  USR
      *   '-
     C           P5I4NX    IFLE P5I1NX                     *IF
     C           P5I6NX    ORLE P5I0NX                     *OR
      * January Check
      * CASE: PAR.This Month  (MM) USR is >= January
     C           P5I4NX    IFGE 1                          *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Weight
     C                     EXSR UHSUBR                     CWT Weight
     C                     ELSE
      * CASE: *OTHERWISE
      * Loads Weight
     C                     EXSR UISUBR                     Loads Weight
     C                     END                             *FI
     C           $GVRNB    SUB  $GJXX7    $GXSNB           Last Jan Change
     C                     Z-ADD$GXSNB    $GZFVA           Current Jan Cha
     C                     END                             *FI
      * February Check
      * CASE: PAR.This Month  (MM) USR is >= February
     C           P5I4NX    IFGE 2                          *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Weight
     C                     EXSR UJSUBR                     CWT Weight
     C                     ELSE
      * CASE: *OTHERWISE
      * Load Weight
     C                     EXSR UKSUBR                     Load Weight
     C                     END                             *FI
     C           $GWZNB    SUB  $GXHNB    $GXUNB           Last Feb Change
     C           $GZFVA    ADD  $GXUNB    $GZGVA           Current Feb Cha
     C                     END                             *FI
      * March Check
      * CASE: PAR.This Month  (MM) USR is >= March
     C           P5I4NX    IFGE 3                          *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Weight
     C                     EXSR ULSUBR                     CWT Weight
     C                     ELSE
      * CASE: *OTHERWISE
      * Loads Weight
     C                     EXSR UMSUBR                     Loads Weight
     C                     END                             *FI
     C           $GW3NB    SUB  $GXINB    $GXVNB           Last Mar Change
     C           $GZGVA    ADD  $GXVNB    $GZHVA           Current Mar Cha
     C                     END                             *FI
      * April Check
      * CASE: PAR.This Month  (MM) USR is >= April
     C           P5I4NX    IFGE 4                          *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Weight
     C                     EXSR UNSUBR                     CWT Weight
     C                     ELSE
      * CASE: *OTHERWISE
      * Loads Weight
     C                     EXSR UOSUBR                     Loads Weight
     C                     END                             *FI
     C           $GW6NB    SUB  $GXJNB    $GXWNB           Last Apr Change
     C           $GZHVA    ADD  $GXWNB    $GZIVA           Current Apr Cha
     C                     END                             *FI
      * May Check
      * CASE: PAR.This Month  (MM) USR is >= May
     C           P5I4NX    IFGE 5                          *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Weight
     C                     EXSR UPSUBR                     CWT Weight
     C                     ELSE
      * CASE: *OTHERWISE
      * Loads Weight
     C                     EXSR UQSUBR                     Loads Weight
     C                     END                             *FI
     C           $GW7NB    SUB  $GXKNB    $GXXNB           Last May Change
     C           $GZIVA    ADD  $GXXNB    $GZJVA           Current May Cha
     C                     END                             *FI
      * June Check
      * CASE: PAR.This Month  (MM) USR is >= June
     C           P5I4NX    IFGE 6                          *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Weight
     C                     EXSR URSUBR                     CWT Weight
     C                     ELSE
      * CASE: *OTHERWISE
      * Loads Weight
     C                     EXSR USSUBR                     Loads Weight
     C                     END                             *FI
     C           $GW8NB    SUB  $GXLNB    $GXYNB           Last Jun Change
     C           $GZJVA    ADD  $GXYNB    $GZKVA           Current Jun Cha
     C                     END                             *FI
      * July Check
      * CASE: PAR.This Month  (MM) USR is >= July
     C           P5I4NX    IFGE 7                          *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Weight
     C                     EXSR UTSUBR                     CWT Weight
     C                     ELSE
      * CASE: *OTHERWISE
      * Load Weight
     C                     EXSR UUSUBR                     Load Weight
     C                     END                             *FI
     C           $GW9NB    SUB  $GXMNB    $GXZNB           Last Jul Change
     C           $GZKVA    ADD  $GXZNB    $GZLVA           Current Jul Cha
     C                     END                             *FI
      * August Check
      * CASE: PAR.This Month  (MM) USR is >= August
     C           P5I4NX    IFGE 8                          *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Loads
     C                     EXSR UVSUBR                     CWT Loads
     C                     ELSE
      * CASE: *OTHERWISE
      * Weight Loads
     C                     EXSR UWSUBR                     Weight Loads
     C                     END                             *FI
     C           $GXANB    SUB  $GXONB    $GX0NB           Last Aug Change
     C           $GZLVA    ADD  $GX0NB    $GZMVA           Current Aug Cha
     C                     END                             *FI
      * September Check
      * CASE: PAR.This Month  (MM) USR is >= September
     C           P5I4NX    IFGE 9                          *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Weight
     C                     EXSR UXSUBR                     CWT Weight
     C                     ELSE
      * CASE: *OTHERWISE
      * Load Weights
     C                     EXSR UYSUBR                     Load Weights
     C                     END                             *FI
     C           $GXBNB    SUB  $GXPNB    $GX1NB           Last Sep Change
     C           $GZMVA    ADD  $GX1NB    $GZNVA           Current Sep Cha
     C                     END                             *FI
      * October Check
      * CASE: PAR.This Month  (MM) USR is >= October
     C           P5I4NX    IFGE 10                         *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Weight
     C                     EXSR UZSUBR                     CWT Weight
     C                     ELSE
      * CASE: *OTHERWISE
      * Load Weight
     C                     EXSR NASUBR                     Load Weight
     C                     END                             *FI
     C           $GXCNB    SUB  $GXQNB    $GX4NB           Last Oct Change
     C           $GZNVA    ADD  $GX4NB    $GZOVA           Current Oct Cha
     C                     END                             *FI
      * November Check
      * CASE: PAR.This Month  (MM) USR is >= November
     C           P5I4NX    IFGE 11                         *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Weight
     C                     EXSR NBSUBR                     CWT Weight
     C                     ELSE
      * CASE: *OTHERWISE
      * Load Weight
     C                     EXSR NCSUBR                     Load Weight
     C                     END                             *FI
     C           $GXDNB    SUB  $GXRNB    $GX2NB           Last Nov Change
     C           $GZOVA    ADD  $GX2NB    $GZPVA           Current Nov Cha
     C                     END                             *FI
      * December Check
      * CASE: PAR.This Month  (MM) USR is >= December
     C           P5I4NX    IFGE 12                         *IF
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
      * CWT Loads
     C                     EXSR NDSUBR                     CWT Loads
     C                     ELSE
      * CASE: *OTHERWISE
      * Weight Loads
     C                     EXSR NESUBR                     Weight Loads
     C                     END                             *FI
     C           $GVYNB    SUB  $GVZNB    $GX3NB           Last Dec Change
     C           $GZPVA    ADD  $GX3NB    $GZQVA           Current Dec Cha
     C                     END                             *FI
      * Calculating Current Total
      * CUR.Current Load Total    USR =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 +
      *    x11 + x12)
      * x1    : CUR.Current Jan Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Current Feb Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Current Mar Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Current Apr Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Current May Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x6    : CUR.Current Jun Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x7    : CUR.Current Jul Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x8    : CUR.Current Aug Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x9    : CUR.Current Sep Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x10   : CUR.Current Oct Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x11   : CUR.Current Nov Weight    USR
      * +     : PGM.*Synon (17,7) work field
      * x12   : CUR.Current Dec Weight    USR
     C           $GVRNB    ADD  $GWZNB    W0WD10           *Synon (17,7) w
     C           W0WD10    ADD  $GW3NB    W0WD09           *Synon (17,7) w
     C           W0WD09    ADD  $GW6NB    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  $GW7NB    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  $GW8NB    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  $GW9NB    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  $GXANB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GXBNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GXCNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GXDNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GVYNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GZRVA           Current Load To
      * Calculating Last Total
      * CUR.Last Load Total       USR =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 +
      *    x11 + x12)
      * x1    : CUR.Last Jan Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Last Feb Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Last Mar Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Last Apr Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Last May Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x6    : CUR.Last Jun Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x7    : CUR.Last Jul Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x8    : CUR.Last Aug Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x9    : CUR.Last Sep Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x10   : CUR.Last Oct Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x11   : CUR.Last Nov Weight       USR
      * +     : PGM.*Synon (17,7) work field
      * x12   : CUR.Last Dec Weight       USR
     C           $GJXX7    ADD  $GXHNB    W0WD10           *Synon (17,7) w
     C           W0WD10    ADD  $GXINB    W0WD09           *Synon (17,7) w
     C           W0WD09    ADD  $GXJNB    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  $GXKNB    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  $GXLNB    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  $GXMNB    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  $GXONB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GXPNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GXQNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GXRNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GVZNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GZSVA           Last Load Total
      * Create Summary Work file for January
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is January
     C           P5I4NX    IFEQ 01                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0001  70       Parent Customer
     C                     PARM $GVRNB    WQ0002  92       Current YTD Wei
     C                     PARM $GJXX7    WQ0003  92       Last YTD Weight
     C                     PARM $GXSNB    WQ0004 112       Last year Month
     C                     PARM $GZFVA    WQ0005 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for February
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is February
     C           P5I4NX    IFEQ 02                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0006  70       Parent Customer
     C                     PARM $GWZNB    WQ0007  92       Current YTD Wei
     C                     PARM $GXHNB    WQ0008  92       Last YTD Weight
     C                     PARM $GXUNB    WQ0009 112       Last year Month
     C                     PARM $GZGVA    WQ0010 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for March
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is March
     C           P5I4NX    IFEQ 03                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0011  70       Parent Customer
     C                     PARM $GW3NB    WQ0012  92       Current YTD Wei
     C                     PARM $GXINB    WQ0013  92       Last YTD Weight
     C                     PARM $GXVNB    WQ0014 112       Last year Month
     C                     PARM $GZHVA    WQ0015 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for April
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is April
     C           P5I4NX    IFEQ 04                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0016  70       Parent Customer
     C                     PARM $GW6NB    WQ0017  92       Current YTD Wei
     C                     PARM $GXJNB    WQ0018  92       Last YTD Weight
     C                     PARM $GXWNB    WQ0019 112       Last year Month
     C                     PARM $GZIVA    WQ0020 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for May
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is May
     C           P5I4NX    IFEQ 05                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0021  70       Parent Customer
     C                     PARM $GW7NB    WQ0022  92       Current YTD Wei
     C                     PARM $GXKNB    WQ0023  92       Last YTD Weight
     C                     PARM $GXXNB    WQ0024 112       Last year Month
     C                     PARM $GZJVA    WQ0025 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for June
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is June
     C           P5I4NX    IFEQ 06                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0026  70       Parent Customer
     C                     PARM $GW8NB    WQ0027  92       Current YTD Wei
     C                     PARM $GXLNB    WQ0028  92       Last YTD Weight
     C                     PARM $GXYNB    WQ0029 112       Last year Month
     C                     PARM $GZKVA    WQ0030 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for July
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is July
     C           P5I4NX    IFEQ 07                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0031  70       Parent Customer
     C                     PARM $GW9NB    WQ0032  92       Current YTD Wei
     C                     PARM $GXMNB    WQ0033  92       Last YTD Weight
     C                     PARM $GXZNB    WQ0034 112       Last year Month
     C                     PARM $GZLVA    WQ0035 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for August
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is August
     C           P5I4NX    IFEQ 08                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0036  70       Parent Customer
     C                     PARM $GXANB    WQ0037  92       Current YTD Wei
     C                     PARM $GXONB    WQ0038  92       Last YTD Weight
     C                     PARM $GX0NB    WQ0039 112       Last year Month
     C                     PARM $GZMVA    WQ0040 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for September
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is September
     C           P5I4NX    IFEQ 09                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0041  70       Parent Customer
     C                     PARM $GXBNB    WQ0042  92       Current YTD Wei
     C                     PARM $GXPNB    WQ0043  92       Last YTD Weight
     C                     PARM $GX1NB    WQ0044 112       Last year Month
     C                     PARM $GZNVA    WQ0045 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for October
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is October
     C           P5I4NX    IFEQ 10                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0046  70       Parent Customer
     C                     PARM $GXCNB    WQ0047  92       Current YTD Wei
     C                     PARM $GXQNB    WQ0048  92       Last YTD Weight
     C                     PARM $GX4NB    WQ0049 112       Last year Month
     C                     PARM $GZOVA    WQ0050 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for November
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is November
     C           P5I4NX    IFEQ 11                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0051  70       Parent Customer
     C                     PARM $GXDNB    WQ0052  92       Current YTD Wei
     C                     PARM $GXRNB    WQ0053  92       Last YTD Weight
     C                     PARM $GX2NB    WQ0054 112       Last year Month
     C                     PARM $GZPVA    WQ0055 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Create Summary Work file for December
      * CASE: PAR.Report Type Both      USR is Summary
     C           P1DBSX    IFEQ 'S'                        *IF
      * CASE: PAR.This Month  (MM) USR is December
     C           P5I4NX    IFEQ 12                         *IF
      * CRT Workfile           XF - Cust Annual Rpt Workfile  * 
     C                     CALL 'PDOEXFR'              90  CRT Workfile
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBTC7    WQ0056  70       Parent Customer
     C                     PARM $GVYNB    WQ0057  92       Current YTD Wei
     C                     PARM $GVZNB    WQ0058  92       Last YTD Weight
     C                     PARM $GX3NB    WQ0059 112       Last year Month
     C                     PARM $GZQVA    WQ0060 112       Current year Mo
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * This format always starts a new page
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
      * Convert fields to external form
      * Convert Parent Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $GBTC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$GBTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VGBTC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGBTC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$GKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         NASUBR    BEGSR
      *================================================================
      * Load Weight
      *================================================================
     C           $GTUNB    DIV  P2RSNB    $GU1NB    H      Weight 10.1
     C           $GTXNB    DIV  P2RSNB    $GU5NB    H      Weight 10.2
     C           $GTYNB    DIV  P2RSNB    $GU2NB    H      Weight 10.3
     C           $GTZNB    DIV  P2RSNB    $GU3NB    H      Weight 10.4
     C           $GT2NB    DIV  P2RSNB    $GU4NB    H      Weight 10.5
      * Calculating Oct's Weight
      * CUR.Current Oct Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 10.1           USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 10.2           usr
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 10.3           USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 10.4           USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 10.5           USR
     C           $GU1NB    ADD  $GU5NB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GU2NB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GU3NB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GU4NB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GXCNB           Current Oct Wei
     C           $GJXXX    DIV  P2RSNB    $GXQNB    H      Last Oct Weight
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBSUBR    BEGSR
      *================================================================
      * CWT Weight
      *================================================================
     C           $GT6NB    DIV  100       $GU6NB    H      Weight 11.1
     C           $GT7NB    DIV  100       $GVBNB    H      Weight 11.2
     C           $GT8NB    DIV  100       $GVCNB    H      Weight 11.3
     C           $GUANB    DIV  100       $GVDNB    H      Weight 11.4
     C           $GUBNB    DIV  100       $GVENB    H      Weight 11.5
      * Calculating Nov's Weight
      * CUR.Current Nov Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 11.1           SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 11.2           SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 11.3           SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 11.4           SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 11.5           SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GT6NB    ADD  $GT7NB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GT8NB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GUANB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GUBNB    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GXDNB           Current Nov Wei
     C           $GJXX9    DIV  100       $GXRNB    H      Last Nov Weight
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCSUBR    BEGSR
      *================================================================
      * Load Weight
      *================================================================
     C           $GT6NB    DIV  P2RSNB    $GU6NB    H      Weight 11.1
     C           $GT7NB    DIV  P2RSNB    $GVBNB    H      Weight 11.2
     C           $GT8NB    DIV  P2RSNB    $GVCNB    H      Weight 11.3
     C           $GUANB    DIV  P2RSNB    $GVDNB    H      Weight 11.4
     C           $GUBNB    DIV  P2RSNB    $GVENB    H      Weight 11.5
      * Calculating Nov's Weight
      * CUR.Current Nov Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 11.1           USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 11.2           USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 11.3           USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 11.4           USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 11.5           USR
     C           $GU6NB    ADD  $GVBNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GVCNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GVDNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GVENB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GXDNB           Current Nov Wei
     C           $GJXX9    DIV  P2RSNB    $GXRNB    H      Last Nov Weight
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDSUBR    BEGSR
      *================================================================
      * CWT Loads
      *================================================================
     C           $GUFNB    DIV  100       $GVFNB    H      Weight 12.1
     C           $GJXX3    DIV  100       $GVGNB    H      Weight 12.2
     C           $GJXX4    DIV  100       $GVHNB    H      Weight 12.3
     C           $GJXX5    DIV  100       $GVINB    H      Weight 12.4
     C           $GJXX6    DIV  100       $GVJNB    H      Weight 12.5
      * Calculating Dec's Weight
      * CUR.Current Dec Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 12.1           SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 12.2           SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 12.3           SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 12.4           SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 12.5           SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GUFNB    ADD  $GJXX3    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GJXX4    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GJXX5    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GJXX6    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GVYNB           Current Dec Wei
     C           $GJXX8    DIV  100       $GVZNB    H      Last Dec Weight
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NESUBR    BEGSR
      *================================================================
      * Weight Loads
      *================================================================
     C           $GUFNB    DIV  P2RSNB    $GVFNB    H      Weight 12.1
     C           $GJXX3    DIV  P2RSNB    $GVGNB    H      Weight 12.2
     C           $GJXX4    DIV  P2RSNB    $GVHNB    H      Weight 12.3
     C           $GJXX5    DIV  P2RSNB    $GVINB    H      Weight 12.4
     C           $GJXX6    DIV  P2RSNB    $GVJNB    H      Weight 12.5
      * Calculating Dec's Weight
      * CUR.Current Dec Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 12.1           USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 12.2           USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 12.3           USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 12.4           USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 12.5           USR
     C           $GVFNB    ADD  $GVGNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GVHNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GVINB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GVJNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GVYNB           Current Dec Wei
     C           $GJXX8    DIV  P2RSNB    $GVZNB    H      Last Dec Weight
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Sales Ton Report   PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Sales Ton Report   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP1AIC3    $CAIC3           Company Number
     C                     MOVELP5ORTX    $CORTX           TXT MM/YY
     C                     MOVELP1B5SX    $CB5SX           Print Yes/No
     C                     MOVELP2EZTX    $CEZTX           USR Work Field
     C                     Z-ADDP1BTC7    $CBTC7           Parent Customer
     C                     Z-ADDP1ANC7    $CANC7           A/R Customer Nu
     C                     Z-ADDP1BKC7    $CBKC7           Ship To Custome
     C                     MOVELP1X3CD    $CX3CD           Territory Code
     C                     MOVELP1R4CD    $CR4CD           Sales Route Cod
      * Company
      * CASE: PAR.Company Number is Equal to zero
     C           P1AIC3    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    $CAPTX           Company Name
     C                     MOVEL@CN,01    $CAPTX           Company Name
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Company Name Only  RT - Company Name and Address  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
      * Parent Customer
      * CASE: PAR.Parent Customer is equal to zero
     C           P1BTC7    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    $CADTX           Name
     C                     MOVEL@CN,02    $CADTX           Name
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Name Only          RT - Customer  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
      * A/R Customer Number
      * CASE: PAR.A/R Customer Number is equal to zero
     C           P1ANC7    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    $CAQTX           A/R Customer Na
     C                     MOVEL@CN,03    $CAQTX           A/R Customer Na
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1ANC7    WL0003           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    $CAQTX    P      Customer Name
     C                     END                             *FI
      * Ship To Customer
      * CASE: PAR.Ship To Customer is equal to zero
     C           P1BKC7    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    $CUWTX           Ship To Name
     C                     MOVEL@CN,04    $CUWTX           Ship To Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CUWTX           Ship To Name
      * Ship To Name          DRV
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CBKC7    WL0003           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    $CUWTX    P      Customer Name
     C                     END                             *FI
      * Sales Route Code
      * CASE: PAR.Sales Route Code is *All
     C           P1R4CD    IFEQ 'ALL'                      *IF
     C                     MOVEL*BLANK    $CR4CD           Sales Route Cod
     C                     MOVEL*BLANK    $CMZNA           Sales Route Des
     C                     MOVEL@CN,05    $CMZNA           Sales Route Des
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Description        RT - PD Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1R4CD    WL0005    P      Sales Route Cod
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    $CMZNA    P      Sales Route Des
     C                     END                             *FI
      * Territory Code
      * CASE: PAR.Territory Code is *All
     C           P1X3CD    IFEQ '*ALL'                     *IF
     C                     MOVEL*BLANK    $CX3CD           Territory Code
     C                     MOVEL*BLANK    $COKNA           Territory Descr
     C                     MOVEL@CN,06    $COKNA           Territory Descr
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV All                RT - Territory  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1X3CD    WL0007    P      Territory Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    $COKNA    P      Territory Descr
     C                     MOVELWL0009    YL0001    P      TER Unused Sts
     C                     MOVELWL0010    YL0002    P      TER Unused Sts
     C                     MOVELWL0011    YL0003    P      TER Unused Sts
     C                     MOVELWL0012    YL0004    P      TER Unused Sts
     C                     MOVELWL0013    YL0005    P      Regional Salesp
     C                     END                             *FI
     C                     MOVELP5ORTX    $CORTX           TXT MM/YY
      * 1PG.USR Work Field 5A     USR = Condition name of PAR.Sale Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1524139   Y2LSNO  70       List number
     C                     PARM P1DASX    W0INVL 25        Sale Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $COLTX    PARM           W0CNNM 25        USR Work Field
      *
      * 1PG.USR Work Field 7A = Condition name of PAR.Report Type Both
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1524143   Y2LSNO  70       List number
     C                     PARM P1DBSX    W0INVL 25        Report Type Bot
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CE2TX    PARM           W0CNNM 25        USR Work Field
      *
      * 1PG.USR Work Field 3A = Condition name of 1PG.Print Yes/No
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1518948   Y2LSNO  70       List number
     C                     PARM $CB5SX    W0INVL 25        Print Yes/No
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CEZTX    PARM           W0CNNM 25        USR Work Field
      *
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $CAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$CAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Parent Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CBTC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CBTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCBTC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCBTC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert A/R Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CANC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCANC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCANC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCBKC7           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$C1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of PRT Sales Ton Report   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Parent Customer of PRT Sales Ton Report   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print A/R Customer Number of PRT Sales Ton Report   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * USER: On print of A/R Customer Number format
     C                     MOVEL'N'       WUB5SX           Print Yes/No
      * Mention hidden format
     C   99N99             WRITE$EKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Sales Route Code of PRT Sales Ton Report   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Detail line. of PRT Sales Ton Report   PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * USER: On print of detail format
     C                     MOVEL'N'       W0PFM            *Print format
      * Mention hidden format
     C   99N99             WRITE$FDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Sales Ton Report   PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  13        W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Sales Ton Report   PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Parent Customer of PRT Sales Ton Report   PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * A/R Customer Number of PRT Sales Ton Report   PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Sales Route Code of PRT Sales Ton Report   PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Sales Ton Report   PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     MOVELP5ORTX    $BORTX           TXT MM/YY
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Load State/Territory *Arr - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL*BLANK    ACBGCD           State Code
      * Establish starting position
     C           KPSSC     SETLL@ACREAH                    *
     C                     READ @ACREAH                  90*
      * Data record not found
     C   90                MOVEL'USR0005' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Territory using St RT - Territory State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELACBGCD    WL0001    P      State Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUX3CD    P      Territory Code
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Load State/Territory   CO - *Arrays  * 
     C                     EXSR SECRRC
     C                     END                             *FI
     C                     READ @ACREAH                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Territory using St RT - Territory State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN LWBGCD    WQSD01           State Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           State Code
      * Setup key
     C                     MOVELWL0001    WQSD01           State Code
      * Establish starting position
     C           KRSSD     SETLL@LWRERM                    *
     C           KRSSD     READE@LWRERM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2583' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT                     *QUIT
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLWX3CD    WL0002           Territory Code
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@LWRERM                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Load State/Territory   CO - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Array full, cannot add any more elements
     C           YL01      IFEQ 100
     C                     MOVEL'Y2U0036' W0RTN   7
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     MOVEL*BLANK    XABGCD           State Code
     C                     MOVEL*BLANK    XAX3CD           Territory Code
      * Move all fields to Territory/State
     C                     MOVELACBGCD    XABGCD           State Code
     C                     MOVELWUX3CD    XAX3CD           Territory Code
      *
      * Move key fields to Territory/State
     C                     MOVELXABGCD    YI0101           State Code
      *
      * Check for duplicate primary key
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFEQ XABGCD
      * Array element already exists
     C                     MOVEL'Y2U0003' W0RTN   7
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Insert after last used element
     C           YL01      ADD  1         Y       50
      * Check if element was a previously deleted element
     C           YK01,Y    IFNE *HIVAL
      * If so, reuse MODS index
     C                     MOVELYK01,Y    YD01
     C                     ELSE
      * If not, use element number as MODS index
     C                     Z-ADDY         YI01
     C                     ENDIF
      *
      * Create(insert) new element
      * Move key fields to Territory/State
     C                     MOVELXABGCD    YI0101           State Code
      *
     C                     MOVELYD01      YK01,Y
     C           YI01      OCUR YM01
      * Update MODS fields
     C                     MOVELXABGCD    WABGCD           State Code
     C                     MOVELXAX3CD    WAX3CD           Territory Code
      * Only sort if element is out of position
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR01      IFGT 0
     C           YR01      ANDLE100
     C           YK01,YR01 ANDGTYD01
     C                     ADD  1         YR01    50
     C                     ENDIF
      * Sort array to place element in correct position
     C                     SORTAYK01
     C                     ENDIF
      * Adjust number of elements currently in array
     C                     ADD  1         YL01
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Company Name Only  RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSF     CHAIN@ABREAK              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $CAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Name Only          RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1BTC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $CADTX           Customer Name
     C                     GOTO SGEXIT                     *QUIT
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    $CADTX           Customer Name
     C                     GOTO SGEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0003    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    WL0004           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Description        RT - PD Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELWL0005    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSI     CHAIN@JEREWF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Sales Route Des
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEMZNA    WL0006           Sales Route Des
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV All                RT - Territory  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           LVX3CD           Territory Code
      * Setup key
     C                     MOVELWL0007    LVX3CD           Territory Code
      * Establish starting position
     C           KRSSJ     CHAIN@LVREQ7              90    *
      * Data record not found
     C   90                MOVEL'USR2581' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLVOKNA    WL0008           Territory Descr
     C                     MOVELLVS1SX    WL0009           TER Unused Sts
     C                     MOVELLVS2SX    WL0010           TER Unused Sts
     C                     MOVELLVS3SX    WL0011           TER Unused Sts
     C                     MOVELLVS4SX    WL0012           TER Unused Sts
     C                     MOVELLVFQAA    WL0013           Regional Salesp
     C                     GOTO SJEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV All fields - Company/Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0014    EOAIC3           Company Number
     C                     Z-ADDWL0015    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELEOAQCD    WL0016           Terms Code
     C                     MOVELEOR4CD    WL0017           Sales Route Cod
     C                     MOVELEOBYNA    WL0018           Special Instruc
     C                     MOVELEOB6NA    WL0019           Special Instruc
     C                     MOVELEOBZNA    WL0020           Carrier Code
     C                     MOVELEOLLST    WL0021           Broker
     C                     MOVELEOPPST    WL0022           P.O. Required F
     C                     Z-ADDEOR5NB    WL0023           Deliver after t
     C                     Z-ADDEOR6NB    WL0024           Deliver before
     C                     MOVELEOQGST    WL0025           Alt Remittance
     C                     MOVELEOBOCD    WL0026           Type Code
     C                     Z-ADDEOTBNB    WL0027           Absorbed Freigh
     C                     Z-ADDEOMTCU    WL0028           Mileage To Cust
     C                     Z-ADDEOW2NB    WL0029           Freight Overate
     C                     MOVELEORPCD    WL0030           Age Code
     C                     MOVELEOAJCD    WL0031           Warehouse Code
     C                     MOVELEOX9ST    WL0032           Outside Warehou
     C                     MOVELEOT9CD    WL0033           Customer Group
     C                     MOVELEOUBCD    WL0034           Customer Group
     C                     MOVELEOISTX    WL0035           G/L Code
     C                     MOVELEOLQCD    WL0036           Commodity Marke
     C                     MOVELEONJNA    WL0037           Credit Contact
     C                     MOVELEOI0TX    WL0038           Credit Contact
     C                     MOVELEONKNA    WL0039           Credit Contact
     C                     MOVELEOI1TX    WL0040           Credit Contact
     C                     MOVELEOVLST    WL0041           Allow Man/Qt WO
     C                     MOVELEORLST    WL0042           Fax Invoice Fla
     C                     MOVELEOMMTX    WL0043           Fax Invoice Fax
     C                     MOVELEOOHNA    WL0044           Fax Invoice Con
     C                     MOVELEOQ6ST    WL0045           Distributor
     C                     MOVELEOQ8ST    WL0046           Default Shippin
     C                     MOVELEORBST    WL0047           Unused Co/Cust
     C                     MOVELEOREST    WL0048           Unused Co/Cust
     C                     MOVELEOUVST    WL0049           EDI Status 1
     C                     MOVELEOUWST    WL0050           EDI Status 2
     C                     MOVELEOUXST    WL0051           EDI Status 3
     C                     MOVELEOVSST    WL0052           Record Status
     C                     Z-ADDEOAATM    WL0053           Job Time
     C                     MOVELEOAYNA    WL0054           User Id
     C                     MOVELEOA0NA    WL0055           Job Name
     C                     Z-ADDEOAXDT    WL0056           Job Date
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV State/Territory    RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C           YL01      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * Initialize internal index
     C                     MOVEL*LOVAL    YD01
      * Move key fields to Territory/State
     C                     MOVELF4RJCD    YI0101           State Code
      *
      * Only search if key is not beyond range of current elements
     C           YK01,YL01 IFGT YD01
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE F4RJCD
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT                     *QUIT
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '1'
     C           YI01      OCUR YM01
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAX3CD    WUX3CD           Territory Code
     C                     GOTO SLEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - OP Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           EXJNCD           Order Type - Sa
      * Setup key
     C                     MOVELF4JNCD    EXJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSM     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEXOBST    WUOBST           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Check Existence    RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0057    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSN     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Name.Address,Fax   RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0058    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSO     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0059           Customer Name
     C                     MOVEL*BLANK    WL0060           Address Line 1
     C                     MOVEL*BLANK    WL0061           Address Line 2
     C                     MOVEL*BLANK    WL0062           City
     C                     MOVEL*BLANK    WL0063           State Code
     C                     MOVEL*BLANK    WL0064           Zip/Postal Code
     C                     MOVEL*BLANK    WL0065           Fax Number FF
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    WL0059           Customer Name
     C                     MOVELBBACNA    WL0060           Address Line 1
     C                     MOVELBBADNA    WL0061           Address Line 2
     C                     MOVELBBAJNA    WL0062           City
     C                     MOVELBBBGCD    WL0063           State Code
     C                     MOVELBBBTTX    WL0064           Zip/Postal Code
     C                     MOVELBBBWTX    WL0065           Fax Number FF
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Type Code Desc.    RT - Type Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           AJBOCD           Type Code
      * Setup key
     C                     MOVELP4BOCD    AJBOCD           Type Code
      * Establish starting position
     C           KRSSP     CHAIN@AJREBR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0026' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $GAUNA           Description
     C                     MOVEL*BLANK    WUG0TX           Record Status
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAJAUNA    $GAUNA           Description
     C                     MOVELAJVSST    WUG0TX           Record Status
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Truck Size         RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVE *BLANK    FKRONB           Truck Size
     C                     MOVEL'S'       FKRONB           Truck Size
      * Establish starting position
     C           KRSSQ     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P2RSNB           Maximum pounds
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFKRSNB    P2RSNB           Maximum pounds
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Get Current Year & Month.
      *================================================================
      * PAR.Current Year  USR = JOB.*Job date *YEAR
     C           ##JDT     ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    P5I0NX
      * PAR.Current Month USR = JOB.*Job date *MONTH
     C           ##JDT     ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    P5I1NX
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Determine Comparison Dates.
      *================================================================
      * PAR.This Month  (MM) USR = PAR.Date - ATR *MONTH
     C           P1MUDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    P5I4NX
      * PAR.This Year (YYYY) USR = PAR.Date - ATR *YEAR
     C           P1MUDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    P5I3NX
     C           P5I3NX    SUB  1         P5I2NX           Last Year (YYYY
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Format Heading Year (Example: '98)
      *================================================================
      * Last Year
     C                     MOVELP5I2NX    P5T9TX           Year Alpha (YYY
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP5T9TX:ZQ P5UATX    P  90  Year Alpha (YY)
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           ''''      CAT  P5UATX:ZQ P2NHTX    P      Alpha Zeroes 3
      * This Year
     C                     MOVELP5I3NX    P5T9TX           Year Alpha (YYY
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP5T9TX:ZQ P5UATX    P  90  Year Alpha (YY)
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           ''''      CAT  P5UATX:ZQ P2EZTX    P      USR Work Field
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Format Heading "MM/YY".
      *================================================================
      * PAR.Year  NBR USR = PAR.Date - ATR *YEAR
     C           P1MUDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    P5I8NX
      * PAR.Month NBR USR = PAR.Date - ATR *MONTH
     C           P1MUDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    P5I9NX
     C                     MOVELP5I9NX    P5ONTX           TXT Month Numbe
     C                     MOVELP5I8NX    P5OPTX           TXT Year Number
     C                     Z-ADD*ZERO     ZQ      50
     C           P5ONTX    CAT  '/':ZQ    P5ORTX    P      TXT MM/YY
     C                     Z-ADD*ZERO     ZQ      50
     C           P5ORTX    CAT  P5OPTX:ZQ P5ORTX    P      TXT MM/YY
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * This Year.
      *================================================================
      * January
      * CASE: January of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is January
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 01                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE: Week 1
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GO1NB           Weight 1.1
     C                     END                             *FI
      * Week 2
      * CASE: Week 2
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GO3NB           Weight 1.2
     C                     END                             *FI
      * Week 3
      * CASE: Week 3
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GO4NB           Weight 1.3
     C                     END                             *FI
      * Week 4
      * CASE: Week 4
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GO5NB           Weight 1.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GO7NB           Weight 1.5
     C                     END                             *FI
     C                     END                             *FI
      * February
      * CASE: February of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is February
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 02                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GO8NB           Weight 2.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GO9NB           Weight 2.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GPANB           Weight 2.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GPBNB           Weight 2.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GPCNB           Weight 2.5
     C                     END                             *FI
     C                     END                             *FI
      * March
      * CASE: March of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is March
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 03                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GPDNB           Weight 3.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GPENB           Weight 3.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $G               Weight 3.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJETI           Weight 3.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GJTII           Weight 3.5
     C                     END                             *FI
     C                     END                             *FI
      * April
      * CASE: April of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is April
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 04                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJTIV           Weight 4.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJETV           Weight 4.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJTVI           Weight 4.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJVII           Weight 4.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GQNNB           Weight 4.5
     C                     END                             *FI
     C                     END                             *FI
      * May
      * CASE: May of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is May
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 05                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GRENB           Weight 5.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GRJNB           Weight 5.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJTIX           Weight 5.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJTXI           Weight 5.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GRYNB           Weight 5.5
     C                     END                             *FI
     C                     END                             *FI
      * June
      * CASE: June of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is June
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 06                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GR2NB           Weight 6.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJXII           Weight 6.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GXIII           Weight 6.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJXIV           Weight 6.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GJTXV           Weight 6.5
     C                     END                             *FI
     C                     END                             *FI
      * July
      * CASE: July of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is July
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 07                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GSVNB           Weight 7.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GSWNB           Weight 7.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJXVI           Weight 7.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GS3NB           Weight 7.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GS4NB           Weight 7.5
     C                     END                             *FI
     C                     END                             *FI
      * August
      * CASE: August of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is August
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 08                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GVIII           Weight 8.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GQUNB           Weight 8.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GQVNB           Weight 8.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GQYNB           Weight 8.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GQZNB           Weight 8.5
     C                     END                             *FI
     C                     END                             *FI
      * September
      * CASE: September of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is September
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 09                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GSONB           Weight 9.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GSPNB           Weight 9.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GSSNB           Weight 9.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GSTNB           Weight 9.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GSUNB           Weight 9.5
     C                     END                             *FI
     C                     END                             *FI
      * October
      * CASE: October of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is October
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 10                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GTUNB           Weight 10.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GTXNB           Weight 10.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GTYNB           Weight 10.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GTZNB           Weight 10.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GT2NB           Weight 10.5
     C                     END                             *FI
     C                     END                             *FI
      * November
      * CASE: November of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is November
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 11                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GT6NB           Weight 11.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GT7NB           Weight 11.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GT8NB           Weight 11.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GUANB           Weight 11.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GUBNB           Weight 11.5
     C                     END                             *FI
     C                     END                             *FI
      * December
      * CASE: December of Current Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is December
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.This Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 12                         *IF
     C           P5I6NX    IFEQ P5I3NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
      * Week 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 1
      *   |- c2    : PAR.Actual Shipped Day USR is LE 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 1                          *IF
     C           P5I7NX    IFLE 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GUFNB           Weight 12.1
     C                     END                             *FI
      * Week 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 8
      *   |- c2    : PAR.Actual Shipped Day USR is LE 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 8                          *IF
     C           P5I7NX    IFLE 14                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJXX3           Weight 12.2
     C                     END                             *FI
      * Week 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 15
      *   |- c2    : PAR.Actual Shipped Day USR is LE 21
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 15                         *IF
     C           P5I7NX    IFLE 21                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJXX4           Weight 12.3
     C                     END                             *FI
      * Week 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Day USR is GE 22
      *   |- c2    : PAR.Actual Shipped Day USR is LE 28
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I7NX    IFGE 22                         *IF
     C           P5I7NX    IFLE 28                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJXX5           Weight 12.4
     C                     END                             *FI
      * Week 5
      * CASE: PAR.Actual Shipped Day USR is GE 29
     C           P5I7NX    IFGE 29                         *IF
     C                     ADD  F4BYWG    $GJXX6           Weight 12.5
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Last Year.
      *================================================================
      * Last January
      * CASE: PAR.This Month  (MM) USR is >= January
     C           P5I4NX    IFGE 1                          *IF
      * Last January
      * CASE: January of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is January
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 01                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GVLNB           Last Jan Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last February
      * CASE: PAR.This Month  (MM) USR is >= February
     C           P5I4NX    IFGE 2                          *IF
      * Last February
      * CASE: February of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is February
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 02                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GV1NB           Last Feb Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last March
      * CASE: PAR.This Month  (MM) USR is >= March
     C           P5I4NX    IFGE 3                          *IF
      * Last March
      * CASE: March of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is March
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 03                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GV3NB           Last Mar Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last April
      * CASE: PAR.This Month  (MM) USR is >= April
     C           P5I4NX    IFGE 4                          *IF
      * Last April
      * CASE: April of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is April
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 04                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GWSNB           Last Apr Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last May
      * CASE: PAR.This Month  (MM) USR is >= May
     C           P5I4NX    IFGE 5                          *IF
      * Last May
      * CASE: May of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is May
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 05                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GWXNB           Last May Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last June
      * CASE: PAR.This Month  (MM) USR is >= June
     C           P5I4NX    IFGE 6                          *IF
      * Last June
      * CASE: June of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is June
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 06                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GV4NB           Last Jun Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last July
      * CASE: PAR.This Month  (MM) USR is >= July
     C           P5I4NX    IFGE 7                          *IF
      * Last July
      * CASE: July of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is July
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 07                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GV7NB           Last Jul Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last August
      * CASE: PAR.This Month  (MM) USR is >= August
     C           P5I4NX    IFGE 8                          *IF
      * Last August
      * CASE: August of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is August
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 08                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GV8NB           Last Aug Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last September
      * CASE: PAR.This Month  (MM) USR is >= September
     C           P5I4NX    IFGE 9                          *IF
      * Last September
      * CASE: September of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is September
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 09                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GWDNB           Last Sep Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last October
      * CASE: PAR.This Month  (MM) USR is >= October
     C           P5I4NX    IFGE 10                         *IF
      * Last October
      * CASE: October of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is October
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 10                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJXXX           Last Oct Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last November
      * CASE: PAR.This Month  (MM) USR is >= November
     C           P5I4NX    IFGE 11                         *IF
      * Last November
      * CASE: November of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is November
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 11                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJXX9           Last Nov Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last December
      * CASE: PAR.This Month  (MM) USR is >= December
     C           P5I4NX    IFGE 12                         *IF
      * Last December
      * CASE: December of Last Year
      *  - c1 AND c2
      *   |- c1    : PAR.Actual Shipped Month USR is December
      *   |- c2    : PAR.Actual Shipped Year USR EQ PAR.Last Year (YYYY)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5I5NX    IFEQ 12                         *IF
     C           P5I6NX    IFEQ P5I2NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  F4BYWG    $GJXX8           Last Dec Weight
      * CASE: DB1.Weight Billed is Equal to zero
     C           F4BYWG    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUB5SX           Print Yes/No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Print Headers
      *================================================================
     C                     MOVELP2YGCD    $GR4CD           Sales Route Cod
      * RTV Description        RT - PD Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$GR4CD    WL0005    P      Sales Route Cod
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    $GALTX    P      Sales Route Des
     C                     MOVELP4BOCD    $GBOCD           Type Code
      * RTV Type Code Desc.    RT - Type Codes  * 
     C                     EXSR SPRVGN
     C                     Z-ADDP5I3NX    $GESNB           Accounting Year
     C                     Z-ADDP5I2NX    $GE8NB           USR Accounting
     C                     MOVELP2NHTX    $GNHTX           Alpha Zeroes 3
     C                     MOVELP2EZTX    $GEZTX           USR Work Field
      * CASE: PAR.A/R Customer Number is not equal to zero
     C           P1ANC7    IFNE *ZERO                      *IF
     C                     Z-ADDP1ANC7    $GBTC7           Parent Customer
     C                     END                             *FI
      * RTV Name.Address,Fax   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GBTC7    WL0058           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0059    $GPHTX    P      Customer Name
     C                     MOVELWL0060    WUG0TX    P      Address Line 1
     C                     MOVELWL0061    WUG0TX    P      Address Line 2
     C                     MOVELWL0062    $GAJNA    P      City
     C                     MOVELWL0063    P2BGCD    P      State Code
     C                     MOVELWL0064    WUG0TX    P      Zip/Postal Code
     C                     MOVELWL0065    WUG0TX    P      Fax Number FF
     C                     MOVELP2BGCD    $GEINA           State
      * RTV Territory using St RT - Territory State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2BGCD    WL0001    P      State Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $GX3CD    P      Territory Code
      * RTV All                RT - Territory  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$GX3CD    WL0007    P      Territory Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    $GOKNA    P      Territory Descr
     C                     MOVELWL0009    YL0001    P      TER Unused Sts
     C                     MOVELWL0010    YL0002    P      TER Unused Sts
     C                     MOVELWL0011    YL0003    P      TER Unused Sts
     C                     MOVELWL0012    YL0004    P      TER Unused Sts
     C                     MOVELWL0013    YL0005    P      Regional Salesp
      * CASE: PAR.Sale Type             USR is CWT
     C           P1DASX    IFEQ 'C'                        *IF
     C                     MOVEL'  CWT'   $GOLTX           USR Work Field
     C                     ELSE
      * CASE: *OTHERWISE
      * CUR.USR Work Field 5A     USR = Condition name of PAR.Sale Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1524139   Y2LSNO  70       List number
     C                     PARM P1DASX    W0INVL 25        Sale Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $GOLTX    PARM           W0CNNM 25        USR Work Field
      *
     C                     END                             *FI
     C                     MOVEL$GOLTX    $GSATX           USR Work Field
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * CWT Weight
      *================================================================
     C           $GO1NB    DIV  100       $GLWNB    H      Weight 1.1
     C           $GO3NB    DIV  100       $GLXNB    H      Weight 1.2
     C           $GO4NB    DIV  100       $GLYNB    H      Weight 1.3
     C           $GO5NB    DIV  100       $GL1NB    H      Weight 1.4
     C           $GO7NB    DIV  100       $GL4NB    H      Weight 1.5
      * Calculating Jan's Weight
      * CUR.Current Jan Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 1.1            SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 1.2            SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 1.3            SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 1.4            SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 1.5            SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GO1NB    ADD  $GO3NB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GO4NB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GO5NB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GO7NB    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GVRNB           Current Jan Wei
     C           $GVLNB    DIV  100       $GJXX7    H      Last Jan Weight
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Loads Weight
      *================================================================
     C           $GO1NB    DIV  P2RSNB    $GLWNB    H      Weight 1.1
     C           $GO3NB    DIV  P2RSNB    $GLXNB    H      Weight 1.2
     C           $GO4NB    DIV  P2RSNB    $GLYNB    H      Weight 1.3
     C           $GO5NB    DIV  P2RSNB    $GL1NB    H      Weight 1.4
     C           $GO7NB    DIV  P2RSNB    $GL4NB    H      Weight 1.5
      * Calculating Jan's Weight
      * CUR.Current Jan Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 1.1             .U
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 1.2             .U
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 1.3             .U
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 1.4             .U
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 1.5             .U
     C           $GLWNB    ADD  $GLXNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GLYNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GL1NB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GL4NB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GVRNB           Current Jan Wei
     C           $GVLNB    DIV  P2RSNB    $GJXX7    H      Last Jan Weight
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * CWT Weight
      *================================================================
     C           $GO8NB    DIV  100       $GMDNB    H      Weight 2.1
     C           $GO9NB    DIV  100       $GMENB    H      Weight 2.2
     C           $GPANB    DIV  100       $GMGNB    H      Weight 2.3
     C           $GPBNB    DIV  100       $GMINB    H      Weight 2.4
     C           $GPCNB    DIV  100       $GMLNB    H      Weight 2.5
      * Calculating Feb's Weight
      * CUR.Current Feb Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 2.1            SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 2.2            SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 2.3            SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 2.4            SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 2.5            SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GO8NB    ADD  $GO9NB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GPANB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GPBNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GPCNB    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GWZNB           Current Feb Wei
     C           $GV1NB    DIV  100       $GXHNB    H      Last Feb Weight
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Load Weight
      *================================================================
     C           $GO8NB    DIV  P2RSNB    $GMDNB    H      Weight 2.1
     C           $GO9NB    DIV  P2RSNB    $GMENB    H      Weight 2.2
     C           $GPANB    DIV  P2RSNB    $GMGNB    H      Weight 2.3
     C           $GPBNB    DIV  P2RSNB    $GMINB    H      Weight 2.4
     C           $GPCNB    DIV  P2RSNB    $GMLNB    H      Weight 2.5
      * Calculating Feb's Weight
      * CUR.Current Feb Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 2.1             .U
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 2.2             .U
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 2.3             .U
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 2.4             .U
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 2.5             .U
     C           $GMDNB    ADD  $GMENB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GMGNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GMINB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GMLNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GWZNB           Current Feb Wei
     C           $GV1NB    DIV  P2RSNB    $GXHNB    H      Last Feb Weight
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * CWT Weight
      *================================================================
     C           $GPDNB    DIV  100       $GMVNB    H      Weight 3.1
     C           $GPENB    DIV  100       $GMWNB    H      Weight 3.2
     C           $G        DIV  100       $GMYNB    H      Weight 3.3
     C           $GJETI    DIV  100       $GMZNB    H      Weight 3.4
     C           $GJTII    DIV  100       $GM2NB    H      Weight 3.5
      * Calculating Mar's Weight
      * CUR.Current Mar Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 3.1            SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 3.2            SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 3.3            SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 3.4            SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 3.5            SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GPDNB    ADD  $GPENB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $G        W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GJETI    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GJTII    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GW3NB           Current Mar Wei
     C           $GV3NB    DIV  100       $GXINB    H      Last Mar Weight
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Loads Weight
      *================================================================
     C           $GPDNB    DIV  P2RSNB    $GMVNB    H      Weight 3.1
     C           $GPENB    DIV  P2RSNB    $GMWNB    H      Weight 3.2
     C           $G        DIV  P2RSNB    $GMYNB    H      Weight 3.3
     C           $GJETI    DIV  P2RSNB    $GMZNB    H      Weight 3.4
     C           $GJTII    DIV  P2RSNB    $GM2NB    H      Weight 3.5
      * Calculating Mar's Weight
      * CUR.Current Mar Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 3.1             .U
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 3.2             .U
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 3.3             .U
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 3.4             .U
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 3.5             .U
     C           $GMVNB    ADD  $GMWNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GMYNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GMZNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GM2NB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GW3NB           Current Mar Wei
     C           $GV3NB    DIV  P2RSNB    $GXINB    H      Last Mar Weight
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * CWT Weight
      *================================================================
     C           $GJTIV    DIV  100       $GJIII    H      Weight 4.1
     C           $GJETV    DIV  100       $GNFNB    H      Weight 4.2
     C           $GJTVI    DIV  100       $GNHNB    H      Weight 4.3
     C           $GJVII    DIV  100       $GNKNB    H      Weight 4.4
     C           $GQNNB    DIV  100       $GNMNB    H      Weight 4.5
      * Calculating Apr's Weight
      * CUR.Current Apr Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 4.1            SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 4.2            SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 4.3            SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 4.4            SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 4.5            SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GJTIV    ADD  $GJETV    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GJTVI    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GJVII    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GQNNB    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GW6NB           Current Apr Wei
     C           $GWSNB    DIV  100       $GXJNB    H      Last Apr Weight
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Loads Weight
      *================================================================
     C           $GJTIV    DIV  P2RSNB    $GJIII    H      Weight 4.1
     C           $GJETV    DIV  P2RSNB    $GNFNB    H      Weight 4.2
     C           $GJTVI    DIV  P2RSNB    $GNHNB    H      Weight 4.3
     C           $GJVII    DIV  P2RSNB    $GNKNB    H      Weight 4.4
     C           $GQNNB    DIV  P2RSNB    $GNMNB    H      Weight 4.5
      * Calculating Apr's Weight
      * CUR.Current Apr Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 4.1             .U
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 4.2             .U
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 4.3             .U
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 4.4             .U
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 4.5             .U
     C           $GJIII    ADD  $GNFNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GNHNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GNKNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GNMNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GW6NB           Current Apr Wei
     C           $GWSNB    DIV  P2RSNB    $GXJNB    H      Last Apr Weight
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * CWT Weight
      *================================================================
     C           $GRENB    DIV  100       $GNRNB    H      Weight 5.1
     C           $GRJNB    DIV  100       $GNSNB    H      Weight 5.2
     C           $GJTIX    DIV  100       $GNUNB    H      Weight 5.3
     C           $GJTXI    DIV  100       $GNVNB    H      Weight 5.4
     C           $GRYNB    DIV  100       $GNWNB    H      Weight 5.5
      * Calculating May's Weight
      * CUR.Current May Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 5.1            SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 5.2            SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 5.3            SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 5.4            SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 5.5            SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GRENB    ADD  $GRJNB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GJTIX    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GJTXI    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GRYNB    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GW7NB           Current May Wei
     C           $GWXNB    DIV  100       $GXKNB    H      Last May Weight
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Loads Weight
      *================================================================
     C           $GRENB    DIV  P2RSNB    $GNRNB    H      Weight 5.1
     C           $GRJNB    DIV  P2RSNB    $GNSNB    H      Weight 5.2
     C           $GJTIX    DIV  P2RSNB    $GNUNB    H      Weight 5.3
     C           $GJTXI    DIV  P2RSNB    $GNVNB    H      Weight 5.4
     C           $GRYNB    DIV  P2RSNB    $GNWNB    H      Weight 5.5
      * Calculating May's Weight
      * CUR.Current May Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 5.1             .U
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 5.2             .U
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 5.3             .U
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 5.4             .U
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 5.5             .U
     C           $GNRNB    ADD  $GNSNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GNUNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GNVNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GNWNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GW7NB           Current May Wei
     C           $GWXNB    DIV  P2RSNB    $GXKNB    H      Last May Weight
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * CWT Weight
      *================================================================
     C           $GR2NB    DIV  100       $GN0NB    H      Weight 6.1
     C           $GJXII    DIV  100       $GN1NB    H      Weight 6.2
     C           $GXIII    DIV  100       $GN3NB    H      Weight 6.3
     C           $GJXIV    DIV  100       $GN4NB    H      Weight 6.4
     C           $GJTXV    DIV  100       $GN5NB    H      Weight 6.5
      * Calculating Jun's Weight
      * CUR.Current Jun Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 6.1            SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 6.2            SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 6.3            SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 6.4            SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 6.5            SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GR2NB    ADD  $GJXII    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GXIII    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GJXIV    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GJTXV    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GW8NB           Current Jun Wei
     C           $GV4NB    DIV  100       $GXLNB    H      Last Jun Weight
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Loads Weight
      *================================================================
     C           $GR2NB    DIV  P2RSNB    $GN0NB    H      Weight 6.1
     C           $GJXII    DIV  P2RSNB    $GN1NB    H      Weight 6.2
     C           $GXIII    DIV  P2RSNB    $GN3NB    H      Weight 6.3
     C           $GJXIV    DIV  P2RSNB    $GN4NB    H      Weight 6.4
     C           $GJTXV    DIV  P2RSNB    $GN5NB    H      Weight 6.5
      * Calculating Jun's Weight
      * CUR.Current Jun Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 6.1             .U
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 6.2             .U
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 6.3             .U
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 6.4             .U
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 6.5             .U
     C           $GN0NB    ADD  $GN1NB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GN3NB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GN4NB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GN5NB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GW8NB           Current Jun Wei
     C           $GV4NB    DIV  P2RSNB    $GXLNB    H      Last Jun Weight
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * CWT Weight
      *================================================================
     C           $GSVNB    DIV  100       $GOBNB    H      Weight 7.1
     C           $GSWNB    DIV  100       $GOENB    H      Weight 7.2
     C           $GJXVI    DIV  100       $GOFNB    H      Weight 7.3
     C           $GS3NB    DIV  100       $GOGNB    H      Weight 7.4
     C           $GS4NB    DIV  100       $GOHNB    H      Weight 7.5
      * Calculating Jul's Weight
      * CUR.Current Jul Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 7.1            SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 7.2            SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 7.3            SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 7.4            SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 7.5            SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GSVNB    ADD  $GSWNB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GJXVI    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GS3NB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GS4NB    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GW9NB           Current Jul Wei
     C           $GV7NB    DIV  100       $GXMNB    H      Last Jul Weight
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Load Weight
      *================================================================
     C           $GSVNB    DIV  P2RSNB    $GOBNB    H      Weight 7.1
     C           $GSWNB    DIV  P2RSNB    $GOENB    H      Weight 7.2
     C           $GJXVI    DIV  P2RSNB    $GOFNB    H      Weight 7.3
     C           $GS3NB    DIV  P2RSNB    $GOGNB    H      Weight 7.4
     C           $GS4NB    DIV  P2RSNB    $GOHNB    H      Weight 7.5
      * Calculating Jul's Weight
      * CUR.Current Jul Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 7.1             .U
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 7.2             .U
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 7.3             .U
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 7.4             .U
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 7.5             .U
     C           $GOBNB    ADD  $GOENB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GOFNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GOGNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GOHNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GW9NB           Current Jul Wei
     C           $GV7NB    DIV  P2RSNB    $GXMNB    H      Last Jul Weight
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * CWT Loads
      *================================================================
     C           $GVIII    DIV  100       $GQ3NB    H      Weight 8.1
     C           $GQUNB    DIV  100       $GQ4NB    H      Weight 8.2
     C           $GQVNB    DIV  100       $GQ5NB    H      Weight 8.3
     C           $GQYNB    DIV  100       $GRANB    H      Weight 8.4
     C           $GQZNB    DIV  100       $GRBNB    H      Weight 8.5
      * Calculating Aug's Weight
      * CUR.Current Aug Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 8.1            SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 8.2            SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 8.3            SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 8.4            SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 8.5            SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GVIII    ADD  $GQUNB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GQVNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GQYNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GQZNB    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GXANB           Current Aug Wei
     C           $GV8NB    DIV  100       $GXONB    H      Last Aug Weight
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Weight Loads
      *================================================================
     C           $GVIII    DIV  P2RSNB    $GQ3NB    H      Weight 8.1
     C           $GQUNB    DIV  P2RSNB    $GQ4NB    H      Weight 8.2
     C           $GQVNB    DIV  P2RSNB    $GQ5NB    H      Weight 8.3
     C           $GQYNB    DIV  P2RSNB    $GRANB    H      Weight 8.4
     C           $GQZNB    DIV  P2RSNB    $GRBNB    H      Weight 8.5
      * Calculating Aug's Weight
      * CUR.Current Aug Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 8.1            USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 8.2            USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 8.3            USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 8.4            USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 8.5            USR
     C           $GQ3NB    ADD  $GQ4NB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GQ5NB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GRANB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GRBNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GXANB           Current Aug Wei
     C           $GV8NB    DIV  P2RSNB    $GXONB    H      Last Aug Weight
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * CWT Weight
      *================================================================
     C           $GSONB    DIV  100       $GXVII    H      Weight 9.1
     C           $GSPNB    DIV  100       $GTCNB    H      Weight 9.2
     C           $GSSNB    DIV  100       $GJXIX    H      Weight 9.3
     C           $GSTNB    DIV  100       $GJTXX    H      Weight 9.4
     C           $GSUNB    DIV  100       $GJXXI    H      Weight 9.5
      * Calculating Sep's Weight
      * CUR.Current Sep Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 9.1            SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 9.2            SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 9.3            SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 9.4            SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 9.5            SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GSONB    ADD  $GSPNB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GSSNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GSTNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GSUNB    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GXBNB           Current Sep Wei
     C           $GWDNB    DIV  100       $GXPNB    H      Last Sep Weight
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * Load Weights
      *================================================================
     C           $GSONB    DIV  P2RSNB    $GXVII    H      Weight 9.1
     C           $GSPNB    DIV  P2RSNB    $GTCNB    H      Weight 9.2
     C           $GSSNB    DIV  P2RSNB    $GJXIX    H      Weight 9.3
     C           $GSTNB    DIV  P2RSNB    $GJTXX    H      Weight 9.4
     C           $GSUNB    DIV  P2RSNB    $GJXXI    H      Weight 9.5
      * Calculating Sep's Weight
      * CUR.Current Sep Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5))
      * x1    : CUR.Weight 9.1            USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 9.2            USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 9.3            USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 9.4            USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 9.5            USR
     C           $GXVII    ADD  $GTCNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GJXIX    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GJTXX    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $GJXXI    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $GXBNB           Current Sep Wei
     C           $GWDNB    DIV  P2RSNB    $GXPNB    H      Last Sep Weight
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * CWT Weight
      *================================================================
     C           $GTUNB    DIV  100       $GU1NB    H      Weight 10.1
     C           $GTXNB    DIV  100       $GU5NB    H      Weight 10.2
     C           $GTYNB    DIV  100       $GU2NB    H      Weight 10.3
     C           $GTZNB    DIV  100       $GU3NB    H      Weight 10.4
     C           $GT2NB    DIV  100       $GU4NB    H      Weight 10.5
      * Calculating Oct's Weight
      * CUR.Current Oct Weight    USR =
      *    *COMPUTE ((x1 + x2 + x3 + x4 + x5) / x6)
      * x1    : CUR.Weight 10.1           SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Weight 10.2           SUM
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Weight 10.3           SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Weight 10.4           SUM
      * +     : PGM.*Synon (17,7) work field
      * x5    : CUR.Weight 10.5           SUM
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x6    : CON.100
     C           $GTUNB    ADD  $GTXNB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  $GTYNB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  $GTZNB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $GT2NB    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    $GXCNB           Current Oct Wei
     C           $GJXXX    DIV  100       $GXQNB    H      Last Oct Weight
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2VSST           Record Status
     C                     MOVEL*BLANK    P2YGCD           Sales Route Cod
     C                     MOVEL*BLANK    P2BGCD           State Code
     C                     Z-ADD*ZERO     P2RSNB           Maximum pounds
     C                     MOVEL*BLANK    P3ZZST           Record Selected
     C                     MOVEL*BLANK    P4BOCD           Type Code
     C                     Z-ADD*ZERO     P5I0NX           Current Year  U
     C                     Z-ADD*ZERO     P5I1NX           Current Month U
     C                     Z-ADD*ZERO     P5I3NX           This Year (YYYY
     C                     Z-ADD*ZERO     P5I2NX           Last Year (YYYY
     C                     Z-ADD*ZERO     P5I4NX           This Month  (MM
     C                     Z-ADD*ZERO     P5I5NX           Actual Shipped
     C                     Z-ADD*ZERO     P5I7NX           Actual Shipped
     C                     Z-ADD*ZERO     P5I6NX           Actual Shipped
     C                     MOVEL*BLANK    P5T9TX           Year Alpha (YYY
     C                     MOVEL*BLANK    P5UATX           Year Alpha (YY)
     C                     Z-ADD*ZERO     P5I8NX           Year  NBR USR
     C                     Z-ADD*ZERO     P5I9NX           Month NBR USR
     C                     MOVEL*BLANK    P5OPTX           TXT Year Number
     C                     MOVEL*BLANK    P5ONTX           TXT Month Numbe
     C                     MOVEL*BLANK    P5ORTX           TXT MM/YY
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Territory Code
     C                     MOVEL*BLANK    WUX3CD  6
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01    50
     C                     Z-ADD1         Y       50
     C                     ENDIF
      *
      * Define work field Print Yes/No          USR
     C                     MOVEL*BLANK    WUB5SX  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    F4AIC3           Company Number
     C                     MOVEL*LOVAL    F4BTC7           Parent Customer
     C                     MOVEL*LOVAL    F4ANC7           A/R Customer Nu
     C                     MOVEL*LOVAL    F4R4CD           Sales Route Cod
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Type Code
     C                     MOVEL*BLANK    WUBOCD  2
      * Define work field Billing Activity Type
     C                     MOVEL*BLANK    WUOBST  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WD04 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD10 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD09 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD08 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD07 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD06 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD05 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0001  2
     C                     MOVEL*BLANK    WL0002  6
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004 30
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0005  3
     C                     MOVEL*BLANK    WL0006 30
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0007  6
     C                     MOVEL*BLANK    WL0008 30
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  2
     C                     MOVEL*BLANK    WL0012  2
     C                     MOVEL*BLANK    WL0013  3
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  2
     C                     MOVEL*BLANK    WL0017  3
     C                     MOVEL*BLANK    WL0018 40
     C                     MOVEL*BLANK    WL0019 40
     C                     MOVEL*BLANK    WL0020  3
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  1
     C                     Z-ADD*ZERO     WL0023  40
     C                     Z-ADD*ZERO     WL0024  40
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  2
     C                     Z-ADD*ZERO     WL0027  52
     C                     Z-ADD*ZERO     WL0028  92
     C                     Z-ADD*ZERO     WL0029 112
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  3
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  3
     C                     MOVEL*BLANK    WL0034  3
     C                     MOVEL*BLANK    WL0035  8
     C                     MOVEL*BLANK    WL0036  3
     C                     MOVEL*BLANK    WL0037 30
     C                     MOVEL*BLANK    WL0038 25
     C                     MOVEL*BLANK    WL0039 30
     C                     MOVEL*BLANK    WL0040 25
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  1
     C                     MOVEL*BLANK    WL0043 25
     C                     MOVEL*BLANK    WL0044 30
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
     C                     Z-ADD*ZERO     WL0053  60
     C                     MOVEL*BLANK    WL0054 10
     C                     MOVEL*BLANK    WL0055 10
     C                     Z-ADD*ZERO     WL0056  70
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0057  70
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0058  70
     C                     MOVEL*BLANK    WL0059 30
     C                     MOVEL*BLANK    WL0060 30
     C                     MOVEL*BLANK    WL0061 30
     C                     MOVEL*BLANK    WL0062 20
     C                     MOVEL*BLANK    WL0063  2
     C                     MOVEL*BLANK    WL0064 11
     C                     MOVEL*BLANK    WL0065 25
      * Define local work field TER Unused Sts 1
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field TER Unused Sts 2
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field TER Unused Sts 3
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field TER Unused Sts 4
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field Regional Salesperson Code
     C                     MOVEL*BLANK    YL0005  3
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
     C                     MOVEL*BLANK    P3ZZST           Record Selected
      * Get Current Year & Month.
     C                     EXSR UASUBR                     Get Current Yea
      * Determine Comparison Dates.
     C                     EXSR UBSUBR                     Determine Compa
      * Format Heading Year (Example: '98)
     C                     EXSR UCSUBR                     Format Heading
      * Format Heading "MM/YY".
     C                     EXSR UDSUBR                     Format Heading
     C                     MOVEL'N'       WUGGST           USR Display fie
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * Load State/Territory *Arr - State  * 
     C                     EXSR SCRVGN
     C                     MOVEL'XX'      P2BGCD           State Code
     C                     MOVEL'N'       WUB5SX           Print Yes/No
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 All Companies
00002 ALL PARENT CUSTOMERS
00003 All A/R Customers
00004 All Ship To Customers
00005 All Sales Route Codes
00006 All Territories
