     H/TITLE ADD Spread Adjustment  E1 Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 08/04/22  Time  : 10:50:05
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDUYE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: ADD Spread Adjustment  E1 Edit record(1 screen)
      *
     FARBECPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : A/R Detail                Retrieval index       V
      *
     FARBDCPL3IF  E           K        DISK
      * RTV : A/R Header                Retrieval index       NV
      *
     FPBC0CPL1IF  E           K        DISK
      * RTV : A/R Header Ext            Retrieval index
      *
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FPDJ3CPL1IF  E           K        DISK
      * RTV : A/R Adjustment Type       Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDJ3CPL2IF  E           K        DISK
      * RSQ : A/R Adjustment Type       Co/Type Active Records
      *
     FARBDCPMAIF  E           K        DISK
      * RSQ : A/R Header                Inv/InvSfx/Co
      *
     FARBDCPLGIF  E           K        DISK
      * RSQ : A/R Header                RSQ Inv/Sfx (Open)  N
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAEBREL3IF  E           K        DISK
      * RTV : Bank Master               Retrieval Active Only
      *
     FPDNHCPL1IF  E           K        DISK
      * RTV : A/R OA/CM Transactions    Retrieval index
      *
     FARBDCPLRIF  E           K        DISK
      * RSQ : A/R Header                Co/Cust/Inv
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDNHCPL0UF  E           K        DISK                      A
      * UPD : A/R OA/CM Transactions    Update index
      *
     FARBECPL0IF  E           K        DISK                      A
      * UPD : A/R Detail                Update index
      *
     FARBDCPL0UF  E           K        DISK                      A
      * UPD : A/R Header                Update index
      *
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  09  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@J3CPCZ
      * A/R Adjustment Type       Co/Type Active Records
      * Renamed input format fields
     I              J3AIC3                          WAAIC3
     I              J3UHCD                          WAUHCD
     I              J3NFNA                          WANFNA
     I              J3EAZT                          WAEAZT
     I              J3IZTX                          WAIZTX
     I              J3UKVA                          WAUKVA
     I              J3A5ST                          WAA5ST
     I              J3GLTS                          WAGLTS
     I              J3SYSC                          WASYSC
     I              J3UVST                          WAUVST
     I              J3UWST                          WAUWST
     I              J3UXST                          WAUXST
     I              J3VSST                          WAVSST
     I              J3AATM                          WAAATM
     I              J3AYNA                          WAAYNA
     I              J3A0NA                          WAA0NA
     I              J3AXDT                          WAAXDT
      *
     I@BDCPP3
      * A/R Header                Inv/InvSfx/Co
      * Renamed input format fields
     I              BDAIC3                          WBAIC3
     I              BDCONB                          WBCONB
     I              BDCEST                          WBCEST
     I              BDUHCD                          WBUHCD
     I              BDBSVA                          WBBSVA
     I              BDAIVA                          WBAIVA
     I              BDAOVA                          WBAOVA
     I              BDBGVA                          WBBGVA
     I              BDAJST                          WBAJST
     I              BDE3ST                          WBE3ST
     I              BDG4CD                          WBG4CD
     I              BDCKNB                          WBCKNB
     I              BDCAC7                          WBCAC7
     I              BDBKC7                          WBBKC7
     I              BDBCCD                          WBBCCD
     I              BDR4CD                          WBR4CD
     I              BDB4DT                          WBB4DT
     I              BDATDT                          WBATDT
     I              BDH0DT                          WBH0DT
     I              BDH3DT                          WBH3DT
     I              BDH4DT                          WBH4DT
     I              BDH5DT                          WBH5DT
     I              BDANC7                          WBANC7
     I              BDCPTX                          WBCPTX
     I              BDBSDY                          WBBSDY
     I              BDUVST                          WBUVST
     I              BDUWST                          WBUWST
     I              BDUXST                          WBUXST
     I              BDAATM                          WBAATM
     I              BDAYNA                          WBAYNA
     I              BDA0NA                          WBA0NA
     I              BDAXDT                          WBAXDT
      *
     I@BDCPU3
      * A/R Header                RSQ Inv/Sfx (Open)  N
      * Renamed input format fields
     I              BDAIC3                          WCAIC3
     I              BDCONB                          WCCONB
     I              BDCEST                          WCCEST
     I              BDUHCD                          WCUHCD
     I              BDBSVA                          WCBSVA
     I              BDAIVA                          WCAIVA
     I              BDAOVA                          WCAOVA
     I              BDBGVA                          WCBGVA
     I              BDAJST                          WCAJST
     I              BDE3ST                          WCE3ST
     I              BDG4CD                          WCG4CD
     I              BDCKNB                          WCCKNB
     I              BDCAC7                          WCCAC7
     I              BDBKC7                          WCBKC7
     I              BDBCCD                          WCBCCD
     I              BDR4CD                          WCR4CD
     I              BDB4DT                          WCB4DT
     I              BDATDT                          WCATDT
     I              BDH0DT                          WCH0DT
     I              BDH3DT                          WCH3DT
     I              BDH4DT                          WCH4DT
     I              BDH5DT                          WCH5DT
     I              BDANC7                          WCANC7
     I              BDCPTX                          WCCPTX
     I              BDBSDY                          WCBSDY
     I              BDUVST                          WCUVST
     I              BDUWST                          WCUWST
     I              BDUXST                          WCUXST
     I              BDAATM                          WCAATM
     I              BDAYNA                          WCAYNA
     I              BDA0NA                          WCA0NA
     I              BDAXDT                          WCAXDT
      *
     I@NHCPBG
      * A/R OA/CM Transactions    Update index
      * Renamed input format fields
     I              NHAIC3                          WDAIC3
     I              NHCONB                          WDCONB
     I              NHCEST                          WDCEST
     I              NHJZNX                          WDJZNX
     I              NHHNSX                          WDHNSX
     I              NHBSVA                          WDBSVA
     I              NHVSST                          WDVSST
     I              NHMJDT                          WDMJDT
     I              NHBETM                          WDBETM
     I              NHCCVN                          WDCCVN
     I              NHCDVN                          WDCDVN
     I              NHMKDT                          WDMKDT
     I              NHBFTM                          WDBFTM
     I              NHCEVN                          WDCEVN
     I              NHCFVN                          WDCFVN
      *
     I@BFCPFN
      * A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WEAIC3
     I              BFCONB                          WECONB
     I              BFCEST                          WECEST
     I              BFDXNB                          WEDXNB
     I              BFUHCD                          WEUHCD
     I              BFBSVA                          WEBSVA
     I              BFCPTX                          WECPTX
     I              BFNGNA                          WENGNA
     I              BFB4DT                          WEB4DT
     I              BFDVDT                          WEDVDT
     I              BFYXNX                          WEYXNX
     I              BFHYDT                          WEHYDT
     I              BFG4CD                          WEG4CD
     I              BFCKNB                          WECKNB
     I              BFA5ST                          WEA5ST
     I              BFAJST                          WEAJST
     I              BFB1VN                          WEB1VN
     I              BFEAZT                          WEEAZT
     I              BFC1NY                          WEC1NY
     I              BFIZTX                          WEIZTX
     I              BFETSX                          WEETSX
     I              BFW3SX                          WEW3SX
     I              BFW4SX                          WEW4SX
     I              BFW5SX                          WEW5SX
     I              BFW6SX                          WEW6SX
     I              BFW7SX                          WEW7SX
     I              BFW8SX                          WEW8SX
     I              BFQHDT                          WEQHDT
     I              BFQIDT                          WEQIDT
     I              BFQJDT                          WEQJDT
     I              BFQKDT                          WEQKDT
     I              BFQLDT                          WEQLDT
     I              BFGLVL                          WEGLVL
     I              BFGMVL                          WEGMVL
     I              BFGNVL                          WEGNVL
     I              BFGOVL                          WEGOVL
     I              BFGPVL                          WEGPVL
     I              BFUVST                          WEUVST
     I              BFUWST                          WEUWST
     I              BFUXST                          WEUXST
     I              BFAATM                          WEAATM
     I              BFAYNA                          WEAYNA
     I              BFA0NA                          WEA0NA
     I              BFAXDT                          WEAXDT
      *
     I@BDCPC1
      * A/R Header                Co/Cust/Inv
      * Renamed input format fields
     I              BDAIC3                          WFAIC3
     I              BDCONB                          WFCONB
     I              BDCEST                          WFCEST
     I              BDUHCD                          WFUHCD
     I              BDBSVA                          WFBSVA
     I              BDAIVA                          WFAIVA
     I              BDAOVA                          WFAOVA
     I              BDBGVA                          WFBGVA
     I              BDAJST                          WFAJST
     I              BDE3ST                          WFE3ST
     I              BDG4CD                          WFG4CD
     I              BDCKNB                          WFCKNB
     I              BDCAC7                          WFCAC7
     I              BDBKC7                          WFBKC7
     I              BDBCCD                          WFBCCD
     I              BDR4CD                          WFR4CD
     I              BDB4DT                          WFB4DT
     I              BDATDT                          WFATDT
     I              BDH0DT                          WFH0DT
     I              BDH3DT                          WFH3DT
     I              BDH4DT                          WFH4DT
     I              BDH5DT                          WFH5DT
     I              BDANC7                          WFANC7
     I              BDCPTX                          WFCPTX
     I              BDBSDY                          WFBSDY
     I              BDUVST                          WFUVST
     I              BDUWST                          WFUWST
     I              BDUXST                          WFUXST
     I              BDAATM                          WFAATM
     I              BDAYNA                          WFAYNA
     I              BDA0NA                          WFA0NA
     I              BDAXDT                          WFAXDT
      *
     I@BDCPFG
      * A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WGAIC3
     I              BDCONB                          WGCONB
     I              BDCEST                          WGCEST
     I              BDUHCD                          WGUHCD
     I              BDBSVA                          WGBSVA
     I              BDAIVA                          WGAIVA
     I              BDAOVA                          WGAOVA
     I              BDBGVA                          WGBGVA
     I              BDAJST                          WGAJST
     I              BDE3ST                          WGE3ST
     I              BDG4CD                          WGG4CD
     I              BDCKNB                          WGCKNB
     I              BDCAC7                          WGCAC7
     I              BDBKC7                          WGBKC7
     I              BDBCCD                          WGBCCD
     I              BDR4CD                          WGR4CD
     I              BDB4DT                          WGB4DT
     I              BDATDT                          WGATDT
     I              BDH0DT                          WGH0DT
     I              BDH3DT                          WGH3DT
     I              BDH4DT                          WGH4DT
     I              BDH5DT                          WGH5DT
     I              BDANC7                          WGANC7
     I              BDCPTX                          WGCPTX
     I              BDBSDY                          WGBSDY
     I              BDUVST                          WGUVST
     I              BDUWST                          WGUWST
     I              BDUXST                          WGUXST
     I              BDAATM                          WGAATM
     I              BDAYNA                          WGAYNA
     I              BDA0NA                          WGA0NA
     I              BDAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IQPDNH1    E DSPDNHCPL0
      * UPD : A/R OA/CM Transactions    Update index
      * Renamed input format fields
     I              NHAIC3                          WDAIC3
     I              NHCONB                          WDCONB
     I              NHCEST                          WDCEST
     I              NHJZNX                          WDJZNX
     I              NHHNSX                          WDHNSX
     I              NHBSVA                          WDBSVA
     I              NHVSST                          WDVSST
     I              NHMJDT                          WDMJDT
     I              NHBETM                          WDBETM
     I              NHCCVN                          WDCCVN
     I              NHCDVN                          WDCDVN
     I              NHMKDT                          WDMKDT
     I              NHBFTM                          WDBFTM
     I              NHCEVN                          WDCEVN
     I              NHCFVN                          WDCFVN
      *
     IYARDCS      DS                             77
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQARBE1    E DSARBECPL0
      * UPD : A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WEAIC3
     I              BFCONB                          WECONB
     I              BFCEST                          WECEST
     I              BFDXNB                          WEDXNB
     I              BFUHCD                          WEUHCD
     I              BFBSVA                          WEBSVA
     I              BFCPTX                          WECPTX
     I              BFNGNA                          WENGNA
     I              BFB4DT                          WEB4DT
     I              BFDVDT                          WEDVDT
     I              BFYXNX                          WEYXNX
     I              BFHYDT                          WEHYDT
     I              BFG4CD                          WEG4CD
     I              BFCKNB                          WECKNB
     I              BFA5ST                          WEA5ST
     I              BFAJST                          WEAJST
     I              BFB1VN                          WEB1VN
     I              BFEAZT                          WEEAZT
     I              BFC1NY                          WEC1NY
     I              BFIZTX                          WEIZTX
     I              BFETSX                          WEETSX
     I              BFW3SX                          WEW3SX
     I              BFW4SX                          WEW4SX
     I              BFW5SX                          WEW5SX
     I              BFW6SX                          WEW6SX
     I              BFW7SX                          WEW7SX
     I              BFW8SX                          WEW8SX
     I              BFQHDT                          WEQHDT
     I              BFQIDT                          WEQIDT
     I              BFQJDT                          WEQJDT
     I              BFQKDT                          WEQKDT
     I              BFQLDT                          WEQLDT
     I              BFGLVL                          WEGLVL
     I              BFGMVL                          WEGMVL
     I              BFGNVL                          WEGNVL
     I              BFGOVL                          WEGOVL
     I              BFGPVL                          WEGPVL
     I              BFUVST                          WEUVST
     I              BFUWST                          WEUWST
     I              BFUXST                          WEUXST
     I              BFAATM                          WEAATM
     I              BFAYNA                          WEAYNA
     I              BFA0NA                          WEA0NA
     I              BFAXDT                          WEAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQARBD1    E DSARBDCPL0
      * UPD : A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WGAIC3
     I              BDCONB                          WGCONB
     I              BDCEST                          WGCEST
     I              BDUHCD                          WGUHCD
     I              BDBSVA                          WGBSVA
     I              BDAIVA                          WGAIVA
     I              BDAOVA                          WGAOVA
     I              BDBGVA                          WGBGVA
     I              BDAJST                          WGAJST
     I              BDE3ST                          WGE3ST
     I              BDG4CD                          WGG4CD
     I              BDCKNB                          WGCKNB
     I              BDCAC7                          WGCAC7
     I              BDBKC7                          WGBKC7
     I              BDBCCD                          WGBCCD
     I              BDR4CD                          WGR4CD
     I              BDB4DT                          WGB4DT
     I              BDATDT                          WGATDT
     I              BDH0DT                          WGH0DT
     I              BDH3DT                          WGH3DT
     I              BDH4DT                          WGH4DT
     I              BDH5DT                          WGH5DT
     I              BDANC7                          WGANC7
     I              BDCPTX                          WGCPTX
     I              BDBSDY                          WGBSDY
     I              BDUVST                          WGUVST
     I              BDUWST                          WGUWST
     I              BDUXST                          WGUXST
     I              BDAATM                          WGAATM
     I              BDAYNA                          WGAYNA
     I              BDA0NA                          WGA0NA
     I              BDAXDT                          WGAXDT
      *
     IYBRDCS      DS                            134
     IYCRDCS      DS                            134
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * N :  USR Reference number
     I                                    P   1   40P1G4NB
     IP2PARM      DS
      * FLD: A/R Detail
      * I : RST Company Number
     I                                    P   1   20P2AIC3
      * I : RST Invoice Number
     I                                    P   3   60P2CONB
      * I : RST Invoice Suffix
     I                                        7   8 P2CEST
      * I :  Sequence Number
     I                                    P   9  100P2DXNB
      * I :  Transaction Amount
     I                                    P  11  162P2BSVA
      * I :  A/R Orig Inv for CB
     I                                    P  17  200P2QIDT
     IP3PARM      DS
      * FLD: *Arrays
      * O :  USR Amount Applied
     I                                    P   1   62P3U6VA
      * I : MAP USR Remaining Balance
     I                                    P   7  122P3U8VA
      * N :  Company Number Alpha
     I                                       13  15 P3E6TX
      * N :  Error Status
     I                                       16  16 P3ECST
      * I :  USR Company Number
     I                                    P  17  180P3FKNB
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P4AJCD
      * N :  Application Code
     I                                        4   9 P4DNCD
      * N :  Salesperson Code
     I                                       10  12 P4BCCD
      * N :  System Date Format
     I                                       13  15 P4B8NA
      * N :  User Profile Name
     I                                       16  25 P4AJVN
      * N :  Allow Multi-Company
     I                                       26  26 P4I6ST
      * N :  Default Printer
     I                                       27  36 P4MPNA
      * N :  Access Denied (Y/N)
     I                                       37  37 P4WVST
     IP5PARM      DS
      * FLD: A/R Adjustment Type
      * N :  Effect on Account
     I                                        1   1 P5EAZT
      * N :  Adjustment Limit Amount
     I                                    P   2   72P5UKVA
      * N :  User Enter G/L Status
     I                                        8   8 P5GLTS
     IP6PARM      DS
      * I :  USR Invoice Number
     I                                    P   1   40P6YTNB
     IP7PARM      DS
      * I :  USR Invoice Suffix
     I                                        1   2 P7ESST
     IP8PARM      DS
      * I :  A/R Customer Number
     I                                    P   1   40P8ANC7
     IP9PARM      DS
      * I :  USR A/R Customer Number
     I                                    P   1   40P9BMC7
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'A/R Adjustment Type    NF'
      * Adjustment Type Code
     I                                        1   3 ZA0001
      * Message data for 'Adj. > Adj. Limit Amount'
      * Transaction Amount
     I                                    P   1   62ZA0002
      * Message data for 'Cash must be applied thru'
      * Adjustment Type Code
     I                                        1   3 ZA0003
      * Message data for 'Rebill AdjType not Allowd'
      * Adjustment Type Code
     I                                        1   3 ZA0004
      * Message data for 'Adjustment Type is invali'
      * Adjustment Type Code
     I                                        1   3 ZA0005
      * Message data for 'G/L Account Must be enter'
      * Cost Center. . . . . . .
     I                                        1  12 ZA0006
      * Object Account . . . . .
     I                                       13  18 ZA0007
      * Subsidiary . . . . . . .
     I                                       19  26 ZA0008
      * Message data for 'G/L Account Code is in Er'
      * G/L Alpha Code
     I                                        1   8 ZA0009
      * Message data for 'CB Ref.# must be entered.'
      * USR Invoice Number
     I                                    P   1   40ZA0010
      * Message data for 'Chargeback Ref.# already'
      * Invoice Number
     I                                    P   1   40ZA0011
      * Message data for 'Trans Amount > to apply'
      * Transaction Amount
     I                                    P   1   62ZA0012
      * Message data for 'Trans Amount > RemBalDue'
      * Transaction Amount
     I                                    P   1   62ZA0013
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0014
      * Application Code
     I                                       11  16 ZA0015
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0016
      * Application Code
     I                                       11  16 ZA0017
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P2AIC3    PARM           WP0001  30       Company Number
     C           P2CONB    PARM           WP0002  70       Invoice Number
     C           P2CEST    PARM           WP0003  2        Invoice Suffix
     C           P2DXNB    PARM           WP0004  30       Sequence Number
     C           P2BSVA    PARM           WP0005 112       Transaction Amo
     C           P2QIDT    PARM           WP0006  70       A/R Orig Inv fo
     C           P3U6VA    PARM P3U6VA    WP0007 112       USR Amount Appl
     C           P3U8VA    PARM           WP0008 112       USR Remaining B
     C           P3FKNB    PARM           WP0009  30       USR Company Num
     C           P6YTNB    PARM           WP0010  70       USR Invoice Num
     C           P7ESST    PARM           WP0011  2        USR Invoice Suf
     C           P8ANC7    PARM           WP0012  70       A/R Customer Nu
     C           P9BMC7    PARM           WP0013  70       USR A/R Custome
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Repeat until cancelled
     C                     MOVEL'Y'       W0RPT   1
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1CONB    OREQ *ZERO                      Invoice Number
     C           #1CEST    OREQ *BLANK                     Invoice Suffix
     C           #1DXNB    OREQ *ZERO                      Sequence Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BFAIC3           Company Number
     C                     KFLD           BFCONB           Invoice Number
     C                     KFLD           BFCEST           Invoice Suffix
     C                     KFLD           BFDXNB           Sequence Number
      * Setup key
     C                     Z-ADD#1AIC3    BFAIC3
     C                     Z-ADD#1CONB    BFCONB
     C                     MOVEL#1CEST    BFCEST
     C                     Z-ADD#1DXNB    BFDXNB
     C           KRTV      CHAIN@BFCPFO              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record already exists, error
     C           *IN90     IFEQ '0'
     C                     SETON                     9931  *
      * Send message 'A/R Detail             EX'
     C                     MOVEL'USR0179' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
      * USER: Initialize detail screen (new record)
      * CASE: LCL.First Time Flag is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'SPR'     #1UHCD           Adjustment Type
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     END                             *FI
      * RTV A/R Check Number   RT - A/R Header  * 
     C                     EXSR SARVGN
     C                     Z-ADDP2BSVA    #DBGVA           Remaining Balan
      * Use the lesser of the Invoice $ remaining and the Amt to Apply
      * CASE: DTL.Remaining Balance Due LE DTL.USR Remaining Balance
     C           #DBGVA    IFLE #PU8VA                     *IF
      * Invoice $ Remaining
     C                     Z-ADD#DBGVA    #1BSVA           Transaction Amo
     C                     ELSE
      * CASE: *OTHERWISE
      * Amount to Apply
     C                     Z-ADD#PU8VA    #1BSVA           Transaction Amo
     C                     END                             *FI
      * 04/29/2008 slm correction use the sales history instead OrdHeader
      * 02/17/2014 RMC dft CB to NE
      * 01/17/2018 RMC get tf exempt from ar header ext for CB/RB
      * CASE: PAR.Invoice Suffix is Charge Backs and Rebills
     C           P2CEST    IFEQ 'CB'                       *IF
     C           P2CEST    OREQ 'RB'
      * Rtv Orig Order/Inv    RT - A/R Header Ext  * 
     C                     EXSR SBRVGN
      * RTV TF AR Exempt f/ordRT - Sales History  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv TF Exempt By Inv  XF - Sales History  * 
     C                     CALL 'PMUJXFR'              90  Rtv TF Exempt B
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2CONB    WQ0001  70       Invoice Number
     C           #1W3SX    PARM #1W3SX    WQ0002  2        Order TF Exempt
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMUJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL#1W3SX    YL0004           A/R TF Exempt C
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.A/R Orig Inv for CB is Equal to zero
      *   |- c2    : PAR.Invoice Suffix is Charge Backs
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2QIDT    IFEQ *ZERO                      *IF
     C           P2CEST    IFEQ 'CB'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV CB Orig Inv Nbr  RT - A/R Header  * 
     C                     EXSR SDRVGN
     C                     Z-ADDYL0005    #1QIDT           A/R Orig Inv fo
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP2QIDT    #1QIDT           A/R Orig Inv fo
     C                     END                             *FI
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Check relations
      * Check restriction within
     C                     EXSR VACKRL
      * Sequence Number required
     C           #1DXNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
     C                     MOVEL'N'       P3ECST           Error Status
      * CASE: DTL.*CMD key is CF13
     C           *IN13     IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P3E6TX           Company Number
     C                     MOVEL#1AIC3    P3E6TX           Company Number
      * SEL Chart of Accounts  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTSEL'             90  SEL Chart of Ac
     C                     PARM P3E6TX    WQ0006  3        Company Number
     C           #DMCUX    PARM *BLANK    WQ0007 12        Cost Center. .
     C           #DOBJX    PARM *BLANK    WQ0008  6        Object Account
     C           #DSUBX    PARM *BLANK    WQ0009  8        Subsidiary . .
     C           #1IZTX    PARM *BLANK    WQ0010  8        G/L ID Code Alp
     C           #DCVNA    PARM *BLANK    WQ0011 30        Description
     C           WUUNCD    PARM *BLANK    WQ0012  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTSEL'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993637*
     C                     SETON                     38    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * RTV Adj Limits         RT - A/R Adjustment Type  * 
     C                     EXSR SERVGN
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SFRVGN
      * RTV Check Active Adj   RT - A/R Adjustment Type  * 
     C                     EXSR SGRVGN
      * Adjustment Code N/F
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#1UHCD    ZA0001           Adjustment Type
      * Send message 'A/R Adjustment Type    NF'
     C                     MOVEL'USR2041' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     END                             *FI
      * Transaction amount greater than adjustment limit
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Transaction Amount GT PAR.Adjustment Limit Amoun
      *   |- c2    : PAR.Adjustment Limit Amount is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BSVA    IFGT P5UKVA                     *IF
     C           P5UKVA    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1BSVA    ZA0002           Transaction Amo
      * Send message 'Adj. > Adj. Limit Amount'
     C                     MOVEL'USR2066' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     END                             *FI
      * Cash adjustment type is not allowed
      * CASE: DTL.Cash/Adj is Cash Adjustment
     C           #1A5ST    IFEQ 'CSH'                      *IF
      * Setup message data for message
     C                     MOVEL#1UHCD    ZA0003           Adjustment Type
      * Send message 'Cash must be applied thru'
     C                     MOVEL'USR2156' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     END                             *FI
      * Rebill adjustment type is not allowed
      * CASE: DTL.Adjustment Type Code is Rebill
     C           #1UHCD    IFEQ 'RB'                       *IF
      * Setup message data for message
     C                     MOVEL#1UHCD    ZA0004           Adjustment Type
      * Send message 'Rebill AdjType not Allowd'
     C                     MOVEL'USR4954' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     END                             *FI
      * Check for Invalid adjustment types
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : DTL.Adjustment Type Code is A/R Entry by Customer
      *   |- c2    : DTL.Adjustment Type Code is A/R Miscellaneous Acct
      *   |- c3    : DTL.Adjustment Type Code is ACM Apply Credit Memo
      *   |- c4    : DTL.Adjustment Type Code is CRM Credit Memo
      *   |- c5    : DTL.Adjustment Type Code is DBM Debit Memo
      *   |- c6    : DTL.Adjustment Type Code is INV Invoice
      *   |- c7    : DTL.Adjustment Type Code is OA On Account Cash
      *   '-
     C           #1UHCD    IFEQ 'ARC'                      *IF
     C           #1UHCD    OREQ 'ARM'                      *OR
     C           #1UHCD    OREQ 'ACM'                      *OR
     C           #1UHCD    OREQ 'CRM'                      *OR
     C           #1UHCD    OREQ 'DBM'                      *OR
     C           #1UHCD    OREQ 'INV'                      *OR
     C           #1UHCD    OREQ 'OA'                       *OR
      * Setup message data for message
     C                     MOVEL#1UHCD    ZA0005           Adjustment Type
      * Send message 'Adjustment Type is invali'
     C                     MOVEL'USR2263' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     END                             *FI
      * User Defined G/L Code
      * CASE: PAR.User Enter G/L Status is yes
     C           P5GLTS    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DTL.Cost Center. . . . . . . is Not Entered
      *   |- c2    : DTL.Object Account . . . . . is Not Entered
      *   |- c3    : DTL.Subsidiary . . . . . . . is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DMCUX    IFEQ *BLANK                     *IF
     C           #DOBJX    IFEQ *BLANK                     *IF
     C           #DSUBX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DMCUX    ZA0006           Cost Center. .
     C                     MOVEL#DOBJX    ZA0007           Object Account
     C                     MOVEL#DSUBX    ZA0008           Subsidiary . .
      * Send message 'G/L Account Must be enter'
     C                     MOVEL'USR2051' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993637*
     C                     SETON                     38    *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Cost Center. . . . . . . is Select Inquiry
     C           #DMCUX    IFEQ '?'                        *IF
     C                     MOVEL*BLANK    P3E6TX           Company Number
     C                     MOVELP2AIC3    P3E6TX           Company Number
      * SEL Chart of Accounts  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTSEL'             90  SEL Chart of Ac
     C                     PARM P3E6TX    WQ0013  3        Company Number
     C           #DMCUX    PARM *BLANK    WQ0014 12        Cost Center. .
     C           #DOBJX    PARM *BLANK    WQ0015  6        Object Account
     C           #DSUBX    PARM *BLANK    WQ0016  8        Subsidiary . .
     C           #1IZTX    PARM *BLANK    WQ0017  8        G/L ID Code Alp
     C           #DCVNA    PARM *BLANK    WQ0018 30        Description
     C           WUUNCD    PARM *BLANK    WQ0019  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTSEL'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993637*
     C                     SETON                     38    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    P3E6TX           Company Number
     C                     MOVELP2AIC3    P3E6TX           Company Number
      * VAL JDE Account No.s   UP - STR Hog Prcr & Eval Sys  * parm added
     C                     CALL 'ARACTEDT'             90  VAL JDE Account
     C                     PARM P3E6TX    WQ0020  3        Company Number
     C                     PARM #DMCUX    WQ0021 12        Cost Center. .
     C                     PARM #DOBJX    WQ0022  6        Object Account
     C                     PARM #DSUBX    WQ0023  8        Subsidiary . .
     C           #1IZTX    PARM *BLANK    WQ0024  8        G/L ID Code Alp
     C           WUHNST    PARM *BLANK    WQ0025  1        JDE Posting Edi
     C           #DCVNA    PARM *BLANK    WQ0026 30        Description
     C           WUUNCD    PARM *BLANK    WQ0027  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTEDT'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993637*
     C                     SETON                     38    *
     C                     END
      * CASE: WRK.Error Return text is Error Return
     C           WUUNCD    IFEQ 'ERR'                      *IF
      * Setup message data for message
     C                     MOVELWUIVTX    ZA0009           G/L Alpha Code
      * Send message 'G/L Account Code is in Er'
     C                     MOVEL'USR2070' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM #1IZTX    WQ0028  8        G/L ID Code Alp
     C           WUMCUX    PARM *BLANK    WQ0029 12        Cost Center. .
     C           WUOBJX    PARM *BLANK    WQ0030  6        Object Account
     C           WUSUBX    PARM *BLANK    WQ0031  8        Subsidiary . .
     C           #DCVNA    PARM *BLANK    WQ0032 30        Description
     C           #1C1NY    PARM *ZERO     WQ0033  30       G/L Posting Com
     C           WUHNST    PARM *BLANK    WQ0034  1        JDE Posting Edi
     C           WUUNCD    PARM *BLANK    WQ0035  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *** PK0333 ***
      * Chargeback adjustment codes
      * CASE:
      *  - (c1 OR c3) AND c2
      *   |- c1    : DTL.Adjustment Type Code is Chargeback
      *   |- c3    : DTL.Adjustment Type Code is Accrual Chargeback
      *   |- c2    : DTL.USR Reference number is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1UHCD    IFEQ 'CB'                       *IF
     C           #1UHCD    OREQ 'ACB'                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #DG4NB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#DG4NB    ZA0010           USR Reference n
      * Send message 'CB Ref.# must be entered.'
     C                     MOVEL'USR2119' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     END                             *FI
      * *** PK0333 ***
      * Check CB number for duplicate invoice number
      * CASE:
      *  - (c1 OR c3) AND c2
      *   |- c1    : DTL.Adjustment Type Code is Chargeback
      *   |- c3    : DTL.Adjustment Type Code is Accrual Chargeback
      *   |- c2    : DTL.USR Reference number is Not equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1UHCD    IFEQ 'CB'                       *IF
     C           #1UHCD    OREQ 'ACB'                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #DG4NB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check invc exists  RT - A/R Header  * 
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
     C                     Z-ADD#DG4NB    ZA0011           USR Reference n
      * Send message 'Chargeback Ref.# already'
     C                     MOVEL'USR2272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
      * *** 12/10/01  Prevent over-spreading and over-applying  ***
      * OVER-Spread an Amount to Apply
      * CASE: DTL.Transaction Amount GT DTL.USR Remaining Balance
     C           #1BSVA    IFGT #PU8VA                     *IF
      * Setup message data for message
     C                     Z-ADD#1BSVA    ZA0012           Transaction Amo
      * Send message 'Trans Amount > to apply'
     C                     MOVEL'USR3120' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     END                             *FI
      * RTV Remaining/Open Inv RT - A/R Header  * 
     C                     EXSR SIRVGN
      * OVER Apply to an Invoice
      * CASE: DTL.Transaction Amount GT WRK.Remaining Balance Due
     C           #1BSVA    IFGT WUBGVA                     *IF
      * Setup message data for message
     C                     Z-ADD#1BSVA    ZA0013           Transaction Amo
      * Send message 'Trans Amount > RemBalDue'
     C                     MOVEL'USR3121' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     MOVEL'Y'       P3ECST           Error Status
     C                     END                             *FI
      * **************
     C                     Z-ADD#DG4NB    P1G4NB           USR Reference n
     C                     Z-ADD#1BSVA    WUBSVA           Transaction Amo
     C                     MOVEL#1UHCD    WUUHCD           Adjustment Type
     C                     MOVEL#1G4CD    WUG4CD           Bank Code
     C                     Z-ADDWUHXDT    WUHXDT           Deposit Date
      * **************
      * RMC 12/23/05 get g/l posting company
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM #1IZTX    WQ0036  8        G/L ID Code Alp
     C                     PARM *BLANK    WQ0037 12        Cost Center. .
     C                     PARM *BLANK    WQ0038  6        Object Account
     C                     PARM *BLANK    WQ0039  8        Subsidiary . .
     C                     PARM *BLANK    WQ0040 30        Description
     C           #1C1NY    PARM *ZERO     WQ0041  30       G/L Posting Com
     C           WUHNST    PARM *BLANK    WQ0042  1        JDE Posting Edi
     C           WUUNCD    PARM *BLANK    WQ0043  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * **************
      * JBB 07/11/16 E6458 - Add Original Invoice Sequence Number to
      *     A/R Detail record for the Charge Back
     C                     Z-ADD#1DXNB    YL0006           A/R Orig Seq fo
     C                     END
      * Check relations
      * Check reference to A/R Adjustment Type
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9932  *
     C                     END
      * Check reference to Calendar
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Bank Master
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Adjustment Type Code required
     C           #1UHCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Transaction Amount required
     C           #1BSVA    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * CASE: PAR.Access Denied (Y/N) is no
     C           P4WVST    IFEQ 'N'                        *IF
      * CRT A/R OA/CM Trans    RT - A/R OA/CM Transactions  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1CONB    WL0002           Invoice Number
     C                     MOVEL#1CEST    WL0003    P      Invoice Suffix
     C                     Z-ADDP6YTNB    WL0004           Reference Numbe
     C                     MOVELP7ESST    WL0005    P      Reference Suffi
     C                     Z-ADD#1BSVA    WL0006           Transaction Amo
     C                     EXSR SJRVGN
      * CRT A/R OA/CM Trans    RT - A/R OA/CM Transactions  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3FKNB    WL0001           Company Number
     C                     Z-ADDP6YTNB    WL0002           Invoice Number
     C                     MOVELP7ESST    WL0003    P      Invoice Suffix
     C                     Z-ADD#1CONB    WL0004           Reference Numbe
     C                     MOVEL#1CEST    WL0005    P      Reference Suffi
     C                     Z-ADD#1BSVA    WL0006           Transaction Amo
     C                     EXSR SJRVGN
     C                     END                             *FI
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * CRT A/R Detail Appl    CR - A/R Detail  * 
     C                     EXSR SMCRRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           P5GLTS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Enable key screen
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     Z-ADD*ZERO     #DYTNB           USR Invoice Num
     C                     Z-ADD*ZERO     #1B4DT           Transaction Dat
     C                     Z-ADD*ZERO     #1DVDT           Payment/Deposit
     C                     Z-ADD*ZERO     #1YXNX           Deposit Time
     C                     Z-ADD*ZERO     #1HYDT           G/L Post Date
     C                     MOVEL*BLANK    #1G4CD           Bank Code
     C                     Z-ADD*ZERO     #1CKNB           GL Document Num
     C                     MOVEL*BLANK    #1A5ST           Cash/Adj
     C                     MOVEL*BLANK    #1AJST           A/R Processing
     C                     MOVEL*BLANK    #1B1VN           Originating Pro
     C                     MOVEL*BLANK    #1EAZT           Effect on Accou
     C                     Z-ADD*ZERO     #1C1NY           G/L Posting Com
     C                     MOVEL*BLANK    #1IZTX           G/L ID Code JDE
     C                     MOVEL*BLANK    #1ETSX           Post Adjustment
     C                     MOVEL*BLANK    #1W3SX           A/R TF Exempt C
     C                     MOVEL*BLANK    #1W4SX           A/R Dtl UnUsed
     C                     MOVEL*BLANK    #1W5SX           A/R Dtl UnUsed
     C                     MOVEL*BLANK    #1W6SX           A/R Dtl UnUsed
     C                     MOVEL*BLANK    #1W7SX           A/R Dtl UnUsed
     C                     MOVEL*BLANK    #1W8SX           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     #1QHDT           TFS Adj Week-En
     C                     Z-ADD*ZERO     #1QIDT           A/R Orig Inv fo
     C                     Z-ADD*ZERO     #1QJDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     #1QKDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     #1QLDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     #1GLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     #1GMVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     #1GNVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     #1GOVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     #1GPVL           A/R Dtl UnUsed
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #DAPTX           Company Name
     C                     Z-ADDP3U8VA    #PU8VA           USR Remaining B
     C                     Z-ADD*ZERO     #DBGVA           Remaining Balan
     C                     MOVEL*BLANK    #1CPTX           A/R Check Numbe
     C                     MOVEL*BLANK    #1UHCD           Adjustment Type
     C                     MOVEL*BLANK    #DNFNA           Adjustment Desc
     C                     Z-ADD*ZERO     #1BSVA           Transaction Amo
     C                     MOVEL*BLANK    #1NGNA           Explanation
     C                     Z-ADD*ZERO     #DG4NB           USR Reference n
     C                     MOVEL*BLANK    #DMCUX           Cost Center. .
     C                     MOVEL*BLANK    #DOBJX           Object Account
     C                     MOVEL*BLANK    #DSUBX           Subsidiary . .
     C                     MOVEL*BLANK    #DCVNA           G/L Account Des
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPFO fields to screen
      *================================================================
     C                     Z-ADDBFB4DT    #1B4DT           Transaction Dat
     C                     Z-ADDBFDVDT    #1DVDT           Payment/Deposit
     C                     Z-ADDBFYXNX    #1YXNX           Deposit Time
     C                     Z-ADDBFHYDT    #1HYDT           G/L Post Date
     C                     MOVELBFG4CD    #1G4CD           Bank Code
     C                     Z-ADDBFCKNB    #1CKNB           GL Document Num
     C                     MOVELBFA5ST    #1A5ST           Cash/Adj
     C                     MOVELBFAJST    #1AJST           A/R Processing
     C                     MOVELBFB1VN    #1B1VN           Originating Pro
     C                     MOVELBFEAZT    #1EAZT           Effect on Accou
     C                     Z-ADDBFC1NY    #1C1NY           G/L Posting Com
     C                     MOVELBFIZTX    #1IZTX           G/L ID Code JDE
     C                     MOVELBFETSX    #1ETSX           Post Adjustment
     C                     MOVELBFW3SX    #1W3SX           A/R TF Exempt C
     C                     MOVELBFW4SX    #1W4SX           A/R Dtl UnUsed
     C                     MOVELBFW5SX    #1W5SX           A/R Dtl UnUsed
     C                     MOVELBFW6SX    #1W6SX           A/R Dtl UnUsed
     C                     MOVELBFW7SX    #1W7SX           A/R Dtl UnUsed
     C                     MOVELBFW8SX    #1W8SX           A/R Dtl UnUsed
     C                     Z-ADDBFQHDT    #1QHDT           TFS Adj Week-En
     C                     Z-ADDBFQIDT    #1QIDT           A/R Orig Inv fo
     C                     Z-ADDBFQJDT    #1QJDT           A/R Dtl UnUsed
     C                     Z-ADDBFQKDT    #1QKDT           A/R Dtl UnUsed
     C                     Z-ADDBFQLDT    #1QLDT           A/R Dtl UnUsed
     C                     Z-ADDBFGLVL    #1GLVL           G/L Sub-Ledger
     C                     Z-ADDBFGMVL    #1GMVL           A/R Dtl UnUsed
     C                     Z-ADDBFGNVL    #1GNVL           A/R Dtl UnUsed
     C                     Z-ADDBFGOVL    #1GOVL           A/R Dtl UnUsed
     C                     Z-ADDBFGPVL    #1GPVL           A/R Dtl UnUsed
     C                     MOVELBFUVST    #1UVST           EDI Status 1
     C                     MOVELBFUWST    #1UWST           EDI Status 2
     C                     MOVELBFUXST    #1UXST           EDI Status 3
     C                     Z-ADDBFAATM    #1AATM           Job Time
     C                     MOVELBFAYNA    #1AYNA           User Id
     C                     MOVELBFA0NA    #1A0NA           Job Name
     C                     Z-ADDBFAXDT    #1AXDT           Job Date
     C                     Z-ADDBFAIC3    #1AIC3           Company Number
     C                     Z-ADDBFCONB    #1CONB           Invoice Number
     C                     MOVELBFCEST    #1CEST           Invoice Suffix
     C                     Z-ADDBFDXNB    #1DXNB           Sequence Number
     C                     MOVELBFCPTX    #1CPTX           A/R Check Numbe
     C                     MOVELBFUHCD    #1UHCD           Adjustment Type
     C                     Z-ADDBFBSVA    #1BSVA           Transaction Amo
     C                     MOVELBFNGNA    #1NGNA           Explanation
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP3U8VA    #PU8VA           USR Remaining B
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDP2CONB    #1CONB           Invoice Number
     C                     MOVELP2CEST    #1CEST           Invoice Suffix
     C                     Z-ADD*ZERO     #1DXNB           Sequence Number
      * Check restriction within
     C                     EXSR VGCKRL
      * USER: Initialize key screen
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
     C                     Z-ADDP2CONB    #1CONB           Invoice Number
     C                     MOVELP2CEST    #1CEST           Invoice Suffix
     C                     Z-ADDP2DXNB    #1DXNB           Sequence Number
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV A/R Check Number   RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BDAIC3           Company Number
     C                     KFLD           BDCONB           Invoice Number
     C                     KFLD           BDCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDP3FKNB    BDAIC3           Company Number
     C                     Z-ADDP6YTNB    BDCONB           Invoice Number
     C                     MOVELP7ESST    BDCEST           Invoice Suffix
      * Establish starting position
     C           KRSSA     CHAIN@BDCPF7              90    *
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBDCPTX    #1CPTX           A/R Check Numbe
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Orig Order/Inv    RT - A/R Header Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           C0AIC3           Company Number
     C                     KFLD           C0CONB           Invoice Number
     C                     KFLD           C0CEST           Invoice Suffix
      * Setup key
     C                     Z-ADDP2AIC3    C0AIC3           Company Number
     C                     Z-ADDP2CONB    C0CONB           Invoice Number
     C                     MOVELP2CEST    C0CEST           Invoice Suffix
      * Establish starting position
     C           KRSSB     CHAIN@C0CPYP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4952' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Attach to Invoi
     C                     Z-ADD*ZERO     YL0003           Attach to Order
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDC0ATIN    YL0002           Attach to Invoi
     C                     Z-ADDC0T3NB    YL0003           Attach to Order
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV TF AR Exempt f/ordRT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F4AIC3    WQSC01           Company Number
     C           *LIKE     DEFN F4C4NB    WQSC02           Order Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDP2AIC3    WQSC01           Company Number
     C                     Z-ADDYL0003    WQSC02           Order Number
      * Establish starting position
     C           KRSSC     SETLL@FHSTD3                    *
     C           KRSSC     READE@FHSTD3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1241' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1W3SX           Order TF Exempt
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELF4IUSX    #1W3SX           Order TF Exempt
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@FHSTD3                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV CB Orig Inv Nbr  RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BDAIC3           Company Number
     C                     KFLD           BDCONB           Invoice Number
     C                     KFLD           BDCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDP2AIC3    BDAIC3           Company Number
     C                     Z-ADDP2CONB    BDCONB           Invoice Number
     C                     MOVELP2CEST    BDCEST           Invoice Suffix
      * Establish starting position
     C           KRSSD     CHAIN@BDCPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0005           Original Inv fo
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBDH3DT    YL0005           Original Inv fo
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Adj Limits         RT - A/R Adjustment Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           J3AIC3           Company Number
     C                     KFLD           J3UHCD           Adjustment Type
      * Setup key
     C                     Z-ADD#1AIC3    J3AIC3           Company Number
     C                     MOVEL#1UHCD    J3UHCD           Adjustment Type
      * Establish starting position
     C           KRSSE     CHAIN@J3CPCQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2041' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJ3NFNA    #DNFNA           Adjustment Desc
     C                     MOVELJ3EAZT    #1EAZT           Effect on Accou
     C                     MOVELJ3IZTX    #1IZTX           G/L ID Code JDE
     C                     Z-ADDJ3UKVA    P5UKVA           Adjustment Limi
     C                     MOVELJ3A5ST    #1A5ST           Cash/Adj
     C                     MOVELJ3GLTS    P5GLTS           User Enter G/L
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDP2AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSF     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAPTX           Name
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #DAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Check Active Adj   RT - A/R Adjustment Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WAUHCD    WQSG02           Adjustment Type
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Adjustment Type
      * Setup key
     C                     Z-ADD#1AIC3    WQSG01           Company Number
     C                     MOVEL#1UHCD    WQSG02           Adjustment Type
      * Establish starting position
     C           KRSSG     SETLL@J3CPCZ                    *
     C           KRSSG     READE@J3CPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2041' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWASYSC    WUSYSC           System Control
     C                     MOVELWAVSST    WUVSST           Record Status
     C           KRSSG     READE@J3CPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Check invc exists  RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCONB    WQSH01           Invoice Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Invoice Number
      * Setup key
     C                     Z-ADD#DG4NB    WQSH01           Invoice Number
      * Establish starting position
     C           KRSSH     SETLL@BDCPP3                    *
     C           KRSSH     READE@BDCPP3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSH     READE@BDCPP3                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Remaining/Open Inv RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCCONB    WQSI02           Invoice Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           Invoice Number
      * Setup key
     C                     Z-ADD#1CONB    WQSI02           Invoice Number
      * Establish starting position
     C           KRSSI     SETLL@BDCPU3                    *
     C           KRSSI     READE@BDCPU3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1AIC3           Company Number
     C                     MOVEL*BLANK    #1CEST           Invoice Suffix
     C                     Z-ADD*ZERO     WUBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WUANC7           A/R Customer Nu
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAIC3    #1AIC3           Company Number
     C                     MOVELWCCEST    #1CEST           Invoice Suffix
     C                     Z-ADDWCBGVA    WUBGVA           Remaining Balan
     C                     Z-ADDWCANC7    WUANC7           A/R Customer Nu
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@BDCPU3                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * CRT A/R OA/CM Trans    RT - A/R OA/CM Transactions  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       USR amount 1  1
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           NHAIC3           Company Number
     C                     KFLD           NHCONB           Invoice Number
     C                     KFLD           NHCEST           Invoice Suffix
     C                     KFLD           NHJZNX           Reference Numbe
     C                     KFLD           NHHNSX           Reference Suffi
      * Setup key
     C                     Z-ADDWL0001    NHAIC3           Company Number
     C                     Z-ADDWL0002    NHCONB           Invoice Number
     C                     MOVELWL0003    NHCEST           Invoice Suffix
     C                     Z-ADDWL0004    NHJZNX           Reference Numbe
     C                     MOVELWL0005    NHHNSX           Reference Suffi
      * Establish starting position
     C           KRSSJ     CHAIN@NHCPBH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2900' W0RTN   7
      * USER: Processing if Data record not found
      * CRT A/R OA/CM Trans    CR - A/R OA/CM Transactions  * 
     C                     EXSR SKCRRC
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           NHBSVA    ADD  WL0006    WN0001           USR amount 1  1
      * CHG A/R OA/CM Trans    CH - A/R OA/CM Transactions  * 
     C                     EXSR SLCHRC
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT A/R OA/CM Trans    CR - A/R OA/CM Transactions  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  1        Record Status
     C                     Z-ADD*ZERO     WN0003  70       Create Date
     C                     Z-ADD*ZERO     WN0004  60       Create Time
     C                     MOVEL*BLANK    WN0005 10        Create User
     C                     MOVEL*BLANK    WN0006 10        Create Program
     C                     Z-ADD*ZERO     WN0007  70       Change Date
     C                     Z-ADD*ZERO     WN0008  60       Change Time
     C                     MOVEL*BLANK    WN0009 10        Change User
     C                     MOVEL*BLANK    WN0010 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NHCPBG
     C                     Z-ADDWL0001    WDAIC3           Company Number
     C                     Z-ADDWL0002    WDCONB           Invoice Number
     C                     MOVELWL0003    WDCEST           Invoice Suffix
     C                     Z-ADDWL0004    WDJZNX           Reference Numbe
     C                     MOVELWL0005    WDHNSX           Reference Suffi
     C                     Z-ADDWL0006    WDBSVA           Transaction Amo
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WDVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WDMJDT           Create Date
     C                     Z-ADD##JTM     WDBETM           Create Time
     C                     MOVEL##USR     WDCCVN           Create User
     C                     MOVEL##PGM     WDCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
     C                     MOVEL*BLANK    WDCEVN           Change User
     C                     MOVEL*BLANK    WDCFVN           Change Program
     C           KLCRSK    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDCONB           Invoice Number
     C                     KFLD           WDCEST           Invoice Suffix
     C                     KFLD           WDJZNX           Reference Numbe
     C                     KFLD           WDHNSX           Reference Suffi
      * Check for duplicate primary key
     C           KLCRSK    SETLL@NHCPBG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2901' W0RTN   7
      * Send message 'A/R OA/CM Transactions EX'
     C                     MOVEL'USR2901' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@NHCPBG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * CHG A/R OA/CM Trans    CH - A/R OA/CM Transactions  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0011  1        Record Status
     C                     Z-ADD*ZERO     WN0012  70       Create Date
     C                     Z-ADD*ZERO     WN0013  60       Create Time
     C                     MOVEL*BLANK    WN0014 10        Create User
     C                     MOVEL*BLANK    WN0015 10        Create Program
     C                     Z-ADD*ZERO     WN0016  70       Change Date
     C                     Z-ADD*ZERO     WN0017  60       Change Time
     C                     MOVEL*BLANK    WN0018 10        Change User
     C                     MOVEL*BLANK    WN0019 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @NHCPBG
     C                     Z-ADDNHAIC3    WDAIC3           Company Number
     C                     Z-ADDNHCONB    WDCONB           Invoice Number
     C                     MOVELNHCEST    WDCEST    P      Invoice Suffix
     C                     Z-ADDNHJZNX    WDJZNX           Reference Numbe
     C                     MOVELNHHNSX    WDHNSX    P      Reference Suffi
      *
     C           KLCHSL    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDCONB           Invoice Number
     C                     KFLD           WDCEST           Invoice Suffix
     C                     KFLD           WDJZNX           Reference Numbe
     C                     KFLD           WDHNSX           Reference Suffi
     C           KLCHSL    CHAIN@NHCPBG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDNHCPL0'MDACP
     C                     MOVEL'@NHCPBG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDNH1    YARDCS
      * Move non-key fields to @NHCPBG
     C                     Z-ADDWN0001    WDBSVA           Transaction Amo
      *
      * Set PGM.*Record Data Changed flag
     C           QPDNH1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WDMKDT           Change Date
     C                     Z-ADD##JTM     WDBFTM           Change Time
     C                     MOVEL##USR     WDCEVN           Change User
     C                     MOVEL##PGM     WDCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPDNH1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@NHCPBG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDNHCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * CRT A/R Detail Appl    CR - A/R Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0020  60       Job Time
     C                     MOVEL*BLANK    WN0021 10        User Id
     C                     MOVEL*BLANK    WN0022 10        Job Name
     C                     Z-ADD*ZERO     WN0023  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BFCPFN
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1CONB    WECONB           Invoice Number
     C                     MOVEL#1CEST    WECEST           Invoice Suffix
     C                     Z-ADD#1DXNB    WEDXNB           Sequence Number
     C                     MOVEL#1UHCD    WEUHCD           Adjustment Type
     C                     Z-ADD#1BSVA    WEBSVA           Transaction Amo
     C                     MOVEL#1CPTX    WECPTX           A/R Check Numbe
     C                     MOVEL#1NGNA    WENGNA           Explanation
     C                     Z-ADD##JDT     WEB4DT           Transaction Dat
     C                     Z-ADD##JDT     WEDVDT           Payment/Deposit
     C                     Z-ADD*ZERO     WEYXNX           Deposit Time
     C                     Z-ADD#1HYDT    WEHYDT           G/L Post Date
     C                     MOVEL#1G4CD    WEG4CD           Bank Code
     C                     Z-ADD#1CKNB    WECKNB           GL Document Num
     C                     MOVEL#1A5ST    WEA5ST           Cash/Adj
     C                     MOVEL'E'       WEAJST           A/R Processing
     C                     MOVEL##PGM     WEB1VN           Originating Pro
     C                     MOVEL#1EAZT    WEEAZT           Effect on Accou
     C                     Z-ADD#1C1NY    WEC1NY           G/L Posting Com
     C                     MOVEL#1IZTX    WEIZTX           G/L ID Code JDE
     C                     MOVEL'Y'       WEETSX           Post Adjustment
     C                     MOVEL#1W3SX    WEW3SX           A/R TF Exempt C
     C                     MOVEL#1W4SX    WEW4SX           A/R Dtl UnUsed
     C                     MOVEL#1W5SX    WEW5SX           A/R Dtl UnUsed
     C                     MOVEL#1W6SX    WEW6SX           A/R Dtl UnUsed
     C                     MOVEL#1W7SX    WEW7SX           A/R Dtl UnUsed
     C                     MOVEL#1W8SX    WEW8SX           A/R Dtl UnUsed
     C                     Z-ADD#1QHDT    WEQHDT           TFS Adj Week-En
     C                     Z-ADD#1QIDT    WEQIDT           A/R Orig Inv fo
     C                     Z-ADD#DG4NB    WEQJDT           A/R Dtl UnUsed
     C                     Z-ADD#1QKDT    WEQKDT           A/R Dtl UnUsed
     C                     Z-ADD#1QLDT    WEQLDT           A/R Dtl UnUsed
     C                     Z-ADD#1GLVL    WEGLVL           G/L Sub-Ledger
     C                     Z-ADD#1GMVL    WEGMVL           A/R Dtl UnUsed
     C                     Z-ADD#1GNVL    WEGNVL           A/R Dtl UnUsed
     C                     Z-ADD#1GOVL    WEGOVL           A/R Dtl UnUsed
     C                     Z-ADD#1GPVL    WEGPVL           A/R Dtl UnUsed
     C                     MOVEL#1UVST    WEUVST           EDI Status 1
     C                     MOVEL#1UWST    WEUWST           EDI Status 2
     C                     MOVEL#1UXST    WEUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSM    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WECONB           Invoice Number
     C                     KFLD           WECEST           Invoice Suffix
     C                     KFLD           WEDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSM    SETLL@BFCPFN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0179' W0RTN   7
      * Send message 'A/R Detail             EX'
     C                     MOVEL'USR0179' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@BFCPFN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @BFCPFN fields back
     C                     Z-ADDWEDXNB    #1DXNB           Sequence Number
      * USER: Processing after Data update
     C                     MOVEL'N'       P4WVST           Access Denied (
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Chg Apply Header   RT - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0024  50       Days to Pay
     C                     Z-ADD*ZERO     WN0025 112       USR Cash Appl A
     C                     Z-ADD*ZERO     WN0026 112       USR Amount Appl
     C                     Z-ADD*ZERO     WN0027 112       USR Remaining B
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WFANC7    WQSN02           A/R Customer Nu
     C           *LIKE     DEFN WFCONB    WQSN03           Invoice Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           A/R Customer Nu
     C                     KFLD           WQSN03           Invoice Number
      * Setup key
     C                     Z-ADDP2AIC3    WQSN01           Company Number
     C                     Z-ADDP8ANC7    WQSN02           A/R Customer Nu
     C                     Z-ADDP2CONB    WQSN03           Invoice Number
      * Establish starting position
     C           KRSSN     SETLL@BDCPC1                    *
     C           KRSSN     READE@BDCPC1                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WUBSVA    ADD  WFAOVA    WN0026           USR Amount Appl
     C           WN0026    ADD  WFAIVA    WN0025           USR Cash Appl A
     C           WFBSVA    SUB  WN0025    WN0027           USR Remaining B
      * The calculation for days to pay removed 6/13/96 per ARS026
      *        Document number AR26DSN.DOC has the documented project det
      *    I decided to put this back in with call 1723
      * Paid in full date
      * CASE: PAR.USR Remaining Balance is Zero
     C           WN0027    IFEQ 0                          *IF
     C                     Z-ADD##JDT     WUH4DT           Paid in Full Da
      *
     C                     Z-ADD*ZERO     WN0028  50       Number of Days
      *
      * CLC Days Paid          IF
      *   Transaction Date (Invoice Date) will be used instead of Due Dat
      *      PER Request ARS038
      *   The Paid in Full Date has been Changed to the Deposit Date
      *      Which is the Last Payment Date
      * PAR.Number of Days = PAR.Last Payment Date - PAR.Transaction Date
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WFB4DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WFH0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     WN0028
     C                     ELSE
     C           XDURR     MULT -1        WN0028
     C                     END
      * Handle Negative Days to Pay
      * CASE: PAR.Number of Days is Less Than Zero
     C           WN0028    IFLT 0                          *IF
     C                     Z-ADD*ZERO     WN0024           Days to Pay
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0028    WN0024           Days to Pay
     C                     END                             *FI
      * Days to Pay is Negative
      * CASE: PAR.Days to Pay is less than zero
     C           WN0024    IFLT 0                          *IF
     C                     Z-ADD*ZERO     WN0024           Days to Pay
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0024           Days to Pay
     C                     Z-ADD*ZERO     WUH4DT           Paid in Full Da
     C                     END                             *FI
      * CHG for Apply Credit   CH - A/R Header  * 
     C                     EXSR SOCHRC
     C           KRSSN     READE@BDCPC1                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * CHG for Apply Credit   CH - A/R Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0029  3        Adjustment Type
     C                     Z-ADD*ZERO     WN0030 112       Transaction Amo
     C                     Z-ADD*ZERO     WN0031 112       Adjustment Amou
     C                     MOVEL*BLANK    WN0032  1        A/R Processing
     C                     MOVEL*BLANK    WN0033  1        Purge Status
     C                     MOVEL*BLANK    WN0034  6        Bank Code
     C                     Z-ADD*ZERO     WN0035  80       GL Document Num
     C                     Z-ADD*ZERO     WN0036  70       Order Number Re
     C                     Z-ADD*ZERO     WN0037  70       Ship To Custome
     C                     MOVEL*BLANK    WN0038  3        Salesperson Cod
     C                     MOVEL*BLANK    WN0039  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0040  70       Transaction Dat
     C                     Z-ADD*ZERO     WN0041  70       Due Date
     C                     Z-ADD*ZERO     WN0042  70       Original Inv fo
     C                     Z-ADD*ZERO     WN0043  70       Last G/L Post D
     C                     Z-ADD*ZERO     WN0044  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0045 10        A/R Check Numbe
     C                     MOVEL*BLANK    WN0046  1        EDI Status 1
     C                     MOVEL*BLANK    WN0047  1        EDI Status 2
     C                     MOVEL*BLANK    WN0048  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0049  60       Job Time
     C                     MOVEL*BLANK    WN0050 10        User Id
     C                     MOVEL*BLANK    WN0051 10        Job Name
     C                     Z-ADD*ZERO     WN0052  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BDCPFG
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFCONB    WGCONB           Invoice Number
     C                     MOVELWFCEST    WGCEST    P      Invoice Suffix
      *
     C           KLCHSO    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGCONB           Invoice Number
     C                     KFLD           WGCEST           Invoice Suffix
     C           KLCHSO    CHAIN@BDCPFG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBDCPL0'MDACP
     C                     MOVEL'@BDCPFG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBD1    YBRDCS
      * Move non-key fields to @BDCPFG
     C                     Z-ADDWN0026    WGAOVA           Amount Paid
     C                     Z-ADDWN0027    WGBGVA           Remaining Balan
     C                     Z-ADDWFH0DT    WGH0DT           Last Payment Da
     C                     Z-ADDWUH4DT    WGH4DT           Paid in Full Da
     C                     Z-ADDWN0024    WGBSDY           Days to Pay
      *
      * Set PGM.*Record Data Changed flag
     C           QARBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QARBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BDCPFG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Add Chargeback Hd. RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           BDAIC3           Company Number
     C                     KFLD           BDCONB           Invoice Number
     C                     KFLD           BDCEST           Invoice Suffix
      * Setup key
     C                     Z-ADD#1AIC3    BDAIC3           Company Number
     C                     Z-ADD#1CONB    BDCONB           Invoice Number
     C                     MOVEL#1CEST    BDCEST           Invoice Suffix
      * Establish starting position
     C           KRSSP     CHAIN@BDCPF7              90    *
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: PAR.Deposit Date is not entered
     C           WUHXDT    IFEQ 0                          *IF
     C                     Z-ADD##JDT     WUHXDT           Deposit Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUHXDT    WUHXDT           Deposit Date
     C                     END                             *FI
      * *** PK0333 ***  changed to use par.adjustment type code instead o
      * cnd.chargeback
     C                     Z-ADD#1CONB    YL0007           Original Inv fo
      * CRT A/R Header         CR - A/R Header  * 
     C                     EXSR SQCRRC
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * CRT A/R Header         CR - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0053  60       Job Time
     C                     MOVEL*BLANK    WN0054 10        User Id
     C                     MOVEL*BLANK    WN0055 10        Job Name
     C                     Z-ADD*ZERO     WN0056  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BDCPFG
     C                     Z-ADD#1AIC3    WGAIC3           Company Number
     C                     Z-ADDP1G4NB    WGCONB           Invoice Number
     C                     MOVEL'CB'      WGCEST           Invoice Suffix
     C                     MOVELWUUHCD    WGUHCD           Adjustment Type
     C                     Z-ADDWUBSVA    WGBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WGAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WGAOVA           Amount Paid
     C                     Z-ADDWUBSVA    WGBGVA           Remaining Balan
     C                     MOVEL'E'       WGAJST           A/R Processing
     C                     MOVEL'O'       WGE3ST           Purge Status
     C                     MOVELWUG4CD    WGG4CD           Bank Code
     C                     Z-ADD*ZERO     WGCKNB           GL Document Num
     C                     Z-ADDBDCAC7    WGCAC7           Order Number Re
     C                     Z-ADDBDBKC7    WGBKC7           Ship To Custome
     C                     MOVELBDBCCD    WGBCCD           Salesperson Cod
     C                     MOVELBDR4CD    WGR4CD           Sales Route Cod
     C                     Z-ADDWUHXDT    WGB4DT           Transaction Dat
     C                     Z-ADDWUHXDT    WGATDT           Due Date
     C                     Z-ADD*ZERO     WGH0DT           Last Payment Da
     C                     Z-ADDYL0007    WGH3DT           Original Inv fo
     C                     Z-ADD*ZERO     WGH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WGH5DT           Last G/L Post D
     C                     Z-ADDBDANC7    WGANC7           A/R Customer Nu
     C                     MOVELBDCPTX    WGCPTX           A/R Check Numbe
     C                     Z-ADD*ZERO     WGBSDY           Days to Pay
     C                     MOVELBDUVST    WGUVST           EDI Status 1
     C                     MOVELBDUWST    WGUWST           EDI Status 2
     C                     MOVELBDUXST    WGUXST           EDI Status 3
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRSQ    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGCONB           Invoice Number
     C                     KFLD           WGCEST           Invoice Suffix
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@BDCPFG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0175' W0RTN   7
      * Send message 'A/R Header             EX'
     C                     MOVEL'USR0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@BDCPFG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * E6933 DN  08/12/16 - Create A/R Header Ext record.
      * Crt A/R Header Ext    XF - A/R Header Ext  * 
     C                     CALL 'PBX3XFR'              90  Crt A/R Header
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0051  30       Company Number
     C                     PARM WGCONB    WQ0052  70       Invoice Number
     C                     PARM WGCEST    WQ0053  2        Invoice Suffix
     C                     PARM WGBGVA    WQ0054 112       Remaining Balan
     C                     PARM WGCAC7    WQ0055  70       Order Number Re
     C                     PARM WGH3DT    WQ0056  70       Original Inv fo
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBX3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Change Adj Amt     RT - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0057 112       USR Adjustments
     C                     Z-ADD*ZERO     WN0058 112       USR Adj Temp To
     C                     Z-ADD*ZERO     WN0059 112       USR Amount Appl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           BDAIC3           Company Number
     C                     KFLD           BDCONB           Invoice Number
     C                     KFLD           BDCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDP3FKNB    BDAIC3           Company Number
     C                     Z-ADDP6YTNB    BDCONB           Invoice Number
     C                     MOVELP7ESST    BDCEST           Invoice Suffix
      * Establish starting position
     C           KRSSR     CHAIN@BDCPF7              90    *
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           BDAOVA    ADD  WUBSVA    WN0059           USR Amount Appl
     C           BDAIVA    ADD  WN0059    WN0057           USR Adjustments
     C           BDBSVA    SUB  WN0057    WUBGVA           Remaining Balan
      * CASE: WRK.Remaining Balance Due is equal to zero
     C           WUBGVA    IFEQ 0                          *IF
     C                     Z-ADD##JDT     WUH4DT           Paid in Full Da
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUH4DT           Paid in Full Da
     C                     END                             *FI
      * CHG Adj Amount field   CH - A/R Header  * 
     C                     EXSR SSCHRC
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * CHG Adj Amount field   CH - A/R Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0060  3        Adjustment Type
     C                     MOVEL*BLANK    WN0061  1        A/R Processing
     C                     MOVEL*BLANK    WN0062  1        Purge Status
     C                     MOVEL*BLANK    WN0063  6        Bank Code
     C                     Z-ADD*ZERO     WN0064  80       GL Document Num
     C                     Z-ADD*ZERO     WN0065  70       Order Number Re
     C                     Z-ADD*ZERO     WN0066  70       Ship To Custome
     C                     MOVEL*BLANK    WN0067  3        Salesperson Cod
     C                     MOVEL*BLANK    WN0068  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0069  70       Transaction Dat
     C                     Z-ADD*ZERO     WN0070  70       Due Date
     C                     Z-ADD*ZERO     WN0071  70       Last Payment Da
     C                     Z-ADD*ZERO     WN0072  70       Original Inv fo
     C                     Z-ADD*ZERO     WN0073  70       Last G/L Post D
     C                     Z-ADD*ZERO     WN0074  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0075 10        A/R Check Numbe
     C                     MOVEL*BLANK    WN0076  1        EDI Status 1
     C                     MOVEL*BLANK    WN0077  1        EDI Status 2
     C                     MOVEL*BLANK    WN0078  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0079  60       Job Time
     C                     MOVEL*BLANK    WN0080 10        User Id
     C                     MOVEL*BLANK    WN0081 10        Job Name
     C                     Z-ADD*ZERO     WN0082  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BDCPFG
     C                     Z-ADDP3FKNB    WGAIC3           Company Number
     C                     Z-ADDBDCONB    WGCONB           Invoice Number
     C                     MOVELBDCEST    WGCEST    P      Invoice Suffix
      *
     C           KLCHSS    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGCONB           Invoice Number
     C                     KFLD           WGCEST           Invoice Suffix
     C           KLCHSS    CHAIN@BDCPFG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBDCPL0'MDACP
     C                     MOVEL'@BDCPFG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBD1    YCRDCS
      * Move non-key fields to @BDCPFG
     C                     Z-ADDBDBSVA    WGBSVA           Transaction Amo
     C                     Z-ADDBDAIVA    WGAIVA           Adjustment Amou
     C                     Z-ADDWN0059    WGAOVA           Amount Paid
     C                     Z-ADDWUBGVA    WGBGVA           Remaining Balan
     C                     Z-ADDWUH4DT    WGH4DT           Paid in Full Da
     C                     Z-ADDBDBSDY    WGBSDY           Days to Pay
      *
      * Set PGM.*Record Data Changed flag
     C           QARBD1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QARBD1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BDCPFG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV G/L Code           RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0007    EOAIC3           Company Number
     C                     Z-ADDWL0008    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSST     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELEOISTX    WL0009           G/L Code
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Next Seq. No.      RT - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BFAIC3    WQSU01           Company Number
     C           *LIKE     DEFN BFCONB    WQSU02           Invoice Number
     C           *LIKE     DEFN BFCEST    WQSU03           Invoice Suffix
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Invoice Number
     C                     KFLD           WQSU03           Invoice Suffix
     C                     KFLD           BFDXNB           Sequence Number
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Invoice Number
     C                     KFLD           WQSU03           Invoice Suffix
      * Setup key
     C                     Z-ADDWL0010    WQSU01           Company Number
     C                     Z-ADDWL0011    WQSU02           Invoice Number
     C                     MOVELWL0012    WQSU03           Invoice Suffix
     C                     Z-ADDWL0013    BFDXNB           Sequence Number
      * Establish starting position
     C           KPSSU     SETLL@BFCPFO                    *
     C           KRSSU     READE@BFCPFO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0178' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0013           Sequence Number
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDBFDXNB    WL0013           Sequence Number
     C           KRSSU     READE@BFCPFO                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         WL0013           Sequence Number
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BFCPFN
     C                     Z-ADDWL0014    WEAIC3           Company Number
     C                     Z-ADDWL0015    WECONB           Invoice Number
     C                     MOVELWL0016    WECEST           Invoice Suffix
     C                     Z-ADDWL0017    WEDXNB           Sequence Number
     C                     MOVELWL0018    WEUHCD           Adjustment Type
     C                     Z-ADDWL0019    WEBSVA           Transaction Amo
     C                     MOVELWL0020    WECPTX           A/R Check Numbe
     C                     MOVELWL0021    WENGNA           Explanation
     C                     Z-ADDWL0022    WEB4DT           Transaction Dat
     C                     Z-ADDWL0023    WEDVDT           Payment/Deposit
     C                     Z-ADDWL0024    WEYXNX           Deposit Time
     C                     Z-ADDWL0025    WEHYDT           G/L Post Date
     C                     MOVELWL0026    WEG4CD           Bank Code
     C                     Z-ADDWL0027    WECKNB           GL Document Num
     C                     MOVELWL0028    WEA5ST           Cash/Adj
     C                     MOVELWL0029    WEAJST           A/R Processing
     C                     MOVELWL0030    WEB1VN           Originating Pro
     C                     MOVELWL0031    WEEAZT           Effect on Accou
     C                     Z-ADDWL0032    WEC1NY           G/L Posting Com
     C                     MOVELWL0033    WEIZTX           G/L ID Code JDE
     C                     MOVELWL0034    WEETSX           Post Adjustment
     C                     MOVELWL0035    WEW3SX           A/R TF Exempt C
     C                     MOVELWL0036    WEW4SX           A/R Dtl UnUsed
     C                     MOVELWL0037    WEW5SX           A/R Dtl UnUsed
     C                     MOVELWL0038    WEW6SX           A/R Dtl UnUsed
     C                     MOVELWL0039    WEW7SX           A/R Dtl UnUsed
     C                     MOVELWL0040    WEW8SX           A/R Dtl UnUsed
     C                     Z-ADDWL0041    WEQHDT           TFS Adj Week-En
     C                     Z-ADDWL0042    WEQIDT           A/R Orig Inv fo
     C                     Z-ADDWL0043    WEQJDT           A/R Dtl UnUsed
     C                     Z-ADDWL0044    WEQKDT           A/R Dtl UnUsed
     C                     Z-ADDWL0045    WEQLDT           A/R Dtl UnUsed
     C                     Z-ADDWL0046    WEGLVL           G/L Sub-Ledger
     C                     Z-ADDWL0047    WEGMVL           A/R Dtl UnUsed
     C                     Z-ADDWL0048    WEGNVL           A/R Dtl UnUsed
     C                     Z-ADDWL0049    WEGOVL           A/R Dtl UnUsed
     C                     Z-ADDWL0050    WEGPVL           A/R Dtl UnUsed
     C                     MOVELWL0051    WEUVST           EDI Status 1
     C                     MOVELWL0052    WEUWST           EDI Status 2
     C                     MOVELWL0053    WEUXST           EDI Status 3
     C                     Z-ADDWL0054    WEAATM           Job Time
     C                     MOVELWL0055    WEAYNA           User Id
     C                     MOVELWL0056    WEA0NA           Job Name
     C                     Z-ADDWL0057    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSV    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WECONB           Invoice Number
     C                     KFLD           WECEST           Invoice Suffix
     C                     KFLD           WEDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSV    SETLL@BFCPFN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0179' W0RTN   7
      * Send message 'A/R Detail             EX'
     C                     MOVEL'USR0179' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@BFCPFN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDYL0008    KMAIC3           Company Number
     C                     MOVE *BLANK    KMV8CD           Company Value C
     C                     MOVEL'M3LIVE'  KMV8CD           Company Value C
      * Establish starting position
     C           KRSSW     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    YL0010           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0083    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSX     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P4I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P4MPNA           Default Printer
     C                     MOVELDRBCCD    P4BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0013           Company Number
     C                     MOVELDRBUVN    WN0084           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0058    DTAJVN           User Profile Na
     C                     MOVELWL0059    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSY     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0060           Company Number
     C                     MOVELDTAJCD    WL0061           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSZ01           Application Cod
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSZ01           Application Cod
     C                     MOVEL'A/R'     WQSZ01           Application Cod
      * Establish starting position
     C           KRSSZ     SETLL@DNRESF                    *
     C           KRSSZ     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TARVGN
     C                     END                             *FI
     C           KRSSZ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTA01           Application Cod
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTA01           Application Cod
      * Establish starting position
     C           KRSTA     SETLL@DNRESF                    *
     C           KRSTA     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ***********************
      * RMC 08/04/22 W105515- ITC postings:use the same exempt code used
      *      creating the other a/r dtl entries. it needs to be the same.
      *      instead of from the customer. exempt prod was getting posted
      *      the customer's exempt sts which are mostly all NE
      * ***********************
      * RMC 04/19/22 W94990 - FOR E1LIVE -- DO EXTRA INTER CO ENTRIES IN
      *      THE INTER CO FOR 440 SPR TO 960 OA WERENT GETTING CREATED
      *   so Uncomment what was commented in the exit processing
      * RMC 07/28/21 SDN440 - FOR E1LIVE
      *    Changed company 362 to 320; ONLY CREATE THE EXIT PROGRAMMING
      *     FOR M3. DONT NEED TO MAKE THEM FOR E1 JDE
      * RMC 04/13/21 SDN440 - FOR E1LIVE or M3Live
      *    Changed PWBYXFR to get live with M3 and use cgl code from eith
      * ***********************
      * RMC 06/19/19 S15141 - CREATE 362 (DIV 491) ENTRIES WHEN 440 CB IS
      *    APPLIED TO 960 CM. When create Marketing Svs entries for 440
      * added OR with company numbers switched. (wasnt getting the 490 en
      * ***********************
      * 01/17/2018 RMC get tf exempt from ar header ext for CB/RB
      * ***********************
      * RMC 10/26/17 S11954 - CREATE 362 (DIV 491) ENTRIES WHEN 440 OA IS
      *    APPLIED TO 960 INVOICE... (ENTRIES 5 AND 6. ENTRY 6 BALANCES E
      * ***********************
      * RMC 05/11/17  E9064 - new coding for 440  OA
      * ***********************
      * JBB 02/28/17  E9064 - Add company 440 processing
      * ***********************
      * JBB 08/22/16  E5262 - Fix Duplicate Charge Back Explanations
      * - Recompile for a change on access paths ARBDCPLG and ARBDCPLR.
      * ***********************
      * JBB 07/13/16  E6458 - Fix Duplicate Charge Back Explanations
      * - When creating the A/R Detail record for the Charge Back, write
      *   the Charge Back Reference Number to the Unused Date 3 field.
      * ***********************
      * RMC 02/25/15  E3977 get Orig Inv for CB if blank
      * ** 02/18/2010 LJB E000512  Add new parm to VAL JDE Account
      * ** Nos. UP, retrieve and recompile
      * RMC 07/22/09  S00877 RTV Check invc exists to chk Invoice without
      * SLM 04/26/08  Remove getting TF Exempt from the Order Header
      *   replace it with the 1st sales history rec value.
      *   TFS040  Change to the rtv on customer ext
      * SLM 04/09/08  E00193 Inter Company only for Organization of SBD
      *   TFS040 Also change to the rtv on customer ext
      *   03/28/06   par.usr company number has the OA company number
      *   since it may be diff than the appld Invoice company number
      * RMC 12/23/05   get g/l posting code
      * RMC 05/05/05   Write records with a -0- deposit time
      * RMC 03/17/05  Display the lesser of the Amout to Apply and the
      *   Remaining Bal Due as the transaction amt
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1CEST    WK1X03  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           YPMTFD    OREQ '#1CONB'
     C           WK1X03    OREQ '?'                        Invoice Suffix
     C           YPMTFD    OREQ '#1CEST'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1CONB' defaulted for 'Invoice Number'.
      * Field '(KEY) #1CEST' defaulted for 'Invoice Suffix'.
     C                     CALL 'PDPGSRR'              90  SEL A/R Header
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0003  30       Company Number
     C           #1CONB    PARM #1CONB    WQ0004  70       Invoice Number
     C           #1CEST    PARM #1CEST    WQ0005  2        Invoice Suffix
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CONB    IFNE *ZERO                      Invoice Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CEST    IFNE *BLANK                     Invoice Suffix
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVABD    KLIST
     C                     KFLD           BDAIC3           Company Number
     C                     KFLD           BDCONB           Invoice Number
     C                     KFLD           BDCEST           Invoice Suffix
      * Setup key
     C                     Z-ADD#1AIC3    BDAIC3
     C                     Z-ADD#1CONB    BDCONB
     C                     MOVEL#1CEST    BDCEST
     C           KLVABD    CHAIN@BDCPF7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'A/R Header             NF'
     C                     MOVEL'USR0174' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0174' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to A/R Adjustment Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1UHCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Adjustment Type
     C           YPMTFD    OREQ '#1UHCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1UHCD' defaulted for 'Adjustment Type Code'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #DNFNA' defaulted for 'Adjustment Description'.
     C                     CALL 'PDTESRR'              90  SEL Adjustment
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0044  30       Company Number
     C           #1UHCD    PARM #1UHCD    WQ0045  3        Adjustment Type
     C           #DNFNA    PARM *BLANK    WQ0046 30        Adjustment Desc
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9932  *
     C                     END
      *
     C           #1UHCD    IFNE *BLANK                     Adjustment Type
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1UHCD    IFEQ *BLANK                     Adjustment Type
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBJ3    KLIST
     C                     KFLD           J3AIC3           Company Number
     C                     KFLD           J3UHCD           Adjustment Type
      * Setup key
     C                     Z-ADD#1AIC3    J3AIC3
     C                     MOVEL#1UHCD    J3UHCD
     C           KLVBJ3    CHAIN@J3CPCQ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'A/R Adjustment Type    NF'
     C                     MOVEL'USR2041' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2041' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B4DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1B4DT    AFBCDT
     C           KLVCAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1DVDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1DVDT    AFBCDT
     C           KLVDAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1HYDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1HYDT    AFBCDT
     C           KLVEAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Bank Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1G4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Bank Code
     C           YPMTFD    OREQ '#1G4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1G4CD' defaulted for 'Bank Code'.
     C                     CALL 'PDD8SRR'              90  SEL Bank Master
     C                     PARM *BLANK    W0RTN   7
     C           #1G4CD    PARM #1G4CD    WQ0047  6        Bank Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDD8SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1G4CD    IFNE *BLANK                     Bank Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1G4CD    IFEQ *BLANK                     Bank Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFEB    KLIST
     C                     KFLD           EBG4CD           Bank Code
      * Setup key
     C                     MOVEL#1G4CD    EBG4CD
     C           KLVFEB    CHAIN@EBREVK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Bank Master            NF'
     C                     MOVEL'USR0850' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0850' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1CEST    WK1X03  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           YPMTFD    OREQ '#1CONB'
     C           WK1X03    OREQ '?'                        Invoice Suffix
     C           YPMTFD    OREQ '#1CEST'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1CONB' defaulted for 'Invoice Number'.
      * Field '(KEY) #1CEST' defaulted for 'Invoice Suffix'.
     C                     CALL 'PDPGSRR'              90  SEL A/R Header
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0048  30       Company Number
     C           #1CONB    PARM #1CONB    WQ0049  70       Invoice Number
     C           #1CEST    PARM #1CEST    WQ0050  2        Invoice Suffix
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CONB    IFNE *ZERO                      Invoice Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CEST    IFNE *BLANK                     Invoice Suffix
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VG999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVGBD    KLIST
     C                     KFLD           BDAIC3           Company Number
     C                     KFLD           BDCONB           Invoice Number
     C                     KFLD           BDCEST           Invoice Suffix
      * Setup key
     C                     Z-ADD#1AIC3    BDAIC3
     C                     Z-ADD#1CONB    BDCONB
     C                     MOVEL#1CEST    BDCEST
     C           KLVGBD    CHAIN@BDCPF7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
     C           VG999     TAG
      * Restrictor relation not satisfied
      * Send message 'A/R Header             NF'
     C                     MOVEL'USR0174' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0174' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDGE031
     C           ZHCSCL    ANDLE033
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1UHCD'  YPMTFD           Adjustment Type
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * There was an error condition in the detail
      * CASE: PAR.Error Status is yes
     C           P3ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       P4WVST           Access Denied (
     C                     END                             *FI
      * Adjustment record has been added from and to transactions need to
      * CASE: PAR.Access Denied (Y/N) is no
     C           P4WVST    IFEQ 'N'                        *IF
      * Determine Customer Number
      * CASE: PAR.USR A/R Customer Number is not equal to zero
     C           P9BMC7    IFNE *ZERO                      *IF
     C                     Z-ADDP9BMC7    WUANC7           A/R Customer Nu
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP8ANC7    WUANC7           A/R Customer Nu
     C                     END                             *FI
      * RTV Chg Apply Header   RT - A/R Header  * 
     C                     EXSR SNRVGN
     C                     Z-ADDWUBSVA    P3U6VA           USR Amount Appl
      * *** PK0333 ***
      * Add Chargeback Header Record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Adjustment Type Code is Chargeback
      *   |- c2    : WRK.Adjustment Type Code is Accrual Chargeback
      *   '-
     C           WUUHCD    IFEQ 'CB'                       *IF
     C           WUUHCD    OREQ 'ACB'                      *OR
      * RTV Add Chargeback Hd. RT - A/R Header  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
      *        Create Reversing entry for CM A/R account
      * Read with par.usr company number  instead of par.company number
      * RTV Change Adj Amt     RT - A/R Header  * 
     C                     EXSR SRRVGN
     C           *ZERO     SUB  WUBSVA    WUBSVA           Transaction Amo
      * RTV G/L Code           RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0007           Company Number
     C                     Z-ADDP8ANC7    WL0008           Ship To Custome
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    WUISTX    P      G/L Code
      * If Co/Customer does not exist
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    WUISTX           G/L Code
     C                     MOVEL'*blanks' WUISTX           G/L Code
     C                     END                             *FI
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0057  30       Company Number
     C                     PARM WUISTX    WQ0058  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0059 25        G/L Code Desc U
     C           WUIZTX    PARM *BLANK    WQ0060  8        G/L Account Id
     C                     PARM WUAT1U    WQ0061  3        G/L Account Typ
     C                     PARM WUAT2U    WQ0062  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0063  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WUIZTX    WQ0064  8        G/L ID Code Alp
     C                     PARM *BLANK    WQ0065 12        Cost Center. .
     C                     PARM *BLANK    WQ0066  6        Object Account
     C                     PARM *BLANK    WQ0067  8        Subsidiary . .
     C                     PARM *BLANK    WQ0068 30        Description
     C           WUC1NY    PARM *ZERO     WQ0069  30       G/L Posting Com
     C                     PARM *BLANK    WQ0070  1        JDE Posting Edi
     C                     PARM *BLANK    WQ0071  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0010           Company Number
     C                     Z-ADDP2CONB    WL0011           Invoice Number
     C                     MOVELP2CEST    WL0012    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0013           Sequence Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WUDXNB           Sequence Number
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0014           Company Number
     C                     Z-ADDP2CONB    WL0015           Invoice Number
     C                     MOVELP2CEST    WL0016    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0017           Sequence Number
     C                     MOVEL'ARC'     WL0018    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0019           Transaction Amo
     C                     MOVEL*BLANK    WL0020           A/R Check Numbe
     C                     MOVEL@CN,003   WL0021    P      Explanation
     C                     Z-ADD##JDT     WL0022           Transaction Dat
     C                     Z-ADD##JDT     WL0023           Payment/Deposit
     C                     Z-ADD*ZERO     WL0024           Deposit Time
     C                     Z-ADD*ZERO     WL0025           G/L Post Date
     C                     MOVEL*BLANK    WL0026           Bank Code
     C                     Z-ADD*ZERO     WL0027           GL Document Num
     C                     MOVEL'ADJ'     WL0028    P      Cash/Adj
     C                     MOVEL'E'       WL0029    P      A/R Processing
     C                     MOVEL##PGM     WL0030    P      Originating Pro
     C                     MOVELP5EAZT    WL0031    P      Effect on Accou
     C                     Z-ADDWUC1NY    WL0032           G/L Posting Com
     C                     MOVELWUIZTX    WL0033    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0034    P      Post Adjustment
     C                     MOVELYL0004    WL0035    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0036           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0037           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0038           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0039           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0040           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0041           TFS Adj Week-En
     C                     Z-ADDP2QIDT    WL0042           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0043           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0044           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0045           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0046           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0049           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0051    P      EDI Status 1
     C                     MOVELWUUWST    WL0052    P      EDI Status 2
     C                     MOVELWUUXST    WL0053    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0054           Job Time
     C                     MOVEL*BLANK    WL0055           User Id
     C                     MOVEL*BLANK    WL0056           Job Name
     C                     Z-ADD*ZERO     WL0057           Job Date
     C                     EXSR SVCRRC
     C                     END                             *FI
      * slm 04/09/2008 ONLY allo Intr Company if org is Seaboard
      * Inter Company transaction
     C                     Z-ADDP2AIC3    YL0008           Company Number
      * RTV Co. Dflt Int All,O XF - Company Defaults Internal  * 
     C                     CALL 'PMRMXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0008    WQ0072  30       Company Number
     C                     PARM *BLANK    WQ0073  2        Shipping Method
     C                     PARM *BLANK    WQ0074  1        Load Type Dft
     C                     PARM *BLANK    WQ0075  1        LTL Flag Dft
     C                     PARM *BLANK    WQ0076  1        Export Status D
     C                     PARM *BLANK    WQ0077  1        Shrink Wrap Dft
     C                     PARM *ZERO     WQ0078  40       Departure Time
     C                     PARM *BLANK    WQ0079  6        Export Code Dft
     C                     PARM *BLANK    WQ0080  1        Allow Mult Whse
     C                     PARM *BLANK    WQ0081  1        Allow Multi Exp
     C                     PARM *BLANK    WQ0082  1        Slip Sheet Dft
     C                     PARM *BLANK    WQ0083  1        Palletize Dft
     C           YL0009    PARM *BLANK    WQ0084  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 8/8/21 ONLY MAKE THE OFFSETTING ENTRIES IN HERE IR M3 = LIVE/PARA
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SWRVGN
      * New for applying an OA or CM to a diff company   3/28/06
      * CASE:
      *  - c2ANDc1ANDc3ANDc4
      *   |- c2    : PAR.Access Denied (Y/N) is no
      *   |- c1    : WRK.Adjustment Type Code is Spread
      *   |- c3    : PAR.USR Invoice Suffix is CM or OA
      *   |- c4    : LCL.Company Organization is Seaboard
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4WVST    IFEQ 'N'                        *IF
     C           WUUHCD    IFEQ 'SPR'                      *IF
     C           P7ESST    IFEQ 'CM'                       *IF
     C           P7ESST    OREQ 'OA'
     C           YL0009    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.USR Company Number NE PAR.Company Number
     C           P3FKNB    IFNE P2AIC3                     *IF
      * ***************************************************
      * ****  Create Trans for Old company/customer    ****
      * SLM 04/09/2008 - create new function to send back the exempt code
      * if not found then NE will be sent back, or invalid then NE will b
      * back
      * RMC 8/4/22 use the same A/R TF exempt code used when writing the
     C           0         SUB  WUBSVA    WUBSVA           Transaction Amo
      * RTV G/L Code           RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0007           Company Number
     C                     Z-ADDP8ANC7    WL0008           Ship To Custome
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    WUISTX    P      G/L Code
      * If Co/Customer does not exist
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    WUISTX           G/L Code
     C                     MOVEL'*blanks' WUISTX           G/L Code
     C                     END                             *FI
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P3FKNB    WQ0085  30       Company Number
     C                     PARM WUISTX    WQ0086  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0087 25        G/L Code Desc U
     C           WUIZTX    PARM *BLANK    WQ0088  8        G/L Account Id
     C                     PARM WUAT1U    WQ0089  3        G/L Account Typ
     C                     PARM WUAT2U    WQ0090  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0091  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WUIZTX    WQ0092  8        G/L ID Code Alp
     C                     PARM *BLANK    WQ0093 12        Cost Center. .
     C                     PARM *BLANK    WQ0094  6        Object Account
     C                     PARM *BLANK    WQ0095  8        Subsidiary . .
     C                     PARM *BLANK    WQ0096 30        Description
     C           WUC1NY    PARM *ZERO     WQ0097  30       G/L Posting Com
     C                     PARM *BLANK    WQ0098  1        JDE Posting Edi
     C                     PARM *BLANK    WQ0099  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3FKNB    WL0010           Company Number
     C                     Z-ADDP6YTNB    WL0011           Invoice Number
     C                     MOVELP7ESST    WL0012    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0013           Sequence Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WUDXNB           Sequence Number
      * Inter Company
      * # 1
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3FKNB    WL0014           Company Number
     C                     Z-ADDP6YTNB    WL0015           Invoice Number
     C                     MOVELP7ESST    WL0016    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0017           Sequence Number
     C                     MOVEL'ITC'     WL0018    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0019           Transaction Amo
     C                     MOVEL*BLANK    WL0020           A/R Check Numbe
     C                     MOVEL@CN,004   WL0021    P      Explanation
     C                     Z-ADD##JDT     WL0022           Transaction Dat
     C                     Z-ADD##JDT     WL0023           Payment/Deposit
     C                     Z-ADD*ZERO     WL0024           Deposit Time
     C                     Z-ADD*ZERO     WL0025           G/L Post Date
     C                     MOVEL*BLANK    WL0026           Bank Code
     C                     Z-ADD*ZERO     WL0027           GL Document Num
     C                     MOVEL'ADJ'     WL0028    P      Cash/Adj
     C                     MOVEL'E'       WL0029    P      A/R Processing
     C                     MOVEL##PGM     WL0030    P      Originating Pro
     C                     MOVEL*BLANK    WL0031           Effect on Accou
     C                     Z-ADDWUC1NY    WL0032           G/L Posting Com
     C                     MOVELWUIZTX    WL0033    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0034    P      Post Adjustment
     C                     MOVELYL0004    WL0035    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0036           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0037           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0038           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0039           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0040           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0041           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0042           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0043           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0044           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0045           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0046           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0049           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0051    P      EDI Status 1
     C                     MOVELWUUWST    WL0052    P      EDI Status 2
     C                     MOVELWUUXST    WL0053    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0054           Job Time
     C                     MOVEL*BLANK    WL0055           User Id
     C                     MOVEL*BLANK    WL0056           Job Name
     C                     Z-ADD*ZERO     WL0057           Job Date
     C                     EXSR SVCRRC
      *        Create Reversing entry for CM A/R account
     C           *ZERO     SUB  WUBSVA    WUBSVA           Transaction Amo
      * If 360 chg to 960:  Credit 320.3830.101   : 320.OFFAR320
      * If 960 chg to 360:  Credit 960.1830.101   : 960.OFFAR960
      * If 360 chg to 440:  Credit 320.3830.105   : 320.OFFARSTF
      * If 960 chg to 440:  Credit 320.3830.105   : 320.OFFARSTF
      * If 440 chg to 360:  Credit 440.1830.105   : 440.OFFAR440
      * If 440 chg to 960:  Credit 320.3830.101   : 320.OFFAR320  same as
      * CASE: PAR.USR Company Number is Guymon
     C           P3FKNB    IFEQ 360                        *IF
     C                     Z-ADD320       WUC1NY           G/L Posting Com
      * added 6.26.19
      * CASE: PAR.Company Number is NE Seaboard Triumph
     C           P2AIC3    IFNE 440                        *IF
     C                     MOVEL'OFFAR320'YL0011           MCR CGL Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'OFFARSTF'YL0011           MCR CGL Code
     C                     END                             *FI
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0100  30       Company Number
     C                     PARM YL0011    WQ0101  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0102  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0012    WUIZTX           G/L ID Code JDE
     C                     ELSE
      * CASE: PAR.USR Company Number is St. Joseph
     C           P3FKNB    IFEQ 960                        *IF
     C                     Z-ADD960       WUC1NY           G/L Posting Com
      * change OFFAR960 TO BACK TO  GL ID 02502562
     C                     MOVEL@CN,005   WUIZTX           G/L ID Code JDE
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0103  30       Company Number
     C                     PARM WUIZTX    WQ0104  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0105  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0012    WUIZTX           G/L ID Code JDE
     C                     ELSE
      * CASE: PAR.USR Company Number is Sioux City
     C           P3FKNB    IFEQ 440                        *IF
     C                     Z-ADD440       WUC1NY           G/L Posting Com
     C                     MOVEL@CN,006   WUIZTX           G/L ID Code JDE
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0106  30       Company Number
     C                     PARM WUIZTX    WQ0107  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0108  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0012    WUIZTX           G/L ID Code JDE
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3FKNB    WL0010           Company Number
     C                     Z-ADDP6YTNB    WL0011           Invoice Number
     C                     MOVELP7ESST    WL0012    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0013           Sequence Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WUDXNB           Sequence Number
      * Inter Company
      * # 2
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3FKNB    WL0014           Company Number
     C                     Z-ADDP6YTNB    WL0015           Invoice Number
     C                     MOVELP7ESST    WL0016    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0017           Sequence Number
     C                     MOVEL'ITC'     WL0018    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0019           Transaction Amo
     C                     MOVEL*BLANK    WL0020           A/R Check Numbe
     C                     MOVEL@CN,007   WL0021    P      Explanation
     C                     Z-ADD##JDT     WL0022           Transaction Dat
     C                     Z-ADD##JDT     WL0023           Payment/Deposit
     C                     Z-ADD*ZERO     WL0024           Deposit Time
     C                     Z-ADD*ZERO     WL0025           G/L Post Date
     C                     MOVEL*BLANK    WL0026           Bank Code
     C                     Z-ADD*ZERO     WL0027           GL Document Num
     C                     MOVEL'ADJ'     WL0028    P      Cash/Adj
     C                     MOVEL'E'       WL0029    P      A/R Processing
     C                     MOVEL##PGM     WL0030    P      Originating Pro
     C                     MOVEL*BLANK    WL0031           Effect on Accou
     C                     Z-ADDWUC1NY    WL0032           G/L Posting Com
     C                     MOVELWUIZTX    WL0033    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0034    P      Post Adjustment
     C                     MOVELYL0004    WL0035    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0036           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0037           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0038           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0039           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0040           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0041           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0042           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0043           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0044           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0045           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0046           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0049           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0051    P      EDI Status 1
     C                     MOVELWUUWST    WL0052    P      EDI Status 2
     C                     MOVELWUUXST    WL0053    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0054           Job Time
     C                     MOVEL*BLANK    WL0055           User Id
     C                     MOVEL*BLANK    WL0056           Job Name
     C                     Z-ADD*ZERO     WL0057           Job Date
     C                     EXSR SVCRRC
      * ***************************************************
      * ***************************************************
      * ****  Create Trans for New company/customer    ****
     C           *ZERO     SUB  WUBSVA    WUBSVA           Transaction Amo
      * RMC 8/4/22 use the same A/R TF exempt code used when writing the
      * If 360 chg to 960:  Debit  320.3830.101   : 320.OFFAR320
      * If 960 chg to 360:  Debit  960.1830.101   : 960.OFFAR960
      * If 360 chg to 440:  Debit  320.3830.105   : 320.OFFARSTF
      * If 960 chg to 440:  Debit  320.3830.105   : 320.OFFARSTF
      * If 440 chg to 360:  Debit  440.1830.105   : 440.OFFAR440
      * If 440 chg to 960:  Debit  320.3830.101   : 320.OFFAR320
      * CASE: PAR.Company Number is Guymon
     C           P2AIC3    IFEQ 360                        *IF
     C                     Z-ADD320       WUC1NY           G/L Posting Com
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Company Number is Guymon
      *   |- c2    : PAR.USR Company Number is Seaboard Triumph Foods
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2AIC3    IFEQ 360                        *IF
     C           P3FKNB    IFEQ 440                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0109  30       Company Number
     C                     PARM 'OFFARSTF'WQ0110  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0111  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0112  30       Company Number
     C                     PARM 'OFFAR320'WQ0113  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0114  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVELYL0012    WUIZTX           G/L ID Code JDE
     C                     ELSE
      * CASE: PAR.Company Number is St. Joseph
     C           P2AIC3    IFEQ 960                        *IF
     C                     Z-ADD960       WUC1NY           G/L Posting Com
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0115  30       Company Number
     C                     PARM 'OFFAR960'WQ0116  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0117  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0012    WUIZTX           G/L ID Code JDE
     C                     ELSE
      * CASE: PAR.Company Number is Seaboard Triumph Foods
     C           P2AIC3    IFEQ 440                        *IF
     C                     Z-ADD440       WUC1NY           G/L Posting Com
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0118  30       Company Number
     C                     PARM 'OFFAR440'WQ0119  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0120  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0012    WUIZTX           G/L ID Code JDE
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0010           Company Number
     C                     Z-ADDP6YTNB    WL0011           Invoice Number
     C                     MOVELP7ESST    WL0012    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0013           Sequence Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WUDXNB           Sequence Number
      * Inter Company
      * # 3
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0014           Company Number
     C                     Z-ADDP6YTNB    WL0015           Invoice Number
     C                     MOVELP7ESST    WL0016    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0017           Sequence Number
     C                     MOVEL'ITC'     WL0018    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0019           Transaction Amo
     C                     MOVEL*BLANK    WL0020           A/R Check Numbe
     C                     MOVEL@CN,008   WL0021    P      Explanation
     C                     Z-ADD##JDT     WL0022           Transaction Dat
     C                     Z-ADD##JDT     WL0023           Payment/Deposit
     C                     Z-ADD*ZERO     WL0024           Deposit Time
     C                     Z-ADD*ZERO     WL0025           G/L Post Date
     C                     MOVEL*BLANK    WL0026           Bank Code
     C                     Z-ADD*ZERO     WL0027           GL Document Num
     C                     MOVEL'ADJ'     WL0028    P      Cash/Adj
     C                     MOVEL'E'       WL0029    P      A/R Processing
     C                     MOVEL##PGM     WL0030    P      Originating Pro
     C                     MOVEL*BLANK    WL0031           Effect on Accou
     C                     Z-ADDWUC1NY    WL0032           G/L Posting Com
     C                     MOVELWUIZTX    WL0033    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0034    P      Post Adjustment
     C                     MOVELYL0004    WL0035    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0036           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0037           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0038           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0039           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0040           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0041           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0042           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0043           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0044           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0045           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0046           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0049           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0051    P      EDI Status 1
     C                     MOVELWUUWST    WL0052    P      EDI Status 2
     C                     MOVELWUUXST    WL0053    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0054           Job Time
     C                     MOVEL*BLANK    WL0055           User Id
     C                     MOVEL*BLANK    WL0056           Job Name
     C                     Z-ADD*ZERO     WL0057           Job Date
     C                     EXSR SVCRRC
      *        Create Reversing entry for CM A/R account
     C           *ZERO     SUB  WUBSVA    WUBSVA           Transaction Amo
      * RTV G/L Code           RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0007           Company Number
     C                     Z-ADDP8ANC7    WL0008           Ship To Custome
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    WUISTX    P      G/L Code
      * If Co/Customer does not exist
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    WUISTX           G/L Code
     C                     MOVEL'*blanks' WUISTX           G/L Code
     C                     END                             *FI
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0121  30       Company Number
     C                     PARM WUISTX    WQ0122  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0123 25        G/L Code Desc U
     C           WUIZTX    PARM *BLANK    WQ0124  8        G/L Account Id
     C                     PARM WUAT1U    WQ0125  3        G/L Account Typ
     C                     PARM WUAT2U    WQ0126  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0127  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WUIZTX    WQ0128  8        G/L ID Code Alp
     C                     PARM *BLANK    WQ0129 12        Cost Center. .
     C                     PARM *BLANK    WQ0130  6        Object Account
     C                     PARM *BLANK    WQ0131  8        Subsidiary . .
     C                     PARM *BLANK    WQ0132 30        Description
     C           WUC1NY    PARM *ZERO     WQ0133  30       G/L Posting Com
     C                     PARM *BLANK    WQ0134  1        JDE Posting Edi
     C                     PARM *BLANK    WQ0135  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0010           Company Number
     C                     Z-ADDP6YTNB    WL0011           Invoice Number
     C                     MOVELP7ESST    WL0012    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0013           Sequence Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WUDXNB           Sequence Number
      * Inter Company
      * # 4
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0014           Company Number
     C                     Z-ADDP6YTNB    WL0015           Invoice Number
     C                     MOVELP7ESST    WL0016    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0017           Sequence Number
     C                     MOVEL'ITC'     WL0018    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0019           Transaction Amo
     C                     MOVEL*BLANK    WL0020           A/R Check Numbe
     C                     MOVEL@CN,009   WL0021    P      Explanation
     C                     Z-ADD##JDT     WL0022           Transaction Dat
     C                     Z-ADD##JDT     WL0023           Payment/Deposit
     C                     Z-ADD*ZERO     WL0024           Deposit Time
     C                     Z-ADD*ZERO     WL0025           G/L Post Date
     C                     MOVEL*BLANK    WL0026           Bank Code
     C                     Z-ADD*ZERO     WL0027           GL Document Num
     C                     MOVEL'ADJ'     WL0028    P      Cash/Adj
     C                     MOVEL'E'       WL0029    P      A/R Processing
     C                     MOVEL##PGM     WL0030    P      Originating Pro
     C                     MOVEL*BLANK    WL0031           Effect on Accou
     C                     Z-ADDWUC1NY    WL0032           G/L Posting Com
     C                     MOVELWUIZTX    WL0033    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0034    P      Post Adjustment
     C                     MOVELYL0004    WL0035    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0036           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0037           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0038           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0039           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0040           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0041           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0042           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0043           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0044           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0045           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0046           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0049           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0051    P      EDI Status 1
     C                     MOVELWUUWST    WL0052    P      EDI Status 2
     C                     MOVELWUUXST    WL0053    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0054           Job Time
     C                     MOVEL*BLANK    WL0055           User Id
     C                     MOVEL*BLANK    WL0056           Job Name
     C                     Z-ADD*ZERO     WL0057           Job Date
     C                     EXSR SVCRRC
      * *****************
      * RMC NEW 10.26.17 to create Marketing Svs entries for 440 apply to
      * *****************
      * 4/19/22 DO FOR 440 SPREAD TO 960 FOR E1 TOO
      * CASE: *OTHERWISE
      * 440 CM -- 960 in/cm/...
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.USR Company Number is Sioux City
      *   |- c2    : PAR.Company Number is St. Joseph
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3FKNB    IFEQ 440                        *IF
     C           P2AIC3    IFEQ 960                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/20/19 made new CASE Below with companies switched
      * RMC 6/23/19 switch the accts below to the 2nd set
      * RMC 7/28/21 SDN440 change 362 to 320
      * If 440 chg to 960:  Credit 320.3830.101   : 320.OFFAR320
      *    Balance entry : Debit   320.3830.105   : 320.OFFARSTF
     C                     Z-ADD960       WUC1NY           G/L Posting Com
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0136  30       Company Number
     C                     PARM 'OFFAR320'WQ0137  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0138  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0012    WUIZTX           G/L ID Code JDE
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0010           Company Number
     C                     Z-ADDP6YTNB    WL0011           Invoice Number
     C                     MOVELP7ESST    WL0012    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0013           Sequence Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WUDXNB           Sequence Number
      * Inter Company
      * # 5
     C                     Z-ADD320       WUC1NY           G/L Posting Com
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0014           Company Number
     C                     Z-ADDP6YTNB    WL0015           Invoice Number
     C                     MOVELP7ESST    WL0016    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0017           Sequence Number
     C                     MOVEL'ITC'     WL0018    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0019           Transaction Amo
     C                     MOVEL*BLANK    WL0020           A/R Check Numbe
     C                     MOVEL@CN,007   WL0021    P      Explanation
     C                     Z-ADD##JDT     WL0022           Transaction Dat
     C                     Z-ADD##JDT     WL0023           Payment/Deposit
     C                     Z-ADD*ZERO     WL0024           Deposit Time
     C                     Z-ADD*ZERO     WL0025           G/L Post Date
     C                     MOVEL*BLANK    WL0026           Bank Code
     C                     Z-ADD*ZERO     WL0027           GL Document Num
     C                     MOVEL'ADJ'     WL0028    P      Cash/Adj
     C                     MOVEL'E'       WL0029    P      A/R Processing
     C                     MOVEL##PGM     WL0030    P      Originating Pro
     C                     MOVEL*BLANK    WL0031           Effect on Accou
     C                     Z-ADDWUC1NY    WL0032           G/L Posting Com
     C                     MOVELWUIZTX    WL0033    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0034    P      Post Adjustment
     C                     MOVELYL0004    WL0035    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0036           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0037           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0038           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0039           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0040           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0041           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0042           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0043           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0044           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0045           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0046           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0049           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0051    P      EDI Status 1
     C                     MOVELWUUWST    WL0052    P      EDI Status 2
     C                     MOVELWUUXST    WL0053    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0054           Job Time
     C                     MOVEL*BLANK    WL0055           User Id
     C                     MOVEL*BLANK    WL0056           Job Name
     C                     Z-ADD*ZERO     WL0057           Job Date
     C                     EXSR SVCRRC
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0139  30       Company Number
     C                     PARM 'OFFARSTF'WQ0140  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0141  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0012    WUIZTX           G/L ID Code JDE
     C           *ZERO     SUB  WUBSVA    WUBSVA           Transaction Amo
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0010           Company Number
     C                     Z-ADDP6YTNB    WL0011           Invoice Number
     C                     MOVELP7ESST    WL0012    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0013           Sequence Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WUDXNB           Sequence Number
      * Inter Company
      * # 6
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0014           Company Number
     C                     Z-ADDP6YTNB    WL0015           Invoice Number
     C                     MOVELP7ESST    WL0016    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0017           Sequence Number
     C                     MOVEL'ITC'     WL0018    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0019           Transaction Amo
     C                     MOVEL*BLANK    WL0020           A/R Check Numbe
     C                     MOVEL@CN,008   WL0021    P      Explanation
     C                     Z-ADD##JDT     WL0022           Transaction Dat
     C                     Z-ADD##JDT     WL0023           Payment/Deposit
     C                     Z-ADD*ZERO     WL0024           Deposit Time
     C                     Z-ADD*ZERO     WL0025           G/L Post Date
     C                     MOVEL*BLANK    WL0026           Bank Code
     C                     Z-ADD*ZERO     WL0027           GL Document Num
     C                     MOVEL'ADJ'     WL0028    P      Cash/Adj
     C                     MOVEL'E'       WL0029    P      A/R Processing
     C                     MOVEL##PGM     WL0030    P      Originating Pro
     C                     MOVEL*BLANK    WL0031           Effect on Accou
     C                     Z-ADDWUC1NY    WL0032           G/L Posting Com
     C                     MOVELWUIZTX    WL0033    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0034    P      Post Adjustment
     C                     MOVELYL0004    WL0035    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0036           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0037           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0038           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0039           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0040           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0041           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0042           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0043           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0044           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0045           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0046           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0049           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0051    P      EDI Status 1
     C                     MOVELWUUWST    WL0052    P      EDI Status 2
     C                     MOVELWUUXST    WL0053    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0054           Job Time
     C                     MOVEL*BLANK    WL0055           User Id
     C                     MOVEL*BLANK    WL0056           Job Name
     C                     Z-ADD*ZERO     WL0057           Job Date
     C                     EXSR SVCRRC
     C                     END                             *FI
      * 960 CM -- 440 in/cm/...
      * CASE:
      *  - c3ANDc4
      *   |- c3    : PAR.USR Company Number is St. Joseph
      *   |- c4    : PAR.Company Number is Sioux City
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3FKNB    IFEQ 960                        *IF
     C           P2AIC3    IFEQ 440                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/20/19 made new CASE with companies switched
      * RMC 6/23/19 switch the accts below to the 2nd set
      * RMC 7/28/21 SDN440 change 362 to 320
      * If 440 chg to 960: Debit   320.3830.101   : 320.OFFAR320
      *    Balance entry : Credit  320.3830.105   : 320.OFFARSTF
     C                     Z-ADD960       WUC1NY           G/L Posting Com
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0142  30       Company Number
     C                     PARM 'OFFARSTF'WQ0143  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0144  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0012    WUIZTX           G/L ID Code JDE
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0010           Company Number
     C                     Z-ADDP6YTNB    WL0011           Invoice Number
     C                     MOVELP7ESST    WL0012    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0013           Sequence Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WUDXNB           Sequence Number
      * Inter Company
      * # 5
     C                     Z-ADD320       WUC1NY           G/L Posting Com
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0014           Company Number
     C                     Z-ADDP6YTNB    WL0015           Invoice Number
     C                     MOVELP7ESST    WL0016    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0017           Sequence Number
     C                     MOVEL'ITC'     WL0018    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0019           Transaction Amo
     C                     MOVEL*BLANK    WL0020           A/R Check Numbe
     C                     MOVEL@CN,007   WL0021    P      Explanation
     C                     Z-ADD##JDT     WL0022           Transaction Dat
     C                     Z-ADD##JDT     WL0023           Payment/Deposit
     C                     Z-ADD*ZERO     WL0024           Deposit Time
     C                     Z-ADD*ZERO     WL0025           G/L Post Date
     C                     MOVEL*BLANK    WL0026           Bank Code
     C                     Z-ADD*ZERO     WL0027           GL Document Num
     C                     MOVEL'ADJ'     WL0028    P      Cash/Adj
     C                     MOVEL'E'       WL0029    P      A/R Processing
     C                     MOVEL##PGM     WL0030    P      Originating Pro
     C                     MOVEL*BLANK    WL0031           Effect on Accou
     C                     Z-ADDWUC1NY    WL0032           G/L Posting Com
     C                     MOVELWUIZTX    WL0033    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0034    P      Post Adjustment
     C                     MOVELYL0004    WL0035    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0036           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0037           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0038           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0039           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0040           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0041           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0042           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0043           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0044           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0045           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0046           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0049           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0051    P      EDI Status 1
     C                     MOVELWUUWST    WL0052    P      EDI Status 2
     C                     MOVELWUUXST    WL0053    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0054           Job Time
     C                     MOVEL*BLANK    WL0055           User Id
     C                     MOVEL*BLANK    WL0056           Job Name
     C                     Z-ADD*ZERO     WL0057           Job Date
     C                     EXSR SVCRRC
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUC1NY    WQ0145  30       Company Number
     C                     PARM 'OFFAR320'WQ0146  8        MCR CGL Code
     C           YL0012    PARM *BLANK    WQ0147  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0012    WUIZTX           G/L ID Code JDE
     C           *ZERO     SUB  WUBSVA    WUBSVA           Transaction Amo
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0010           Company Number
     C                     Z-ADDP6YTNB    WL0011           Invoice Number
     C                     MOVELP7ESST    WL0012    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0013           Sequence Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WUDXNB           Sequence Number
      * Inter Company
      * # 6
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0014           Company Number
     C                     Z-ADDP6YTNB    WL0015           Invoice Number
     C                     MOVELP7ESST    WL0016    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0017           Sequence Number
     C                     MOVEL'ITC'     WL0018    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0019           Transaction Amo
     C                     MOVEL*BLANK    WL0020           A/R Check Numbe
     C                     MOVEL@CN,008   WL0021    P      Explanation
     C                     Z-ADD##JDT     WL0022           Transaction Dat
     C                     Z-ADD##JDT     WL0023           Payment/Deposit
     C                     Z-ADD*ZERO     WL0024           Deposit Time
     C                     Z-ADD*ZERO     WL0025           G/L Post Date
     C                     MOVEL*BLANK    WL0026           Bank Code
     C                     Z-ADD*ZERO     WL0027           GL Document Num
     C                     MOVEL'ADJ'     WL0028    P      Cash/Adj
     C                     MOVEL'E'       WL0029    P      A/R Processing
     C                     MOVEL##PGM     WL0030    P      Originating Pro
     C                     MOVEL*BLANK    WL0031           Effect on Accou
     C                     Z-ADDWUC1NY    WL0032           G/L Posting Com
     C                     MOVELWUIZTX    WL0033    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0034    P      Post Adjustment
     C                     MOVELYL0004    WL0035    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0036           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0037           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0038           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0039           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0040           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0041           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0042           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0043           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0044           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0045           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0046           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0049           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0051    P      EDI Status 1
     C                     MOVELWUUWST    WL0052    P      EDI Status 2
     C                     MOVELWUUXST    WL0053    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0054           Job Time
     C                     MOVEL*BLANK    WL0055           User Id
     C                     MOVEL*BLANK    WL0056           Job Name
     C                     Z-ADD*ZERO     WL0057           Job Date
     C                     EXSR SVCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1G4NB           USR Reference n
     C                     MOVEL*BLANK    P3E6TX           Company Number
     C                     MOVEL*BLANK    P3ECST           Error Status
     C                     MOVEL*BLANK    P4AJCD           Warehouse Code
     C                     MOVEL*BLANK    P4DNCD           Application Cod
     C                     MOVEL*BLANK    P4BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P4B8NA           System Date For
     C                     MOVEL*BLANK    P4AJVN           User Profile Na
     C                     MOVEL*BLANK    P4I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P4MPNA           Default Printer
     C                     MOVEL*BLANK    P4WVST           Access Denied (
     C                     MOVEL*BLANK    P5EAZT           Effect on Accou
     C                     Z-ADD*ZERO     P5UKVA           Adjustment Limi
     C                     MOVEL*BLANK    P5GLTS           User Enter G/L
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Error Return text
     C                     MOVEL*BLANK    WUUNCD  7
      * Define work field System Control
     C                     MOVEL*BLANK    WUSYSC  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAUKVA           Adjustment Limi
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field JDE Posting Edit Code USR
     C                     MOVEL*BLANK    WUHNST  1
      * Define work field G/L Alpha Code
     C                     MOVEL*BLANK    WUIVTX  8
      * Define work field Cost Center. . . . . . .
     C                     MOVEL*BLANK    WUMCUX 12
      * Define work field Object Account . . . . .
     C                     MOVEL*BLANK    WUOBJX  6
      * Define work field Subsidiary . . . . . . .
     C                     MOVEL*BLANK    WUSUBX  8
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WBAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WBAOVA           Amount Paid
     C                     Z-ADD*ZERO     WBBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WBCKNB           GL Document Num
     C                     Z-ADD*ZERO     WBCAC7           Order Number Re
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WBATDT           Due Date
     C                     Z-ADD*ZERO     WBH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WBH3DT           Original Inv fo
     C                     Z-ADD*ZERO     WBH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WBH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBSDY           Days to Pay
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Remaining Balance Due
     C                     Z-ADD*ZERO     WUBGVA 112
      * Define work field A/R Customer Number
     C                     Z-ADD*ZERO     WUANC7  70
      * Define work field Transaction Amount
     C                     Z-ADD*ZERO     WUBSVA 112
      * Define work field Adjustment Type Code
     C                     MOVEL*BLANK    WUUHCD  3
      * Define work field Bank Code
     C                     MOVEL*BLANK    WUG4CD  6
      * Define work field Deposit Date
     C                     Z-ADD*ZERO     WUHXDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDJZNX           Reference Numbe
     C                     Z-ADD*ZERO     WDBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEDXNB           Sequence Number
     C                     Z-ADD*ZERO     WEBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WEB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WEDVDT           Payment/Deposit
     C                     Z-ADD*ZERO     WEYXNX           Deposit Time
     C                     Z-ADD*ZERO     WEHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WECKNB           GL Document Num
     C                     Z-ADD*ZERO     WEC1NY           G/L Posting Com
     C                     Z-ADD*ZERO     WEQHDT           TFS Adj Week-En
     C                     Z-ADD*ZERO     WEQIDT           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WEQJDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEQKDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEQLDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WEGMVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGNVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGOVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGPVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Paid in Full Date
     C                     Z-ADD*ZERO     WUH4DT  70
      * Clear all neither parameters
      * CRT A/R Header         CR - A/R Header  * 
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field G/L Code
     C                     MOVEL*BLANK    WUISTX  8
      * Define work field G/L Code Desc USR
     C                     MOVEL*BLANK    WUIYTX 25
      * Define work field G/L ID Code JDE
     C                     MOVEL*BLANK    WUIZTX  8
      * Define work field G/L Account Type 1 USR
     C                     MOVEL*BLANK    WUAT1U  3
      * Define work field G/L Account Type 2 USR
     C                     MOVEL*BLANK    WUAT2U  3
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field G/L Posting Company
     C                     Z-ADD*ZERO     WUC1NY  30
      * Define work field Sequence Number
     C                     Z-ADD*ZERO     WUDXNB  30
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  2
     C                     Z-ADD*ZERO     WL0006 112
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  8
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  2
     C                     Z-ADD*ZERO     WL0013  30
      * Define local variables for subroutine SVCRRC.
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  2
     C                     Z-ADD*ZERO     WL0017  30
     C                     MOVEL*BLANK    WL0018  3
     C                     Z-ADD*ZERO     WL0019 112
     C                     MOVEL*BLANK    WL0020 10
     C                     MOVEL*BLANK    WL0021 30
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  70
     C                     Z-ADD*ZERO     WL0024  40
     C                     Z-ADD*ZERO     WL0025  70
     C                     MOVEL*BLANK    WL0026  6
     C                     Z-ADD*ZERO     WL0027  80
     C                     MOVEL*BLANK    WL0028  3
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030 10
     C                     MOVEL*BLANK    WL0031  1
     C                     Z-ADD*ZERO     WL0032  30
     C                     MOVEL*BLANK    WL0033  8
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  2
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  1
     C                     MOVEL*BLANK    WL0039  2
     C                     MOVEL*BLANK    WL0040  2
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  70
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044  70
     C                     Z-ADD*ZERO     WL0045  70
     C                     Z-ADD*ZERO     WL0046 112
     C                     Z-ADD*ZERO     WL0047 112
     C                     Z-ADD*ZERO     WL0048 112
     C                     Z-ADD*ZERO     WL0049 112
     C                     Z-ADD*ZERO     WL0050 112
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
     C                     MOVEL*BLANK    WL0053  1
     C                     Z-ADD*ZERO     WL0054  60
     C                     MOVEL*BLANK    WL0055 10
     C                     MOVEL*BLANK    WL0056 10
     C                     Z-ADD*ZERO     WL0057  70
      * Define local variables for subroutine SYRVGN.
     C                     MOVEL*BLANK    WL0058 10
     C                     MOVEL*BLANK    WL0059  6
     C                     Z-ADD*ZERO     WL0060  30
     C                     MOVEL*BLANK    WL0061  3
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Attach to Order Number
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field A/R TF Exempt Code
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field Original Inv for CB
     C                     Z-ADD*ZERO     YL0005  70
      * Define null work field Cost Center. . . . . . .
     C                     MOVEL*BLANK    YN0001 12
      * Define null work field Object Account . . . . .
     C                     MOVEL*BLANK    YN0002  6
      * Define null work field Subsidiary . . . . . . .
     C                     MOVEL*BLANK    YN0003  8
      * Define null work field Description
     C                     MOVEL*BLANK    YN0004 30
      * Define local work field A/R Orig Seq for CB
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Original Inv for CB
     C                     Z-ADD*ZERO     YL0007  70
      * Define null work field JDE Posting Edit Code USR
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field Error Return text
     C                     MOVEL*BLANK    YN0006  7
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0008  30
      * Define null work field Shipping Method Dft
     C                     MOVEL*BLANK    YN0007  2
      * Define null work field Load Type Dft
     C                     MOVEL*BLANK    YN0008  1
      * Define null work field LTL Flag Dft
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field Export Status Dft
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Shrink Wrap Dft
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Departure Time DFT
     C                     Z-ADD*ZERO     YN0012  40
      * Define null work field Export Code Dft
     C                     MOVEL*BLANK    YN0013  6
      * Define null work field Allow Mult Whse to Order
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Allow Multi Export On Ord
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Slip Sheet Dft
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Palletize Dft
     C                     MOVEL*BLANK    YN0017  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Live with M3
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field MCR CGL Code
     C                     MOVEL*BLANK    YL0011  8
      * Define local work field MCR GL Acct ID
     C                     MOVEL*BLANK    YL0012  8
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0013  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0014  3
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Set to *ADD mode
     C                     MOVEL'ADD'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0083 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0083           User Profile Na
      *
     C                     MOVEL*BLANK    WN0084 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SXRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0083    ZA0014           User Profile Na
     C                     MOVEL'A/R'     ZA0015           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0084    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0083    WL0058    P      User Profile Na
     C                     MOVEL'A/R'     WL0059    P      Application Cod
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0060    WUAIC3           Company Number
     C                     MOVELWL0061    YL0014    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0084    WL0058    P      User Profile Na
     C                     MOVEL'A/R'     WL0059    P      Application Cod
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0060    WUAIC3           Company Number
     C                     MOVELWL0061    YL0014    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0014    P4AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0083    ZA0016           User Profile Na
     C                     MOVEL'A/R'     ZA0017           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0013    IFNE 0                          *IF
     C                     Z-ADDYL0013    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0014    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P4AJCD    PARM *BLANK    WQ0148  3        Warehouse Code
     C                     PARM YL0013    WQ0149  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SZRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       P4WVST           Access Denied (
     C                     MOVEL'Y'       YL0001           First Time Flag
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * ***********************
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 Y2U0003
00003 Credit A/R
00004 Debit A/R Account
00005 OFFAR960
00006 OFFAR440
00007 Credit Inter Co
00008 Debit Inter Co
00009 Credit A/R Account
