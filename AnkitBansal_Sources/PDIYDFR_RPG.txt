     H/TITLE WW Cred Hold/Rlse Hold DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 03/19/25  Time  : 04:17:10
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDIYDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Cred Hold/Rlse Hold DF Display file
      *
     FOPBFCPMLIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          SchedShipDate, Order, Co
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer Master           Active Only
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCABBRELCIF  E           K        DISK
      * RSQ : Customer Master           RSQ Parent # Active
      *
     FARBDCPLSIF  E           K        DISK
      * RSQ : AR Header New             Cust/Inv, sel inv,cm
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse Codes           ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size new            Retrieval index
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FPDLHCPLHIF  E           K        DISK
      * RSQ : Load Order Change Log     Load/Order/Type
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 037  5 0A
     E                    W0END   7 037  5 0A
     E                    W0NAM   7 037 10
      * Long constants
     E                    @CN#    1  07  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BBREWG
      * Customer Master           Active Only
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
     I              ADQDSC                          WCQDSC
      *
     I@BBREXK
      * Customer Master           RSQ Parent # Active
      * Renamed input format fields
     I              BBBKC7                          WDBKC7
     I              BBAYTX                          WDAYTX
     I              BBACNA                          WDACNA
     I              BBADNA                          WDADNA
     I              BBAENA                          WDAENA
     I              BBAJNA                          WDAJNA
     I              BBBGCD                          WDBGCD
     I              BBG5CD                          WDG5CD
     I              BBBTTX                          WDBTTX
     I              BBBVTX                          WDBVTX
     I              BBBWTX                          WDBWTX
     I              BBABTX                          WDABTX
     I              BBA2NA                          WDA2NA
     I              BBCBST                          WDCBST
     I              BBB0NA                          WDB0NA
     I              BBP3NB                          WDP3NB
     I              BBAXNA                          WDAXNA
     I              BBI6DT                          WDI6DT
     I              BBAYDT                          WDAYDT
     I              BBANC7                          WDANC7
     I              BBBTC7                          WDBTC7
     I              BBK6ST                          WDK6ST
     I              BBUZST                          WDUZST
     I              BBKXCD                          WDKXCD
     I              BBLTCD                          WDLTCD
     I              BBQNST                          WDQNST
     I              BBS2NB                          WDS2NB
     I              BBVHVA                          WDVHVA
     I              BBI7DT                          WDI7DT
     I              BBRJST                          WDRJST
     I              BBRKST                          WDRKST
     I              BBQWST                          WDQWST
     I              BBQXST                          WDQXST
     I              BBQYST                          WDQYST
     I              BBUNCS                          WDUNCS
     I              BBUVST                          WDUVST
     I              BBUWST                          WDUWST
     I              BBUXST                          WDUXST
     I              BBVSST                          WDVSST
     I              BBAATM                          WDAATM
     I              BBAYNA                          WDAYNA
     I              BBA0NA                          WDA0NA
     I              BBAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WGAIC3
     I              BEC4NB                          WGC4NB
     I              BEJNCD                          WGJNCD
     I              BEANC7                          WGANC7
     I              BEBKC7                          WGBKC7
     I              BEBRTX                          WGBRTX
     I              BEHMNA                          WGHMNA
     I              BEHONA                          WGHONA
     I              BEHPNA                          WGHPNA
     I              BEHNNA                          WGHNNA
     I              BEDBCD                          WGDBCD
     I              BECKTX                          WGCKTX
     I              BEB0C7                          WGB0C7
     I              BEAETX                          WGAETX
     I              BEB1NA                          WGB1NA
     I              BEB3NA                          WGB3NA
     I              BEB4NA                          WGB4NA
     I              BEB2NA                          WGB2NA
     I              BEBHCD                          WGBHCD
     I              BEC8TX                          WGC8TX
     I              BEBCNA                          WGBCNA
     I              BEA0DT                          WGA0DT
     I              BEA5DT                          WGA5DT
     I              BEGNDT                          WGGNDT
     I              BEACDT                          WGACDT
     I              BEAQCD                          WGAQCD
     I              BEB6NA                          WGB6NA
     I              BEBYNA                          WGBYNA
     I              BEBZNA                          WGBZNA
     I              BEGTST                          WGGTST
     I              BEGVST                          WGGVST
     I              BEGUST                          WGGUST
     I              BEQFST                          WGQFST
     I              BECQCD                          WGCQCD
     I              BEGJST                          WGGJST
     I              BEGWST                          WGGWST
     I              BEGXST                          WGGXST
     I              BEGYST                          WGGYST
     I              BEAODT                          WGAODT
     I              BEAIVN                          WGAIVN
     I              BECXDT                          WGCXDT
     I              BEJZVA                          WGJZVA
     I              BEA1WG                          WGA1WG
     I              BEXIST                          WGXIST
     I              BEXJST                          WGXJST
     I              BEXKST                          WGXKST
     I              BEEIDT                          WGEIDT
     I              BEAFTM                          WGAFTM
     I              BEE8CD                          WGE8CD
     I              BEE9CD                          WGE9CD
     I              BERMNB                          WGRMNB
     I              BETBNB                          WGTBNB
     I              BER1NB                          WGR1NB
     I              BEPJST                          WGPJST
     I              BEU0ST                          WGU0ST
     I              BEU1ST                          WGU1ST
     I              BEQ2CD                          WGQ2CD
     I              BEU2ST                          WGU2ST
     I              BEVEST                          WGVEST
     I              BEVFST                          WGVFST
     I              BEVGST                          WGVGST
     I              BERPCD                          WGRPCD
     I              BERNNB                          WGRNNB
     I              BEVDST                          WGVDST
     I              BEATIN                          WGATIN
     I              BEU4ST                          WGU4ST
     I              BEU5ST                          WGU5ST
     I              BERSRN                          WGRSRN
     I              BEMHNA                          WGMHNA
     I              BEMINA                          WGMINA
     I              BEWBST                          WGWBST
     I              BER4CD                          WGR4CD
     I              BEBFCD                          WGBFCD
     I              BEQ4CD                          WGQ4CD
     I              BET3NB                          WGT3NB
     I              BESICD                          WGSICD
     I              BECONB                          WGCONB
     I              BECEST                          WGCEST
     I              BEAWDT                          WGAWDT
     I              BEJPCD                          WGJPCD
     I              BEXUST                          WGXUST
     I              BEZ1ST                          WGZ1ST
     I              BEVRVA                          WGVRVA
     I              BEOBST                          WGOBST
     I              BEBCST                          WGBCST
     I              BEBDST                          WGBDST
     I              BEB7VL                          WGB7VL
     I              BEGASX                          WGGASX
     I              BEGBSX                          WGGBSX
     I              BEGCSX                          WGGCSX
     I              BEGDSX                          WGGDSX
     I              BEFNSX                          WGFNSX
     I              BEFOSX                          WGFOSX
     I              BEFPSX                          WGFPSX
     I              BEFQSX                          WGFQSX
     I              BEFRSX                          WGFRSX
     I              BEFSSX                          WGFSSX
     I              BEFTSX                          WGFTSX
     I              BEFUSX                          WGFUSX
     I              BEFVSX                          WGFVSX
     I              BEFWSX                          WGFWSX
     I              BEFXSX                          WGFXSX
     I              BEFYSX                          WGFYSX
     I              BENODT                          WGNODT
     I              BENPDT                          WGNPDT
     I              BENQDT                          WGNQDT
     I              BENRDT                          WGNRDT
     I              BENSDT                          WGNSDT
     I              BEBPTM                          WGBPTM
     I              BEBQTM                          WGBQTM
     I              BEBRTM                          WGBRTM
     I              BEBSTM                          WGBSTM
     I              BEBTTM                          WGBTTM
     I              BEH0NX                          WGH0NX
     I              BEH1NX                          WGH1NX
     I              BEH2NX                          WGH2NX
     I              BEH3NX                          WGH3NX
     I              BEH4NX                          WGH4NX
     I              BEC0C7                          WGC0C7
     I              BEUVST                          WGUVST
     I              BEUWST                          WGUWST
     I              BEUXST                          WGUXST
     I              BEAATM                          WGAATM
     I              BEAYNA                          WGAYNA
     I              BEA0NA                          WGA0NA
     I              BEAXDT                          WGAXDT
      *
     I@ADREWA
      * Warehouse Codes           ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WHAJCD
     I              ADF8NA                          WHF8NA
     I              ADACNA                          WHACNA
     I              ADADNA                          WHADNA
     I              ADAENA                          WHAENA
     I              ADAJNA                          WHAJNA
     I              ADBTTX                          WHBTTX
     I              ADAOCD                          WHAOCD
     I              ADBGCD                          WHBGCD
     I              ADVHST                          WHVHST
     I              ADMPNA                          WHMPNA
     I              ADWPST                          WHWPST
     I              ADXUST                          WHXUST
     I              ADT0ST                          WHT0ST
     I              ADT1ST                          WHT1ST
     I              ADDBNB                          WHDBNB
     I              ADT2ST                          WHT2ST
     I              ADT3ST                          WHT3ST
     I              ADT4ST                          WHT4ST
     I              ADT6ST                          WHT6ST
     I              ADBWC3                          WHBWC3
     I              ADBTC3                          WHBTC3
     I              ADBUC3                          WHBUC3
     I              ADBVC3                          WHBVC3
     I              ADFCAA                          WHFCAA
     I              ADRQSX                          WHRQSX
     I              ADRRSX                          WHRRSX
     I              ADRSSX                          WHRSSX
     I              ADRTSX                          WHRTSX
     I              ADT7ST                          WHT7ST
     I              ADT8ST                          WHT8ST
     I              ADRNSX                          WHRNSX
     I              ADROSX                          WHROSX
     I              ADRPSX                          WHRPSX
     I              ADUVST                          WHUVST
     I              ADUWST                          WHUWST
     I              ADUXST                          WHUXST
     I              ADVSST                          WHVSST
     I              ADAATM                          WHAATM
     I              ADAYNA                          WHAYNA
     I              ADA0NA                          WHA0NA
     I              ADAXDT                          WHAXDT
     I              ADQDSC                          WHQDSC
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WIRMNB
     I              FJAIC3                          WIAIC3
     I              FJAODT                          WIAODT
     I              FJPJST                          WIPJST
     I              FJPKST                          WIPKST
     I              FJRNNB                          WIRNNB
     I              FJDMTX                          WIDMTX
     I              FJDNTX                          WIDNTX
     I              FJDOTX                          WIDOTX
     I              FJWTTX                          WIWTTX
     I              FJWUTX                          WIWUTX
     I              FJRPNB                          WIRPNB
     I              FJFLAM                          WIFLAM
     I              FJXQST                          WIXQST
     I              FJRRNB                          WIRRNB
     I              FJDXTX                          WIDXTX
     I              FJDYTX                          WIDYTX
     I              FJSBNB                          WISBNB
     I              FJBZNA                          WIBZNA
     I              FJRONB                          WIRONB
     I              FJSQNB                          WISQNB
     I              FJR1NB                          WIR1NB
     I              FJVCST                          WIVCST
     I              FJVDST                          WIVDST
     I              FJSDNB                          WISDNB
     I              FJPAOU                          WIPAOU
     I              FJDGWG                          WIDGWG
     I              FJSXNB                          WISXNB
     I              FJHADT                          WIHADT
     I              FJAART                          WIAART
     I              FJDHWG                          WIDHWG
     I              FJDIWG                          WIDIWG
     I              FJAQDT                          WIAQDT
     I              FJS6NB                          WIS6NB
     I              FJT4NB                          WIT4NB
     I              FJPRTM                          WIPRTM
     I              FJNPSV                          WINPSV
     I              FJJ8TX                          WIJ8TX
     I              FJTLMI                          WITLMI
     I              FJJ9TX                          WIJ9TX
     I              FJQ2CD                          WIQ2CD
     I              FJVPCD                          WIVPCD
     I              FJDBCD                          WIDBCD
     I              FJGRWE                          WIGRWE
     I              FJXCCD                          WIXCCD
     I              FJU2ST                          WIU2ST
     I              FJF9DT                          WIF9DT
     I              FJONTM                          WIONTM
     I              FJJ4DT                          WIJ4DT
     I              FJTRTM                          WITRTM
     I              FJJ5DT                          WIJ5DT
     I              FJSPTM                          WISPTM
     I              FJJ6DT                          WIJ6DT
     I              FJLFTM                          WILFTM
     I              FJJ7DT                          WIJ7DT
     I              FJBOTM                          WIBOTM
     I              FJJ8DT                          WIJ8DT
     I              FJBLTM                          WIBLTM
     I              FJKIDT                          WIKIDT
     I              FJASTM                          WIASTM
     I              FJKADT                          WIKADT
     I              FJAJCM                          WIAJCM
     I              FJXACD                          WIXACD
     I              FJOANA                          WIOANA
     I              FJK4TX                          WIK4TX
     I              FJVOAG                          WIVOAG
     I              FJKBDT                          WIKBDT
     I              FJNBBO                          WINBBO
     I              FJW4CD                          WIW4CD
     I              FJEFDT                          WIEFDT
     I              FJCNTN                          WICNTN
     I              FJKCDT                          WIKCDT
     I              FJTMIN                          WITMIN
     I              FJKDDT                          WIKDDT
     I              FJVMNB                          WIVMNB
     I              FJOCFR                          WIOCFR
     I              FJKJDT                          WIKJDT
     I              FJATTM                          WIATTM
     I              FJOTRS                          WIOTRS
     I              FJRNST                          WIRNST
     I              FJBRBK                          WIBRBK
     I              FJEIDT                          WIEIDT
     I              FJRMST                          WIRMST
     I              FJAJCD                          WIAJCD
     I              FJKKDT                          WIKKDT
     I              FJAVTM                          WIAVTM
     I              FJKZDT                          WIKZDT
     I              FJAXTM                          WIAXTM
     I              FJLHOS                          WILHOS
     I              FJLHOR                          WILHOR
     I              FJWNTX                          WIWNTX
     I              FJOITX                          WIOITX
     I              FJOJTX                          WIOJTX
     I              FJLLDT                          WILLDT
     I              FJLSHG                          WILSHG
     I              FJYPST                          WIYPST
     I              FJK0DT                          WIK0DT
     I              FJAYTM                          WIAYTM
     I              FJKNNX                          WIKNNX
     I              FJICWG                          WIICWG
     I              FJIDWG                          WIIDWG
     I              FJH9SX                          WIH9SX
     I              FJWOTX                          WIWOTX
     I              FJK1DT                          WIK1DT
     I              FJAZTM                          WIAZTM
     I              FJK2DT                          WIK2DT
     I              FJA0TM                          WIA0TM
     I              FJROST                          WIROST
     I              FJRPST                          WIRPST
     I              FJRQST                          WIRQST
     I              FJRRST                          WIRRST
     I              FJZBVA                          WIZBVA
     I              FJWPTX                          WIWPTX
     I              FJWQTX                          WIWQTX
     I              FJWRTX                          WIWRTX
     I              FJWSTX                          WIWSTX
     I              FJRVSX                          WIRVSX
     I              FJRUSX                          WIRUSX
     I              FJRWSX                          WIRWSX
     I              FJRXSX                          WIRXSX
     I              FJRYSX                          WIRYSX
     I              FJRZSX                          WIRZSX
     I              FJR0SX                          WIR0SX
     I              FJR1SX                          WIR1SX
     I              FJR2SX                          WIR2SX
     I              FJR3SX                          WIR3SX
     I              FJR4SX                          WIR4SX
     I              FJPYDT                          WIPYDT
     I              FJCKTM                          WICKTM
     I              FJPZDT                          WIPZDT
     I              FJCLTM                          WICLTM
     I              FJP0DT                          WIP0DT
     I              FJCMTM                          WICMTM
     I              FJP1DT                          WIP1DT
     I              FJCNTM                          WICNTM
     I              FJP2DT                          WIP2DT
     I              FJCOTM                          WICOTM
     I              FJP3DT                          WIP3DT
     I              FJCQTM                          WICQTM
     I              FJUVST                          WIUVST
     I              FJUWST                          WIUWST
     I              FJUXST                          WIUXST
     I              FJAATM                          WIAATM
     I              FJAYNA                          WIAYNA
     I              FJA0NA                          WIA0NA
     I              FJAXDT                          WIAXDT
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WJRMNB
     I              FLRUNB                          WJRUNB
     I              FLRVNB                          WJRVNB
     I              FLDQTX                          WJDQTX
     I              FLRWNB                          WJRWNB
     I              FLRXNB                          WJRXNB
     I              FLSQNB                          WJSQNB
     I              FLT0NB                          WJT0NB
     I              FLT1NB                          WJT1NB
     I              FLR1NB                          WJR1NB
     I              FLAIC3                          WJAIC3
     I              FLC4NB                          WJC4NB
     I              FLVCST                          WJVCST
     I              FLKEDT                          WJKEDT
     I              FLSXNB                          WJSXNB
     I              FLKFDT                          WJKFDT
     I              FLACTM                          WJACTM
     I              FLK5TX                          WJK5TX
     I              FLW5CD                          WJW5CD
     I              FLEJDT                          WJEJDT
     I              FLAGTM                          WJAGTM
     I              FLKJDT                          WJKJDT
     I              FLATTM                          WJATTM
     I              FLHDDT                          WJHDDT
     I              FLAUTM                          WJAUTM
     I              FLKKDT                          WJKKDT
     I              FLAVTM                          WJAVTM
     I              FLZ4NB                          WJZ4NB
     I              FLY7ST                          WJY7ST
     I              FLY2ST                          WJY2ST
     I              FLWHTX                          WJWHTX
     I              FLWITX                          WJWITX
     I              FLWJTX                          WJWJTX
     I              FLWKTX                          WJWKTX
     I              FLWLTX                          WJWLTX
     I              FLN7DT                          WJN7DT
     I              FLN8DT                          WJN8DT
     I              FLN9DT                          WJN9DT
     I              FLB3TM                          WJB3TM
     I              FLB4TM                          WJB4TM
     I              FLB5TM                          WJB5TM
     I              FLIASX                          WJIASX
     I              FLIBSX                          WJIBSX
     I              FLICSX                          WJICSX
     I              FLWVTX                          WJWVTX
     I              FLWWTX                          WJWWTX
     I              FLWXTX                          WJWXTX
     I              FLUVST                          WJUVST
     I              FLUWST                          WJUWST
     I              FLUXST                          WJUXST
     I              FLAATM                          WJAATM
     I              FLAYNA                          WJAYNA
     I              FLA0NA                          WJA0NA
     I              FLAXDT                          WJAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WKRMNB
     I              FLRUNB                          WKRUNB
     I              FLRVNB                          WKRVNB
     I              FLDQTX                          WKDQTX
     I              FLRWNB                          WKRWNB
     I              FLRXNB                          WKRXNB
     I              FLSQNB                          WKSQNB
     I              FLT0NB                          WKT0NB
     I              FLT1NB                          WKT1NB
     I              FLR1NB                          WKR1NB
     I              FLAIC3                          WKAIC3
     I              FLC4NB                          WKC4NB
     I              FLVCST                          WKVCST
     I              FLKEDT                          WKKEDT
     I              FLSXNB                          WKSXNB
     I              FLKFDT                          WKKFDT
     I              FLACTM                          WKACTM
     I              FLK5TX                          WKK5TX
     I              FLW5CD                          WKW5CD
     I              FLEJDT                          WKEJDT
     I              FLAGTM                          WKAGTM
     I              FLKJDT                          WKKJDT
     I              FLATTM                          WKATTM
     I              FLHDDT                          WKHDDT
     I              FLAUTM                          WKAUTM
     I              FLKKDT                          WKKKDT
     I              FLAVTM                          WKAVTM
     I              FLZ4NB                          WKZ4NB
     I              FLY7ST                          WKY7ST
     I              FLY2ST                          WKY2ST
     I              FLWHTX                          WKWHTX
     I              FLWITX                          WKWITX
     I              FLWJTX                          WKWJTX
     I              FLWKTX                          WKWKTX
     I              FLWLTX                          WKWLTX
     I              FLN7DT                          WKN7DT
     I              FLN8DT                          WKN8DT
     I              FLN9DT                          WKN9DT
     I              FLB3TM                          WKB3TM
     I              FLB4TM                          WKB4TM
     I              FLB5TM                          WKB5TM
     I              FLIASX                          WKIASX
     I              FLIBSX                          WKIBSX
     I              FLICSX                          WKICSX
     I              FLWVTX                          WKWVTX
     I              FLWWTX                          WKWWTX
     I              FLWXTX                          WKWXTX
     I              FLUVST                          WKUVST
     I              FLUWST                          WKUWST
     I              FLUXST                          WKUXST
     I              FLAATM                          WKAATM
     I              FLAYNA                          WKAYNA
     I              FLA0NA                          WKA0NA
     I              FLAXDT                          WKAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WLRMNB
     I              FLRUNB                          WLRUNB
     I              FLRVNB                          WLRVNB
     I              FLDQTX                          WLDQTX
     I              FLRWNB                          WLRWNB
     I              FLRXNB                          WLRXNB
     I              FLSQNB                          WLSQNB
     I              FLT0NB                          WLT0NB
     I              FLT1NB                          WLT1NB
     I              FLR1NB                          WLR1NB
     I              FLAIC3                          WLAIC3
     I              FLC4NB                          WLC4NB
     I              FLVCST                          WLVCST
     I              FLKEDT                          WLKEDT
     I              FLSXNB                          WLSXNB
     I              FLKFDT                          WLKFDT
     I              FLACTM                          WLACTM
     I              FLK5TX                          WLK5TX
     I              FLW5CD                          WLW5CD
     I              FLEJDT                          WLEJDT
     I              FLAGTM                          WLAGTM
     I              FLKJDT                          WLKJDT
     I              FLATTM                          WLATTM
     I              FLHDDT                          WLHDDT
     I              FLAUTM                          WLAUTM
     I              FLKKDT                          WLKKDT
     I              FLAVTM                          WLAVTM
     I              FLZ4NB                          WLZ4NB
     I              FLY7ST                          WLY7ST
     I              FLY2ST                          WLY2ST
     I              FLWHTX                          WLWHTX
     I              FLWITX                          WLWITX
     I              FLWJTX                          WLWJTX
     I              FLWKTX                          WLWKTX
     I              FLWLTX                          WLWLTX
     I              FLN7DT                          WLN7DT
     I              FLN8DT                          WLN8DT
     I              FLN9DT                          WLN9DT
     I              FLB3TM                          WLB3TM
     I              FLB4TM                          WLB4TM
     I              FLB5TM                          WLB5TM
     I              FLIASX                          WLIASX
     I              FLIBSX                          WLIBSX
     I              FLICSX                          WLICSX
     I              FLWVTX                          WLWVTX
     I              FLWWTX                          WLWWTX
     I              FLWXTX                          WLWXTX
     I              FLUVST                          WLUVST
     I              FLUWST                          WLUWST
     I              FLUXST                          WLUXST
     I              FLAATM                          WLAATM
     I              FLAYNA                          WLAYNA
     I              FLA0NA                          WLA0NA
     I              FLAXDT                          WLAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WMRMNB
     I              FLRUNB                          WMRUNB
     I              FLRVNB                          WMRVNB
     I              FLDQTX                          WMDQTX
     I              FLRWNB                          WMRWNB
     I              FLRXNB                          WMRXNB
     I              FLSQNB                          WMSQNB
     I              FLT0NB                          WMT0NB
     I              FLT1NB                          WMT1NB
     I              FLR1NB                          WMR1NB
     I              FLAIC3                          WMAIC3
     I              FLC4NB                          WMC4NB
     I              FLVCST                          WMVCST
     I              FLKEDT                          WMKEDT
     I              FLSXNB                          WMSXNB
     I              FLKFDT                          WMKFDT
     I              FLACTM                          WMACTM
     I              FLK5TX                          WMK5TX
     I              FLW5CD                          WMW5CD
     I              FLEJDT                          WMEJDT
     I              FLAGTM                          WMAGTM
     I              FLKJDT                          WMKJDT
     I              FLATTM                          WMATTM
     I              FLHDDT                          WMHDDT
     I              FLAUTM                          WMAUTM
     I              FLKKDT                          WMKKDT
     I              FLAVTM                          WMAVTM
     I              FLZ4NB                          WMZ4NB
     I              FLY7ST                          WMY7ST
     I              FLY2ST                          WMY2ST
     I              FLWHTX                          WMWHTX
     I              FLWITX                          WMWITX
     I              FLWJTX                          WMWJTX
     I              FLWKTX                          WMWKTX
     I              FLWLTX                          WMWLTX
     I              FLN7DT                          WMN7DT
     I              FLN8DT                          WMN8DT
     I              FLN9DT                          WMN9DT
     I              FLB3TM                          WMB3TM
     I              FLB4TM                          WMB4TM
     I              FLB5TM                          WMB5TM
     I              FLIASX                          WMIASX
     I              FLIBSX                          WMIBSX
     I              FLICSX                          WMICSX
     I              FLWVTX                          WMWVTX
     I              FLWWTX                          WMWWTX
     I              FLWXTX                          WMWXTX
     I              FLUVST                          WMUVST
     I              FLUWST                          WMUWST
     I              FLUXST                          WMUXST
     I              FLAATM                          WMAATM
     I              FLAYNA                          WMAYNA
     I              FLA0NA                          WMA0NA
     I              FLAXDT                          WMAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WOAIC3
     I              OMC4NB                          WOC4NB
     I              OMDPNB                          WODPNB
     I              OMUENB                          WOUENB
     I              OMHGCD                          WOHGCD
     I              OMAJCD                          WOAJCD
     I              OMBKC7                          WOBKC7
     I              OMCFC7                          WOCFC7
     I              OMGMST                          WOGMST
     I              OMGNST                          WOGNST
     I              OMMAVA                          WOMAVA
     I              OMKDVA                          WOKDVA
     I              OML8VA                          WOL8VA
     I              OML9VA                          WOL9VA
     I              OMGTST                          WOGTST
     I              OMGVST                          WOGVST
     I              OMGUST                          WOGUST
     I              OMQFST                          WOQFST
     I              OMAYVA                          WOAYVA
     I              OMEXDT                          WOEXDT
     I              OMLQCD                          WOLQCD
     I              OMRDCD                          WORDCD
     I              OMQ7CD                          WOQ7CD
     I              OMBZPR                          WOBZPR
     I              OML6NB                          WOL6NB
     I              OMU1ST                          WOU1ST
     I              OMGIDT                          WOGIDT
     I              OMCRCD                          WOCRCD
     I              OMAGCD                          WOAGCD
     I              OMRZST                          WORZST
     I              OMR0ST                          WOR0ST
     I              OMR1ST                          WOR1ST
     I              OMG7NA                          WOG7NA
     I              OMG8NA                          WOG8NA
     I              OMRPCD                          WORPCD
     I              OMVEST                          WOVEST
     I              OMVGST                          WOVGST
     I              OMAVST                          WOAVST
     I              OMU0ST                          WOU0ST
     I              OMRFCD                          WORFCD
     I              OMFZST                          WOFZST
     I              OMR1NB                          WOR1NB
     I              OMAVQT                          WOAVQT
     I              OMD0WG                          WOD0WG
     I              OMCCQT                          WOCCQT
     I              OMAUWG                          WOAUWG
     I              OMCBQT                          WOCBQT
     I              OMATWG                          WOATWG
     I              OMAQCS                          WOAQCS
     I              OMAGCS                          WOAGCS
     I              OMAKPR                          WOAKPR
     I              OMALPR                          WOALPR
     I              OMAUPR                          WOAUPR
     I              OMAVWG                          WOAVWG
     I              OMA4WG                          WOA4WG
     I              OMA5DT                          WOA5DT
     I              OMAODT                          WOAODT
     I              OMGNDT                          WOGNDT
     I              OMAMST                          WOAMST
     I              OMANST                          WOANST
     I              OMVAST                          WOVAST
     I              OMRGNB                          WORGNB
     I              OMRHNB                          WORHNB
     I              OMRINB                          WORINB
     I              OMRBCD                          WORBCD
     I              OMHICD                          WOHICD
     I              OMRNCD                          WORNCD
     I              OMROCD                          WOROCD
     I              OMCXDT                          WOCXDT
     I              OMAJVN                          WOAJVN
     I              OMKXCD                          WOKXCD
     I              OMJPCD                          WOJPCD
     I              OMCQCD                          WOCQCD
     I              OMR4CD                          WOR4CD
     I              OMZ1ST                          WOZ1ST
     I              OMZ3ST                          WOZ3ST
     I              OMZ4ST                          WOZ4ST
     I              OMDUPR                          WODUPR
     I              OMB6VL                          WOB6VL
     I              OMA1AA                          WOA1AA
     I              OMFZSX                          WOFZSX
     I              OMF0SX                          WOF0SX
     I              OMF1SX                          WOF1SX
     I              OMF2SX                          WOF2SX
     I              OMF3SX                          WOF3SX
     I              OMF4SX                          WOF4SX
     I              OMF5SX                          WOF5SX
     I              OMF6SX                          WOF6SX
     I              OMF7SX                          WOF7SX
     I              OMNTDT                          WONTDT
     I              OMNUDT                          WONUDT
     I              OMNVDT                          WONVDT
     I              OMNWDT                          WONWDT
     I              OMNXDT                          WONXDT
     I              OMBUTM                          WOBUTM
     I              OMBVTM                          WOBVTM
     I              OMBWTM                          WOBWTM
     I              OMBXTM                          WOBXTM
     I              OMBYTM                          WOBYTM
     I              OMH5NX                          WOH5NX
     I              OMH6NX                          WOH6NX
     I              OMH7NX                          WOH7NX
     I              OMH8NX                          WOH8NX
     I              OMH9NX                          WOH9NX
     I              OMDVPR                          WODVPR
     I              OMDWPR                          WODWPR
     I              OMDXPR                          WODXPR
     I              OMDYPR                          WODYPR
     I              OMDZPR                          WODZPR
     I              OMGSPR                          WOGSPR
     I              OMGTPR                          WOGTPR
     I              OMGUPR                          WOGUPR
     I              OMHOST                          WOHOST
     I              OMHPST                          WOHPST
     I              OMIOST                          WOIOST
     I              OMPEWG                          WOPEWG
     I              OMRINY                          WORINY
     I              OMTIDT                          WOTIDT
     I              OMTJDT                          WOTJDT
     I              OMH2ST                          WOH2ST
     I              OMH0ST                          WOH0ST
     I              OMH1ST                          WOH1ST
     I              OMTKDT                          WOTKDT
     I              OMTLDT                          WOTLDT
     I              OMTMDT                          WOTMDT
     I              OMUVST                          WOUVST
     I              OMUWST                          WOUWST
     I              OMUXST                          WOUXST
     I              OMAATM                          WOAATM
     I              OMAYNA                          WOAYNA
     I              OMA0NA                          WOA0NA
     I              OMAXDT                          WOAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      * Outward parameters
     IPBRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PBRMNB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WIRMNB
     I              FJAIC3                          WIAIC3
     I              FJAODT                          WIAODT
     I              FJPJST                          WIPJST
     I              FJPKST                          WIPKST
     I              FJRNNB                          WIRNNB
     I              FJDMTX                          WIDMTX
     I              FJDNTX                          WIDNTX
     I              FJDOTX                          WIDOTX
     I              FJWTTX                          WIWTTX
     I              FJWUTX                          WIWUTX
     I              FJRPNB                          WIRPNB
     I              FJFLAM                          WIFLAM
     I              FJXQST                          WIXQST
     I              FJRRNB                          WIRRNB
     I              FJDXTX                          WIDXTX
     I              FJDYTX                          WIDYTX
     I              FJSBNB                          WISBNB
     I              FJBZNA                          WIBZNA
     I              FJRONB                          WIRONB
     I              FJSQNB                          WISQNB
     I              FJR1NB                          WIR1NB
     I              FJVCST                          WIVCST
     I              FJVDST                          WIVDST
     I              FJSDNB                          WISDNB
     I              FJPAOU                          WIPAOU
     I              FJDGWG                          WIDGWG
     I              FJSXNB                          WISXNB
     I              FJHADT                          WIHADT
     I              FJAART                          WIAART
     I              FJDHWG                          WIDHWG
     I              FJDIWG                          WIDIWG
     I              FJAQDT                          WIAQDT
     I              FJS6NB                          WIS6NB
     I              FJT4NB                          WIT4NB
     I              FJPRTM                          WIPRTM
     I              FJNPSV                          WINPSV
     I              FJJ8TX                          WIJ8TX
     I              FJTLMI                          WITLMI
     I              FJJ9TX                          WIJ9TX
     I              FJQ2CD                          WIQ2CD
     I              FJVPCD                          WIVPCD
     I              FJDBCD                          WIDBCD
     I              FJGRWE                          WIGRWE
     I              FJXCCD                          WIXCCD
     I              FJU2ST                          WIU2ST
     I              FJF9DT                          WIF9DT
     I              FJONTM                          WIONTM
     I              FJJ4DT                          WIJ4DT
     I              FJTRTM                          WITRTM
     I              FJJ5DT                          WIJ5DT
     I              FJSPTM                          WISPTM
     I              FJJ6DT                          WIJ6DT
     I              FJLFTM                          WILFTM
     I              FJJ7DT                          WIJ7DT
     I              FJBOTM                          WIBOTM
     I              FJJ8DT                          WIJ8DT
     I              FJBLTM                          WIBLTM
     I              FJKIDT                          WIKIDT
     I              FJASTM                          WIASTM
     I              FJKADT                          WIKADT
     I              FJAJCM                          WIAJCM
     I              FJXACD                          WIXACD
     I              FJOANA                          WIOANA
     I              FJK4TX                          WIK4TX
     I              FJVOAG                          WIVOAG
     I              FJKBDT                          WIKBDT
     I              FJNBBO                          WINBBO
     I              FJW4CD                          WIW4CD
     I              FJEFDT                          WIEFDT
     I              FJCNTN                          WICNTN
     I              FJKCDT                          WIKCDT
     I              FJTMIN                          WITMIN
     I              FJKDDT                          WIKDDT
     I              FJVMNB                          WIVMNB
     I              FJOCFR                          WIOCFR
     I              FJKJDT                          WIKJDT
     I              FJATTM                          WIATTM
     I              FJOTRS                          WIOTRS
     I              FJRNST                          WIRNST
     I              FJBRBK                          WIBRBK
     I              FJEIDT                          WIEIDT
     I              FJRMST                          WIRMST
     I              FJAJCD                          WIAJCD
     I              FJKKDT                          WIKKDT
     I              FJAVTM                          WIAVTM
     I              FJKZDT                          WIKZDT
     I              FJAXTM                          WIAXTM
     I              FJLHOS                          WILHOS
     I              FJLHOR                          WILHOR
     I              FJWNTX                          WIWNTX
     I              FJOITX                          WIOITX
     I              FJOJTX                          WIOJTX
     I              FJLLDT                          WILLDT
     I              FJLSHG                          WILSHG
     I              FJYPST                          WIYPST
     I              FJK0DT                          WIK0DT
     I              FJAYTM                          WIAYTM
     I              FJKNNX                          WIKNNX
     I              FJICWG                          WIICWG
     I              FJIDWG                          WIIDWG
     I              FJH9SX                          WIH9SX
     I              FJWOTX                          WIWOTX
     I              FJK1DT                          WIK1DT
     I              FJAZTM                          WIAZTM
     I              FJK2DT                          WIK2DT
     I              FJA0TM                          WIA0TM
     I              FJROST                          WIROST
     I              FJRPST                          WIRPST
     I              FJRQST                          WIRQST
     I              FJRRST                          WIRRST
     I              FJZBVA                          WIZBVA
     I              FJWPTX                          WIWPTX
     I              FJWQTX                          WIWQTX
     I              FJWRTX                          WIWRTX
     I              FJWSTX                          WIWSTX
     I              FJRVSX                          WIRVSX
     I              FJRUSX                          WIRUSX
     I              FJRWSX                          WIRWSX
     I              FJRXSX                          WIRXSX
     I              FJRYSX                          WIRYSX
     I              FJRZSX                          WIRZSX
     I              FJR0SX                          WIR0SX
     I              FJR1SX                          WIR1SX
     I              FJR2SX                          WIR2SX
     I              FJR3SX                          WIR3SX
     I              FJR4SX                          WIR4SX
     I              FJPYDT                          WIPYDT
     I              FJCKTM                          WICKTM
     I              FJPZDT                          WIPZDT
     I              FJCLTM                          WICLTM
     I              FJP0DT                          WIP0DT
     I              FJCMTM                          WICMTM
     I              FJP1DT                          WIP1DT
     I              FJCNTM                          WICNTM
     I              FJP2DT                          WIP2DT
     I              FJCOTM                          WICOTM
     I              FJP3DT                          WIP3DT
     I              FJCQTM                          WICQTM
     I              FJUVST                          WIUVST
     I              FJUWST                          WIUWST
     I              FJUXST                          WIUXST
     I              FJAATM                          WIAATM
     I              FJAYNA                          WIAYNA
     I              FJA0NA                          WIA0NA
     I              FJAXDT                          WIAXDT
      *
     IYBRDCS      DS                            793
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYCRDCS      DS                            793
      * Outward parameters
     IPCRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PCDXNB
      * I :  Load ID
     I                                    P  11  140PCRMNB
      * I :  Stop_Drop
     I                                    P  15  170PCRVNB
      * I :  Load Change Type
     I                                       18  23 PCRVST
      * I :  Department Control Code
     I                                       24  26 PCUJST
      * I :  Change Log Prior Value
     I                                       27  38 PCMNTX
      * I :  Change Log New Value
     I                                       39  50 PCMOTX
      * I :  User Id
     I                                       51  60 PCAYNA
      * I :  Job Name
     I                                       61  70 PCA0NA
      * I :  Carrier Code
     I                                       71  73 PCBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PCXMCD
      * I :  Company Number
     I                                    P  77  780PCAIC3
      * I :  Order Number
     I                                    P  79  820PCC4NB
      *
      * Outward parameters
     IPDRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * I :  Created Date
     I                                    P   1   40PDK4DT
      * I :  Created Time
     I                                    P   5   80PDA1TM
      * I :  Sequence Number
     I                                    P   9  100PDDXNB
      * I :  Load ID
     I                                    P  11  140PDRMNB
      * I :  Stop_Drop
     I                                    P  15  170PDRVNB
      * I :  Load Change Type
     I                                       18  23 PDRVST
      * I :  Department Control Code
     I                                       24  26 PDUJST
      * I :  Change Log Prior Value
     I                                       27  38 PDMNTX
      * I :  Change Log New Value
     I                                       39  50 PDMOTX
      * I :  User Id
     I                                       51  60 PDAYNA
      * I :  Job Name
     I                                       61  70 PDA0NA
      * I :  Carrier Code
     I                                       71  73 PDBZNA
      * I :  Carrier Broker Carrier Co
     I                                       74  76 PDXMCD
      * I :  Company Number
     I                                    P  77  780PDAIC3
      * I :  Order Number
     I                                    P  79  820PDC4NB
      *
     IYDRDCS      DS                            793
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WMRMNB
     I              FLRUNB                          WMRUNB
     I              FLRVNB                          WMRVNB
     I              FLDQTX                          WMDQTX
     I              FLRWNB                          WMRWNB
     I              FLRXNB                          WMRXNB
     I              FLSQNB                          WMSQNB
     I              FLT0NB                          WMT0NB
     I              FLT1NB                          WMT1NB
     I              FLR1NB                          WMR1NB
     I              FLAIC3                          WMAIC3
     I              FLC4NB                          WMC4NB
     I              FLVCST                          WMVCST
     I              FLKEDT                          WMKEDT
     I              FLSXNB                          WMSXNB
     I              FLKFDT                          WMKFDT
     I              FLACTM                          WMACTM
     I              FLK5TX                          WMK5TX
     I              FLW5CD                          WMW5CD
     I              FLEJDT                          WMEJDT
     I              FLAGTM                          WMAGTM
     I              FLKJDT                          WMKJDT
     I              FLATTM                          WMATTM
     I              FLHDDT                          WMHDDT
     I              FLAUTM                          WMAUTM
     I              FLKKDT                          WMKKDT
     I              FLAVTM                          WMAVTM
     I              FLZ4NB                          WMZ4NB
     I              FLY7ST                          WMY7ST
     I              FLY2ST                          WMY2ST
     I              FLWHTX                          WMWHTX
     I              FLWITX                          WMWITX
     I              FLWJTX                          WMWJTX
     I              FLWKTX                          WMWKTX
     I              FLWLTX                          WMWLTX
     I              FLN7DT                          WMN7DT
     I              FLN8DT                          WMN8DT
     I              FLN9DT                          WMN9DT
     I              FLB3TM                          WMB3TM
     I              FLB4TM                          WMB4TM
     I              FLB5TM                          WMB5TM
     I              FLIASX                          WMIASX
     I              FLIBSX                          WMIBSX
     I              FLICSX                          WMICSX
     I              FLWVTX                          WMWVTX
     I              FLWWTX                          WMWWTX
     I              FLWXTX                          WMWXTX
     I              FLUVST                          WMUVST
     I              FLUWST                          WMUWST
     I              FLUXST                          WMUXST
     I              FLAATM                          WMAATM
     I              FLAYNA                          WMAYNA
     I              FLA0NA                          WMA0NA
     I              FLAXDT                          WMAXDT
      *
     IYERDCS      DS                            367
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WOAIC3
     I              OMC4NB                          WOC4NB
     I              OMDPNB                          WODPNB
     I              OMUENB                          WOUENB
     I              OMHGCD                          WOHGCD
     I              OMAJCD                          WOAJCD
     I              OMBKC7                          WOBKC7
     I              OMCFC7                          WOCFC7
     I              OMGMST                          WOGMST
     I              OMGNST                          WOGNST
     I              OMMAVA                          WOMAVA
     I              OMKDVA                          WOKDVA
     I              OML8VA                          WOL8VA
     I              OML9VA                          WOL9VA
     I              OMGTST                          WOGTST
     I              OMGVST                          WOGVST
     I              OMGUST                          WOGUST
     I              OMQFST                          WOQFST
     I              OMAYVA                          WOAYVA
     I              OMEXDT                          WOEXDT
     I              OMLQCD                          WOLQCD
     I              OMRDCD                          WORDCD
     I              OMQ7CD                          WOQ7CD
     I              OMBZPR                          WOBZPR
     I              OML6NB                          WOL6NB
     I              OMU1ST                          WOU1ST
     I              OMGIDT                          WOGIDT
     I              OMCRCD                          WOCRCD
     I              OMAGCD                          WOAGCD
     I              OMRZST                          WORZST
     I              OMR0ST                          WOR0ST
     I              OMR1ST                          WOR1ST
     I              OMG7NA                          WOG7NA
     I              OMG8NA                          WOG8NA
     I              OMRPCD                          WORPCD
     I              OMVEST                          WOVEST
     I              OMVGST                          WOVGST
     I              OMAVST                          WOAVST
     I              OMU0ST                          WOU0ST
     I              OMRFCD                          WORFCD
     I              OMFZST                          WOFZST
     I              OMR1NB                          WOR1NB
     I              OMAVQT                          WOAVQT
     I              OMD0WG                          WOD0WG
     I              OMCCQT                          WOCCQT
     I              OMAUWG                          WOAUWG
     I              OMCBQT                          WOCBQT
     I              OMATWG                          WOATWG
     I              OMAQCS                          WOAQCS
     I              OMAGCS                          WOAGCS
     I              OMAKPR                          WOAKPR
     I              OMALPR                          WOALPR
     I              OMAUPR                          WOAUPR
     I              OMAVWG                          WOAVWG
     I              OMA4WG                          WOA4WG
     I              OMA5DT                          WOA5DT
     I              OMAODT                          WOAODT
     I              OMGNDT                          WOGNDT
     I              OMAMST                          WOAMST
     I              OMANST                          WOANST
     I              OMVAST                          WOVAST
     I              OMRGNB                          WORGNB
     I              OMRHNB                          WORHNB
     I              OMRINB                          WORINB
     I              OMRBCD                          WORBCD
     I              OMHICD                          WOHICD
     I              OMRNCD                          WORNCD
     I              OMROCD                          WOROCD
     I              OMCXDT                          WOCXDT
     I              OMAJVN                          WOAJVN
     I              OMKXCD                          WOKXCD
     I              OMJPCD                          WOJPCD
     I              OMCQCD                          WOCQCD
     I              OMR4CD                          WOR4CD
     I              OMZ1ST                          WOZ1ST
     I              OMZ3ST                          WOZ3ST
     I              OMZ4ST                          WOZ4ST
     I              OMDUPR                          WODUPR
     I              OMB6VL                          WOB6VL
     I              OMA1AA                          WOA1AA
     I              OMFZSX                          WOFZSX
     I              OMF0SX                          WOF0SX
     I              OMF1SX                          WOF1SX
     I              OMF2SX                          WOF2SX
     I              OMF3SX                          WOF3SX
     I              OMF4SX                          WOF4SX
     I              OMF5SX                          WOF5SX
     I              OMF6SX                          WOF6SX
     I              OMF7SX                          WOF7SX
     I              OMNTDT                          WONTDT
     I              OMNUDT                          WONUDT
     I              OMNVDT                          WONVDT
     I              OMNWDT                          WONWDT
     I              OMNXDT                          WONXDT
     I              OMBUTM                          WOBUTM
     I              OMBVTM                          WOBVTM
     I              OMBWTM                          WOBWTM
     I              OMBXTM                          WOBXTM
     I              OMBYTM                          WOBYTM
     I              OMH5NX                          WOH5NX
     I              OMH6NX                          WOH6NX
     I              OMH7NX                          WOH7NX
     I              OMH8NX                          WOH8NX
     I              OMH9NX                          WOH9NX
     I              OMDVPR                          WODVPR
     I              OMDWPR                          WODWPR
     I              OMDXPR                          WODXPR
     I              OMDYPR                          WODYPR
     I              OMDZPR                          WODZPR
     I              OMGSPR                          WOGSPR
     I              OMGTPR                          WOGTPR
     I              OMGUPR                          WOGUPR
     I              OMHOST                          WOHOST
     I              OMHPST                          WOHPST
     I              OMIOST                          WOIOST
     I              OMPEWG                          WOPEWG
     I              OMRINY                          WORINY
     I              OMTIDT                          WOTIDT
     I              OMTJDT                          WOTJDT
     I              OMH2ST                          WOH2ST
     I              OMH0ST                          WOH0ST
     I              OMH1ST                          WOH1ST
     I              OMTKDT                          WOTKDT
     I              OMTLDT                          WOTLDT
     I              OMTMDT                          WOTMDT
     I              OMUVST                          WOUVST
     I              OMUWST                          WOUWST
     I              OMUXST                          WOUXST
     I              OMAATM                          WOAATM
     I              OMAYNA                          WOAYNA
     I              OMA0NA                          WOA0NA
     I              OMAXDT                          WOAXDT
      *
     IYFRDCS      DS                            525
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Application Code
     I                                        6  11 P1DNCD
      * N :  Salesperson Code
     I                                       12  14 P1BCCD
      * N :  User Profile Name
     I                                       15  24 P1AJVN
      * N :  Allow Multi_Company
     I                                       25  25 P1I6ST
      * N :  Default Printer
     I                                       26  35 P1MPNA
      * N :  First Time Flag
     I                                       36  36 P1TAST
     IP2PARM      DS
      * FLD: Order Header TRG
      * N :  Credit Hold
     I                                        1   1 P2XIST
      * N :  Production Hold
     I                                        2   2 P2XJST
      * N :  New Customer Hold
     I                                        3   3 P2XKST
     IP3PARM      DS
      * FLD: User Profile Control
      * N :  Credit Hold Authority
     I                                        1   1 P3XMST
      * N :  Production Hold Authority
     I                                        2   2 P3XNST
     IP4PARM      DS
      * N : MAP USR Reason Code
     I                                        1   3 P4O9CD
     IP5PARM      DS
      * N :  Error Status
     I                                        1   1 P5ECST
     IP6PARM      DS
      * N :  USR Status (Y/N)
     I                                        1   1 P6E6ST
     IP7PARM      DS
      * FLD: Load Order Change Log
      * N :  Created Date
     I                                    P   1   40P7K4DT
      * N :  Created Time
     I                                    P   5   80P7A1TM
      * N :  Sequence Number
     I                                    P   9  100P7DXNB
      * N :  Load ID
     I                                    P  11  140P7RMNB
      * N :  Stop_Drop
     I                                    P  15  170P7RVNB
      * N :  Load Change Type
     I                                       18  23 P7RVST
      * N :  Department Control Code
     I                                       24  26 P7UJST
      * N :  Change Log Prior Value
     I                                       27  38 P7MNTX
      * N :  Change Log New Value
     I                                       39  50 P7MOTX
      * N :  User Id
     I                                       51  60 P7AYNA
      * N :  Job Name
     I                                       61  70 P7A0NA
      * N :  Carrier Code
     I                                       71  73 P7BZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 P7XMCD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0001
      * Order Number
     I                                        2   8 ZA0002
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0003
      * Message data for 'Order has other holds'
      * Order Number
     I                                        1   7 ZA0004
      * Text USR
     I                                        8  17 ZA0005
      * Message data for 'Order not on Crd Hold'
      * Order Number
     I                                        1   7 ZA0006
      * *SFLSEL
     I                                        8   8 ZA0007
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0008
      * Order Number
     I                                        2   8 ZA0009
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0010
      * Message data for 'Order already on crd hold'
      * Order Number
     I                                        1   7 ZA0011
      * *SFLSEL
     I                                        8   8 ZA0012
      * Message data for 'Load locked Can't Hold Or'
      * *SFLSEL
     I                                        1   1 ZA0013
      * Message data for 'No Orders Assinged - INF'
      * Load ID
     I                                    P   1   40ZA0014
      * *SFLSEL
     I                                        5   5 ZA0015
      * Message data for 'Blck Ord on Ld-no UPD-INF'
      * *SFLSEL
     I                                        1   1 ZA0016
      * Load ID
     I                                    P   2   50ZA0017
      * Message data for 'Load Cant be Locked - INF'
      * *SFLSEL
     I                                        1   1 ZA0018
      * Load ID
     I                                    P   2   50ZA0019
      * Message data for 'Carrier must be ent.- INF'
      * Carrier Code
     I                                        1   3 ZA0020
      * Load ID
     I                                    P   4   70ZA0021
      * Message data for 'Truck size needed - INF'
      * Truck Size
     I                                        1   7 ZA0022
      * Load ID
     I                                    P   8  110ZA0023
      * Message data for 'Shipping Mthd req - INF'
      * Shipping Method
     I                                        1   2 ZA0024
      * Message data for 'Load has ords w/o stp-INF'
      * Load ID
     I                                    P   1   40ZA0025
      * Message data for 'Load is not accepted- INF'
      * Load ID
     I                                    P   1   40ZA0026
      * Message data for 'Load has Ords on Hold-INF'
      * Load ID
     I                                    P   1   40ZA0027
      * *SFLSEL
     I                                        5   5 ZA0028
      * Message data for 'Load has Cncld Ords - INF'
      * Load ID
     I                                    P   1   40ZA0029
      * *SFLSEL
     I                                        5   5 ZA0030
      * Message data for 'Load has Ords in Use-INF'
      * *SFLSEL
     I                                        1   1 ZA0031
      * Load ID
     I                                    P   2   50ZA0032
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0033
      * Load ID
     I                                    P   2   50ZA0034
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0035
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0036
      * USR CDE Parm 1
     I                                        4   6 ZA0037
      * USR CDE Parm 2
     I                                        7   9 ZA0038
      * USR CDE Parm 3
     I                                       10  12 ZA0039
      * USR CDE Parm 4
     I                                       13  15 ZA0040
      * USR CDE Parm 5
     I                                       16  18 ZA0041
      * USR CDE Parm 6
     I                                       19  21 ZA0042
      * USR CDE Parm 7
     I                                       22  24 ZA0043
      * USR CDE Parm 8
     I                                       25  27 ZA0044
      * USR CDE Parm 9
     I                                       28  30 ZA0045
      * Message data for 'Load Locked'
      * Load ID
     I                                    P   1   40ZA0046
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0047
      * Application Code
     I                                       11  16 ZA0048
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0049
      * Application Code
     I                                       11  16 ZA0050
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: PAR.First Time Flag is Yes
     C           P1TAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       P1TAST           First Time Flag
     C                     MOVEL'Y'       #2XIST           Credit Hold
     C                     END                             *FI
      * *Set Cursor: CTL.Order Number  (*Override=*NO)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD008       W0ROW0
     C                     Z-ADD004       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SARVGN
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEAODT           Scheduled Ship
     C                     KFLD           BEC4NB           Order Number
     C                     KFLD           BEAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AODT    BEAODT
     C                     Z-ADD#2C4NB    BEC4NB
     C                     Z-ADD#2AIC3    BEAIC3
     C           KPOS      SETLL@BFCPID
     C                     READ @BFCPID                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2BRTX    WZBRTX
     C                     MOVEL#2BRTX    WZBRTX           Ship To Name
     C           *LIKE     DEFN #CO6NA    WZO6NA
     C                     MOVEL#CO6NA    WZO6NA           Warehouse Desc
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2A0DT    WZA0DT
     C                     MOVEL#2A0DT    WZA0DT           Order Date
     C           *LIKE     DEFN #2A5DT    WZA5DT
     C                     MOVEL#2A5DT    WZA5DT           Requested Ship
     C           *LIKE     DEFN #2CQCD    WZCQCD
     C                     MOVEL#2CQCD    WZCQCD           Reason Code
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2BCST    WZBCST
     C                     MOVEL#2BCST    WZBCST           Block Order Fla
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2R4CD    WZR4CD
     C                     MOVEL#2R4CD    WZR4CD           Sales Route Cod
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2B0C7    WZB0C7
     C                     MOVEL#2B0C7    WZB0C7           Bill to Custome
     C           *LIKE     DEFN #2BCNA    WZBCNA
     C                     MOVEL#2BCNA    WZBCNA           Customer Purcha
     C           *LIKE     DEFN #2CXDT    WZCXDT
     C                     MOVEL#2CXDT    WZCXDT           Date of Origina
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2XIST    WZXIST
     C                     MOVEL#2XIST    WZXIST           Credit Hold
     C           *LIKE     DEFN #2XJST    WZXJST
     C                     MOVEL#2XJST    WZXJST           Production Hold
     C           *LIKE     DEFN #2JZVA    WZJZVA
     C                     MOVEL#2JZVA    WZJZVA           Order Value Tot
     C           *LIKE     DEFN #2BQTM    WZBQTM
     C                     MOVEL#2BQTM    WZBQTM           Time of Origina
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPID                  90*
     C  N82                READ @BFCPID                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,44
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2BRTX    IFNE *BLANK                     Ship To Name
     C           BEBRTX    CABNE#2BRTX    BB020            Ship To Name
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BEBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C           #2A0DT    IFNE *ZERO                      Order Date
     C           BEA0DT    CABNE#2A0DT    BB020            Order Date
     C                     END
     C           #2A5DT    IFNE *ZERO                      Requested Ship
     C           BEA5DT    CABNE#2A5DT    BB020            Requested Ship
     C                     END
     C           #2CQCD    IFNE *BLANK                     Reason Code
     C           BECQCD    CABNE#2CQCD    BB020            Reason Code
     C                     END
     C           #2GWST    IFNE *BLANK                     Header Status
     C           BEGWST    CABNE#2GWST    BB020            Header Status
     C                     END
     C           #2BCST    IFNE *BLANK                     Block Order Fla
     C           BEBCST    CABNE#2BCST    BB020            Block Order Fla
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           BEC4NB    CABNE#2C4NB    BB020            Order Number
     C                     END
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2C4NB    OREQ *ZERO                      Order Number
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           BEAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C                     END
     C           #2R4CD    IFNE *BLANK                     Sales Route Cod
     C           BER4CD    CABNE#2R4CD    BB020            Sales Route Cod
     C                     END
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           BERMNB    CABNE#2RMNB    BB020            Load ID
     C                     END
     C           #2B0C7    IFNE *ZERO                      Bill to Custome
     C           BEB0C7    CABNE#2B0C7    BB020            Bill to Custome
     C                     END
     C           #2CXDT    IFNE *ZERO                      Date of Origina
     C           BECXDT    CABNE#2CXDT    BB020            Date of Origina
     C                     END
     C           #2XIST    IFNE *BLANK                     Credit Hold
     C           BEXIST    CABNE#2XIST    BB020            Credit Hold
     C                     END
     C           #2XJST    IFNE *BLANK                     Production Hold
     C           BEXJST    CABNE#2XJST    BB020            Production Hold
     C                     END
     C           #2JZVA    IFNE *ZERO                      Order Value Tot
     C           BEJZVA    CABNE#2JZVA    BB020            Order Value Tot
     C                     END
     C           #2BQTM    IFNE *ZERO                      Time of Origina
     C           BEBQTM    CABLT#2BQTM    BB020            Time of Origina
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * Match company
      * CASE: CTL.Company Number is not equal to zero
     C           #2AIC3    IFNE *ZERO                      *IF
      * CASE: DB1.Company Number NE CTL.Company Number
     C           BEAIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Match warehouse E01325  2/09/2011 RMC
      * CASE: CTL.Warehouse Code is Not Blanks
     C           #CAJCD    IFNE *BLANK                     *IF
      * RTV 1st Warehouse      RT - Order Detail  * 
     C                     EXSR SBRVGN
      * CASE: LCL.Warehouse Code NE CTL.Warehouse Code
     C           YL0001    IFNE #CAJCD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Exclude Credit/Debit memos
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Exclude credit/debit memos
      * CASE: DB1.Billing Activity Type is Credit or Debit Memo
     C           BEOBST    IFEQ '2'                        *IF
     C           BEOBST    OREQ '3'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RTV LoadSts/Carrier    RT - Load Header  * 
     C                     EXSR SCRVGN
      * Match Load Sts  E2148
      * CASE: CTL.Load Status is All but Blank
     C           #CPKST    IFEQ 'C'                        *IF
     C           #CPKST    OREQ 'E'
     C           #CPKST    OREQ 'I'
     C           #CPKST    OREQ 'L'
     C           #CPKST    OREQ 'S'
     C           #CPKST    OREQ 'U'
      * CASE: RCD.Load Status NE CTL.Load Status
     C           #RPKST    IFNE #CPKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELBEXIST    #RXOST           USR Credit Hold
      * Init screen Credit hold to blank if No.
      * CASE: DB1.Credit Hold is No
     C           BEXIST    IFEQ 'N'                        *IF
     C                     MOVELP2XIST    #RXOST           USR Credit Hold
     C                     END                             *FI
      * Init Prod hold to blank if No.
      * CASE: DB1.Production Hold is No
     C           BEXJST    IFEQ 'N'                        *IF
     C                     MOVELP2XJST    #1XJST           Production Hold
     C                     END                             *FI
      * Init New Cust hold to blank if No.
      * CASE: DB1.New Customer Hold is No
     C           BEXKST    IFEQ 'N'                        *IF
     C                     MOVELP2XKST    #1XKST           New Customer Ho
     C                     END                             *FI
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SDRVGN
      * Retrieve Credit Limits.    8/01/02
     C                     EXSR UASUBR                     Retrieve Credit
      * Use Credit Limit based on flags per Tim -- 1/30/03
      * CASE: LCL.Credit Check A/R Customer is yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0005    #RASVA           Credit Limit
     C                     ELSE
      * CASE: LCL.Credit Check Parent Cust is yes
     C           YL0004    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0006    #RASVA           Credit Limit
     C                     END                             *FI
     C                     END                             *FI
      * Match credit limit              8/4/04
      * CASE: CTL.Credit Limit is not equal to zeros
     C           #CASVA    IFNE *ZERO                      *IF
      * CASE: RCD.Credit Limit NE CTL.Credit Limit
     C           #RASVA    IFNE #CASVA                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0007           Company Number
     C                     Z-ADD#1C4NB    WL0008           Order Number
     C                     Z-ADD*ZERO     WL0009           Order Sequence
     C                     Z-ADD*ZERO     WL0010           Order Secondary
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    #RAJCD    P      Warehouse Code
     C                     MOVELWL0012    YN0005    P      Trans Contol AS
      * RTV Parent Customer    RT - Customer  * 
     C                     EXSR SHRVGN
      * RTV Parent Exp f/hdr  RT - Customer  * 
     C                     EXSR SIRVGN
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPID                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Bill to Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2B0C7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2B0C7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2B0C7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Date of Original Entry
      * External date
     C                     Z-ADDV2CXDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9938  *
     C                     END
     C                     Z-ADDXDINDT    #2CXDT
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Credit Hold
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2XIST'  IFEQ YPMTFD
      * Credit Hold
     C                     MOVEL#2XIST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFXIST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZFXIST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZFXIST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZFXIST
     C                     ENDSL
     C                     EXFMTZEXIST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFXIST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZFXIST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZFXIST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2XIST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Production Hold
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2XJST'  IFEQ YPMTFD
      * Production Hold
     C                     MOVEL#2XJST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFXJST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZFXJST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZFXJST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZFXJST
     C                     ENDSL
     C                     EXFMTZEXJST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFXJST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZFXJST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZFXJST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2XJST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Load Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CPKST'  IFEQ YPMTFD
      * Load Status
     C                     MOVEL#CPKST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFPKST
     C                     SELEC
     C           W0INVL    WHEQ 'U'                        U
     C                     Z-ADD1         ZFPKST
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD2         ZFPKST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZFPKST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD4         ZFPKST
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD5         ZFPKST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD6         ZFPKST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD7         ZFPKST
     C                     ENDSL
     C                     EXFMTZEPKST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFPKST    WHEQ 1
     C                     MOVEL'U'       W0INVL           U
     C           ZFPKST    WHEQ 2
     C                     MOVEL'L'       W0INVL           L
     C           ZFPKST    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C           ZFPKST    WHEQ 4
     C                     MOVEL'E'       W0INVL           E
     C           ZFPKST    WHEQ 5
     C                     MOVEL'C'       W0INVL           C
     C           ZFPKST    WHEQ 6
     C                     MOVEL'I'       W0INVL           I
     C           ZFPKST    WHEQ 7
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CPKST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Time of Original Entry
     C                     Z-ADD#2BQTM    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9943  *
     C                     END
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZR4CD    CASNE#2R4CD    FBRQRL
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZB0C7    CASNE#2B0C7    FBRQRL
     C           WZCXDT    CASNE#2CXDT    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZXIST    CASNE#2XIST    FBRQRL
     C           WZXJST    CASNE#2XJST    FBRQRL
     C           WZBQTM    CASNE#2BQTM    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * Prompts
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * BILL TO CUST
      * CASE: PGM.*Cursor field <IS> CTL.Bill to Customer
     C           W0CFL     IFEQ 'V2B0C7'                   *IF
      * SEL Bill to Customer   SR - Customer  * 
     C                     CALL 'PDU1SRR'              90  SEL Bill to Cus
     C                     PARM *BLANK    W0RTN   7
     C           #2B0C7    PARM #2B0C7    WQ0001  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDU1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Sales route
      * CASE: PGM.*Cursor field <IS> CTL.Sales Route Code
     C           W0CFL     IFEQ '#2R4CD'                   *IF
      * SEL PD Sales Route Act SR - Sales Route  * 
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #2R4CD    PARM #2R4CD    WQ0002  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Warehouse
      * CASE: PGM.*Cursor field <IS> CTL.Warehouse Code
     C           W0CFL     IFEQ '#CAJCD'                   *IF
      * SEL Prod Whse-No Sec   SR - Warehouse  * 
     C                     CALL 'PMCLSRR'              90  SEL Prod Whse-N
     C                     PARM *BLANK    W0RTN   7
     C           #CAJCD    PARM #CAJCD    WQ0003  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCLSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Ship To Customer
      * CASE: PGM.*Cursor field <IS> CTL.Bill to Customer
     C           W0CFL     IFEQ 'V2B0C7'                   *IF
      * SEL Ship To Customer   SR - Customer  * 
     C                     CALL 'PDR5SRR'              90  SEL Ship To Cus
     C                     PARM *BLANK    W0RTN   7
     C           #2BKC7    PARM #2BKC7    WQ0004  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       P5ECST           Error Status
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * ERROR STATUS 'YES' - DEFER CONFIRM
      * CASE: PAR.Error Status is yes
     C           P5ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.USR Status (Y/N) is no
     C           P6E6ST    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P6E6ST           USR Status (Y/N
     C                     END                             *FI
     C                     END                             *FI
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,44
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * Ensure that we are using fresh data
     C                     EXSR UBSUBR                     Ensure that we
      * Refresh screen
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Process A/R Summary Inquiry request.
      * CASE: RCD.*SFLSEL is *Customer Inquiry
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * ***
      * Change to new A/R Summary Inquiry program
      * RMC 9/16/04  PKTR01
     C                     MOVEL*BLANK    WUJDST           USR Check Y/N S
      * DSP A/R Summary       XF - A/R Summary  * 
     C                     CALL 'PPG5XFR'              90  DSP A/R Summary
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0005  30       Company Number
     C                     PARM #1ANC7    WQ0006  70       AR Customer Num
     C                     PARM WUJDST    WQ0007  1        USR Check Y/N S
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPG5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       P6E6ST           USR Status (Y/N
     C                     END                             *FI
      * Process Order Inquiry Detail request.
      * CASE: RCD.*SFLSEL is *Order Inquiry
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
     C                     MOVEL##USR     P1AJVN           User Profile Na
      * DSP Ord Inquiry Detail DF - Order Detail  * 
     C                     CALL 'PDPZDFR'              90  DSP Ord Inquiry
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0008  30       Company Number
     C                     PARM #1C4NB    WQ0009  70       Order Number
     C           WUNFNN    PARM *ZERO     WQ0010  30       Order Sequence
     C           WUNFNN    PARM *ZERO     WQ0011  30       Order Secondary
     C           P1DNCD    PARM P1DNCD    WQ0012  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPZDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       P6E6ST           USR Status (Y/N
     C                     END                             *FI
      * Release credit hold
      * CASE: RCD.*SFLSEL is *Release Credit Hold
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * CASE: RCD.Order in Use is yes
     C           #1GJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0001           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     MOVEL'Y'       P5ECST           Error Status
     C                     ELSE
      * CASE: RCD.Header Status is Cancelled
     C           #1GWST    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0003           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     MOVEL'Y'       P5ECST           Error Status
     C                     ELSE
      * CASE: RCD.Credit Hold is Yes
     C           #1XIST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       #RXOST           USR Credit Hold
      * Change header status - dont care about prod hold 10/13/13 E2824
      * CASE: RCD.New Customer Hold is Yes
     C           #1XKST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0004           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL@CN,002   ZA0005           Text USR
      * Send message 'Order has other holds'
     C                     MOVEL'USR1844' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1GWST    #1GXST           Header Status L
     C                     MOVEL'A'       #1GWST           Header Status
     C                     END                             *FI
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0006           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1SEL     ZA0007           *SFLSEL
      * Send message 'Order not on Crd Hold'
     C                     MOVEL'USR1843' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     MOVEL'Y'       P5ECST           Error Status
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Put order on credit hold
      * CASE: RCD.*SFLSEL is *Credit Hold
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * CASE: RCD.Order in Use is yes
     C           #1GJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0008           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0009           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0009           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     MOVEL'Y'       P5ECST           Error Status
     C                     ELSE
      * CASE: RCD.Header Status is Cancelled
     C           #1GWST    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0010           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     MOVEL'Y'       P5ECST           Error Status
     C                     ELSE
      * CASE: RCD.Credit Hold is Yes
     C           #1XIST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0011           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0011           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1SEL     ZA0012           *SFLSEL
      * Send message 'Order already on crd hold'
     C                     MOVEL'USR1845' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     MOVEL'Y'       P5ECST           Error Status
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     ELSE
      * CASE: WRK.Load Status is Locked thru Invoiced
     C           WUPKST    IFEQ 'I'                        *IF
     C           WUPKST    OREQ 'L'
     C           WUPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0013           *SFLSEL
      * Send message 'Load locked Can't Hold Or'
     C                     MOVEL'USR2357' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     MOVEL'Y'       P5ECST           Error Status
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1GWST    #1GXST           Header Status L
     C                     MOVEL'H'       #1GWST           Header Status
     C                     MOVEL'Y'       #RXOST           USR Credit Hold
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 6=Process Order Header Request to display change log
      * CASE: RCD.*SFLSEL is Option 6
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
     C                     MOVEL##USR     P1AJVN           User Profile Na
      * Dsp Order Header       PV - Order Header TRG  * 
     C                     CALL 'OMB5PVR'              90  Dsp Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0013  30       Company Number
     C                     PARM #1C4NB    WQ0014  70       Order Number
     C                     PARM #1BCNA    WQ0015 15        Customer Purcha
     C                     PARM #1CXDT    WQ0016  70       Date of Origina
     C                     PARM #1AFTM    WQ0017  40       Requested Deliv
     C                     PARM P1DNCD    WQ0018  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMB5PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,44
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Release Credit hold
      * CASE: RCD.*SFLSEL is *Release Credit Hold
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
     C                     MOVEL'N'       #1XIST           Credit Hold
      * CHG Crd Hld, Sts,Rsn   CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0015           Company Number
     C                     Z-ADD#1C4NB    WL0016           Order Number
     C                     MOVEL#RO9CD    WL0017    P      Reason Code
     C                     MOVEL#1GWST    WL0018    P      Header Status
     C                     MOVEL#1GXST    WL0019    P      Header Status L
     C                     MOVEL#1XIST    WL0020    P      Credit Hold
     C                     EXSR SMCHRC
      * If possible Lock Load when Credit Hold is released - OMS272
     C                     MOVEL'N'       WUATUS           STATUS
      * Allow this function to autolock without checking the ship date. W
      * However, don't lock if error still pending in Ord Dtl P001251 9/2
      * CASE: RCD.Load ID is GT Zero
     C           #1RMNB    IFGT *ZERO                      *IF
      *
     C                     MOVEL*BLANK    WN0121  1        Load Status
     C                     Z-ADD*ZERO     WN0122  70       Total Load Orde
     C                     MOVEL*BLANK    WN0123  3        Carrier Code
     C                     MOVEL*BLANK    WN0124  7        Truck Size
     C                     MOVEL*BLANK    WN0125  2        Shipping Method
     C                     MOVEL*BLANK    WN0126  1        Load Acceptance
     C                     MOVEL*BLANK    WN0127  1        Block Order Fla
      *
      * EDT Lock Load Edit/INF IF
      * ** Chk for ord detail errors still pending  9.20.2011 P001251 LJB
      * ** Chg lock option override sts to *job date chk   8.23.09 E00495
      * ** Add lock option override sts for sched ship date chk  7.24.09
      * ** Add Override Total Load Miles - WRK context     E00207 8/13/08
      * RTV Load for Load Plan RT - Load Header  * 
     C                     EXSR SNRVGN
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
     C                     EXSR SORVGN
      *
     C                     Z-ADD*ZERO     WN0128  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0129  70       Minimum pounds
     C                     MOVEL*BLANK    WN0130  1        USR Orders on L
     C                     MOVEL*BLANK    WN0131  1        Order in Use
     C                     MOVEL*BLANK    WN0132  1        Header Status
     C                     MOVEL*BLANK    WN0133  1        Access Denied (
      *
      * EDT Lock Load Edits-INFIF
      * assume will have error
     C                     MOVEL'Y'       P5ECST           Error Status
      *
     C                     MOVEL*BLANK    WN0134 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0134           User Profile Na
      *
     C                     MOVEL*BLANK    WN0135 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0134    WL0021    P      User Profile Na
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    WUG0TX    P      Allow Multi_Com
     C                     MOVELWL0023    WUG0TX    P      Default Printer
     C                     MOVELWL0024    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0025    YL0007           Company Number
     C                     MOVELWL0026    WN0135    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0135    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0134    WL0027    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0028    P      Application Cod
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    WUAIC3           Company Number
     C                     MOVELWL0030    YL0008    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0135    WL0027    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0028    P      Application Cod
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    WUAIC3           Company Number
     C                     MOVELWL0030    YL0008    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0008    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0007    IFGT 0                          *IF
     C                     Z-ADDYL0007    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0008    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0009    WL0032           Shipping Compan
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0133           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0133    IFEQ 'Y'                        *IF
      * Send message 'Usr Cant Lock/Unlk Ld-INF'
     C                     MOVEL'USR2543' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
     C                     EXSR STRVGN
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0014           Load ID
     C                     MOVEL#1SEL     ZA0015           *SFLSEL
      * Send message 'No Orders Assinged - INF'
     C                     MOVEL'USR2544' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           WN0127    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0016           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0017           Load ID
      * Send message 'Blck Ord on Ld-no UPD-INF'
     C                     MOVEL'USR2545' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           WN0121    IFEQ 'I'                        *IF
     C           WN0121    OREQ 'L'
     C           WN0121    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0018           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0019           Load ID
      * Send message 'Load Cant be Locked - INF'
     C                     MOVEL'USR2546' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code EQ WRK.BLANK
      *   |- c2    : PAR.STATUS is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0123    IFEQ WUGSTX                     *IF
     C           WUATUS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVELWN0123    ZA0020           Carrier Code
     C                     Z-ADD#1RMNB    ZA0021           Load ID
      * Send message 'Carrier must be ent.- INF'
     C                     MOVEL'USR2547' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           WN0124    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0124    ZA0022           Truck Size
     C                     Z-ADD#1RMNB    ZA0023           Load ID
      * Send message 'Truck size needed - INF'
     C                     MOVEL'USR2548' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           WN0125    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0125    ZA0024           Shipping Method
      * Send message 'Shipping Mthd req - INF'
     C                     MOVEL'USR2549' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0130    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0025           Load ID
      * Send message 'Load has ords w/o stp-INF'
     C                     MOVEL'USR2550' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           WN0126    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0026           Load ID
      * Send message 'Load is not accepted- INF'
     C                     MOVEL'USR2551' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - PD Order Header  * 
     C                     EXSR SURVGN
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0132    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0027           Load ID
     C                     MOVEL#1SEL     ZA0028           *SFLSEL
      * Send message 'Load has Ords on Hold-INF'
     C                     MOVEL'USR2552' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0132    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0029           Load ID
     C                     MOVEL#1SEL     ZA0030           *SFLSEL
      * Send message 'Load has Cncld Ords - INF'
     C                     MOVEL'USR2553' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0131    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0031           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0032           Load ID
      * Send message 'Load has Ords in Use-INF'
     C                     MOVEL'USR2554' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Ord Requires Revw RT - Order Header TRG  * 
     C                     EXSR SVRVGN
      * ** Check for errors in Export Order Automation Upload   P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * ** Cannot lock load if errors in Order Detail         P001251
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0033           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0034           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
     C                     EXSR SWRVGN
      * Do not want to lock the load if the Load Weight is not
      * within range.  -Purva 5/5/99 C0007042
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           WN0122    IFLT WN0129                     *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0035           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P5ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           WN0122    IFGT WN0128                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P5ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Sched ship date if not called from a LOCK option  FP1054 7/
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Lock option override sts is No
      *   |- c2    : PAR.Scheduled Ship Date GT JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'Y'       IFEQ 'N'                        *IF
     C           WUAODT    IFGT ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P5ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P5ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UCSUBR                     ***** Change Lo
      * Lock Load if no errors
      * CASE: PAR.Error Status is no
     C           P5ECST    IFEQ 'N'                        *IF
      * RTV Load Status        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0013           Load ID
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUPKST    P      Load Status
      *
     C                     Z-ADD*ZERO     WN0136  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0137 112       Flat Amount
     C                     Z-ADD*ZERO     WN0138  50       Total Stops
     C                     Z-ADD*ZERO     WN0139  70       Total Load Mile
     C                     MOVEL*BLANK    WN0140  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0141  2        Ship To State C
     C                     MOVEL*BLANK    WN0142  3        Carrier Broker
     C                     MOVEL*BLANK    WN0143  1        Export Status
     C                     MOVEL*BLANK    WN0144  3        Shipping Line
     C                     MOVEL*BLANK    WN0145 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0146  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0147  60       Deadline Depart
     C                     MOVEL*BLANK    WN0148  1        MG Created Load
     C                     MOVEL*BLANK    WN0149  2        Load U_M
     C                     MOVEL*BLANK    WN0150  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0151 20        Destination Cit
     C                     MOVEL*BLANK    WN0152  2        State Code
     C                     MOVEL*BLANK    WN0153  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0154  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN0155  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN0156  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN0157  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN0158  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN0159  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN0160  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN0161  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN0162  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN0163 155       Company Number
     C                     Z-ADD*ZERO     WN0164 155       Date 1
     C                     Z-ADD*ZERO     WN0165 155       Order Number 1
     C                     Z-ADD*ZERO     WN0166  40       Requested Deliv
     C                     MOVEL*BLANK    WN0167  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
     C                     EXSR SXRVGN
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN0140    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
     C                     EXSR SYRVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0148    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
     C                     EXSR TBRVGN
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN0146           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
     C                     EXSR TCRVGN
     C           WN0166    MULT 100       WN0147           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0313  51       Hours Required
     C                     Z-ADD*ZERO     WN0314  50       Miles to next s
     C                     Z-ADD*ZERO     WN0315  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN0316  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0317  50       @Days 5
     C                     Z-ADD*ZERO     WN0318  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0319  20       USR Period
     C                     Z-ADD*ZERO     WN0320  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0321  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
     C                     EXSR TERVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0011    IFEQ 'CT'                       *IF
     C           YL0011    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0033           Load ID
     C                     Z-ADD*ZERO     WL0034           Stop_Drop
     C                     Z-ADD*ZERO     WL0035           Order Number
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    WN0314           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0314    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0021  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0022  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0033           Load ID
     C                     Z-ADD*ZERO     WL0034           Stop_Drop
     C                     Z-ADD*ZERO     WL0035           Order Number
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    WN0314           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0314    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN0146           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0147           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0313           Hours Required
     C                     Z-ADD*ZERO     YL0012           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
     C                     EXSR TGRVGN
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0023  70       Load ID
     C           YL0013    PARM YL0013    WQ0024  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           YL0012    ADD  YL0013    WN0313           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN0313    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0313    DIV  24        WN0317           @Days 5
     C           WN0317    MULT 24        WU               USR Hours 5.0
     C           WN0313    SUB  WU        WN0315           USR Hours 5.0
     C           WN0315    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN0317    IFGT 0                          *IF
     C                     MULT -1        WN0317           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0146    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0317    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0146
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0146
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0147                     *IF
     C                     SUB  WN0147    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN0317           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0146    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0317    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0146
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0146
     C                     END
     C           240000    SUB  WUPINB    WN0147           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0147           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
     C                     EXSR THRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
     C                     EXSR TIRVGN
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0138    IFEQ 1                          *IF
     C           WN0137    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
     C                     EXSR TKRVGN
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN0151    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN0151           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
     C                     EXSR TLRVGN
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UESUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
     C                     EXSR TMCHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0136    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
     C                     EXSR TNRVGN
     C                     Z-ADD#1AIC3    WN0163           Company Number
     C                     Z-ADD#1RMNB    WN0165           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN0136    WN0164           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0153    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN0167    PARM *BLANK    WQ0027  7        Return Code Usr
     C                     PARM 'OMS'     WQ0028  6        Application Cod
     C                     PARM @CN,004   WQ0029 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0030  1        USR Detail or S
     C                     PARM @CN,005   WQ0031 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0032 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0033  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0034  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0035  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0036 10        PRT Night Queue
     C           WN0163    PARM WN0163    WQ0037 155       Company Number
     C           WN0164    PARM WN0164    WQ0038 155       Date 1
     C           WN0165    PARM WN0165    WQ0039 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0040 155       System Value Nu
     C           WN0153    PARM WN0153    WQ0041  3        USR Warehouse C
     C           WN0154    PARM WN0154    WQ0042  3        USR CDE Parm 1
     C           WN0155    PARM WN0155    WQ0043  3        USR CDE Parm 2
     C           WN0156    PARM WN0156    WQ0044  3        USR CDE Parm 3
     C           WN0157    PARM WN0157    WQ0045  3        USR CDE Parm 4
     C           WN0158    PARM WN0158    WQ0046  3        USR CDE Parm 5
     C           WN0159    PARM WN0159    WQ0047  3        USR CDE Parm 6
     C           WN0160    PARM WN0160    WQ0048  3        USR CDE Parm 7
     C           WN0161    PARM WN0161    WQ0049  3        USR CDE Parm 8
     C           WN0162    PARM WN0162    WQ0050  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0051  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0052  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0459  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
     C                     EXSR TPRVGN
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0037           PFS Company Num
     C                     MOVEL'LDORDD'  WL0038    P      PFS Interface C
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    YL0014    P      PFS AccuSort Ac
     C                     MOVELWL0040    YL0015    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0014    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0459    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  Zzz Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0053  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  Zzz AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0054  70       Load ID
     C                     PARM #1AIC3    WQ0055  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  Zzz Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0056  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0015    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0057  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0058  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,006                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0136    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0153    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0153    WQ0059  3        Warehouse Code
     C                     PARM *BLANK    WQ0060 10        Default Printer
     C           YL0016    PARM *BLANK    WQ0061  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0016    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN0153    ZA0036           USR Warehouse C
     C                     MOVELWN0154    ZA0037           USR CDE Parm 1
     C                     MOVELWN0155    ZA0038           USR CDE Parm 2
     C                     MOVELWN0156    ZA0039           USR CDE Parm 3
     C                     MOVELWN0157    ZA0040           USR CDE Parm 4
     C                     MOVELWN0158    ZA0041           USR CDE Parm 5
     C                     MOVELWN0159    ZA0042           USR CDE Parm 6
     C                     MOVELWN0160    ZA0043           USR CDE Parm 7
     C                     MOVELWN0161    ZA0044           USR CDE Parm 8
     C                     MOVELWN0162    ZA0045           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR UFSUBR                     ***** Change Lo
     C                     MOVEL*BLANK    WURVST           Load Change Typ
     C                     MOVEL'LOCK'    WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#1RMNB    PCRMNB           Load ID
     C                     Z-ADD*ZERO     PCRVNB           Stop_Drop
     C                     MOVELWURVST    PCRVST    P      Load Change Typ
     C                     MOVELWUUJST    PCUJST    P      Department Cont
     C                     MOVELWUPKST    PCMNTX    P      Change Log Prio
     C                     MOVEL'L'       PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#1BZNA    PCBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     Z-ADD*ZERO     PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0046           Load ID
      * Send message 'Load Locked'
     C                     MOVEL'USR2559' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'L'       #RPKST           Load Status
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  010       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
     C                     END                             *FI
      * CASE: RCD.Load ID is Blank
     C           #1RMNB    IFEQ *ZERO                      *IF
      * P00196 RMC 4/12/14 CAT2 Dailys-Interface Cond "ORDONL" - send ord
      * CASE: DB1.Load ID is Blank
     C           BERMNB    IFEQ *ZERO                      *IF
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0037           PFS Company Num
     C                     MOVEL'ORDONL'  WL0038    P      PFS Interface C
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    YL0017    P      PFS AccuSort Ac
     C                     MOVELWL0040    YL0018    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0019           Load Status
      * PFS Order Header      XF - Order Header TRG  * 
     C                     CALL 'PBEYXFR'              90  Zzz Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0062  30       Company Number
     C                     PARM #1C4NB    WQ0063  70       Order Number
     C                     PARM #1BZNA    WQ0064  3        Carrier Code
     C                     PARM #1RMNB    WQ0065  70       Load ID
     C                     PARM YL0019    WQ0066  1        Load Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBEYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0020           Change Log Prio
     C                     MOVEL'Y'       YL0020           Change Log Prio
     C                     MOVEL*BLANK    YL0021           Change Log New
     C                     MOVEL'N'       YL0021           Change Log New
     C                     MOVEL'CRDRLS'  YL0022           Load Change Typ
     C                     MOVEL'ACC'     YL0023           Department Cont
      * * Write Credit Release log record                     E003028
      * Set Load ID to zeros if order is not yet assigned to a load  E003
      * CASE: RCD.Load ID is Blank
     C           #1RMNB    IFEQ *ZERO                      *IF
     C                     Z-ADD*ZERO     YL0024           Load ID
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1RMNB    YL0024           Load ID
     C                     END                             *FI
      * LCL.*Date1 (ending) = JOB.*Job date + CON.-90 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-90       XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0025
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0025
     C                     END
     C                     MOVEL##USR     YL0026           User Id
      * CRT LOCL-Ord,no load   X1 - Load Order Change Log  * 
     C                     CALL 'PBL8XFR'              90  CRT LOCL-Ord,no
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0025    WQ0067  70       Created Date
     C                     PARM 000001    WQ0068  60       Created Time
     C                     PARM YL0024    WQ0069  70       Load ID
     C                     PARM *ZERO     WQ0070  50       Stop_Drop
     C                     PARM YL0022    WQ0071  6        Load Change Typ
     C                     PARM YL0023    WQ0072  3        Department Cont
     C                     PARM YL0020    WQ0073 12        Change Log Prio
     C                     PARM YL0021    WQ0074 12        Change Log New
     C                     PARM YL0026    WQ0075 10        User Id
     C                     PARM #1A0NA    WQ0076 10        Job Name
     C                     PARM #1BZNA    WQ0077  3        Carrier Code
     C                     PARM #1AIC3    WQ0078  30       Company Number
     C                     PARM #1C4NB    WQ0079  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBL8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'N'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Credit Hold
      * CASE: RCD.*SFLSEL is *Credit Hold
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
     C                     MOVEL'Y'       #1XIST           Credit Hold
      * CHG Crd Hld, Sts,Rsn   CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0015           Company Number
     C                     Z-ADD#1C4NB    WL0016           Order Number
     C                     MOVEL#RO9CD    WL0017    P      Reason Code
     C                     MOVEL#1GWST    WL0018    P      Header Status
     C                     MOVEL#1GXST    WL0019    P      Header Status L
     C                     MOVEL#1XIST    WL0020    P      Credit Hold
     C                     EXSR SMCHRC
      * * Check for an existing Credit Released record        E003028
     C                     MOVEL'CRDRLS'  P7RVST           Load Change Typ
     C                     MOVEL##USR     YL0026           User Id
      * RTV Get Create DateTimeRT - Load Order Change Log  * 
     C                     EXSR TURVGN
      * * If order was previously Credit Released, Cancel it  E003028
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     MOVEL'ACC'     YL0023           Department Cont
     C                     MOVEL'CRDRLX'  YL0022           Load Change Typ
     C                     MOVELYL0022    YL0027           @Change Type 2
      * CHG LOCL-Ord,no load   XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADDP7K4DT    PDK4DT           Created Date
     C                     Z-ADDP7A1TM    PDA1TM           Created Time
     C                     Z-ADDP7DXNB    PDDXNB           Sequence Number
     C                     Z-ADDP7RMNB    PDRMNB           Load ID
     C                     Z-ADDP7RVNB    PDRVNB           Stop_Drop
     C                     MOVELP7RVST    PDRVST    P      Load Change Typ
     C                     MOVELP7UJST    PDUJST    P      Department Cont
     C                     MOVELP7MNTX    PDMNTX    P      Change Log Prio
     C                     MOVELP7MOTX    PDMOTX    P      Change Log New
     C                     MOVELP7AYNA    PDAYNA    P      User Id
     C                     MOVELP7A0NA    PDA0NA    P      Job Name
     C                     MOVELP7BZNA    PDBZNA    P      Carrier Code
     C                     MOVELP7XMCD    PDXMCD    P      Carrier Broker
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PBMAXFR'              90  CHG LOCL-Ord,no
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
     C                     PARM YL0027    WQ0080  6        @Change Type 2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBMAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'N'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Reload
      * CASE: RCD.*SFLSEL is *Reset to blank
     C           #1SEL     IFEQ *BLANK                     *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.USR Reason Code NE RCD.Reason Code
      *   |- c2    : RCD.USR Credit Hold NE RCD.Credit Hold
      *   '-
     C           #RO9CD    IFNE #1CQCD                     *IF
     C           #RXOST    ORNE #1XIST                     *OR
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     END                             *FI
     C                     END                             *FI
      * CASE: RCD.Load ID is GT Zero
     C           #1RMNB    IFGT *ZERO                      *IF
      * E4119 RMC 5/20/16 Dont do if MG Created Load
      * RTV MG Created Load   RT - Load Header  * 
     C                     EXSR TVRVGN
      * CASE: LCL.MG Created Load is Yes
     C           YL0028    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Deadline Date/Time XF - Load Detail  * 
     C                     CALL 'PMP9XFR'              90  CLC Deadline Da
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0081  70       Load ID
     C           WUKZDT    PARM WUKZDT    WQ0082  70       Deadline Depart
     C           WUAXTM    PARM *ZERO     WQ0083  60       Deadline Depart
     C                     PARM *ZERO     WQ0084  70       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Deadline Dep D/T   CH - Load Header  * 
     C                     EXSR TWCHRC
      * CHG Deadline Date/Time RT - OM Load Detail  * 
     C                     EXSR TXRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN78
     C           P3XMST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           #RPKST    IFEQ 'L'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPID fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEJNCD    #1JNCD           Order Type_Sale
     C                     Z-ADDBEANC7    #1ANC7           AR Customer Num
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip_Pos
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip_Pos
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A_R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non_Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non_Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1B0C7
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1A0DT
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     MOVEL*BLANK    #RO9CD           USR Reason Code
     C                     MOVEL*BLANK    #RKTNA           USR Customer Na
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RAJCD           Warehouse Code
     C                     MOVEL*BLANK    #RH8AA           Carrier Code Us
     C                     Z-ADD*ZERO     #RYWVA           Total Company E
     C                     Z-ADD*ZERO     #RASVA           Credit Limit
     C                     MOVEL*BLANK    #RXOST           USR Credit Hold
     C                     MOVEL*BLANK    #RPKST           Load Status
     C                     MOVEL*BLANK    #RAYTX           Customer Name
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #2BRTX           Ship To Name
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
     C                     Z-ADD*ZERO     #2A0DT           Order Date
     C                     Z-ADD*ZERO     #2A5DT           Requested Ship
     C                     MOVELP4O9CD    #PO9CD           USR Reason Code
     C                     MOVEL*BLANK    #2CQCD           Reason Code
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     MOVEL*BLANK    #2BCST           Block Order Fla
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #2R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #CAJCD           Warehouse Code
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #CH8AA           Carrier Code Us
     C                     Z-ADD*ZERO     #2B0C7           Bill to Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2B0C7
     C                     MOVEL*BLANK    #2BCNA           Customer Purcha
     C                     Z-ADD*ZERO     #CYWVA           Total Company E
     C                     Z-ADD*ZERO     #CASVA           Credit Limit
     C                     Z-ADD*ZERO     #2CXDT           Date of Origina
      * Clear external version also
     C                     Z-ADD*ZERO     V2CXDT
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     MOVEL*BLANK    #2XIST           Credit Hold
     C                     MOVEL*BLANK    #2XJST           Production Hold
     C                     MOVEL*BLANK    #CPKST           Load Status
     C                     Z-ADD*ZERO     #2JZVA           Order Value Tot
     C                     Z-ADD*ZERO     #2BQTM           Time of Origina
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1B0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1B0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1B0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  #1A0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A0DT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2B0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2B0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2B0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Date of Original Entry to display format
      * Convert date
     C           1000000   ADD  #2CXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2CXDT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0653  70       Item Code
     C                     MOVEL*BLANK    WN0654  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0655  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0656  70       Order Group Cod
     C                     MOVEL*BLANK    WN0657  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0658  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0659 112       Billing Detail
     C                     Z-ADD*ZERO     WN0660 112       Billing Detail
     C                     Z-ADD*ZERO     WN0661 112       Billing Detail
     C                     Z-ADD*ZERO     WN0662 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0663  1        Comment Print A
     C                     MOVEL*BLANK    WN0664  1        Comment Print I
     C                     MOVEL*BLANK    WN0665  1        Comment Print P
     C                     MOVEL*BLANK    WN0666  1        Comment Print S
     C                     Z-ADD*ZERO     WN0667 112       Extended Amount
     C                     Z-ADD*ZERO     WN0668  70       Market Pricing
     C                     MOVEL*BLANK    WN0669  3        Commodity Marke
     C                     MOVEL*BLANK    WN0670  3        Date Method Cod
     C                     MOVEL*BLANK    WN0671  3        Price Method Co
     C                     Z-ADD*ZERO     WN0672 114       Price Overage O
     C                     Z-ADD*ZERO     WN0673  70       Contract Number
     C                     MOVEL*BLANK    WN0674  1        Price Status
     C                     Z-ADD*ZERO     WN0675  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0676  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0677  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0678  1        Work Confirm St
     C                     MOVEL*BLANK    WN0679  1        Work Over_Short
     C                     MOVEL*BLANK    WN0680  1        OD Production P
     C                     MOVEL*BLANK    WN0681 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0682 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0683  1        Age Code
     C                     MOVEL*BLANK    WN0684  1        Palletize
     C                     MOVEL*BLANK    WN0685  1        Slip Sheet
     C                     MOVEL*BLANK    WN0686  1        Catch Weight St
     C                     MOVEL*BLANK    WN0687  1        Price Audit
     C                     MOVEL*BLANK    WN0688  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0689  1        Production Date
     C                     Z-ADD*ZERO     WN0690 112       Rated Freight
     C                     Z-ADD*ZERO     WN0691 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0692 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0693 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0694 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0695 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0696 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0697 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0698 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0699 114       Unit Price
     C                     Z-ADD*ZERO     WN0700 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0701 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0702 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0703 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0704  70       Requested Ship
     C                     Z-ADD*ZERO     WN0705  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0706  70       Actual Shipped
     C                     MOVEL*BLANK    WN0707  1        Affect Inventor
     C                     MOVEL*BLANK    WN0708  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0709  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0710  30       Item Structure
     C                     Z-ADD*ZERO     WN0711  30       Item Structure
     C                     Z-ADD*ZERO     WN0712  30       Item Structure
     C                     MOVEL*BLANK    WN0713  2        Item Level
     C                     MOVEL*BLANK    WN0714  2        Quality Level
     C                     MOVEL*BLANK    WN0715  2        Pricing Product
     C                     MOVEL*BLANK    WN0716  2        Season Product
     C                     Z-ADD*ZERO     WN0717  70       Date of Origina
     C                     MOVEL*BLANK    WN0718 10        User Profile Na
     C                     MOVEL*BLANK    WN0719  6        Country Code
     C                     MOVEL*BLANK    WN0720  2        Event Code
     C                     MOVEL*BLANK    WN0721  3        Reason Code
     C                     MOVEL*BLANK    WN0722  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0723  1        Modified Flag
     C                     MOVEL*BLANK    WN0724  1        Substituted Fla
     C                     MOVEL*BLANK    WN0725  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0726 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0727 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0728  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0729  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0730  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0731  1        Affect Commissi
     C                     MOVEL*BLANK    WN0732  1        Affect Pricing
     C                     MOVEL*BLANK    WN0733  1        Released by Use
     C                     MOVEL*BLANK    WN0734  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0735  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0736  3        Production Ware
     C                     MOVEL*BLANK    WN0737  3        OD Price Type
     C                     Z-ADD*ZERO     WN0738  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0739  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0740  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0741  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0742  60       Price Code
     C                     Z-ADD*ZERO     WN0743  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0744  60       Substitution Li
     C                     Z-ADD*ZERO     WN0745  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0746 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0747 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0748 112       OD Item Target
     C                     Z-ADD*ZERO     WN0749 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0750 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0751 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0752 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0753 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0754 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0755 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0756 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0757 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0758 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0759  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0760  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0761  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0762 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0763  40       Item Age Days
     C                     Z-ADD*ZERO     WN0764  70       Production Ovr
     C                     Z-ADD*ZERO     WN0765  70       Production Ovr
     C                     MOVEL*BLANK    WN0766  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0767  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0768  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0769  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0770  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0771  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0772  1        EDI Status 1
     C                     MOVEL*BLANK    WN0773  1        EDI Status 2
     C                     MOVEL*BLANK    WN0774  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0775  60       Job Time
     C                     MOVEL*BLANK    WN0776 10        User Id
     C                     MOVEL*BLANK    WN0777 10        Job Name
     C                     Z-ADD*ZERO     WN0778  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WOAIC3           Company Number
     C                     Z-ADDOMC4NB    WOC4NB           Order Number
     C                     Z-ADDOMDPNB    WODPNB           Order Sequence
     C                     Z-ADDOMUENB    WOUENB           Order Secondary
      *
     C           KLCHNA    KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOC4NB           Order Number
     C                     KFLD           WODPNB           Order Sequence
     C                     KFLD           WOUENB           Order Secondary
     C           KLCHNA    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YFRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWMHDDT    WONVDT           Deadline Depart
     C                     Z-ADDWMAUTM    WOBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WOAATM           Job Time
     C                     MOVEL##USR     WOAYNA           User Id
     C                     MOVEL##JOB     WOA0NA           Job Name
     C                     Z-ADD##JDT     WOAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNB01           Application Cod
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQNB01           Application Cod
     C                     MOVEL'OMS'     WQNB01           Application Cod
      * Establish starting position
     C           KRSNB     SETLL@DNRESF                    *
     C           KRSNB     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR NCRVGN
     C                     END                             *FI
     C           KRSNB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNC01           Application Cod
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQNC01           Application Cod
      * Establish starting position
     C           KRSNC     SETLL@DNRESF                    *
     C           KRSNC     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSNC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * RTV Hold Authorities   RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSND     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P3XMST           Credit Hold Aut
     C                     MOVEL*BLANK    P3XNST           Production Hold
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRXMST    P3XMST           Credit Hold Aut
     C                     MOVELDRXNST    P3XNST           Production Hold
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSA     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #CO6NA           Warehouse Descr
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    #CO6NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSB01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSB02           Order Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSB01           Company Number
     C                     Z-ADD#1C4NB    WQSB02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSB     SETLL@BGWKL1                    *
     C           KRSSB     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELOMAJCD    YL0001           Warehouse Code
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV LoadSts/Carrier    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSC     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RPKST           Load Status
     C                     MOVEL*BLANK    #RH8AA           Carrier Code
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    #RPKST           Load Status
     C                     MOVELFJBZNA    #RH8AA           Carrier Code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDBEB0C7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RAYTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    #RAYTX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Credit Limits      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    WABKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@BBREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWABTC7    WL0002           Parent Customer
     C                     MOVELWAK6ST    WL0003           Credit Check AR
     C                     MOVELWAUZST    WL0004           Credit Check Pa
     C                     Z-ADDWAS2NB    WL0005           Parent Credit L
     C                     Z-ADDWAVHVA    WL0006           AR Credit Limit
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWL0007    WQSF01           Company Number
     C                     Z-ADDWL0008    WQSF02           Order Number
     C                     Z-ADDWL0009    WBDPNB           Order Sequence
     C                     Z-ADDWL0010    WBUENB           Order Secondary
      * Establish starting position
     C           KPSSF     SETLL@BGWKAE                    *
     C           KRSSF     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0011           Warehouse Code
     C                     MOVEL*BLANK    WL0012           Trans Contol AS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SGRVGN
      * PAR = DB1 By name
     C                     MOVELWBAJCD    WL0011           Warehouse Code
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWBAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0012           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCXUST    WL0012           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Parent Customer    RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBBBTC7    YL0002           Parent Customer
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Parent Exp f/hdr  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Initialize Parameters
     C                     Z-ADD*ZERO     #RYWVA           Total Company E
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDBTC7    WQSI01           Parent Customer
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Parent Customer
      * Setup key
     C                     Z-ADDYL0002    WQSI01           Parent Customer
      * Establish starting position
     C           KRSSI     SETLL@BBREXK                    *
     C           KRSSI     READE@BBREXK                  90*
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Here is where we check if confirmed customer
      * CASE: PAR.Parent Customer EQ DB1.Parent Customer
     C           YL0002    IFEQ WDBTC7                     *IF
      * A/R Customers only
      * CASE: DB1.Ship To Customer EQ DB1.A/R Customer Number
     C           WDBKC7    IFEQ WDANC7                     *IF
      * RTV Cust Open Inv Ttl RT - A/R Header  * 
     C                     EXSR SJRVGN
     C                     ADD  WUBGVA    #RYWVA           Total Company E
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSI     READE@BBREXK                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Cust Open Inv Ttl RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUBGVA           Remaining Balan
      * Declare restrictor key work fields
     C           *LIKE     DEFN BDANC7    WQSJ01           AR Customer Num
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           AR Customer Num
      * Setup key
     C                     Z-ADDWDANC7    WQSJ01           AR Customer Num
      * Establish starting position
     C           KRSSJ     SETLL@BDCPYC                    *
     C           KRSSJ     READE@BDCPYC                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  BDBGVA    WUBGVA           Remaining Balan
     C           KRSSJ     READE@BDCPYC                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV All Header Fields  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1C4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEJNCD    #1JNCD           Order Type_Sale
     C                     Z-ADDWEANC7    #1ANC7           AR Customer Num
     C                     Z-ADDWEBKC7    #1BKC7           Ship To Custome
     C                     MOVELWEBRTX    #1BRTX           Ship To Name
     C                     MOVELWEHMNA    #1HMNA           Ship To Address
     C                     MOVELWEHONA    #1HONA           Ship To Address
     C                     MOVELWEHPNA    #1HPNA           Ship To Address
     C                     MOVELWEHNNA    #1HNNA           Ship To City
     C                     MOVELWEDBCD    #1DBCD           Ship To State C
     C                     MOVELWECKTX    #1CKTX           Ship To Zip_Pos
     C                     Z-ADDWEB0C7    #1B0C7           Bill to Custome
     C                     MOVELWEAETX    #1AETX           Bill to Name
     C                     MOVELWEB1NA    #1B1NA           Bill to Address
     C                     MOVELWEB3NA    #1B3NA           Bill to Address
     C                     MOVELWEB4NA    #1B4NA           Bill to Address
     C                     MOVELWEB2NA    #1B2NA           Bill to City
     C                     MOVELWEBHCD    #1BHCD           Bill to State C
     C                     MOVELWEC8TX    #1C8TX           Bill to Zip_Pos
     C                     MOVELWEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDWEA0DT    #1A0DT           Order Date
     C                     Z-ADDWEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDWEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDWEACDT    #1ACDT           Cancel Date
     C                     MOVELWEAQCD    #1AQCD           Terms Code
     C                     MOVELWEB6NA    #1B6NA           Special Instruc
     C                     MOVELWEBYNA    #1BYNA           Special Instruc
     C                     MOVELWEBZNA    #1BZNA           Carrier Code
     C                     MOVELWEGTST    #1GTST           Comment Print A
     C                     MOVELWEGVST    #1GVST           Comment Print I
     C                     MOVELWEGUST    #1GUST           Comment Print P
     C                     MOVELWEQFST    #1QFST           Comment Print S
     C                     MOVELWECQCD    #1CQCD           Reason Code
     C                     MOVELWEGJST    #1GJST           Order in Use
     C                     MOVELWEGWST    #1GWST           Header Status
     C                     MOVELWEGXST    #1GXST           Header Status L
     C                     MOVELWEGYST    #1GYST           Order Type Prin
     C                     Z-ADDWEAODT    #1AODT           Scheduled Ship
     C                     MOVELWEAIVN    #1AIVN           User Original E
     C                     Z-ADDWECXDT    #1CXDT           Date of Origina
     C                     Z-ADDWEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDWEA1WG    #1A1WG           Order Weight To
     C                     MOVELWEXIST    #1XIST           Credit Hold
     C                     MOVELWEXJST    #1XJST           Production Hold
     C                     MOVELWEXKST    #1XKST           New Customer Ho
     C                     Z-ADDWEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDWEAFTM    #1AFTM           Requested Deliv
     C                     MOVELWEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELWEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDWERMNB    #1RMNB           Load ID
     C                     Z-ADDWETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDWER1NB    #1R1NB           Rated Freight
     C                     MOVELWEPJST    #1PJST           LTL Flag
     C                     MOVELWEU0ST    #1U0ST           Price Audit
     C                     MOVELWEU1ST    #1U1ST           Price Status
     C                     MOVELWEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWEU2ST    #1U2ST           Export Status
     C                     MOVELWEVEST    #1VEST           Palletize
     C                     MOVELWEVFST    #1VFST           Shrink Wrap
     C                     MOVELWEVGST    #1VGST           Slip Sheet
     C                     MOVELWERPCD    #1RPCD           Age Code
     C                     Z-ADDWERNNB    #1RNNB           Reefer Temperat
     C                     MOVELWEVDST    #1VDST           Load Type
     C                     Z-ADDWEATIN    #1ATIN           Attach to Invoi
     C                     MOVELWEU4ST    #1U4ST           Load Plan Order
     C                     MOVELWEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDWERSRN    #1RSRN           Resell Referenc
     C                     MOVELWEMHNA    #1MHNA           Special Comment
     C                     MOVELWEMINA    #1MINA           Special Comment
     C                     MOVELWEWBST    #1WBST           Affect Auto Acc
     C                     MOVELWER4CD    #1R4CD           Sales Route Cod
     C                     MOVELWEBFCD    #1BFCD           Manager Level C
     C                     MOVELWEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDWET3NB    #1T3NB           Attach to Order
     C                     MOVELWESICD    #1SICD           Reason for Pric
     C                     Z-ADDWECONB    #1CONB           Invoice Number
     C                     MOVELWECEST    #1CEST           Invoice Suffix
     C                     Z-ADDWEAWDT    #1AWDT           Invoice Date
     C                     MOVELWEJPCD    #1JPCD           Event Code
     C                     MOVELWEXUST    #1XUST           Trans Contol AS
     C                     MOVELWEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDWEVRVA    #1VRVA           A_R order Value
     C                     MOVELWEOBST    #1OBST           Billing Activit
     C                     MOVELWEBCST    #1BCST           Block Order Fla
     C                     MOVELWEBDST    #1BDST           Order Certifica
     C                     MOVELWEUVST    #1UVST           EDI Status 1
     C                     MOVELWEUWST    #1UWST           EDI Status 2
     C                     MOVELWEUXST    #1UXST           EDI Status 3
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0013    FJRMNB           Load ID
      * Establish starting position
     C           KRSSL     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0014           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    WL0014           Load Status
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * CHG Crd Hld, Sts,Rsn   CH - PD Order Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0002  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  1        Order in Use
     C                     MOVEL*BLANK    WN0033  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0034  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0035 10        User Original E
     C                     Z-ADD*ZERO     WN0036  70       Date of Origina
     C                     Z-ADD*ZERO     WN0037 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0038 112       Order Weight To
     C                     MOVEL*BLANK    WN0039  1        Production Hold
     C                     MOVEL*BLANK    WN0040  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0041  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0042  40       Requested Deliv
     C                     MOVEL*BLANK    WN0043  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0044 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0045  70       Load ID
     C                     Z-ADD*ZERO     WN0046  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0047 112       Rated Freight
     C                     MOVEL*BLANK    WN0048  1        LTL Flag
     C                     MOVEL*BLANK    WN0049  1        Price Audit
     C                     MOVEL*BLANK    WN0050  1        Price Status
     C                     MOVEL*BLANK    WN0051  2        Shipping Method
     C                     MOVEL*BLANK    WN0052  1        Export Status
     C                     MOVEL*BLANK    WN0053  1        Palletize
     C                     MOVEL*BLANK    WN0054  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0055  1        Slip Sheet
     C                     MOVEL*BLANK    WN0056  1        Age Code
     C                     Z-ADD*ZERO     WN0057  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0058  1        Load Type
     C                     Z-ADD*ZERO     WN0059  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0060  1        Load Plan Order
     C                     MOVEL*BLANK    WN0061  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0062  70       Resell Referenc
     C                     MOVEL*BLANK    WN0063 30        Special Comment
     C                     MOVEL*BLANK    WN0064 30        Special Comment
     C                     MOVEL*BLANK    WN0065  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0066  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0067  2        Manager Level C
     C                     MOVEL*BLANK    WN0068  3        VP Level Code
     C                     Z-ADD*ZERO     WN0069  70       Attach to Order
     C                     MOVEL*BLANK    WN0070  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0071  70       Invoice Number
     C                     MOVEL*BLANK    WN0072  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0073  70       Invoice Date
     C                     MOVEL*BLANK    WN0074  2        Event Code
     C                     MOVEL*BLANK    WN0075  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0076  1        Modified Flag
     C                     Z-ADD*ZERO     WN0077 112       A_R order Value
     C                     MOVEL*BLANK    WN0078  1        Billing Activit
     C                     MOVEL*BLANK    WN0079  1        Block Order Fla
     C                     MOVEL*BLANK    WN0080  1        Order Certifica
     C                     Z-ADD*ZERO     WN0081 112       Invoice Order V
     C                     MOVEL*BLANK    WN0082  1        Process Sts for
     C                     MOVEL*BLANK    WN0083  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0084  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0085  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0086  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0087  1        Email Cust On O
     C                     MOVEL*BLANK    WN0088  1        Order Emailed
     C                     MOVEL*BLANK    WN0089  1        Export Docs Go
     C                     MOVEL*BLANK    WN0090  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0091  1        Broker Order St
     C                     MOVEL*BLANK    WN0092  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0093  2        Order Requires
     C                     MOVEL*BLANK    WN0094  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0095  2        Export USDA App
     C                     MOVEL*BLANK    WN0096  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0097  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0098  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0099  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0100  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0101  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0102  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0103  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0104  60       Time of Origina
     C                     Z-ADD*ZERO     WN0105  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0106  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0107  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0108 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0109 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0110 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0111 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0112 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0113  70       Claim Number
     C                     MOVEL*BLANK    WN0114  1        EDI Status 1
     C                     MOVEL*BLANK    WN0115  1        EDI Status 2
     C                     MOVEL*BLANK    WN0116  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0117  60       Job Time
     C                     MOVEL*BLANK    WN0118 10        User Id
     C                     MOVEL*BLANK    WN0119 10        Job Name
     C                     Z-ADD*ZERO     WN0120  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0015    WFAIC3           Company Number
     C                     Z-ADDWL0016    WFC4NB           Order Number
      *
     C           KLCHSM    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C           KLCHSM    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0017    WFCQCD    P      Reason Code
     C                     MOVELWL0018    WFGWST    P      Header Status
     C                     MOVELWL0019    WFGXST    P      Header Status L
     C                     MOVELWL0020    WFXIST    P      Credit Hold
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWFAIC3    PAAIC3           Company Number
     C                     Z-ADDWFC4NB    PAC4NB           Order Number
     C                     MOVELWFJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWFANC7    PAANC7           AR Customer Num
     C                     Z-ADDWFBKC7    PABKC7           Ship To Custome
     C                     MOVELWFBRTX    PABRTX    P      Ship To Name
     C                     MOVELWFHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWFHONA    PAHONA    P      Ship To Address
     C                     MOVELWFHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWFHNNA    PAHNNA    P      Ship To City
     C                     MOVELWFDBCD    PADBCD    P      Ship To State C
     C                     MOVELWFCKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWFB0C7    PAB0C7           Bill to Custome
     C                     MOVELWFAETX    PAAETX    P      Bill to Name
     C                     MOVELWFB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWFB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWFB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWFB2NA    PAB2NA    P      Bill to City
     C                     MOVELWFBHCD    PABHCD    P      Bill to State C
     C                     MOVELWFC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWFBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWFA0DT    PAA0DT           Order Date
     C                     Z-ADDWFA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWFGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWFACDT    PAACDT           Cancel Date
     C                     MOVELWFAQCD    PAAQCD    P      Terms Code
     C                     MOVELWFB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWFBYNA    PABYNA    P      Special Instruc
     C                     MOVELWFBZNA    PABZNA    P      Carrier Code
     C                     MOVELWFGTST    PAGTST    P      Comment Print A
     C                     MOVELWFGVST    PAGVST    P      Comment Print I
     C                     MOVELWFGUST    PAGUST    P      Comment Print P
     C                     MOVELWFQFST    PAQFST    P      Comment Print S
     C                     MOVELWFCQCD    PACQCD    P      Reason Code
     C                     MOVELWFGJST    PAGJST    P      Order in Use
     C                     MOVELWFGWST    PAGWST    P      Header Status
     C                     MOVELWFGXST    PAGXST    P      Header Status L
     C                     MOVELWFGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWFAODT    PAAODT           Scheduled Ship
     C                     MOVELWFAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWFCXDT    PACXDT           Date of Origina
     C                     Z-ADDWFJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWFA1WG    PAA1WG           Order Weight To
     C                     MOVELWFXIST    PAXIST    P      Credit Hold
     C                     MOVELWFXJST    PAXJST    P      Production Hold
     C                     MOVELWFXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWFEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWFAFTM    PAAFTM           Requested Deliv
     C                     MOVELWFE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWFE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWFRMNB    PARMNB           Load ID
     C                     Z-ADDWFTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWFR1NB    PAR1NB           Rated Freight
     C                     MOVELWFPJST    PAPJST    P      LTL Flag
     C                     MOVELWFU0ST    PAU0ST    P      Price Audit
     C                     MOVELWFU1ST    PAU1ST    P      Price Status
     C                     MOVELWFQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWFU2ST    PAU2ST    P      Export Status
     C                     MOVELWFVEST    PAVEST    P      Palletize
     C                     MOVELWFVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWFVGST    PAVGST    P      Slip Sheet
     C                     MOVELWFRPCD    PARPCD    P      Age Code
     C                     Z-ADDWFRNNB    PARNNB           Reefer Temperat
     C                     MOVELWFVDST    PAVDST    P      Load Type
     C                     Z-ADDWFATIN    PAATIN           Attach to Invoi
     C                     MOVELWFU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWFU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWFRSRN    PARSRN           Resell Referenc
     C                     MOVELWFMHNA    PAMHNA    P      Special Comment
     C                     MOVELWFMINA    PAMINA    P      Special Comment
     C                     MOVELWFWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWFR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWFBFCD    PABFCD    P      Manager Level C
     C                     MOVELWFQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWFT3NB    PAT3NB           Attach to Order
     C                     MOVELWFSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWFCONB    PACONB           Invoice Number
     C                     MOVELWFCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWFAWDT    PAAWDT           Invoice Date
     C                     MOVELWFJPCD    PAJPCD    P      Event Code
     C                     MOVELWFXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWFZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWFVRVA    PAVRVA           A_R order Value
     C                     MOVELWFOBST    PAOBST    P      Billing Activit
     C                     MOVELWFBCST    PABCST    P      Block Order Fla
     C                     MOVELWFBDST    PABDST    P      Order Certifica
     C                     Z-ADDWFB7VL    PAB7VL           Invoice Order V
     C                     MOVELWFGASX    PAGASX    P      Process Sts for
     C                     MOVELWFGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWFGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWFGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWFFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWFFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWFFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWFFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWFFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWFFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWFFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWFFUSX    PAFUSX    P      Order Requires
     C                     MOVELWFFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWFFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWFFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWFFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWFNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWFNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWFNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWFNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWFNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWFBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWFBQTM    PABQTM           Time of Origina
     C                     Z-ADDWFBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWFBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWFBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWFH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWFH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWFH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWFH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWFH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWFC0C7    PAC0C7           Claim Number
     C                     MOVELWFUVST    PAUVST    P      EDI Status 1
     C                     MOVELWFUWST    PAUWST    P      EDI Status 2
     C                     MOVELWFUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWFAATM    PAAATM           Job Time
     C                     MOVELWFAYNA    PAAYNA    P      User Id
     C                     MOVELWFA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWFAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Load for Load Plan RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSN     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAODT           Scheduled Ship
     C                     MOVEL*BLANK    WN0121           Load Status
     C                     Z-ADD*ZERO     WURNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WN0122           Total Load Orde
     C                     Z-ADD*ZERO     WUFLAM           Flat Amount
     C                     MOVEL*BLANK    WUXQST           Allocate Pounds
     C                     MOVEL*BLANK    WN0123           Carrier Code
     C                     MOVEL*BLANK    WN0124           Truck Size
     C                     Z-ADD*ZERO     WUR1NB           Rated Freight
     C                     MOVEL*BLANK    WUVDST           Load Type
     C                     Z-ADD*ZERO     WUT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WUTLMI           Total Load Mile
     C                     MOVEL*BLANK    WN0125           Shipping Method
     C                     MOVEL*BLANK    WUVPCD           Ship From Wareh
     C                     MOVEL*BLANK    WUDBCD           Ship To State C
     C                     MOVEL*BLANK    WUXCCD           Carrier Broker
     C                     MOVEL*BLANK    WN0126           Load Acceptance
     C                     Z-ADD*ZERO     WUK2DT           Override Total
     C                     MOVEL*BLANK    WUWRTX           Shipping Temp C
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WUAODT           Scheduled Ship
     C                     MOVELFJPKST    WN0121           Load Status
     C                     Z-ADDFJRNNB    WURNNB           Reefer Temperat
     C                     Z-ADDFJRPNB    WN0122           Total Load Orde
     C                     Z-ADDFJFLAM    WUFLAM           Flat Amount
     C                     MOVELFJXQST    WUXQST           Allocate Pounds
     C                     MOVELFJBZNA    WN0123           Carrier Code
     C                     MOVELFJRONB    WN0124           Truck Size
     C                     Z-ADDFJR1NB    WUR1NB           Rated Freight
     C                     MOVELFJVDST    WUVDST           Load Type
     C                     Z-ADDFJT4NB    WUT4NB           Schedule Sequen
     C                     Z-ADDFJTLMI    WUTLMI           Total Load Mile
     C                     MOVELFJQ2CD    WN0125           Shipping Method
     C                     MOVELFJVPCD    WUVPCD           Ship From Wareh
     C                     MOVELFJDBCD    WUDBCD           Ship To State C
     C                     MOVELFJXCCD    WUXCCD           Carrier Broker
     C                     MOVELFJRMST    WN0126           Load Acceptance
     C                     Z-ADDFJK2DT    WUK2DT           Override Total
     C                     MOVELFJWRTX    WUWRTX           Shipping Temp C
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WUJDST           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       WN0127           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSO02           Load ID
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSO02           Load ID
      * Establish starting position
     C           KRSSO     SETLL@BFCPD9                    *
     C           KRSSO     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUJDST           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           WGBCST    IFEQ 'B'                        *IF
     C                     MOVELWGBCST    WN0127           Block Order Fla
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSO     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0021    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSP     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WL0022           Allow Multi_Com
     C                     MOVELDRMPNA    WL0023           Default Printer
     C                     MOVELDRBCCD    WL0024           Salesperson Cod
     C                     Z-ADDDRAIC3    WL0025           Company Number
     C                     MOVELDRBUVN    WL0026           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0027    DTAJVN           User Profile Na
     C                     MOVELWL0028    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSQ     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0029           Company Number
     C                     MOVELDTAJCD    WL0030           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHBWC3    WQSR01           Shipping Compan
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Shipping Compan
      * Setup key
     C                     Z-ADDWL0032    WQSR01           Shipping Compan
      * Establish starting position
     C           KRSSR     SETLL@ADREWA                    *
     C           KRSSR     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0031           Warehouse Code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WHVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WHAOCD    IFNE *BLANK                     *IF
     C                     MOVELWHAOCD    WL0031           Warehouse Code
     C                     GOTO SREXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSR     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSS     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Name
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WUG0TX           Name
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * VAL no Stop Entered    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0130           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQST02           Load ID
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQST02           Load ID
      * Establish starting position
     C           KRSST     SETLL@FLCPEB                    *
     C           KRSST     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop is EQ Zero
     C           FLRVNB    IFEQ 0                          *IF
     C                     MOVEL'Y'       WN0130           Status - Y or N
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C           KRSST     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Hold, Use-by load  RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0131           Order in Use
     C                     MOVEL*BLANK    WN0132           Header Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSU02           Load ID
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSU02           Load ID
      * Establish starting position
     C           KRSSU     SETLL@BFCPD9                    *
     C           KRSSU     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If find 1 order on load which is held/cancelled, set par flag and
      * CASE: DB1.Header Status is Hold
     C           WGGWST    IFEQ 'H'                        *IF
     C                     MOVELWGGWST    WN0132           Header Status
     C                     GOTO SUEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Cancelled
     C           WGGWST    IFEQ 'X'                        *IF
     C                     MOVELWGGWST    WN0132           Header Status
     C                     GOTO SUEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Order in Use is yes
     C           WGGJST    IFEQ 'Y'                        *IF
     C                     MOVELWGGJST    WN0131           Order in Use
     C                     GOTO SUEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSU     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSV02           Load ID
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSV02           Load ID
      * Establish starting position
     C           KRSSV     SETLL@BFCPD9                    *
     C           KRSSV     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Order Requires
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGFUSX    YL0010           Order Requires
     C           KRSSV     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVELWN0124    FKRONB           Truck Size
      * Establish starting position
     C           KRSSW     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0128           Maximum pounds
     C                     Z-ADD*ZERO     WN0129           Minimum pounds
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFKRSNB    WN0128           Maximum pounds
     C                     Z-ADDFKTANB    WN0129           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Load Header All,Mg RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSX     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WN0136           Scheduled Ship
     C                     MOVELFJPJST    WUG0TX           LTL Flag
     C                     MOVELFJPKST    WUG0TX           Load Status
     C                     Z-ADDFJRNNB    WUNFNN           Reefer Temperat
     C                     MOVELFJDMTX    WUG0TX           Seal 1
     C                     MOVELFJDNTX    WUG0TX           Seal 2
     C                     MOVELFJDOTX    WUG0TX           Seal 3
     C                     Z-ADDFJRPNB    WUNFNN           Total Load Orde
     C                     Z-ADDFJFLAM    WN0137           Flat Amount
     C                     MOVELFJXQST    WUG0TX           Allocate Pounds
     C                     Z-ADDFJRRNB    WN0138           Total Stops
     C                     MOVELFJDXTX    WUG0TX           Trailer Id
     C                     MOVELFJDYTX    WUG0TX           Transloader Car
     C                     Z-ADDFJSBNB    WUNFNN           BOL Time
     C                     MOVELFJBZNA    WUG0TX           Carrier Code
     C                     MOVELFJRONB    WUG0TX           Truck Size
     C                     Z-ADDFJSQNB    WUNFNN           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    WUNFNN           Rated Freight
     C                     MOVELFJVCST    WUG0TX           Ship Status
     C                     MOVELFJVDST    WUG0TX           Load Type
     C                     Z-ADDFJSDNB    WUNFNN           Number Pallets
     C                     Z-ADDFJPAOU    WUNFNN           Number Pallets
     C                     Z-ADDFJDGWG    WUNFNN           Load Carrier Pa
     C                     Z-ADDFJSXNB    WUNFNN           Estimated Arriv
     C                     Z-ADDFJHADT    WUNFNN           Actual Arrival
     C                     Z-ADDFJAART    WUNFNN           Actual Arrival
     C                     Z-ADDFJDHWG    WUNFNN           Trailer IN Weig
     C                     Z-ADDFJDIWG    WUNFNN           Trailer OUT Wei
     C                     Z-ADDFJAQDT    WUNFNN           Actual Departur
     C                     Z-ADDFJS6NB    WUNFNN           Departure Time
     C                     Z-ADDFJT4NB    WUNFNN           Schedule Sequen
     C                     Z-ADDFJPRTM    WUNFNN           Product Tempera
     C                     Z-ADDFJNPSV    WUNFNN           Number Spacers
     C                     MOVELFJJ8TX    WUG0TX           Car_Veh_Initial
     C                     Z-ADDFJTLMI    WN0139           Total Load Mile
     C                     MOVELFJJ9TX    WUG0TX           Recorder ID
     C                     MOVELFJQ2CD    WUG0TX           Shipping Method
     C                     MOVELFJVPCD    WN0140           Ship From Wareh
     C                     MOVELFJDBCD    WN0141           Ship To State C
     C                     Z-ADDFJGRWE    WUNFNN           Gross Weight
     C                     MOVELFJXCCD    WN0142           Carrier Broker
     C                     MOVELFJU2ST    WN0143           Export Status
     C                     Z-ADDFJF9DT    WUNFNN           Actual Ship Dat
     C                     MOVELFJONTM    WUG0TX           On Time_Y_N
     C                     Z-ADDFJJ4DT    WUNFNN           Truck Ready Dat
     C                     Z-ADDFJTRTM    WUNFNN           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WUNFNN           Spotted Date
     C                     Z-ADDFJSPTM    WUNFNN           Spotted Time
     C                     Z-ADDFJJ6DT    WUNFNN           Load Finished D
     C                     Z-ADDFJLFTM    WUNFNN           Load Finished T
     C                     Z-ADDFJJ7DT    WUNFNN           BOL Complete Da
     C                     Z-ADDFJBOTM    WUNFNN           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WUNFNN           BOL Received Da
     C                     Z-ADDFJBLTM    WUNFNN           BOL Received Ti
     C                     Z-ADDFJKIDT    WUNFNN           Truck Departure
     C                     Z-ADDFJASTM    WUNFNN           Truck Departure
     C                     Z-ADDFJKADT    WUNFNN           Adjusted Depart
     C                     Z-ADDFJAJCM    WUNFNN           Adjusted Depart
     C                     MOVELFJXACD    WUG0TX           Shipping Line
     C                     MOVELFJOANA    WUG0TX           Port Delv Termi
     C                     MOVELFJK4TX    WUG0TX           Vessel Name
     C                     Z-ADDFJVOAG    WUNFNN           Voyage
     C                     Z-ADDFJKBDT    WUNFNN           Sail Date
     C                     MOVELFJNBBO    WUG0TX           Booking Number
     C                     MOVELFJW4CD    WUG0TX           Discharge Port
     C                     Z-ADDFJEFDT    WUNFNN           Arrival Date
     C                     MOVELFJCNTN    WUG0TX           Container Numbe
     C                     Z-ADDFJKCDT    WUNFNN           Date In
     C                     Z-ADDFJTMIN    WUNFNN           Time In
     C                     Z-ADDFJKDDT    WUNFNN           Date Out
     C                     Z-ADDFJVMNB    WUNFNN           Time Out
     C                     Z-ADDFJOCFR    WUNFNN           Load Total Frei
     C                     Z-ADDFJKJDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDFJATTM    WUNFNN           Scheduled Deliv
     C                     MOVELFJOTRS    WUG0TX           LH Unused Sts
     C                     Z-ADDFJKKDT    WUNFNN           On Yard Date
     C                     Z-ADDFJAVTM    WUNFNN           On Yard Time
     C                     Z-ADDFJKZDT    WN0146           Deadline Depart
     C                     Z-ADDFJAXTM    WN0147           Deadline Depart
     C                     MOVELFJRYSX    WN0148           MG Created Load
     C                     GOTO SXEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0168  70       Total Load Mile
     C                     MOVEL*BLANK    WN0169  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0170  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0171  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSY     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
     C                     EXSR SZRVGN
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           FJAJCD    IFEQ WN0169                     *IF
     C                     MOVEL*BLANK    WN0170           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELFJAJCD    WN0170           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           FJRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDFJTLMI    WN0168           Total Load Mile
     C                     Z-ADDFJK2DT    WN0171           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPBRC
     C                     Z-ADDFJRMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Detai
     C           WN0168    PARM WN0168    WQ0019  70       Total Load Mile
     C           WN0171    PARM WN0171    WQ0020  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR TACHRC
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSZ02           Load ID
      * Define keylist
     C           KPSSZ     KLIST
     C                     KFLD           WQSZ02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ02           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQSZ02           Load ID
     C                     Z-ADD1         FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSSZ     SETLL@FLCPEB                    *
     C           KRSSZ     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0007           Company Number
     C                     Z-ADDFLC4NB    WL0008           Order Number
     C                     Z-ADD*ZERO     WL0009           Order Sequence
     C                     Z-ADD*ZERO     WL0010           Order Secondary
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    WN0169    P      Warehouse Code
     C                     MOVELWL0012    WUG0TX    P      Trans Contol AS
     C                     GOTO SZEXIT                     *QUIT
     C           KRSSZ     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0172  30       Company Number
     C                     Z-ADD*ZERO     WN0173  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0174  1        LTL Flag
     C                     MOVEL*BLANK    WN0175  1        Load Status
     C                     Z-ADD*ZERO     WN0176  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0177 15        Seal 1
     C                     MOVEL*BLANK    WN0178 15        Seal 2
     C                     MOVEL*BLANK    WN0179 15        Seal 3
     C                     MOVEL*BLANK    WN0180 15        Seal 4
     C                     MOVEL*BLANK    WN0181 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0182  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0183 112       Flat Amount
     C                     MOVEL*BLANK    WN0184  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0185  50       Total Stops
     C                     MOVEL*BLANK    WN0186 20        Trailer Id
     C                     MOVEL*BLANK    WN0187  3        Transloader Car
     C                     Z-ADD*ZERO     WN0188  40       BOL Time
     C                     MOVEL*BLANK    WN0189  3        Carrier Code
     C                     MOVEL*BLANK    WN0190  7        Truck Size
     C                     Z-ADD*ZERO     WN0191  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0192 112       Rated Freight
     C                     MOVEL*BLANK    WN0193  1        Ship Status
     C                     MOVEL*BLANK    WN0194  1        Load Type
     C                     Z-ADD*ZERO     WN0195  50       Number Pallets
     C                     Z-ADD*ZERO     WN0196  50       Number Pallets
     C                     Z-ADD*ZERO     WN0197 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0198  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0199  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0200  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0201 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0202 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0203  70       Actual Departur
     C                     Z-ADD*ZERO     WN0204  40       Departure Time
     C                     Z-ADD*ZERO     WN0205  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0206  52       Product Tempera
     C                     Z-ADD*ZERO     WN0207  50       Number Spacers
     C                     MOVEL*BLANK    WN0208 12        Car_Veh_Initial
     C                     MOVEL*BLANK    WN0209 12        Recorder ID
     C                     MOVEL*BLANK    WN0210  2        Shipping Method
     C                     MOVEL*BLANK    WN0211  2        Ship To State C
     C                     Z-ADD*ZERO     WN0212  70       Gross Weight
     C                     MOVEL*BLANK    WN0213  3        Carrier Broker
     C                     MOVEL*BLANK    WN0214  1        Export Status
     C                     Z-ADD*ZERO     WN0215  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0216  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0217  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0218  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0219  70       Spotted Date
     C                     Z-ADD*ZERO     WN0220  60       Spotted Time
     C                     Z-ADD*ZERO     WN0221  70       Load Finished D
     C                     Z-ADD*ZERO     WN0222  60       Load Finished T
     C                     Z-ADD*ZERO     WN0223  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0224  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0225  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0226  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0227  70       Truck Departure
     C                     Z-ADD*ZERO     WN0228  60       Truck Departure
     C                     Z-ADD*ZERO     WN0229  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0230  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0231  3        Shipping Line
     C                     MOVEL*BLANK    WN0232 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0233 30        Vessel Name
     C                     Z-ADD*ZERO     WN0234  50       Voyage
     C                     Z-ADD*ZERO     WN0235  70       Sail Date
     C                     MOVEL*BLANK    WN0236 12        Booking Number
     C                     MOVEL*BLANK    WN0237 20        Discharge Port
     C                     Z-ADD*ZERO     WN0238  70       Arrival Date
     C                     MOVEL*BLANK    WN0239 12        Container Numbe
     C                     Z-ADD*ZERO     WN0240  70       Date In
     C                     Z-ADD*ZERO     WN0241  60       Time In
     C                     Z-ADD*ZERO     WN0242  70       Date Out
     C                     Z-ADD*ZERO     WN0243  60       Time Out
     C                     Z-ADD*ZERO     WN0244 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0245  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0246  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0247  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0248  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0249  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0250  70       Requested Deliv
     C                     MOVEL*BLANK    WN0251  1        Load Acceptance
     C                     Z-ADD*ZERO     WN0252  70       On Yard Date
     C                     Z-ADD*ZERO     WN0253  60       On Yard Time
     C                     Z-ADD*ZERO     WN0254  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0255  60       Deadline Depart
     C                     MOVEL*BLANK    WN0256  1        Load Held Over
     C                     MOVEL*BLANK    WN0257  1        Load Held Over
     C                     MOVEL*BLANK    WN0258 15        Load Held Over
     C                     MOVEL*BLANK    WN0259 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0260 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0261  70       Express Mail Da
     C                     MOVEL*BLANK    WN0262  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0263  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0264  70       Product Complet
     C                     Z-ADD*ZERO     WN0265  60       Product Complet
     C                     Z-ADD*ZERO     WN0266  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0267  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0268  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0269  1        Load Confirmed
     C                     MOVEL*BLANK    WN0270 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0271  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0272  60       Load Door 1
     C                     Z-ADD*ZERO     WN0273  60       Load Door 2
     C                     MOVEL*BLANK    WN0274  1        Partial Load
     C                     MOVEL*BLANK    WN0275  1        Load Confirmati
     C                     MOVEL*BLANK    WN0276  1        Export Load USD
     C                     MOVEL*BLANK    WN0277  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0278 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0279 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0280 15        Late Billing Em
     C                     MOVEL*BLANK    WN0281 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0282 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0283  1        Multi Company L
     C                     MOVEL*BLANK    WN0284  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0285  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0286  1        LH Power Only L
     C                     MOVEL*BLANK    WN0287  1        MG Created Load
     C                     MOVEL*BLANK    WN0288  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0289  2        Load U_M
     C                     MOVEL*BLANK    WN0290  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0291  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0292  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0293  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0294  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0295  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0296  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0297  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0298  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0299  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0300  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0301  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0302  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0303  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0304  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0305  60       LH Unused Time
     C                     MOVEL*BLANK    WN0306  1        EDI Status 1
     C                     MOVEL*BLANK    WN0307  1        EDI Status 2
     C                     MOVEL*BLANK    WN0308  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0309  60       Job Time
     C                     MOVEL*BLANK    WN0310 10        User Id
     C                     MOVEL*BLANK    WN0311 10        Job Name
     C                     Z-ADD*ZERO     WN0312  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDFJRMNB    WIRMNB           Load ID
      *
     C           KLCHTA    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHTA    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0168    WITLMI           Total Load Mile
     C                     MOVELWN0169    WIVPCD    P      Ship From Wareh
     C                     MOVELWN0170    WIAJCD    P      Warehouse Code
     C                     Z-ADDWN0171    WIK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTB02           Load ID
      * Define keylist
     C           KPSTB     KLIST
     C                     KFLD           WQTB02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTB02           Load ID
     C                     Z-ADD*ZERO     FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSTB     SETLL@FLCPEB                    *
     C           KRSTB     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDFLN7DT    WUN7DT           LD Carrier Appt
     C                     Z-ADDFLB3TM    WN0147           LD Carrier Appt
     C                     GOTO TBEXIT                     *QUIT
     C           KRSTB     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTC02           Load ID
      * Define keylist
     C           KPSTC     KLIST
     C                     KFLD           WQTC02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTC02           Load ID
     C                     Z-ADD*ZERO     FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSTC     SETLL@FLCPEB                    *
     C           KRSTC     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
     C                     EXSR TDRVGN
     C                     GOTO TCEXIT                     *QUIT
     C           KRSTC     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WEAIC3           Company Number
     C                     Z-ADDFLC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     Z-ADD*ZERO     WN0146           Requested Deliv
     C                     Z-ADD*ZERO     WN0166           Requested Deliv
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBRTX    WUBRTX           Ship To Name
     C                     MOVELWEHNNA    WUHNNA           Ship To City
     C                     Z-ADDWEEIDT    WN0146           Requested Deliv
     C                     Z-ADDWEAFTM    WN0166           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTE     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJQ2CD    YL0011           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTF02           Load ID
      * Define keylist
     C           KPSTF     KLIST
     C                     KFLD           WQTF02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
     C                     KFLD           FLC4NB           Order Number
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF02           Load ID
      * Setup key
     C                     Z-ADDWL0033    WQTF02           Load ID
     C                     Z-ADDWL0034    FLRVNB           Stop_Drop
     C                     Z-ADDWL0035    FLC4NB           Order Number
      * Establish starting position
     C           KPSTF     SETLL@FLCPEB                    *
     C           KRSTF     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLRWNB    WL0036           Miles to next s
     C                     GOTO TFEXIT                     *QUIT
     C           KRSTF     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSTG     KLIST
     C                     KFLD           LGMILE           Miles to First
      * Setup key
     C                     Z-ADDWN0314    LGMILE           Miles to First
      * Establish starting position
     C           KPSTG     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLGHRRQ    YL0012           Hours Required
     C                     GOTO TGEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTH     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    WUG0TX           Load Status
     C                     Z-ADDFJTLMI    WUTLMI           Total Load Mile
     C                     Z-ADDFJK2DT    WUK2DT           Override Total
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJRMNB    WQTI02           Load ID
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTI02           Load ID
      * Establish starting position
     C           KRSTI     SETLL@FLCPE8                    *
     C           KRSTI     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - PD Order Header  * 
     C                     EXSR TJRVGN
     C                     GOTO TIEXIT                     *QUIT
     C           KRSTI     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWJAIC3    WEAIC3           Company Number
     C                     Z-ADDWJC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTJ     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBKC7    WUBKC7           Ship To Custome
     C                     MOVELWEBRTX    WUBRTX           Ship To Name
     C                     MOVELWEHMNA    WUHMNA           Ship To Address
     C                     MOVELWEHONA    WUHONA           Ship To Address
     C                     MOVELWEHPNA    WUHPNA           Ship To Address
     C                     MOVELWEHNNA    WUHNNA           Ship To City
     C                     MOVELWEDBCD    WN0141           Ship To State C
     C                     MOVELWECKTX    WUCKTX           Ship To Zip_Pos
     C                     MOVELWEBCNA    WUG0TX           Customer Purcha
     C                     MOVELWEB6NA    WUG0TX           Special Instruc
     C                     MOVELWEBYNA    WUG0TX           Special Instruc
     C                     Z-ADDWEEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWEAFTM    WUNFNN           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTK02           Load ID
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTK02           Load ID
      * Establish starting position
     C           KRSTK     SETLL@BFCPD9                    *
     C           KRSTK     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGHNNA    WN0151           Ship To City
     C                     MOVELWGDBCD    WN0152           Ship To State C
     C                     GOTO TKEXIT                     *QUIT
     C           KRSTK     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           LEBZNA           Carrier Code
     C                     KFLD           LEAJCD           Warehouse Code
     C                     KFLD           LEXECD           Destination Cit
     C                     KFLD           LEBGCD           State Code
      * Setup key
     C                     MOVELWN0142    LEBZNA           Carrier Code
     C                     MOVELWN0140    LEAJCD           Warehouse Code
     C                     MOVELWN0151    LEXECD           Destination Cit
     C                     MOVELWN0152    LEBGCD           State Code
      * Establish starting position
     C           KRSTL     CHAIN@LECPM7              90    *
      * Data record not found
     C   90                MOVEL'USR2455' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * only pass out FLAT amt.  (it could now be a ML rate too)  01/03/0
      * CASE: DB1.CDR Unit of Measure is Flat
     C           LEAVTX    IFEQ 'FL'                       *IF
      * PAR = DB1 By name
     C                     Z-ADDLENMVA    WN0137           Flat Rate
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCHRC    BEGSR
      *================================================================
      * CHG Lock Load Update   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0322  30       Company Number
     C                     MOVEL*BLANK    WN0323  1        LTL Flag
     C                     Z-ADD*ZERO     WN0324  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0325 15        Seal 1
     C                     MOVEL*BLANK    WN0326 15        Seal 2
     C                     MOVEL*BLANK    WN0327 15        Seal 3
     C                     MOVEL*BLANK    WN0328 15        Seal 4
     C                     MOVEL*BLANK    WN0329 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0330  70       Total Load Orde
     C                     MOVEL*BLANK    WN0331  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0332  50       Total Stops
     C                     MOVEL*BLANK    WN0333 20        Trailer Id
     C                     MOVEL*BLANK    WN0334  3        Transloader Car
     C                     Z-ADD*ZERO     WN0335  40       BOL Time
     C                     MOVEL*BLANK    WN0336  3        Carrier Code
     C                     MOVEL*BLANK    WN0337  7        Truck Size
     C                     Z-ADD*ZERO     WN0338  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0339 112       Rated Freight
     C                     MOVEL*BLANK    WN0340  1        Ship Status
     C                     MOVEL*BLANK    WN0341  1        Load Type
     C                     Z-ADD*ZERO     WN0342  50       Number Pallets
     C                     Z-ADD*ZERO     WN0343  50       Number Pallets
     C                     Z-ADD*ZERO     WN0344 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0345  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0346  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0347  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0348 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0349 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0350  70       Actual Departur
     C                     Z-ADD*ZERO     WN0351  40       Departure Time
     C                     Z-ADD*ZERO     WN0352  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0353  52       Product Tempera
     C                     Z-ADD*ZERO     WN0354  50       Number Spacers
     C                     MOVEL*BLANK    WN0355 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0356  70       Total Load Mile
     C                     MOVEL*BLANK    WN0357 12        Recorder ID
     C                     MOVEL*BLANK    WN0358  2        Shipping Method
     C                     Z-ADD*ZERO     WN0359  70       Gross Weight
     C                     MOVEL*BLANK    WN0360  3        Carrier Broker
     C                     MOVEL*BLANK    WN0361  1        Export Status
     C                     Z-ADD*ZERO     WN0362  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0363  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0364  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0365  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0366  70       Spotted Date
     C                     Z-ADD*ZERO     WN0367  60       Spotted Time
     C                     Z-ADD*ZERO     WN0368  70       Load Finished D
     C                     Z-ADD*ZERO     WN0369  60       Load Finished T
     C                     Z-ADD*ZERO     WN0370  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0371  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0372  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0373  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0374  70       Truck Departure
     C                     Z-ADD*ZERO     WN0375  60       Truck Departure
     C                     Z-ADD*ZERO     WN0376  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0377  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0378  3        Shipping Line
     C                     MOVEL*BLANK    WN0379 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0380 30        Vessel Name
     C                     Z-ADD*ZERO     WN0381  50       Voyage
     C                     Z-ADD*ZERO     WN0382  70       Sail Date
     C                     MOVEL*BLANK    WN0383 12        Booking Number
     C                     MOVEL*BLANK    WN0384 20        Discharge Port
     C                     Z-ADD*ZERO     WN0385  70       Arrival Date
     C                     MOVEL*BLANK    WN0386 12        Container Numbe
     C                     Z-ADD*ZERO     WN0387  70       Date In
     C                     Z-ADD*ZERO     WN0388  60       Time In
     C                     Z-ADD*ZERO     WN0389  70       Date Out
     C                     Z-ADD*ZERO     WN0390  60       Time Out
     C                     Z-ADD*ZERO     WN0391 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0392  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0393  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0394  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0395  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0396  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0397  70       Requested Deliv
     C                     MOVEL*BLANK    WN0398  1        Load Acceptance
     C                     MOVEL*BLANK    WN0399  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0400  70       On Yard Date
     C                     Z-ADD*ZERO     WN0401  60       On Yard Time
     C                     MOVEL*BLANK    WN0402  1        Load Held Over
     C                     MOVEL*BLANK    WN0403  1        Load Held Over
     C                     MOVEL*BLANK    WN0404 15        Load Held Over
     C                     MOVEL*BLANK    WN0405 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0406 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0407  70       Express Mail Da
     C                     MOVEL*BLANK    WN0408  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0409  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0410  70       Product Complet
     C                     Z-ADD*ZERO     WN0411  60       Product Complet
     C                     Z-ADD*ZERO     WN0412  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0413  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0414  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0415  1        Load Confirmed
     C                     MOVEL*BLANK    WN0416 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0417  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0418  60       Load Door 1
     C                     Z-ADD*ZERO     WN0419  70       Override Total
     C                     Z-ADD*ZERO     WN0420  60       Load Door 2
     C                     MOVEL*BLANK    WN0421  1        Partial Load
     C                     MOVEL*BLANK    WN0422  1        Load Confirmati
     C                     MOVEL*BLANK    WN0423  1        Export Load USD
     C                     MOVEL*BLANK    WN0424  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0425 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0426 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0427 15        Late Billing Em
     C                     MOVEL*BLANK    WN0428 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0429 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0430  1        Multi Company L
     C                     MOVEL*BLANK    WN0431  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0432  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0433  1        LH Power Only L
     C                     MOVEL*BLANK    WN0434  1        MG Created Load
     C                     MOVEL*BLANK    WN0435  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0436  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0437  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0438  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0439  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0440  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0441  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0442  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0443  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0444  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0445  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0446  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0447  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0448  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0449  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0450  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0451  60       LH Unused Time
     C                     MOVEL*BLANK    WN0452  1        EDI Status 1
     C                     MOVEL*BLANK    WN0453  1        EDI Status 2
     C                     MOVEL*BLANK    WN0454  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0455  60       Job Time
     C                     MOVEL*BLANK    WN0456 10        User Id
     C                     MOVEL*BLANK    WN0457 10        Job Name
     C                     Z-ADD*ZERO     WN0458  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WIRMNB           Load ID
      *
     C           KLCHTM    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHTM    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YCRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0136    WIAODT           Scheduled Ship
     C                     MOVEL'L'       WIPKST    P      Load Status
     C                     Z-ADDWN0137    WIFLAM           Flat Amount
     C                     MOVELWN0140    WIVPCD    P      Ship From Wareh
     C                     MOVELWN0141    WIDBCD    P      Ship To State C
     C                     Z-ADDWN0146    WIKZDT           Deadline Depart
     C                     Z-ADDWN0147    WIAXTM           Deadline Depart
     C                     MOVELWN0149    WIR0SX    P      Load U_M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * RTV All Whses on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0153           USR Warehouse C
     C                     MOVEL*BLANK    WN0154           USR CDE Parm 1
     C                     MOVEL*BLANK    WN0155           USR CDE Parm 2
     C                     MOVEL*BLANK    WN0156           USR CDE Parm 3
     C                     MOVEL*BLANK    WN0157           USR CDE Parm 4
     C                     MOVEL*BLANK    WN0158           USR CDE Parm 5
     C                     MOVEL*BLANK    WN0159           USR CDE Parm 6
     C                     MOVEL*BLANK    WN0160           USR CDE Parm 7
     C                     MOVEL*BLANK    WN0161           USR CDE Parm 8
     C                     MOVEL*BLANK    WN0162           USR CDE Parm 9
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKRMNB    WQTN02           Load ID
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTN02           Load ID
      * Establish starting position
     C           KRSTN     SETLL@FLCPKF                    *
     C           KRSTN     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Whses on Order RT - Order Detail  * 
     C                     EXSR TORVGN
     C           KRSTN     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV All Whses on Order RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQTO01           Company Number
     C           *LIKE     DEFN WBC4NB    WQTO02           Order Number
      * Define keylist
     C           KPSTO     KLIST
     C                     KFLD           WQTO01           Company Number
     C                     KFLD           WQTO02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Company Number
     C                     KFLD           WQTO02           Order Number
      * Setup key
     C                     Z-ADDWKAIC3    WQTO01           Company Number
     C                     Z-ADDWKC4NB    WQTO02           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
      * Establish starting position
     C           KPSTO     SETLL@BGWKAE                    *
     C           KRSTO     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code EQ PAR.USR Warehouse Code
     C           WBAJCD    IFEQ WN0153                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 1
     C           WBAJCD    IFEQ WN0154                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 2
     C           WBAJCD    IFEQ WN0155                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 3
     C           WBAJCD    IFEQ WN0156                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 4
     C           WBAJCD    IFEQ WN0157                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 5
     C           WBAJCD    IFEQ WN0158                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 6
     C           WBAJCD    IFEQ WN0159                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 7
     C           WBAJCD    IFEQ WN0160                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 8
     C           WBAJCD    IFEQ WN0161                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 9
     C           WBAJCD    IFEQ WN0162                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * current warehouse not already being used
      * Fill in first blank warehouse
      * CASE: PAR.USR Warehouse Code EQ WRK.BLANK
     C           WN0153    IFEQ WUGSTX                     *IF
     C                     MOVELWBAJCD    WN0153           USR Warehouse C
     C                     ELSE
      * CASE: PAR.USR CDE Parm 1 EQ WRK.BLANK
     C           WN0154    IFEQ WUGSTX                     *IF
     C                     MOVELWBAJCD    WN0154           USR CDE Parm 1
     C                     ELSE
      * CASE: PAR.USR CDE Parm 2 EQ WRK.BLANK
     C           WN0155    IFEQ WUGSTX                     *IF
     C                     MOVELWBAJCD    WN0155           USR CDE Parm 2
     C                     ELSE
      * CASE: PAR.USR CDE Parm 3 EQ WRK.BLANK
     C           WN0156    IFEQ WUGSTX                     *IF
     C                     MOVELWBAJCD    WN0156           USR CDE Parm 3
     C                     ELSE
      * CASE: PAR.USR CDE Parm 4 EQ WRK.BLANK
     C           WN0157    IFEQ WUGSTX                     *IF
     C                     MOVELWBAJCD    WN0157           USR CDE Parm 4
     C                     ELSE
      * CASE: PAR.USR CDE Parm 5 EQ WRK.BLANK
     C           WN0158    IFEQ WUGSTX                     *IF
     C                     MOVELWBAJCD    WN0158           USR CDE Parm 5
     C                     ELSE
      * CASE: PAR.USR CDE Parm 6 EQ WRK.BLANK
     C           WN0159    IFEQ WUGSTX                     *IF
     C                     MOVELWBAJCD    WN0159           USR CDE Parm 6
     C                     ELSE
      * CASE: PAR.USR CDE Parm 7 EQ WRK.BLANK
     C           WN0160    IFEQ WUGSTX                     *IF
     C                     MOVELWBAJCD    WN0160           USR CDE Parm 7
     C                     ELSE
      * CASE: PAR.USR CDE Parm 8 EQ WRK.BLANK
     C           WN0161    IFEQ WUGSTX                     *IF
     C                     MOVELWBAJCD    WN0161           USR CDE Parm 8
     C                     ELSE
      * CASE: PAR.USR CDE Parm 9 EQ WRK.BLANK
     C           WN0162    IFEQ WUGSTX                     *IF
     C                     MOVELWBAJCD    WN0162           USR CDE Parm 9
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTO     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLRMNB    WQTP01           Load ID
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTP01           Load ID
      * Establish starting position
     C           KRSTP     SETLL@FLCPBW                    *
     C           KRSTP     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR TQRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WN0459           Trans Contol AS
     C                     GOTO TPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTP     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWLAIC3    WEAIC3           Company Number
     C                     Z-ADDWLC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTQ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR TRRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO TQEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTR01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTR02           Order Number
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Company Number
     C                     KFLD           WQTR02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQTR01           Company Number
     C                     Z-ADDWEC4NB    WQTR02           Order Number
      * Establish starting position
     C           KRSTR     SETLL@BGWKL1                    *
     C           KRSTR     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR TSRVGN
     C                     GOTO TREXIT                     *QUIT
     C                     END                             *FI
     C           KRSTR     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSTS     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCF8NA    WUF8NA           Warehouse Descr
     C                     MOVELWCXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0037    BUY1NX           PFS Company Num
     C                     MOVELWL0038    BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSTT     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0039           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0040           PFS Carlisle Ac
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    WL0039           PFS AccuSort Ac
     C                     MOVELBUWUSX    WL0040           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * RTV Get Create DateTimeRT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     P7K4DT           Created Date
     C                     Z-ADD*ZERO     P7A1TM           Created Time
      * Declare restrictor key work fields
     C           *LIKE     DEFN LHRMNB    WQTU01           Load ID
     C           *LIKE     DEFN LHC4NB    WQTU02           Order Number
     C           *LIKE     DEFN LHRVST    WQTU03           Load Change Typ
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WQTU01           Load ID
     C                     KFLD           WQTU02           Order Number
     C                     KFLD           WQTU03           Load Change Typ
      * Setup key
     C                     Z-ADD#1RMNB    WQTU01           Load ID
     C                     Z-ADD#1C4NB    WQTU02           Order Number
     C                     MOVELP7RVST    WQTU03           Load Change Typ
      * Establish starting position
     C           KRSTU     SETLL@LHCPHB                    *
     C           KRSTU     READE@LHCPHB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLHK4DT    P7K4DT           Created Date
     C                     Z-ADDLHA1TM    P7A1TM           Created Time
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO TUEXIT                     *QUIT
     C           KRSTU     READE@LHCPHB                  90*
     C                     ENDDO
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * RTV MG Created Load   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTV     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0028           MG Created Load
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJRYSX    YL0028           MG Created Load
     C                     GOTO TVEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCHRC    BEGSR
      *================================================================
      * CHG Deadline Dep D/T   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0460  30       Company Number
     C                     Z-ADD*ZERO     WN0461  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0462  1        LTL Flag
     C                     MOVEL*BLANK    WN0463  1        Load Status
     C                     Z-ADD*ZERO     WN0464  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0465 15        Seal 1
     C                     MOVEL*BLANK    WN0466 15        Seal 2
     C                     MOVEL*BLANK    WN0467 15        Seal 3
     C                     MOVEL*BLANK    WN0468 15        Seal 4
     C                     MOVEL*BLANK    WN0469 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0470  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0471 112       Flat Amount
     C                     MOVEL*BLANK    WN0472  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0473  50       Total Stops
     C                     MOVEL*BLANK    WN0474 20        Trailer Id
     C                     MOVEL*BLANK    WN0475  3        Transloader Car
     C                     Z-ADD*ZERO     WN0476  40       BOL Time
     C                     MOVEL*BLANK    WN0477  3        Carrier Code
     C                     MOVEL*BLANK    WN0478  7        Truck Size
     C                     Z-ADD*ZERO     WN0479  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0480 112       Rated Freight
     C                     MOVEL*BLANK    WN0481  1        Ship Status
     C                     MOVEL*BLANK    WN0482  1        Load Type
     C                     Z-ADD*ZERO     WN0483  50       Number Pallets
     C                     Z-ADD*ZERO     WN0484  50       Number Pallets
     C                     Z-ADD*ZERO     WN0485 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0486  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0487  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0488  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0489 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0490 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0491  70       Actual Departur
     C                     Z-ADD*ZERO     WN0492  40       Departure Time
     C                     Z-ADD*ZERO     WN0493  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0494  52       Product Tempera
     C                     Z-ADD*ZERO     WN0495  50       Number Spacers
     C                     MOVEL*BLANK    WN0496 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0497  70       Total Load Mile
     C                     MOVEL*BLANK    WN0498 12        Recorder ID
     C                     MOVEL*BLANK    WN0499  2        Shipping Method
     C                     MOVEL*BLANK    WN0500  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0501  2        Ship To State C
     C                     Z-ADD*ZERO     WN0502  70       Gross Weight
     C                     MOVEL*BLANK    WN0503  3        Carrier Broker
     C                     MOVEL*BLANK    WN0504  1        Export Status
     C                     Z-ADD*ZERO     WN0505  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0506  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0507  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0508  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0509  70       Spotted Date
     C                     Z-ADD*ZERO     WN0510  60       Spotted Time
     C                     Z-ADD*ZERO     WN0511  70       Load Finished D
     C                     Z-ADD*ZERO     WN0512  60       Load Finished T
     C                     Z-ADD*ZERO     WN0513  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0514  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0515  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0516  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0517  70       Truck Departure
     C                     Z-ADD*ZERO     WN0518  60       Truck Departure
     C                     Z-ADD*ZERO     WN0519  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0520  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0521  3        Shipping Line
     C                     MOVEL*BLANK    WN0522 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0523 30        Vessel Name
     C                     Z-ADD*ZERO     WN0524  50       Voyage
     C                     Z-ADD*ZERO     WN0525  70       Sail Date
     C                     MOVEL*BLANK    WN0526 12        Booking Number
     C                     MOVEL*BLANK    WN0527 20        Discharge Port
     C                     Z-ADD*ZERO     WN0528  70       Arrival Date
     C                     MOVEL*BLANK    WN0529 12        Container Numbe
     C                     Z-ADD*ZERO     WN0530  70       Date In
     C                     Z-ADD*ZERO     WN0531  60       Time In
     C                     Z-ADD*ZERO     WN0532  70       Date Out
     C                     Z-ADD*ZERO     WN0533  60       Time Out
     C                     Z-ADD*ZERO     WN0534 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0535  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0536  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0537  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0538  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0539  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0540  70       Requested Deliv
     C                     MOVEL*BLANK    WN0541  1        Load Acceptance
     C                     MOVEL*BLANK    WN0542  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0543  70       On Yard Date
     C                     Z-ADD*ZERO     WN0544  60       On Yard Time
     C                     MOVEL*BLANK    WN0545  1        Load Held Over
     C                     MOVEL*BLANK    WN0546  1        Load Held Over
     C                     MOVEL*BLANK    WN0547 15        Load Held Over
     C                     MOVEL*BLANK    WN0548 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0549 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0550  70       Express Mail Da
     C                     MOVEL*BLANK    WN0551  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0552  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0553  70       Product Complet
     C                     Z-ADD*ZERO     WN0554  60       Product Complet
     C                     Z-ADD*ZERO     WN0555  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0556  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0557  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0558  1        Load Confirmed
     C                     MOVEL*BLANK    WN0559 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0560  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0561  60       Load Door 1
     C                     Z-ADD*ZERO     WN0562  70       Override Total
     C                     Z-ADD*ZERO     WN0563  60       Load Door 2
     C                     MOVEL*BLANK    WN0564  1        Partial Load
     C                     MOVEL*BLANK    WN0565  1        Load Confirmati
     C                     MOVEL*BLANK    WN0566  1        Export Load USD
     C                     MOVEL*BLANK    WN0567  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0568 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0569 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0570 15        Late Billing Em
     C                     MOVEL*BLANK    WN0571 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0572 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0573  1        Multi Company L
     C                     MOVEL*BLANK    WN0574  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0575  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0576  1        LH Power Only L
     C                     MOVEL*BLANK    WN0577  1        MG Created Load
     C                     MOVEL*BLANK    WN0578  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0579  2        Load U_M
     C                     MOVEL*BLANK    WN0580  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0581  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0582  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0583  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0584  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0585  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0586  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0587  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0588  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0589  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0590  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0591  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0592  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0593  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0594  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0595  60       LH Unused Time
     C                     MOVEL*BLANK    WN0596  1        EDI Status 1
     C                     MOVEL*BLANK    WN0597  1        EDI Status 2
     C                     MOVEL*BLANK    WN0598  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0599  60       Job Time
     C                     MOVEL*BLANK    WN0600 10        User Id
     C                     MOVEL*BLANK    WN0601 10        Job Name
     C                     Z-ADD*ZERO     WN0602  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WIRMNB           Load ID
      *
     C           KLCHTW    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHTW    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YDRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWUKZDT    WIKZDT           Deadline Depart
     C                     Z-ADDWUAXTM    WIAXTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * CHG Deadline Date/Time RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLRMNB    WQTX01           Load ID
      * Define keylist
     C           KPSTX     KLIST
     C                     KFLD           WQTX01           Load ID
     C                     KFLD           WLRUNB           Stop_Drop Seque
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTX01           Load ID
     C                     Z-ADD*ZERO     WLRUNB           Stop_Drop Seque
      * Establish starting position
     C           KPSTX     SETLL@FLCPBW                    *
     C           KRSTX     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TXEXIT                     *QUIT
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Deadline Date/Time CH - Load Detail  * 
     C                     EXSR TYCHRC
     C           KRSTX     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCHRC    BEGSR
      *================================================================
      * CHG Deadline Date/Time CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0603  50       Stop_Drop
     C                     MOVEL*BLANK    WN0604 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0605  50       Miles to next s
     C                     Z-ADD*ZERO     WN0606  72       Freight Charge
     C                     Z-ADD*ZERO     WN0607  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0608 112       Freight Misc_Ch
     C                     Z-ADD*ZERO     WN0609  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0610 112       Rated Freight
     C                     Z-ADD*ZERO     WN0611  30       Company Number
     C                     Z-ADD*ZERO     WN0612  70       Order Number
     C                     MOVEL*BLANK    WN0613  1        Ship Status
     C                     Z-ADD*ZERO     WN0614  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0615  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0616  70       Appointment Con
     C                     Z-ADD*ZERO     WN0617  60       Appointment Con
     C                     MOVEL*BLANK    WN0618 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0619 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0620  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0621  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0622  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0623  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0624  70       On Yard Date
     C                     Z-ADD*ZERO     WN0625  60       On Yard Time
     C                     Z-ADD*ZERO     WN0626  70       MPC Number
     C                     MOVEL*BLANK    WN0627  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0628  1        On Time Addl Rs
     C                     MOVEL*BLANK    WN0629 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0630 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0631 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0632 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0633 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0634  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0635  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0636  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0637  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0638  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0639  60       LD Unused Time
     C                     MOVEL*BLANK    WN0640  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0641  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0642  2        HPB Transload S
     C                     MOVEL*BLANK    WN0643 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0644 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN0645 25        Cust Assigned A
     C                     MOVEL*BLANK    WN0646  1        EDI Status 1
     C                     MOVEL*BLANK    WN0647  1        EDI Status 2
     C                     MOVEL*BLANK    WN0648  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0649  60       Job Time
     C                     MOVEL*BLANK    WN0650 10        User Id
     C                     MOVEL*BLANK    WN0651 10        Job Name
     C                     Z-ADD*ZERO     WN0652  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADD#1RMNB    WMRMNB           Load ID
     C                     Z-ADDWLRUNB    WMRUNB           Stop_Drop Seque
      *
     C           KLCHTY    KLIST
     C                     KFLD           WMRMNB           Load ID
     C                     KFLD           WMRUNB           Stop_Drop Seque
     C           KLCHTY    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YERDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWUKZDT    WMHDDT           Deadline Depart
     C                     Z-ADDWUAXTM    WMAUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##JOB     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
     C                     EXSR TZRVGN
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTZ01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTZ02           Order Number
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           WQTZ01           Company Number
     C                     KFLD           WQTZ02           Order Number
      * Setup key
     C                     Z-ADDWMAIC3    WQTZ01           Company Number
     C                     Z-ADDWMC4NB    WQTZ02           Order Number
      * Establish starting position
     C           KRSTZ     SETLL@BGWKL1                    *
     C           KRSTZ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR NACHRC
     C           KRSTZ     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Retrieve Credit Limits.    8/01/02
      *================================================================
      * * A/R Credit Limit *
      * RTV Credit Limits      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEANC7    WL0001           Ship To Custome
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0002           Parent Customer
     C                     MOVELWL0003    YL0003    P      Credit Check AR
     C                     MOVELWL0004    YL0004    P      Credit Check Pa
     C                     Z-ADDWL0005    WUNFNN           Parent Credit L
     C                     Z-ADDWL0006    YL0005           AR Credit Limit
      * * Parent Credit Limit *
      * RTV Credit Limits      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0002    WL0001           Ship To Custome
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WUNFNN           Parent Customer
     C                     MOVELWL0003    WUG0TX    P      Credit Check AR
     C                     MOVELWL0004    WUG0TX    P      Credit Check Pa
     C                     Z-ADDWL0005    YL0006           Parent Credit L
     C                     Z-ADDWL0006    WUNFNN           AR Credit Limit
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Ensure that we are using fresh data
      *================================================================
      * RTV All Header Fields  RT - Order Header TRG  * 
     C                     EXSR SKRVGN
      * Init Prod hold to blank if No.
      * CASE: RCD.Production Hold is No
     C           #1XJST    IFEQ 'N'                        *IF
     C                     MOVELP2XJST    #1XJST           Production Hold
     C                     END                             *FI
      * Init New Cust hold to blank if No.
      * CASE: RCD.New Customer Hold is No
     C           #1XKST    IFEQ 'N'                        *IF
     C                     MOVELP2XKST    #1XKST           New Customer Ho
     C                     END                             *FI
      * RTV Load Status        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0013           Load ID
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUPKST    P      Load Status
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 09/20/2011 LJB P001251  Export Order Automation Upload
      * ** Cannot lock load if there are errors still pending in the
      * ** Order Detail record
      * *****
      * ** Auto lock if shipping today & no errors            E00495
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0025  70       Load ID
     C           WN0149    PARM *BLANK    WQ0026  2        Load U_M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * WI642 JM 02/21/25 Load Order Change Log-USDA FAS 98 and FAS99
      *  - Existing bug fix for cancel of credit release scenario
      *  if order was previously Credit Released,then make Load Change Ty
      *  = Credit Release Cancelled
      * E4119 RMC 7/15/16 Dont Calc DDT if MG Created Load is Yes
      * E4119 RMC 5/20/16 Remove live with tpm check
      * *****
      * ** 04/12/2013 RMC P0196 if pfs interface is live with ORDONL (Dai
      *    Then create PFS Download files for Order if not load tied yet.
      * *****
      * ** 03/14/2014 LJB E003028 Create Log record when credit released
      * **   Add option 6 to display Order Header. This will give Account
      * **   access to Display Order Change Log so they can see Cred Rele
      * *****
      * ** 10/16/2013 RMC E2824 Allow Release Credit Hold independent of
      * *****
      * ** 06/05/2013 RMC E002622 Display Sales Rte for selection
      * *****
      * ** 06/15/2012 RMC E002148 Display Load Sts for selection
      * *****
      * ** 09/20/2011 LJB P001251 Export Order Automation Upload
      * ** In lock edit checks, don't allow lock if errors still pending
      * ** in the Order Detail record
      * *****
      * ** 02/09/2011 RMC E01325
      * ** Added Warehouse as a selector.
      * *****
      * ** 11/25/2009 LJB W272
      * ** Autolock, anyway, without checking the date
      * *****
      * ** 09/30/2009 RMC E00495
      * ** replace ship with Bill to cust, removed reason, hdr sts, blk o
      * ** 09/30/2009 LJB E00495
      * ** Change to auto-lock only if shipping today. Also, RTV the
      * ** carrier appt date/time, if entered - use for DDD/T calcs.
      * *****
      * ** FP1054 07/24/09 RMC
      * ** Dont lock load if shipping later than tomorrow, so pass in NO
      * ** Lock Opt override
      * *****
      * ** OMSLJB3 02/06/2006 LJB
      * ** Change the logical file and put Co# as a lower order key so
      * **   all companies for the selected date sort together.
      * *****
      * ** T00014 03/27/2006 LJB
      * ** Put blanks in new input parm for the DSP A/R Summary
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XTCKTM    BEGSR
      *================================================================
      * Validate time format
      *================================================================
      * If time is zero, do not check
     C           XTTIM     CABEQ*ZERO     XTCKTE
     C                     MOVEL*BLANK    W0RTN   7
     C           YPMTFD    CABNE*BLANK    XTCKTE
      *
      * Check hours in range 0 to 23
      * Check minutes in range 0 to 59
      * Check seconds in range 0 to 59
     C           XTHH      IFLT *ZERO
     C           XTHH      ORGT 23
     C           XTNN      ORLT *ZERO
     C           XTNN      ORGT 59
     C           XTSS      ORLT *ZERO
     C           XTSS      ORGT 59
      * Send error message
      * Send message '*Invalid time'
     C                     MOVEL'Y2U0019' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0019' W0RTN
     C                     END
      *================================================================
     CSR         XTCKTE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 02560
     C           ZINPOS    ANDLE06144
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  10        W0CSRR  50
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ADD  10        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD10        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ107
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2XIST'  YPMTFD           Credit Hold
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ110
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2XJST'  YPMTFD           Production Hold
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ113
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CPKST'  YPMTFD           Load Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2XIST           Credit Hold
     C                     MOVEL*BLANK    P2XJST           Production Hold
     C                     MOVEL*BLANK    P2XKST           New Customer Ho
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3XMST           Credit Hold Aut
     C                     MOVEL*BLANK    P3XNST           Production Hold
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4O9CD           USR Reason Code
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5ECST           Error Status
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6E6ST           USR Status (Y/N
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7K4DT           Created Date
     C                     Z-ADD*ZERO     P7A1TM           Created Time
     C                     Z-ADD*ZERO     P7DXNB           Sequence Number
     C                     Z-ADD*ZERO     P7RMNB           Load ID
     C                     Z-ADD*ZERO     P7RVNB           Stop_Drop
     C                     MOVEL*BLANK    P7RVST           Load Change Typ
     C                     MOVEL*BLANK    P7UJST           Department Cont
     C                     MOVEL*BLANK    P7MNTX           Change Log Prio
     C                     MOVEL*BLANK    P7MOTX           Change Log New
     C                     MOVEL*BLANK    P7AYNA           User Id
     C                     MOVEL*BLANK    P7A0NA           Job Name
     C                     MOVEL*BLANK    P7BZNA           Carrier Code
     C                     MOVEL*BLANK    P7XMCD           Carrier Broker
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D_B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D_B Rat
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WBGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WCBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Remaining Balance Due
     C                     Z-ADD*ZERO     WUBGVA 112
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           AR Customer Num
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A_R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WENPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WENQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WENRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WENSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           Time of Origina
     C                     Z-ADD*ZERO     WEBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WEBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WEBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WEH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WEH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WEH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WEH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WEH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Define work field STATUS
     C                     MOVEL*BLANK    WUATUS  1
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Reefer Temperature
     C                     Z-ADD*ZERO     WURNNB  52
      * Define work field Flat Amount
     C                     Z-ADD*ZERO     WUFLAM 112
      * Define work field Allocate Pounds_Miles
     C                     MOVEL*BLANK    WUXQST  1
      * Define work field Rated Freight
     C                     Z-ADD*ZERO     WUR1NB 112
      * Define work field Load Type
     C                     MOVEL*BLANK    WUVDST  1
      * Define work field Schedule Sequence Number
     C                     Z-ADD*ZERO     WUT4NB  50
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Ship From Warehouse
     C                     MOVEL*BLANK    WUVPCD  3
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Carrier Broker
     C                     MOVEL*BLANK    WUXCCD  3
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field Shipping Temp C_F txt
     C                     MOVEL*BLANK    WUWRTX 25
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WIRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WIRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WIFLAM           Flat Amount
     C                     Z-ADD*ZERO     WIRRNB           Total Stops
     C                     Z-ADD*ZERO     WISBNB           BOL Time
     C                     Z-ADD*ZERO     WISQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WISDNB           Number Pallets
     C                     Z-ADD*ZERO     WIPAOU           Number Pallets
     C                     Z-ADD*ZERO     WIDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WISXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WIHADT           Actual Arrival
     C                     Z-ADD*ZERO     WIAART           Actual Arrival
     C                     Z-ADD*ZERO     WIDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WIDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WIAQDT           Actual Departur
     C                     Z-ADD*ZERO     WIS6NB           Departure Time
     C                     Z-ADD*ZERO     WIT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WIPRTM           Product Tempera
     C                     Z-ADD*ZERO     WINPSV           Number Spacers
     C                     Z-ADD*ZERO     WITLMI           Total Load Mile
     C                     Z-ADD*ZERO     WIGRWE           Gross Weight
     C                     Z-ADD*ZERO     WIF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WIJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WITRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WIJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WISPTM           Spotted Time
     C                     Z-ADD*ZERO     WIJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WILFTM           Load Finished T
     C                     Z-ADD*ZERO     WIJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WIBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WIJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WIBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WIKIDT           Truck Departure
     C                     Z-ADD*ZERO     WIASTM           Truck Departure
     C                     Z-ADD*ZERO     WIKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WIAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WIVOAG           Voyage
     C                     Z-ADD*ZERO     WIKBDT           Sail Date
     C                     Z-ADD*ZERO     WIEFDT           Arrival Date
     C                     Z-ADD*ZERO     WIKCDT           Date In
     C                     Z-ADD*ZERO     WITMIN           Time In
     C                     Z-ADD*ZERO     WIKDDT           Date Out
     C                     Z-ADD*ZERO     WIVMNB           Time Out
     C                     Z-ADD*ZERO     WIOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WIKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WIATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WIBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WIEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WIKKDT           On Yard Date
     C                     Z-ADD*ZERO     WIAVTM           On Yard Time
     C                     Z-ADD*ZERO     WIKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WIAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WILLDT           Express Mail Da
     C                     Z-ADD*ZERO     WIK0DT           Product Complet
     C                     Z-ADD*ZERO     WIAYTM           Product Complet
     C                     Z-ADD*ZERO     WIKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WIICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WIIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WIK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WIAZTM           Load Door 1
     C                     Z-ADD*ZERO     WIK2DT           Override Total
     C                     Z-ADD*ZERO     WIA0TM           Load Door 2
     C                     Z-ADD*ZERO     WIZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WIPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WICKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WIPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WICLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WIP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WICMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WIP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WICNTM           LH Unused Time
     C                     Z-ADD*ZERO     WIP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WICOTM           LH Unused Time
     C                     Z-ADD*ZERO     WIP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WICQTM           LH Unused Time
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     WUN7DT  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJRMNB           Load ID
     C                     Z-ADD*ZERO     WJRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WJRVNB           Stop_Drop
     C                     Z-ADD*ZERO     WJRWNB           Miles to next s
     C                     Z-ADD*ZERO     WJRXNB           Freight Charge
     C                     Z-ADD*ZERO     WJSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WJT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WJT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WJSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WJKFDT           Appointment Con
     C                     Z-ADD*ZERO     WJACTM           Appointment Con
     C                     Z-ADD*ZERO     WJEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WJAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WJKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WJATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WJHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WJAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WJKKDT           On Yard Date
     C                     Z-ADD*ZERO     WJAVTM           On Yard Time
     C                     Z-ADD*ZERO     WJZ4NB           MPC Number
     C                     Z-ADD*ZERO     WJN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WJN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WJN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WJB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WJB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WJB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Destination City
     C                     MOVEL*BLANK    WUXECD 20
      * Define work field USR Select/Omit Flag
     C                     MOVEL*BLANK    WUCYST  1
      * Define work field USR Detail or Summary
     C                     MOVEL*BLANK    WUSTST  1
      * Define work field AUTO PRINT PRELIM PICK
     C                     MOVEL*BLANK    WUCLST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field System Value Numeric
     C                     Z-ADD*ZERO     WUM8NB 155
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Deadline Departure Date
     C                     Z-ADD*ZERO     WUKZDT  70
      * Define work field Deadline Departure Time
     C                     Z-ADD*ZERO     WUAXTM  60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  3
     C                     MOVEL*BLANK    WL0012  1
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014  1
      * Define local variables for subroutine SMCHRC.
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  3
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0021 10
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023 10
     C                     MOVEL*BLANK    WL0024  3
     C                     Z-ADD*ZERO     WL0025  30
     C                     MOVEL*BLANK    WL0026 10
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0027 10
     C                     MOVEL*BLANK    WL0028  6
     C                     Z-ADD*ZERO     WL0029  30
     C                     MOVEL*BLANK    WL0030  3
      * Define local variables for subroutine SRRVGN.
     C                     MOVEL*BLANK    WL0031  3
     C                     Z-ADD*ZERO     WL0032  30
      * Define local variables for subroutine TFRVGN.
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  50
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  50
      * Define local variables for subroutine TTRVGN.
     C                     Z-ADD*ZERO     WL0037  30
     C                     MOVEL*BLANK    WL0038  6
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040  1
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0001  3
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Load Acceptance Flag
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Deadline Departure Date
     C                     Z-ADD*ZERO     YN0003  70
      * Define null work field Deadline Departure Time
     C                     Z-ADD*ZERO     YN0004  60
      * Define local work field Parent Customer
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Credit Check AR Customer
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Credit Check Parent Cust
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field AR Credit Limit
     C                     Z-ADD*ZERO     YL0005 112
      * Define local work field Parent Credit Limit
     C                     Z-ADD*ZERO     YL0006 112
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0005  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0009  30
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0010  2
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0006  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0012  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0015  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0007 10
      * Define local work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0020 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0021 12
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0022  6
      * Define local work field Department Control Code
     C                     MOVEL*BLANK    YL0023  3
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0024  70
      * Define local work field *Date1 (ending)
     C                     Z-ADD*ZERO     YL0025  70
      * Define local work field User Id
     C                     MOVEL*BLANK    YL0026 10
      * Define local work field @Change Type 2
     C                     MOVEL*BLANK    YL0027  6
      * Define local work field MG Created Load
     C                     MOVEL*BLANK    YL0028  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0008  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0029  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0030  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD07        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0779 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0779           User Profile Na
      *
     C                     MOVEL*BLANK    WN0780 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0779    WL0021    P      User Profile Na
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    P1I6ST    P      Allow Multi_Com
     C                     MOVELWL0023    P1MPNA    P      Default Printer
     C                     MOVELWL0024    P1BCCD    P      Salesperson Cod
     C                     Z-ADDWL0025    YL0029           Company Number
     C                     MOVELWL0026    WN0780    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0779    ZA0047           User Profile Na
     C                     MOVEL'OMS'     ZA0048           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0780    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0779    WL0027    P      User Profile Na
     C                     MOVEL'OMS'     WL0028    P      Application Cod
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    P1AIC3           Company Number
     C                     MOVELWL0030    YL0030    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0780    WL0027    P      User Profile Na
     C                     MOVEL'OMS'     WL0028    P      Application Cod
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    P1AIC3           Company Number
     C                     MOVELWL0030    YL0030    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0030    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0779    ZA0049           User Profile Na
     C                     MOVEL'OMS'     ZA0050           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0029    IFNE 0                          *IF
     C                     Z-ADDYL0029    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0030    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0085  3        Warehouse Code
     C                     PARM YL0029    WQ0086  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR NBRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       P1TAST           First Time Flag
      * RTV Hold Authorities   RT - User Profile Control  * 
     C                     EXSR NDRVGN
     C                     MOVEL'N'       P6E6ST           USR Status (Y/N
     C                     Z-ADD999999    W0SLM            *Scan limit
      * ***** Change log and comments
     C                     EXSR UGSUBR                     ***** Change lo
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01026020520206002065020700207402082
02086020950211102124021370214602155
02158021610216402393025620256402572
02577025820258602594025980260602622
02635026490265802667026700267302676
0285402905
** W0END
01155020580206202067020720208002084
02092021090212202135021440215302155
02158021610217502400025620257002574
02579025840259202596026040262002633
02646026560266502667026700267302687
0288302912
** W0NAM
#2ST1     V2C4NB    V2AIC3    #2R4CD    #CAJCD    #2RMNB    #CH8AA
V2B0C7    #2BCNA    #CYWVA    #CASVA    V2CXDT    V2AODT    #2XIST
#2XJST    #CPKST    #2JZVA    #2BQTM    #1SEL     V1C4NB    V1AIC3
#1R4CD    #RAJCD    #1RMNB    #RH8AA    V1B0C7    #1BCNA    #RYWVA
#RASVA    V1A0DT    V1AODT    #RXOST    #1XJST    #RPKST    #1JZVA
#RAYTX    #1BQTM
** @CN
00001 USR0752
00002 Cred  Hold
00003 Y2U0005
00004 PDIZPCLP
00005 Auto Print Prelim. Pick
00006 PDSNPFR
00007 Y2U0003
