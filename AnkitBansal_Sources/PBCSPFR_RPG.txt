     H/TITLE Prt Exp Bkg rpt & dwnldPF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 10/06/20  Time  : 13:48:41
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL4IF  E           K        DISK
      * RSQ : Load Header               RSQ SchShp/Carrier
      *
     FPOC5REL0IF  E           K        DISK
      * RTV : Broker                    Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FCAAJREL1IF  E           K        DISK
      * RTV : Type Codes                Retrieval index       NV
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOPBGWKL6IF  E           K        DISK
      * RSQ : Order Detail              Co/Order/Item
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPDMRREL1IF  E           K        DISK
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FPMAMREL2IF  E           K        DISK
      * RSQ : Order Header Extension    Load ID/Order#/Co#
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPHDIF  E           K        DISK
      * RSQ : Order Header TRG          ARCust/Load/Order
      *
     FPMAMRELBIF  E           K        DISK
      * RSQ : Order Header Extension    Load ID/LdHaulTyp
      *
     FOMHOREL2IF  E           K        DISK
      * RSQ : Customer Accrual          RSQ Accrual
      *
     FOPBFCPNLIF  E           K        DISK
      * RSQ : Order Header TRG          Load ID/Ship To/Order
      *
     FCAEOREL5IF  E           K        DISK
      * RSQ : Company Customer          Customer
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FPNGYCPL0IF  E           K        DISK                      A
      * UPD : WF OHE & Load Rpt Info    Update index
      *
     FPBCSPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Exp Bkg rpt & dwnldPF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L7         7  1
     E                    #L3         3  1
      * Long constants
     E                    @CN#    1  08  6   @CN    25
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@AMREJM
      * Order Header Extension    Load ID/Order#/Co#
      * Renamed input format fields
     I              AMAIC3                          WCAIC3
     I              AMC4NB                          WCC4NB
     I              AMRMNB                          WCRMNB
     I              AMRUNB                          WCRUNB
     I              AMXACD                          WCXACD
     I              AMOANA                          WCOANA
     I              AMHBAA                          WCHBAA
     I              AMJ0T1                          WCJ0T1
     I              AMGENY                          WCGENY
     I              AMJ1T1                          WCJ1T1
     I              AMHCAA                          WCHCAA
     I              AMQWDT                          WCQWDT
     I              AMQXDT                          WCQXDT
     I              AMQYDT                          WCQYDT
     I              AMHDAA                          WCHDAA
     I              AMCCTX                          WCCCTX
     I              AMJ2T1                          WCJ2T1
     I              AMRLNA                          WCRLNA
     I              AMRMNA                          WCRMNA
     I              AMGINY                          WCGINY
     I              AMGFNY                          WCGFNY
     I              AMGGNY                          WCGGNY
     I              AMGHNY                          WCGHNY
     I              AMHEVL                          WCHEVL
     I              AMHFVL                          WCHFVL
     I              AMHGVL                          WCHGVL
     I              AMQZDT                          WCQZDT
     I              AMQ0DT                          WCQ0DT
     I              AMQ1DT                          WCQ1DT
     I              AMQ2DT                          WCQ2DT
     I              AMC2TX                          WCC2TX
     I              AMC3TX                          WCC3TX
     I              AMC6TX                          WCC6TX
     I              AMCHTX                          WCCHTX
     I              AMCITX                          WCCITX
     I              AMCLTX                          WCCLTX
     I              AMB4TX                          WCB4TX
     I              AMCUTX                          WCCUTX
     I              AMCVTX                          WCCVTX
     I              AMB9TX                          WCB9TX
     I              AMJWSC                          WCJWSC
     I              AMITNY                          WCITNY
     I              AMLMT1                          WCLMT1
     I              AMLWAA                          WCLWAA
     I              AMFVST                          WCFVST
     I              AMF0ST                          WCF0ST
     I              AMF2ST                          WCF2ST
     I              AMF3ST                          WCF3ST
     I              AMJUSC                          WCJUSC
     I              AMJVSC                          WCJVSC
     I              AMV3T1                          WCV3T1
     I              AMV4T1                          WCV4T1
     I              AMV5T1                          WCV5T1
     I              AMV6T1                          WCV6T1
     I              AMV7T1                          WCV7T1
     I              AMV8T1                          WCV8T1
     I              AMV9T1                          WCV9T1
     I              AMWAT1                          WCWAT1
     I              AMWBT1                          WCWBT1
     I              AMWCT1                          WCWCT1
     I              AMWDT1                          WCWDT1
     I              AMQJNY                          WCQJNY
     I              AMQKNY                          WCQKNY
     I              AMQLNY                          WCQLNY
     I              AMP8NY                          WCP8NY
     I              AMP9NY                          WCP9NY
     I              AMQANY                          WCQANY
     I              AMQCNY                          WCQCNY
     I              AMQDNY                          WCQDNY
     I              AMQENY                          WCQENY
     I              AMQFNY                          WCQFNY
     I              AMQGNY                          WCQGNY
     I              AMQHNY                          WCQHNY
     I              AMQINY                          WCQINY
     I              AMQMNY                          WCQMNY
     I              AMMYU1                          WCMYU1
     I              AMJXSC                          WCJXSC
     I              AMJYSC                          WCJYSC
     I              AMJZSC                          WCJZSC
     I              AMJ0SC                          WCJ0SC
     I              AMMZU1                          WCMZU1
     I              AMM0U1                          WCM0U1
     I              AMM1U1                          WCM1U1
     I              AMM2U1                          WCM2U1
     I              AMM3U1                          WCM3U1
     I              AMW5DT                          WCW5DT
     I              AMW6DT                          WCW6DT
     I              AMUVST                          WCUVST
     I              AMUWST                          WCUWST
     I              AMUXST                          WCUXST
     I              AMVSST                          WCVSST
     I              AMAATM                          WCAATM
     I              AMAYNA                          WCAYNA
     I              AMA0NA                          WCA0NA
     I              AMAXDT                          WCAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@BFCPQI
      * Order Header TRG          ARCust/Load/Order
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@AMREJI
      * Order Header Extension    Load ID/LdHaulTyp
      * Renamed input format fields
     I              AMAIC3                          WGAIC3
     I              AMC4NB                          WGC4NB
     I              AMRMNB                          WGRMNB
     I              AMRUNB                          WGRUNB
     I              AMXACD                          WGXACD
     I              AMOANA                          WGOANA
     I              AMHBAA                          WGHBAA
     I              AMJ0T1                          WGJ0T1
     I              AMGENY                          WGGENY
     I              AMJ1T1                          WGJ1T1
     I              AMHCAA                          WGHCAA
     I              AMQWDT                          WGQWDT
     I              AMQXDT                          WGQXDT
     I              AMQYDT                          WGQYDT
     I              AMHDAA                          WGHDAA
     I              AMCCTX                          WGCCTX
     I              AMJ2T1                          WGJ2T1
     I              AMRLNA                          WGRLNA
     I              AMRMNA                          WGRMNA
     I              AMGINY                          WGGINY
     I              AMGFNY                          WGGFNY
     I              AMGGNY                          WGGGNY
     I              AMGHNY                          WGGHNY
     I              AMHEVL                          WGHEVL
     I              AMHFVL                          WGHFVL
     I              AMHGVL                          WGHGVL
     I              AMQZDT                          WGQZDT
     I              AMQ0DT                          WGQ0DT
     I              AMQ1DT                          WGQ1DT
     I              AMQ2DT                          WGQ2DT
     I              AMC2TX                          WGC2TX
     I              AMC3TX                          WGC3TX
     I              AMC6TX                          WGC6TX
     I              AMCHTX                          WGCHTX
     I              AMCITX                          WGCITX
     I              AMCLTX                          WGCLTX
     I              AMB4TX                          WGB4TX
     I              AMCUTX                          WGCUTX
     I              AMCVTX                          WGCVTX
     I              AMB9TX                          WGB9TX
     I              AMJWSC                          WGJWSC
     I              AMITNY                          WGITNY
     I              AMLMT1                          WGLMT1
     I              AMLWAA                          WGLWAA
     I              AMFVST                          WGFVST
     I              AMF0ST                          WGF0ST
     I              AMF2ST                          WGF2ST
     I              AMF3ST                          WGF3ST
     I              AMJUSC                          WGJUSC
     I              AMJVSC                          WGJVSC
     I              AMV3T1                          WGV3T1
     I              AMV4T1                          WGV4T1
     I              AMV5T1                          WGV5T1
     I              AMV6T1                          WGV6T1
     I              AMV7T1                          WGV7T1
     I              AMV8T1                          WGV8T1
     I              AMV9T1                          WGV9T1
     I              AMWAT1                          WGWAT1
     I              AMWBT1                          WGWBT1
     I              AMWCT1                          WGWCT1
     I              AMWDT1                          WGWDT1
     I              AMQJNY                          WGQJNY
     I              AMQKNY                          WGQKNY
     I              AMQLNY                          WGQLNY
     I              AMP8NY                          WGP8NY
     I              AMP9NY                          WGP9NY
     I              AMQANY                          WGQANY
     I              AMQCNY                          WGQCNY
     I              AMQDNY                          WGQDNY
     I              AMQENY                          WGQENY
     I              AMQFNY                          WGQFNY
     I              AMQGNY                          WGQGNY
     I              AMQHNY                          WGQHNY
     I              AMQINY                          WGQINY
     I              AMQMNY                          WGQMNY
     I              AMMYU1                          WGMYU1
     I              AMJXSC                          WGJXSC
     I              AMJYSC                          WGJYSC
     I              AMJZSC                          WGJZSC
     I              AMJ0SC                          WGJ0SC
     I              AMMZU1                          WGMZU1
     I              AMM0U1                          WGM0U1
     I              AMM1U1                          WGM1U1
     I              AMM2U1                          WGM2U1
     I              AMM3U1                          WGM3U1
     I              AMW5DT                          WGW5DT
     I              AMW6DT                          WGW6DT
     I              AMUVST                          WGUVST
     I              AMUWST                          WGUWST
     I              AMUXST                          WGUXST
     I              AMVSST                          WGVSST
     I              AMAATM                          WGAATM
     I              AMAYNA                          WGAYNA
     I              AMA0NA                          WGA0NA
     I              AMAXDT                          WGAXDT
      *
     I@BFCPR4
      * Order Header TRG          Load ID/Ship To/Order
      * Renamed input format fields
     I              BEAIC3                          WHAIC3
     I              BEC4NB                          WHC4NB
     I              BEJNCD                          WHJNCD
     I              BEANC7                          WHANC7
     I              BEBKC7                          WHBKC7
     I              BEBRTX                          WHBRTX
     I              BEHMNA                          WHHMNA
     I              BEHONA                          WHHONA
     I              BEHPNA                          WHHPNA
     I              BEHNNA                          WHHNNA
     I              BEDBCD                          WHDBCD
     I              BECKTX                          WHCKTX
     I              BEB0C7                          WHB0C7
     I              BEAETX                          WHAETX
     I              BEB1NA                          WHB1NA
     I              BEB3NA                          WHB3NA
     I              BEB4NA                          WHB4NA
     I              BEB2NA                          WHB2NA
     I              BEBHCD                          WHBHCD
     I              BEC8TX                          WHC8TX
     I              BEBCNA                          WHBCNA
     I              BEA0DT                          WHA0DT
     I              BEA5DT                          WHA5DT
     I              BEGNDT                          WHGNDT
     I              BEACDT                          WHACDT
     I              BEAQCD                          WHAQCD
     I              BEB6NA                          WHB6NA
     I              BEBYNA                          WHBYNA
     I              BEBZNA                          WHBZNA
     I              BEGTST                          WHGTST
     I              BEGVST                          WHGVST
     I              BEGUST                          WHGUST
     I              BEQFST                          WHQFST
     I              BECQCD                          WHCQCD
     I              BEGJST                          WHGJST
     I              BEGWST                          WHGWST
     I              BEGXST                          WHGXST
     I              BEGYST                          WHGYST
     I              BEAODT                          WHAODT
     I              BEAIVN                          WHAIVN
     I              BECXDT                          WHCXDT
     I              BEJZVA                          WHJZVA
     I              BEA1WG                          WHA1WG
     I              BEXIST                          WHXIST
     I              BEXJST                          WHXJST
     I              BEXKST                          WHXKST
     I              BEEIDT                          WHEIDT
     I              BEAFTM                          WHAFTM
     I              BEE8CD                          WHE8CD
     I              BEE9CD                          WHE9CD
     I              BERMNB                          WHRMNB
     I              BETBNB                          WHTBNB
     I              BER1NB                          WHR1NB
     I              BEPJST                          WHPJST
     I              BEU0ST                          WHU0ST
     I              BEU1ST                          WHU1ST
     I              BEQ2CD                          WHQ2CD
     I              BEU2ST                          WHU2ST
     I              BEVEST                          WHVEST
     I              BEVFST                          WHVFST
     I              BEVGST                          WHVGST
     I              BERPCD                          WHRPCD
     I              BERNNB                          WHRNNB
     I              BEVDST                          WHVDST
     I              BEATIN                          WHATIN
     I              BEU4ST                          WHU4ST
     I              BEU5ST                          WHU5ST
     I              BERSRN                          WHRSRN
     I              BEMHNA                          WHMHNA
     I              BEMINA                          WHMINA
     I              BEWBST                          WHWBST
     I              BER4CD                          WHR4CD
     I              BEBFCD                          WHBFCD
     I              BEQ4CD                          WHQ4CD
     I              BET3NB                          WHT3NB
     I              BESICD                          WHSICD
     I              BECONB                          WHCONB
     I              BECEST                          WHCEST
     I              BEAWDT                          WHAWDT
     I              BEJPCD                          WHJPCD
     I              BEXUST                          WHXUST
     I              BEZ1ST                          WHZ1ST
     I              BEVRVA                          WHVRVA
     I              BEOBST                          WHOBST
     I              BEBCST                          WHBCST
     I              BEBDST                          WHBDST
     I              BEB7VL                          WHB7VL
     I              BEGASX                          WHGASX
     I              BEGBSX                          WHGBSX
     I              BEGCSX                          WHGCSX
     I              BEGDSX                          WHGDSX
     I              BEFNSX                          WHFNSX
     I              BEFOSX                          WHFOSX
     I              BEFPSX                          WHFPSX
     I              BEFQSX                          WHFQSX
     I              BEFRSX                          WHFRSX
     I              BEFSSX                          WHFSSX
     I              BEFTSX                          WHFTSX
     I              BEFUSX                          WHFUSX
     I              BEFVSX                          WHFVSX
     I              BEFWSX                          WHFWSX
     I              BEFXSX                          WHFXSX
     I              BEFYSX                          WHFYSX
     I              BENODT                          WHNODT
     I              BENPDT                          WHNPDT
     I              BENQDT                          WHNQDT
     I              BENRDT                          WHNRDT
     I              BENSDT                          WHNSDT
     I              BEBPTM                          WHBPTM
     I              BEBQTM                          WHBQTM
     I              BEBRTM                          WHBRTM
     I              BEBSTM                          WHBSTM
     I              BEBTTM                          WHBTTM
     I              BEH0NX                          WHH0NX
     I              BEH1NX                          WHH1NX
     I              BEH2NX                          WHH2NX
     I              BEH3NX                          WHH3NX
     I              BEH4NX                          WHH4NX
     I              BEC0C7                          WHC0C7
     I              BEUVST                          WHUVST
     I              BEUWST                          WHUWST
     I              BEUXST                          WHUXST
     I              BEAATM                          WHAATM
     I              BEAYNA                          WHAYNA
     I              BEA0NA                          WHA0NA
     I              BEAXDT                          WHAXDT
      *
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPNGY1    E DSPNGYCPL0
      * UPD : WF OHE & Load Rpt Info    Update index
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I : POS Load ID
     I                                    P   1   40P1RMNB
      * I :  Company Number
     I                                    P   5   60P1AIC3
      * I :  Scheduled Ship Date
     I                                    P   7  100P1AODT
      * N :  Carrier Code
     I                                       11  13 P1BZNA
     IP2PARM      DS
      * FLD: *Arrays
      * I :  OHE Booking Number
     I                                        1  15 P2J1T1
      * I :  Scheduled Ship Date USR
     I                                    P  16  190P2HODT
      * I :  Ship to Customer Pass USR
     I                                    P  20  275P2SHTC
     IP3PARM      DS
      * FLD: Order Header TRG
      * N :  Ship To Customer
     I                                    P   1   40P3BKC7
     IP4PARM      DS
      * FLD: *Arrays
      * I :  Country Code 1 usr
     I                                        1   6 P4KIAA
      * I :  Country Code 2 usr
     I                                        7  12 P4KJAA
      * I :  Country Code 3 usr
     I                                       13  18 P4KKAA
      * I :  Country Code 4 usr
     I                                       19  24 P4KLAA
      * I :  Country Code 5 usr
     I                                       25  30 P4KMAA
      * I :  Country Code 6 usr
     I                                       31  36 P4KNAA
      * I :  Country Code 7 usr
     I                                       37  42 P4NHAA
      * I :  Country Code 8 usr
     I                                       43  48 P4NIAA
      * I :  Country Code 9 usr
     I                                       49  54 P4NJAA
      * I :  Country Code 10 usr
     I                                       55  60 P4NKAA
     IP5PARM      DS
      * I :  Broker Code
     I                                        1   6 P5HHAA
     IP6PARM      DS
      * FLD: *Arrays
      * I :  Trans Type 1 PASS     USR
     I                                        1   2 P6ZSST
      * I :  Trans Type 2 PASS     USR
     I                                        3   4 P6ZTST
      * I :  Reason Code 1 PASS    USR
     I                                        5   7 P6T4CD
      * I :  USR Include all Products
     I                                        8   8 P6JIST
      * I :  Status - Y or N
     I                                        9   9 P6B8ST
      * I :  USR Confirm Status (Y/N)
     I                                       10  10 P6SBST
     IP7PARM      DS
      * FLD: *Arrays
      * I :  Carrier Code Usr 1
     I                                        1   3 P7NLAA
      * I :  Carrier Code Usr 2
     I                                        4   6 P7NMAA
      * I :  Carrier Code Usr 3
     I                                        7   9 P7NNAA
      * I :  Carrier Code Usr 4
     I                                       10  12 P7NOAA
      * I :  Carrier Code Usr 5
     I                                       13  15 P7NPAA
      * I :  Carrier Code Usr 6
     I                                       16  18 P7NQAA
      * I :  Carrier Code Usr 7
     I                                       19  21 P7NRAA
      * I :  Carrier Code Usr 8
     I                                       22  24 P7NSAA
      * I :  Carrier Code Usr 9
     I                                       25  27 P7NTAA
      * I :  Carrier Code Usr 10
     I                                       28  30 P7NUAA
      * I :  Carrier Code Usr 11
     I                                       31  33 P7N0AA
      * I :  Carrier Code Usr 12
     I                                       34  36 P7NWAA
      * I :  Carrier Code Usr 13
     I                                       37  39 P7NXAA
      * I :  Carrier Code Usr 14
     I                                       40  42 P7NYAA
      * I :  Carrier Code Usr 15
     I                                       43  45 P7NZAA
     IP8PARM      DS
      * FLD: *Arrays
      * I :  USR Warehouse Code
     I                                        1   3 P8CPCD
      * I :  USR CDE Parm 1
     I                                        4   6 P8VSCD
      * I :  USR CDE Parm 2
     I                                        7   9 P8VTCD
      * I :  USR CDE Parm 3
     I                                       10  12 P8VUCD
      * I :  USR CDE Parm 4
     I                                       13  15 P8VVCD
      * I :  USR CDE Parm 5
     I                                       16  18 P8VWCD
      * I :  USR CDE Parm 6
     I                                       19  21 P8VXCD
      * I :  USR CDE Parm 7
     I                                       22  24 P8VYCD
      * I :  USR CDE Parm 8
     I                                       25  27 P8VZCD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1AODT    PARM           WP0003  70       Scheduled Ship
     C           P2J1T1    PARM           WP0004 15        OHE Booking Num
     C           P2HODT    PARM           WP0005  70       Scheduled Ship
     C           P2SHTC    PARM           WP0006 155       Ship to Custome
     C           P4KIAA    PARM           WP0007  6        Country Code 1
     C           P4KJAA    PARM           WP0008  6        Country Code 2
     C           P4KKAA    PARM           WP0009  6        Country Code 3
     C           P4KLAA    PARM           WP0010  6        Country Code 4
     C           P4KMAA    PARM           WP0011  6        Country Code 5
     C           P4KNAA    PARM           WP0012  6        Country Code 6
     C           P4NHAA    PARM           WP0013  6        Country Code 7
     C           P4NIAA    PARM           WP0014  6        Country Code 8
     C           P4NJAA    PARM           WP0015  6        Country Code 9
     C           P4NKAA    PARM           WP0016  6        Country Code 10
     C           P5HHAA    PARM           WP0017  6        Broker Code
     C           P6ZSST    PARM           WP0018  2        Trans Type 1 PA
     C           P6ZTST    PARM           WP0019  2        Trans Type 2 PA
     C           P6T4CD    PARM           WP0020  3        Reason Code 1 P
     C           P6JIST    PARM           WP0021  1        USR Include all
     C           P6B8ST    PARM           WP0022  1        Status - Y or N
     C           P6SBST    PARM           WP0023  1        USR Confirm Sta
     C           P7NLAA    PARM           WP0024  3        Carrier Code Us
     C           P7NMAA    PARM           WP0025  3        Carrier Code Us
     C           P7NNAA    PARM           WP0026  3        Carrier Code Us
     C           P7NOAA    PARM           WP0027  3        Carrier Code Us
     C           P7NPAA    PARM           WP0028  3        Carrier Code Us
     C           P7NQAA    PARM           WP0029  3        Carrier Code Us
     C           P7NRAA    PARM           WP0030  3        Carrier Code Us
     C           P7NSAA    PARM           WP0031  3        Carrier Code Us
     C           P7NTAA    PARM           WP0032  3        Carrier Code Us
     C           P7NUAA    PARM           WP0033  3        Carrier Code Us
     C           P7N0AA    PARM           WP0034  3        Carrier Code Us
     C           P7NWAA    PARM           WP0035  3        Carrier Code Us
     C           P7NXAA    PARM           WP0036  3        Carrier Code Us
     C           P7NYAA    PARM           WP0037  3        Carrier Code Us
     C           P7NZAA    PARM           WP0038  3        Carrier Code Us
     C           P8CPCD    PARM           WP0039  3        USR Warehouse C
     C           P8VSCD    PARM           WP0040  3        USR CDE Parm 1
     C           P8VTCD    PARM           WP0041  3        USR CDE Parm 2
     C           P8VUCD    PARM           WP0042  3        USR CDE Parm 3
     C           P8VVCD    PARM           WP0043  3        USR CDE Parm 4
     C           P8VWCD    PARM           WP0044  3        USR CDE Parm 5
     C           P8VXCD    PARM           WP0045  3        USR CDE Parm 6
     C           P8VYCD    PARM           WP0046  3        USR CDE Parm 7
     C           P8VZCD    PARM           WP0047  3        USR CDE Parm 8
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Exp Bkg rpt & dwnldPF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$JENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Exp Bkg rpt & dwnldPF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@FJCPL9                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Scheduled Ship
     C                     MOVEL'Y'       W0AL01  1        Carrier Code
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $IMCNB           Number of Order
     C                     Z-ADD*ZERO     $IJGNB           USR number
     C                     Z-ADD*ZERO     $IWQNB           USR Counter
     C                     Z-ADD*ZERO     $ICPPC           USR Percent Wor
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDFJAIC3    $CAIC3           Company Number
     C                     Z-ADDFJAODT    $CAODT           Scheduled Ship
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDFJAIC3    $DAIC3           Company Number
     C                     Z-ADDFJAODT    $DAODT           Scheduled Ship
     C                     MOVELFJBZNA    $DBZNA           Carrier Code
     C                     MOVEL*BLANK    $DADTX           Name
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDFJRMNB    $ERMNB           Load ID
     C                     Z-ADDFJAIC3    $EAIC3           Company Number
     C                     MOVELFJVPCD    $EVPCD           Ship From Wareh
     C                     MOVEL*BLANK    $EY8TX           Text USR 7
     C                     MOVEL*BLANK    $EKTNA           USR Customer Na
     C                     MOVEL*BLANK    $EBRTX           Ship To Name
     C                     Z-ADD*ZERO     $EC4NB           Order Number
     C                     MOVEL*BLANK    $EGVTX           USR Carrier Nam
     C                     Z-ADDFJAODT    $EAODT           Scheduled Ship
     C                     MOVELFJPJST    $EPJST           LTL Flag
     C                     MOVELFJPKST    $EPKST           Load Status
     C                     Z-ADDFJRNNB    $ERNNB           Reefer Temperat
     C                     MOVELFJDMTX    $EDMTX           Seal 1
     C                     MOVELFJDNTX    $EDNTX           Seal 2
     C                     MOVELFJDOTX    $EDOTX           Seal 3
     C                     MOVELFJWTTX    $EWTTX           Seal 4
     C                     MOVELFJWUTX    $EWUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    $ERPNB           Total Load Orde
     C                     Z-ADDFJFLAM    $EFLAM           Flat Amount
     C                     MOVELFJXQST    $EXQST           Allocate Pounds
     C                     Z-ADDFJRRNB    $ERRNB           Total Stops
     C                     MOVELFJDYTX    $EDYTX           Transloader Car
     C                     Z-ADDFJSBNB    $ESBNB           BOL Time
     C                     MOVELFJBZNA    $EBZNA           Carrier Code
     C                     MOVELFJRONB    $ERONB           Truck Size
     C                     Z-ADDFJSQNB    $ESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    $ER1NB           Rated Freight
     C                     MOVELFJVCST    $EVCST           Ship Status
     C                     MOVELFJVDST    $EVDST           Load Type
     C                     Z-ADDFJSDNB    $ESDNB           Number Pallets
     C                     Z-ADDFJPAOU    $EPAOU           Number Pallets
     C                     Z-ADDFJDGWG    $EDGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    $ESXNB           Estimated Arriv
     C                     Z-ADDFJHADT    $EHADT           Actual Arrival
     C                     Z-ADDFJAART    $EAART           Actual Arrival
     C                     Z-ADDFJDHWG    $EDHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    $EDIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    $EAQDT           Actual Departur
     C                     Z-ADDFJS6NB    $ES6NB           Departure Time
     C                     Z-ADDFJPRTM    $EPRTM           Product Tempera
     C                     Z-ADDFJNPSV    $ENPSV           Number Spacers
     C                     MOVELFJJ8TX    $EJ8TX           Car/Veh. Initia
     C                     Z-ADDFJTLMI    $ETLMI           Total Load Mile
     C                     MOVELFJJ9TX    $EJ9TX           Recorder ID
     C                     MOVELFJQ2CD    $EQ2CD           Shipping Method
     C                     MOVELFJDBCD    $EDBCD           Ship To State C
     C                     Z-ADDFJGRWE    $EGRWE           Gross Weight
     C                     MOVELFJXCCD    $EXCCD           Carrier Broker
     C                     MOVELFJU2ST    $EU2ST           Export Status
     C                     Z-ADDFJF9DT    $EF9DT           Actual Ship Dat
     C                     MOVELFJONTM    $EONTM           On Time - (Y/N)
     C                     Z-ADDFJJ5DT    $EJ5DT           Spotted Date
     C                     Z-ADDFJSPTM    $ESPTM           Spotted Time
     C                     Z-ADDFJJ6DT    $EJ6DT           Load Finished D
     C                     Z-ADDFJLFTM    $ELFTM           Load Finished T
     C                     Z-ADDFJJ7DT    $EJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    $EBOTM           BOL Complete Ti
     C                     Z-ADDFJKIDT    $EKIDT           Truck Departure
     C                     Z-ADDFJASTM    $EASTM           Truck Departure
     C                     Z-ADDFJKADT    $EKADT           Adjusted Depart
     C                     Z-ADDFJAJCM    $EAJCM           Adjusted Depart
     C                     MOVELFJK4TX    $EK4TX           Vessel Name
     C                     Z-ADDFJVOAG    $EVOAG           Voyage
     C                     Z-ADDFJKBDT    $EKBDT           Sail Date
     C                     MOVELFJNBBO    $ENBBO           Booking Number
     C                     Z-ADDFJEFDT    $EEFDT           Arrival Date
     C                     MOVEL*BLANK    $ENLTX           USR 15 Text
     C                     MOVELFJOJTX    $EOJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    $ELLDT           Express Mail Da
     C                     MOVELFJXACD    $EXACD           Shipping Line
     C                     MOVELFJOANA    $EOANA           Port Delv Termi
     C                     MOVELFJW4CD    $EW4CD           Discharge Port
     C                     MOVEL*BLANK    $EOKTX           Port City
     C                     MOVELFJCNTN    $ECNTN           Container Numbe
     C                     MOVELFJOITX    $EOITX           Ocean BOL Numbe
     C                     Z-ADDFJOCFR    $EOCFR           Load Total Frei
     C                     Z-ADDFJKJDT    $EKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    $EATTM           Scheduled Deliv
     C                     MOVELFJOTRS    $EOTRS           LH Unused Sts
     C                     MOVELFJRNST    $ERNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    $EBRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    $EEIDT           Requested Deliv
     C                     MOVELFJRMST    $ERMST           Load Acceptance
     C                     MOVELFJAJCD    $EAJCD           Warehouse Code
     C                     Z-ADDFJKKDT    $EKKDT           On Yard Date
     C                     Z-ADDFJAVTM    $EAVTM           On Yard Time
     C                     Z-ADDFJKZDT    $EKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    $EAXTM           Deadline Depart
     C                     MOVELFJLHOS    $ELHOS           Load Held Over
     C                     MOVELFJLHOR    $ELHOR           Load Held Over
     C                     MOVELFJWNTX    $EWNTX           Load Held Over
     C                     MOVELFJLSHG    $ELSHG           Load Shag Flag
     C                     MOVELFJYPST    $EYPST           Load Wash Flag
     C                     Z-ADDFJK0DT    $EK0DT           Product Complet
     C                     Z-ADDFJAYTM    $EAYTM           Product Complet
     C                     Z-ADDFJKNNX    $EKNNX           Pallets Loaded
     C                     Z-ADDFJICWG    $EICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    $EIDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    $EH9SX           Load Confirmed
     C                     MOVELFJWOTX    $EWOTX           Load Confirmed
     C                     Z-ADDFJK1DT    $EK1DT           Load Confirmati
     C                     Z-ADDFJAZTM    $EAZTM           Load Door 1
     C                     Z-ADDFJK2DT    $EK2DT           Override Total
     C                     Z-ADDFJA0TM    $EA0TM           Load Door 2
     C                     MOVELFJROST    $EROST           Partial Load
     C                     MOVELFJRPST    $ERPST           Load Confirmati
     C                     MOVELFJRQST    $ERQST           Export Load USD
     C                     MOVELFJRRST    $ERRST           Late Delivery E
     C                     Z-ADDFJZBVA    $EZBVA           Load Actual Fre
     C                     MOVELFJWPTX    $EWPTX           Hide on WW Load
     C                     MOVELFJWQTX    $EWQTX           Late Billing Em
     C                     MOVELFJWRTX    $EWRTX           Shipping Temp C
     C                     MOVELFJWSTX    $EWSTX           LH Held Over Rs
     C                     MOVELFJRVSX    $ERVSX           Multi Company L
     C                     MOVELFJRUSX    $ERUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    $ERWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    $ERXSX           LH Power Only L
     C                     MOVELFJRYSX    $ERYSX           MG Created Load
     C                     MOVELFJRZSX    $ERZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    $ER0SX           Load U/M
     C                     MOVELFJR1SX    $ER1SX           TPM Shipment St
     C                     MOVELFJR2SX    $ER2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    $ER3SX           LH On-Time Reas
     C                     MOVELFJR4SX    $ER4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    $EPYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    $ECKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    $EPZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    $ECLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    $EP0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    $ECMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    $EP1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    $ECNTM           LH Unused Time
     C                     Z-ADDFJP2DT    $EP2DT           LH Unused Date
     C                     Z-ADDFJCOTM    $ECOTM           LH Unused Time
     C                     Z-ADDFJP3DT    $EP3DT           LH Unused Date
     C                     Z-ADDFJCQTM    $ECQTM           LH Unused Time
     C                     MOVELFJUVST    $EUVST           EDI Status 1
     C                     MOVELFJUXST    $EUXST           EDI Status 3
     C                     Z-ADDFJAATM    $EAATM           Job Time
     C                     MOVELFJAYNA    $EAYNA           User Id
     C                     MOVELFJA0NA    $EA0NA           Job Name
     C                     Z-ADDFJAXDT    $EAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Crt LdOrdDt Wts/WF PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FJAODT    WZA001           Scheduled Ship
     C                     Z-ADDFJAODT    WZA001
     C           *LIKE     DEFN FJBZNA    WZA002           Carrier Code
     C                     MOVELFJBZNA    WZA002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @FJCPL9                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Select only Export
      * CASE: DB1.Export Status is Not Yes
     C           FJU2ST    IFEQ *BLANK                     *IF
     C           FJU2ST    OREQ 'N'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select by Load Start Company
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Company Number is greater than zero
      *   |- c2    : PAR.Company Number NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AIC3    IFGT *ZERO                      *IF
     C           P1AIC3    IFNE FJAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select Carrier if at least one is entered
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10
      *   |- c1    : PAR.Carrier Code Usr 1 is Entered
      *   |- c2    : PAR.Carrier Code Usr 2 is Entered
      *   |- c3    : PAR.Carrier Code Usr 3 is Entered
      *   |- c4    : PAR.Carrier Code Usr 4 is Entered
      *   |- c5    : PAR.Carrier Code Usr 5 is Entered
      *   |- c6    : PAR.Carrier Code Usr 6 is Entered
      *   |- c7    : PAR.Carrier Code Usr 7 is Entered
      *   |- c8    : PAR.Carrier Code Usr 8 is Entered
      *   |- c9    : PAR.Carrier Code Usr 9 is Entered
      *   |- c10   : PAR.Carrier Code Usr 10 is Entered
      *   '-
     C           P7NLAA    IFNE *BLANK                     *IF
     C           P7NMAA    ORNE *BLANK                     *OR
     C           P7NNAA    ORNE *BLANK                     *OR
     C           P7NOAA    ORNE *BLANK                     *OR
     C           P7NPAA    ORNE *BLANK                     *OR
     C           P7NQAA    ORNE *BLANK                     *OR
     C           P7NRAA    ORNE *BLANK                     *OR
     C           P7NSAA    ORNE *BLANK                     *OR
     C           P7NTAA    ORNE *BLANK                     *OR
     C           P7NUAA    ORNE *BLANK                     *OR
     C                     MOVEL'N'       WUWXST           Record Found US
      * Test 1st Carrier code for match
      * CASE: PAR.Carrier Code Usr 1 EQ DB1.Carrier Code
     C           P7NLAA    IFEQ FJBZNA                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 2nd Carrier code for match
      * CASE: PAR.Carrier Code Usr 2 EQ DB1.Carrier Code
     C           P7NMAA    IFEQ FJBZNA                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 3rd Carrier code for match
      * CASE: PAR.Carrier Code Usr 3 EQ DB1.Carrier Code
     C           P7NNAA    IFEQ FJBZNA                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 4th Carrier code for match
      * CASE: PAR.Carrier Code Usr 4 EQ DB1.Carrier Code
     C           P7NOAA    IFEQ FJBZNA                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 5th Carrier code for match
      * CASE: PAR.Carrier Code Usr 5 EQ DB1.Carrier Code
     C           P7NPAA    IFEQ FJBZNA                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 6rd Carrier code for match
      * CASE: PAR.Carrier Code Usr 6 EQ DB1.Carrier Code
     C           P7NQAA    IFEQ FJBZNA                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 7th Carrier code for match
      * CASE: PAR.Carrier Code Usr 7 EQ DB1.Carrier Code
     C           P7NRAA    IFEQ FJBZNA                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 8th Carrier code for match
      * CASE: PAR.Carrier Code Usr 8 EQ DB1.Carrier Code
     C           P7NSAA    IFEQ FJBZNA                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 9th Carrier code for match
      * CASE: PAR.Carrier Code Usr 9 EQ DB1.Carrier Code
     C           P7NTAA    IFEQ FJBZNA                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 10th Carrier code for match
      * CASE: PAR.Carrier Code Usr 10 EQ DB1.Carrier Code
     C           P7NUAA    IFEQ FJBZNA                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * SEL: Entered Carrier if at least 1 match is found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select Ship Line if at least one is entered
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Carrier Code Usr 11 is Entered
      *   |- c2    : PAR.Carrier Code Usr 12 is Entered
      *   |- c3    : PAR.Carrier Code Usr 13 is Entered
      *   |- c4    : PAR.Carrier Code Usr 14 is Entered
      *   |- c5    : PAR.Carrier Code Usr 15 is Entered
      *   '-
     C           P7N0AA    IFNE *BLANK                     *IF
     C           P7NWAA    ORNE *BLANK                     *OR
     C           P7NXAA    ORNE *BLANK                     *OR
     C           P7NYAA    ORNE *BLANK                     *OR
     C           P7NZAA    ORNE *BLANK                     *OR
      * Unconditionally move "///" to wrk.ship line to confound tests
     C                     MOVEL'///'     WUXACD           Shipping Line
     C                     MOVEL'N'       WUWXST           Record Found US
      * RTV Shipping Line-OHE  RT - Order Header Extension  * 
     C                     EXSR SPRVGN
      * Test 1st Shipping Line for match
      * CASE: PAR.Carrier Code Usr 11 EQ WRK.Shipping Line
     C           P7N0AA    IFEQ WUXACD                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 2nd Shipping line for match
      * CASE: PAR.Carrier Code Usr 12 EQ WRK.Shipping Line
     C           P7NWAA    IFEQ WUXACD                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 3rd Shipping Line for match
      * CASE: PAR.Carrier Code Usr 13 EQ WRK.Shipping Line
     C           P7NXAA    IFEQ WUXACD                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 4th Shipping Line for match
      * CASE: PAR.Carrier Code Usr 14 EQ WRK.Shipping Line
     C           P7NYAA    IFEQ WUXACD                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Test 5th Shipping Line for match
      * CASE: PAR.Carrier Code Usr 15 EQ WRK.Shipping Line
     C           P7NZAA    IFEQ WUXACD                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
      * Skip records with no Shipping Line assigned
      * CASE: WRK.Shipping Line is not entered
     C           WUXACD    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWXST           Record Found US
     C                     END                             *FI
      * SEL: Entered Shipping Line if at least 1 match is found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select country if at least one is entered             E00281
      * CASE: PGM.*Record selected is Not *NO
     C           W0RSL     IFEQ 'Y'                        *IF
     C           W0RSL     OREQ *BLANK
      * ** Select country if at least one is entered          E00281
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10
      *   |- c1    : PAR.Country Code 1 usr is Entered
      *   |- c2    : PAR.Country Code 2 usr is Entered
      *   |- c3    : PAR.Country Code 3 usr is Entered
      *   |- c4    : PAR.Country Code 4 usr is Entered
      *   |- c5    : PAR.Country Code 5 usr is Entered
      *   |- c6    : PAR.Country Code 6 usr is Entered
      *   |- c7    : PAR.Country Code 7 usr is entered
      *   |- c8    : PAR.Country Code 8 usr is Entered
      *   |- c9    : PAR.Country Code 9 usr is Entered
      *   |- c10   : PAR.Country Code 10 usr is Entered
      *   '-
     C           P4KIAA    IFNE *BLANK                     *IF
     C           P4KJAA    ORNE *BLANK                     *OR
     C           P4KKAA    ORNE *BLANK                     *OR
     C           P4KLAA    ORNE *BLANK                     *OR
     C           P4KMAA    ORNE *BLANK                     *OR
     C           P4KNAA    ORNE *BLANK                     *OR
     C           P4NHAA    ORNE *BLANK                     *OR
     C           P4NIAA    ORNE *BLANK                     *OR
     C           P4NJAA    ORNE *BLANK                     *OR
     C           P4NKAA    ORNE *BLANK                     *OR
     C                     MOVEL'N'       WUWXST           Record Found US
     C                     MOVEL'N'       WU               Country Ord Fou
      * SEL: 1st Country Code, if entered
      * CASE: PAR.Country Code 1 usr is Entered
     C           P4KIAA    IFNE *BLANK                     *IF
      * RTV Order for Cntry   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0042           Load ID
     C                     MOVELP4KIAA    WL0043    P      Country Code
     C                     MOVELWU        WL0044    P      Country Ord Fou
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WU        P      Country Ord Fou
      * CASE: WRK.Country Ord Found Sts USR is yes
     C           WU        IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
      * Test 2nd country code if no record for 1st country code
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Blanks
      *   |- c2    : WRK.Record Found USR is Record Not Found
      *   '-
     C           WUWXST    IFEQ *BLANK                     *IF
     C           WUWXST    OREQ 'N'                        *OR
      * SEL: 2nd Country Code, if entered
      * CASE: PAR.Country Code 2 usr is Entered
     C           P4KJAA    IFNE *BLANK                     *IF
      * RTV Order for Cntry   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0042           Load ID
     C                     MOVELP4KJAA    WL0043    P      Country Code
     C                     MOVELWU        WL0044    P      Country Ord Fou
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WU        P      Country Ord Fou
      * CASE: WRK.Country Ord Found Sts USR is yes
     C           WU        IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test 3rd country code if record found is blanks
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Blanks
      *   |- c2    : WRK.Record Found USR is Record Not Found
      *   '-
     C           WUWXST    IFEQ *BLANK                     *IF
     C           WUWXST    OREQ 'N'                        *OR
      * SEL: 3rd Country Code, if entered
      * CASE: PAR.Country Code 3 usr is Entered
     C           P4KKAA    IFNE *BLANK                     *IF
      * RTV Order for Cntry   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0042           Load ID
     C                     MOVELP4KKAA    WL0043    P      Country Code
     C                     MOVELWU        WL0044    P      Country Ord Fou
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WU        P      Country Ord Fou
      * CASE: WRK.Country Ord Found Sts USR is yes
     C           WU        IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test 4th country code if record found is blanks
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Blanks
      *   |- c2    : WRK.Record Found USR is Record Not Found
      *   '-
     C           WUWXST    IFEQ *BLANK                     *IF
     C           WUWXST    OREQ 'N'                        *OR
      * SEL: 4th Country Code, if entered
      * CASE: PAR.Country Code 4 usr is Entered
     C           P4KLAA    IFNE *BLANK                     *IF
      * RTV Order for Cntry   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0042           Load ID
     C                     MOVELP4KLAA    WL0043    P      Country Code
     C                     MOVELWU        WL0044    P      Country Ord Fou
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WU        P      Country Ord Fou
      * CASE: WRK.Country Ord Found Sts USR is yes
     C           WU        IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test 5th country code if record found is blanks
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Blanks
      *   |- c2    : WRK.Record Found USR is Record Not Found
      *   '-
     C           WUWXST    IFEQ *BLANK                     *IF
     C           WUWXST    OREQ 'N'                        *OR
      * SEL: 5th Country Code, if entered
      * CASE: PAR.Country Code 5 usr is Entered
     C           P4KMAA    IFNE *BLANK                     *IF
      * RTV Order for Cntry   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0042           Load ID
     C                     MOVELP4KMAA    WL0043    P      Country Code
     C                     MOVELWU        WL0044    P      Country Ord Fou
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WU        P      Country Ord Fou
      * CASE: WRK.Country Ord Found Sts USR is yes
     C           WU        IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test 6th country code if record found is blanks
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Blanks
      *   |- c2    : WRK.Record Found USR is Record Not Found
      *   '-
     C           WUWXST    IFEQ *BLANK                     *IF
     C           WUWXST    OREQ 'N'                        *OR
      * CASE: PAR.Country Code 6 usr is Entered
     C           P4KNAA    IFNE *BLANK                     *IF
      * RTV Order for Cntry   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0042           Load ID
     C                     MOVELP4KNAA    WL0043    P      Country Code
     C                     MOVELWU        WL0044    P      Country Ord Fou
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WU        P      Country Ord Fou
      * CASE: WRK.Country Ord Found Sts USR is yes
     C           WU        IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test 7th country code if record found is blanks
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Blanks
      *   |- c2    : WRK.Record Found USR is Record Not Found
      *   '-
     C           WUWXST    IFEQ *BLANK                     *IF
     C           WUWXST    OREQ 'N'                        *OR
      * CASE: PAR.Country Code 7 usr is entered
     C           P4NHAA    IFNE *BLANK                     *IF
      * RTV Order for Cntry   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0042           Load ID
     C                     MOVELP4NHAA    WL0043    P      Country Code
     C                     MOVELWU        WL0044    P      Country Ord Fou
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WU        P      Country Ord Fou
      * CASE: WRK.Country Ord Found Sts USR is yes
     C           WU        IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test 8th country code if record found is blanks
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Blanks
      *   |- c2    : WRK.Record Found USR is Record Not Found
      *   '-
     C           WUWXST    IFEQ *BLANK                     *IF
     C           WUWXST    OREQ 'N'                        *OR
      * CASE: PAR.Country Code 8 usr is Entered
     C           P4NIAA    IFNE *BLANK                     *IF
      * RTV Order for Cntry   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0042           Load ID
     C                     MOVELP4KLAA    WL0043    P      Country Code
     C                     MOVELWU        WL0044    P      Country Ord Fou
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WU        P      Country Ord Fou
      * CASE: WRK.Country Ord Found Sts USR is yes
     C           WU        IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test 9th country code if record found is blanks
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Blanks
      *   |- c2    : WRK.Record Found USR is Record Not Found
      *   '-
     C           WUWXST    IFEQ *BLANK                     *IF
     C           WUWXST    OREQ 'N'                        *OR
      * CASE: PAR.Country Code 9 usr is Entered
     C           P4NJAA    IFNE *BLANK                     *IF
      * RTV Order for Cntry   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0042           Load ID
     C                     MOVELP4NJAA    WL0043    P      Country Code
     C                     MOVELWU        WL0044    P      Country Ord Fou
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WU        P      Country Ord Fou
      * CASE: WRK.Country Ord Found Sts USR is yes
     C           WU        IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test 10th country code if no record for 1st country code
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Blanks
      *   |- c2    : WRK.Record Found USR is Record Not Found
      *   '-
     C           WUWXST    IFEQ *BLANK                     *IF
     C           WUWXST    OREQ 'N'                        *OR
      * CASE: PAR.Country Code 10 usr is Entered
     C           P4NKAA    IFNE *BLANK                     *IF
      * RTV Order for Cntry   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0042           Load ID
     C                     MOVELP4NKAA    WL0043    P      Country Code
     C                     MOVELWU        WL0044    P      Country Ord Fou
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WU        P      Country Ord Fou
      * CASE: WRK.Country Ord Found Sts USR is yes
     C           WU        IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Skip if Country Code is not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Select by Load Id
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Load ID is GT Zero
      *   |- c2    : PAR.Load ID NE DB1.Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1RMNB    IFGT *ZERO                      *IF
     C           P1RMNB    IFNE FJRMNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: DB1.Load ID is Blank
     C           FJRMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Type of Customer - Ship To or Bill To            E002587
      * CASE: PGM.*Record selected is Not *NO
     C           W0RSL     IFEQ 'Y'                        *IF
     C           W0RSL     OREQ *BLANK
      * SEL: Type of Customer - Ship To or Bill To            E002587
      * CASE: PAR.USR Include all Products NE WRK.Blank for 3          US
     C           P6JIST    IFNE WUUAT1                     *IF
      * Only test if this record has not been excluded prior to this
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0011           Record Selected
      * If Bill To requested then select associated Ship To's as well
      * CASE: PAR.USR Include all Products is Bill To
     C           P6JIST    IFEQ 'B'                        *IF
      * Select Bill To customer
      * CASE: PAR.Ship To Customer is not equal to zero
     C           P3BKC7    IFNE *ZERO                      *IF
      * VAL ARCust on a Load   RT - Order Header TRG  * 
     C                     EXSR SSRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       YL0011           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0011           Record Selected
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * * If no cust# passed in, select all for date range
     C                     MOVEL'Y'       YL0011           Record Selected
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.USR Include all Products is Ship To
     C           P6JIST    IFEQ 'S'                        *IF
      * Select Ship To customer
      * CASE: PAR.Ship To Customer is not equal to zero
     C           P3BKC7    IFNE *ZERO                      *IF
      * If Ship To requested then only select that ship to's records
      * RTV Ordrs/Chk Ship Cst RT - Order Header TRG  * 
     C                     EXSR STRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       YL0011           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0011           Record Selected
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0011           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Record Selected       USR is yes
     C           YL0011    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Up to 9 Warehouses                               E004105
      * CASE: PGM.*Record selected is Not *NO
     C           W0RSL     IFEQ 'Y'                        *IF
     C           W0RSL     OREQ *BLANK
      * 01/17/20 DN S16050-Added 9th Warehouse Code.
      * See if at least one warehouse code was entered
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   '-
     C           P8CPCD    IFNE *BLANK                     *IF
     C           P8VSCD    ORNE *BLANK                     *OR
     C           P8VTCD    ORNE *BLANK                     *OR
     C           P8VUCD    ORNE *BLANK                     *OR
     C           P8VVCD    ORNE *BLANK                     *OR
     C           P8VWCD    ORNE *BLANK                     *OR
     C           P8VXCD    ORNE *BLANK                     *OR
     C           P8VYCD    ORNE *BLANK                     *OR
     C           P8VZCD    ORNE *BLANK                     *OR
      * * If warehouse requested, check each warehouse code
     C                     MOVEL'N'       YL0012           Select Status
      * Whse 1-Select if warehouse code entered
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           P8CPCD    IFNE *BLANK                     *IF
      * SEL Order for Whse    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0045           Load ID
     C                     MOVELP8CPCD    WL0046    P      Warehouse Code
     C                     MOVELYL0012    WL0047    P      Select Status
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    YL0012    P      Select Status
     C                     END                             *FI
      * Whse 2-Select if warehouse code entered
      * CASE: PAR.USR CDE Parm 1 is Warehouse Code not Blank
     C           P8VSCD    IFNE *BLANK                     *IF
      * CASE: LCL.Select Status is no
     C           YL0012    IFEQ 'N'                        *IF
      * SEL Order for Whse    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0045           Load ID
     C                     MOVELP8VSCD    WL0046    P      Warehouse Code
     C                     MOVELYL0012    WL0047    P      Select Status
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    YL0012    P      Select Status
     C                     END                             *FI
     C                     END                             *FI
      * Whse 3-Select if warehouse code entered
      * CASE: PAR.USR CDE Parm 2 is Warehouse Code not Blank
     C           P8VTCD    IFNE *BLANK                     *IF
      * CASE: LCL.Select Status is no
     C           YL0012    IFEQ 'N'                        *IF
      * SEL Order for Whse    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0045           Load ID
     C                     MOVELP8VTCD    WL0046    P      Warehouse Code
     C                     MOVELYL0012    WL0047    P      Select Status
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    YL0012    P      Select Status
     C                     END                             *FI
     C                     END                             *FI
      * Whse 4-Select if warehouse code entered
      * CASE: PAR.USR CDE Parm 3 is Warehouse Code not Blank
     C           P8VUCD    IFNE *BLANK                     *IF
      * CASE: LCL.Select Status is no
     C           YL0012    IFEQ 'N'                        *IF
      * SEL Order for Whse    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0045           Load ID
     C                     MOVELP8VUCD    WL0046    P      Warehouse Code
     C                     MOVELYL0012    WL0047    P      Select Status
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    YL0012    P      Select Status
     C                     END                             *FI
     C                     END                             *FI
      * Whse 5-Select if warehouse code entered
      * CASE: PAR.USR CDE Parm 4 is Warehouse Code not Blank
     C           P8VVCD    IFNE *BLANK                     *IF
      * CASE: LCL.Select Status is no
     C           YL0012    IFEQ 'N'                        *IF
      * SEL Order for Whse    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0045           Load ID
     C                     MOVELP8VVCD    WL0046    P      Warehouse Code
     C                     MOVELYL0012    WL0047    P      Select Status
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    YL0012    P      Select Status
     C                     END                             *FI
     C                     END                             *FI
      * Whse 6-Select if warehouse code entered
      * CASE: PAR.USR CDE Parm 5 is Warehouse Code not Blank
     C           P8VWCD    IFNE *BLANK                     *IF
      * CASE: LCL.Select Status is no
     C           YL0012    IFEQ 'N'                        *IF
      * SEL Order for Whse    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0045           Load ID
     C                     MOVELP8VWCD    WL0046    P      Warehouse Code
     C                     MOVELYL0012    WL0047    P      Select Status
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    YL0012    P      Select Status
     C                     END                             *FI
     C                     END                             *FI
      * Whse 7-Select if warehouse code entered
      * CASE: PAR.USR CDE Parm 6 is Warehouse Code not Blank
     C           P8VXCD    IFNE *BLANK                     *IF
      * CASE: LCL.Select Status is no
     C           YL0012    IFEQ 'N'                        *IF
      * SEL Order for Whse    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0045           Load ID
     C                     MOVELP8VXCD    WL0046    P      Warehouse Code
     C                     MOVELYL0012    WL0047    P      Select Status
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    YL0012    P      Select Status
     C                     END                             *FI
     C                     END                             *FI
      * Whse 8-Select if warehouse code entered
      * CASE: PAR.USR CDE Parm 7 is Warehouse Code not Blank
     C           P8VYCD    IFNE *BLANK                     *IF
      * CASE: LCL.Select Status is no
     C           YL0012    IFEQ 'N'                        *IF
      * SEL Order for Whse    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0045           Load ID
     C                     MOVELP8VYCD    WL0046    P      Warehouse Code
     C                     MOVELYL0012    WL0047    P      Select Status
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    YL0012    P      Select Status
     C                     END                             *FI
     C                     END                             *FI
      * Whse 9-Select if warehouse code entered       01/17/20 DN S16050
      * CASE: PAR.USR CDE Parm 8 is Warehouse Code not Blank
     C           P8VZCD    IFNE *BLANK                     *IF
      * CASE: LCL.Select Status is no
     C           YL0012    IFEQ 'N'                        *IF
      * SEL Order for Whse    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0045           Load ID
     C                     MOVELP8VZCD    WL0046    P      Warehouse Code
     C                     MOVELYL0012    WL0047    P      Select Status
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    YL0012    P      Select Status
     C                     END                             *FI
     C                     END                             *FI
      * If Select Status is no then don't select the record
      * CASE: LCL.Select Status is no
     C           YL0012    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Select Load Haul Type, if entered
      * CASE: PAR.Reason Code 1 PASS    USR is Entered
     C           P6T4CD    IFNE *BLANK                     *IF
      * VAL LdHaul for Load Id RT - Order Header Extension  * 
     C                     EXSR SWRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * If Collect Y/N = No, select only Prepaid, else select all
      * CASE: PAR.Status - Y or N is no
     C           P6B8ST    IFEQ 'N'                        *IF
      * CASE: DB1.Shipping Method is Collect
     C           FJQ2CD    IFEQ 'CR'                       *IF
     C           FJQ2CD    OREQ 'CT'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * 07/19/19 DN R15161-Replaced Booking Number w/ OHE Booking Number.
      * Select Booking Number, if entered
      * CASE: PAR.OHE Booking Number is Entered
     C           P2J1T1    IFNE *BLANK                     *IF
      * RTV Booking# by Load   RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD*ZERO     WL0048           Order Number
     C                     Z-ADDFJRMNB    WL0049           Load ID
     C                     MOVELP2J1T1    WL0050    P      OHE Booking Num
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    YL0013    P      Record Found US
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0013    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Sel Broker if entered, val broker customer, if entered  E001704
      * CASE: PAR.Broker Code is Entered
     C           P5HHAA    IFNE *BLANK                     *IF
      * VAL Broker Exists     RT - Broker  * 
     C                     EXSR SYRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Ship To Customer is not equal to zero
     C           P3BKC7    IFNE *ZERO                      *IF
      * VAL Broker for ShipTo  RT - Customer Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP5HHAA    WL0052    P      Accrual Code
     C                     Z-ADDP3BKC7    WL0053           Ship To Custome
     C                     EXSR SZRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0014           Ship To Custome
      * RTV Ship To,SlsRte -Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0054           Load ID
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0055    YL0014           Ship To Custome
     C                     MOVELWL0056    YN0079    P      Ship To Name
     C                     MOVELWL0057    YN0080    P      Ship To State C
     C                     MOVELWL0058    YN0081    P      Sales Route Cod
      * VAL Broker for ShipTo  RT - Customer Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP5HHAA    WL0052    P      Accrual Code
     C                     Z-ADDYL0014    WL0053           Ship To Custome
     C                     EXSR SZRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Select Customer Type Code                             E002395
      * CASE: PAR.Trans Type 1 PASS     USR NE WRK.Blank for 3          U
     C           P6ZSST    IFNE WUUAT1                     *IF
      * Only test if this record has not been excluded prior to this
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Test type code for each customer order on the load, flag if at le
      * one customer matches. If only one customer is requested, test onl
      * customer and flag if type code matches
     C                     MOVEL*BLANK    YL0011           Record Selected
      * RTV Type Cd by Ord     RT - Order Header TRG  * 
     C                     EXSR TBRVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Record Selected       USR is no
      *   |- c2    : LCL.Record Selected       USR is blank
      *   '-
     C           YL0011    IFEQ 'N'                        *IF
     C           YL0011    OREQ *BLANK                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: LCL.Record Selected       USR is yes
     C           YL0011    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Warehouse Type  (FR or FZ)                       E002587
      * CASE: PGM.*Record selected is Not *NO
     C           W0RSL     IFEQ 'Y'                        *IF
     C           W0RSL     OREQ *BLANK
      * SEL: Warehouse Type  (FR or FZ)                       E002587
      * CASE: PAR.Trans Type 2 PASS     USR NE WRK.Blank for 3          U
     C           P6ZTST    IFNE WUUAT1                     *IF
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELFJVPCD    WL0001    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0016    P      Warehouse Type
      * CASE: LCL.Warehouse Type is Equal blank
     C           YL0016    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: LCL.Warehouse Type NE PAR.Trans Type 2 PASS     USR
     C           YL0016    IFNE P6ZTST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Include Letter of Credit Number                  E002768
      * CASE: PGM.*Record selected is Not *NO
     C           W0RSL     IFEQ 'Y'                        *IF
     C           W0RSL     OREQ *BLANK
      * SEL: Include/Exclude loads with Letter of Credit      E002768
      * CASE: PAR.USR Confirm Status (Y/N) is L/C - Select All
     C           P6SBST    IFEQ 'A'                        *IF
      * * do nothing, select all records
     C                     ELSE
      * CASE: PAR.USR Confirm Status (Y/N) is L/C Not Entered
     C           P6SBST    IFEQ *BLANK                     *IF
      * * Select records with Letter of Credit not yet entered
      * RTV VAL Ltr of Crdt    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD1         WL0061           Order Number
     C                     Z-ADDFJRMNB    WL0062           Load ID
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    WUWXST    P      Record Found US
      * CASE: WRK.Record Found USR is Record Found
     C           WUWXST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.USR Confirm Status (Y/N) is L/C Entered
     C           P6SBST    IFEQ 'E'                        *IF
      * * Select records with Letter of Credit already entered
      * RTV VAL Ltr of Crdt    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD1         WL0061           Order Number
     C                     Z-ADDFJRMNB    WL0062           Load ID
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    WUWXST    P      Record Found US
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Scheduled Ship
     C                     MOVEL*BLANK    W0AL01  1        Carrier Code
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Scheduled Ship
     C                     MOVEL'Y'       W0AL01  1        Carrier Code
     C                     ELSE
      * Next record - Detect level breaks
     C           FJAODT    IFNE WZA001                     Scheduled Ship
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           FJBZNA    IFNE WZA002                     Carrier Code
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     Z-ADDWUCNTU    $IMCNB           Number of Order
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$IFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Crt LdOrdDt Wts/WF PO: Mainline
      *================================================================
      * PRT Crt LdOrdDt Wts/WF PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQKB02           Load ID
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB02           Load ID
      * Setup key
     C                     Z-ADD$ERMNB    WQKB02           Load ID
      * Establish starting position
     C           KRSB      SETLL@FLCPKF                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Load ID
     C                     MOVEL'Y'       W0BL01  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $HHHT1           @Dashes Line Us
     C                     Z-ADDFLAIC3    $HAIC3           Company Number
     C                     Z-ADDFLRMNB    $HRMNB           Load ID
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDFLRMNB    $FRMNB           Load ID
     C                     Z-ADDFLAIC3    $FAIC3           Company Number
     C                     MOVEL*BLANK    $FAJCD           Warehouse Code
     C                     Z-ADDFLC4NB    $FC4NB           Order Number
     C                     Z-ADD*ZERO     $FD0C7           Ship to Custome
     C                     Z-ADDFLRUNB    $FRUNB           Stop/Drop Seque
     C                     MOVEL*BLANK    $FAYTX           Customer Name
     C                     MOVEL*BLANK    $FBCNA           Customer Purcha
     C                     Z-ADD*ZERO     $FA1WG           Order Weight To
     C                     Z-ADD*ZERO     $FF0WG           Gross Weight US
     C                     Z-ADD*ZERO     $FTTNY           Weight in Metri
     C                     Z-ADD*ZERO     $FEVWG           Weight Schedule
     C                     Z-ADD*ZERO     $FJZVA           Order Value Tot
     C                     Z-ADD*ZERO     $FE9WG           Gross Weight US
     C                     Z-ADDFLZ4NB    $FZ4NB           MPC Number
     C                     MOVEL*BLANK    $FNANA           Yes/No Descript
     C                     MOVEL*BLANK    $FKXCD           Country Code
     C                     MOVEL*BLANK    $FB6NA           Special Instruc
     C                     MOVEL*BLANK    $FBYNA           Special Instruc
     C                     MOVEL*BLANK    $FY8TX           Text USR 7
     C                     MOVEL*BLANK    $FCNTN           Container Numbe
     C                     MOVEL*BLANK    $FMHNA           Special Comment
     C                     Z-ADDFLKEDT    $FKEDT           Estimated Arriv
     C                     Z-ADDFLSXNB    $FSXNB           Estimated Arriv
     C                     Z-ADDFLKFDT    $FKFDT           Appointment Con
     C                     Z-ADDFLACTM    $FACTM           Appointment Con
     C                     MOVELFLK5TX    $FK5TX           Confirmation Ma
     C                     MOVELFLW5CD    $FW5CD           Confirmation Nu
     C                     Z-ADDFLEJDT    $FEJDT           Actual Delivery
     C                     Z-ADDFLAGTM    $FAGTM           Actual Delivery
     C                     Z-ADDFLKJDT    $FKJDT           Scheduled Deliv
     C                     Z-ADDFLATTM    $FATTM           Scheduled Deliv
     C                     Z-ADDFLHDDT    $FHDDT           Deadline Depart
     C                     Z-ADDFLAUTM    $FAUTM           Deadline Depart
     C                     Z-ADDFLKKDT    $FKKDT           On Yard Date
     C                     Z-ADDFLAVTM    $FAVTM           On Yard Time
     C                     MOVELFLY7ST    $FY7ST           Load Dtl On Tim
     C                     MOVELFLY2ST    $FY2ST           On Time Add'l R
     C                     MOVELFLWHTX    $FWHTX           Seal Nbr 1
     C                     MOVELFLWITX    $FWITX           Seal Nbr 2
     C                     MOVELFLWJTX    $FWJTX           Seal Nbr 3
     C                     MOVELFLWKTX    $FWKTX           Seal Nbr 4
     C                     MOVELFLWLTX    $FWLTX           Seal Nbr 5
     C                     Z-ADDFLN7DT    $FN7DT           LD Carrier Appt
     C                     Z-ADDFLN8DT    $FN8DT           LD Unused Date
     C                     Z-ADDFLN9DT    $FN9DT           LD Unused Date
     C                     Z-ADDFLB3TM    $FB3TM           LD Carrier Appt
     C                     Z-ADDFLB4TM    $FB4TM           LD Unused Time
     C                     Z-ADDFLB5TM    $FB5TM           LD Unused Time
     C                     MOVELFLIASX    $FIASX           Miles Error Sts
     C                     MOVELFLIBSX    $FIBSX           LD Unused Sts 2
     C                     MOVELFLICSX    $FICSX           HPB Transload S
     C                     MOVELFLWVTX    $FWVTX           LD Cst Svc Trac
     C                     MOVELFLWWTX    $FWWTX           LD Unused Txt 2
     C                     MOVELFLWXTX    $FWXTX           LD Unused Txt 3
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Crt OHE/LD WF      PO
     C                     EXSR UHSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     MOVEL@CN,006   WUCWTX           @Text 25
     C                     MOVEL*BLANK    $HHHT1           @Dashes Line Us
     C                     MOVELWUCWTX    $HHHT1           @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $HHHT1    CAT  WUCWTX:ZQ $HHHT1    P      @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $HHHT1    CAT  WUCWTX:ZQ $HHHT1    P      @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $HHHT1    CAT  WUCWTX:ZQ $HHHT1    P      @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $HHHT1    CAT  WUCWTX:ZQ $HHHT1    P      @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $HHHT1    CAT  WUCWTX:ZQ $HHHT1    P      @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $HHHT1    CAT  @CN,007:ZQ$HHHT1    P      @Dashes Line Us
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FLRMNB    WZB001           Load ID
     C                     Z-ADDFLRMNB    WZB001
     C           *LIKE     DEFN FLC4NB    WZB002           Order Number
     C                     Z-ADDFLC4NB    WZB002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@FLCPKF                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Load ID
     C                     MOVEL*BLANK    W0BL01  1        Order Number
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Load ID
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           FLRMNB    IFNE WZB001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           FLC4NB    IFNE WZB002                     Order Number
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$HKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * PRT Crt OHE/LD WF      PO: Mainline
      *================================================================
      * PRT Crt OHE/LD WF      PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMAIC3    WQKC01           Company Number
     C           *LIKE     DEFN AMC4NB    WQKC02           Order Number
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
      * Setup key
     C                     Z-ADD$FAIC3    WQKC01           Company Number
     C                     Z-ADD$FC4NB    WQKC02           Order Number
      * Establish starting position
     C           KRSC      SETLL@AMREJF                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDAMAIC3    $GAIC3           Company Number
     C                     Z-ADDAMC4NB    $GC4NB           Order Number
     C                     Z-ADDAMRMNB    $GRMNB           Load ID
     C                     Z-ADDAMRUNB    $GRUNB           Stop/Drop Seque
     C                     MOVELAMHBAA    $GHBAA           OHE City
     C                     MOVELAMOANA    $GOANA           Port Delv Termi
     C                     MOVELAMB4TX    $GB4TX           OHE Load Haul T
     C                     MOVELAMXACD    $GXACD           Shipping Line
     C                     MOVELAMJ0T1    $GJ0T1           OHE Vessel/Airl
     C                     MOVELAMGENY    $GGENY           OHE Voyage/Flig
     C                     Z-ADDAMQWDT    $GQWDT           OHE Sail/Flight
     C                     MOVELAMHCAA    $GHCAA           OHE Discharge P
     C                     Z-ADDAMQYDT    $GQYDT           OHE Arrival Dat
     C                     MOVELAMJ2T1    $GJ2T1           OHE Container N
     C                     MOVELAMJ1T1    $GJ1T1           OHE Booking Num
     C                     MOVEL*BLANK    $GAKU1           String 30
     C                     Z-ADDAMQXDT    $GQXDT           OHE Port Cut Da
     C                     MOVELAMHDAA    $GHDAA           OHE Late Delive
     C                     MOVELAMCCTX    $GCCTX           OHE Ship Status
     C                     MOVELAMRLNA    $GRLNA           OHE Comment 1
     C                     MOVELAMRMNA    $GRMNA           OHE Comment 2
     C                     Z-ADDAMGINY    $GGINY           OHE Unused Numb
     C                     Z-ADDAMGFNY    $GGFNY           OHE Unused Numb
     C                     Z-ADDAMGGNY    $GGGNY           OHE Unused Numb
     C                     Z-ADDAMGHNY    $GGHNY           OHE Unused Numb
     C                     Z-ADDAMHEVL    $GHEVL           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    $GHFVL           OHE HPB RIN Pri
     C                     Z-ADDAMHGVL    $GHGVL           Transload Termi
     C                     Z-ADDAMQZDT    $GQZDT           OHE Est Arrv at
     C                     Z-ADDAMQ0DT    $GQ0DT           OHE Backhaul ET
     C                     Z-ADDAMQ1DT    $GQ1DT           OHE Port/Pier P
     C                     Z-ADDAMQ2DT    $GQ2DT           OHE Actual Ship
     C                     MOVELAMC2TX    $GC2TX           OHE Carrier SCA
     C                     MOVELAMC3TX    $GC3TX           OHE Spot Buy
     C                     MOVELAMC6TX    $GC6TX           OHE PO ACK Flag
     C                     MOVELAMCHTX    $GCHTX           OHE Override Ty
     C                     MOVELAMCITX    $GCITX           OHE Backhaul St
     C                     MOVELAMCLTX    $GCLTX           OHE Backhaul ET
     C                     MOVELAMCUTX    $GCUTX           OHE Backhaul Ca
     C                     MOVELAMCVTX    $GCVTX           OHE Bookings Co
     C                     MOVELAMB9TX    $GB9TX           OHE EDI Error R
     C                     MOVELAMJWSC    $GJWSC           OHE EDI Error R
     C                     Z-ADDAMITNY    $GITNY           HPB COA Batch N
     C                     MOVELAMLMT1    $GLMT1           Delivery P.O. N
     C                     MOVELAMLWAA    $GLWAA           OHE Intended fo
     C                     MOVELAMFVST    $GFVST           OHE EDI 943 Act
     C                     MOVELAMF0ST    $GF0ST           OHE EDI 944 Act
     C                     MOVELAMF2ST    $GF2ST           OHE EDI 940 Act
     C                     MOVELAMF3ST    $GF3ST           OHE EDI 945 Act
     C                     MOVELAMJUSC    $GJUSC           OHE EDI 856 Act
     C                     MOVELAMJVSC    $GJVSC           OHE EDI 824 Act
     C                     MOVELAMV3T1    $GV3T1           OHE Transload S
     C                     MOVELAMV4T1    $GV4T1           OHE Abs Rate Ov
     C                     MOVELAMV5T1    $GV5T1           OHE Appt Confir
     C                     MOVELAMV6T1    $GV6T1           OHE Backhaul Co
     C                     MOVELAMV7T1    $GV7T1           OHE Backhaul Ch
     C                     MOVELAMV8T1    $GV8T1           OHE Transload C
     C                     MOVELAMV9T1    $GV9T1           OHE Pier Pass I
     C                     MOVELAMWAT1    $GWAT1           OHE Carrier Nm
     C                     MOVELAMWBT1    $GWBT1           OHE Appt Confir
     C                     MOVELAMWCT1    $GWCT1           OHE Backhaul Co
     C                     MOVELAMWDT1    $GWDT1           Letter of Credi
     C                     Z-ADDAMQJNY    $GQJNY           OHE Backhaul Re
     C                     Z-ADDAMQKNY    $GQKNY           LD Stop/Drop
     C                     Z-ADDAMQLNY    $GQLNY           OHE Unused Numb
     C                     Z-ADDAMP8NY    $GP8NY           OHE Pier Pass F
     C                     Z-ADDAMP9NY    $GP9NY           OHE Port Check
     C                     Z-ADDAMQANY    $GQANY           OHE Port Cut Ti
     C                     Z-ADDAMQCNY    $GQCNY           OHE Backhaul Tr
     C                     Z-ADDAMQDNY    $GQDNY           OHE Load Sched
     C                     Z-ADDAMQENY    $GQENY           Original Appoin
     C                     Z-ADDAMQFNY    $GQFNY           Original Appoin
     C                     Z-ADDAMQGNY    $GQGNY           OHE PowerPro Lo
     C                     Z-ADDAMQHNY    $GQHNY           OHE PowerPro Lo
     C                     Z-ADDAMQINY    $GQINY           OHE Unused Nume
     C                     Z-ADDAMQMNY    $GQMNY           OHE Orig ABS Fr
     C                     MOVELAMMYU1    $GMYU1           OHE Genset Numb
     C                     MOVELAMJXSC    $GJXSC           OHE Email BOL/S
     C                     MOVELAMJYSC    $GJYSC           OHE Unused Stat
     C                     MOVELAMJZSC    $GJZSC           OHE Unused Stat
     C                     MOVELAMJ0SC    $GJ0SC           OHE Unused Stat
     C                     MOVELAMMZU1    $GMZU1           OHE Unused Text
     C                     MOVELAMM0U1    $GM0U1           OHE Unused Text
     C                     MOVELAMM1U1    $GM1U1           OHE Unused Text
     C                     MOVELAMM2U1    $GM2U1           OHE Unused Text
     C                     MOVELAMM3U1    $GM3U1           OHE Unused Text
     C                     Z-ADDAMW5DT    $GW5DT           OHE Unused Date
     C                     Z-ADDAMW6DT    $GW6DT           OHE Unused Date
     C                     MOVELAMUVST    $GUVST           EDI Status 1
     C                     MOVELAMUWST    $GUWST           EDI Status 2
     C                     MOVELAMUXST    $GUXST           EDI Status 3
     C                     MOVELAMVSST    $GVSST           Record Status
     C                     Z-ADDAMAATM    $GAATM           Job Time
     C                     MOVELAMAYNA    $GAYNA           User Id
     C                     MOVELAMA0NA    $GA0NA           Job Name
     C                     Z-ADDAMAXDT    $GAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AMAIC3    WZC001           Company Number
     C                     Z-ADDAMAIC3    WZC001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@AMREJF                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     ELSE
      * Next record - Detect level breaks
     C           AMAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Exp Bkg rpt & dwnldPF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Exp Bkg rpt & dwnldPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Scheduled Ship Date of Prt Exp Bkg rpt & dwnldPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$CKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Carrier Code of Prt Exp Bkg rpt & dwnldPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$DKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Detail line. of Prt Exp Bkg rpt & dwnldPF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'N'       WUDTSX           Print (Yes/No)
      * RTV Carrier Name       RT - Carrier  * 
     C                     EXSR SGRVGN
      * CUR.USR 15 Text           USR = Condition name of CUR.Shipping Me
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM $EQ2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $ENLTX    PARM           W0CNNM 25        USR 15 Text
      *
     C                     ADD  1         WUCNTU           Count USR
      * ** E002395 01/08/2013 LJB
      * ** Add Warehouse Type, spell out, if Fresh then change to Chilled
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$EVPCD    WL0001    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUWPST    P      Warehouse Type
      * warehouse type text
      * CASE: WRK.Warehouse Type is Fresh
     C           WUWPST    IFEQ 'FR'                       *IF
     C                     MOVEL@CN,004   $EY8TX           Text USR 7
     C                     ELSE
      * CASE: WRK.Warehouse Type is Frozen
     C           WUWPST    IFEQ 'FZ'                       *IF
     C                     MOVEL@CN,003   $EY8TX           Text USR 7
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $EY8TX           Text USR 7
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $EAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$EAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VEAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $EAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEAODT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Crt LdOrdDt Wts/WF PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Load ID of PRT Crt LdOrdDt Wts/WF PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Order Number of PRT Crt LdOrdDt Wts/WF PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Detail line. of PRT Crt LdOrdDt Wts/WF PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * ** Clear work variables
     C                     EXSR UGSUBR                     ** Clear work v
      * CUR = DB1 By name
     C                     Z-ADDFLRMNB    $FRMNB           Load ID
     C                     Z-ADDFLAIC3    $FAIC3           Company Number
     C                     Z-ADDFLC4NB    $FC4NB           Order Number
     C                     Z-ADDFLRUNB    $FRUNB           Stop/Drop Seque
     C                     Z-ADDFLZ4NB    $FZ4NB           MPC Number
     C                     Z-ADDFLKEDT    $FKEDT           Estimated Arriv
     C                     Z-ADDFLSXNB    $FSXNB           Estimated Arriv
     C                     Z-ADDFLKFDT    $FKFDT           Appointment Con
     C                     Z-ADDFLACTM    $FACTM           Appointment Con
     C                     MOVELFLK5TX    $FK5TX           Confirmation Ma
     C                     MOVELFLW5CD    $FW5CD           Confirmation Nu
     C                     Z-ADDFLEJDT    $FEJDT           Actual Delivery
     C                     Z-ADDFLAGTM    $FAGTM           Actual Delivery
     C                     Z-ADDFLKJDT    $FKJDT           Scheduled Deliv
     C                     Z-ADDFLATTM    $FATTM           Scheduled Deliv
     C                     Z-ADDFLHDDT    $FHDDT           Deadline Depart
     C                     Z-ADDFLAUTM    $FAUTM           Deadline Depart
     C                     Z-ADDFLKKDT    $FKKDT           On Yard Date
     C                     Z-ADDFLAVTM    $FAVTM           On Yard Time
     C                     MOVELFLY7ST    $FY7ST           Load Dtl On Tim
     C                     MOVELFLY2ST    $FY2ST           On Time Add'l R
     C                     MOVELFLWHTX    $FWHTX           Seal Nbr 1
     C                     MOVELFLWITX    $FWITX           Seal Nbr 2
     C                     MOVELFLWJTX    $FWJTX           Seal Nbr 3
     C                     MOVELFLWKTX    $FWKTX           Seal Nbr 4
     C                     MOVELFLWLTX    $FWLTX           Seal Nbr 5
     C                     Z-ADDFLN7DT    $FN7DT           LD Carrier Appt
     C                     Z-ADDFLN8DT    $FN8DT           LD Unused Date
     C                     Z-ADDFLN9DT    $FN9DT           LD Unused Date
     C                     Z-ADDFLB3TM    $FB3TM           LD Carrier Appt
     C                     Z-ADDFLB4TM    $FB4TM           LD Unused Time
     C                     Z-ADDFLB5TM    $FB5TM           LD Unused Time
     C                     MOVELFLIASX    $FIASX           Miles Error Sts
     C                     MOVELFLIBSX    $FIBSX           LD Unused Sts 2
     C                     MOVELFLICSX    $FICSX           HPB Transload S
     C                     MOVELFLWVTX    $FWVTX           LD Cst Svc Trac
     C                     MOVELFLWWTX    $FWWTX           LD Unused Txt 2
     C                     MOVELFLWXTX    $FWXTX           LD Unused Txt 3
      * RTV Qty & Wght Schedul RT - Order Detail  * 
     C                     EXSR SIRVGN
      * RTV All Header Fields  RT - Order Header TRG  * 
     C                     EXSR SJRVGN
      * ** calculate net kg
     C           $FA1WG    DIV  2.2046    $FEVWG    H      Weight Schedule
      * ** retrieve gross weight lbs & calculate gross kg
      * RTV Gross Wgt/Qty     XF - Order Detail  * rtv order gross weight
     C                     CALL 'PQPQXFR'              90  RTV Gross Wgt/Q
     C                     PARM *BLANK    W0RTN   7
     C                     PARM FLAIC3    WQ0001  30       Company Number
     C                     PARM FLC4NB    WQ0002  70       Order Number
     C                     PARM *ZERO     WQ0003  30       Order Sequence
     C                     PARM *ZERO     WQ0004  30       Order Secondary
     C           YL0003    PARM YL0003    WQ0005 112       USR Weight Accu
     C           YL0002    PARM YL0002    WQ0006 112       Order Quantity
     C                     PARM YL0007    WQ0007  92       Avg Pallet Tare
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PQPQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDYL0003    $FF0WG           Gross Weight US
     C           YL0003    DIV  2.2046    $FE9WG    H      Gross Weight US
      * ** Export Yes or No
      * CASE: LCL.Export Status is yes
     C           YL0006    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    $FNANA           Yes/No Descript
     C                     MOVEL'Yes'     $FNANA           Yes/No Descript
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $FNANA           Yes/No Descript
     C                     MOVEL'No'      $FNANA           Yes/No Descript
     C                     END                             *FI
      * RTV 1st Whse/Country   RT - Order Detail  * 
     C                     EXSR SKRVGN
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$FAJCD    WL0001    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUWPST    P      Warehouse Type
      * Warehouse Type text
      * CASE: WRK.Warehouse Type is Frozen
     C           WUWPST    IFEQ 'FZ'                       *IF
     C                     MOVEL@CN,003   $FY8TX           Text USR 7
     C                     ELSE
      * CASE: WRK.Warehouse Type is Fresh
     C           WUWPST    IFEQ 'FR'                       *IF
     C                     MOVEL@CN,004   $FY8TX           Text USR 7
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $FY8TX           Text USR 7
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Shipping Marks    RT - Export Doc Order Hdr  * 
     C                     EXSR SLRVGN
      * ** Hide special instructions & whse type are blanks  E002587
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : CUR.Special Instructions is Equal to Blank
      *   |- c2    : CUR.Special Instructions 2 is Equal to Blank
      *   |- c3    : WRK.Text USR 7 is *Blanks
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $FB6NA    IFEQ *BLANK                     *IF
     C           $FBYNA    IFEQ *BLANK                     *IF
     C           WUY8TX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUDXSX           Display Flag 1
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $FAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$FAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VFAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VFAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $FC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$FC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VFC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VFC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship to Customer      USR to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $FD0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$FD0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VFD0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VFD0C7           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUDXSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of PRT Crt OHE/LD WF      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of PRT Crt OHE/LD WF      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Detail line. of PRT Crt OHE/LD WF      PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'N'       WUD4ST           USR Flag 1
     C                     MOVEL'Y'       WUUFL2           USR Flag 2
      * ** Don't print a blank line if no exp instructions exist
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5 AND c6 AND c7 AND c8 AND c9
      *  -  AND c10 AND c11
      *   |- c1    : CUR.OHE City is Not Entered
      *   |- c2    : CUR.Port Delv Terminal is Not Entered
      *   |- c3    : CUR.Shipping Line is not entered
      *   |- c4    : CUR.OHE Vessel/Airline is blanks
      *   |- c5    : CUR.OHE Voyage/Flight is Zeros
      *   |- c6    : CUR.OHE Sail/Flight Date is not entered
      *   |- c7    : CUR.OHE Discharge Port/Airprt is Blank
      *   |- c8    : CUR.OHE Arrival Date is not entered
      *   |- c9    : CUR.OHE Container Number is Not Entered
      *   |- c10   : CUR.OHE Booking Number is Not Entered
      *   |- c11   : CUR.OHE Load Haul Type is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $GHBAA    IFEQ *BLANK                     *IF
     C           $GOANA    IFEQ *BLANK                     *IF
     C           $GXACD    IFEQ *BLANK                     *IF
     C           $GJ0T1    IFEQ *BLANK                     *IF
     C           $GGENY    IFEQ '*ZERO'                    *IF
     C           $GQWDT    IFEQ *ZERO                      *IF
     C           $GHCAA    IFEQ *BLANK                     *IF
     C           $GQYDT    IFEQ *ZERO                      *IF
     C           $GJ2T1    IFEQ *BLANK                     *IF
     C           $GJ1T1    IFEQ *BLANK                     *IF
     C           $GB4TX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * ** If Container is blanks, get Trailer ID from Load Header E00190
      * CASE: CUR.OHE Container Number is Not Entered
     C           $GJ2T1    IFEQ *BLANK                     *IF
      * RTV Trailer Number     RT - Load Header  * 
     C                     EXSR SMRVGN
     C                     MOVELWUDXTX    $GJ2T1           OHE Container N
     C                     MOVEL'Y'       YL0009           USR Flag 1
     C                     MOVEL'Y'       WUD4ST           USR Flag 1
     C                     END                             *FI
      * Change to print if Trailer exists in Load Header
      * CASE: WRK.USR Flag 1 is Yes
     C           WUD4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     END                             *FI
     C                     MOVELAMOANA    WN0005           Port Delv Termi
     C                     MOVELAMHBAA    WN0007           OHE City
     C                     MOVELAMJ0T1    WN0001           OHE Vessel/Airl
     C                     MOVELAMGENY    WN0008           OHE Voyage/Flig
     C                     MOVELAMJ1T1    WN0009           OHE Booking Num
     C                     MOVELAMHCAA    WN0011           OHE Discharge P
     C                     Z-ADDAMQYDT    WN0003           OHE Arrival Dat
     C                     MOVELAMJ2T1    WN0010           OHE Container N
     C                     MOVELAMWDT1    WN0012           Letter of Credi
     C                     MOVELWN0012    $GAKU1           String 30
      * * Get the Sail Port State for Delivery Terminal       E003025
      * RTV Shipping State     RT - Shipping Line/Port  * 
     C                     EXSR SNRVGN
      * * Pop Letter of Credit into String 30                 E002768
      * * carrier broker contains the accrual broker code. (SEI for Sumi)
      * * create the work file
      * CRT WF OHE & Load Rpt  CR - WF OHE & Load Rpt Info  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GAIC3    WL0003           Company Number
     C                     MOVEL$FAYTX    WL0004    P      Customer Name
     C                     Z-ADD$GRMNB    WL0005           Load ID
     C                     Z-ADD$GC4NB    WL0006           Order Number
     C                     MOVEL$GJ0T1    WL0007    P      OHE Vessel/Airl
     C                     Z-ADD$GQWDT    WL0008           OHE Sail/Flight
     C                     Z-ADD$EAODT    WL0009           Scheduled Ship
     C                     Z-ADD$GQYDT    WL0010           OHE Arrival Dat
     C                     MOVEL$GXACD    WL0011    P      Shipping Line
     C                     MOVEL$GOANA    WL0012    P      Port Delv Termi
     C                     MOVELWN0006    WL0013    P      Sail Port State
     C                     MOVEL$FAJCD    WL0014    P      Warehouse Code
     C                     MOVEL$GHBAA    WL0015    P      OHE City
     C                     MOVEL$GGENY    WL0016    P      OHE Voyage/Flig
     C                     MOVEL$GJ1T1    WL0017    P      OHE Booking Num
     C                     MOVEL$GJ2T1    WL0018    P      OHE Container N
     C                     MOVEL$GHCAA    WL0019    P      OHE Discharge P
     C                     MOVEL$FBCNA    WL0020    P      Customer Purcha
     C                     MOVEL$FBYNA    WL0021    P      Special Instruc
     C                     MOVEL$FB6NA    WL0022    P      Special Instruc
     C                     MOVEL$FMHNA    WL0023    P      Special Comment
     C                     Z-ADD$FZ4NB    WL0024           MPC Number
     C                     Z-ADD$FJZVA    WL0025           Order Value Tot
     C                     Z-ADD$FA1WG    WL0026           Order Weight To
     C                     Z-ADD$FEVWG    WL0027           Net Weight Kilo
     C                     Z-ADDYL0002    WL0028           Quantity Ordere
     C                     Z-ADDYL0004    WL0029           Quantity Schedu
     C                     Z-ADD$EGRWE    WL0030           Gross Weight
     C                     Z-ADD$FF0WG    WL0031           Gross Weight Or
     C                     MOVEL$EXCCD    WL0032    P      Broker Code
     C                     Z-ADD$FE9WG    WL0033           Gross Weight Ki
     C                     MOVEL$FKXCD    WL0034    P      Country Code
     C                     Z-ADDWUANC7    WL0035           A/R Customer Nu
     C                     Z-ADD$FD0C7    WL0036           Ship To Custome
     C                     MOVELP6ZSST    WL0037    P      Type Code
     C                     MOVELWUWPST    WL0038    P      Warehouse Type
     C                     MOVELWUZ0S1    WL0039    P      Type of Custome
     C                     MOVELWN0012    WL0040    P      Letter of Credi
     C                     MOVELYL0008    WL0041    P      ED Shipping Mar
     C                     EXSR SOCRRC
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert OHE Sail/Flight Date to display format
      * Convert date
     C           1000000   ADD  $GQWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGQWDT
      * Convert OHE Arrival Date to display format
      * Convert date
     C           1000000   ADD  $GQYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGQYDT
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Exp Bkg rpt & dwnldPF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Scheduled Ship Date of Prt Exp Bkg rpt & dwnldPF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Carrier Code of Prt Exp Bkg rpt & dwnldPF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Exp Bkg rpt & dwnldPF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Crt LdOrdDt Wts/WF PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Crt LdOrdDt Wts/WF PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Crt LdOrdDt Wts/WF PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Crt LdOrdDt Wts/WF PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Crt OHE/LD WF      PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Crt OHE/LD WF      PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Crt OHE/LD WF      PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     Z-ADDP1AODT    $BAODT           Scheduled Ship
     C                     Z-ADDP2HODT    $BHODT           Scheduled Ship
     C                     Z-ADDP1RMNB    $BRMNB           Load ID
     C                     MOVEL*BLANK    $BP9NA           Description USR
      * ** Print multiple country codes
     C                     EXSR UASUBR                     ** Print multip
      * ** Print multiple Carrier Codes
     C                     EXSR UBSUBR                     ** Print multip
      * ** Print multiple Shipping Lines
     C                     EXSR UCSUBR                     ** Print multip
     C                     MOVELP8CPCD    $BAJCD           Warehouse Code
      * TOP = PAR By name
     C                     Z-ADDP1AODT    $BAODT           Scheduled Ship
     C                     Z-ADDP3BKC7    $BBKC7           Ship To Custome
     C                     Z-ADDP2HODT    $BHODT           Scheduled Ship
     C                     MOVELP8VSCD    $BVSCD           USR CDE Parm 1
     C                     MOVELP8VTCD    $BVTCD           USR CDE Parm 2
     C                     MOVELP8VUCD    $BVUCD           USR CDE Parm 3
     C                     MOVELP8VVCD    $BVVCD           USR CDE Parm 4
     C                     MOVELP8VWCD    $BVWCD           USR CDE Parm 5
     C                     MOVELP8VXCD    $BVXCD           USR CDE Parm 6
     C                     MOVELP8VYCD    $BVYCD           USR CDE Parm 7
     C                     MOVELP8VZCD    $BVZCD           USR CDE Parm 8
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
     C                     Z-ADDP1RMNB    $BRMNB           Load ID
     C                     MOVELP2J1T1    $BJ1T1           OHE Booking Num
     C                     MOVELP1BZNA    $BBZNA           Carrier Code
     C                     MOVELP7NLAA    $BNLAA           Carrier Code Us
     C                     MOVELP7NMAA    $BNMAA           Carrier Code Us
     C                     MOVELP7NNAA    $BNNAA           Carrier Code Us
     C                     MOVELP7NOAA    $BNOAA           Carrier Code Us
     C                     MOVELP7NPAA    $BNPAA           Carrier Code Us
     C                     MOVELP7NQAA    $BNQAA           Carrier Code Us
     C                     MOVELP7NRAA    $BNRAA           Carrier Code Us
     C                     MOVELP7NSAA    $BNSAA           Carrier Code Us
     C                     MOVELP7NTAA    $BNTAA           Carrier Code Us
     C                     MOVELP7NUAA    $BNUAA           Carrier Code Us
     C                     MOVELP7N0AA    $BN0AA           Carrier Code Us
     C                     MOVELP7NWAA    $BNWAA           Carrier Code Us
     C                     MOVELP7NXAA    $BNXAA           Carrier Code Us
     C                     MOVELP7NYAA    $BNYAA           Carrier Code Us
     C                     MOVELP7NZAA    $BNZAA           Carrier Code Us
     C                     MOVELP5HHAA    $BHHAA           Broker Code
     C                     MOVELP4KIAA    $BKIAA           Country Code 1
     C                     MOVELP4KJAA    $BKJAA           Country Code 2
     C                     MOVELP4KKAA    $BKKAA           Country Code 3
     C                     MOVELP4KLAA    $BKLAA           Country Code 4
     C                     MOVELP4KMAA    $BKMAA           Country Code 5
     C                     MOVELP4KNAA    $BKNAA           Country Code 6
     C                     MOVELP4NHAA    $BNHAA           Country Code 7
     C                     MOVELP4NIAA    $BNIAA           Country Code 8
     C                     MOVELP4NJAA    $BNJAA           Country Code 9
     C                     MOVELP4NKAA    $BNKAA           Country Code 10
      * ** Include Collect Y/N
      * TOP.Text 3 Length USR = Condition name of PAR.Status - Y or N
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM P6B8ST    W0INVL 25        Status - Y or N
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BMLT1    PARM           W0CNNM 25        Text 3 Length U
      *
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
      * 07/19/19 DN R15161-Replaced Booking Number w/ OHE Booking Number.
     C                     MOVELP2J1T1    $BJ1T1           OHE Booking Num
     C                     MOVELP5HHAA    $BHHAA           Broker Code
      * broker name                            E001704
      * CASE: TOP.Broker Code is Entered
     C           $BHHAA    IFNE *BLANK                     *IF
      * Rtv Broker Name       RT - Broker  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
      * Load start company
      * CASE: PAR.Company Number is greater than zero
     C           P1AIC3    IFGT *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BAPTX           Company Name
     C                     MOVEL'*All'    $BAPTX           Company Name
     C                     END                             *FI
      * Load Customer - A/R or Ship To, based on customer type  E002587
     C                     EXSR UDSUBR                     Load Customer -
      * Type of Customer - Bill To or Ship To                 E002587
      * CASE: PAR.USR Include all Products NE WRK.USR Blank Field
     C           P6JIST    IFNE WUOINA                     *IF
      * CASE: PAR.USR Include all Products is Bill To
     C           P6JIST    IFEQ 'B'                        *IF
     C                     MOVEL@CN,001   $BIUTX           Text USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,002   $BIUTX           Text USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BIUTX           Text USR
     C                     END                             *FI
      * Load Haul Type
      * CASE: PAR.Reason Code 1 PASS    USR is Entered
     C           P6T4CD    IFNE *BLANK                     *IF
     C                     MOVELP6T4CD    $BB4TX           OHE Load Haul T
      * TOP.Description 1 usr = Condition name of TOP.OHE Load Haul Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1916500   Y2LSNO  70       List number
     C                     PARM $BB4TX    W0INVL 25        OHE Load Haul T
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BTIT1    PARM           W0CNNM 25        Description 1 u
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BTIT1           Description 1 u
     C                     MOVEL'*ALL'    $BTIT1           Description 1 u
     C                     END                             *FI
      * ** Include Customer Type Code
      * Type Code, ES, EX, or ??                              E002395
      * CASE: PAR.Trans Type 1 PASS     USR NE WRK.Blank for 3          U
     C           P6ZSST    IFNE WUUAT1                     *IF
     C                     MOVELP6ZSST    $BBOCD           Type Code
      * RTV Type Code Desc.    RT - Type Codes  * 
     C                     EXSR SFRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BP9NA           Description USR
     C                     MOVEL'*ALL'    $BP9NA           Description USR
     C                     END                             *FI
      * Warehouse Type - Frozen or Chilled                    E002587
      * CASE: PAR.Trans Type 2 PASS     USR NE WRK.Blank for 3          U
     C           P6ZTST    IFNE WUUAT1                     *IF
     C                     MOVELP6ZTST    $BWPST           Warehouse Type
      * CASE: TOP.Warehouse Type is Frozen
     C           $BWPST    IFEQ 'FZ'                       *IF
     C                     MOVEL@CN,003   $BY8TX           Text USR 7
     C                     MOVEL$BY8TX    WUY8TX           Text USR 7
     C                     ELSE
      * CASE: TOP.Warehouse Type is Fresh
     C           $BWPST    IFEQ 'FR'                       *IF
     C                     MOVEL@CN,004   $BY8TX           Text USR 7
     C                     MOVEL$BY8TX    WUY8TX           Text USR 7
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,005   $BY8TX           Text USR 7
     C                     MOVEL$BY8TX    WUY8TX           Text USR 7
     C                     END                             *FI
      * Format dashes between heading and first record on each page
     C                     EXSR UESUBR                     Format dashes b
      * Convert fields to external form
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $BAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBAODT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  $BHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBHODT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUDTSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Broker Name       RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           C5HHAA           Broker Code
      * Setup key
     C                     MOVEL$BHHAA    C5HHAA           Broker Code
      * Establish starting position
     C           KRSSC     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BC4T1           Broker Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC5C4T1    $BC4T1           Broker Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BAPTX           Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Name Only          RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$BBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BAYTX           Customer Name
     C                     GOTO SEEXIT                     *QUIT
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    $BAYTX           Customer Name
     C                     GOTO SEEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Type Code Desc.    RT - Type Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           AJBOCD           Type Code
      * Setup key
     C                     MOVEL$BBOCD    AJBOCD           Type Code
      * Establish starting position
     C           KRSSF     CHAIN@AJREBR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0026' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BP9NA           Description
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAJAUNA    $BP9NA           Description
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL$EBZNA    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSG     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $EKTNA           Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    $EKTNA           Name
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Warehouse Type
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0002           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Qty & Wght Schedul RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0004           Quantity Schedu
     C                     Z-ADD0         YL0005           Weight Schedule
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSI01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSI02           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADD$FAIC3    WQSI01           Company Number
     C                     Z-ADD$FC4NB    WQSI02           Order Number
      * Establish starting position
     C           KRSSI     SETLL@BGWKZL                    *
     C           KRSSI     READE@BGWKZL                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
     C                     ADD  OMCCQT    YL0004           Quantity Schedu
     C                     ADD  OMAUWG    YL0005           Weight Schedule
     C                     END                             *FI
     C           KRSSI     READE@BGWKZL                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV All Header Fields  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEANC7    WUANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $FD0C7           Ship To Custome
     C                     MOVELBEBRTX    $FAYTX           Ship To Name
     C                     MOVELBEBCNA    $FBCNA           Customer Purcha
     C                     MOVELBEB6NA    $FB6NA           Special Instruc
     C                     MOVELBEBYNA    $FBYNA           Special Instruc
     C                     Z-ADDBEJZVA    $FJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $FA1WG           Order Weight To
     C                     MOVELBEU2ST    YL0006           Export Status
     C                     MOVELBEMHNA    $FMHNA           Special Comment
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV 1st Whse/Country   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSK02           Order Number
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
      * Setup key
     C                     Z-ADD$FAIC3    WQSK01           Company Number
     C                     Z-ADD$FC4NB    WQSK02           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
      * Establish starting position
     C           KPSSK     SETLL@BGWKAE                    *
     C           KRSSK     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAJCD    $FAJCD           Warehouse Code
     C                     MOVELWAKXCD    $FKXCD           Country Code
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Shipping Marks    RT - Export Doc Order Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN MRAIC3    WQSL01           Company Number
     C           *LIKE     DEFN MRC4NB    WQSL02           Order Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADD$HAIC3    WQSL01           Company Number
     C                     Z-ADD$FC4NB    WQSL02           Order Number
      * Establish starting position
     C           KRSSL     SETLL@MRREWT                    *
     C           KRSSL     READE@MRREWT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2743' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           ED Shipping Mar
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELMRORNA    YL0008           ED Shipping Mar
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@MRREWT                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Trailer Number     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDAMRMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSSM     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBDXTX    WUDXTX           Trailer Id
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Shipping State     RT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           LCXACD           Shipping Line
     C                     KFLD           LCOANA           Port Delv Termi
      * Setup key
     C                     MOVEL$GXACD    LCXACD           Shipping Line
     C                     MOVEL$GOANA    LCOANA           Port Delv Termi
      * Establish starting position
     C           KRSSN     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0006           Sail Port State
     C                     GOTO SNEXIT                     *QUIT
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELLCXBCD    WN0006           Sail Port State
     C                     GOTO SNEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * CRT WF OHE & Load Rpt  CR - WF OHE & Load Rpt Info  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @GYCPI1
     C                     Z-ADDWL0003    GYAIC3           Company Number
     C                     MOVELWL0004    GYAYTX           Customer Name
     C                     Z-ADDWL0005    GYRMNB           Load ID
     C                     Z-ADDWL0006    GYC4NB           Order Number
     C                     MOVELWL0007    GYJ0T1           OHE Vessel/Airl
     C                     Z-ADDWL0008    GYQWDT           OHE Sail/Flight
     C                     Z-ADDWL0009    GYAODT           Scheduled Ship
     C                     Z-ADDWL0010    GYQYDT           OHE Arrival Dat
     C                     MOVELWL0011    GYXACD           Shipping Line
     C                     MOVELWL0012    GYOANA           Port Delv Termi
     C                     MOVELWL0013    GYXBCD           Sail Port State
     C                     MOVELWL0014    GYAJCD           Warehouse Code
     C                     MOVELWL0015    GYHBAA           OHE City
     C                     MOVELWL0016    GYGENY           OHE Voyage/Flig
     C                     MOVELWL0017    GYJ1T1           OHE Booking Num
     C                     MOVELWL0018    GYJ2T1           OHE Container N
     C                     MOVELWL0019    GYHCAA           OHE Discharge P
     C                     MOVELWL0020    GYBCNA           Customer Purcha
     C                     MOVELWL0021    GYBYNA           Special Instruc
     C                     MOVELWL0022    GYB6NA           Special Instruc
     C                     MOVELWL0023    GYMHNA           Special Comment
     C                     Z-ADDWL0024    GYZ4NB           MPC Number
     C                     Z-ADDWL0025    GYJZVA           Order Value Tot
     C                     Z-ADDWL0026    GYA1WG           Order Weight To
     C                     Z-ADDWL0027    GYVSNY           Net Weight Kilo
     C                     Z-ADDWL0028    GYAVQT           Quantity Ordere
     C                     Z-ADDWL0029    GYCCQT           Quantity Schedu
     C                     Z-ADDWL0030    GYGRWE           Gross Weight
     C                     Z-ADDWL0031    GYZKNY           Gross Weight Or
     C                     MOVELWL0032    GYHHAA           Broker Code
     C                     Z-ADDWL0033    GYVRNY           Gross Weight Ki
     C                     MOVELWL0034    GYKXCD           Country Code
     C                     Z-ADDWL0035    GYANC7           A/R Customer Nu
     C                     Z-ADDWL0036    GYBKC7           Ship To Custome
     C                     MOVELWL0037    GYBOCD           Type Code
     C                     MOVELWL0038    GYWPST           Warehouse Type
     C                     MOVELWL0039    GYZ0S1           Type of Custome
     C                     MOVELWL0040    GYWDT1           Letter of Credi
     C                     MOVELWL0041    GYORNA           ED Shipping Mar
      *
     C           KLCRSO    KLIST
     C                     KFLD           GYAIC3           Company Number
     C                     KFLD           GYAYTX           Customer Name
     C                     KFLD           GYRMNB           Load ID
     C                     KFLD           GYC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSO    SETLL@GYCPI1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4396' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@GYCPI1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Shipping Line-OHE  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSP01           Load ID
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQSP01           Load ID
      * Establish starting position
     C           KRSSP     SETLL@AMREJM                    *
     C           KRSSP     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXACD           Shipping Line
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** pass back the first record found with a shipping line
      * CASE: DB1.Shipping Line is not entered
     C           WCXACD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELWCXACD    WUXACD           Shipping Line
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Order for Cntry   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSQ02           Load ID
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
      * Setup key
     C                     Z-ADDWL0042    WQSQ02           Load ID
      * Establish starting position
     C           KRSSQ     SETLL@BFCPD9                    *
     C           KRSSQ     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Order for Cntry   RT - Order Detail  * 
     C                     EXSR SRRVGN
     C           KRSSQ     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Order for Cntry   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSR01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSR02           Order Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WQSR01           Company Number
     C                     Z-ADDWDC4NB    WQSR02           Order Number
      * Establish starting position
     C           KRSSR     SETLL@BGWKL1                    *
     C           KRSSR     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WEGMST    IFEQ 'L'                        *IF
     C           WEGMST    OREQ 'A'
     C           WEGMST    OREQ 'C'
     C           WEGMST    OREQ 'R'
     C           WEGMST    OREQ 'E'
     C           WEGMST    OREQ 'H'
     C           WEGMST    OREQ 'I'
      * Country Found
      * CASE: PAR.Country Code is Entered
     C           WL0043    IFNE *BLANK                     *IF
      * CASE: PAR.Country Code EQ DB1.Country Code
     C           WL0043    IFEQ WEKXCD                     *IF
     C                     MOVEL'Y'       WL0044           Country Ord Fou
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSR     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * VAL ARCust on a Load   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFANC7    WQSS01           A/R Customer Nu
     C           *LIKE     DEFN WFRMNB    WQSS02           Load ID
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           A/R Customer Nu
     C                     KFLD           WQSS02           Load ID
      * Setup key
     C                     Z-ADDP3BKC7    WQSS01           A/R Customer Nu
     C                     Z-ADDFJRMNB    WQSS02           Load ID
      * Establish starting position
     C           KRSSS     SETLL@BFCPQI                    *
     C           KRSSS     READE@BFCPQI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.A/R Customer Number EQ PAR.A/R Customer Number
     C           WFANC7    IFEQ P3BKC7                     *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SSEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSS     READE@BFCPQI                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Ordrs/Chk Ship Cst RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQST02           Load ID
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST02           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQST02           Load ID
      * Establish starting position
     C           KRSST     SETLL@BFCPD9                    *
     C           KRSST     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Ship To Customer EQ PAR.Ship To Customer
     C           WDBKC7    IFEQ P3BKC7                     *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO STEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C           KRSST     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * SEL Order for Whse    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSU02           Load ID
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU02           Load ID
      * Setup key
     C                     Z-ADDWL0045    WQSU02           Load ID
      * Establish starting position
     C           KRSSU     SETLL@BFCPD9                    *
     C           KRSSU     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Check Warehouse    RT - Order Detail  * 
     C                     EXSR SVRVGN
     C           KRSSU     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Check Warehouse    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSV01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSV02           Order Number
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WQSV01           Company Number
     C                     Z-ADDWDC4NB    WQSV02           Order Number
      * Establish starting position
     C           KRSSV     SETLL@BGWKL1                    *
     C           KRSSV     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WEGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.Warehouse Code
     C           WEAJCD    IFEQ WL0046                     *IF
     C                     MOVEL'Y'       WL0047           Select Status
     C                     GOTO SVEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSV     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * VAL LdHaul for Load Id RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSW01           Load ID
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSW01           Load ID
      * Establish starting position
     C           KRSSW     SETLL@AMREJI                    *
     C           KRSSW     READE@AMREJI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSW     READE@AMREJI                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Booking# by Load   RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0051           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSX01           Load ID
      * Define keylist
     C           KPSSX     KLIST
     C                     KFLD           WQSX01           Load ID
     C                     KFLD           WCC4NB           Order Number
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Load ID
      * Setup key
     C                     Z-ADDWL0049    WQSX01           Load ID
     C                     Z-ADDWL0048    WCC4NB           Order Number
      * Establish starting position
     C           KPSSX     SETLL@AMREJM                    *
     C           KRSSX     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Pass back Record Found if match
      * CASE: PAR.OHE Booking Number EQ DB1.OHE Booking Number
     C           WL0050    IFEQ WCJ1T1                     *IF
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     MOVEL'Y'       WL0051           Record Found US
     C                     GOTO SXEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSX     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * VAL Broker Exists     RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           C5HHAA           Broker Code
      * Setup key
     C                     MOVELP5HHAA    C5HHAA           Broker Code
      * Establish starting position
     C           KRSSY     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * VAL Broker for ShipTo  RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN HOOJCD    WQSZ02           Accrual Code
     C           *LIKE     DEFN HOBKC7    WQSZ03           Ship To Custome
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ02           Accrual Code
     C                     KFLD           WQSZ03           Ship To Custome
      * Setup key
     C                     MOVELWL0052    WQSZ02           Accrual Code
     C                     Z-ADDWL0053    WQSZ03           Ship To Custome
      * Establish starting position
     C           KRSSZ     SETLL@HORELO                    *
     C           KRSSZ     READE@HORELO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1520' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSZ     READE@HORELO                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Ship To,SlsRte -Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQTA02           Load ID
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA02           Load ID
      * Setup key
     C                     Z-ADDWL0054    WQTA02           Load ID
      * Establish starting position
     C           KRSTA     SETLL@BFCPD9                    *
     C           KRSTA     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDBKC7    WL0055           Ship To Custome
     C                     MOVELWDBRTX    WL0056           Ship To Name
     C                     MOVELWDDBCD    WL0057           Ship To State C
     C                     MOVELWDR4CD    WL0058           Sales Route Cod
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Type Cd by Ord     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQTB01           Load ID
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQTB01           Load ID
      * Establish starting position
     C           KRSTB     SETLL@BFCPR4                    *
     C           KRSTB     READE@BFCPR4                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Ship To Customer is not equal to zero
     C           P3BKC7    IFNE 0                          *IF
      * Validate type code for selected customer
      * CASE: DB1.Ship To Customer EQ PAR.Ship To Customer
     C           WHBKC7    IFEQ P3BKC7                     *IF
      * RTV Type Code by Cust  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHBKC7    WL0059           Ship To Custome
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    YL0015    P      Type Code
      * CASE: LCL.Type Code NE PAR.Trans Type 1 PASS     USR
     C           YL0015    IFNE P6ZSST                     *IF
     C                     MOVEL'N'       YL0011           Record Selected
     C                     GOTO TBEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0011           Record Selected
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Ship To Customer is equal to zero
     C           P3BKC7    IFEQ 0                          *IF
     C                     MOVEL'N'       YL0011           Record Selected
      * Rtv Cust&CType-LdOrd  RT - Order Header TRG  * 
     C                     EXSR TDRVGN
      * Flag if at least 1 order on the load has matching type code
      * CASE: PAR.Record Selected       USR is yes
     C           YL0011    IFEQ 'Y'                        *IF
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTB     READE@BFCPR4                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Type Code by Cust  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EOBKC7    WQTC01           Ship To Custome
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Ship To Custome
      * Setup key
     C                     Z-ADDWL0059    WQTC01           Ship To Custome
      * Establish starting position
     C           KRSTC     SETLL@EOREIQ                    *
     C           KRSTC     READE@EOREIQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0060           Type Code
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    WL0060           Type Code
     C           KRSTC     READE@EOREIQ                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Cust&CType-LdOrd  RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0013  2        Type Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQTD02           Load ID
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD02           Load ID
      * Setup key
     C                     Z-ADDWHRMNB    WQTD02           Load ID
      * Establish starting position
     C           KRSTD     SETLL@BFCPRQ                    *
     C           KRSTD     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Type Code by Cust  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIBKC7    WL0059           Ship To Custome
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    WN0013    P      Type Code
      * CASE: PAR.Type Code EQ PAR.Trans Type 1 PASS     USR
     C           WN0013    IFEQ P6ZSST                     *IF
     C                     MOVEL'Y'       YL0011           Record Selected
     C                     GOTO TDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTD     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV VAL Ltr of Crdt    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0063           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQTE01           Load ID
      * Define keylist
     C           KPSTE     KLIST
     C                     KFLD           WQTE01           Load ID
     C                     KFLD           WCC4NB           Order Number
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Load ID
      * Setup key
     C                     Z-ADDWL0062    WQTE01           Load ID
     C                     Z-ADDWL0061    WCC4NB           Order Number
      * Establish starting position
     C           KPSTE     SETLL@AMREJM                    *
     C           KRSTE     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** Pass back if a Letter of Credit Number was found or not
      * CASE: DB1.Letter of Credit Number is Not entered
     C           WCWDT1    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WL0063           Record Found US
     C                     END                             *FI
     C           KRSTE     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ** Print multiple country codes
      *================================================================
     C                     MOVELP4KIAA    $BKIAA           Country Code 1
     C                     MOVELP4KJAA    $BKJAA           Country Code 2
     C                     MOVELP4KKAA    $BKKAA           Country Code 3
     C                     MOVELP4KLAA    $BKLAA           Country Code 4
     C                     MOVELP4KMAA    $BKMAA           Country Code 5
     C                     MOVELP4KNAA    $BKNAA           Country Code 6
     C                     MOVELP4NHAA    $BNHAA           Country Code 7
     C                     MOVELP4NIAA    $BNIAA           Country Code 8
     C                     MOVELP4NJAA    $BNJAA           Country Code 9
     C                     MOVELP4NKAA    $BNKAA           Country Code 10
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ** Print multiple Carrier Codes
      *================================================================
     C                     MOVELP7NLAA    $BNLAA           Carrier Code Us
     C                     MOVELP7NMAA    $BNMAA           Carrier Code Us
     C                     MOVELP7NNAA    $BNNAA           Carrier Code Us
     C                     MOVELP7NOAA    $BNOAA           Carrier Code Us
     C                     MOVELP7NPAA    $BNPAA           Carrier Code Us
     C                     MOVELP7NQAA    $BNQAA           Carrier Code Us
     C                     MOVELP7NRAA    $BNRAA           Carrier Code Us
     C                     MOVELP7NSAA    $BNSAA           Carrier Code Us
     C                     MOVELP7NTAA    $BNTAA           Carrier Code Us
     C                     MOVELP7NUAA    $BNUAA           Carrier Code Us
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ** Print multiple Shipping Lines
      *================================================================
     C                     MOVELP7N0AA    $BN0AA           Carrier Code Us
     C                     MOVELP7NWAA    $BNWAA           Carrier Code Us
     C                     MOVELP7NXAA    $BNXAA           Carrier Code Us
     C                     MOVELP7NYAA    $BNYAA           Carrier Code Us
     C                     MOVELP7NZAA    $BNZAA           Carrier Code Us
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Load Customer - A/R or Ship To, based on customer type  E002587
      *================================================================
     C                     Z-ADDP2SHTC    $BBKC7           Ship To Custome
      * CASE: TOP.Ship To Customer is equal to zero
     C           $BBKC7    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    $BAYTX           Customer Name
     C                     MOVEL'*All'    $BAYTX           Customer Name
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Name Only          RT - Customer  * 
     C                     EXSR SERVGN
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Format dashes between heading and first record on each page
      *================================================================
     C                     MOVEL@CN,006   WUCWTX           @Text 25
     C                     MOVEL*BLANK    $BHHT1           @Dashes Line Us
     C                     MOVELWUCWTX    $BHHT1           @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $BHHT1    CAT  WUCWTX:ZQ $BHHT1    P      @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $BHHT1    CAT  WUCWTX:ZQ $BHHT1    P      @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $BHHT1    CAT  WUCWTX:ZQ $BHHT1    P      @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $BHHT1    CAT  WUCWTX:ZQ $BHHT1    P      @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $BHHT1    CAT  WUCWTX:ZQ $BHHT1    P      @Dashes Line Us
     C                     Z-ADD0         ZQ      50
     C           $BHHT1    CAT  @CN,007:ZQ$BHHT1    P      @Dashes Line Us
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Crt LdOrdDt Wts/WF PO
      *================================================================
      * PRT Crt LdOrdDt Wts/WF PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * ** Clear work variables
      *================================================================
     C                     Z-ADD*ZERO     YL0001           USR Weight   9.
     C                     Z-ADD*ZERO     YL0002           USR Quantity, 9
     C                     Z-ADD*ZERO     YL0003           USR Weight Accu
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Crt OHE/LD WF      PO
      *================================================================
      * * NOTE: The Print Obj also creates the Work File if OHE exists
      * *    The OHE rec is now created in Order Entry so it always exist
      * * Carrier Broker contains the Accrual Broker code (SEI for Sumi)
      * * Set flag if OHE record, else leave "No"
      * * Whse Type and Type of Customer added                E002587
      * * Letter of Credit added                              E002768
     C                     MOVEL'N'       WUUFL2           USR Flag 2
      *
     C                     MOVEL*BLANK    WN0001 30        OHE Vessel/Airl
     C                     Z-ADD*ZERO     WN0002  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0003  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0004  3        Shipping Line
     C                     MOVEL*BLANK    WN0005 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0006  2        Sail Port State
     C                     MOVEL*BLANK    WN0007 25        OHE City
     C                     MOVEL*BLANK    WN0008 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0009 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0010 12        OHE Container N
     C                     MOVEL*BLANK    WN0011 20        OHE Discharge P
     C                     MOVEL*BLANK    WN0012 50        Letter of Credi
      *
      * PRT Crt OHE/LD WF      PO: Mainline
     C                     EXSR C0MAIN
      * * The following should never execute since OHE is added in Order
      * If no OHE record, write the work file record here.
      * CASE: WRK.USR Flag 2 is No
     C           WUUFL2    IFEQ 'N'                        *IF
      * 07/19/19 DN R15161-Recreate WF Record Due to File Change.
      * CRT WF OHE & Load Rpt  CR - WF OHE & Load Rpt Info  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$FAIC3    WL0003           Company Number
     C                     MOVEL$FAYTX    WL0004    P      Customer Name
     C                     Z-ADD$FRMNB    WL0005           Load ID
     C                     Z-ADD$FC4NB    WL0006           Order Number
     C                     MOVEL*BLANK    WL0007           OHE Vessel/Airl
     C                     Z-ADD*ZERO     WL0008           OHE Sail/Flight
     C                     Z-ADD$EAODT    WL0009           Scheduled Ship
     C                     Z-ADD*ZERO     WL0010           OHE Arrival Dat
     C                     MOVEL*BLANK    WL0011           Shipping Line
     C                     MOVEL*BLANK    WL0012           Port Delv Termi
     C                     MOVEL*BLANK    WL0013           Sail Port State
     C                     MOVEL$FAJCD    WL0014    P      Warehouse Code
     C                     MOVEL*BLANK    WL0015           OHE City
     C                     MOVEL*BLANK    WL0016           OHE Voyage/Flig
     C                     MOVEL*BLANK    WL0017           OHE Booking Num
     C                     MOVEL*BLANK    WL0018           OHE Container N
     C                     MOVEL*BLANK    WL0019           OHE Discharge P
     C                     MOVEL$FBCNA    WL0020    P      Customer Purcha
     C                     MOVEL$FBYNA    WL0021    P      Special Instruc
     C                     MOVEL$FB6NA    WL0022    P      Special Instruc
     C                     MOVEL$FMHNA    WL0023    P      Special Comment
     C                     Z-ADD$FZ4NB    WL0024           MPC Number
     C                     Z-ADD$FJZVA    WL0025           Order Value Tot
     C                     Z-ADD$FA1WG    WL0026           Order Weight To
     C                     Z-ADD$FEVWG    WL0027           Net Weight Kilo
     C                     Z-ADDYL0010    WL0028           Quantity Ordere
     C                     Z-ADDYL0004    WL0029           Quantity Schedu
     C                     Z-ADD$EGRWE    WL0030           Gross Weight
     C                     Z-ADD$FF0WG    WL0031           Gross Weight Or
     C                     MOVEL$EXCCD    WL0032    P      Broker Code
     C                     Z-ADD$FE9WG    WL0033           Gross Weight Ki
     C                     MOVEL$FKXCD    WL0034    P      Country Code
     C                     Z-ADDWUANC7    WL0035           A/R Customer Nu
     C                     Z-ADD$FD0C7    WL0036           Ship To Custome
     C                     MOVELP6ZSST    WL0037    P      Type Code
     C                     MOVELWUWPST    WL0038    P      Warehouse Type
     C                     MOVELWUZ0S1    WL0039    P      Type of Custome
     C                     MOVEL*BLANK    WL0040           Letter of Credi
     C                     MOVELYL0008    WL0041    P      ED Shipping Mar
     C                     EXSR SOCRRC
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Crt LdOrdDt Wts/WF PO: Initialise
      *================================================================
      * USER: Initialize program
      * * NOTE: The PRT Crt OHE/LD WF print object also creates the work
      * *    The OHE rec is now created in Order Entry so it always exist
      * * Carrier Broker contains the Accrual Broker code (SEI for Sumi)
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * PRT Crt OHE/LD WF      PO: Initialise
      *================================================================
      * USER: Initialize program
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1BZNA           Carrier Code
     C                     Z-ADD*ZERO     P3BKC7           Ship To Custome
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FJAODT           Scheduled Ship
     C                     MOVEL*LOVAL    FJBZNA           Carrier Code
      * Define work field USR Blank Field
     C                     MOVEL*BLANK    WUOINA  1
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Define work field Text USR 7
     C                     MOVEL*BLANK    WUY8TX  7
      * Define work field @Text 25
     C                     MOVEL*BLANK    WUCWTX 25
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FLRMNB           Load ID
     C                     MOVEL*LOVAL    FLC4NB           Order Number
      * Define work field A/R Customer Number
     C                     Z-ADD*ZERO     WUANC7  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Display Flag 1 USR
     C                     MOVEL*BLANK    WUDXSX  1
      * Define work field USR Flag 2
     C                     MOVEL*BLANK    WUUFL2  1
      * Define work field Type of Customer
     C                     MOVEL*BLANK    WUZ0S1  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AMAIC3           Company Number
     C                     MOVEL*LOVAL    AMC4NB           Order Number
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field Trailer Id
     C                     MOVEL*BLANK    WUDXTX 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field Shipping Line
     C                     MOVEL*BLANK    WUXACD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WCQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WCQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WCQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WCGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WCHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WCHGVL           Transload Termi
     C                     Z-ADD*ZERO     WCQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WCQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WCQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WCQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WCITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WCQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WCQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WCQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WCP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WCQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WCQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WCQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WCQENY           Original Appoin
     C                     Z-ADD*ZERO     WCQFNY           Original Appoin
     C                     Z-ADD*ZERO     WCQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WCQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WCW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Country Ord Found Sts USR
     C                     MOVEL*BLANK    WU      1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  2
      * Define local variables for subroutine SOCRRC.
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004 30
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007 30
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  70
     C                     MOVEL*BLANK    WL0011  3
     C                     MOVEL*BLANK    WL0012 20
     C                     MOVEL*BLANK    WL0013  2
     C                     MOVEL*BLANK    WL0014  3
     C                     MOVEL*BLANK    WL0015 25
     C                     MOVEL*BLANK    WL0016 15
     C                     MOVEL*BLANK    WL0017 15
     C                     MOVEL*BLANK    WL0018 12
     C                     MOVEL*BLANK    WL0019 20
     C                     MOVEL*BLANK    WL0020 15
     C                     MOVEL*BLANK    WL0021 40
     C                     MOVEL*BLANK    WL0022 40
     C                     MOVEL*BLANK    WL0023 30
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027  71
     C                     Z-ADD*ZERO     WL0028 112
     C                     Z-ADD*ZERO     WL0029 112
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  71
     C                     MOVEL*BLANK    WL0032  6
     C                     Z-ADD*ZERO     WL0033  71
     C                     MOVEL*BLANK    WL0034  6
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037  2
     C                     MOVEL*BLANK    WL0038  2
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040 50
     C                     MOVEL*BLANK    WL0041 15
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0042  70
     C                     MOVEL*BLANK    WL0043  6
     C                     MOVEL*BLANK    WL0044  1
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046  3
     C                     MOVEL*BLANK    WL0047  1
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  70
     C                     MOVEL*BLANK    WL0050 15
     C                     MOVEL*BLANK    WL0051  1
      * Define local variables for subroutine SZRVGN.
     C                     MOVEL*BLANK    WL0052  3
     C                     Z-ADD*ZERO     WL0053  70
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  70
     C                     MOVEL*BLANK    WL0056 30
     C                     MOVEL*BLANK    WL0057  2
     C                     MOVEL*BLANK    WL0058  3
      * Define local variables for subroutine TCRVGN.
     C                     Z-ADD*ZERO     WL0059  70
     C                     MOVEL*BLANK    WL0060  2
      * Define local variables for subroutine TERVGN.
     C                     Z-ADD*ZERO     WL0061  70
     C                     Z-ADD*ZERO     WL0062  70
     C                     MOVEL*BLANK    WL0063  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field USR Weight   9.1
     C                     Z-ADD*ZERO     YL0001  91
      * Define local work field USR Quantity, 9.0
     C                     Z-ADD*ZERO     YL0002  90
      * Define local work field USR Weight Accumulated
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0005 112
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0006 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0007  2
      * Define null work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YN0008 11
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0009  70
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0010 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0011 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0012 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0013 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0014 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0015  2
      * Define null work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YN0016 11
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0017  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0018  70
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0019  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0020  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0021  2
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0023  1
      * Define null work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0027  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0028  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0029  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0030  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0032  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0033 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0034  70
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0038  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0039  40
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0040  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0041 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0042  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0043  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0044 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0048  2
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0006  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0049  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0050  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0051  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0052  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0053  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0054  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0055  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0056  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0057  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0058  70
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0059 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0060  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0061  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0062  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0063  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0064  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0065  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0066  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0067  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0068  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0069  2
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0071  1
      * Define null work field A/R order Value Total
     C                     Z-ADD*ZERO     YN0072 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0073  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0074  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0075  1
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0076  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0077  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0078  1
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0007  92
      * Define local work field ED Shipping Marks Txt
     C                     MOVEL*BLANK    YL0008 15
      * Define local work field USR Flag 1
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0010 112
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Select Status
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0014  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0079 30
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0080  2
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0081  3
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0015  2
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0016  2
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     Z-ADDP2SHTC    P3BKC7           Ship To Custome
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Bill To
00002 Ship To
00003 Frozen
00004 Chilled
00005 FZ & CH
00006 -------------------------
00007 ------------
00008 Y2U0005
