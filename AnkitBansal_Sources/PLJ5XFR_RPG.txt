     H/TITLE Prg Buy Order Header  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:30:17
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKAWCPLFIF  E           K        DISK
      * RSQ : Buy Order Header          KDte(d)/Co
      *
     FPKAYCPL1IF  E           K        DISK
      * RTV : Buy Order Comment         Retrieval index
      *
     FPKAYCPL3IF  E           K        DISK                      A
      * UPD : Buy Order Comment         Update index for Purge
      *
     FPKAYCPL0UF  E           K        DISK
      * UPD : Buy Order Comment         Update index
      *
     FPKAWCPLIIF  E           K        DISK                      A
      * UPD : Buy Order Header          Update index for Purge
      *
     FPKAWCPL0UF  E           K        DISK
      * UPD : Buy Order Header          Update index
      *
     I@AWCPE8
      * Buy Order Header          KDte(d)/Co
      * Renamed input format fields
     I              AWHMNB                          WAHMNB
     I              AWBNNB                          WABNNB
     I              AWARDT                          WAARDT
     I              AWASDT                          WAASDT
     I              AWA4ST                          WAA4ST
     I              AWA5ST                          WAA5ST
     I              AWAAPR                          WAAAPR
     I              AWA6ST                          WAA6ST
     I              AWA7ST                          WAA7ST
     I              AWB3ST                          WAB3ST
     I              AWALPR                          WAALPR
     I              AWETCD                          WAETCD
     I              AWEUCD                          WAEUCD
     I              AWJ5TX                          WAJ5TX
     I              AWD5DT                          WAD5DT
     I              AWD6DT                          WAD6DT
     I              AWD7DT                          WAD7DT
     I              AWD8DT                          WAD8DT
     I              AWD9DT                          WAD9DT
     I              AWJOEJ                          WAJOEJ
     I              AWKOFF                          WAKOFF
     I              AWKWPE                          WAKWPE
     I              AWIMBF                          WAIMBF
     I              AWOPTR                          WAOPTR
     I              AWOEJD                          WAOEJD
     I              AWIRMF                          WAIRMF
     I              AWJIRM                          WAJIRM
     I              AWJRKF                          WAJRKF
     I              AWKFIR                          WAKFIR
     I              AWUZST                          WAUZST
     I              AWU0ST                          WAU0ST
     I              AWU1ST                          WAU1ST
     I              AWU2ST                          WAU2ST
     I              AWU3ST                          WAU3ST
     I              AWHXNB                          WAHXNB
     I              AWGANB                          WAGANB
     I              AWGBNB                          WAGBNB
     I              AWABCD                          WAABCD
     I              AWAECD                          WAAECD
     I              AWAKCD                          WAAKCD
     I              AWALCD                          WAALCD
     I              AWAGCD                          WAAGCD
     I              AWAICD                          WAAICD
     I              AWAMCD                          WAAMCD
     I              AWACCD                          WAACCD
     I              AWAAVN                          WAAAVN
     I              AWAADT                          WAAADT
     I              AWAMTM                          WAAMTM
     I              AWAJST                          WAAJST
     I              AWAHVN                          WAAHVN
     I              AWAGVN                          WAAGVN
     I              AWABVN                          WAABVN
     I              AWABDT                          WAABDT
     I              AWABTM                          WAABTM
      *
     I@AYCPCB
      * Buy Order Comment         Retrieval index
      * Renamed input format fields
     I              AYHMNB                          WBHMNB
     I              AYBNNB                          WBBNNB
     I              AYBRNB                          WBBRNB
     I              AYA2TX                          WBA2TX
     I              AYEMST                          WBEMST
     I              AYAAVN                          WBAAVN
     I              AYAADT                          WBAADT
     I              AYAMTM                          WBAMTM
     I              AYAJST                          WBAJST
     I              AYAHVN                          WBAHVN
     I              AYAGVN                          WBAGVN
     I              AYABVN                          WBABVN
     I              AYABDT                          WBABDT
     I              AYABTM                          WBABTM
      *
     I@AYCPNG
      * Buy Order Comment         Update index for Purge
      * Renamed input format fields
     I              AYHMNB                          WCHMNB
     I              AYBNNB                          WCBNNB
     I              AYBRNB                          WCBRNB
     I              AYA2TX                          WCA2TX
     I              AYEMST                          WCEMST
     I              AYAAVN                          WCAAVN
     I              AYAADT                          WCAADT
     I              AYAMTM                          WCAMTM
     I              AYAJST                          WCAJST
     I              AYAHVN                          WCAHVN
     I              AYAGVN                          WCAGVN
     I              AYABVN                          WCABVN
     I              AYABDT                          WCABDT
     I              AYABTM                          WCABTM
      *
     I@AYCPCA
      * Buy Order Comment         Update index
      * Renamed input format fields
     I              AYHMNB                          WDHMNB
     I              AYBNNB                          WDBNNB
     I              AYBRNB                          WDBRNB
     I              AYA2TX                          WDA2TX
     I              AYEMST                          WDEMST
     I              AYAAVN                          WDAAVN
     I              AYAADT                          WDAADT
     I              AYAMTM                          WDAMTM
     I              AYAJST                          WDAJST
     I              AYAHVN                          WDAHVN
     I              AYAGVN                          WDAGVN
     I              AYABVN                          WDABVN
     I              AYABDT                          WDABDT
     I              AYABTM                          WDABTM
      *
     I@AWCPNF
      * Buy Order Header          Update index for Purge
      * Renamed input format fields
     I              AWHMNB                          WEHMNB
     I              AWBNNB                          WEBNNB
     I              AWARDT                          WEARDT
     I              AWASDT                          WEASDT
     I              AWA4ST                          WEA4ST
     I              AWA5ST                          WEA5ST
     I              AWAAPR                          WEAAPR
     I              AWA6ST                          WEA6ST
     I              AWA7ST                          WEA7ST
     I              AWB3ST                          WEB3ST
     I              AWALPR                          WEALPR
     I              AWETCD                          WEETCD
     I              AWEUCD                          WEEUCD
     I              AWJ5TX                          WEJ5TX
     I              AWD5DT                          WED5DT
     I              AWD6DT                          WED6DT
     I              AWD7DT                          WED7DT
     I              AWD8DT                          WED8DT
     I              AWD9DT                          WED9DT
     I              AWJOEJ                          WEJOEJ
     I              AWKOFF                          WEKOFF
     I              AWKWPE                          WEKWPE
     I              AWIMBF                          WEIMBF
     I              AWOPTR                          WEOPTR
     I              AWOEJD                          WEOEJD
     I              AWIRMF                          WEIRMF
     I              AWJIRM                          WEJIRM
     I              AWJRKF                          WEJRKF
     I              AWKFIR                          WEKFIR
     I              AWUZST                          WEUZST
     I              AWU0ST                          WEU0ST
     I              AWU1ST                          WEU1ST
     I              AWU2ST                          WEU2ST
     I              AWU3ST                          WEU3ST
     I              AWHXNB                          WEHXNB
     I              AWGANB                          WEGANB
     I              AWGBNB                          WEGBNB
     I              AWABCD                          WEABCD
     I              AWAECD                          WEAECD
     I              AWAKCD                          WEAKCD
     I              AWALCD                          WEALCD
     I              AWAGCD                          WEAGCD
     I              AWAICD                          WEAICD
     I              AWAMCD                          WEAMCD
     I              AWACCD                          WEACCD
     I              AWAAVN                          WEAAVN
     I              AWAADT                          WEAADT
     I              AWAMTM                          WEAMTM
     I              AWAJST                          WEAJST
     I              AWAHVN                          WEAHVN
     I              AWAGVN                          WEAGVN
     I              AWABVN                          WEABVN
     I              AWABDT                          WEABDT
     I              AWABTM                          WEABTM
      *
     I@AWCPAZ
      * Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WFHMNB
     I              AWBNNB                          WFBNNB
     I              AWARDT                          WFARDT
     I              AWASDT                          WFASDT
     I              AWA4ST                          WFA4ST
     I              AWA5ST                          WFA5ST
     I              AWAAPR                          WFAAPR
     I              AWA6ST                          WFA6ST
     I              AWA7ST                          WFA7ST
     I              AWB3ST                          WFB3ST
     I              AWALPR                          WFALPR
     I              AWETCD                          WFETCD
     I              AWEUCD                          WFEUCD
     I              AWJ5TX                          WFJ5TX
     I              AWD5DT                          WFD5DT
     I              AWD6DT                          WFD6DT
     I              AWD7DT                          WFD7DT
     I              AWD8DT                          WFD8DT
     I              AWD9DT                          WFD9DT
     I              AWJOEJ                          WFJOEJ
     I              AWKOFF                          WFKOFF
     I              AWKWPE                          WFKWPE
     I              AWIMBF                          WFIMBF
     I              AWOPTR                          WFOPTR
     I              AWOEJD                          WFOEJD
     I              AWIRMF                          WFIRMF
     I              AWJIRM                          WFJIRM
     I              AWJRKF                          WFJRKF
     I              AWKFIR                          WFKFIR
     I              AWUZST                          WFUZST
     I              AWU0ST                          WFU0ST
     I              AWU1ST                          WFU1ST
     I              AWU2ST                          WFU2ST
     I              AWU3ST                          WFU3ST
     I              AWHXNB                          WFHXNB
     I              AWGANB                          WFGANB
     I              AWGBNB                          WFGBNB
     I              AWABCD                          WFABCD
     I              AWAECD                          WFAECD
     I              AWAKCD                          WFAKCD
     I              AWALCD                          WFALCD
     I              AWAGCD                          WFAGCD
     I              AWAICD                          WFAICD
     I              AWAMCD                          WFAMCD
     I              AWACCD                          WFACCD
     I              AWAAVN                          WFAAVN
     I              AWAADT                          WFAADT
     I              AWAMTM                          WFAMTM
     I              AWAJST                          WFAJST
     I              AWAHVN                          WFAHVN
     I              AWAGVN                          WFAGVN
     I              AWABVN                          WFABVN
     I              AWABDT                          WFABDT
     I              AWABTM                          WFABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKAY1    E DSPKAYCPL3
      * UPD : Buy Order Comment         Update index for Purge
      * Renamed input format fields
     I              AYHMNB                          WCHMNB
     I              AYBNNB                          WCBNNB
     I              AYBRNB                          WCBRNB
     I              AYA2TX                          WCA2TX
     I              AYEMST                          WCEMST
     I              AYAAVN                          WCAAVN
     I              AYAADT                          WCAADT
     I              AYAMTM                          WCAMTM
     I              AYAJST                          WCAJST
     I              AYAHVN                          WCAHVN
     I              AYAGVN                          WCAGVN
     I              AYABVN                          WCABVN
     I              AYABDT                          WCABDT
     I              AYABTM                          WCABTM
      *
     IQPKAY2    E DSPKAYCPL0
      * UPD : Buy Order Comment         Update index
      * Renamed input format fields
     I              AYHMNB                          WDHMNB
     I              AYBNNB                          WDBNNB
     I              AYBRNB                          WDBRNB
     I              AYA2TX                          WDA2TX
     I              AYEMST                          WDEMST
     I              AYAAVN                          WDAAVN
     I              AYAADT                          WDAADT
     I              AYAMTM                          WDAMTM
     I              AYAJST                          WDAJST
     I              AYAHVN                          WDAHVN
     I              AYAGVN                          WDAGVN
     I              AYABVN                          WDABVN
     I              AYABDT                          WDABDT
     I              AYABTM                          WDABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKAW1    E DSPKAWCPLI
      * UPD : Buy Order Header          Update index for Purge
      * Renamed input format fields
     I              AWHMNB                          WEHMNB
     I              AWBNNB                          WEBNNB
     I              AWARDT                          WEARDT
     I              AWASDT                          WEASDT
     I              AWA4ST                          WEA4ST
     I              AWA5ST                          WEA5ST
     I              AWAAPR                          WEAAPR
     I              AWA6ST                          WEA6ST
     I              AWA7ST                          WEA7ST
     I              AWB3ST                          WEB3ST
     I              AWALPR                          WEALPR
     I              AWETCD                          WEETCD
     I              AWEUCD                          WEEUCD
     I              AWJ5TX                          WEJ5TX
     I              AWD5DT                          WED5DT
     I              AWD6DT                          WED6DT
     I              AWD7DT                          WED7DT
     I              AWD8DT                          WED8DT
     I              AWD9DT                          WED9DT
     I              AWJOEJ                          WEJOEJ
     I              AWKOFF                          WEKOFF
     I              AWKWPE                          WEKWPE
     I              AWIMBF                          WEIMBF
     I              AWOPTR                          WEOPTR
     I              AWOEJD                          WEOEJD
     I              AWIRMF                          WEIRMF
     I              AWJIRM                          WEJIRM
     I              AWJRKF                          WEJRKF
     I              AWKFIR                          WEKFIR
     I              AWUZST                          WEUZST
     I              AWU0ST                          WEU0ST
     I              AWU1ST                          WEU1ST
     I              AWU2ST                          WEU2ST
     I              AWU3ST                          WEU3ST
     I              AWHXNB                          WEHXNB
     I              AWGANB                          WEGANB
     I              AWGBNB                          WEGBNB
     I              AWABCD                          WEABCD
     I              AWAECD                          WEAECD
     I              AWAKCD                          WEAKCD
     I              AWALCD                          WEALCD
     I              AWAGCD                          WEAGCD
     I              AWAICD                          WEAICD
     I              AWAMCD                          WEAMCD
     I              AWACCD                          WEACCD
     I              AWAAVN                          WEAAVN
     I              AWAADT                          WEAADT
     I              AWAMTM                          WEAMTM
     I              AWAJST                          WEAJST
     I              AWAHVN                          WEAHVN
     I              AWAGVN                          WEAGVN
     I              AWABVN                          WEABVN
     I              AWABDT                          WEABDT
     I              AWABTM                          WEABTM
      *
     IQPKAW2    E DSPKAWCPL0
      * UPD : Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WFHMNB
     I              AWBNNB                          WFBNNB
     I              AWARDT                          WFARDT
     I              AWASDT                          WFASDT
     I              AWA4ST                          WFA4ST
     I              AWA5ST                          WFA5ST
     I              AWAAPR                          WFAAPR
     I              AWA6ST                          WFA6ST
     I              AWA7ST                          WFA7ST
     I              AWB3ST                          WFB3ST
     I              AWALPR                          WFALPR
     I              AWETCD                          WFETCD
     I              AWEUCD                          WFEUCD
     I              AWJ5TX                          WFJ5TX
     I              AWD5DT                          WFD5DT
     I              AWD6DT                          WFD6DT
     I              AWD7DT                          WFD7DT
     I              AWD8DT                          WFD8DT
     I              AWD9DT                          WFD9DT
     I              AWJOEJ                          WFJOEJ
     I              AWKOFF                          WFKOFF
     I              AWKWPE                          WFKWPE
     I              AWIMBF                          WFIMBF
     I              AWOPTR                          WFOPTR
     I              AWOEJD                          WFOEJD
     I              AWIRMF                          WFIRMF
     I              AWJIRM                          WFJIRM
     I              AWJRKF                          WFJRKF
     I              AWKFIR                          WFKFIR
     I              AWUZST                          WFUZST
     I              AWU0ST                          WFU0ST
     I              AWU1ST                          WFU1ST
     I              AWU2ST                          WFU2ST
     I              AWU3ST                          WFU3ST
     I              AWHXNB                          WFHXNB
     I              AWGANB                          WFGANB
     I              AWGBNB                          WFGBNB
     I              AWABCD                          WFABCD
     I              AWAECD                          WFAECD
     I              AWAKCD                          WFAKCD
     I              AWALCD                          WFALCD
     I              AWAGCD                          WFAGCD
     I              AWAICD                          WFAICD
     I              AWAMCD                          WFAMCD
     I              AWACCD                          WFACCD
     I              AWAAVN                          WFAAVN
     I              AWAADT                          WFAADT
     I              AWAMTM                          WFAMTM
     I              AWAJST                          WFAJST
     I              AWAHVN                          WFAHVN
     I              AWAGVN                          WFAGVN
     I              AWABVN                          WFABVN
     I              AWABDT                          WFABDT
     I              AWABTM                          WFABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Purge Date USR
     I                                    P   1   40P1EPDT
     IP2PARM      DS
      * FLD: *Arrays
      * I : RST Purge Code
     I                                        1   3 P2N7CD
      * I : RST Library
     I                                        4  13 P2LBNM
      * I : RST Purge Application Code
     I                                       14  19 P2HWCD
      * I :  File
     I                                       20  29 P2A4VN
      * I :  Logical Name
     I                                       30  39 P2A8VN
      * I :  Tape Physical File
     I                                       40  49 P2A9VN
      * I :  Field Name
     I                                       50  55 P2A7VN
      * I :  Date Format
     I                                       56  65 P2VLTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1EPDT    PARM           WP0001  70       Purge Date USR
     C           P2N7CD    PARM           WP0002  3        Purge Code
     C           P2LBNM    PARM           WP0003 10        Library
     C           P2HWCD    PARM           WP0004  6        Purge Applicati
     C           P2A4VN    PARM           WP0005 10        File
     C           P2A8VN    PARM           WP0006 10        Logical Name
     C           P2A9VN    PARM           WP0007 10        Tape Physical F
     C           P2A7VN    PARM           WP0008  6        Field Name
     C           P2VLTX    PARM           WP0009 10        Date Format
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prg Buy Order Header  XF
      * Modifications
      * 11/05/2020 ISE H16853 - Recompiled due to change in Buy Order Num
      * Prg Buy Order Header  RT - Buy Order Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Prg Buy Order Header  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change log and comments
     C                     EXSR UASUBR                     ***** Change lo
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAASDT           BOH Kill Date
      * Setup key
     C                     Z-ADDP1EPDT    WAASDT           BOH Kill Date
      * Establish starting position
     C           KPSSA     SETLL@AWCPE8                    *
     C                     READ @AWCPE8                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** 03/13/2009 LJB FP1009 Skip, this file is not being used
      * ** 10/23/2018 JBB E13947 Reinstate, Triumph Foods uses this file
      * Prg Buy Order Comment RT - Buy Order Comment  * 
     C                     EXSR SBRVGN
      * CRT Buy Order Hdr Purge - Buy Order Header  * 
     C                     EXSR SECRRC
      * Dlt Buy Order Header  DL - Buy Order Header  * 
     C                     EXSR SFDLRC
     C                     READ @AWCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Prg Buy Order Comment RT - Buy Order Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSB02           BOH Buy Order N
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WQSB01           BOH Company Num
     C                     Z-ADDWABNNB    WQSB02           BOH Buy Order N
      * Establish starting position
     C           KRSSB     SETLL@AYCPCB                    *
     C           KRSSB     READE@AYCPCB                  90*
      * Data record not found
     C   90                MOVEL'PRK0053' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT BO Comment for Purge - Buy Order Comment  * 
     C                     EXSR SCCRRC
      * Dlt BO Comment        DL - Buy Order Comment  * 
     C                     EXSR SDDLRC
     C           KRSSB     READE@AYCPCB                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * CRT BO Comment for Purge - Buy Order Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AYCPNG
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBRNB    WCBRNB           BOC Comment Lin
     C                     MOVELWBA2TX    WCA2TX           BOC Comment
     C                     MOVELWBEMST    WCEMST           BOC Comment Typ
     C                     MOVELWBAAVN    WCAAVN           RS User Changed
     C                     Z-ADDWBAADT    WCAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WCAMTM           RS Time Changed
     C                     MOVELWBAJST    WCAJST           RS Record Statu
     C                     MOVELWBAHVN    WCAHVN           RS Job
     C                     MOVELWBAGVN    WCAGVN           RS Program
     C                     MOVELWBABVN    WCABVN           RS User Added
     C                     Z-ADDWBABDT    WCABDT           RS Date Added
     C                     Z-ADDWBABTM    WCABTM           RS Time Added
      *
     C           KLCRSC    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBRNB           BOC Comment Lin
      * Check for duplicate primary key
     C           KLCRSC    SETLL@AYCPNG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0054' W0RTN   7
      * Send message 'Buy Order Comment      EX'
     C                     MOVEL'PRK0054' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@AYCPNG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Dlt BO Comment        DL - Buy Order Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AYCPCA
     C                     Z-ADDWBHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWBBRNB    WDBRNB           BOC Comment Lin
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBRNB           BOC Comment Lin
     C           KLDLSD    CHAIN@AYCPCA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAYCPL0'MDACP
     C                     MOVEL'@AYCPCA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AYCPCA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * CRT Buy Order Hdr Purge - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AWCPNF
     C                     Z-ADDWAHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWAARDT    WEARDT           BOH Buy Order D
     C                     Z-ADDWAASDT    WEASDT           BOH Kill Date
     C                     MOVELWAA4ST    WEA4ST           BOH Payment Typ
     C                     MOVELWAA5ST    WEA5ST           BOH Buy Order T
     C                     Z-ADDWAAAPR    WEAAPR           BOH Market Add/
     C                     MOVELWAA6ST    WEA6ST           BOH Status
     C                     MOVELWAA7ST    WEA7ST           BOH Delv Plan P
     C                     MOVELWAB3ST    WEB3ST           BOH Quote Price
     C                     Z-ADDWAALPR    WEALPR           BOH Quoted Base
     C                     MOVELWAETCD    WEETCD           BOH Commodity M
     C                     MOVELWAEUCD    WEEUCD           BOH Commodity P
     C                     MOVELWAJ5TX    WEJ5TX           BOH Market Date
     C                     Z-ADDWAD5DT    WED5DT           BOH MPR Reporti
     C                     Z-ADDWAD6DT    WED6DT           BOH Hedge Date
     C                     Z-ADDWAD7DT    WED7DT           BOH Unused Date
     C                     Z-ADDWAD8DT    WED8DT           BOH Unused Date
     C                     Z-ADDWAD9DT    WED9DT           BOH Unused Date
     C                     Z-ADDWAJOEJ    WEJOEJ           BOH Hedge Head
     C                     Z-ADDWAKOFF    WEKOFF           BOH Hedge Refer
     C                     Z-ADDWAKWPE    WEKWPE           BOH Hedge Time
     C                     Z-ADDWAIMBF    WEIMBF           BOH Unused Nbr
     C                     Z-ADDWAOPTR    WEOPTR           BOH Unused Nbr
     C                     Z-ADDWAOEJD    WEOEJD           BOH Unused Nbr
     C                     Z-ADDWAIRMF    WEIRMF           BOH Unused Nbr
     C                     Z-ADDWAJIRM    WEJIRM           BOH Unused Nbr
     C                     Z-ADDWAJRKF    WEJRKF           BOH Unused Nbr
     C                     Z-ADDWAKFIR    WEKFIR           BOH Unused Nbr
     C                     MOVELWAUZST    WEUZST           BOH MPR Reporti
     C                     MOVELWAU0ST    WEU0ST           BOH MPR EST RPT
     C                     MOVELWAU1ST    WEU1ST           BOH MPR Purchas
     C                     MOVELWAU2ST    WEU2ST           BOH Status 4
     C                     MOVELWAU3ST    WEU3ST           BOH Status 5
     C                     Z-ADDWAHXNB    WEHXNB           PPWS Company Nu
     C                     Z-ADDWAGANB    WEGANB           CW Year
     C                     Z-ADDWAGBNB    WEGBNB           CW Week Number
     C                     MOVELWAABCD    WEABCD           PD Producer Cod
     C                     MOVELWAAECD    WEAECD           PL Location Cod
     C                     MOVELWAAKCD    WEAKCD           PC Contract Cod
     C                     MOVELWAALCD    WEALCD           PSC Sub-Contrac
     C                     MOVELWAAGCD    WEAGCD           GN Genetic Code
     C                     MOVELWAAICD    WEAICD           PO Option Code
     C                     MOVELWAAMCD    WEAMCD           CMP Program Cod
     C                     MOVELWAACCD    WEACCD           HB Buyer Code
     C                     MOVELWAAAVN    WEAAVN           RS User Changed
     C                     Z-ADDWAAADT    WEAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WEAMTM           RS Time Changed
     C                     MOVELWAAJST    WEAJST           RS Record Statu
     C                     MOVELWAAHVN    WEAHVN           RS Job
     C                     MOVELWAAGVN    WEAGVN           RS Program
     C                     MOVELWAABVN    WEABVN           RS User Added
     C                     Z-ADDWAABDT    WEABDT           RS Date Added
     C                     Z-ADDWAABTM    WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
      * Check for duplicate primary key
     C           KLCRSE    SETLL@AWCPNF                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0050' W0RTN   7
      * Send message 'Buy Order Header       EX'
     C                     MOVEL'PRK0050' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@AWCPNF                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Dlt Buy Order Header  DL - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AWCPAZ
     C                     Z-ADDWAHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WFBNNB           BOH Buy Order N
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C           KLDLSF    CHAIN@AWCPAZ              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAWCPL0'MDACP
     C                     MOVEL'@AWCPAZ' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AWCPAZ                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 01/23/2009 LJB FP1009
      * ** Removed QTEMP processing, write to Purge file in Purge Library
      * ** then delete
      * ** 08/16/2007 LJB FP1009
      * ** Changed RSQ lgl to put Kill Date first, removed company number
      * ** from input parms, Add CRT to write the records to QTEMP file
      * ** before deleting from production
      * - 10/23/2018 JBB E13962 - Purge Buy Order Comments
      *   Add logic to purge Buy Order Comment records.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WAARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WAASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WAAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WAALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WAD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WAD6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WAD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WAD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WAD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WAJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WAKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WAKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WAIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WAGANB           CW Year
     C                     Z-ADD*ZERO     WAGBNB           CW Week Number
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBRNB           BOC Comment Lin
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
