     H/TITLE BLD MTech Test Data   XP  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:35:40
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPLAECPL0IF  E           K        DISK
      * RTV : Delivery Sched Detail     Retrieval index
      *
     FPLBJCPL0IF  E           K        DISK                      A
      * UPD : Delivery Sched Detail UPL Update index
      *
     FPLAECPL1UF  E           K        DISK
      * UPD : Delivery Sched Detail     Update index
      *
     I@AECPIG
      * Delivery Sched Detail     Retrieval index
      * Renamed input format fields
     I              AEHONB                          WAHONB
     I              AEE0DT                          WAE0DT
     I              AEE6DT                          WAE6DT
     I              AEAGTH                          WAAGTH
     I              AEHZA1                          WAHZA1
     I              AEH0A1                          WAH0A1
     I              AEH1A1                          WAH1A1
     I              AEJ4CD                          WAJ4CD
     I              AEJ5CD                          WAJ5CD
     I              AELBCD                          WALBCD
     I              AELCCD                          WALCCD
     I              AEIOA1                          WAIOA1
     I              AEH2A1                          WAH2A1
     I              AEIJA1                          WAIJA1
     I              AEK9CD                          WAK9CD
     I              AEK8CD                          WAK8CD
     I              AEJ6CD                          WAJ6CD
     I              AEJ7CD                          WAJ7CD
     I              AEMGCD                          WAMGCD
     I              AEW1ST                          WAW1ST
     I              AEW2ST                          WAW2ST
     I              AEH3A1                          WAH3A1
     I              AEMECD                          WAMECD
     I              AEMFCD                          WAMFCD
     I              AEW4ST                          WAW4ST
     I              AEXWST                          WAXWST
     I              AEFRDT                          WAFRDT
     I              AEBOTH                          WABOTH
     I              AEE7DT                          WAE7DT
     I              AEAHTH                          WAAHTH
     I              AEE8DT                          WAE8DT
     I              AEAITH                          WAAITH
     I              AEXBST                          WAXBST
     I              AEXGST                          WAXGST
     I              AEXPST                          WAXPST
     I              AEXNST                          WAXNST
     I              AEXTST                          WAXTST
     I              AEXLST                          WAXLST
     I              AEW0ST                          WAW0ST
     I              AEYEST                          WAYEST
     I              AEFZDT                          WAFZDT
     I              AEB1TH                          WAB1TH
     I              AEAACD                          WAAACD
     I              AEABCD                          WAABCD
     I              AEAECD                          WAAECD
     I              AEHMNB                          WAHMNB
     I              AEBNNB                          WABNNB
     I              AEBONB                          WABONB
     I              AEY0A1                          WAY0A1
     I              AEY1A1                          WAY1A1
     I              AEDGT1                          WADGT1
     I              AEDHT1                          WADHT1
     I              AEIISS                          WAIISS
     I              AEAAVN                          WAAAVN
     I              AEAADT                          WAAADT
     I              AEAMTM                          WAAMTM
     I              AEAJST                          WAAJST
     I              AEAHVN                          WAAHVN
     I              AEAGVN                          WAAGVN
     I              AEABVN                          WAABVN
     I              AEABDT                          WAABDT
     I              AEABTM                          WAABTM
      *
     I@BJCPRJ
      * Delivery Sched Detail UPL Update index
      * Renamed input format fields
     I              BJTFA1                          WBTFA1
     I              BJAADX                          WBAADX
     I              BJTGA1                          WBTGA1
     I              BJTHA1                          WBTHA1
     I              BJTPA1                          WBTPA1
     I              BJGXDT                          WBGXDT
     I              BJGTDT                          WBGTDT
     I              BJB8TH                          WBB8TH
     I              BJTKA1                          WBTKA1
     I              BJPJCD                          WBPJCD
     I              BJPKCD                          WBPKCD
     I              BJPLCD                          WBPLCD
     I              BJPMCD                          WBPMCD
     I              BJTMA1                          WBTMA1
     I              BJPQCD                          WBPQCD
     I              BJPPCD                          WBPPCD
     I              BJPNCD                          WBPNCD
     I              BJPOCD                          WBPOCD
     I              BJPRCD                          WBPRCD
     I              BJPSCD                          WBPSCD
     I              BJE4SS                          WBE4SS
     I              BJTOA1                          WBTOA1
     I              BJPTCD                          WBPTCD
     I              BJPUCD                          WBPUCD
     I              BJE6SS                          WBE6SS
     I              BJGWDT                          WBGWDT
     I              BJCATH                          WBCATH
     I              BJGUDT                          WBGUDT
     I              BJB9TH                          WBB9TH
     I              BJGVDT                          WBGVDT
     I              BJCBTH                          WBCBTH
     I              BJABCD                          WBABCD
     I              BJAECD                          WBAECD
     I              BJHMNB                          WBHMNB
     I              BJBNNB                          WBBNNB
     I              BJBONB                          WBBONB
     I              BJYYA1                          WBYYA1
     I              BJYZA1                          WBYZA1
     I              BJDET1                          WBDET1
     I              BJDFT1                          WBDFT1
     I              BJIHSS                          WBIHSS
     I              BJFFSS                          WBFFSS
     I              BJFGSS                          WBFGSS
     I              BJFHSS                          WBFHSS
     I              BJPVCD                          WBPVCD
     I              BJPWCD                          WBPWCD
      *
     I@AECPIH
      * Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WCHONB
     I              AEE0DT                          WCE0DT
     I              AEE6DT                          WCE6DT
     I              AEAGTH                          WCAGTH
     I              AEHZA1                          WCHZA1
     I              AEH0A1                          WCH0A1
     I              AEH1A1                          WCH1A1
     I              AEJ4CD                          WCJ4CD
     I              AEJ5CD                          WCJ5CD
     I              AELBCD                          WCLBCD
     I              AELCCD                          WCLCCD
     I              AEIOA1                          WCIOA1
     I              AEH2A1                          WCH2A1
     I              AEIJA1                          WCIJA1
     I              AEK9CD                          WCK9CD
     I              AEK8CD                          WCK8CD
     I              AEJ6CD                          WCJ6CD
     I              AEJ7CD                          WCJ7CD
     I              AEMGCD                          WCMGCD
     I              AEW1ST                          WCW1ST
     I              AEW2ST                          WCW2ST
     I              AEH3A1                          WCH3A1
     I              AEMECD                          WCMECD
     I              AEMFCD                          WCMFCD
     I              AEW4ST                          WCW4ST
     I              AEXWST                          WCXWST
     I              AEFRDT                          WCFRDT
     I              AEBOTH                          WCBOTH
     I              AEE7DT                          WCE7DT
     I              AEAHTH                          WCAHTH
     I              AEE8DT                          WCE8DT
     I              AEAITH                          WCAITH
     I              AEXBST                          WCXBST
     I              AEXGST                          WCXGST
     I              AEXPST                          WCXPST
     I              AEXNST                          WCXNST
     I              AEXTST                          WCXTST
     I              AEXLST                          WCXLST
     I              AEW0ST                          WCW0ST
     I              AEYEST                          WCYEST
     I              AEFZDT                          WCFZDT
     I              AEB1TH                          WCB1TH
     I              AEAACD                          WCAACD
     I              AEABCD                          WCABCD
     I              AEAECD                          WCAECD
     I              AEHMNB                          WCHMNB
     I              AEBNNB                          WCBNNB
     I              AEBONB                          WCBONB
     I              AEY0A1                          WCY0A1
     I              AEY1A1                          WCY1A1
     I              AEDGT1                          WCDGT1
     I              AEDHT1                          WCDHT1
     I              AEIISS                          WCIISS
     I              AEAAVN                          WCAAVN
     I              AEAADT                          WCAADT
     I              AEAMTM                          WCAMTM
     I              AEAJST                          WCAJST
     I              AEAHVN                          WCAHVN
     I              AEAGVN                          WCAGVN
     I              AEABVN                          WCABVN
     I              AEABDT                          WCABDT
     I              AEABTM                          WCABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPLBJ1    E DSPLBJCPL0
      * UPD : Delivery Sched Detail UPL Update index
      * Renamed input format fields
     I              BJTFA1                          WBTFA1
     I              BJAADX                          WBAADX
     I              BJTGA1                          WBTGA1
     I              BJTHA1                          WBTHA1
     I              BJTPA1                          WBTPA1
     I              BJGXDT                          WBGXDT
     I              BJGTDT                          WBGTDT
     I              BJB8TH                          WBB8TH
     I              BJTKA1                          WBTKA1
     I              BJPJCD                          WBPJCD
     I              BJPKCD                          WBPKCD
     I              BJPLCD                          WBPLCD
     I              BJPMCD                          WBPMCD
     I              BJTMA1                          WBTMA1
     I              BJPQCD                          WBPQCD
     I              BJPPCD                          WBPPCD
     I              BJPNCD                          WBPNCD
     I              BJPOCD                          WBPOCD
     I              BJPRCD                          WBPRCD
     I              BJPSCD                          WBPSCD
     I              BJE4SS                          WBE4SS
     I              BJTOA1                          WBTOA1
     I              BJPTCD                          WBPTCD
     I              BJPUCD                          WBPUCD
     I              BJE6SS                          WBE6SS
     I              BJGWDT                          WBGWDT
     I              BJCATH                          WBCATH
     I              BJGUDT                          WBGUDT
     I              BJB9TH                          WBB9TH
     I              BJGVDT                          WBGVDT
     I              BJCBTH                          WBCBTH
     I              BJABCD                          WBABCD
     I              BJAECD                          WBAECD
     I              BJHMNB                          WBHMNB
     I              BJBNNB                          WBBNNB
     I              BJBONB                          WBBONB
     I              BJYYA1                          WBYYA1
     I              BJYZA1                          WBYZA1
     I              BJDET1                          WBDET1
     I              BJDFT1                          WBDFT1
     I              BJIHSS                          WBIHSS
     I              BJFFSS                          WBFFSS
     I              BJFGSS                          WBFGSS
     I              BJFHSS                          WBFHSS
     I              BJPVCD                          WBPVCD
     I              BJPWCD                          WBPWCD
      *
     IQPLAE1    E DSPLAECPL1
      * UPD : Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WCHONB
     I              AEE0DT                          WCE0DT
     I              AEE6DT                          WCE6DT
     I              AEAGTH                          WCAGTH
     I              AEHZA1                          WCHZA1
     I              AEH0A1                          WCH0A1
     I              AEH1A1                          WCH1A1
     I              AEJ4CD                          WCJ4CD
     I              AEJ5CD                          WCJ5CD
     I              AELBCD                          WCLBCD
     I              AELCCD                          WCLCCD
     I              AEIOA1                          WCIOA1
     I              AEH2A1                          WCH2A1
     I              AEIJA1                          WCIJA1
     I              AEK9CD                          WCK9CD
     I              AEK8CD                          WCK8CD
     I              AEJ6CD                          WCJ6CD
     I              AEJ7CD                          WCJ7CD
     I              AEMGCD                          WCMGCD
     I              AEW1ST                          WCW1ST
     I              AEW2ST                          WCW2ST
     I              AEH3A1                          WCH3A1
     I              AEMECD                          WCMECD
     I              AEMFCD                          WCMFCD
     I              AEW4ST                          WCW4ST
     I              AEXWST                          WCXWST
     I              AEFRDT                          WCFRDT
     I              AEBOTH                          WCBOTH
     I              AEE7DT                          WCE7DT
     I              AEAHTH                          WCAHTH
     I              AEE8DT                          WCE8DT
     I              AEAITH                          WCAITH
     I              AEXBST                          WCXBST
     I              AEXGST                          WCXGST
     I              AEXPST                          WCXPST
     I              AEXNST                          WCXNST
     I              AEXTST                          WCXTST
     I              AEXLST                          WCXLST
     I              AEW0ST                          WCW0ST
     I              AEYEST                          WCYEST
     I              AEFZDT                          WCFZDT
     I              AEB1TH                          WCB1TH
     I              AEAACD                          WCAACD
     I              AEABCD                          WCABCD
     I              AEAECD                          WCAECD
     I              AEHMNB                          WCHMNB
     I              AEBNNB                          WCBNNB
     I              AEBONB                          WCBONB
     I              AEY0A1                          WCY0A1
     I              AEY1A1                          WCY1A1
     I              AEDGT1                          WCDGT1
     I              AEDHT1                          WCDHT1
     I              AEIISS                          WCIISS
     I              AEAAVN                          WCAAVN
     I              AEAADT                          WCAADT
     I              AEAMTM                          WCAMTM
     I              AEAJST                          WCAJST
     I              AEAHVN                          WCAHVN
     I              AEAGVN                          WCAGVN
     I              AEABVN                          WCABVN
     I              AEABDT                          WCABDT
     I              AEABTM                          WCABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Date Alpha USR
     I                                        1   7 P1CZCD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1CZCD    PARM           WP0001  7        Date Alpha USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BLD MTech Test Data   XP
      *  5/08/2018 JBB E31600 - Recompiled for Audit Stamp inclusion
      * 11/04/2020 ISE H16853 - Recompiled due to change in Buy Order Num
     C                     Z-ADD440       WUHONB           CC Company Numb
     C                     MOVE P1CZCD    WUE0DT           DSH Kill Date
      * RTV Bld MTech Test DataRT - Delivery Sched Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Bld MTech Test DataRT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHONB    WQSA01           CC Company Numb
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
     C                     KFLD           WAE0DT           DSH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
      * Setup key
     C                     Z-ADDWUHONB    WQSA01           CC Company Numb
     C                     Z-ADDWUE0DT    WAE0DT           DSH Kill Date
      * Establish starting position
     C           KPSSA     SETLL@AECPIG                    *
     C           KRSSA     READE@AECPIG                  90*
      * Data record not found
     C   90                MOVEL'PRK1028' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.SR Source Code is Seaboard
     C           WAAACD    IFEQ 'SBD'                      *IF
      * CASE: DB1.DSD Movement Number is Entered
     C           WAH3A1    IFNE 0                          *IF
     C                     ADD  1         WUTHA1           DSU Transaction
     C           WAH3A1    SUB  2000000   WUTOA1           DSU Movement Nu
      * Crt Delivery Sched DetUCR - Delivery Sched Detail UPL  * 
     C                     EXSR SBCRRC
      * Del Delv Sched Dtl    DL - Delivery Sched Detail  * 
     C                     EXSR SCDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Delv Sched Dtl    DL - Delivery Sched Detail  * 
     C                     EXSR SDDLRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@AECPIG                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt Delivery Sched DetUCR - Delivery Sched Detail UPL  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        DSU Record Stat
     C                     Z-ADD*ZERO     WN0002  70       DSU Change Date
     C                     Z-ADD*ZERO     WN0003  60       DSU Change Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BJCPRJ
     C                     Z-ADDWUHONB    WBTFA1           DSU Company Num
     C                     Z-ADD##JDT     WBAADX           DSU Transaction
     C                     Z-ADD##JTM     WBTGA1           DSU Transaction
     C                     Z-ADDWUTHA1    WBTHA1           DSU Transaction
     C                     Z-ADD1         WBTPA1           DSU Split Seque
     C                     Z-ADDWAE0DT    WBGXDT           DSU Kill Date
     C                     Z-ADDWAE6DT    WBGTDT           DSU Delivery Da
     C                     Z-ADDWAAGTH    WBB8TH           DSU Delivery Ti
     C                     Z-ADDWAH1A1    WBTKA1           DSU Farm Site C
     C                     MOVELWAJ4CD    WBPJCD           DSU Building
     C                     MOVELWAJ5CD    WBPKCD           DSU Room
     C                     MOVELWALBCD    WBPLCD           DSU Sire Line C
     C                     MOVELWALCCD    WBPMCD           DSU Hog Group C
     C                     Z-ADDWAH2A1    WBTMA1           DSU Scheduled D
     C                     MOVELWAK9CD    WBPQCD           UnUsed Status 5
     C                     MOVELWAK8CD    WBPPCD           UnUsed Code 5
     C                     MOVELWAJ6CD    WBPNCD           DSU Driver
     C                     MOVELWAJ7CD    WBPOCD           DSU Loading Cre
     C                     MOVELWAMGCD    WBPRCD           DSU Hauler Reas
     C                     MOVELWAW1ST    WBPSCD           DSU Load Type
     C                     MOVELWAW2ST    WBE4SS           DSU Full/Split
     C                     Z-ADDWUTOA1    WBTOA1           DSU Movement Nu
     C                     MOVELWAMECD    WBPTCD           DSU Truck ID
     C                     MOVELWAMFCD    WBPUCD           DSU Trailer ID
     C                     MOVELWAXWST    WBE6SS           DSU Sched Route
     C                     Z-ADDWAFRDT    WBGWDT           DSU Sched Route
     C                     Z-ADDWABOTH    WBCATH           DSU Sched Route
     C                     Z-ADDWAE7DT    WBGUDT           DSU Sch Farm Ar
     C                     Z-ADDWAAHTH    WBB9TH           DSU Sch Farm Ar
     C                     Z-ADDWAE8DT    WBGVDT           DSU Sch Start L
     C                     Z-ADDWAAITH    WBCBTH           DSU Sch Start L
     C                     MOVELWAABCD    WBABCD           PD Producer Cod
     C                     MOVELWAAECD    WBAECD           PL Location Cod
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWUYYA1    WBYYA1           DSU PRD Srv Bat
     C                     Z-ADDWUYZA1    WBYZA1           DSU PRD Srv Sch
     C                     MOVELWUDET1    WBDET1           DSU Ref 1
     C                     MOVELWUDFT1    WBDFT1           DSU Ref 2
     C                     MOVELWUIHSS    WBIHSS           DSU Ref Status
     C                     Z-ADDWUFGSS    WBFGSS           DSU Process Sta
     C                     MOVELWUFHSS    WBFHSS           DSU Error Reaso
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBFFSS           DSU Record Stat
     C                     Z-ADD##JDT     WBPVCD           DSU Change Date
     C                     Z-ADD##JTM     WBPWCD           DSU Change Time
     C           KLCRSB    KLIST
     C                     KFLD           WBTFA1           DSU Company Num
     C                     KFLD           WBAADX           DSU Transaction
     C                     KFLD           WBTGA1           DSU Transaction
     C                     KFLD           WBTHA1           DSU Transaction
      * Check for duplicate primary key
     C           KLCRSB    SETLL@BJCPRJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1276' W0RTN   7
      * Send message 'Delivery Sched 1309442'
     C                     MOVEL'PRK1276' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@BJCPRJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * Del Delv Sched Dtl    DL - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AECPIH
     C                     Z-ADDWAHONB    WCHONB           CC Company Numb
     C                     Z-ADDWAE0DT    WCE0DT           DSH Kill Date
     C                     Z-ADDWAE6DT    WCE6DT           DSD Delivery Da
     C                     Z-ADDWAAGTH    WCAGTH           DSD Delivery Ti
     C                     Z-ADDWAHZA1    WCHZA1           DSD Delivery Ti
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCE0DT           DSH Kill Date
     C                     KFLD           WCE6DT           DSD Delivery Da
     C                     KFLD           WCAGTH           DSD Delivery Ti
     C                     KFLD           WCHZA1           DSD Delivery Ti
     C           KLDLSC    CHAIN@AECPIH              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAECPL1'MDACP
     C                     MOVEL'@AECPIH' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AECPIH                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Del Delv Sched Dtl    DL - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AECPIH
     C                     Z-ADDWAHONB    WCHONB           CC Company Numb
     C                     Z-ADDWAE0DT    WCE0DT           DSH Kill Date
     C                     Z-ADDWAE6DT    WCE6DT           DSD Delivery Da
     C                     Z-ADDWAAGTH    WCAGTH           DSD Delivery Ti
     C                     Z-ADDWAHZA1    WCHZA1           DSD Delivery Ti
      *
     C           KLDLSD    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCE0DT           DSH Kill Date
     C                     KFLD           WCE6DT           DSD Delivery Da
     C                     KFLD           WCAGTH           DSD Delivery Ti
     C                     KFLD           WCHZA1           DSD Delivery Ti
     C           KLDLSD    CHAIN@AECPIH              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAECPL1'MDACP
     C                     MOVEL'@AECPIH' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AECPIH                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field CC Company Number
     C                     Z-ADD*ZERO     WUHONB  30
      * Define work field DSH Kill Date
     C                     Z-ADD*ZERO     WUE0DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WAE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WAE6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WAAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WAHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WAH0A1           DSD Scheduled H
     C                     Z-ADD*ZERO     WAH1A1           DSD Farm Site C
     C                     Z-ADD*ZERO     WAIOA1           DSD Unused Head
     C                     Z-ADD*ZERO     WAH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WAIJA1           DSD Scheduled K
     C                     Z-ADD*ZERO     WAH3A1           DSD Movement Nu
     C                     Z-ADD*ZERO     WAFRDT           DSD Sched Route
     C                     Z-ADD*ZERO     WABOTH           DSD Sched Route
     C                     Z-ADD*ZERO     WAE7DT           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WAAHTH           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WAE8DT           DSD Sch Start L
     C                     Z-ADD*ZERO     WAAITH           DSD Sch Start L
     C                     Z-ADD*ZERO     WAFZDT           DSD Unused Date
     C                     Z-ADD*ZERO     WAB1TH           DSD Unused Time
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WAY0A1           DSD PRD Srv Bat
     C                     Z-ADD*ZERO     WAY1A1           DSD PRD Srv Sch
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field DSU Transaction Seq
     C                     Z-ADD*ZERO     WUTHA1  50
      * Define work field DSU Movement Number
     C                     Z-ADD*ZERO     WUTOA1  70
      * Define work field DSU PRD Srv Batch ID
     C                     Z-ADD*ZERO     WUYYA1 100
      * Define work field DSU PRD Srv Sched ID
     C                     Z-ADD*ZERO     WUYZA1 100
      * Define work field DSU Ref 1
     C                     MOVEL*BLANK    WUDET1 10
      * Define work field DSU Ref 2
     C                     MOVEL*BLANK    WUDFT1 10
      * Define work field DSU Ref Status
     C                     MOVEL*BLANK    WUIHSS  2
      * Define work field DSU Process Status
     C                     Z-ADD*ZERO     WUFGSS  10
      * Define work field DSU Error Reason
     C                     MOVEL*BLANK    WUFHSS  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBTFA1           DSU Company Num
     C                     Z-ADD*ZERO     WBAADX           DSU Transaction
     C                     Z-ADD*ZERO     WBTGA1           DSU Transaction
     C                     Z-ADD*ZERO     WBTHA1           DSU Transaction
     C                     Z-ADD*ZERO     WBTPA1           DSU Split Seque
     C                     Z-ADD*ZERO     WBGXDT           DSU Kill Date
     C                     Z-ADD*ZERO     WBGTDT           DSU Delivery Da
     C                     Z-ADD*ZERO     WBB8TH           DSU Delivery Ti
     C                     Z-ADD*ZERO     WBTKA1           DSU Farm Site C
     C                     Z-ADD*ZERO     WBTMA1           DSU Scheduled D
     C                     Z-ADD*ZERO     WBTOA1           DSU Movement Nu
     C                     Z-ADD*ZERO     WBGWDT           DSU Sched Route
     C                     Z-ADD*ZERO     WBCATH           DSU Sched Route
     C                     Z-ADD*ZERO     WBGUDT           DSU Sch Farm Ar
     C                     Z-ADD*ZERO     WBB9TH           DSU Sch Farm Ar
     C                     Z-ADD*ZERO     WBGVDT           DSU Sch Start L
     C                     Z-ADD*ZERO     WBCBTH           DSU Sch Start L
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBYYA1           DSU PRD Srv Bat
     C                     Z-ADD*ZERO     WBYZA1           DSU PRD Srv Sch
     C                     Z-ADD*ZERO     WBFGSS           DSU Process Sta
     C                     Z-ADD*ZERO     WBPVCD           DSU Change Date
     C                     Z-ADD*ZERO     WBPWCD           DSU Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
