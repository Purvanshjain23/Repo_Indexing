     H/TITLE Crt Std Deviation     PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by  : COOL:2E  Version: 62050
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISPPATE
     H* Date          : 03/23/00  Time  : 14:44:52
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKUWPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Crt Std Deviation     PV  Prompt & validate record
      *
     FPKEYCPL1IF  E           K        DISK
      * RTV : Company Std Deviation     Retrieval index
      *
     FPKEYCPL0UF  E           K        DISK
      * UPD : Company Std Deviation     Update index
      *
     E                    YDOW        7  1               *Days of week
     I@EYCPEU
      * Company Std Deviation     Update index
      * Renamed input format fields
     I              EYALA1                          WAALA1
     I              EYV3ST                          WAV3ST
     I              EYENDT                          WAENDT
     I              EYEODT                          WAEODT
     I              EYV1ST                          WAV1ST
     I              EYH0CD                          WAH0CD
     I              EYH1CD                          WAH1CD
     I              EYAOA1                          WAAOA1
     I              EYAPA1                          WAAPA1
     I              EYAQA1                          WAAQA1
     I              EYH5PC                          WAH5PC
     I              EYARA1                          WAARA1
     I              EYAUA1                          WAAUA1
     I              EYASA1                          WAASA1
     I              EYH6PC                          WAH6PC
     I              EYATA1                          WAATA1
     I              EYH7PC                          WAH7PC
     I              EYAVA1                          WAAVA1
     I              EYAWA1                          WAAWA1
     I              EYANA1                          WAANA1
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPKEY1    E DSPKEYCPL0
      * UPD : Company Std Deviation     Update index
      * Renamed input format fields
     I              EYALA1                          WAALA1
     I              EYV3ST                          WAV3ST
     I              EYENDT                          WAENDT
     I              EYEODT                          WAEODT
     I              EYV1ST                          WAV1ST
     I              EYH0CD                          WAH0CD
     I              EYH1CD                          WAH1CD
     I              EYAOA1                          WAAOA1
     I              EYAPA1                          WAAPA1
     I              EYAQA1                          WAAQA1
     I              EYH5PC                          WAH5PC
     I              EYARA1                          WAARA1
     I              EYAUA1                          WAAUA1
     I              EYASA1                          WAASA1
     I              EYH6PC                          WAH6PC
     I              EYATA1                          WAATA1
     I              EYH7PC                          WAH7PC
     I              EYAVA1                          WAAVA1
     I              EYAWA1                          WAAWA1
     I              EYANA1                          WAANA1
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Oms Warehouse Code
     I                                        1   3 P1J8NB
      * N :  CC Company Number
     I                                    P   4   50P1HONB
      * N :  Oms Application Code
     I                                        6  11 P1C7CD
      * N :  Oms SalesPerson Code
     I                                       12  14 P1C8CD
      * N :  Oms Allow Multi-Company
     I                                       15  15 P1G8ST
      * N :  Oms Default Printer
     I                                       16  25 P1G9ST
      * N :  Oms Name
     I                                       26  55 P1EUTX
      * N :  Oms System Value Alpha
     I                                       56  95 P1EVTX
      * N :  Oms Access Denied (Y/N)
     I                                       96  96 P1HAST
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB              '    1 256 #S0001
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Date Required'
      * Date USR
     I                                    P   1   40ZA0001
      * Message data for 'Date Required'
      * Date USR
     I                                    P   1   40ZA0002
      * Message data for 'Invalid Company Number'
      * CC Company Number
     I                                    P   1   20ZA0003
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
     C                     MOVEL*BLANK    YL0001           Year Alpha Usr
     C                     MOVEL#DAMA1    YL0001           Year Alpha Usr
      * CASE: DTL.CSD Type is Other
     C           #1V3ST    IFEQ 'O'                        *IF
      * Del Std Deviation     RT - Company Std Deviation  * 
     C                     EXSR SARVGN
      * SBMJOB: Crt Std Deviation     UP - Company Std Deviation  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PKUUUPR '#SPRG  10 P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#1ALA1    #SPAK  309       CSD Company Num
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL#1V3ST    #SSTR     P      CSD Type
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#DB3DT    #SPAK  309       Date From USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#DB4DT    #SPAK  309       Date To   USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       CSD Month
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       CSD Week
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PKUUUPR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKUUUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993132*
     C                     END
     C                     ELSE
      * CASE: DTL.CSD Type is Monthly
     C           #1V3ST    IFEQ 'M'                        *IF
      * Monthly
      * CASE: DTL.CSD Month is Entered
     C           #1AWA1    IFNE *ZERO                      *IF
     C                     MOVEL#1AWA1    YL0002           Month Alpha USR
      * * From Date *
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0002    CAT  '01':ZQ   YL0003    P      Date From Conve
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0003    CAT  YL0001:ZQ YL0003    P      Date From Conve
      * Cvt Date              UP - STR Miscellaneous  * 
     C                     CALL 'PKPOUPR'              90  Cvt Date
     C                     PARM YL0003    WQ0001 10        Date From Conve
     C           YL0004    PARM *BLANK    WQ0002 11        Date To Convert
     C                     PARM '*MDYY'   WQ0003  8        Date From Forma
     C                     PARM '*CYMD'   WQ0004  8        Date To Format
     C                     PARM '*NONE'   WQ0005  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0004    YL0005           Date Alpha USR
     C                     MOVE YL0005    YL0006           CSD From Date
      * * To Date   *
      * LCL.Number 1 USR = LCL.CSD From Date *MONTH LENGTH
     C           YL0006    ADD  1000000   XDINDT
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     ADD  1         XDINMM
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0007
     C                     MOVELYL0007    YL0008           Length Usr Txt
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0002    CAT  YL0008:ZQ YL0003    P      Date From Conve
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0003    CAT  YL0001:ZQ YL0003    P      Date From Conve
      * Cvt Date              UP - STR Miscellaneous  * 
     C                     CALL 'PKPOUPR'              90  Cvt Date
     C                     PARM YL0003    WQ0006 10        Date From Conve
     C           YL0004    PARM *BLANK    WQ0007 11        Date To Convert
     C                     PARM '*MDYY'   WQ0008  8        Date From Forma
     C                     PARM '*CYMD'   WQ0009  8        Date To Format
     C                     PARM '*NONE'   WQ0010  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0004    YL0005           Date Alpha USR
     C                     MOVE YL0005    YL0009           CSD To Date
      * * Create Standard Deviation *
      * Del Std Deviation     RT - Company Std Deviation  * 
     C                     EXSR SCRVGN
      * SBMJOB: Crt Std Deviation     UP - Company Std Deviation  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PKUUUPR '#SPRG  10 P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#1ALA1    #SPAK  309       CSD Company Num
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL#1V3ST    #SSTR     P      CSD Type
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0006    #SPAK  309       Date From USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0009    #SPAK  309       Date To   USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1AWA1    #SPAK  309       CSD Month
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       CSD Week
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PKUUUPR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKUUUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993132*
     C                     SETON                     34    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD01        YL0007           Number 1 USR
      * LCL.Year USR = JOB.*Job date *YEAR
     C           ##JDT     ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0010
      * CASE: DTL.CSD Year LT LCL.Year USR
     C           #DAMA1    IFLT YL0010                     *IF
     C                     Z-ADD12        YL0011           Number 2 USR
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Number 2 USR = JOB.*Job date *MONTH
     C           ##JDT     ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0011
     C                     SUB  1         YL0011           Number 2 USR
     C                     END                             *FI
      * DO WHILE: LCL.Number 1 USR LE LCL.Number 2 USR
     C           YL0007    DOWLEYL0011                     *DOW
     C                     MOVELYL0007    YL0002           Month Alpha USR
      * * From Date *
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0002    CAT  '01':ZQ   YL0003    P      Date From Conve
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0003    CAT  YL0001:ZQ YL0003    P      Date From Conve
      * Cvt Date              UP - STR Miscellaneous  * 
     C                     CALL 'PKPOUPR'              90  Cvt Date
     C                     PARM YL0003    WQ0011 10        Date From Conve
     C           YL0004    PARM *BLANK    WQ0012 11        Date To Convert
     C                     PARM '*MDYY'   WQ0013  8        Date From Forma
     C                     PARM '*CYMD'   WQ0014  8        Date To Format
     C                     PARM '*NONE'   WQ0015  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0004    YL0005           Date Alpha USR
     C                     MOVE YL0005    YL0006           CSD From Date
      * * To Date   *
      * LCL.Number 3 USR = LCL.CSD From Date *MONTH LENGTH
     C           YL0006    ADD  1000000   XDINDT
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     ADD  1         XDINMM
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0012
     C                     MOVELYL0012    YL0008           Length Usr Txt
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0002    CAT  YL0008:ZQ YL0003    P      Date From Conve
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0003    CAT  YL0001:ZQ YL0003    P      Date From Conve
      * Cvt Date              UP - STR Miscellaneous  * 
     C                     CALL 'PKPOUPR'              90  Cvt Date
     C                     PARM YL0003    WQ0016 10        Date From Conve
     C           YL0004    PARM *BLANK    WQ0017 11        Date To Convert
     C                     PARM '*MDYY'   WQ0018  8        Date From Forma
     C                     PARM '*CYMD'   WQ0019  8        Date To Format
     C                     PARM '*NONE'   WQ0020  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0004    YL0005           Date Alpha USR
     C                     MOVE YL0005    YL0009           CSD To Date
      * * Create Standard Deviation *
      * Del Std Deviation     RT - Company Std Deviation  * 
     C                     EXSR SERVGN
      * SBMJOB: Crt Std Deviation     UP - Company Std Deviation  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PKUUUPR '#SPRG  10 P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#1ALA1    #SPAK  309       CSD Company Num
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL#1V3ST    #SSTR     P      CSD Type
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0006    #SPAK  309       Date From USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0009    #SPAK  309       Date To   USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0007    #SPAK  309       CSD Month
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       CSD Week
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PKUUUPR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKUUUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993132*
     C                     END
      * * Increment Month *
     C                     ADD  1         YL0007           Number 1 USR
     C                     END                             *ITR
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.CSD Type is Weekly
     C           #1V3ST    IFEQ 'W'                        *IF
      * Weekly
      * CASE: DTL.CSD Week is Entered
     C           #1ANA1    IFNE *ZERO                      *IF
      * RTV Wk Start/End      RT - STR Order Management Sys  * 
     C                     CALL 'POENXFR'              90  RTV Wk Start/En
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ALA1    WQ0021  30       CC Company Numb
     C                     PARM #DAMA1    WQ0022  40       CSD Year
     C                     PARM #1ANA1    WQ0023  20       CSD Week
     C           YL0006    PARM *ZERO     WQ0024  70       Date From USR
     C           YL0009    PARM *ZERO     WQ0025  70       Date To   USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POENXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     SETON                     35    *
     C                     END
      * * Create Standard Deviation *
      * Del Std Deviation     RT - Company Std Deviation  * 
     C                     EXSR SGRVGN
      * SBMJOB: Crt Std Deviation     UP - Company Std Deviation  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PKUUUPR '#SPRG  10 P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#1ALA1    #SPAK  309       CSD Company Num
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL#1V3ST    #SSTR     P      CSD Type
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0006    #SPAK  309       Date From USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0009    #SPAK  309       Date To   USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       CSD Month
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1ANA1    #SPAK  309       CSD Week
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PKUUUPR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKUUUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993132*
     C                     SETON                     35    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD01        YL0007           Number 1 USR
      * RTV Wk Start/End      RT - STR Order Management Sys  * 
     C                     CALL 'POENXFR'              90  RTV Wk Start/En
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ALA1    WQ0026  30       CC Company Numb
     C                     PARM #DAMA1    WQ0027  40       CSD Year
     C                     PARM YL0007    WQ0028  20       CSD Week
     C           YL0006    PARM *ZERO     WQ0029  70       Date From USR
     C           YL0009    PARM *ZERO     WQ0030  70       Date To   USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POENXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     END
      * LCL.Year USR = LCL.CSD To Date *YEAR
     C           YL0009    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0010
      * DO WHILE:
      *  - c1 AND c2
      *   |- c1    : DTL.CSD Year EQ LCL.Year USR
      *   |- c2    : LCL.CSD To Date LE JOB.*Job date
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           #DAMA1    IFEQ YL0010                     *IF
     C           YL0009    IFLE ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * CASE: From and To Date entered
      *  - c1 AND c2
      *   |- c1    : LCL.CSD From Date is Entered
      *   |- c2    : LCL.CSD To Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0006    IFNE *ZERO                      *IF
     C           YL0009    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * * Create Standard Deviation *
      * Del Std Deviation     RT - Company Std Deviation  * 
     C                     EXSR SIRVGN
      * SBMJOB: Crt Std Deviation     UP - Company Std Deviation  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PKUUUPR '#SPRG  10 P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#1ALA1    #SPAK  309       CSD Company Num
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL#1V3ST    #SSTR     P      CSD Type
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0006    #SPAK  309       Date From USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0009    #SPAK  309       Date To   USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       CSD Month
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0007    #SPAK  309       CSD Week
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PKUUUPR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKUUUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993132*
     C                     END
     C                     END                             *FI
      * * Increment Week *
     C                     ADD  1         YL0007           Number 1 USR
      * RTV Wk Start/End      RT - STR Order Management Sys  * 
     C                     CALL 'POENXFR'              90  RTV Wk Start/En
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ALA1    WQ0031  30       CC Company Numb
     C                     PARM #DAMA1    WQ0032  40       CSD Year
     C                     PARM YL0007    WQ0033  20       CSD Week
     C           YL0006    PARM *ZERO     WQ0034  70       Date From USR
     C           YL0009    PARM *ZERO     WQ0035  70       Date To   USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POENXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     END
      * LCL.Year USR = LCL.CSD To Date *YEAR
     C           YL0009    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0010
     C                     END                             *ITR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate CSD Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1V3ST'  IFEQ YPMTFD
      * CSD Type
     C                     MOVEL#1V3ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHV3ST
     C                     SELEC
     C           W0INVL    WHEQ 'M'                        M
     C                     Z-ADD1         ZHV3ST
     C           W0INVL    WHEQ 'W'                        W
     C                     Z-ADD2         ZHV3ST
     C                     ENDSL
     C                     EXFMTZGV3ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHV3ST    WHEQ 1
     C                     MOVEL'M'       W0INVL           M
     C           ZHV3ST    WHEQ 2
     C                     MOVEL'W'       W0INVL           W
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1V3ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * CASE: DTL.CSD Type is Other
     C           #1V3ST    IFEQ 'O'                        *IF
     C                     Z-ADD*ZERO     #1AWA1           CSD Month
     C                     Z-ADD*ZERO     #1ANA1           CSD Week
      * Val:  From Date
      * CASE: DTL.Date From USR EQ LCL.Zero USR
     C           #DB3DT    IFEQ YL0013                     *IF
      * Setup message data for message
      * Convert Date From USR to display format
      * Convert date
     C           1000000   ADD  #DB3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Send message 'Date Required'
     C                     MOVEL'PRK0772' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Val:  To Date
      * CASE: DTL.Date To   USR EQ LCL.Zero USR
     C           #DB4DT    IFEQ YL0013                     *IF
      * Setup message data for message
      * Convert Date From USR to display format
      * Convert date
     C           1000000   ADD  #DB3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0002
      * Send message 'Date Required'
     C                     MOVEL'PRK0772' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.CSD Type is Monthly
     C           #1V3ST    IFEQ 'M'                        *IF
     C                     Z-ADD*ZERO     #1ANA1           CSD Week
     C                     Z-ADD*ZERO     #DB3DT           Date From USR
     C                     Z-ADD*ZERO     #DB4DT           Date To   USR
     C                     ELSE
      * CASE: DTL.CSD Type is Weekly
     C           #1V3ST    IFEQ 'W'                        *IF
     C                     Z-ADD*ZERO     #1AWA1           CSD Month
     C                     Z-ADD*ZERO     #DB3DT           Date From USR
     C                     Z-ADD*ZERO     #DB4DT           Date To   USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Screen function fields
      * DTL.Condition Name USR = Condition name of DTL.CSD Type
     C                     CALL 'PKRVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1232528   Y2LSNO  70       List number
     C                     PARM #1V3ST    W0INVL 25        CSD Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DC4TX    PARM           W0CNNM 25        Condition Name
      *
     C                     END
      * CSD Company Number required
     C           #1ALA1    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * CSD Type required
     C           #1V3ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * CSD Year required
     C           #DAMA1    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
      * Enable PUTOVR
     C                     SETON                         86*
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1G8ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1ENDT           CSD From Date
     C                     Z-ADD*ZERO     #1EODT           CSD To Date
     C                     Z-ADD*ZERO     #DB3DT           Date From USR
     C                     Z-ADD*ZERO     #DB4DT           Date To   USR
     C                     MOVEL*BLANK    #1V1ST           CSD Source Type
     C                     MOVEL*BLANK    #1H0CD           CSD Producer Co
     C                     MOVEL*BLANK    #1H1CD           CSD Location Co
     C                     Z-ADD*ZERO     #1AOA1           CSD Head Killed
     C                     Z-ADD*ZERO     #1APA1           CSD Avg Hot Wgt
     C                     Z-ADD*ZERO     #1AQA1           CSD SDev Hot Wg
     C                     Z-ADD*ZERO     #1H5PC           CSD Avg Lean %
     C                     Z-ADD*ZERO     #1ARA1           CSD SDev Lean %
     C                     Z-ADD*ZERO     #1AUA1           CSD Avg Backfat
     C                     Z-ADD*ZERO     #1ASA1           CSD SDev Backfa
     C                     Z-ADD*ZERO     #1H6PC           CSD Avg Loin Ey
     C                     Z-ADD*ZERO     #1ATA1           CSD SDev Loin E
     C                     Z-ADD*ZERO     #1H7PC           CSD Avg Adj Yie
     C                     Z-ADD*ZERO     #1AVA1           CSD SDev Adj Yi
     C                     Z-ADD*ZERO     #1ALA1           CSD Company Num
     C                     MOVEL*BLANK    #DEUTX           Oms Name
     C                     MOVEL*BLANK    #1V3ST           CSD Type
     C                     MOVEL*BLANK    #DC4TX           Condition Name
     C                     Z-ADD*ZERO     #DAMA1           CSD Year
     C                     Z-ADD*ZERO     #1AWA1           CSD Month
     C                     Z-ADD*ZERO     #1ANA1           CSD Week
      * CALC: Screen function fields
      * DTL.Condition Name USR = Condition name of DTL.CSD Type
     C                     CALL 'PKRVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1232528   Y2LSNO  70       List number
     C                     PARM #1V3ST    W0INVL 25        CSD Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DC4TX    PARM           W0CNNM 25        Condition Name
      *
      * USER: Load screen
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0014    IFEQ 'Y'                        *IF
     C                     Z-ADDP1HONB    #1ALA1           CSD Company Num
     C                     MOVEL'N'       YL0014           First Time Flag
     C                     END                             *FI
      * Val Company Number    IF
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ALA1    WQ0036  30       CC Company Numb
     C           #DEUTX    PARM *BLANK    WQ0037 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0038  1        Invalid Y/N USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: WRK.Invalid Y/N USR is Yes
     C           WUG3ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1ALA1    ZA0003           CC Company Numb
      * Send message 'Invalid Company Number'
     C                     MOVEL'PRK0299' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     MOVELWUG3ST    YL0015           Invalid Y/N USR
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Del Std Deviation     RT - Company Std Deviation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYALA1    WQSA01           CSD Company Num
     C           *LIKE     DEFN EYV3ST    WQSA02           CSD Type
     C           *LIKE     DEFN EYENDT    WQSA03           CSD From Date
     C           *LIKE     DEFN EYEODT    WQSA04           CSD To Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           CSD Company Num
     C                     KFLD           WQSA02           CSD Type
     C                     KFLD           WQSA03           CSD From Date
     C                     KFLD           WQSA04           CSD To Date
      * Setup key
     C                     Z-ADD#1ALA1    WQSA01           CSD Company Num
     C                     MOVEL#1V3ST    WQSA02           CSD Type
     C                     Z-ADD#DB3DT    WQSA03           CSD From Date
     C                     Z-ADD#DB4DT    WQSA04           CSD To Date
      * Establish starting position
     C           KRSSA     SETLL@EYCPEV                    *
     C           KRSSA     READE@EYCPEV                  90*
      * Data record not found
     C   90                MOVEL'PRK0943' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Company Std Deviat - Company Std Deviation  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@EYCPEV                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Delete Company Std Deviat - Company Std Deviation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPEU
     C                     Z-ADDEYALA1    WAALA1           CSD Company Num
     C                     MOVELEYV3ST    WAV3ST           CSD Type
     C                     Z-ADDEYENDT    WAENDT           CSD From Date
     C                     Z-ADDEYEODT    WAEODT           CSD To Date
     C                     MOVELEYV1ST    WAV1ST           CSD Source Type
     C                     MOVELEYH0CD    WAH0CD           CSD Producer Co
     C                     MOVELEYH1CD    WAH1CD           CSD Location Co
      *
     C           KLDLSB    KLIST
     C                     KFLD           WAALA1           CSD Company Num
     C                     KFLD           WAV3ST           CSD Type
     C                     KFLD           WAENDT           CSD From Date
     C                     KFLD           WAEODT           CSD To Date
     C                     KFLD           WAV1ST           CSD Source Type
     C                     KFLD           WAH0CD           CSD Producer Co
     C                     KFLD           WAH1CD           CSD Location Co
     C           KLDLSB    CHAIN@EYCPEU              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKEYCPL0'MDACP
     C                     MOVEL'@EYCPEU' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPEU                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Del Std Deviation     RT - Company Std Deviation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYALA1    WQSC01           CSD Company Num
     C           *LIKE     DEFN EYV3ST    WQSC02           CSD Type
     C           *LIKE     DEFN EYENDT    WQSC03           CSD From Date
     C           *LIKE     DEFN EYEODT    WQSC04           CSD To Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           CSD Company Num
     C                     KFLD           WQSC02           CSD Type
     C                     KFLD           WQSC03           CSD From Date
     C                     KFLD           WQSC04           CSD To Date
      * Setup key
     C                     Z-ADD#1ALA1    WQSC01           CSD Company Num
     C                     MOVEL#1V3ST    WQSC02           CSD Type
     C                     Z-ADDYL0006    WQSC03           CSD From Date
     C                     Z-ADDYL0009    WQSC04           CSD To Date
      * Establish starting position
     C           KRSSC     SETLL@EYCPEV                    *
     C           KRSSC     READE@EYCPEV                  90*
      * Data record not found
     C   90                MOVEL'PRK0943' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Company Std Deviat - Company Std Deviation  * 
     C                     EXSR SDDLRC
     C           KRSSC     READE@EYCPEV                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Delete Company Std Deviat - Company Std Deviation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPEU
     C                     Z-ADDEYALA1    WAALA1           CSD Company Num
     C                     MOVELEYV3ST    WAV3ST           CSD Type
     C                     Z-ADDEYENDT    WAENDT           CSD From Date
     C                     Z-ADDEYEODT    WAEODT           CSD To Date
     C                     MOVELEYV1ST    WAV1ST           CSD Source Type
     C                     MOVELEYH0CD    WAH0CD           CSD Producer Co
     C                     MOVELEYH1CD    WAH1CD           CSD Location Co
      *
     C           KLDLSD    KLIST
     C                     KFLD           WAALA1           CSD Company Num
     C                     KFLD           WAV3ST           CSD Type
     C                     KFLD           WAENDT           CSD From Date
     C                     KFLD           WAEODT           CSD To Date
     C                     KFLD           WAV1ST           CSD Source Type
     C                     KFLD           WAH0CD           CSD Producer Co
     C                     KFLD           WAH1CD           CSD Location Co
     C           KLDLSD    CHAIN@EYCPEU              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKEYCPL0'MDACP
     C                     MOVEL'@EYCPEU' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPEU                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Del Std Deviation     RT - Company Std Deviation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYALA1    WQSE01           CSD Company Num
     C           *LIKE     DEFN EYV3ST    WQSE02           CSD Type
     C           *LIKE     DEFN EYENDT    WQSE03           CSD From Date
     C           *LIKE     DEFN EYEODT    WQSE04           CSD To Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CSD Company Num
     C                     KFLD           WQSE02           CSD Type
     C                     KFLD           WQSE03           CSD From Date
     C                     KFLD           WQSE04           CSD To Date
      * Setup key
     C                     Z-ADD#1ALA1    WQSE01           CSD Company Num
     C                     MOVEL#1V3ST    WQSE02           CSD Type
     C                     Z-ADDYL0006    WQSE03           CSD From Date
     C                     Z-ADDYL0009    WQSE04           CSD To Date
      * Establish starting position
     C           KRSSE     SETLL@EYCPEV                    *
     C           KRSSE     READE@EYCPEV                  90*
      * Data record not found
     C   90                MOVEL'PRK0943' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Company Std Deviat - Company Std Deviation  * 
     C                     EXSR SFDLRC
     C           KRSSE     READE@EYCPEV                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Delete Company Std Deviat - Company Std Deviation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPEU
     C                     Z-ADDEYALA1    WAALA1           CSD Company Num
     C                     MOVELEYV3ST    WAV3ST           CSD Type
     C                     Z-ADDEYENDT    WAENDT           CSD From Date
     C                     Z-ADDEYEODT    WAEODT           CSD To Date
     C                     MOVELEYV1ST    WAV1ST           CSD Source Type
     C                     MOVELEYH0CD    WAH0CD           CSD Producer Co
     C                     MOVELEYH1CD    WAH1CD           CSD Location Co
      *
     C           KLDLSF    KLIST
     C                     KFLD           WAALA1           CSD Company Num
     C                     KFLD           WAV3ST           CSD Type
     C                     KFLD           WAENDT           CSD From Date
     C                     KFLD           WAEODT           CSD To Date
     C                     KFLD           WAV1ST           CSD Source Type
     C                     KFLD           WAH0CD           CSD Producer Co
     C                     KFLD           WAH1CD           CSD Location Co
     C           KLDLSF    CHAIN@EYCPEU              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKEYCPL0'MDACP
     C                     MOVEL'@EYCPEU' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPEU                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Del Std Deviation     RT - Company Std Deviation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYALA1    WQSG01           CSD Company Num
     C           *LIKE     DEFN EYV3ST    WQSG02           CSD Type
     C           *LIKE     DEFN EYENDT    WQSG03           CSD From Date
     C           *LIKE     DEFN EYEODT    WQSG04           CSD To Date
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           CSD Company Num
     C                     KFLD           WQSG02           CSD Type
     C                     KFLD           WQSG03           CSD From Date
     C                     KFLD           WQSG04           CSD To Date
      * Setup key
     C                     Z-ADD#1ALA1    WQSG01           CSD Company Num
     C                     MOVEL#1V3ST    WQSG02           CSD Type
     C                     Z-ADDYL0006    WQSG03           CSD From Date
     C                     Z-ADDYL0009    WQSG04           CSD To Date
      * Establish starting position
     C           KRSSG     SETLL@EYCPEV                    *
     C           KRSSG     READE@EYCPEV                  90*
      * Data record not found
     C   90                MOVEL'PRK0943' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Company Std Deviat - Company Std Deviation  * 
     C                     EXSR SHDLRC
     C           KRSSG     READE@EYCPEV                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Delete Company Std Deviat - Company Std Deviation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPEU
     C                     Z-ADDEYALA1    WAALA1           CSD Company Num
     C                     MOVELEYV3ST    WAV3ST           CSD Type
     C                     Z-ADDEYENDT    WAENDT           CSD From Date
     C                     Z-ADDEYEODT    WAEODT           CSD To Date
     C                     MOVELEYV1ST    WAV1ST           CSD Source Type
     C                     MOVELEYH0CD    WAH0CD           CSD Producer Co
     C                     MOVELEYH1CD    WAH1CD           CSD Location Co
      *
     C           KLDLSH    KLIST
     C                     KFLD           WAALA1           CSD Company Num
     C                     KFLD           WAV3ST           CSD Type
     C                     KFLD           WAENDT           CSD From Date
     C                     KFLD           WAEODT           CSD To Date
     C                     KFLD           WAV1ST           CSD Source Type
     C                     KFLD           WAH0CD           CSD Producer Co
     C                     KFLD           WAH1CD           CSD Location Co
     C           KLDLSH    CHAIN@EYCPEU              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKEYCPL0'MDACP
     C                     MOVEL'@EYCPEU' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPEU                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Del Std Deviation     RT - Company Std Deviation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYALA1    WQSI01           CSD Company Num
     C           *LIKE     DEFN EYV3ST    WQSI02           CSD Type
     C           *LIKE     DEFN EYENDT    WQSI03           CSD From Date
     C           *LIKE     DEFN EYEODT    WQSI04           CSD To Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           CSD Company Num
     C                     KFLD           WQSI02           CSD Type
     C                     KFLD           WQSI03           CSD From Date
     C                     KFLD           WQSI04           CSD To Date
      * Setup key
     C                     Z-ADD#1ALA1    WQSI01           CSD Company Num
     C                     MOVEL#1V3ST    WQSI02           CSD Type
     C                     Z-ADDYL0006    WQSI03           CSD From Date
     C                     Z-ADDYL0009    WQSI04           CSD To Date
      * Establish starting position
     C           KRSSI     SETLL@EYCPEV                    *
     C           KRSSI     READE@EYCPEV                  90*
      * Data record not found
     C   90                MOVEL'PRK0943' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Company Std Deviat - Company Std Deviation  * 
     C                     EXSR SJDLRC
     C           KRSSI     READE@EYCPEV                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * Delete Company Std Deviat - Company Std Deviation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPEU
     C                     Z-ADDEYALA1    WAALA1           CSD Company Num
     C                     MOVELEYV3ST    WAV3ST           CSD Type
     C                     Z-ADDEYENDT    WAENDT           CSD From Date
     C                     Z-ADDEYEODT    WAEODT           CSD To Date
     C                     MOVELEYV1ST    WAV1ST           CSD Source Type
     C                     MOVELEYH0CD    WAH0CD           CSD Producer Co
     C                     MOVELEYH1CD    WAH1CD           CSD Location Co
      *
     C           KLDLSJ    KLIST
     C                     KFLD           WAALA1           CSD Company Num
     C                     KFLD           WAV3ST           CSD Type
     C                     KFLD           WAENDT           CSD From Date
     C                     KFLD           WAEODT           CSD To Date
     C                     KFLD           WAV1ST           CSD Source Type
     C                     KFLD           WAH0CD           CSD Producer Co
     C                     KFLD           WAH1CD           CSD Location Co
     C           KLDLSJ    CHAIN@EYCPEU              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKEYCPL0'MDACP
     C                     MOVEL'@EYCPEU' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPEU                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDEQ017
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1V3ST'  YPMTFD           CSD Type
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1J8NB           Oms Warehouse C
     C                     Z-ADD*ZERO     P1HONB           CC Company Numb
     C                     MOVEL*BLANK    P1C7CD           Oms Application
     C                     MOVEL*BLANK    P1C8CD           Oms SalesPerson
     C                     MOVEL*BLANK    P1G8ST           Oms Allow Multi
     C                     MOVEL*BLANK    P1G9ST           Oms Default Pri
     C                     MOVEL*BLANK    P1EUTX           Oms Name
     C                     MOVEL*BLANK    P1EVTX           Oms System Valu
     C                     MOVEL*BLANK    P1HAST           Oms Access Deni
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAALA1           CSD Company Num
     C                     Z-ADD*ZERO     WAENDT           CSD From Date
     C                     Z-ADD*ZERO     WAEODT           CSD To Date
     C                     Z-ADD*ZERO     WAAOA1           CSD Head Killed
     C                     Z-ADD*ZERO     WAAPA1           CSD Avg Hot Wgt
     C                     Z-ADD*ZERO     WAAQA1           CSD SDev Hot Wg
     C                     Z-ADD*ZERO     WAH5PC           CSD Avg Lean %
     C                     Z-ADD*ZERO     WAARA1           CSD SDev Lean %
     C                     Z-ADD*ZERO     WAAUA1           CSD Avg Backfat
     C                     Z-ADD*ZERO     WAASA1           CSD SDev Backfa
     C                     Z-ADD*ZERO     WAH6PC           CSD Avg Loin Ey
     C                     Z-ADD*ZERO     WAATA1           CSD SDev Loin E
     C                     Z-ADD*ZERO     WAH7PC           CSD Avg Adj Yie
     C                     Z-ADD*ZERO     WAAVA1           CSD SDev Adj Yi
     C                     Z-ADD*ZERO     WAAWA1           CSD Month
     C                     Z-ADD*ZERO     WAANA1           CSD Week
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local work field Year Alpha Usr
     C                     MOVEL*BLANK    YL0001  4
      * Define local work field Month Alpha USR
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Date From Convert USR
     C                     MOVEL*BLANK    YL0003 10
      * Define local work field Date To Convert USR
     C                     MOVEL*BLANK    YL0004 11
      * Define local work field Date Alpha USR
     C                     MOVEL*BLANK    YL0005  7
      * Define local work field CSD From Date
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Number 1 USR
     C                     Z-ADD*ZERO     YL0007  20
      * Define local work field Length Usr Txt
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field CSD To Date
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Year USR
     C                     Z-ADD*ZERO     YL0010  40
      * Define local work field Number 2 USR
     C                     Z-ADD*ZERO     YL0011  20
      * Define local work field Number 3 USR
     C                     Z-ADD*ZERO     YL0012  20
      * Define local work field Zero USR
     C                     Z-ADD*ZERO     YL0013  10
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Invalid Y/N USR
     C                     MOVEL*BLANK    YL0015  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Val Application/User  IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                     CALL 'PDGXXFR'              90  Val Application
     C                     PARM *BLANK    W0RTN   7
     C           P1J8NB    PARM *BLANK    WQ0039  3        Oms Warehouse C
     C           P1HONB    PARM *ZERO     WQ0040  30       CC Company Numb
     C                     PARM 'HPE'     WQ0041  6        Oms Application
     C           P1C8CD    PARM *BLANK    WQ0042  3        Oms SalesPerson
     C           P1G8ST    PARM *BLANK    WQ0043  1        Oms Allow Multi
     C           P1G9ST    PARM *BLANK    WQ0044 10        Oms Default Pri
     C           P1EUTX    PARM *BLANK    WQ0045 30        Oms Name
     C           P1EVTX    PARM *BLANK    WQ0046 40        Oms System Valu
     C           P1HAST    PARM *BLANK    WQ0047  1        Oms Access Deni
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P1HAST    IFEQ 'Y'                        *IF
      * Send message 'Access Denied for User'
     C                     MOVEL'PRK0298' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP1EVTX    ##CMP
     C                     END                             *FI
     C                     MOVEL'Y'       YL0014           First Time Flag
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
