     H/TITLE Bld Sales Hist Dwnld  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 06/02/09  Time  : 15:56:48
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMHSTPMEIF  E           K        DISK
      * RSQ : Sales History             Co/ActShipDt/Ord/Item,se
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FOMHSTPMDIF  E           K        DISK
      * RSQ : Sales History             Co/ActShipDt/ShipItem,se
      *
     FPOAUCPL2IF  E           K        DISK
      * RSQ : WF Sales History Dwnld    Co/Key-Item/Seq (D)
      *
     FPOAUCPL0IF  E           K        DISK                      A
      * UPD : WF Sales History Dwnld    Update index
      *
     I@HSTPG1
      * Sales History             Co/ActShipDt/Ord/Item,se
      * Renamed input format fields
     I              F4AIC3                          WAAIC3
     I              F4C4NB                          WAC4NB
     I              F4DPNB                          WADPNB
     I              F4UENB                          WAUENB
     I              F4MONA                          WAMONA
     I              F4RJCD                          WARJCD
     I              F4RKCD                          WARKCD
     I              F4GPTX                          WAGPTX
     I              F4ABTX                          WAABTX
     I              F4KXCD                          WAKXCD
     I              F4BOCD                          WABOCD
     I              F4BTC7                          WABTC7
     I              F4ANC7                          WAANC7
     I              F4AQTX                          WAAQTX
     I              F4BKC7                          WABKC7
     I              F4BRTX                          WABRTX
     I              F4HNNA                          WAHNNA
     I              F4DBCD                          WADBCD
     I              F4CKTX                          WACKTX
     I              F4BCNA                          WABCNA
     I              F4A0DT                          WAA0DT
     I              F4ACDT                          WAACDT
     I              F4R4CD                          WAR4CD
     I              F4R5CD                          WAR5CD
     I              F4BFCD                          WABFCD
     I              F4Q4CD                          WAQ4CD
     I              F4AQCD                          WAAQCD
     I              F4TBNB                          WATBNB
     I              F4BZNA                          WABZNA
     I              F4RLCD                          WARLCD
     I              F4JNCD                          WAJNCD
     I              F4Q2CD                          WAQ2CD
     I              F4U2ST                          WAU2ST
     I              F4ATIN                          WAATIN
     I              F4T3NB                          WAT3NB
     I              F4RSRN                          WARSRN
     I              F4ORIT                          WAORIT
     I              F4AJCD                          WAAJCD
     I              F4AVQT                          WAAVQT
     I              F4D0WG                          WAD0WG
     I              F4CCQT                          WACCQT
     I              F4AUWG                          WAAUWG
     I              F4AGCD                          WAAGCD
     I              F4AKPR                          WAAKPR
     I              F4AUPR                          WAAUPR
     I              F4CRCD                          WACRCD
     I              F4A5DT                          WAA5DT
     I              F4AWDT                          WAAWDT
     I              F4HDDT                          WAHDDT
     I              F4AGCS                          WAAGCS
     I              F4AQCS                          WAAQCS
     I              F4AVWG                          WAAVWG
     I              F4AYVA                          WAAYVA
     I              F4AMST                          WAAMST
     I              F4ANST                          WAANST
     I              F4VAST                          WAVAST
     I              F4L6NB                          WAL6NB
     I              F4UMCD                          WAUMCD
     I              F4HCDT                          WAHCDT
     I              F4ESNB                          WAESNB
     I              F4ETNB                          WAETNB
     I              F4BZNB                          WABZNB
     I              F4EXQT                          WAEXQT
     I              F4BYWG                          WABYWG
     I              F4S5NB                          WAS5NB
     I              F4MAVA                          WAMAVA
     I              F4KDVA                          WAKDVA
     I              F4USVA                          WAUSVA
     I              F4UTVA                          WAUTVA
     I              F4A4WG                          WAA4WG
     I              F4CKNB                          WACKNB
     I              F4BMST                          WABMST
     I              F4R8NB                          WAR8NB
     I              F4RMCD                          WARMCD
     I              F4BZPR                          WABZPR
     I              F4RDCD                          WARDCD
     I              F4Q7CD                          WAQ7CD
     I              F4EXDT                          WAEXDT
     I              F4LQCD                          WALQCD
     I              F4HICD                          WAHICD
     I              F4RBCD                          WARBCD
     I              F4RGNB                          WARGNB
     I              F4RHNB                          WARHNB
     I              F4RINB                          WARINB
     I              F4R1NB                          WAR1NB
     I              F4CONB                          WACONB
     I              F4CEST                          WACEST
     I              F4GNDT                          WAGNDT
     I              F4RMNB                          WARMNB
     I              F4AODT                          WAAODT
     I              F4LLCD                          WALLCD
     I              F4LMCD                          WALMCD
     I              F4SKNB                          WASKNB
     I              F4SLNB                          WASLNB
     I              F4SMNB                          WASMNB
     I              F4G7NA                          WAG7NA
     I              F4ONVA                          WAONVA
     I              F4N0CD                          WAN0CD
     I              F4B4NB                          WAB4NB
     I              F4B5NB                          WAB5NB
     I              F4N1CD                          WAN1CD
     I              F4GIDT                          WAGIDT
     I              F4Z1ST                          WAZ1ST
     I              F4ULVA                          WAULVA
     I              F4UNVA                          WAUNVA
     I              F4UOVA                          WAUOVA
     I              F4UPVA                          WAUPVA
     I              F4UQVA                          WAUQVA
     I              F4SDCD                          WASDCD
     I              F4QZCD                          WAQZCD
     I              F4XWST                          WAXWST
     I              F4T9CD                          WAT9CD
     I              F4UBCD                          WAUBCD
     I              F4CFC7                          WACFC7
     I              F4X1CD                          WAX1CD
     I              F4GASX                          WAGASX
     I              F4DUPR                          WADUPR
     I              F4B6VL                          WAB6VL
     I              F4IANX                          WAIANX
     I              F4IBNX                          WAIBNX
     I              F4RPCD                          WARPCD
     I              F4NYDT                          WANYDT
     I              F4BZTM                          WABZTM
     I              F4Z4NB                          WAZ4NB
     I              F4XACD                          WAXACD
     I              F4OANA                          WAOANA
     I              F4OKTX                          WAOKTX
     I              F4K4TX                          WAK4TX
     I              F4NBBO                          WANBBO
     I              F4OCFR                          WAOCFR
     I              F4C0C7                          WAC0C7
     I              F4A1AA                          WAA1AA
     I              F4VEST                          WAVEST
     I              F4A5PR                          WAA5PR
     I              F4CDPR                          WACDPR
     I              F4D0PR                          WAD0PR
     I              F4D0VL                          WAD0VL
     I              F4IRSX                          WAIRSX
     I              F4CEVL                          WACEVL
     I              F4ISSX                          WAISSX
     I              F4ITSX                          WAITSX
     I              F4IUSX                          WAIUSX
     I              F4OHDT                          WAOHDT
     I              F4D9PR                          WAD9PR
     I              F4CFVL                          WACFVL
     I              F4UVST                          WAUVST
     I              F4UWST                          WAUWST
     I              F4UXST                          WAUXST
     I              F4AATM                          WAAATM
     I              F4AYNA                          WAAYNA
     I              F4A0NA                          WAA0NA
     I              F4AXDT                          WAAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                          WCJNCD
     I              EXJVNA                          WCJVNA
     I              EXOAST                          WCOAST
     I              EXOBST                          WCOBST
     I              EXOEST                          WCOEST
     I              EXOFST                          WCOFST
     I              EXVBST                          WCVBST
     I              EXPYST                          WCPYST
     I              EXX8ST                          WCX8ST
     I              EXISTX                          WCISTX
     I              EXUVST                          WCUVST
     I              EXUWST                          WCUWST
     I              EXUXST                          WCUXST
     I              EXVSST                          WCVSST
     I              EXAATM                          WCAATM
     I              EXAYNA                          WCAYNA
     I              EXA0NA                          WCA0NA
     I              EXAXDT                          WCAXDT
      *
     I@AUCPGY
      * WF Sales History Dwnld    Update index
      * Renamed input format fields
     I              AUAIC3                          WDAIC3
     I              AUD2C7                          WDD2C7
     I              AUDPNB                          WDDPNB
     I              AUUENB                          WDUENB
     I              AUIZSX                          WDIZSX
     I              AUS5NB                          WDS5NB
     I              AUGNDT                          WDGNDT
     I              AUA5PR                          WDA5PR
     I              AUEXQT                          WDEXQT
     I              AUBYWG                          WDBYWG
     I              AUUSVA                          WDUSVA
     I              AUE3PC                          WDE3PC
     I              AUAJCD                          WDAJCD
     I              AUIUSX                          WDIUSX
      *
     I@HSTPG0
      * Sales History             Co/ActShipDt/ShipItem,se
      * Renamed input format fields
     I              F4AIC3                          WEAIC3
     I              F4C4NB                          WEC4NB
     I              F4DPNB                          WEDPNB
     I              F4UENB                          WEUENB
     I              F4MONA                          WEMONA
     I              F4RJCD                          WERJCD
     I              F4RKCD                          WERKCD
     I              F4GPTX                          WEGPTX
     I              F4ABTX                          WEABTX
     I              F4KXCD                          WEKXCD
     I              F4BOCD                          WEBOCD
     I              F4BTC7                          WEBTC7
     I              F4ANC7                          WEANC7
     I              F4AQTX                          WEAQTX
     I              F4BKC7                          WEBKC7
     I              F4BRTX                          WEBRTX
     I              F4HNNA                          WEHNNA
     I              F4DBCD                          WEDBCD
     I              F4CKTX                          WECKTX
     I              F4BCNA                          WEBCNA
     I              F4A0DT                          WEA0DT
     I              F4ACDT                          WEACDT
     I              F4R4CD                          WER4CD
     I              F4R5CD                          WER5CD
     I              F4BFCD                          WEBFCD
     I              F4Q4CD                          WEQ4CD
     I              F4AQCD                          WEAQCD
     I              F4TBNB                          WETBNB
     I              F4BZNA                          WEBZNA
     I              F4RLCD                          WERLCD
     I              F4JNCD                          WEJNCD
     I              F4Q2CD                          WEQ2CD
     I              F4U2ST                          WEU2ST
     I              F4ATIN                          WEATIN
     I              F4T3NB                          WET3NB
     I              F4RSRN                          WERSRN
     I              F4ORIT                          WEORIT
     I              F4AJCD                          WEAJCD
     I              F4AVQT                          WEAVQT
     I              F4D0WG                          WED0WG
     I              F4CCQT                          WECCQT
     I              F4AUWG                          WEAUWG
     I              F4AGCD                          WEAGCD
     I              F4AKPR                          WEAKPR
     I              F4AUPR                          WEAUPR
     I              F4CRCD                          WECRCD
     I              F4A5DT                          WEA5DT
     I              F4AWDT                          WEAWDT
     I              F4HDDT                          WEHDDT
     I              F4AGCS                          WEAGCS
     I              F4AQCS                          WEAQCS
     I              F4AVWG                          WEAVWG
     I              F4AYVA                          WEAYVA
     I              F4AMST                          WEAMST
     I              F4ANST                          WEANST
     I              F4VAST                          WEVAST
     I              F4L6NB                          WEL6NB
     I              F4UMCD                          WEUMCD
     I              F4HCDT                          WEHCDT
     I              F4ESNB                          WEESNB
     I              F4ETNB                          WEETNB
     I              F4BZNB                          WEBZNB
     I              F4EXQT                          WEEXQT
     I              F4BYWG                          WEBYWG
     I              F4S5NB                          WES5NB
     I              F4MAVA                          WEMAVA
     I              F4KDVA                          WEKDVA
     I              F4USVA                          WEUSVA
     I              F4UTVA                          WEUTVA
     I              F4A4WG                          WEA4WG
     I              F4CKNB                          WECKNB
     I              F4BMST                          WEBMST
     I              F4R8NB                          WER8NB
     I              F4RMCD                          WERMCD
     I              F4BZPR                          WEBZPR
     I              F4RDCD                          WERDCD
     I              F4Q7CD                          WEQ7CD
     I              F4EXDT                          WEEXDT
     I              F4LQCD                          WELQCD
     I              F4HICD                          WEHICD
     I              F4RBCD                          WERBCD
     I              F4RGNB                          WERGNB
     I              F4RHNB                          WERHNB
     I              F4RINB                          WERINB
     I              F4R1NB                          WER1NB
     I              F4CONB                          WECONB
     I              F4CEST                          WECEST
     I              F4GNDT                          WEGNDT
     I              F4RMNB                          WERMNB
     I              F4AODT                          WEAODT
     I              F4LLCD                          WELLCD
     I              F4LMCD                          WELMCD
     I              F4SKNB                          WESKNB
     I              F4SLNB                          WESLNB
     I              F4SMNB                          WESMNB
     I              F4G7NA                          WEG7NA
     I              F4ONVA                          WEONVA
     I              F4N0CD                          WEN0CD
     I              F4B4NB                          WEB4NB
     I              F4B5NB                          WEB5NB
     I              F4N1CD                          WEN1CD
     I              F4GIDT                          WEGIDT
     I              F4Z1ST                          WEZ1ST
     I              F4ULVA                          WEULVA
     I              F4UNVA                          WEUNVA
     I              F4UOVA                          WEUOVA
     I              F4UPVA                          WEUPVA
     I              F4UQVA                          WEUQVA
     I              F4SDCD                          WESDCD
     I              F4QZCD                          WEQZCD
     I              F4XWST                          WEXWST
     I              F4T9CD                          WET9CD
     I              F4UBCD                          WEUBCD
     I              F4CFC7                          WECFC7
     I              F4X1CD                          WEX1CD
     I              F4GASX                          WEGASX
     I              F4DUPR                          WEDUPR
     I              F4B6VL                          WEB6VL
     I              F4IANX                          WEIANX
     I              F4IBNX                          WEIBNX
     I              F4RPCD                          WERPCD
     I              F4NYDT                          WENYDT
     I              F4BZTM                          WEBZTM
     I              F4Z4NB                          WEZ4NB
     I              F4XACD                          WEXACD
     I              F4OANA                          WEOANA
     I              F4OKTX                          WEOKTX
     I              F4K4TX                          WEK4TX
     I              F4NBBO                          WENBBO
     I              F4OCFR                          WEOCFR
     I              F4C0C7                          WEC0C7
     I              F4A1AA                          WEA1AA
     I              F4VEST                          WEVEST
     I              F4A5PR                          WEA5PR
     I              F4CDPR                          WECDPR
     I              F4D0PR                          WED0PR
     I              F4D0VL                          WED0VL
     I              F4IRSX                          WEIRSX
     I              F4CEVL                          WECEVL
     I              F4ISSX                          WEISSX
     I              F4ITSX                          WEITSX
     I              F4IUSX                          WEIUSX
     I              F4OHDT                          WEOHDT
     I              F4D9PR                          WED9PR
     I              F4CFVL                          WECFVL
     I              F4UVST                          WEUVST
     I              F4UWST                          WEUWST
     I              F4UXST                          WEUXST
     I              F4AATM                          WEAATM
     I              F4AYNA                          WEAYNA
     I              F4A0NA                          WEA0NA
     I              F4AXDT                          WEAXDT
      *
     I@AUCPKG
      * WF Sales History Dwnld    Co/Key-Item/Seq (D)
      * Renamed input format fields
     I              AUAIC3                          WFAIC3
     I              AUD2C7                          WFD2C7
     I              AUDPNB                          WFDPNB
     I              AUUENB                          WFUENB
     I              AUIZSX                          WFIZSX
     I              AUS5NB                          WFS5NB
     I              AUGNDT                          WFGNDT
     I              AUA5PR                          WFA5PR
     I              AUEXQT                          WFEXQT
     I              AUBYWG                          WFBYWG
     I              AUUSVA                          WFUSVA
     I              AUE3PC                          WFE3PC
     I              AUAJCD                          WFAJCD
     I              AUIUSX                          WFIUSX
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPOAU1    E DSPOAUCPL0
      * UPD : WF Sales History Dwnld    Update index
      * Renamed input format fields
     I              AUAIC3                          WDAIC3
     I              AUD2C7                          WDD2C7
     I              AUDPNB                          WDDPNB
     I              AUUENB                          WDUENB
     I              AUIZSX                          WDIZSX
     I              AUS5NB                          WDS5NB
     I              AUGNDT                          WDGNDT
     I              AUA5PR                          WDA5PR
     I              AUEXQT                          WDEXQT
     I              AUBYWG                          WDBYWG
     I              AUUSVA                          WDUSVA
     I              AUE3PC                          WDE3PC
     I              AUAJCD                          WDAJCD
     I              AUIUSX                          WDIUSX
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  Report Type
     I                                        1   1 P2IZSX
     IP3PARM      DS
      * I :  From Date             USR
     I                                    P   1   40P3L9DT
     IP4PARM      DS
      * I :  To Date               USR
     I                                    P   1   40P4MADT
     IP5PARM      DS
      * I :  USR Sales Realiz. Flag
     I                                        1   1 P5JHST
     IP6PARM      DS
      * I :  USR Active Flag
     I                                        1   1 P6W2ST
     IP7PARM      DS
      * I :  Change Flag USR
     I                                        1   1 P7HWSX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2IZSX    PARM           WP0002  1        Report Type
     C           P3L9DT    PARM           WP0003  70       From Date
     C           P4MADT    PARM           WP0004  70       To Date
     C           P5JHST    PARM           WP0005  1        USR Sales Reali
     C           P6W2ST    PARM           WP0006  1        USR Active Flag
     C           P7HWSX    PARM           WP0007  1        Change Flag USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Sales Hist Dwnld  XF
      * *****************
      * CASE: PAR.Report Type is Detail
     C           P2IZSX    IFEQ 'D'                        *IF
      * Bld Sales Hst Dwn-Dtl RT - Sales History  * 
     C                     EXSR SARVGN
     C                     ELSE
      * CASE: PAR.Report Type is Summary
     C           P2IZSX    IFEQ 'S'                        *IF
      * Bld Sales Hst Dwn-Smm RT - Sales History  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change log and comments
     C                     EXSR UASUBR                     ***** Change lo
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Bld Sales Hst Dwn-Dtl RT - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Billing Activit
     C                     MOVEL*BLANK    WN0002  2        Print on Realiz
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ** 06/01/2009 LJB E00423 Add: Include/Exclude/Only Sample items
      * pk0224 -- Create Sales History download Detail by order number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WAGNDT           Actual Shipped
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP3L9DT    WAGNDT           Actual Shipped
      * Establish starting position
     C           KPSSA     SETLL@HSTPG1                    *
     C           KRSSA     READE@HSTPG1                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Actual Shipped Date GE PAR.From Date
      *   |- c2    : DB1.Actual Shipped Date LE PAR.To Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAGNDT    IFGE P3L9DT                     *IF
     C           WAGNDT    IFLE P4MADT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * RTV Print Realization  RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAS5NB    WL0002           Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WULNCD    P      Default Commod
     C                     MOVELWL0004    WN0002    P      Print on Realiz
      * RTV Billing Type       RT - Order Types  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAJNCD    WL0005    P      Order Type - Sa
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WN0001    P      Billing Activit
      * Exclude CM/DM
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit or Debit Memo
      *   |- c2    : PAR.USR Sales Realiz. Flag is None
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0001    IFEQ '2'                        *IF
     C           WN0001    OREQ '3'
     C           P5JHST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CM/DM Only
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.USR Sales Realiz. Flag is CM/DM Only
      *   |- c2    : PAR.Billing Activity Type is Invoice or Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5JHST    IFEQ 'O'                        *IF
     C           WN0001    IFEQ '1'                        *IF
     C           WN0001    OREQ '4'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Include All Products?
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.USR Active Flag is Record Not Found
      *   |- c2    : PAR.Print on Realization Rpt is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6W2ST    IFEQ 'N'                        *IF
     C           WN0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Include Samples? (Unit Price <= .01 are samples)     E00423
      * CASE: If Samples Only, skip if unit price > .01
      *  - c1 AND c2
      *   |- c1    : PAR.Change Flag USR is Only
      *   |- c2    : DB1.Unit Price is GT .01
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P7HWSX    IFEQ 'O'                        *IF
     C           WAAKPR    IFGT .01                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: If Include Samples = No, skip unit pric <= .01
      *  - c1 AND c2
      *   |- c1    : PAR.Change Flag USR is No
      *   |- c2    : DB1.Unit Price is LE .0100
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P7HWSX    IFEQ 'N'                        *IF
     C           WAAKPR    IFLE .0100                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Record Selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * FOB amount and weight
      * CASE: PAR.Billing Activity Type is Invoice
     C           WN0001    IFEQ '1'                        *IF
      * CASE: DB1.Affect Sales Doll Status is no
     C           WAANST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0001           FOB Gross Amoun
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAUSVA    YL0001           FOB Gross Amoun
     C                     END                             *FI
      * CASE: DB1.Affect Sales Pnds Status is no
     C           WAVAST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0002           Weight Billed
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWABYWG    YL0002           Weight Billed
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Credit or Debit Memo
      * CASE: PAR.USR Sales Realiz. Flag is Process by Flags
     C           P5JHST    IFEQ 'P'                        *IF
      * CASE: DB1.Affect Sales Doll Status is no
     C           WAANST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0001           FOB Gross Amoun
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAUSVA    YL0001           FOB Gross Amoun
     C                     END                             *FI
      * CASE: DB1.Affect Sales Pnds Status is no
     C           WAVAST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0002           Weight Billed
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWABYWG    YL0002           Weight Billed
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.USR Sales Realiz. Flag is All
      *   |- c2    : PAR.USR Sales Realiz. Flag is CM/DM Only
      *   '-
     C           P5JHST    IFEQ 'A'                        *IF
     C           P5JHST    OREQ 'O'                        *OR
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Affect Sales Doll Status is no
      *   |- c2    : DB1.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAANST    IFEQ 'N'                        *IF
     C           WAVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0001           FOB Gross Amoun
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAUSVA    YL0001           FOB Gross Amoun
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Affect Sales Pnds Status is no
      *   |- c2    : DB1.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAVAST    IFEQ 'N'                        *IF
     C           WAANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0002           Weight Billed
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWABYWG    YL0002           Weight Billed
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * reverse sign if credit memo and positive
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit Memo
      *   |- c2    : LCL.Weight Billed is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0001    IFEQ '2'                        *IF
     C           YL0002    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  YL0002    YL0002           Weight Billed
     C                     END                             *FI
      * Calc fob gross
      * CASE: LCL.Weight Billed is Not equal zero
     C           YL0002    IFNE *ZERO                      *IF
      * Compute: FOB price/cwt
      * LCL.FOB Price/CWT =
      *    *COMPUTE ((x1/x2)/x3)
      * x1    : LCL.FOB Gross Amount
      * /     : PGM.*Synon (17,7) work field *
      * x2    : LCL.Weight Billed
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0001    DIV  YL0002    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0003           FOB Price/CWT
     C                     END                             *FI
      * Crt W010 Sales Hist   CR - WF Sales History Dwnld  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0007           Company Number
     C                     Z-ADDWAC4NB    WL0008           Key Field - Ite
     C                     Z-ADDWADPNB    WL0009           Order Sequence
     C                     Z-ADDWAUENB    WL0010           Order Secondary
     C                     MOVELP2IZSX    WL0011    P      Report Type
     C                     Z-ADDWAS5NB    WL0012           Shipped Item Co
     C                     Z-ADDWAGNDT    WL0013           Actual Shipped
     C                     Z-ADDWAA5PR    WL0014           Commodity Marke
     C                     Z-ADDWAEXQT    WL0015           Quantity Billed
     C                     Z-ADDYL0002    WL0016           Weight Billed
     C                     Z-ADDYL0001    WL0017           FOB Gross Amoun
     C                     Z-ADDYL0003    WL0018           FOB Price/CWT
     C                     MOVELWAAJCD    WL0019    P      Warehouse Code
     C                     MOVELWAIUSX    WL0020    P      Order TF Exempt
     C                     EXSR SDCRRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@HSTPG1                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Print Realization  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Default Commod
     C                     MOVEL*BLANK    WL0004           Print on Realiz
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBLNCD    WL0003           Default Commod
     C                     MOVELWBX6ST    WL0004           Print on Realiz
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCJNCD           Order Type - Sa
      * Setup key
     C                     MOVELWL0005    WCJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSC     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCOBST    WL0006           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt W010 Sales Hist   CR - WF Sales History Dwnld  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AUCPGY
     C                     Z-ADDWL0007    WDAIC3           Company Number
     C                     Z-ADDWL0008    WDD2C7           Key Field - Ite
     C                     Z-ADDWL0009    WDDPNB           Order Sequence
     C                     Z-ADDWL0010    WDUENB           Order Secondary
     C                     MOVELWL0011    WDIZSX           Report Type
     C                     Z-ADDWL0012    WDS5NB           Shipped Item Co
     C                     Z-ADDWL0013    WDGNDT           Actual Shipped
     C                     Z-ADDWL0014    WDA5PR           Commodity Marke
     C                     Z-ADDWL0015    WDEXQT           Quantity Billed
     C                     Z-ADDWL0016    WDBYWG           Weight Billed
     C                     Z-ADDWL0017    WDUSVA           FOB Gross Amoun
     C                     Z-ADDWL0018    WDE3PC           FOB Price/CWT
     C                     MOVELWL0019    WDAJCD           Warehouse Code
     C                     MOVELWL0020    WDIUSX           Order TF Exempt
      *
     C           KLCRSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDD2C7           Key Field - Ite
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Check for duplicate primary key
     C           KLCRSD    SETLL@AUCPGY                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2990' W0RTN   7
      * Send message 'WF Sales History Dwnld EX'
     C                     MOVEL'USR2990' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@AUCPGY                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Bld Sales Hst Dwn-Smm RT - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0003  1        Billing Activit
     C                     MOVEL*BLANK    WN0004  2        Print on Realiz
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ** 06/01/2009 LJB E00423 Add: Include/Exclude/Only Sample items
      * pk0224 - Create Sales History Download Summary by Shipped item co
     C                     MOVEL'Y'       YL0004           First Time Flag
     C                     MOVEL'N'       WUWXST           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WEGNDT           Actual Shipped
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSE01           Company Number
     C                     Z-ADDP3L9DT    WEGNDT           Actual Shipped
      * Establish starting position
     C           KPSSE     SETLL@HSTPG0                    *
     C           KRSSE     READE@HSTPG0                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Actual Shipped Date GE PAR.From Date
      *   |- c2    : DB1.Actual Shipped Date LE PAR.To Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEGNDT    IFGE P3L9DT                     *IF
     C           WEGNDT    IFLE P4MADT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Item code or Whse break --  Calc FOB and write record
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Shipped Item Code NE LCL.USR Item Code
      *   |- c2    : DB1.Warehouse Code NE LCL.Warehouse Code
      *   '-
     C           WES5NB    IFNE YL0005                     *IF
     C           WEAJCD    ORNE YL0006                     *OR
      * CASE: LCL.First Time Flag is NO
     C           YL0004    IFEQ 'N'                        *IF
      * CASE: LCL.Weight Billed is Not equal zero
     C           YL0007    IFNE *ZERO                      *IF
      * Compute: FOB price/cwt
      * LCL.FOB Price/CWT =
      *    *COMPUTE ((x1/x2)/x3)
      * x1    : LCL.FOB Gross Amount
      * /     : PGM.*Synon (17,7) work field *
      * x2    : LCL.Weight Billed
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0008    DIV  YL0007    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0009           FOB Price/CWT
     C                     END                             *FI
      * Rtv Last Seq Nbr      RT - W010 Sales History Dwnld  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0021           Company Number
     C                     Z-ADDYL0005    WL0022           Key Field - Ite
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0010           Order Sequence
     C                     ADD  1         YL0010           Order Sequence
      * Crt W010 Sales Hist   CR - WF Sales History Dwnld  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0007           Company Number
     C                     Z-ADDYL0005    WL0008           Key Field - Ite
     C                     Z-ADDYL0010    WL0009           Order Sequence
     C                     Z-ADD*ZERO     WL0010           Order Secondary
     C                     MOVELP2IZSX    WL0011    P      Report Type
     C                     Z-ADD*ZERO     WL0012           Shipped Item Co
     C                     Z-ADDYL0011    WL0013           Actual Shipped
     C                     Z-ADDYL0012    WL0014           Commodity Marke
     C                     Z-ADDYL0013    WL0015           Quantity Billed
     C                     Z-ADDYL0007    WL0016           Weight Billed
     C                     Z-ADDYL0008    WL0017           FOB Gross Amoun
     C                     Z-ADDYL0009    WL0018           FOB Price/CWT
     C                     MOVELYL0006    WL0019    P      Warehouse Code
     C                     MOVELWUOTTX    WL0020    P      Order TF Exempt
     C                     EXSR SDCRRC
     C                     END                             *FI
     C                     MOVEL'N'       YL0004           First Time Flag
     C                     Z-ADDWES5NB    YL0005           USR Item Code
     C                     MOVELWEAJCD    YL0006           Warehouse Code
     C                     Z-ADDWEGNDT    YL0011           Actual Shipped
     C                     Z-ADDWEA5PR    YL0012           Commodity Marke
     C                     Z-ADD*ZERO     YL0008           FOB Gross Amoun
     C                     Z-ADD*ZERO     YL0007           Weight Billed
     C                     Z-ADD*ZERO     YL0013           Quantity Billed
     C                     MOVEL'N'       WUWXST           Record Found US
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * RTV Billing Type       RT - Order Types  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWEJNCD    WL0005    P      Order Type - Sa
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WN0003    P      Billing Activit
      * RTV Print Realization  RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           Company Number
     C                     Z-ADDWES5NB    WL0002           Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WULNCD    P      Default Commod
     C                     MOVELWL0004    WN0004    P      Print on Realiz
      * Exclude CM/DM
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit or Debit Memo
      *   |- c2    : PAR.USR Sales Realiz. Flag is None
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0003    IFEQ '2'                        *IF
     C           WN0003    OREQ '3'
     C           P5JHST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CM/DM Only
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.USR Sales Realiz. Flag is CM/DM Only
      *   |- c2    : PAR.Billing Activity Type is Invoice or Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5JHST    IFEQ 'O'                        *IF
     C           WN0003    IFEQ '1'                        *IF
     C           WN0003    OREQ '4'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Include All Products?
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.USR Active Flag is Record Not Found
      *   |- c2    : PAR.Print on Realization Rpt is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6W2ST    IFEQ 'N'                        *IF
     C           WN0004    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Include Samples? (Unit Price <= .01 are samples)     E00423
      * CASE: If Samples Only, skip if unit price > .01
      *  - c1 AND c2
      *   |- c1    : PAR.Change Flag USR is Only
      *   |- c2    : DB1.Unit Price is GT .01
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P7HWSX    IFEQ 'O'                        *IF
     C           WEAKPR    IFGT .01                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: If Include Samples = No, skip unit pric <= .01
      *  - c1 AND c2
      *   |- c1    : PAR.Change Flag USR is No
      *   |- c2    : DB1.Unit Price is LE .0100
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P7HWSX    IFEQ 'N'                        *IF
     C           WEAKPR    IFLE .0100                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Record Selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * FOB amount and weight
      * CASE: PAR.Billing Activity Type is Invoice
     C           WN0003    IFEQ '1'                        *IF
      * CASE: DB1.Affect Sales Doll Status is no
     C           WEANST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0014           FOB Gross Amoun
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEUSVA    YL0014           FOB Gross Amoun
     C                     END                             *FI
      * CASE: DB1.Affect Sales Pnds Status is no
     C           WEVAST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0015           USR Weight Bill
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEBYWG    YL0015           USR Weight Bill
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Credit or Debit Memo
      * CASE: PAR.USR Sales Realiz. Flag is Process by Flags
     C           P5JHST    IFEQ 'P'                        *IF
      * CASE: DB1.Affect Sales Doll Status is no
     C           WEANST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0014           FOB Gross Amoun
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEUSVA    YL0014           FOB Gross Amoun
     C                     END                             *FI
      * CASE: DB1.Affect Sales Pnds Status is no
     C           WEVAST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0015           USR Weight Bill
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEBYWG    YL0015           USR Weight Bill
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.USR Sales Realiz. Flag is All
      *   |- c2    : PAR.USR Sales Realiz. Flag is CM/DM Only
      *   '-
     C           P5JHST    IFEQ 'A'                        *IF
     C           P5JHST    OREQ 'O'                        *OR
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Affect Sales Doll Status is no
      *   |- c2    : DB1.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEANST    IFEQ 'N'                        *IF
     C           WEVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0014           FOB Gross Amoun
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEUSVA    YL0014           FOB Gross Amoun
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Affect Sales Pnds Status is no
      *   |- c2    : DB1.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEVAST    IFEQ 'N'                        *IF
     C           WEANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0015           USR Weight Bill
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEBYWG    YL0015           USR Weight Bill
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * reverse sign if credit memo and positive
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit Memo
      *   |- c2    : LCL.USR Weight Billed 11.2  7 is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0003    IFEQ '2'                        *IF
     C           YL0015    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  YL0015    YL0015           USR Weight Bill
     C                     END                             *FI
     C                     ADD  YL0014    YL0008           FOB Gross Amoun
     C                     ADD  YL0015    YL0007           Weight Billed
     C                     ADD  WEEXQT    YL0013           Quantity Billed
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@HSTPG0                  90*
     C                     ENDDO
      * USER: Exit processing
      * Last record
      * CASE: WRK.Record Found USR is Record Found
     C           WUWXST    IFEQ 'Y'                        *IF
      * CASE: LCL.First Time Flag is NO
     C           YL0004    IFEQ 'N'                        *IF
      * CASE: LCL.Weight Billed is Not equal zero
     C           YL0007    IFNE *ZERO                      *IF
      * Compute: FOB price/cwt
      * LCL.FOB Price/CWT =
      *    *COMPUTE ((x1/x2)/x3)
      * x1    : LCL.FOB Gross Amount
      * /     : PGM.*Synon (17,7) work field *
      * x2    : LCL.Weight Billed
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0008    DIV  YL0007    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0009           FOB Price/CWT
     C                     END                             *FI
      * Rtv Last Seq Nbr      RT - W010 Sales History Dwnld  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0021           Company Number
     C                     Z-ADDYL0005    WL0022           Key Field - Ite
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0010           Order Sequence
     C                     ADD  1         YL0010           Order Sequence
      * Crt W010 Sales Hist   CR - WF Sales History Dwnld  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0007           Company Number
     C                     Z-ADDYL0005    WL0008           Key Field - Ite
     C                     Z-ADDYL0010    WL0009           Order Sequence
     C                     Z-ADD*ZERO     WL0010           Order Secondary
     C                     MOVELP2IZSX    WL0011    P      Report Type
     C                     Z-ADD*ZERO     WL0012           Shipped Item Co
     C                     Z-ADDYL0011    WL0013           Actual Shipped
     C                     Z-ADDYL0012    WL0014           Commodity Marke
     C                     Z-ADDYL0013    WL0015           Quantity Billed
     C                     Z-ADDYL0007    WL0016           Weight Billed
     C                     Z-ADDYL0008    WL0017           FOB Gross Amoun
     C                     Z-ADDYL0009    WL0018           FOB Price/CWT
     C                     MOVELYL0006    WL0019    P      Warehouse Code
     C                     MOVELWUOTTX    WL0020    P      Order TF Exempt
     C                     EXSR SDCRRC
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Last Seq Nbr      RT - W010 Sales History Dwnld  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFD2C7    WQSF02           Key Field - Ite
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Key Field - Ite
      * Setup key
     C                     Z-ADDWL0021    WQSF01           Company Number
     C                     Z-ADDWL0022    WQSF02           Key Field - Ite
      * Establish starting position
     C           KRSSF     SETLL@AUCPKG                    *
     C           KRSSF     READE@AUCPKG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2989' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0023           Order Sequence
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFDPNB    WL0023           Order Sequence
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@AUCPKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * RMC 1/5/6 Add Sbd Marketing Accrual back into Fob Gross Amount
      * RMC 1/12/6 Dont add Sbd Marketing Accrual back into Fob Gross Amo
      *   now it is in the calculation of the fob gross
      * RMC 1/20/6 For Dtl Dwnld - output Order TF Exempt code
      * 6/01/2009 LJB E00423 Add: Include/Exclude/Only Sample Items
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAORIT           Original Item
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WABYWG           Weight Billed
     C                     Z-ADD*ZERO     WAS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WAUTVA           Standard Overag
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WACKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WAR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WAONVA           Actual Freight
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WAUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WAUOVA           Commission Amou
     C                     Z-ADD*ZERO     WAUPVA           Financials Amou
     C                     Z-ADD*ZERO     WAUQVA           Financials Amou
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WAIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WANYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WABZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WAA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WACDPR           Market Value
     C                     Z-ADD*ZERO     WAD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WAD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WACEVL           Sales Expense T
     C                     Z-ADD*ZERO     WAOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WAD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WACFVL           HST Item Target
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Default Commod Mark basis
     C                     MOVEL*BLANK    WULNCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Item Category N
     C                     Z-ADD*ZERO     WBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           Production Lead
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WBILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WBCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WBCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WBCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WBCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WBCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WBCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WBF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WBF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WBBNNB           Production Qty
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDD2C7           Key Field - Ite
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WDEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WDBYWG           Weight Billed
     C                     Z-ADD*ZERO     WDUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WDE3PC           FOB Price/CWT
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004  2
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0005  2
     C                     MOVEL*BLANK    WL0006  1
      * Define local variables for subroutine SDCRRC.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  1
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014 114
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018 114
     C                     MOVEL*BLANK    WL0019  3
     C                     MOVEL*BLANK    WL0020  2
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  30
      * Define local work field FOB Gross Amount
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field Weight Billed
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field FOB Price/CWT
     C                     Z-ADD*ZERO     YL0003 114
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field USR Item Code
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field Weight Billed
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field FOB Gross Amount
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field FOB Price/CWT
     C                     Z-ADD*ZERO     YL0009 114
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Commodity Market Price
     C                     Z-ADD*ZERO     YL0012 114
      * Define local work field Quantity Billed
     C                     Z-ADD*ZERO     YL0013 112
      * Define local work field FOB Gross Amount      USR
     C                     Z-ADD*ZERO     YL0014  92
      * Define local work field USR Weight Billed 11.2  7
     C                     Z-ADD*ZERO     YL0015 112
      *================================================================
     CSR         ZZEXIT    ENDSR
