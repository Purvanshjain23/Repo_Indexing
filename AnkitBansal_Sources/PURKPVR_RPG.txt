     H/TITLE PMT Order Acknowledge PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISAAGRA
     H* Date          : 07/23/25  Time  : 07:49:38
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPURKPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: PMT Order Acknowledge PV  Prompt & validate record
      *
     FCAAPREL4IF  E           K        DISK
      * RSQ : Salesperson               By Sales Type
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FPDMKCPL1IF  E           K        DISK
      * RTV : AR Claim Header           Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPNGVREL1IF  E           K        DISK
      * RTV : Warehouse Dist Entry      Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDLWREL1IF  E           K        DISK
      * RTV : Territory State           Retrieval index
      *
     FPDLVREL1IF  E           K        DISK
      * RTV : Territory Master          Retrieval index
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FPOC5REL0IF  E           K        DISK
      * RTV : Broker News               Retrieval index
      *
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 009  5 0A
     E                    W0END   7 009  5 0A
     E                    W0NAM   7 009 10
      * Long constants
     E                    @CN#    1  09  6   @CN    25
      * Set wdw location allowed?
     E                    YSL         1  1
     I@APREWI
      * Salesperson               By Sales Type
      * Renamed input format fields
     I              APBCCD                          WABCCD
     I              APALTX                          WAALTX
     I              APACNA                          WAACNA
     I              APADNA                          WAADNA
     I              APAENA                          WAAENA
     I              APAJNA                          WAAJNA
     I              APBGCD                          WABGCD
     I              APBTTX                          WABTTX
     I              APBVTX                          WABVTX
     I              APBWTX                          WABWTX
     I              APDZTX                          WADZTX
     I              APD0TX                          WAD0TX
     I              APD1TX                          WAD1TX
     I              APLVCD                          WALVCD
     I              APKZCD                          WAKZCD
     I              APAIC3                          WAAIC3
     I              APAVNB                          WAAVNB
     I              APDSCD                          WADSCD
     I              APUVST                          WAUVST
     I              APUWST                          WAUWST
     I              APUXST                          WAUXST
     I              APVSST                          WAVSST
     I              APAATM                          WAAATM
     I              APAYNA                          WAAYNA
     I              APA0NA                          WAA0NA
     I              APAXDT                          WAAXDT
      *
     I@ABREUA
      * Company Name and Address  Active records
      * Renamed input format fields
     I              ABAIC3                          WBAIC3
     I              ABADTX                          WBADTX
     I              ABACNA                          WBACNA
     I              ABADNA                          WBADNA
     I              ABAENA                          WBAENA
     I              ABAJNA                          WBAJNA
     I              ABBTTX                          WBBTTX
     I              ABBVTX                          WBBVTX
     I              ABBWTX                          WBBWTX
     I              ABA2NA                          WBA2NA
     I              ABABTX                          WBABTX
     I              ABBGCD                          WBBGCD
     I              ABKXCD                          WBKXCD
     I              ABUVST                          WBUVST
     I              ABUWST                          WBUWST
     I              ABUXST                          WBUXST
     I              ABVSST                          WBVSST
     I              ABAATM                          WBAATM
     I              ABAYNA                          WBAYNA
     I              ABA0NA                          WBA0NA
     I              ABAXDT                          WBAXDT
      *
     I@MKCPWB
      * AR Claim Header           Retrieval index
      * Renamed input format fields
     I              MKC0C7                          WCC0C7
     I              MKZLCD                          WCZLCD
     I              MKBIC3                          WCBIC3
     I              MKALNX                          WCALNX
     I              MKRMNB                          WCRMNB
     I              MKC3C7                          WCC3C7
     I              MKRFTX                          WCRFTX
     I              MKCHSX                          WCCHSX
     I              MKCJSX                          WCCJSX
     I              MKAYVL                          WCAYVL
     I              MKAZVL                          WCAZVL
     I              MKA0VL                          WCA0VL
     I              MKPQTX                          WCPQTX
     I              MKCNSX                          WCCNSX
     I              MKPLTX                          WCPLTX
     I              MKCOSX                          WCCOSX
     I              MKPMTX                          WCPMTX
     I              MKCPSX                          WCCPSX
     I              MKA1VL                          WCA1VL
     I              MKPNTX                          WCPNTX
     I              MKPOTX                          WCPOTX
     I              MKMLDT                          WCMLDT
     I              MKEJDT                          WCEJDT
     I              MKCQSX                          WCCQSX
     I              MKPPTX                          WCPPTX
     I              MKMMDT                          WCMMDT
     I              MKMNDT                          WCMNDT
     I              MKBGTM                          WCBGTM
     I              MKCGVN                          WCCGVN
     I              MKC4C7                          WCC4C7
     I              MKO2NA                          WCO2NA
     I              MKNFDT                          WCNFDT
     I              MKBJTM                          WCBJTM
     I              MKCQVN                          WCCQVN
     I              MKMODT                          WCMODT
     I              MKBHTM                          WCBHTM
     I              MKCHVN                          WCCHVN
     I              MKCRSX                          WCCRSX
     I              MKMPDT                          WCMPDT
     I              MKBITM                          WCBITM
     I              MKCIVN                          WCCIVN
     I              MKTBTX                          WCTBTX
     I              MKEOVL                          WCEOVL
     I              MKEPVL                          WCEPVL
     I              MKP6DT                          WCP6DT
     I              MKCRTM                          WCCRTM
     I              MKYSNX                          WCYSNX
     I              MKT5SX                          WCT5SX
     I              MKF7PC                          WCF7PC
     I              MKF8PC                          WCF8PC
     I              MKF9PC                          WCF9PC
     I              MKEQVL                          WCEQVL
     I              MKERVL                          WCERVL
     I              MKESVL                          WCESVL
     I              MKETVL                          WCETVL
     I              MKT7SX                          WCT7SX
     I              MKT8SX                          WCT8SX
     I              MKT9SX                          WCT9SX
     I              MKUASX                          WCUASX
     I              MKUBSX                          WCUBSX
     I              MKGAPC                          WCGAPC
     I              MKGBPC                          WCGBPC
     I              MKVSST                          WCVSST
     I              MKMJDT                          WCMJDT
     I              MKBETM                          WCBETM
     I              MKCCVN                          WCCCVN
     I              MKCDVN                          WCCDVN
     I              MKMKDT                          WCMKDT
     I              MKBFTM                          WCBFTM
     I              MKCEVN                          WCCEVN
     I              MKCFVN                          WCCFVN
     I              MKTXAA                          WCTXAA
     I              MKC8AB                          WCC8AB
     I              MKEJAB                          WCEJAB
     I              MKDMAB                          WCDMAB
     I              MKWUU1                          WCWUU1
     I              MKXPU1                          WCXPU1
     I              MKFAVN                          WCFAVN
     I              MKBVTS                          WCBVTS
     I              MKWAU1                          WCWAU1
     I              MKFBVN                          WCFBVN
     I              MKBWTS                          WCBWTS
     I              MKWBU1                          WCWBU1
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
     I              ADQDSC                          WEQDSC
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WFAIC3
     I              AMC4NB                          WFC4NB
     I              AMRMNB                          WFRMNB
     I              AMRUNB                          WFRUNB
     I              AMXACD                          WFXACD
     I              AMOANA                          WFOANA
     I              AMHBAA                          WFHBAA
     I              AMJ0T1                          WFJ0T1
     I              AMGENY                          WFGENY
     I              AMJ1T1                          WFJ1T1
     I              AMHCAA                          WFHCAA
     I              AMQWDT                          WFQWDT
     I              AMQXDT                          WFQXDT
     I              AMQYDT                          WFQYDT
     I              AMHDAA                          WFHDAA
     I              AMCCTX                          WFCCTX
     I              AMJ2T1                          WFJ2T1
     I              AMRLNA                          WFRLNA
     I              AMRMNA                          WFRMNA
     I              AMGINY                          WFGINY
     I              AMGFNY                          WFGFNY
     I              AMGGNY                          WFGGNY
     I              AMGHNY                          WFGHNY
     I              AMHEVL                          WFHEVL
     I              AMHFVL                          WFHFVL
     I              AMHGVL                          WFHGVL
     I              AMQZDT                          WFQZDT
     I              AMQ0DT                          WFQ0DT
     I              AMQ1DT                          WFQ1DT
     I              AMQ2DT                          WFQ2DT
     I              AMC2TX                          WFC2TX
     I              AMC3TX                          WFC3TX
     I              AMC6TX                          WFC6TX
     I              AMCHTX                          WFCHTX
     I              AMCITX                          WFCITX
     I              AMCLTX                          WFCLTX
     I              AMB4TX                          WFB4TX
     I              AMCUTX                          WFCUTX
     I              AMCVTX                          WFCVTX
     I              AMB9TX                          WFB9TX
     I              AMJWSC                          WFJWSC
     I              AMITNY                          WFITNY
     I              AMLMT1                          WFLMT1
     I              AMLWAA                          WFLWAA
     I              AMFVST                          WFFVST
     I              AMF0ST                          WFF0ST
     I              AMF2ST                          WFF2ST
     I              AMF3ST                          WFF3ST
     I              AMJUSC                          WFJUSC
     I              AMJVSC                          WFJVSC
     I              AMV3T1                          WFV3T1
     I              AMV4T1                          WFV4T1
     I              AMV5T1                          WFV5T1
     I              AMV6T1                          WFV6T1
     I              AMV7T1                          WFV7T1
     I              AMV8T1                          WFV8T1
     I              AMV9T1                          WFV9T1
     I              AMWAT1                          WFWAT1
     I              AMWBT1                          WFWBT1
     I              AMWCT1                          WFWCT1
     I              AMWDT1                          WFWDT1
     I              AMQJNY                          WFQJNY
     I              AMQKNY                          WFQKNY
     I              AMQLNY                          WFQLNY
     I              AMP8NY                          WFP8NY
     I              AMP9NY                          WFP9NY
     I              AMQANY                          WFQANY
     I              AMQCNY                          WFQCNY
     I              AMQDNY                          WFQDNY
     I              AMQENY                          WFQENY
     I              AMQFNY                          WFQFNY
     I              AMQGNY                          WFQGNY
     I              AMQHNY                          WFQHNY
     I              AMQINY                          WFQINY
     I              AMQMNY                          WFQMNY
     I              AMMYU1                          WFMYU1
     I              AMJXSC                          WFJXSC
     I              AMJYSC                          WFJYSC
     I              AMJZSC                          WFJZSC
     I              AMJ0SC                          WFJ0SC
     I              AMMZU1                          WFMZU1
     I              AMM0U1                          WFM0U1
     I              AMM1U1                          WFM1U1
     I              AMM2U1                          WFM2U1
     I              AMM3U1                          WFM3U1
     I              AMW5DT                          WFW5DT
     I              AMW6DT                          WFW6DT
     I              AMUVST                          WFUVST
     I              AMUWST                          WFUWST
     I              AMUXST                          WFUXST
     I              AMVSST                          WFVSST
     I              AMAATM                          WFAATM
     I              AMAYNA                          WFAYNA
     I              AMA0NA                          WFA0NA
     I              AMAXDT                          WFAXDT
      *
     I@GVREIL
      * Warehouse Dist Entry      Retrieval index
      * Renamed input format fields
     I              GVAJCD                          WGAJCD
     I              GVMNAA                          WGMNAA
     I              GVS8NY                          WGS8NY
     I              GVXST1                          WGXST1
     I              GVL4ST                          WGL4ST
     I              GVXTT1                          WGXTT1
     I              GVXUT1                          WGXUT1
     I              GVL5ST                          WGL5ST
     I              GVVSST                          WGVSST
     I              GVMJDT                          WGMJDT
     I              GVBETM                          WGBETM
     I              GVCCVN                          WGCCVN
     I              GVCDVN                          WGCDVN
     I              GVMKDT                          WGMKDT
     I              GVBFTM                          WGBFTM
     I              GVCEVN                          WGCEVN
     I              GVCFVN                          WGCFVN
      *
     I@LWRERA
      * Territory State           Retrieval index
      * Renamed input format fields
     I              LWBGCD                          WHBGCD
     I              LWX3CD                          WHX3CD
     I              LWUVST                          WHUVST
     I              LWUWST                          WHUWST
     I              LWUXST                          WHUXST
     I              LWVSST                          WHVSST
     I              LWAATM                          WHAATM
     I              LWAYNA                          WHAYNA
     I              LWA0NA                          WHA0NA
     I              LWAXDT                          WHAXDT
      *
     I@LVREQ7
      * Territory Master          Retrieval index
      * Renamed input format fields
     I              LVX3CD                          WIX3CD
     I              LVOKNA                          WIOKNA
     I              LVS1SX                          WIS1SX
     I              LVS2SX                          WIS2SX
     I              LVS3SX                          WIS3SX
     I              LVS4SX                          WIS4SX
     I              LVFQAA                          WIFQAA
     I              LVUVST                          WIUVST
     I              LVUWST                          WIUWST
     I              LVUXST                          WIUXST
     I              LVVSST                          WIVSST
     I              LVAATM                          WIAATM
     I              LVAYNA                          WIAYNA
     I              LVA0NA                          WIA0NA
     I              LVAXDT                          WIAXDT
      *
     I@APREBU
      * Salesperson               Retrieval index       V
      * Renamed input format fields
     I              APBCCD                          WJBCCD
     I              APALTX                          WJALTX
     I              APACNA                          WJACNA
     I              APADNA                          WJADNA
     I              APAENA                          WJAENA
     I              APAJNA                          WJAJNA
     I              APBGCD                          WJBGCD
     I              APBTTX                          WJBTTX
     I              APBVTX                          WJBVTX
     I              APBWTX                          WJBWTX
     I              APDZTX                          WJDZTX
     I              APD0TX                          WJD0TX
     I              APD1TX                          WJD1TX
     I              APLVCD                          WJLVCD
     I              APKZCD                          WJKZCD
     I              APAIC3                          WJAIC3
     I              APAVNB                          WJAVNB
     I              APDSCD                          WJDSCD
     I              APUVST                          WJUVST
     I              APUWST                          WJUWST
     I              APUXST                          WJUXST
     I              APVSST                          WJVSST
     I              APAATM                          WJAATM
     I              APAYNA                          WJAYNA
     I              APA0NA                          WJA0NA
     I              APAXDT                          WJAXDT
      *
     I@HORELA
      * Customer Accrual          Retrieval index
      * Renamed input format fields
     I              HOBKC7                          WKBKC7
     I              HOOJCD                          WKOJCD
     I              HOGUNY                          WKGUNY
     I              HOBFDT                          WKBFDT
     I              HOA2DT                          WKA2DT
     I              HOBKPR                          WKBKPR
     I              HOTTST                          WKTTST
     I              HOSHSX                          WKSHSX
     I              HOQDSX                          WKQDSX
     I              HOPJDT                          WKPJDT
     I              HOPKDT                          WKPKDT
     I              HOECVL                          WKECVL
     I              HOQESX                          WKQESX
     I              HOQFSX                          WKQFSX
     I              HOHHAA                          WKHHAA
     I              HOHQVL                          WKHQVL
     I              HOQGSX                          WKQGSX
     I              HOQHSX                          WKQHSX
     I              HOQISX                          WKQISX
     I              HOQJSX                          WKQJSX
     I              HOUVST                          WKUVST
     I              HOUWST                          WKUWST
     I              HOUXST                          WKUXST
     I              HOAATM                          WKAATM
     I              HOAYNA                          WKAYNA
     I              HOA0NA                          WKA0NA
     I              HOAXDT                          WKAXDT
      *
     I@C5RESJ
      * Broker News               Retrieval index
      * Renamed input format fields
     I              C5HHAA                          WLHHAA
     I              C5C4T1                          WLC4T1
     I              C5QMNA                          WLQMNA
     I              C5QNNA                          WLQNNA
     I              C5QONA                          WLQONA
     I              C5QPNA                          WLQPNA
     I              C5C5T1                          WLC5T1
     I              C5C6T1                          WLC6T1
     I              C5C7T1                          WLC7T1
     I              C5C8T1                          WLC8T1
     I              C5C9T1                          WLC9T1
     I              C5DAT1                          WLDAT1
     I              C5DBT1                          WLDBT1
     I              C5DCT1                          WLDCT1
     I              C5DDT1                          WLDDT1
     I              C5PWSX                          WLPWSX
     I              C5PXSX                          WLPXSX
     I              C5PYSX                          WLPYSX
     I              C5PZSX                          WLPZSX
     I              C5BCCD                          WLBCCD
     I              C5UVST                          WLUVST
     I              C5UWST                          WLUWST
     I              C5UXST                          WLUXST
     I              C5VSST                          WLVSST
     I              C5AATM                          WLAATM
     I              C5AYNA                          WLAYNA
     I              C5A0NA                          WLA0NA
     I              C5AXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Ship To Customer
     I                                    P   7  100P1BKC7
      * I :  Block Order Flag
     I                                       11  11 P1BCST
      * I :  OH Load Plan Ready
     I                                       12  13 P1FVSX
     IP2PARM      DS
      * FLD: Salesperson
      * I :  Salesperson Code
     I                                        1   3 P2BCCD
      * I :  Salesperson Name
     I                                        4  33 P2ALTX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Generic Message 80 ERR'
      * Generic Message 80 USR
     I                                        1  80 ZA0001
      * Message data for 'Generic Message 80 ERR'
      * Generic Message 80 USR
     I                                        1  80 ZA0002
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1BKC7    PARM           WP0003  70       Ship To Custome
     C           P1BCST    PARM           WP0004  1        Block Order Fla
     C           P1FVSX    PARM           WP0005  2        OH Load Plan Re
     C           P2BCCD    PARM           WP0006  3        Salesperson Cod
     C           P2ALTX    PARM           WP0007 30        Salesperson Nam
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Reposition window
     C   26                CAS            ZRRPWD
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     Z-ADD1         YWPNNO  10       Panel number
     C                     MOVEL'S'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
     C                     Z-ADD1         W0WASM  10
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: User defined action
      * 08/06/24 SP S312312-Start (Adding new condition c6)
      * Perform print, email, or fax
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : DTL.Print (Yes/No) USR is Yes
      *   |- c2    : DTL.Status Flag 7  Y/N is Yes
      *   |- c3    : DTL.Status Flag 2  Y/N is Yes
      *   |- c4    : DTL.Status Flag 3  Y/N is Yes
      *   |- c5    : DTL.Status Flag 8  Y/N is Yes
      *   |- c6    : DTL.Email to Broker Usr is Yes
      *   |- c7    : DTL.Email to Salesperson Usr is Yes
      *   '-
     C           #DDTSX    IFEQ 'Y'                        *IF
     C           #DAKTX    OREQ 'Y'                        *OR
     C           #DQ2ST    OREQ 'Y'                        *OR
     C           #DQ3ST    OREQ 'Y'                        *OR
     C           #DAFTX    OREQ 'Y'                        *OR
     C           #DQESC    OREQ 'Y'                        *OR
     C           #DQZSC    OREQ 'Y'                        *OR
      * PMT Print Option  SHR  PV - Print Options  * 
     C                     CALL 'PDG0PVR'              90  PMT Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,001   WQ0001 25        PRT Description
     C           YL0001    PARM YL0001    WQ0002 10        PRT Printer Dev
     C           YL0002    PARM YL0002    WQ0003  4        PRT Hold Output
     C           YL0003    PARM YL0003    WQ0004  4        PRT Save Output
     C           YL0004    PARM YL0004    WQ0005  20       PRT Number of C
     C           YL0005    PARM YL0005    WQ0006  1        PRT Night Queue
     C           YL0006    PARM YL0006    WQ0007 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0008  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If F3 pressed, remain on screen; ELSE process request
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Print Acknowledgement: Print Y/N = Y OR Status Flag 8 = Y
      * CASE: Print Y/N is Yes OR Email to Warehouse is Yes
      *  - c1 OR c2 OR c3
      *   |- c1    : DTL.Print (Yes/No) USR is Yes
      *   |- c2    : DTL.Status Flag 8  Y/N is Yes
      *   |- c3    : DTL.Email to Salesperson Usr is Yes
      *   '-
     C           #DDTSX    IFEQ 'Y'                        *IF
     C           #DAFTX    OREQ 'Y'                        *OR
     C           #DQZSC    OREQ 'Y'                        *OR
      * ** Status Flag 8=Email to Warehouse
     C                     MOVEL'N'       YL0005           PRT Night Queue
      * If F3 pressed, do not print; ELSE print acknowledgement
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0008    YL0007           Email to Wareho
      * PRT Acknowledgements UP - Order Header TRG  * 
     C                     CALL 'PDJWPCLP'             90  PRT Acknowledge
     C                     PARM P1AIC3    WQ0009 155       Company Number
     C                     PARM P1C4NB    WQ0010 155       Order Number 1
     C                     PARM P1C4NB    WQ0011 155       Order Number 2
     C                     PARM *ZERO     WQ0012 155       Date 1
     C                     PARM *ZERO     WQ0013 155       Date 2
     C                     PARM *ZERO     WQ0014 155       Thru Date Pass
     C                     PARM *BLANK    WQ0015  2        Order Type_Sale
     C                     PARM YL0009    WQ0016  2        Shipping Method
     C                     PARM '1'       WQ0017  1        Billing Activit
     C                     PARM 'A'       WQ0018  1        Export Sales
     C                     PARM *BLANK    WQ0019  3        USR Warehouse C
     C                     PARM *BLANK    WQ0020  3        USR CDE Parm 1
     C                     PARM *BLANK    WQ0021  3        USR CDE Parm 2
     C                     PARM *BLANK    WQ0022  3        USR CDE Parm 3
     C                     PARM *BLANK    WQ0023  3        USR CDE Parm 4
     C                     PARM *BLANK    WQ0024  3        USR CDE Parm 5
     C                     PARM *BLANK    WQ0025  3        USR CDE Parm 6
     C                     PARM *BLANK    WQ0026  3        USR CDE Parm 7
     C                     PARM *BLANK    WQ0027  3        USR CDE Parm 8
     C                     PARM *BLANK    WQ0028  3        USR CDE Parm 9
     C                     PARM 'S'       WQ0029  1        USR Select/Omit
     C                     PARM YL0001    WQ0030 10        PRT Printer Dev
     C                     PARM YL0002    WQ0031  4        PRT Hold Output
     C                     PARM YL0003    WQ0032  4        PRT Save Output
     C                     PARM YL0004    WQ0033 155       System Value Nu
     C                     PARM '*JOBD'   WQ0034 10        PRT Night Queue
     C                     PARM *ZERO     WQ0035 155       Date 3
     C                     PARM #DAFTX    WQ0036  1        Email To Whs
     C                     PARM YL0007    WQ0037  3        Email to Wareho
     C                     PARM #DQZSC    WQ0038  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993638*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Email to Regional Sales Manager: Status Flag 3 = Y
      * CASE: DTL.Status Flag 3  Y/N is Yes
     C           #DQ3ST    IFEQ 'Y'                        *IF
      * ** Status Flag 3=Regional Sales Manager
      * 08/06/24 SP S312312-Start (Passing Blank to Email ID)
      * Eml Acknowledgements UP - Order Header TRG  * 
     C                     CALL 'PBIQUPC'              90  Eml Acknowledge
     C                     PARM P1AIC3    WQ0039 155       Company Number
     C                     PARM P1C4NB    WQ0040 155       Order Number 1
     C                     PARM P1C4NB    WQ0041 155       Order Number 2
     C                     PARM *ZERO     WQ0042 155       Customer Number
     C                     PARM #DBCCD    WQ0043  3        Sales Route Cod
     C                     PARM 'N'       WQ0044  1        Status Flag 2
     C                     PARM #DQ3ST    WQ0045  1        Status Flag 3
     C                     PARM *BLANK    WQ0046 50        Broker Email Ad
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBIQUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993534*
     C                     END
      * 08/06/24 SP S312312-End
     C                     END                             *FI
      * 08/06/24 SP S312312-Start(Adding new condition c4)
      * Fax Acknowledgement..: Status flag 2 OR 7 = Y
      * CASE: Fax/Email Buyer OR Fax Cust = Y OR Email Broker
      *  - c1 OR c3 OR c4
      *   |- c1    : DTL.Status Flag 2  Y/N is Yes
      *   |- c3    : DTL.Status Flag 7  Y/N is Yes
      *   |- c4    : DTL.Email to Broker Usr is Yes
      *   '-
     C           #DQ2ST    IFEQ 'Y'                        *IF
     C           #DAKTX    OREQ 'Y'                        *OR
     C           #DQESC    OREQ 'Y'                        *OR
      * ** Status Flag 2=Buyer Fax/Email
      * ** Status Flag 7=Customer Fax
      * 08/21/2017 DN T11489-Added Salesperson Code to Parm.
      * 07/23/25 AA S033369-Start -Do not pass Regional Sales Flag to par
      * 'USR Check Y/N Status' as email sent in previous step.
      * EXC Fax Acknwgmnt     XF - Order Header TRG  * 
     C                     CALL 'PPFDXFR'              90  EXC Fax Acknwgm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0047  30       Company Number
     C                     PARM P1C4NB    WQ0048  70       Order Number
     C                     PARM P1BKC7    WQ0049  70       Ship To Custome
     C                     PARM #1FXSX    WQ0050  3        HPB Ship to War
     C                     PARM P2BCCD    WQ0051  3        Salesperson Cod
     C                     PARM #DQ2ST    WQ0052  1        USR Update Flag
     C                     PARM *BLANK    WQ0053  1        USR Check Y/N S
     C                     PARM 'N'       WQ0054  1        Status - Y or N
     C                     PARM #DAKTX    WQ0055  1        Status Flag 7
     C                     PARM #DQESC    WQ0056  1        Email to Broker
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPFDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993332*
     C                     SETON                     37    *
     C                     END
      * 07/23/25 AA S033369-End
     C                     END                             *FI
      * 08/06/24 SP S312312-End
     C                     END                             *FI
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Print (Yes/No) USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DDTSX'  IFEQ YPMTFD
      * Print (Yes/No) USR
     C                     MOVEL#DDTSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHDTSX
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHDTSX
     C           W0INVL    WHEQ 'O'                        O
     C                     Z-ADD2         ZHDTSX
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD3         ZHDTSX
     C                     ENDSL
     C                     EXFMTZGDTSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHDTSX    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHDTSX    WHEQ 2
     C                     MOVEL'O'       W0INVL           O
     C           ZHDTSX    WHEQ 3
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DDTSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Status Flag 7  Y/N
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DAKTX'  IFEQ YPMTFD
      * Status Flag 7  Y/N
     C                     MOVEL#DAKTX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHAKTX
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHAKTX
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHAKTX
     C                     ENDSL
     C                     EXFMTZGAKTX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHAKTX    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHAKTX    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DAKTX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Status Flag 2  Y/N
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DQ2ST'  IFEQ YPMTFD
      * Status Flag 2  Y/N
     C                     MOVEL#DQ2ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHQ2ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHQ2ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHQ2ST
     C                     ENDSL
     C                     EXFMTZGQ2ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHQ2ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHQ2ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DQ2ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Status Flag 3  Y/N
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DQ3ST'  IFEQ YPMTFD
      * Status Flag 3  Y/N
     C                     MOVEL#DQ3ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHQ3ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHQ3ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHQ3ST
     C                     ENDSL
     C                     EXFMTZGQ3ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHQ3ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHQ3ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DQ3ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Status Flag 8  Y/N
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DAFTX'  IFEQ YPMTFD
      * Status Flag 8  Y/N
     C                     MOVEL#DAFTX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHAFTX
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHAFTX
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHAFTX
     C                     ENDSL
     C                     EXFMTZGAFTX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHAFTX    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHAFTX    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DAFTX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Email to Broker Usr
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#DQESC    W0NSRQ  1        Email to Broker
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#DQESC'  OREQ YPMTFD
     C                     CALL 'CAVLLWR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1835713   Y2LSNO  70
     C           #DQESC    PARM #DQESC    W0EXVL 25        Email to Broker
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Email to Salesperson Usr
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#DQZSC    W0NSRQ  1        Email to Salesp
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#DQZSC'  OREQ YPMTFD
     C                     CALL 'CAVLLWR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1835713   Y2LSNO  70
     C           #DQZSC    PARM #DQZSC    W0EXVL 25        Email to Salesp
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
     C                     MOVEL'N'       W0DCF            *Defer confirm
      * Prompt for Salesperson Code; ELSE Validate Salesperson Code
      * CASE: F4 pressed AND Cursor is on Salesperson Code
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Salesperson Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DBCCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    #DY8TX           Text USR 7
      * SEL Regional Sls Mgr 2 SR - Salesperson  * 
     C                     CALL 'PUECSRR'              90  SEL Regional Sl
     C                     PARM *BLANK    W0RTN   7
     C           #DBCCD    PARM #DBCCD    WQ0057  3        Salesperson Cod
     C           #DY8TX    PARM #DY8TX    WQ0058 30        Salesperson Nam
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUECSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * T11489 DN 08/17/17-Allow to Select a Regional Sales Manager.
      * CASE: DTL.Status Flag 3  Y/N is Yes
     C           #DQ3ST    IFEQ 'Y'                        *IF
      * Validate Salesperson Code.
      * CASE: DTL.Salesperson Code is entered
     C           #DBCCD    IFNE *BLANK                     *IF
      * RTV Regional Sls Mgr   RT - Salesperson  * 
     C                     EXSR SARVGN
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELYL0010    #DY8TX           Text USR 7
      * Defer Confrim If First Time Through.
      * CASE: LCL.First Time Flag is Yes
     C           YL0011    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0011           First Time Flag
     C                     MOVEL#DBCCD    YL0012           Salesperson Cod
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Defer Confrim If Salesperson Code Changes.
      * CASE: DTL.Salesperson Code NE LCL.Salesperson Code
     C           #DBCCD    IFNE YL0012                     *IF
     C                     MOVEL#DBCCD    YL0012           Salesperson Cod
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     MOVEL#DBCCD    YL0012           Salesperson Cod
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,003   CAT  @CN,004:ZQYL0013    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0013    ZA0001           Generic Message
      * Send message 'Generic Message 80 ERR'
     C                     MOVEL'USR4977' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,005   CAT  @CN,006:ZQYL0013    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0013    ZA0002           Generic Message
      * Send message 'Generic Message 80 ERR'
     C                     MOVEL'USR4977' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0012           Salesperson Cod
     C                     MOVEL*BLANK    YL0010           Salesperson Nam
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Company Name and Address
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to AR Claim Header
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
      * CASE: DTL.Salesperson Code is not entered
     C           #DBCCD    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Print (Yes/No) USR required
     C           #DDTSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Status Flag 7  Y/N required
     C           #DAKTX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0016    IFEQ *BLANK                     *IF
     C           YL0016    OREQ 'N'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0017    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     MOVEL*BLANK    #DDXSX           Display Flag 1
     C                     MOVEL*BLANK    #DHVSX           EDI Advanced Sh
     C                     MOVEL*BLANK    #DACTX           Status Flag 6
     C                     MOVEL*BLANK    #DAJTX           Status Flag 5
     C                     MOVEL*BLANK    #DZ7TX           Text USR 4
     C                     MOVEL*BLANK    #DQKST           Display Flag
     C                     MOVEL*BLANK    #DFMST           Status Flag 4
     C                     Z-ADD*ZERO     #1AIC3           Company Number
     C                     Z-ADD*ZERO     #1C4NB           Order Number
     C                     Z-ADD*ZERO     #1VRVA           A_R order Value
     C                     MOVEL*BLANK    #1OBST           Billing Activit
     C                     MOVEL*BLANK    #1BCST           Block Order Fla
     C                     MOVEL*BLANK    #1BDST           Order Certifica
     C                     Z-ADD*ZERO     #1B7VL           Invoice Order V
     C                     MOVEL*BLANK    #1GASX           Process Sts for
     C                     MOVEL*BLANK    #1GBSX           Order Conf Fax
     C                     MOVEL*BLANK    #1GCSX           Manifest Fax St
     C                     MOVEL*BLANK    #1GDSX           Invoice Fax Sts
     C                     MOVEL*BLANK    #1FNSX           Transfer in Sto
     C                     MOVEL*BLANK    #1FOSX           Email Cust On O
     C                     MOVEL*BLANK    #1FPSX           Order Emailed
     C                     MOVEL*BLANK    #1FQSX           Export Docs Go
     C                     MOVEL*BLANK    #1FRSX           Shipping Temp C
     C                     MOVEL*BLANK    #1FSSX           Broker Order St
     C                     MOVEL*BLANK    #1FTSX           Air Freight Ord
     C                     MOVEL*BLANK    #1FUSX           Order Requires
     C                     MOVEL*BLANK    #DSPST           Load Plan Ready
     C                     MOVEL*BLANK    #1FVSX           OH Load Plan Re
     C                     MOVEL*BLANK    #1FWSX           Export USDA App
     C                     MOVEL*BLANK    #1FXSX           HPB Ship to War
     C                     MOVEL*BLANK    #1FYSX           OH TF Exempt Co
     C                     Z-ADD*ZERO     #1NODT           OH Appt Confirm
     C                     Z-ADD*ZERO     #1NPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     #1NQDT           Load Actual Shi
     C                     Z-ADD*ZERO     #1NRDT           Load BOL Comple
     C                     Z-ADD*ZERO     #1NSDT           Load Truck Depa
     C                     Z-ADD*ZERO     #1BPTM           Maximum Gross W
     C                     Z-ADD*ZERO     #1BQTM           Time of Origina
     C                     Z-ADD*ZERO     #1BRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     #1BSTM           Load BOL Comple
     C                     Z-ADD*ZERO     #1BTTM           Load Truck Depa
     C                     Z-ADD*ZERO     #1H0NX           Act Frt Referen
     C                     Z-ADD*ZERO     #1H1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     #1H2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     #1H3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     #1H4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     #1C0C7           Claim Number
     C                     MOVEL*BLANK    #DDTSX           Print (Yes/No)
     C                     MOVEL*BLANK    #DAKTX           Status Flag 7
     C                     MOVEL*BLANK    #DQ2ST           Status Flag 2
     C                     MOVEL*BLANK    #DQ3ST           Status Flag 3
     C                     MOVEL*BLANK    #DBCCD           Salesperson Cod
     C                     MOVEL*BLANK    #DY8TX           Text USR 7
     C                     MOVEL*BLANK    #DAFTX           Status Flag 8
     C                     MOVEL*BLANK    #DQESC           Email to Broker
     C                     MOVEL*BLANK    #DQZSC           Email to Salesp
      * USER: Load screen
      * Initialize screen Print and Status flags to No
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DDTSX           Print (Yes/No)
     C                     MOVEL'N'       #DQ2ST           Status Flag 2
     C                     MOVEL'N'       #DQ3ST           Status Flag 3
     C                     MOVEL'N'       #DAKTX           Status Flag 7
     C                     MOVEL'N'       #DAFTX           Status Flag 8
      * Retrieve Warehouse Code and Country for Warehouse Dist List
      * RTV Chk DtlExists Info RT - Order Detail  * Get Whs Cd and Countr
     C                     EXSR SBRVGN
      * MSG 'Order has no line items'
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Send message 'Order has no line items'
     C                     MOVEL'USR2058' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * If Country is Japan, retrieve Warehouse Type and OHE Booking Nbr
      * CASE: LCL.Country Code is Japan
     C           YL0018    IFEQ 'JPN'                      *IF
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SCRVGN
      * RTV Booking # f/ord   RT - Order Header Extension  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * Rtv Whs Dist Email    RT - Warehouse Dist Entry  * Email Whs Y/N
     C                     EXSR SERVGN
      * First time, check Email to Warehouse flag
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTAST           First Time Flag
      * If Email to Warehouse flag is Yes
      * CASE: LCL.Email To Whs is yes
     C           YL0016    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       #DAFTX           Status Flag 8
     C                     END                             *FI
     C                     END                             *FI
      * * Load Plan Ready will be a hidden field/unavailable  2386/4119
      * C2586  05/16/13 RMC Dft reg sls mgr email=Y if one is found
      * Default Regional Sales Manager Email
      * CASE: DTL.Print (Yes/No) USR is *yes/no
     C           #DDTSX    IFEQ 'N'                        *IF
     C           #DDTSX    OREQ 'Y'
      * RTV Order/ShipState    RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * RTV Reg Sls Mgr FaxOnlyRT - Territory State  * 
     C                     EXSR SGRVGN
     C                     MOVELYL0023    #DBCCD           Salesperson Cod
      * Exc Rtv Reg Sls Email  XF - Salesperson Electronic CM  * 
     C                     CALL 'PBISXFR'              90  Exc Rtv Reg Sls
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0023    WQ0065  3        Salesperson Cod
     C           YL0024    PARM *BLANK    WQ0066 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBISXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Email Address or Fax is entered, load Salesperson Name
      * CASE: Email Addr is Entered OR Fax Number is Entered
      *  - c1ORc2
      *   |- c1    : LCL.Email Address is Entered
      *   |- c2    : LCL.Fax Phone Number is NE Blanks
      *   '-
     C           YL0024    IFNE *BLANK                     *IF
     C           YL0022    ORNE *BLANK                     *OR
     C                     MOVELYL0010    #DY8TX           Text USR 7
     C                     END                             *FI
     C                     END                             *FI
      * 08/06/24 SP S312312-Start
     C                     MOVEL'N'       #DQESC           Email to Broker
      * Rtv Ship to Broker Eml RT - Customer Accrual  * 
     C                     EXSR SJRVGN
      * 08/06/24 SP S312312-End
     C                     MOVEL'N'       #DQZSC           Email to Salesp
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Regional Sls Mgr   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Salesperson Nam
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABCCD    WQSA01           Salesperson Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Salesperson Cod
      * Setup key
     C                     MOVEL#DBCCD    WQSA01           Salesperson Cod
      * Establish starting position
     C           KRSSA     SETLL@APREWI                    *
     C           KRSSA     READE@APREWI                  90*
      * Data record not found
     C   90                MOVEL'USR0039' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAALTX    YL0010           Salesperson Nam
     C           KRSSA     READE@APREWI                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Chk DtlExists Info RT - Order Detail  * Get Whs Cd and Count
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           Warehouse Code
     C                     MOVEL*BLANK    YL0018           Country Code
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSB02           Order Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSB01           Company Number
     C                     Z-ADDP1C4NB    WQSB02           Order Number
      * Establish starting position
     C           KRSSB     SETLL@BGWKAE                    *
     C           KRSSB     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWDAJCD    YL0008           Warehouse Code
     C                     MOVELWDKXCD    YL0018           Country Code
     C           KRSSB     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0008    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0019           Warehouse Type
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEWPST    YL0019           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Booking # f/ord   RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WFAIC3           Company Number
     C                     Z-ADDP1C4NB    WFC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0020           OHE Booking Num
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFJ1T1    YL0020           OHE Booking Num
     C                     GOTO SDEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Whs Dist Email    RT - Warehouse Dist Entry  * Email Whs Y/N
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0016           Email To Whs
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAJCD    WQSE01           Warehouse Code
     C           *LIKE     DEFN WGMNAA    WQSE02           Distribution Co
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Warehouse Code
     C                     KFLD           WQSE02           Distribution Co
      * Setup key
     C                     MOVELYL0008    WQSE01           Warehouse Code
     C                     MOVEL@CN,009   WQSE02           Distribution Co
      * Establish starting position
     C           KRSSE     SETLL@GVREIL                    *
     C           KRSSE     READE@GVREIL                  90*
      * Data record not found
     C   90                MOVEL'USR4387' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WGVSST    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       YL0016           Email To Whs
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@GVREIL                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Order/ShipState    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    BEAIC3           Company Number
     C                     Z-ADDP1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSF     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0021           Ship To State C
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEDBCD    YL0021           Ship To State C
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Reg Sls Mgr FaxOnlyRT - Territory State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHBGCD    WQSG01           State Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           State Code
      * Setup key
     C                     MOVELYL0021    WQSG01           State Code
      * Establish starting position
     C           KRSSG     SETLL@LWRERA                    *
     C           KRSSG     READE@LWRERA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2583' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'USR0650' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    YL0010           Salesperson Nam
     C                     MOVEL*BLANK    YL0022           Fax Number FF
      * RTV Reg Sls Mgr FaxOnlyRT - Territory  * 
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Reg Sls Mgr FaxOnlyRT - Salesperson  * 
     C                     EXSR SIRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@LWRERA                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Reg Sls Mgr FaxOnlyRT - Territory  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WIX3CD           Territory Code
      * Setup key
     C                     MOVELWHX3CD    WIX3CD           Territory Code
      * Establish starting position
     C           KRSSH     CHAIN@LVREQ7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2581' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIFQAA    YL0023           Regional Salesp
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SHEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Reg Sls Mgr FaxOnlyRT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WJBCCD           Salesperson Cod
      * Setup key
     C                     MOVELYL0023    WJBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSI     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJALTX    YL0010           Salesperson Nam
     C                     MOVELWJBWTX    YL0022           Fax Number FF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SIEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Ship to Broker Eml RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0017           Broker Code
     C                     MOVEL*BLANK    YN0001           Broker Email Ad
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKBKC7    WQSJ01           Ship To Custome
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSJ01           Ship To Custome
      * Establish starting position
     C           KRSSJ     SETLL@HORELA                    *
     C           KRSSJ     READE@HORELA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1520' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Period Beginning Date LE PAR.Date From
      *   |- c2    : DB1.Period Ending Date GE PAR.Date From
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WKBFDT    IFLE ##JDT                      *IF
     C           WKA2DT    IFGE ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Broker Code is Entered
     C           WKHHAA    IFNE *BLANK                     *IF
      * Rtv All details        RT - Broker News  * 
     C                     EXSR SKRVGN
      * CASE: LCL.Record Status is Active
     C           YL0026    IFEQ 'A'                        *IF
     C                     MOVELWKHHAA    YL0017           Broker Code
     C                     MOVELYL0025    YN0001           Broker Email Ad
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@HORELA                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv All details        RT - Broker News  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0025           Broker Email Ad
     C                     MOVEL*BLANK    YL0026           Record Status
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WLHHAA           Broker Code
      * Setup key
     C                     MOVELWKHHAA    WLHHAA           Broker Code
      * Establish starting position
     C           KRSSK     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLC9T1    YL0025           Broker Email Ad
     C                     MOVELWLVSST    YL0026           Record Status
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1AIC3'
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0059  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0060  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0061  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWB    KLIST
     C                     KFLD           WBAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3
     C           KLVBWB    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to AR Claim Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1C0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1C0C7' defaulted for 'Claim Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0014' defaulted for 'Claim Company Number'.
      * Field '(LCL) YL0015' defaulted for 'Claim Ship to Customer'.
     C                     CALL 'PMCSSRR'              90  Sel A/R Claim
     C                     PARM *BLANK    W0RTN   7
     C           #1C0C7    PARM #1C0C7    WQ0062  70       Claim Number
     C           YL0014    PARM YL0014    WQ0063  30       Claim Company N
     C           YL0015    PARM YL0015    WQ0064  70       Claim Ship to C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1C0C7    IFNE *ZERO                      Claim Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1C0C7    IFEQ *ZERO                      Claim Number
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWC    KLIST
     C                     KFLD           WCC0C7           Claim Number
      * Setup key
     C                     Z-ADD#1C0C7    WCC0C7
     C           KLVCWC    CHAIN@MKCPWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'AR Claim Header        NF'
     C                     MOVEL'USR2729' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2729' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         YKDDW1    BEGSR
      *================================================================
      * Calculate window location for drop down lists on screen 1
      *================================================================
      *
      * Calculate window location for DDL - Print (Yes/No) USR
      * Window width
     C                     Z-ADD9         YWWDWD
      * Window depth
     C                     Z-ADD3         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD##WSR     YWWDRW
     C                     ADD  4         YWWDRW
      * Window start column
     C                     Z-ADD##WSC     YWWDCL
     C                     ADD  32        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG01RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG01CL
      *
      * Calculate window location for DDL - Status Flag 7  Y/N
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD##WSR     YWWDRW
     C                     ADD  5         YWWDRW
      * Window start column
     C                     Z-ADD##WSC     YWWDCL
     C                     ADD  32        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG02RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG02CL
      *
      * Calculate window location for DDL - Status Flag 2  Y/N
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD##WSR     YWWDRW
     C                     ADD  6         YWWDRW
      * Window start column
     C                     Z-ADD##WSC     YWWDCL
     C                     ADD  32        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG03RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG03CL
      *
      * Calculate window location for DDL - Status Flag 3  Y/N
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD##WSR     YWWDRW
     C                     ADD  7         YWWDRW
      * Window start column
     C                     Z-ADD##WSC     YWWDCL
     C                     ADD  32        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG04RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG04CL
      *
      * Calculate window location for DDL - Status Flag 8  Y/N
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD##WSR     YWWDRW
     C                     ADD  8         YWWDRW
      * Window start column
     C                     Z-ADD##WSC     YWWDCL
     C                     ADD  32        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG05RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG05CL
      *================================================================
     CSR         YKEXT1    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ##WSR     MULT 256       ZWORK   50
     C                     ADD  ##WSC     ZWORK
     C                     SUB  ZWORK     ZINPOS
     C                     SUB  1         ZINPOS
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
      *
      * Calculate window offset
     C           004       ADD  ##WSR     YWPORW  30
     C           031       ADD  ##WSC     YWPOC1  30
     C                     ADD  1         YWPOC1
     C           ZHCSRW    IFEQ YWPORW
     C           ZHCSCL    ANDEQYWPOC1
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DDTSX'  YPMTFD           Print (Yes/No)
     C                     END
      *
      *
      * Calculate window offset
     C           005       ADD  ##WSR     YWPORW  30
     C           031       ADD  ##WSC     YWPOC1  30
     C                     ADD  1         YWPOC1
     C           ZHCSRW    IFEQ YWPORW
     C           ZHCSCL    ANDEQYWPOC1
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DAKTX'  YPMTFD           Status Flag 7
     C                     END
      *
      *
      * Calculate window offset
     C           006       ADD  ##WSR     YWPORW  30
     C           031       ADD  ##WSC     YWPOC1  30
     C                     ADD  1         YWPOC1
     C           ZHCSRW    IFEQ YWPORW
     C           ZHCSCL    ANDEQYWPOC1
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DQ2ST'  YPMTFD           Status Flag 2
     C                     END
      *
      *
      * Calculate window offset
     C           007       ADD  ##WSR     YWPORW  30
     C           031       ADD  ##WSC     YWPOC1  30
     C                     ADD  1         YWPOC1
     C           ZHCSRW    IFEQ YWPORW
     C           ZHCSCL    ANDEQYWPOC1
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DQ3ST'  YPMTFD           Status Flag 3
     C                     END
      *
      *
      * Calculate window offset
     C           008       ADD  ##WSR     YWPORW  30
     C           031       ADD  ##WSC     YWPOC1  30
     C                     ADD  1         YWPOC1
     C           ZHCSRW    IFEQ YWPORW
     C           ZHCSCL    ANDEQYWPOC1
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#DAFTX'  YPMTFD           Status Flag 8
     C                     END
      *
      *
      * Calculate window offset
     C           009       ADD  ##WSR     YWPORW  30
     C           031       ADD  ##WSC     YWPOC1  30
     C                     ADD  1         YWPOC1
     C           ZHCSRW    IFEQ YWPORW
     C           ZHCSCL    ANDEQYWPOC1
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN78     ANDEQ'0'
     C                     MOVEL'#DQESC'  YPMTFD           Email to Broker
     C                     END
      *
      *
      * Calculate window offset
     C           010       ADD  ##WSR     YWPORW  30
     C           031       ADD  ##WSC     YWPOC1  30
     C                     ADD  1         YWPOC1
     C           ZHCSRW    IFEQ YWPORW
     C           ZHCSCL    ANDEQYWPOC1
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DQZSC'  YPMTFD           Email to Salesp
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           ZHCSRW    SUB  ##WSR     YWPORW  30
     C           ZHCSCL    SUB  ##WSC     YWPOC1  30
     C                     SUB  1         YWPOC1
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM YWPORW    YYRW    50       Row
     C                     PARM YWPOC1    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZRRPWD    BEGSR
      *================================================================
      * *Reposition window
      *================================================================
     C                     MOVEL'Y'       YSL,1            Set wdw locatio
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
      *
      * Redisplay previous panel
     C                     WRITEASSUME
      *================================================================
     CSR         ZREXIT    ENDSR
      /EJECT
     CSR         ZSSTLC    BEGSR
      *================================================================
      * Set window location
      *================================================================
     C           YSL,1     IFEQ 'Y'                        Set wdw locatio
     C           YWLCTP    IFEQ 'S'                        Locate action t
     C                     Z-ADD021       YWWDRW           Window start ro
     C                     Z-ADD074       YWWDCL           Window start co
     C                     MOVEL'*BR  '   YWWDCR           Window referenc
     C                     ELSE
     C                     MOVEL'S'       YWLCTP           Locate action t
     C                     MOVEL'*CALC'   YWWDCR           Window referenc
     C                     Z-ADD-3        YWWDRW           Window start ro
     C                     Z-ADD-3        YWWDCL           Window start co
     C                     END
     C                     Z-ADD050       YWWDWD           Window width
     C                     Z-ADD014       YWWDDP           Window depth
     C                     MOVEL'N'       YSL,1            Set wdw locatio
      *
     C                     EXSR ZURTLC                     Retrieve window
     C                     EXSR ZTWDFD                     Move window fie
     C                     END
      *================================================================
     CSR         ZSEXIT    ENDSR
      /EJECT
     CSR         ZTWDFD    BEGSR
      *================================================================
      * Move window fields by panel
      *================================================================
     C                     Z-ADDYWWDRW    ##WSR            Window start ro
     C                     Z-ADDYWWDCL    ##WSC            Window start co
     C                     EXSR YKDDW1
      *================================================================
     CSR         ZTEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * Disable F3 key, user must press enter.
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     GOTO ZXEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialise Allow Set Window Location flags
     C                     MOVEA*ALL'Y'   YSL
      * Set display size
     C                     SETOF                         93*
     C           @#SCRW    COMP 27                       93*
      * Initialise window location variables.
     C                     Z-ADD*ZEROS    ##WSR
     C                     Z-ADD*ZEROS    ##WSC
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCBIC3           Claim Company N
     C                     Z-ADD*ZERO     WCALNX           Claim Order Num
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCC3C7           Claim Ship to C
     C                     Z-ADD*ZERO     WCAYVL           Claim Amount
     C                     Z-ADD*ZERO     WCAZVL           Claim Net Loss
     C                     Z-ADD*ZERO     WCA0VL           Claim Approved
     C                     Z-ADD*ZERO     WCA1VL           Lab Fee
     C                     Z-ADD*ZERO     WCMLDT           Resolve Claim b
     C                     Z-ADD*ZERO     WCEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WCMMDT           Claim Called in
     C                     Z-ADD*ZERO     WCMNDT           Claim Entry Dat
     C                     Z-ADD*ZERO     WCBGTM           Claim Entry Tim
     C                     Z-ADD*ZERO     WCC4C7           Resale Ship to
     C                     Z-ADD*ZERO     WCNFDT           Sales Approved
     C                     Z-ADD*ZERO     WCBJTM           Sales Approved
     C                     Z-ADD*ZERO     WCMODT           Approved_Denied
     C                     Z-ADD*ZERO     WCBHTM           Approved_Denied
     C                     Z-ADD*ZERO     WCMPDT           Memo Created Da
     C                     Z-ADD*ZERO     WCBITM           Memo Created Ti
     C                     Z-ADD*ZERO     WCEOVL           Approved Net Lo
     C                     Z-ADD*ZERO     WCEPVL           Total Expense A
     C                     Z-ADD*ZERO     WCP6DT           Memo Post Date
     C                     Z-ADD*ZERO     WCCRTM           Memo Post Time
     C                     Z-ADD*ZERO     WCYSNX           TFS Batch Numbe
     C                     Z-ADD*ZERO     WCF7PC           Avg TF Responsi
     C                     Z-ADD*ZERO     WCF8PC           Avg SBF Respons
     C                     Z-ADD*ZERO     WCF9PC           STF Responsibil
     C                     Z-ADD*ZERO     WCEQVL           FPR ID
     C                     Z-ADD*ZERO     WCERVL           AC Unused Value
     C                     Z-ADD*ZERO     WCESVL           AC Unused Value
     C                     Z-ADD*ZERO     WCETVL           AC Unused Value
     C                     Z-ADD*ZERO     WCGAPC           AC Unused Pct 1
     C                     Z-ADD*ZERO     WCGBPC           AC Unused Pct 2
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,007   XDTSDL
     C                     MOVELXDTSDL    WCBVTS           Created Dt Tm
     C                     MOVELXDTSDL    WCBWTS           Updated Dt Tm
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WDGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WEBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WEBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WEBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WEBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WFQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WFQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WFQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WFGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WFHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WFHGVL           Transload Termi
     C                     Z-ADD*ZERO     WFQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WFQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WFQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WFQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WFITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WFQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WFQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WFQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WFP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WFQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WFQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WFQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WFQENY           Original Appoin
     C                     Z-ADD*ZERO     WFQFNY           Original Appoin
     C                     Z-ADD*ZERO     WFQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WFQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WFQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WFQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WFW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WFW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGS8NY           WDE Sequence Nu
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WKBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WKA2DT           Period Ending D
     C                     Z-ADD*ZERO     WKBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WKPJDT           CAH Unused Date
     C                     Z-ADD*ZERO     WKPKDT           CAH Unused Date
     C                     Z-ADD*ZERO     WKECVL           Comm Min Amt_Pe
     C                     Z-ADD*ZERO     WKHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLDAT1           Broker G_L Vend
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local work field PRT Printer Device
     C                     MOVEL*BLANK    YL0001 10
      * Define local work field PRT Hold Output Sts
     C                     MOVEL*BLANK    YL0002  4
      * Define local work field PRT Save Output Sts
     C                     MOVEL*BLANK    YL0003  4
      * Define local work field PRT Number of Copies
     C                     Z-ADD*ZERO     YL0004  20
      * Define local work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field PRT Night Queue
     C                     MOVEL*BLANK    YL0006 10
      * Define local work field Email to Warehouse Code
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field Blank for 4           USR
     C                     MOVEL*BLANK    YL0009  4
      * Define local work field Salesperson Name
     C                     MOVEL*BLANK    YL0010 30
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0012  3
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0013 80
      * Define local work field Claim Company Number
     C                     Z-ADD*ZERO     YL0014  30
      * Define local work field Claim Ship to Customer
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Email To Whs
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Broker Code
     C                     MOVEL*BLANK    YL0017  6
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0018  6
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field OHE Booking Number
     C                     MOVEL*BLANK    YL0020 15
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0021  2
      * Define local work field Fax Phone Number
     C                     MOVEL*BLANK    YL0022 25
      * Define local work field Regional Salesperson Code
     C                     MOVEL*BLANK    YL0023  3
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0024 50
      * Define null work field Broker Email Address
     C                     MOVEL*BLANK    YN0001 50
      * Define null work field Broker Name
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Broker Address Line 1
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Broker Address Line 2
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Broker City
     C                     MOVEL*BLANK    YN0005 20
      * Define null work field Broker State
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field Broker Zip
     C                     MOVEL*BLANK    YN0007 11
      * Define null work field Broker Office Manager
     C                     MOVEL*BLANK    YN0008 30
      * Define null work field Broker Telephone Number
     C                     MOVEL*BLANK    YN0009 25
      * Define null work field Broker Fax Number
     C                     MOVEL*BLANK    YN0010 25
      * Define local work field Broker Email Address
     C                     MOVEL*BLANK    YL0025 50
      * Define null work field Broker G_L Vendor Number
     C                     Z-ADD*ZERO     YN0011  80
      * Define null work field Broker unused txt 1
     C                     MOVEL*BLANK    YN0012 25
      * Define null work field Broker M3 Supplier
     C                     MOVEL*BLANK    YN0013 20
      * Define null work field Broker EDI Trade Partner
     C                     MOVEL*BLANK    YN0014 20
      * Define null work field Broker Fax_Email Inv
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Broker Fax_Email Prc Sht
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Payee Type
     C                     MOVEL*BLANK    YN0017  2
      * Define null work field Broker unused sts 4
     C                     MOVEL*BLANK    YN0018  3
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0019  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0022  1
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0026  1
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * WRK used for setting the Email to Warehouse flag
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * LCL used for changing Regional Salesperson flag
     C                     MOVEL'Y'       YL0011           First Time Flag
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01055013110156701823018270183302079
0233502591
** W0END
01055013110156701823018290183902079
0233502591
** W0NAM
#DDTSX    #DAKTX    #DQ2ST    #DQ3ST    #DBCCD    #DY8TX    #DAFTX
#DQESC    #DQZSC
** @CN
00001 Print Acknowledgement
00002 Y2U9999
00003 Regional Sales Manager co
00004 de invalid.
00005 Must select a Regional Sa
00006 les Manager.
00007 0001-01-01-00.00.00.00000
00008 Y2U0005
00009 SL-ACKNOWL
