/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - PRINT PROGRAM WITH SELECTIONS FOR SALES TONNAGE RPT. */
/*             COMPANY, CUSTOMER NUMBERS, SALESPERSON, AND          */
/*             TERRITORY.                                           */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT SALES TONNAGE REPORT                          */
/*  DATE      - 11/25/97                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/*          &COMPNYN    - COMPANY NUMBER - BLANK FOR ALL            */
/*          &PARCUST    - PARENT CUSTOMER NUMBER                    */
/*          &ARCUST     - A/R CUSTOMER NUMBER                       */
/*          &SALEPER    - SALESPERSON CODE                          */
/*          &TERR       - TERRITORY CODE                            */
/*          &STATE      - STATE CODE                                */
/*          &OUTQ       - OUTPUT QUEUE                              */
/*          &HOLD       - HOLD PRINT                                */
/*          &SAVE       - SAVE PRINT                                */
/*          &COPYN      - NUMBER OF COPIES                          */
/*          &NIGHTQ     - NIGHT OUTPUT QUEUE                        */
/********************************************************************/

 PDL8PCLP:   PGM        PARM(&OUTQ &HOLD &SAVE &NIGHTQ &NQSTAT +
                          &COPYN &COMPNYN &PRODDATE &EXPDOM &REAS1 +
                          &REAS2 &REAS3 &REAS4 &TRNTP &WHSE1 &WHSE2 +
                          &WHSE3 &WHSE4 &WHSE5 &WHSE6 &WHSE7 &WHSE8 +
                          &WHSE9 &WHSE10 &SELOMT)
/* PARMS                                                                      */
        DCL    &COMPNYN    *DEC
        DCL    &PRODDATE   *DEC                  /* CURRENT YEAR COMPA RE DT  */
        DCL    &EXPDOM     *CHAR   (1)
        DCL    &REAS1      *CHAR   (3)
        DCL    &REAS2      *CHAR   (3)
        DCL    &REAS3      *CHAR   (3)
        DCL    &REAS4      *CHAR   (3)
        DCL    &TRNTP      *CHAR   (2)
        DCL    &COPYN      *DEC
        DCL    &PGM        *CHAR   (7)
        DCL    &PGMO       *CHAR   (8)
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue              */
        DCL    &HOLD       *CHAR   (4)           /* Hold Status               */
        DCL    &SAVE       *CHAR   (4)           /* Save Status               */
        DCL    &NIGHTQ     *CHAR   (10)          /* Night Job Queue           */
        DCL    &NQSTAT     *CHAR   (1)
        DCL    &JOBQ       *CHAR   (10)
        DCL    &WHSE1      *CHAR   (3)
        DCL    &WHSE2      *CHAR   (3)
        DCL    &WHSE3      *CHAR   (3)
        DCL    &WHSE4      *CHAR   (3)
        DCL    &WHSE5      *CHAR   (3)
        DCL    &WHSE6      *CHAR   (3)
        DCL    &WHSE7      *CHAR   (3)
        DCL    &WHSE8      *CHAR   (3)
        DCL    &WHSE9      *CHAR   (3)
        DCL    &WHSE10     *CHAR   (3)
        DCL    &SELOMT     *CHAR   (1)
        DCL    &COMMAND    *CHAR   (512)

/* INTERNAL FIELDS                                                            */
        DCL    &COPY       *DEC    (2 0)         /* Number of copies          */
        DCL    &COMPANY    *DEC    (3 0)         /* Company Number            */
        DCL    &PRODATEIN  *DEC    (7 0)

/* OPENQRYF                                                                   */
             DCL        VAR(&A) TYPE(*CHAR) LEN(30)
             DCL        VAR(&B) TYPE(*CHAR) LEN(30)
             DCL        VAR(&C) TYPE(*CHAR) LEN(30)
             DCL        VAR(&D) TYPE(*CHAR) LEN(30)
             DCL        VAR(&E) TYPE(*CHAR) LEN(30)
             DCL        VAR(&F) TYPE(*CHAR) LEN(30)
             DCL        VAR(&G) TYPE(*CHAR) LEN(30)
             DCL        VAR(&H) TYPE(*CHAR) LEN(30)
             DCL        VAR(&I) TYPE(*CHAR) LEN(30)
             DCL        VAR(&J) TYPE(*CHAR) LEN(30)
             DCL        VAR(&K) TYPE(*CHAR) LEN(400)

/********************************************************************/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/********************************************************************/

             CHGVAR     VAR(&COPY) VALUE(&COPYN)
             CHGVAR     VAR(&COMPANY) VALUE(&COMPNYN)
             CHGVAR     VAR(&PRODATEIN) VALUE(&PRODDATE)

/*********************************************************************/
/*   SET UP PRINT FILE.                                              */
/*********************************************************************/
             CHGVAR     VAR(&PGM)  VALUE('PDL8PFR')
             CHGVAR     VAR(&PGMO) VALUE(&PGM *TCAT '$')
/*********************************************************************/
/*   CREATE OPEN QUERY FILE TO BE USED FOR INVOICING REPORTS         */
/*********************************************************************/
/*   WAREHOUSE SELECT                                                */
/*********************************************************************/
             IF         COND(&SELOMT *EQ 'S' *AND &WHSE1 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&A) VALUE('B0AJCD *EQ "' *CAT &WHSE1 +
                          *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'S' *AND &WHSE2 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&B) VALUE('*OR B0AJCD *EQ "' *CAT +
                          &WHSE2 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'S' *AND &WHSE3 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&C) VALUE('*OR B0AJCD *EQ "' *CAT +
                          &WHSE3 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'S' *AND &WHSE4 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&D) VALUE('*OR B0AJCD *EQ "' *CAT +
                          &WHSE4 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'S' *AND &WHSE5 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&E) VALUE('*OR B0AJCD *EQ "' *CAT +
                          &WHSE5 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'S' *AND &WHSE6 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&F) VALUE('*OR B0AJCD *EQ "' *CAT +
                          &WHSE6 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'S' *AND &WHSE7 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&G) VALUE('*OR B0AJCD *EQ "' *CAT +
                          &WHSE7 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'S' *AND &WHSE8 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&H) VALUE('*OR B0AJCD *EQ "' *CAT +
                          &WHSE8 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'S' *AND &WHSE9 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&I) VALUE('*OR B0AJCD *EQ "' *CAT +
                          &WHSE9 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'S' *AND &WHSE10 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&J) VALUE('*OR B0AJCD *EQ "' *CAT +
                          &WHSE10 *CAT '"')
             ENDDO
/*********************************************************************/
/*   WAREHOUSE OMIT                                                  */
/*********************************************************************/
             IF         COND(&SELOMT *EQ 'O' *AND &WHSE1 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&A) VALUE('B0AJCD *NE "' *CAT &WHSE1 +
                          *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'O' *AND &WHSE2 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&B) VALUE('*OR B0AJCD *NE "' *CAT +
                          &WHSE2 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'O' *AND &WHSE3 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&C) VALUE('*OR B0AJCD *NE "' *CAT +
                          &WHSE3 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'O' *AND &WHSE4 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&D) VALUE('*OR B0AJCD *NE "' *CAT +
                          &WHSE4 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'O' *AND &WHSE5 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&E) VALUE('*OR B0AJCD *NE "' *CAT +
                          &WHSE5 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'O' *AND &WHSE6 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&F) VALUE('*OR B0AJCD *NE "' *CAT +
                          &WHSE6 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'O' *AND &WHSE7 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&G) VALUE('*OR B0AJCD *NE "' *CAT +
                          &WHSE7 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'O' *AND &WHSE8 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&H) VALUE('*OR B0AJCD *NE "' *CAT +
                          &WHSE8 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'O' *AND &WHSE9 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&I) VALUE('*OR B0AJCD *NE "' *CAT +
                          &WHSE9 *CAT '"')
             ENDDO
             IF         COND(&SELOMT *EQ 'O' *AND &WHSE10 *NE '   ') +
                          THEN(DO)
             CHGVAR     VAR(&J) VALUE('*OR B0AJCD *NE "' *CAT +
                          &WHSE10 *CAT '"')
             ENDDO
/********************************************************************/
/*  CONCATENATE ALL WAREHOUSE FIELDS TOGETHER                       */
/********************************************************************/
             IF         COND(&SELOMT *NE ' ') THEN(DO)
             CHGVAR     VAR(&K) VALUE(&A *BCAT &B *BCAT &C *BCAT &D +
                          *BCAT &E *BCAT &F *BCAT &G *BCAT &H *BCAT +
                          &I *BCAT &J)
             ENDDO

/*RUN QUERY AGAINST IC ITEM BALANCE FILE                            */
             IF         COND(&SELOMT *NE ' ') THEN(DO)
             OVRDBF     FILE(CAB0REL1) SHARE(*YES)
             OPNQRYF    FILE(CAB0REL1) +
                        QRYSLT(&K) +
                        KEYFLD(*FILE)
             ENDDO

/********************************************************************/
/* OVERRIDE PRINTER FILE WITH USER SPECIFIED SELECTION VALUES       */
/********************************************************************/

             SBDPRTOVR  CMDVAR(&COMMAND) FILE(&PGMO) OUTQ(&OUTQ) +
                          COPIES(&COPY) HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)


/*********************************************************************/
/*   CALL PRINT PROGRAM -
/*********************************************************************/

             CALL       PGM(&PGM) PARM(' ' &COMPANY &PRODATEIN +
                          &EXPDOM &REAS1 &REAS2 &REAS3 &REAS4 +
                          &TRNTP &WHSE1 &WHSE2 &WHSE3 &WHSE4 &WHSE5 +
                          &WHSE6 &WHSE7 &WHSE8 &WHSE9 &WHSE10 &SELOMT)
             IF COND(&SELOMT *NE ' ') THEN(DO)
             CLOF       OPNID(CAB0REL1)
             DLTOVR     FILE(CAB0REL1)
             ENDDO

 END:        ENDPGM
