     H/TITLE PMT Reset OHEAES Flds PV  Prompt & validate record
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Prompt & validate record
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISELOUC
     H* Date          : 02/11/24  Time  : 21:26:59
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0  IF   E           K DISK
      * Values list details file
      *
     FPVDCPVR#  CF   E             WORKSTN
     F                                     INFDS(INFDS#)
      * DSP: PMT Reset OHEAES Flds PV  Prompt & validate record
      *
     FPMAMREL1  IF   E           K DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FECP136L1  IF   E           K DISK
      * RTV : EDI Export Shpmnt Inf HDR Retrieval index
      *
     FOPBFCPL1  IF   E           K DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPMAMREL0  UF   E           K DISK
      * UPD : Order Header Extension    Update index
      *
     FECP136L0  UF   E           K DISK
      * UPD : EDI Export Shpmnt Inf HDR Update index
      *
      * Long constants
     D @CN#            S              6    DIM(02)CTDATA PERRCD(1)
     D @CN             S             25    DIM(02) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      * ABO DEFINE LARGE STRING FOR CL CMD
     D YARTCM          DS           512
     D  DUMMY1                 1      1
     D INFDS#        E DS                  EXTNAME(Y2I#DSP)
      * Display file information data structure
      *
     D QPMAM1        E DS                  EXTNAME(PMAMREL0)
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     D  WAAIC3       E                     EXTFLD(AMAIC3)
     D  WAC4NB       E                     EXTFLD(AMC4NB)
     D  WARMNB       E                     EXTFLD(AMRMNB)
     D  WARUNB       E                     EXTFLD(AMRUNB)
     D  WAXACD       E                     EXTFLD(AMXACD)
     D  WAOANA       E                     EXTFLD(AMOANA)
     D  WAHBAA       E                     EXTFLD(AMHBAA)
     D  WAJ0T1       E                     EXTFLD(AMJ0T1)
     D  WAGENY       E                     EXTFLD(AMGENY)
     D  WAJ1T1       E                     EXTFLD(AMJ1T1)
     D  WAHCAA       E                     EXTFLD(AMHCAA)
     D  WAQWDT       E                     EXTFLD(AMQWDT)
     D  WAQXDT       E                     EXTFLD(AMQXDT)
     D  WAQYDT       E                     EXTFLD(AMQYDT)
     D  WAHDAA       E                     EXTFLD(AMHDAA)
     D  WACCTX       E                     EXTFLD(AMCCTX)
     D  WAJ2T1       E                     EXTFLD(AMJ2T1)
     D  WARLNA       E                     EXTFLD(AMRLNA)
     D  WARMNA       E                     EXTFLD(AMRMNA)
     D  WAGINY       E                     EXTFLD(AMGINY)
     D  WAGFNY       E                     EXTFLD(AMGFNY)
     D  WAGGNY       E                     EXTFLD(AMGGNY)
     D  WAGHNY       E                     EXTFLD(AMGHNY)
     D  WAHEVL       E                     EXTFLD(AMHEVL)
     D  WAHFVL       E                     EXTFLD(AMHFVL)
     D  WAHGVL       E                     EXTFLD(AMHGVL)
     D  WAQZDT       E                     EXTFLD(AMQZDT)
     D  WAQ0DT       E                     EXTFLD(AMQ0DT)
     D  WAQ1DT       E                     EXTFLD(AMQ1DT)
     D  WAQ2DT       E                     EXTFLD(AMQ2DT)
     D  WAC2TX       E                     EXTFLD(AMC2TX)
     D  WAC3TX       E                     EXTFLD(AMC3TX)
     D  WAC6TX       E                     EXTFLD(AMC6TX)
     D  WACHTX       E                     EXTFLD(AMCHTX)
     D  WACITX       E                     EXTFLD(AMCITX)
     D  WACLTX       E                     EXTFLD(AMCLTX)
     D  WAB4TX       E                     EXTFLD(AMB4TX)
     D  WACUTX       E                     EXTFLD(AMCUTX)
     D  WACVTX       E                     EXTFLD(AMCVTX)
     D  WAB9TX       E                     EXTFLD(AMB9TX)
     D  WAJWSC       E                     EXTFLD(AMJWSC)
     D  WAITNY       E                     EXTFLD(AMITNY)
     D  WALMT1       E                     EXTFLD(AMLMT1)
     D  WALWAA       E                     EXTFLD(AMLWAA)
     D  WAFVST       E                     EXTFLD(AMFVST)
     D  WAF0ST       E                     EXTFLD(AMF0ST)
     D  WAF2ST       E                     EXTFLD(AMF2ST)
     D  WAF3ST       E                     EXTFLD(AMF3ST)
     D  WAJUSC       E                     EXTFLD(AMJUSC)
     D  WAJVSC       E                     EXTFLD(AMJVSC)
     D  WAV3T1       E                     EXTFLD(AMV3T1)
     D  WAV4T1       E                     EXTFLD(AMV4T1)
     D  WAV5T1       E                     EXTFLD(AMV5T1)
     D  WAV6T1       E                     EXTFLD(AMV6T1)
     D  WAV7T1       E                     EXTFLD(AMV7T1)
     D  WAV8T1       E                     EXTFLD(AMV8T1)
     D  WAV9T1       E                     EXTFLD(AMV9T1)
     D  WAWAT1       E                     EXTFLD(AMWAT1)
     D  WAWBT1       E                     EXTFLD(AMWBT1)
     D  WAWCT1       E                     EXTFLD(AMWCT1)
     D  WAWDT1       E                     EXTFLD(AMWDT1)
     D  WAQJNY       E                     EXTFLD(AMQJNY)
     D  WAQKNY       E                     EXTFLD(AMQKNY)
     D  WAQLNY       E                     EXTFLD(AMQLNY)
     D  WAP8NY       E                     EXTFLD(AMP8NY)
     D  WAP9NY       E                     EXTFLD(AMP9NY)
     D  WAQANY       E                     EXTFLD(AMQANY)
     D  WAQCNY       E                     EXTFLD(AMQCNY)
     D  WAQDNY       E                     EXTFLD(AMQDNY)
     D  WAQENY       E                     EXTFLD(AMQENY)
     D  WAQFNY       E                     EXTFLD(AMQFNY)
     D  WAQGNY       E                     EXTFLD(AMQGNY)
     D  WAQHNY       E                     EXTFLD(AMQHNY)
     D  WAQINY       E                     EXTFLD(AMQINY)
     D  WAQMNY       E                     EXTFLD(AMQMNY)
     D  WAMYU1       E                     EXTFLD(AMMYU1)
     D  WAJXSC       E                     EXTFLD(AMJXSC)
     D  WAJYSC       E                     EXTFLD(AMJYSC)
     D  WAJZSC       E                     EXTFLD(AMJZSC)
     D  WAJ0SC       E                     EXTFLD(AMJ0SC)
     D  WAMZU1       E                     EXTFLD(AMMZU1)
     D  WAM0U1       E                     EXTFLD(AMM0U1)
     D  WAM1U1       E                     EXTFLD(AMM1U1)
     D  WAM2U1       E                     EXTFLD(AMM2U1)
     D  WAM3U1       E                     EXTFLD(AMM3U1)
     D  WAW5DT       E                     EXTFLD(AMW5DT)
     D  WAW6DT       E                     EXTFLD(AMW6DT)
     D  WAUVST       E                     EXTFLD(AMUVST)
     D  WAUWST       E                     EXTFLD(AMUWST)
     D  WAUXST       E                     EXTFLD(AMUXST)
     D  WAVSST       E                     EXTFLD(AMVSST)
     D  WAAATM       E                     EXTFLD(AMAATM)
     D  WAAYNA       E                     EXTFLD(AMAYNA)
     D  WAA0NA       E                     EXTFLD(AMA0NA)
     D  WAAXDT       E                     EXTFLD(AMAXDT)
      *
     D YARDCS          DS           894
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D QECP11        E DS                  EXTNAME(ECP136L0)
      * UPD : EDI Export Shpmnt Inf HDR Update index
      * Renamed input format fields
     D  WBTSCN       E                     EXTFLD(COTSCN)
     D  WBA0ST       E                     EXTFLD(COA0ST)
     D  WBHPAA       E                     EXTFLD(COHPAA)
     D  WBA8AB       E                     EXTFLD(COA8AB)
     D  WBA9AB       E                     EXTFLD(COA9AB)
     D  WBBAAB       E                     EXTFLD(COBAAB)
     D  WBBBAB       E                     EXTFLD(COBBAB)
     D  WBHDNZ       E                     EXTFLD(COHDNZ)
     D  WBBEAB       E                     EXTFLD(COBEAB)
     D  WBVRNA       E                     EXTFLD(COVRNA)
     D  WBBCAB       E                     EXTFLD(COBCAB)
     D  WBS5U1       E                     EXTFLD(COS5U1)
     D  WBBDAB       E                     EXTFLD(COBDAB)
     D  WBB7DX       E                     EXTFLD(COB7DX)
     D  WBS6U1       E                     EXTFLD(COS6U1)
     D  WBS7U1       E                     EXTFLD(COS7U1)
     D  WBS8U1       E                     EXTFLD(COS8U1)
     D  WBBFAB       E                     EXTFLD(COBFAB)
     D  WBS9U1       E                     EXTFLD(COS9U1)
     D  WBTAU1       E                     EXTFLD(COTAU1)
     D  WBTBU1       E                     EXTFLD(COTBU1)
     D  WBTPU1       E                     EXTFLD(COTPU1)
     D  WBTQU1       E                     EXTFLD(COTQU1)
     D  WBTRU1       E                     EXTFLD(COTRU1)
     D  WBCADX       E                     EXTFLD(COCADX)
     D  WBBETM       E                     EXTFLD(COBETM)
     D  WBN8SC       E                     EXTFLD(CON8SC)
      *
     D YBRDCS          DS           287
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  W0TRN          S              1
     D  W0HLP          S              1
     D  YPMT04         S              1
     D  HELP25         S              1
     D  ##OFF          S             30
     D  ZHCSRW         S              5  0
     D  ZHCSCL         S              5  0
     D  ZZCSRW         S              3  0
     D  ZZCSCL         S              3  0
     D  W0HPMB         S             10
     D  YYHPFL         S             10
     D  YYHPLB         S             10
     D  YYHLVN         S             10
     D  YYUSOP         S             10
     D  YYRW           S              5  0
     D  YYCL           S              5  0
     D  YYLGCT         S              5  0
     D  YYLGVN         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAFSMS         S              1
     D  W0DCF          S              1
     D  WN0001         S              3
     D  WN0002         S             20
     D  WN0003         S             25
     D  WN0004         S             30
     D  WN0005         S             15
     D  WN0006         S             15
     D  WN0007         S             20
     D  WN0008         S              7  0
     D  WN0009         S              7  0
     D  WN0010         S              7  0
     D  WN0011         S              3
     D  WN0012         S              1
     D  WN0013         S             12
     D  WN0014         S             35
     D  WN0015         S             75
     D  WN0016         S             11  0
     D  WN0017         S             11  0
     D  WN0018         S             11  0
     D  WN0019         S             11  0
     D  WN0020         S             11  2
     D  WN0021         S             11  2
     D  WN0022         S             11  2
     D  WN0023         S              7  0
     D  WN0024         S              7  0
     D  WN0025         S              7  0
     D  WN0026         S              7  0
     D  WN0027         S              4
     D  WN0028         S              4
     D  WN0029         S              4
     D  WN0030         S              2
     D  WN0031         S              2
     D  WN0032         S              2
     D  WN0033         S              3
     D  WN0034         S              3
     D  WN0035         S              3
     D  WN0036         S              5
     D  WN0037         S              5
     D  WN0038         S              5  0
     D  WN0039         S             38
     D  WN0040         S              6
     D  WN0041         S              6
     D  WN0042         S              6
     D  WN0043         S              6
     D  WN0044         S              6
     D  WN0045         S              1
     D  WN0046         S             10
     D  WN0047         S             10
     D  WN0048         S             10
     D  WN0049         S             15
     D  WN0050         S             15
     D  WN0051         S             15
     D  WN0052         S             30
     D  WN0053         S             30
     D  WN0054         S             30
     D  WN0055         S             50
     D  WN0056         S             50
     D  WN0057         S              3  0
     D  WN0058         S              3  0
     D  WN0059         S              3  0
     D  WN0060         S              5  2
     D  WN0061         S              5  2
     D  WN0062         S              5  0
     D  WN0063         S              6  0
     D  WN0064         S              6  0
     D  WN0065         S              6  0
     D  WN0066         S              6  0
     D  WN0067         S              9  0
     D  WN0068         S              9  0
     D  WN0069         S              9  0
     D  WN0070         S              9  6
     D  WN0071         S             15
     D  WN0072         S              1
     D  WN0073         S              1
     D  WN0074         S              2
     D  WN0075         S              5
     D  WN0076         S              5
     D  WN0077         S             15
     D  WN0078         S             30
     D  WN0079         S              7  0
     D  WN0080         S              7  0
     D  WN0081         S              1
     D  WN0082         S              1
     D  WN0083         S              1
     D  WN0084         S              1
     D  WN0085         S              6  0
     D  WN0086         S             10
     D  WN0087         S             10
     D  WN0088         S              7  0
     D  YARDC          S              1
     D  WN0089         S              6
     D  WN0090         S              1
     D  WN0091         S              2
     D  WN0092         S              2
     D  WN0093         S              2
     D  WN0094         S              7  0
     D  WN0095         S              2
     D  WN0096         S             20
     D  WN0097         S              4
     D  WN0098         S             28
     D  WN0099         S              3
     D  WN0100         S              8  0
     D  WN0101         S             30
     D  WN0102         S             30
     D  WN0103         S             50
     D  WN0104         S              2
     D  WN0105         S             15
     D  WN0106         S             30
     D  WN0107         S              1
     D  WN0108         S              4
     D  WN0109         S             15
     D  WN0110         S             15
     D  WN0111         S              8  0
     D  WN0112         S              6  0
     D  YBRDC          S              1
     D  WUI3ST         S              1
     D  WUDMCD         S              3
     D  ZADFMF         S             10
     D  WUEOCD         S              7
     D  YN0001         S              3
     D  YN0002         S             20
     D  YN0003         S             25
     D  YN0004         S             30
     D  YN0005         S             15
     D  YN0006         S             15
     D  YN0007         S             20
     D  YN0008         S              7  0
     D  YN0009         S              7  0
     D  YN0010         S              7  0
     D  YN0011         S              3
     D  YN0012         S              1
     D  YN0013         S             12
     D  YN0014         S             35
     D  YN0015         S             75
     D  YN0016         S             11  0
     D  YN0017         S             11  0
     D  YN0018         S             11  0
     D  YN0019         S             11  0
     D  YN0020         S             11  2
     D  YN0021         S             11  2
     D  YN0022         S             11  2
     D  YN0023         S              7  0
     D  YN0024         S              7  0
     D  YN0025         S              7  0
     D  YN0026         S              7  0
     D  YN0027         S              4
     D  YN0028         S              4
     D  YN0029         S              4
     D  YN0030         S              2
     D  YN0031         S              2
     D  YN0032         S              2
     D  YN0033         S              3
     D  YN0034         S              3
     D  YN0035         S              3
     D  YN0036         S              5
     D  YN0037         S              5
     D  YN0038         S              5  0
     D  YN0039         S             38
     D  YN0040         S              6
     D  YN0041         S              6
     D  YN0042         S              6
     D  YN0043         S              6
     D  YN0044         S              6
     D  YN0045         S              1
     D  YN0046         S             10
     D  YN0047         S             10
     D  YN0048         S             10
     D  YN0049         S             15
     D  YN0050         S             15
     D  YN0051         S             15
     D  YN0052         S             30
     D  YN0053         S             30
     D  YN0054         S             30
     D  YN0055         S             50
     D  YN0056         S             50
     D  YN0057         S              3  0
     D  YN0058         S              3  0
     D  YN0059         S              3  0
     D  YN0060         S              5  2
     D  YN0061         S              5  2
     D  YN0062         S              5  0
     D  YN0063         S              6  0
     D  YN0064         S              6  0
     D  YN0065         S              6  0
     D  YN0066         S              6  0
     D  YN0067         S              9  0
     D  YN0068         S              9  0
     D  YN0069         S              9  0
     D  YN0070         S              9  6
     D  YN0071         S             15
     D  YN0072         S              1
     D  YN0073         S              1
     D  YN0074         S              2
     D  YN0075         S              5
     D  YN0076         S              5
     D  YN0077         S             15
     D  YN0078         S             30
     D  YN0079         S              7  0
     D  YN0080         S              7  0
     D  YN0081         S              1
     D  YN0082         S              1
     D  YN0083         S              1
     D  YN0084         S              1
     D  YN0085         S              6
     D  YN0086         S              1
     D  YN0087         S              2
     D  YN0088         S              2
     D  YN0089         S              2
     D  YN0090         S              2
     D  YN0091         S             20
     D  YN0092         S              4
     D  YN0093         S             28
     D  YN0094         S              3
     D  YN0095         S              8  0
     D  YN0096         S             30
     D  YN0097         S             30
     D  YN0098         S             50
     D  YN0099         S              2
     D  YN0100         S             15
     D  YN0101         S             30
     D  YN0102         S              1
     D  YN0103         S              4
     D  YN0104         S             15
     D  YN0105         S             15
     D  YN0106         S              8  0
     D  YN0107         S              6  0
     D  WK1X01         S              1
     D  WK1X02         S              1
     D  YL0001         S             15
     D  YL0002         S              1
     D  WQ0001         S             15
     D  WQ0002         S              1
     D  W0CLPG         S             10
     D  WQ0003         S              3  0
     D  WQ0004         S              7  0
     D  WN30           S             30
     D  W0NSRQ         S              1
     D  Y2LSNO         S              7  0
     D  W0EXVL         S             25
     D  YPMTFD         S             10
     D  YAFSCH         S              4  0
     D  YPMRRN         S              4  0
     D  W0GRP          S              1
     D  YSETCS         S              1
     D  WCSRLC         S              3
     D  ZINPOS         S              5  0
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0CFL          S             10
     D  W0CRW          S              5  0
     D  W0CCL          S              5  0
     D  ZZFFL          S             10
     D  ZZFLB          S             10
     D  ZZFMB          S             10
     D  @1FFL          S             10
     D  @1FLB          S             10
     D  @1FMB          S             10
     D  ZZFQL          S             21
     D  W0PMT          S              1
     D J3              S              1    DIM(3)
     D K3              S              1    DIM(3)
     D J7              S              1    DIM(7)
     D K7              S              1    DIM(7)
     D #L3             S              1    DIM(3)
     D #L7             S              1    DIM(7)
     D                 DS
     D  ZAMSDA                 1    132
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                      WAAIC3
     I              AMC4NB                      WAC4NB
     I              AMRMNB                      WARMNB
     I              AMRUNB                      WARUNB
     I              AMXACD                      WAXACD
     I              AMOANA                      WAOANA
     I              AMHBAA                      WAHBAA
     I              AMJ0T1                      WAJ0T1
     I              AMGENY                      WAGENY
     I              AMJ1T1                      WAJ1T1
     I              AMHCAA                      WAHCAA
     I              AMQWDT                      WAQWDT
     I              AMQXDT                      WAQXDT
     I              AMQYDT                      WAQYDT
     I              AMHDAA                      WAHDAA
     I              AMCCTX                      WACCTX
     I              AMJ2T1                      WAJ2T1
     I              AMRLNA                      WARLNA
     I              AMRMNA                      WARMNA
     I              AMGINY                      WAGINY
     I              AMGFNY                      WAGFNY
     I              AMGGNY                      WAGGNY
     I              AMGHNY                      WAGHNY
     I              AMHEVL                      WAHEVL
     I              AMHFVL                      WAHFVL
     I              AMHGVL                      WAHGVL
     I              AMQZDT                      WAQZDT
     I              AMQ0DT                      WAQ0DT
     I              AMQ1DT                      WAQ1DT
     I              AMQ2DT                      WAQ2DT
     I              AMC2TX                      WAC2TX
     I              AMC3TX                      WAC3TX
     I              AMC6TX                      WAC6TX
     I              AMCHTX                      WACHTX
     I              AMCITX                      WACITX
     I              AMCLTX                      WACLTX
     I              AMB4TX                      WAB4TX
     I              AMCUTX                      WACUTX
     I              AMCVTX                      WACVTX
     I              AMB9TX                      WAB9TX
     I              AMJWSC                      WAJWSC
     I              AMITNY                      WAITNY
     I              AMLMT1                      WALMT1
     I              AMLWAA                      WALWAA
     I              AMFVST                      WAFVST
     I              AMF0ST                      WAF0ST
     I              AMF2ST                      WAF2ST
     I              AMF3ST                      WAF3ST
     I              AMJUSC                      WAJUSC
     I              AMJVSC                      WAJVSC
     I              AMV3T1                      WAV3T1
     I              AMV4T1                      WAV4T1
     I              AMV5T1                      WAV5T1
     I              AMV6T1                      WAV6T1
     I              AMV7T1                      WAV7T1
     I              AMV8T1                      WAV8T1
     I              AMV9T1                      WAV9T1
     I              AMWAT1                      WAWAT1
     I              AMWBT1                      WAWBT1
     I              AMWCT1                      WAWCT1
     I              AMWDT1                      WAWDT1
     I              AMQJNY                      WAQJNY
     I              AMQKNY                      WAQKNY
     I              AMQLNY                      WAQLNY
     I              AMP8NY                      WAP8NY
     I              AMP9NY                      WAP9NY
     I              AMQANY                      WAQANY
     I              AMQCNY                      WAQCNY
     I              AMQDNY                      WAQDNY
     I              AMQENY                      WAQENY
     I              AMQFNY                      WAQFNY
     I              AMQGNY                      WAQGNY
     I              AMQHNY                      WAQHNY
     I              AMQINY                      WAQINY
     I              AMQMNY                      WAQMNY
     I              AMMYU1                      WAMYU1
     I              AMJXSC                      WAJXSC
     I              AMJYSC                      WAJYSC
     I              AMJZSC                      WAJZSC
     I              AMJ0SC                      WAJ0SC
     I              AMMZU1                      WAMZU1
     I              AMM0U1                      WAM0U1
     I              AMM1U1                      WAM1U1
     I              AMM2U1                      WAM2U1
     I              AMM3U1                      WAM3U1
     I              AMW5DT                      WAW5DT
     I              AMW6DT                      WAW6DT
     I              AMUVST                      WAUVST
     I              AMUWST                      WAUWST
     I              AMUXST                      WAUXST
     I              AMVSST                      WAVSST
     I              AMAATM                      WAAATM
     I              AMAYNA                      WAAYNA
     I              AMA0NA                      WAA0NA
     I              AMAXDT                      WAAXDT
      *
     I@COCPKT
      * EDI Export Shpmnt Inf HDR Update index
      * Renamed input format fields
     I              COTSCN                      WBTSCN
     I              COA0ST                      WBA0ST
     I              COHPAA                      WBHPAA
     I              COA8AB                      WBA8AB
     I              COA9AB                      WBA9AB
     I              COBAAB                      WBBAAB
     I              COBBAB                      WBBBAB
     I              COHDNZ                      WBHDNZ
     I              COBEAB                      WBBEAB
     I              COVRNA                      WBVRNA
     I              COBCAB                      WBBCAB
     I              COS5U1                      WBS5U1
     I              COBDAB                      WBBDAB
     I              COB7DX                      WBB7DX
     I              COS6U1                      WBS6U1
     I              COS7U1                      WBS7U1
     I              COS8U1                      WBS8U1
     I              COBFAB                      WBBFAB
     I              COS9U1                      WBS9U1
     I              COTAU1                      WBTAU1
     I              COTBU1                      WBTBU1
     I              COTPU1                      WBTPU1
     I              COTQU1                      WBTQU1
     I              COTRU1                      WBTRU1
     I              COCADX                      WBCADX
     I              COBETM                      WBBETM
     I              CON8SC                      WBN8SC
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                      WCAIC3
     I              AMC4NB                      WCC4NB
     I              AMRMNB                      WCRMNB
     I              AMRUNB                      WCRUNB
     I              AMXACD                      WCXACD
     I              AMOANA                      WCOANA
     I              AMHBAA                      WCHBAA
     I              AMJ0T1                      WCJ0T1
     I              AMGENY                      WCGENY
     I              AMJ1T1                      WCJ1T1
     I              AMHCAA                      WCHCAA
     I              AMQWDT                      WCQWDT
     I              AMQXDT                      WCQXDT
     I              AMQYDT                      WCQYDT
     I              AMHDAA                      WCHDAA
     I              AMCCTX                      WCCCTX
     I              AMJ2T1                      WCJ2T1
     I              AMRLNA                      WCRLNA
     I              AMRMNA                      WCRMNA
     I              AMGINY                      WCGINY
     I              AMGFNY                      WCGFNY
     I              AMGGNY                      WCGGNY
     I              AMGHNY                      WCGHNY
     I              AMHEVL                      WCHEVL
     I              AMHFVL                      WCHFVL
     I              AMHGVL                      WCHGVL
     I              AMQZDT                      WCQZDT
     I              AMQ0DT                      WCQ0DT
     I              AMQ1DT                      WCQ1DT
     I              AMQ2DT                      WCQ2DT
     I              AMC2TX                      WCC2TX
     I              AMC3TX                      WCC3TX
     I              AMC6TX                      WCC6TX
     I              AMCHTX                      WCCHTX
     I              AMCITX                      WCCITX
     I              AMCLTX                      WCCLTX
     I              AMB4TX                      WCB4TX
     I              AMCUTX                      WCCUTX
     I              AMCVTX                      WCCVTX
     I              AMB9TX                      WCB9TX
     I              AMJWSC                      WCJWSC
     I              AMITNY                      WCITNY
     I              AMLMT1                      WCLMT1
     I              AMLWAA                      WCLWAA
     I              AMFVST                      WCFVST
     I              AMF0ST                      WCF0ST
     I              AMF2ST                      WCF2ST
     I              AMF3ST                      WCF3ST
     I              AMJUSC                      WCJUSC
     I              AMJVSC                      WCJVSC
     I              AMV3T1                      WCV3T1
     I              AMV4T1                      WCV4T1
     I              AMV5T1                      WCV5T1
     I              AMV6T1                      WCV6T1
     I              AMV7T1                      WCV7T1
     I              AMV8T1                      WCV8T1
     I              AMV9T1                      WCV9T1
     I              AMWAT1                      WCWAT1
     I              AMWBT1                      WCWBT1
     I              AMWCT1                      WCWCT1
     I              AMWDT1                      WCWDT1
     I              AMQJNY                      WCQJNY
     I              AMQKNY                      WCQKNY
     I              AMQLNY                      WCQLNY
     I              AMP8NY                      WCP8NY
     I              AMP9NY                      WCP9NY
     I              AMQANY                      WCQANY
     I              AMQCNY                      WCQCNY
     I              AMQDNY                      WCQDNY
     I              AMQENY                      WCQENY
     I              AMQFNY                      WCQFNY
     I              AMQGNY                      WCQGNY
     I              AMQHNY                      WCQHNY
     I              AMQINY                      WCQINY
     I              AMQMNY                      WCQMNY
     I              AMMYU1                      WCMYU1
     I              AMJXSC                      WCJXSC
     I              AMJYSC                      WCJYSC
     I              AMJZSC                      WCJZSC
     I              AMJ0SC                      WCJ0SC
     I              AMMZU1                      WCMZU1
     I              AMM0U1                      WCM0U1
     I              AMM1U1                      WCM1U1
     I              AMM2U1                      WCM2U1
     I              AMM3U1                      WCM3U1
     I              AMW5DT                      WCW5DT
     I              AMW6DT                      WCW6DT
     I              AMUVST                      WCUVST
     I              AMUWST                      WCUWST
     I              AMUXST                      WCUXST
     I              AMVSST                      WCVSST
     I              AMAATM                      WCAATM
     I              AMAYNA                      WCAYNA
     I              AMA0NA                      WCA0NA
     I              AMAXDT                      WCAXDT
      *
     I@COCPKU
      * EDI Export Shpmnt Inf HDR Retrieval index
      * Renamed input format fields
     I              COTSCN                      WDTSCN
     I              COA0ST                      WDA0ST
     I              COHPAA                      WDHPAA
     I              COA8AB                      WDA8AB
     I              COA9AB                      WDA9AB
     I              COBAAB                      WDBAAB
     I              COBBAB                      WDBBAB
     I              COHDNZ                      WDHDNZ
     I              COBEAB                      WDBEAB
     I              COVRNA                      WDVRNA
     I              COBCAB                      WDBCAB
     I              COS5U1                      WDS5U1
     I              COBDAB                      WDBDAB
     I              COB7DX                      WDB7DX
     I              COS6U1                      WDS6U1
     I              COS7U1                      WDS7U1
     I              COS8U1                      WDS8U1
     I              COBFAB                      WDBFAB
     I              COS9U1                      WDS9U1
     I              COTAU1                      WDTAU1
     I              COTBU1                      WDTBU1
     I              COTPU1                      WDTPU1
     I              COTQU1                      WDTQU1
     I              COTRU1                      WDTRU1
     I              COCADX                      WDCADX
     I              COBETM                      WDBETM
     I              CON8SC                      WDN8SC
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                      WEAIC3
     I              BEC4NB                      WEC4NB
     I              BEJNCD                      WEJNCD
     I              BEANC7                      WEANC7
     I              BEBKC7                      WEBKC7
     I              BEBRTX                      WEBRTX
     I              BEHMNA                      WEHMNA
     I              BEHONA                      WEHONA
     I              BEHPNA                      WEHPNA
     I              BEHNNA                      WEHNNA
     I              BEDBCD                      WEDBCD
     I              BECKTX                      WECKTX
     I              BEB0C7                      WEB0C7
     I              BEAETX                      WEAETX
     I              BEB1NA                      WEB1NA
     I              BEB3NA                      WEB3NA
     I              BEB4NA                      WEB4NA
     I              BEB2NA                      WEB2NA
     I              BEBHCD                      WEBHCD
     I              BEC8TX                      WEC8TX
     I              BEBCNA                      WEBCNA
     I              BEA0DT                      WEA0DT
     I              BEA5DT                      WEA5DT
     I              BEGNDT                      WEGNDT
     I              BEACDT                      WEACDT
     I              BEAQCD                      WEAQCD
     I              BEB6NA                      WEB6NA
     I              BEBYNA                      WEBYNA
     I              BEBZNA                      WEBZNA
     I              BEGTST                      WEGTST
     I              BEGVST                      WEGVST
     I              BEGUST                      WEGUST
     I              BEQFST                      WEQFST
     I              BECQCD                      WECQCD
     I              BEGJST                      WEGJST
     I              BEGWST                      WEGWST
     I              BEGXST                      WEGXST
     I              BEGYST                      WEGYST
     I              BEAODT                      WEAODT
     I              BEAIVN                      WEAIVN
     I              BECXDT                      WECXDT
     I              BEJZVA                      WEJZVA
     I              BEA1WG                      WEA1WG
     I              BEXIST                      WEXIST
     I              BEXJST                      WEXJST
     I              BEXKST                      WEXKST
     I              BEEIDT                      WEEIDT
     I              BEAFTM                      WEAFTM
     I              BEE8CD                      WEE8CD
     I              BEE9CD                      WEE9CD
     I              BERMNB                      WERMNB
     I              BETBNB                      WETBNB
     I              BER1NB                      WER1NB
     I              BEPJST                      WEPJST
     I              BEU0ST                      WEU0ST
     I              BEU1ST                      WEU1ST
     I              BEQ2CD                      WEQ2CD
     I              BEU2ST                      WEU2ST
     I              BEVEST                      WEVEST
     I              BEVFST                      WEVFST
     I              BEVGST                      WEVGST
     I              BERPCD                      WERPCD
     I              BERNNB                      WERNNB
     I              BEVDST                      WEVDST
     I              BEATIN                      WEATIN
     I              BEU4ST                      WEU4ST
     I              BEU5ST                      WEU5ST
     I              BERSRN                      WERSRN
     I              BEMHNA                      WEMHNA
     I              BEMINA                      WEMINA
     I              BEWBST                      WEWBST
     I              BER4CD                      WER4CD
     I              BEBFCD                      WEBFCD
     I              BEQ4CD                      WEQ4CD
     I              BET3NB                      WET3NB
     I              BESICD                      WESICD
     I              BECONB                      WECONB
     I              BECEST                      WECEST
     I              BEAWDT                      WEAWDT
     I              BEJPCD                      WEJPCD
     I              BEXUST                      WEXUST
     I              BEZ1ST                      WEZ1ST
     I              BEVRVA                      WEVRVA
     I              BEOBST                      WEOBST
     I              BEBCST                      WEBCST
     I              BEBDST                      WEBDST
     I              BEB7VL                      WEB7VL
     I              BEGASX                      WEGASX
     I              BEGBSX                      WEGBSX
     I              BEGCSX                      WEGCSX
     I              BEGDSX                      WEGDSX
     I              BEFNSX                      WEFNSX
     I              BEFOSX                      WEFOSX
     I              BEFPSX                      WEFPSX
     I              BEFQSX                      WEFQSX
     I              BEFRSX                      WEFRSX
     I              BEFSSX                      WEFSSX
     I              BEFTSX                      WEFTSX
     I              BEFUSX                      WEFUSX
     I              BEFVSX                      WEFVSX
     I              BEFWSX                      WEFWSX
     I              BEFXSX                      WEFXSX
     I              BEFYSX                      WEFYSX
     I              BENODT                      WENODT
     I              BENPDT                      WENPDT
     I              BENQDT                      WENQDT
     I              BENRDT                      WENRDT
     I              BENSDT                      WENSDT
     I              BEBPTM                      WEBPTM
     I              BEBQTM                      WEBQTM
     I              BEBRTM                      WEBRTM
     I              BEBSTM                      WEBSTM
     I              BEBTTM                      WEBTTM
     I              BEH0NX                      WEH0NX
     I              BEH1NX                      WEH1NX
     I              BEH2NX                      WEH2NX
     I              BEH3NX                      WEH3NX
     I              BEH4NX                      WEH4NX
     I              BEC0C7                      WEC0C7
     I              BEUVST                      WEUVST
     I              BEUWST                      WEUWST
     I              BEUXST                      WEUXST
     I              BEAATM                      WEAATM
     I              BEAYNA                      WEAYNA
     I              BEA0NA                      WEA0NA
     I              BEAXDT                      WEAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Conduct screen conversation
     C                   DO        *HIVAL
      * Start new transaction
     C                   MOVEL     'Y'           W0TRN
      * Process current transaction
      * Convert fields to external form
     C                   DOW       W0TRN = 'Y'
     C                   EXSR      MNCV#1
      * Display screen
     C                   EXSR      CAEXFM
      * Process response
      * Cancel & exit program
     C   03              CAS                     ZXEXPG
      * HOME: Reset screen fields
     C   30              CAS                     MALDSC
      * Process screen input
     C                   CAS                     DAPRSC
     C                   END
      *
     C                   END
      *
     C                   END
      *****************************************************************
      /EJECT
     CSR   CAEXFM        BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                   TIME                    ##TME
     C                   DOU       W0HLP = 'N'
     C                   MOVEL     'N'           W0HLP
     C                   MOVE      *IN04         YPMT04
     C                   MOVE      *IN25         HELP25
     C                   MOVE      *ALL'0'       ##OFF
     C                   MOVEA     ##OFF         *IN(1)
     C                   MOVE      YPMT04        *IN04
     C                   MOVE      HELP25        *IN25
      * Set cursor by *SET CURSOR data
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y0SET
     C                   END
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   EXFMT     #RCDDTL1
      * Test cursor
     C                   EXSR      Y8TST
      * Check if prompt requested
     C                   EXSR      ZDVPMT
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
     C                   END
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y9CLR
     C                   END
      *================================================================
     CSR   CAEXIT        ENDSR
      /EJECT
     CSR   DAPRSC        BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                   MOVEL     'N'           W0DCF
      * USER: Process command keys
      * CASE: DTL.*CMD key is CF07
     C                   IF        YPMTFD = ' '
      * CHG 3 AES Fields   CH - Order Header Extension  * 
     C                   IF        *IN07
     C                   EXSR      SACHRC
      * Chg AES Fields CH - EDI Export Shpmnt Inf HDR  * 
     C                   EXSR      SBCHRC
     C                   END                                                    *FI
     C                   END
      * Validate screen input
     C                   EXSR      DBVLSC
      * If error, exit
     C     *IN99         CABEQ     '1'           DAEXIT
      * Defer confirm/update requested
     C     W0DCF         CABEQ     'Y'           DAEXIT
      * Prompt for confirmation
     C                   EXSR      DHPMCF
      * Quit if not confirmed
     C     *IN99         CABEQ     '1'           DAEXIT
      * Exit program
     C                   EXSR      ZXEXPG
      *================================================================
     CSR   DAEXIT        ENDSR
      /EJECT
     CSR   DBVLSC        BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                   MOVEL     V1AIC3        WUI3ST                         USR First Posit
     C                   EVAL      W0RTN = ' '                                  *Return code
      * CASE: WRK.USR First Position is Search request
     C                   IF        WUI3ST = '?'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     V1AIC3        WUDMCD                         CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
      * RIGHT JUSTIFY INPUT FIELD
     C                   MOVE      *BLANKS       JUSTC3            3
     C                   MOVEA     *BLANKS       K3
     C                   Z-ADD     3             C                 3 0
     C                   Z-ADD     3             D                 3 0
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                   MOVEA     WUDMCD        J3
     C                   MOVE      *BLANKS       W0RTN
     C                   DO        3
     C     J3(C)         IFNE      ' '
     C                   MOVEA     J3(C)         K3(D)
     C                   SUB       1             D
     C                   END
     C                   SUB       1             C
     C                   END
     C                   MOVEA     K3            JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                   MOVE      JUSTC3        TESTC             1
     C     TESTC         IFGT      '?'
     C     TESTC         ANDLT     '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   ELSE
     C                   MOVE      *IN60         HLDIN             1
     C                   TESTN                   JUSTC3               606060
     C     *IN60         IFEQ      '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   END
     C                   END
     C                   MOVE      JUSTC3        WUDMCD
     C                   MOVE      HLDIN         *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                   IF        W0RTN = @CN(001)
     C                   MOVEL     'USR0752'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   Z-ADD     *ZERO         #1AIC3                         CD3 Int Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVE      WUDMCD        #1AIC3                         CD3 Int Numeric
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                   MOVEL     V1C4NB        WUI3ST                         USR First Posit
     C                   EVAL      W0RTN = ' '                                  *Return code
      * CASE: WRK.USR First Position is Search request
     C                   IF        WUI3ST = '?'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     V1C4NB        WUEOCD                         CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
      * RIGHT JUSTIFY INPUT FIELD
     C                   MOVE      *BLANKS       JUSTC7            7
     C                   MOVEA     *BLANKS       K7
     C                   Z-ADD     7             C                 3 0
     C                   Z-ADD     7             D                 3 0
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                   MOVEA     WUEOCD        J7
     C                   MOVE      *BLANKS       W0RTN
     C                   DO        7
     C     J7(C)         IFNE      ' '
     C                   MOVEA     J7(C)         K7(D)
     C                   SUB       1             D
     C                   END
     C                   SUB       1             C
     C                   END
     C                   MOVEA     K7            JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                   MOVE      JUSTC7        TEST7             1
     C     TEST7         IFGT      '?'
     C     TEST7         ANDLT     '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   ELSE
     C                   MOVE      *IN60         HLDIN             1
     C                   TESTN                   JUSTC7               606060
     C     *IN60         IFEQ      '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   END
     C                   END
     C                   MOVE      JUSTC7        WUEOCD
     C                   MOVE      HLDIN         *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                   IF        W0RTN = @CN(001)
     C                   MOVEL     'USR0802'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   Z-ADD     *ZERO         #1C4NB                         CD7 Int Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVE      WUEOCD        #1C4NB                         CD7 Int Numeric
     C                   END                                                    *FI
     C                   END                                                    *FI
      * USER: Validate fields
      * Rtv All fields        RT - Order Header Extension  * 
     C                   IF        YPMTFD = ' '
     C                   EXSR      SCRVGN
      * If NF = error message
      * CASE: PGM.*Return code is *Record does not exist
      * Send message 'Order Header Extension NF'
     C                   IF        W0RTN = @CN(002)
     C                   MOVEL     'USR3697'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   END                                                    *FI
      * RTV All Fields RT - EDI Export Shpmnt Inf HDR  * 
     C                   EXSR      SDRVGN
      * If NF = error message
      * CASE: PGM.*Return code is *Record does not exist
      * Send message 'EDI Exp Shpmnt Inf HDR NF'
     C                   IF        W0RTN = @CN(002)
     C                   MOVEL     'USR5267'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   END                                                    *FI
     C                   END
      * Bypass ref file checks if error already detected
     C   99              GOTO      DBEXIT
      * Select existing record
     C                   EXSR      VACKRL
      * Check reference to Order Header TRG
     C                   EXSR      VBCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        993132    *
     C                   END
      * Company Number required
     C                   IF        #1AIC3 = *ZERO AND
     C                             YPMTFD = ' '
     C                   SETON                                        9931      *
      * Send message '*Value required'
     C                   MOVEL     'Y2U0001'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END                                                    FI
      * Order Number required
     C                   IF        #1C4NB = *ZERO AND
     C                             YPMTFD = ' '
     C                   SETON                                        9932      *
      * Send message '*Value required'
     C                   MOVEL     'Y2U0001'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END                                                    FI
      * ST02-TRANS SET CONTROL NU required
     C                   IF        #DTSCN = *ZERO AND
     C                             YPMTFD = ' '
     C                   SETON                                        9933      *
      * Send message '*Value required'
     C                   MOVEL     'Y2U0001'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END                                                    FI
      *================================================================
     CSR   DBEXIT        ENDSR
      /EJECT
     CSR   DHPMCF        BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                   EXSR      MNCV#1
      * Update screen time
     C                   TIME                    ##TME
      * Refresh screen
     C                   EVAL      ##CFCD = ' '
     C                   MOVEL     'N'           ##CFCD
      * Save CMD keys
     C                   MOVEA     *IN           WN30
     C                   SETOFF                                       29        *
      * Generate internal/external key list
     C     KINEX         KLIST
     C                   KFLD                    Y2LSNO
     C                   KFLD                    Y2INVL
      * Convert *CONFIRM to external value
     C                   Z-ADD     1001713       Y2LSNO
     C                   EVAL      Y2INVL = ' '
     C                   MOVEL     ##CFCD        Y2INVL                         *CONFIRM
     C     KINEX         CHAIN     @Y2INEX                            90        *
     C  N90              MOVEL     Y2EXVL        V#CFCD                         *CONFIRM
      *
     C                   DOU       W0HLP = 'N' AND
     C                             NOT *IN29
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   WRITE     #RCDDTL1
     C                   EXFMT     #CONFIRM
     C                   IF        *IN29
     C                   SETON                                        99
     C                   GOTO      DHEXIT
     C                   END
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
      * Validate *CONFIRM
     C                   EVAL      W0RTN = ' '
     C                   MOVEL     V#CFCD        W0NSRQ                         *CONFIRM
      * Name search required?
     C                   IF        W0NSRQ = '?' OR
     C                             'V#CFCD' = YPMTFD
     C                   CALL      'CAVLLSR'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1001713       Y2LSNO
     C     V#CFCD        PARM      V#CFCD        W0EXVL                         *CONFIRM
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
     C                   IF        W0NSRQ <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
     C                   END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C     KEXIN         KLIST
     C                   KFLD                    Y2LSNO
     C                   KFLD                    Y2EXVL
      * Convert *CONFIRM to internal value
     C                   Z-ADD     1001713       Y2LSNO
     C                   EVAL      Y2EXVL = ' '
     C                   MOVEL     V#CFCD        Y2EXVL                         *CONFIRM
     C     KEXIN         CHAIN     @Y2EXIN                            90        *
     C                   IF        *IN90
     C                   EVAL      ##CFCD = ' '
     C                   IF        YPMTFD = ' '
     C                   SETON                                        96        *
     C                   WRITE     #CONFIRM
     C                   SETOFF                                       96        *
     C                   END
     C                   ELSE
     C                   MOVEL     Y2INVL        ##CFCD                         *CONFIRM
     C                   END
      *
     C   90              SETON                                        29        *
     C  N90              SETOFF                                       29        *
     C                   END
      * Restore CMD keys
     C                   MOVEA     WN30          *IN
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   IF        ##CFCD = 'Y'
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   END
     C     ##CFCD        COMP      'Y'                                9999      *
      * Not confirmed
      *================================================================
     CSR   DHEXIT        ENDSR
      /EJECT
     CSR   MALDSC        BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                   Z-ADD     *ZERO         #1RUNB                         Stop_Drop Seque
     C                   Z-ADD     *ZERO         #1AIC3                         Company Number
      * Clear external version also
     C                   EVAL      V1AIC3 = ' '
     C                   Z-ADD     *ZERO         #1C4NB                         Order Number
      * Clear external version also
     C                   EVAL      V1C4NB = ' '
     C                   Z-ADD     *ZERO         #1RMNB                         Load ID
     C                   EVAL      #DPTSC = ' '                                 OHE EDI 824 Act
     C                   EVAL      #1JVSC = ' '                                 OHE EDI 824 Act
     C                   EVAL      #DPUSC = ' '                                 OHE EDI 601 Act
     C                   EVAL      #1JZSC = ' '                                 OHE EDI 601 Act
     C                   EVAL      #DWYU1 = ' '                                 OHE EDI 824 AES
     C                   EVAL      #1M2U1 = ' '                                 OHE EDI 824 AES
     C                   Z-ADD     *ZERO         #DTSCN                         ST02-TRANS SET
     C                   EVAL      #DPVSC = ' '                                 EDI-Record Proc
     C                   EVAL      #DA0ST = ' '                                 EDI-Record Proc
     C                   Z-ADD     *ZERO         #DK5NZ                         BA105-Shpt Ref
     C                   Z-ADD     *ZERO         #DHDNZ                         BA105-Shipment
     C                   EVAL      #DPWSC = ' '                                 EDI 824 Receive
     C                   EVAL      #DN8SC = ' '                                 EDI 824 Receive
      *================================================================
     CSR   MAEXIT        ENDSR
      /EJECT
     CSR   MNCV#1        BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C                   IF        #1AIC3 <> 0
     C                   EVAL      WUDMCD = ' '                                 CD3 Ext Numeric
     C                   MOVEL     #1AIC3        WUDMCD                         CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUDMCD        #L3                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        3
     C     #L3(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L3(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L3           WUDMCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUDMCD        V1AIC3                         CD3 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      V1AIC3 = ' '                                 CD3 Ext Numeric
     C                   END                                                    *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        #1C4NB <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     #1C4NB        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        V1C4NB                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      V1C4NB = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      *================================================================
     CSR   MNEXIT        ENDSR
      /EJECT
     CSR   SACHRC        BEGSR
      *================================================================
      * CHG 3 AES Fields   CH - Order Header Extension  * 
      *================================================================
      *
     C                   EVAL      WN0001 = ' '                                 Shipping Line
     C                   EVAL      WN0002 = ' '                                 Port Delv Termi
     C                   EVAL      WN0003 = ' '                                 OHE City
     C                   EVAL      WN0004 = ' '                                 OHE Vessel_Airl
     C                   EVAL      WN0005 = ' '                                 OHE Voyage_Flig
     C                   EVAL      WN0006 = ' '                                 OHE Booking Num
     C                   EVAL      WN0007 = ' '                                 OHE Discharge P
     C                   Z-ADD     *ZERO         WN0008                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WN0009                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WN0010                         OHE Arrival Dat
     C                   EVAL      WN0011 = ' '                                 OHE Late Delive
     C                   EVAL      WN0012 = ' '                                 OHE Ship Status
     C                   EVAL      WN0013 = ' '                                 OHE Container N
     C                   EVAL      WN0014 = ' '                                 OHE Comment 1
     C                   EVAL      WN0015 = ' '                                 OHE Comment 2
     C                   Z-ADD     *ZERO         WN0016                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0017                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0018                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0019                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0020                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WN0021                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WN0022                         Transload Termi
     C                   Z-ADD     *ZERO         WN0023                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WN0024                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WN0025                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WN0026                         OHE Actual Ship
     C                   EVAL      WN0027 = ' '                                 OHE Carrier SCA
     C                   EVAL      WN0028 = ' '                                 OHE Spot Buy
     C                   EVAL      WN0029 = ' '                                 OHE PO ACK Flag
     C                   EVAL      WN0030 = ' '                                 OHE Override Ty
     C                   EVAL      WN0031 = ' '                                 OHE Backhaul St
     C                   EVAL      WN0032 = ' '                                 OHE Backhaul ET
     C                   EVAL      WN0033 = ' '                                 OHE Load Haul T
     C                   EVAL      WN0034 = ' '                                 OHE Backhaul Ca
     C                   EVAL      WN0035 = ' '                                 OHE Bookings Co
     C                   EVAL      WN0036 = ' '                                 OHE EDI Error R
     C                   EVAL      WN0037 = ' '                                 OHE EDI Error R
     C                   Z-ADD     *ZERO         WN0038                         HPB COA Batch N
     C                   EVAL      WN0039 = ' '                                 Delivery P_O  N
     C                   EVAL      WN0040 = ' '                                 OHE Intended fo
     C                   EVAL      WN0041 = ' '                                 OHE EDI 943 Act
     C                   EVAL      WN0042 = ' '                                 OHE EDI 944 Act
     C                   EVAL      WN0043 = ' '                                 OHE EDI 940 Act
     C                   EVAL      WN0044 = ' '                                 OHE EDI 945 Act
     C                   EVAL      WN0045 = ' '                                 OHE EDI 856 Act
     C                   EVAL      WN0046 = ' '                                 OHE Transload S
     C                   EVAL      WN0047 = ' '                                 OHE Abs Rate Ov
     C                   EVAL      WN0048 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0049 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0050 = ' '                                 OHE Backhaul Ch
     C                   EVAL      WN0051 = ' '                                 OHE Transload C
     C                   EVAL      WN0052 = ' '                                 OHE Pier Pass I
     C                   EVAL      WN0053 = ' '                                 OHE Carrier Nm
     C                   EVAL      WN0054 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0055 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0056 = ' '                                 Letter of Credi
     C                   Z-ADD     *ZERO         WN0057                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WN0058                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WN0059                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0060                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WN0061                         OHE Port Check
     C                   Z-ADD     *ZERO         WN0062                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WN0063                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WN0064                         OHE Load Sched
     C                   Z-ADD     *ZERO         WN0065                         Original Appoin
     C                   Z-ADD     *ZERO         WN0066                         Original Appoin
     C                   Z-ADD     *ZERO         WN0067                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0068                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0069                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WN0070                         OHE Orig ABS Fr
     C                   EVAL      WN0071 = ' '                                 OHE Genset Numb
     C                   EVAL      WN0072 = ' '                                 OHE Email BOL_S
     C                   EVAL      WN0073 = ' '                                 OHE EDI Order A
     C                   EVAL      WN0074 = ' '                                 OHE Unused Stat
     C                   EVAL      WN0075 = ' '                                 OHE Unused Text
     C                   EVAL      WN0076 = ' '                                 OHE Unused Text
     C                   EVAL      WN0077 = ' '                                 OHE Customer Ve
     C                   EVAL      WN0078 = ' '                                 OHE Unused Text
     C                   Z-ADD     *ZERO         WN0079                         OHE Unused Date
     C                   Z-ADD     *ZERO         WN0080                         OHE Unused Date
     C                   EVAL      WN0081 = ' '                                 EDI Status 1
     C                   EVAL      WN0082 = ' '                                 EDI Status 2
     C                   EVAL      WN0083 = ' '                                 EDI Status 3
     C                   EVAL      WN0084 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0085                         Job Time
     C                   EVAL      WN0086 = ' '                                 User Id
     C                   EVAL      WN0087 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0088                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @AMREJE
     C                   Z-ADD     #1AIC3        WAAIC3                         Company Number
     C                   Z-ADD     #1C4NB        WAC4NB                         Order Number
      *
     C     KLCHSA        KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAC4NB                         Order Number
     C     KLCHSA        CHAIN     @AMREJE                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PMAMREL0'    MDACP
     C                   MOVEL     '@AMREJE'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPMAM1        YARDCS
      * Move non-key fields to @AMREJE
     C                   Z-ADD     #1RMNB        WARMNB                         Load ID
     C                   Z-ADD     #1RUNB        WARUNB                         Stop_Drop Seque
     C                   EVAL      WAJVSC = ' '                                 OHE EDI 824 Act
     C                   EVAL      WAJZSC = ' '                                 OHE EDI 601 Act
     C                   EVAL      WAM2U1 = ' '                                 OHE EDI 824 AES
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp 2 IF
     C                   Z-ADD     ##JTM         WAAATM                         Job Time
     C                   MOVEL     ##USR         WAAYNA                         User Id
     C                   MOVEL     ##PGM         WAA0NA                         Job Name
     C                   Z-ADD     ##JDT         WAAXDT                         Job Date
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @AMREJE                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PMAMREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBCHRC        BEGSR
      *================================================================
      * Chg AES Fields CH - EDI Export Shpmnt Inf HDR  * 
      *================================================================
      *
     C                   EVAL      WN0089 = ' '                                 TRADE PARTNER C
     C                   EVAL      WN0090 = ' '                                 BA101-Related C
     C                   EVAL      WN0091 = ' '                                 BA102-Action Co
     C                   EVAL      WN0092 = ' '                                 BA103-Transport
     C                   EVAL      WN0093 = ' '                                 BA104-Country C
     C                   Z-ADD     *ZERO         WN0094                         BA105-Shipment
     C                   EVAL      WN0095 = ' '                                 BA108-Ship From
     C                   EVAL      WN0096 = ' '                                 BA109-IRS Ident
     C                   EVAL      WN0097 = ' '                                 BA110-SCAC
     C                   EVAL      WN0098 = ' '                                 BA112-Vessel Na
     C                   EVAL      WN0099 = ' '                                 YNQ01-Type of F
     C                   Z-ADD     *ZERO         WN0100                         DTM02-Sail Date
     C                   EVAL      WN0101 = ' '                                 PS03-Port of Ex
     C                   EVAL      WN0102 = ' '                                 P503-Port of Un
     C                   EVAL      WN0103 = ' '                                 REF02-Ref ITN
     C                   EVAL      WN0104 = ' '                                 M1201-Customs E
     C                   EVAL      WN0105 = ' '                                 M1202-Customs E
     C                   EVAL      WN0106 = ' '                                 M1203-Location
     C                   EVAL      WN0107 = ' '                                 M1204-Foreign P
     C                   EVAL      WN0108 = ' '                                 EDI ESIH-Unused
     C                   EVAL      WN0109 = ' '                                 ESIH OHE Bookin
     C                   EVAL      WN0110 = ' '                                 EDI ESIH-Unused
     C                   Z-ADD     *ZERO         WN0111                         Create Date D8#
     C                   Z-ADD     *ZERO         WN0112                         Create Time
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @COCPKT
     C                   Z-ADD     #DTSCN        WBTSCN                         ST02-TRANS SET
      *
     C     KLCHSB        KLIST
     C                   KFLD                    WBTSCN                         ST02-TRANS SET
     C     KLCHSB        CHAIN     @COCPKT                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'ECP136L0'    MDACP
     C                   MOVEL     '@COCPKT'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QECP11        YBRDCS
      * Move non-key fields to @COCPKT
     C                   MOVEL(P)  'X'           WBA0ST                         EDI-Record Proc
     C                   MOVEL(P)  'Y'           WBN8SC                         EDI 824 Receive
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QECP11 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @COCPKT                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    ECP136L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Rtv All fields        RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WCAIC3                         Company Number
     C                   KFLD                    WCC4NB                         Order Number
      * Setup key
     C                   Z-ADD     #1AIC3        WCAIC3                         Company Number
     C                   Z-ADD     #1C4NB        WCC4NB                         Order Number
      * Establish starting position
     C     KRSSC         CHAIN     @AMREJF                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR3697'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   Z-ADD     *ZERO         #1RMNB                         Load ID
     C                   Z-ADD     *ZERO         #1RUNB                         Stop_Drop Seque
     C                   EVAL      #DPTSC = ' '                                 OHE EDI 824 Act
     C                   EVAL      #DPUSC = ' '                                 OHE EDI 601 Act
     C                   EVAL      #DWYU1 = ' '                                 OHE EDI 824 AES
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WCRMNB        #1RMNB                         Load ID
     C                   Z-ADD     WCRUNB        #1RUNB                         Stop_Drop Seque
     C                   MOVEL     WCJVSC        #DPTSC                         OHE EDI 824 Act
     C                   MOVEL     WCJZSC        #DPUSC                         OHE EDI 601 Act
     C                   MOVEL     WCM2U1        #DWYU1                         OHE EDI 824 AES
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * RTV All Fields RT - EDI Export Shpmnt Inf HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WDTSCN                         ST02-TRANS SET
      * Setup key
     C                   Z-ADD     #DTSCN        WDTSCN                         ST02-TRANS SET
      * Establish starting position
     C     KRSSD         CHAIN     @COCPKU                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5267'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      #DPVSC = ' '                                 EDI-Record Proc
     C                   Z-ADD     *ZERO         #DK5NZ                         BA105-Shipment
     C                   EVAL      #DPWSC = ' '                                 EDI 824 Receive
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WDA0ST        #DPVSC                         EDI-Record Proc
     C                   Z-ADD     WDHDNZ        #DK5NZ                         BA105-Shipment
     C                   MOVEL     WDN8SC        #DPWSC                         EDI 824 Receive
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   VACKRL        BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                   MOVEL     V1AIC3        WK1X01
     C                   MOVEL     V1C4NB        WK1X02
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0001' defaulted for 'OHE Booking Number'.
      * Field '(LCL) YL0002' defaulted for 'Record Selected       USR'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1AIC3' OR
     C                             WK1X02 = '?' OR
     C                             YPMTFD = '#1C4NB'
     C                   CALL      'PBA9SRR'                            90      SEL Booking Num
     C                   PARM      *BLANK        W0RTN
     C     YL0001        PARM      YL0001        WQ0001                         OHE Booking Num
     C     YL0002        PARM      *BLANK        WQ0002                         Record Selected
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBA9SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1AIC3 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1C4NB <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X02 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
     C                   END
      *================================================================
     CSR   VAEXIT        ENDSR
      /EJECT
     CSR   VBCKRL        BEGSR
      *================================================================
      * Check reference to Order Header TRG
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     V1AIC3        WK1X01
     C                   MOVEL     V1C4NB        WK1X02
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1C4NB' defaulted for 'Order Number'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1AIC3' OR
     C                             WK1X02 = '?' OR
     C                             YPMTFD = '#1C4NB'
     C                   CALL      'PDPCSRR'                            90      SEL Order
     C                   PARM      *BLANK        W0RTN
     C     #1AIC3        PARM      #1AIC3        WQ0003                         Company Number
     C     #1C4NB        PARM      #1C4NB        WQ0004                         Order Number
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDPCSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        993132    *
     C                   END
      *
     C                   IF        #1AIC3 <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1C4NB <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X02 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VBEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1AIC3 = *ZERO AND
     C                             #1C4NB = *ZERO
     C                   GOTO      VBEXIT
     C                   END
      *
     C     KLVBWE        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEC4NB                         Order Number
      * Setup key
     C                   Z-ADD     #1AIC3        WEAIC3
     C                   Z-ADD     #1C4NB        WEC4NB
     C     KLVBWE        CHAIN     @BECPFK                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VBEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VBEXIT
     C                   END
      * Send message 'Order Header TRG       NF'
     C                   MOVEL     'USR0176'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'USR0176'     W0RTN
      *================================================================
     CSR   VBEXIT        ENDSR
      /EJECT
     CSR   Y0SET         BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y0EXIT        ENDSR
      /EJECT
     CSR   Y8TST         BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                   Z-ADD     @#RWCL        ZINPOS
     C     ZINPOS        DIV       256           W0CRW
     C                   MVR                     W0CCL
      *================================================================
     CSR   Y8EXIT        ENDSR
      /EJECT
     CSR   Y9CLR         BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y9EXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZDVPMT        BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                   EVAL      YPMTFD = ' '
     C                   Z-ADD     *ZERO         YAFSCH
     C                   Z-ADD     *ZERO         YPMRRN
      *
      *
      * Extract cursor row and column
     C                   IF        *IN04
     C     @#RWCL        DIV       256           ZHCSRW
     C                   MVR                     ZHCSCL
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
     C                   IF        ZHCSRW = 004 AND
     C                             ZHCSCL >= 032 AND
     C                             ZHCSCL <= 034 AND
     C                             @#DFMT = '#RCDDTL1'
     C                   MOVEL     '#1AIC3'      YPMTFD                         Company Number
     C                   END
      *
     C                   IF        ZHCSRW = 005 AND
     C                             ZHCSCL >= 032 AND
     C                             ZHCSCL <= 038 AND
     C                             @#DFMT = '#RCDDTL1'
     C                   MOVEL     '#1C4NB'      YPMTFD                         Order Number
     C                   END
      *
      * Error if user defined prompting is not specified.
     C                   IF        YPMTFD = ' '
     C                   IF        W0PMT = 'N'
     C                   MOVEL     '*NONE'       YPMTFD
     C                   MOVEL     'Y'           W0HLP
     C                   MOVEL     'Y'           ZAFSMS
      * Send error message.
     C                   MOVEL     'Y2U0101'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END
     C                   END
      *
     C                   END
      *================================================================
     CSR   ZDEXIT        ENDSR
      /EJECT
     CSR   ZHHPKY        BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                   MOVEL     'Y'           W0HLP
      *
      * Extract cursor row and column
     C     @#RWCL        DIV       256           ZHCSRW                         Row
     C                   MVR                     ZHCSCL                         Column
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
      *
     C                   CALL      'YDDSHPR'
     C                   PARM      ##PGM         W0HPMB                         Help text sourc
     C                   PARM      *BLANK        YYHPFL                         Help text file
     C                   PARM      *BLANK        YYHPLB                         Help text libra
     C                   PARM                    W0RTN
     C                   PARM      '*CSRLOC'     YYHLVN                         Help label
     C                   PARM      '*NORMAL'     YYUSOP                         Options
     C                   PARM      ZHCSRW        YYRW                           Row
     C                   PARM      ZHCSCL        YYCL                           Column
     C                   PARM      *ZERO         YYLGCT                         # of grps
     C                   PARM      *BLANK        YYLGVN                         Label grps
      *
      * Clear set cursor DDS indicator
     C  N94              MOVEL     'OFF'         WCSRLC
     C  N94              SETON                                        94        *
      *================================================================
     CSR   ZHEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WARUNB                         Stop_Drop Seque
     C                   Z-ADD     *ZERO         WAQWDT                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WAQXDT                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WAQYDT                         OHE Arrival Dat
     C                   Z-ADD     *ZERO         WAGINY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WAGFNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WAGGNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WAGHNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WAHEVL                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WAHFVL                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WAHGVL                         Transload Termi
     C                   Z-ADD     *ZERO         WAQZDT                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WAQ0DT                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WAQ1DT                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WAQ2DT                         OHE Actual Ship
     C                   Z-ADD     *ZERO         WAITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WAQJNY                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WAQKNY                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WAQLNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WAP8NY                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WAP9NY                         OHE Port Check
     C                   Z-ADD     *ZERO         WAQANY                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WAQCNY                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WAQDNY                         OHE Load Sched
     C                   Z-ADD     *ZERO         WAQENY                         Original Appoin
     C                   Z-ADD     *ZERO         WAQFNY                         Original Appoin
     C                   Z-ADD     *ZERO         WAQGNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WAQHNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WAQINY                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WAQMNY                         OHE Orig ABS Fr
     C                   Z-ADD     *ZERO         WAW5DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WAW6DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBTSCN                         ST02-TRANS SET
     C                   Z-ADD     *ZERO         WBHDNZ                         BA105-Shipment
     C                   Z-ADD     *ZERO         WBB7DX                         DTM02-Sail Date
     C                   Z-ADD     *ZERO         WBCADX                         Create Date D8#
     C                   Z-ADD     *ZERO         WBBETM                         Create Time
      * Define work field USR First Position
     C                   EVAL      WUI3ST = ' '
      * Define work field CD3 Ext Numeric Key
     C                   EVAL      WUDMCD = ' '
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Define work field CD7 Ext Numeric Key
     C                   EVAL      WUEOCD = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEAIC3                         Company Number
     C                   Z-ADD     *ZERO         WEC4NB                         Order Number
     C                   Z-ADD     *ZERO         WEANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WEBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WEB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WEA0DT                         Order Date
     C                   Z-ADD     *ZERO         WEA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WEGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WEACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WEAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WECXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WEJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WEA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WEEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WEAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WERMNB                         Load ID
     C                   Z-ADD     *ZERO         WETBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WER1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WERNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WEATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WERSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WET3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WECONB                         Invoice Number
     C                   Z-ADD     *ZERO         WEAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WEVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WEB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WENODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WENPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WENQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WENRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WENSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WEBPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WEBQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WEBRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WEBSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WEBTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WEH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WEH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WEH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WEH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WEH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WEC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WEAATM                         Job Time
     C                   Z-ADD     *ZERO         WEAXDT                         Job Date
      * Flag no *SET CURSOR in the program
     C                   MOVE      'N'           YSETCS
     C                   EVALR     WCSRLC = ' '
      * Define *Synon program work fields
     C                   EVAL      W0CFL = ' '                                  *Cursor field
     C                   Z-ADD     *ZEROS        W0CRW                          *Cursor row
     C                   Z-ADD     *ZEROS        W0CCL                          *Cursor column
      * Move main file information to JOB context
     C                   MOVE      @1FFL         ZZFFL                          Main file name
     C                   MOVE      @1FLB         ZZFLB                          Main file lib
     C                   MOVE      @1FMB         ZZFMB                          Main file mbr
     C                   MOVE      ZZFFL         @1FFL
     C                   MOVE      ZZFLB         @1FLB
     C                   MOVE      ZZFMB         @1FMB
     C                   CALL      'Y2QLVNR'
     C                   PARM                    ZZFFL
     C                   PARM                    ZZFLB
     C                   PARM                    ZZFQL                          LIBRARY/FILE
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define null work field Shipping Line
     C                   EVAL      YN0001 = ' '
      * Define null work field Port Delv Terminal
     C                   EVAL      YN0002 = ' '
      * Define null work field OHE City
     C                   EVAL      YN0003 = ' '
      * Define null work field OHE Vessel_Airline
     C                   EVAL      YN0004 = ' '
      * Define null work field OHE Voyage_Flight
     C                   EVAL      YN0005 = ' '
      * Define null work field OHE Booking Number
     C                   EVAL      YN0006 = ' '
      * Define null work field OHE Discharge Port_Airprt
     C                   EVAL      YN0007 = ' '
      * Define null work field OHE Sail_Flight Date
     C                   Z-ADD     *ZERO         YN0008
      * Define null work field OHE Port Cut Date
     C                   Z-ADD     *ZERO         YN0009
      * Define null work field OHE Arrival Date
     C                   Z-ADD     *ZERO         YN0010
      * Define null work field OHE Late Delivery Code
     C                   EVAL      YN0011 = ' '
      * Define null work field OHE Ship Status
     C                   EVAL      YN0012 = ' '
      * Define null work field OHE Container Number
     C                   EVAL      YN0013 = ' '
      * Define null work field OHE Comment 1
     C                   EVAL      YN0014 = ' '
      * Define null work field OHE Comment 2
     C                   EVAL      YN0015 = ' '
      * Define null work field OHE Unused Number 1_11_0
     C                   Z-ADD     *ZERO         YN0016
      * Define null work field OHE Unused Number 2_11_0
     C                   Z-ADD     *ZERO         YN0017
      * Define null work field OHE Unused Number 3_11_0
     C                   Z-ADD     *ZERO         YN0018
      * Define null work field OHE Unused Number 4_11_0
     C                   Z-ADD     *ZERO         YN0019
      * Define null work field OHE HPB RIN Equiv Value
     C                   Z-ADD     *ZERO         YN0020
      * Define null work field OHE HPB RIN Price
     C                   Z-ADD     *ZERO         YN0021
      * Define null work field Transload Terminal Fees
     C                   Z-ADD     *ZERO         YN0022
      * Define null work field OHE Est Arrv at Dest Date
     C                   Z-ADD     *ZERO         YN0023
      * Define null work field OHE Backhaul ETA RtrnDate
     C                   Z-ADD     *ZERO         YN0024
      * Define null work field OHE Port_Pier Paid Date
     C                   Z-ADD     *ZERO         YN0025
      * Define null work field OHE Actual Ship Date
     C                   Z-ADD     *ZERO         YN0026
      * Define null work field OHE Carrier SCAC Code
     C                   EVAL      YN0027 = ' '
      * Define null work field OHE Spot Buy
     C                   EVAL      YN0028 = ' '
      * Define null work field OHE PO ACK Flag
     C                   EVAL      YN0029 = ' '
      * Define null work field OHE Override Type Code
     C                   EVAL      YN0030 = ' '
      * Define null work field OHE Backhaul Status
     C                   EVAL      YN0031 = ' '
      * Define null work field OHE Backhaul ETA AM_PM
     C                   EVAL      YN0032 = ' '
      * Define null work field OHE Load Haul Type
     C                   EVAL      YN0033 = ' '
      * Define null work field OHE Backhaul Carrier Code
     C                   EVAL      YN0034 = ' '
      * Define null work field OHE Bookings Confirmed
     C                   EVAL      YN0035 = ' '
      * Define null work field OHE EDI Error Reasons
     C                   EVAL      YN0036 = ' '
      * Define null work field OHE EDI Error Reasons 2
     C                   EVAL      YN0037 = ' '
      * Define null work field HPB COA Batch Number
     C                   Z-ADD     *ZERO         YN0038
      * Define null work field Delivery P_O  Number
     C                   EVAL      YN0039 = ' '
      * Define null work field OHE Intended for ExportCC
     C                   EVAL      YN0040 = ' '
      * Define null work field OHE EDI 943 Action
     C                   EVAL      YN0041 = ' '
      * Define null work field OHE EDI 944 Action
     C                   EVAL      YN0042 = ' '
      * Define null work field OHE EDI 940 Action
     C                   EVAL      YN0043 = ' '
      * Define null work field OHE EDI 945 Action
     C                   EVAL      YN0044 = ' '
      * Define null work field OHE EDI 856 Action
     C                   EVAL      YN0045 = ' '
      * Define null work field OHE Transload Seal Nbr
     C                   EVAL      YN0046 = ' '
      * Define null work field OHE Abs Rate Override Rsn
     C                   EVAL      YN0047 = ' '
      * Define null work field OHE Appt Confirmation #
     C                   EVAL      YN0048 = ' '
      * Define null work field OHE Backhaul Container#
     C                   EVAL      YN0049 = ' '
      * Define null work field OHE Backhaul Chassis #
     C                   EVAL      YN0050 = ' '
      * Define null work field OHE Transload Container#
     C                   EVAL      YN0051 = ' '
      * Define null work field OHE Pier Pass Invoice
     C                   EVAL      YN0052 = ' '
      * Define null work field OHE Carrier Nm
     C                   EVAL      YN0053 = ' '
      * Define null work field OHE Appt Confirmation Nm
     C                   EVAL      YN0054 = ' '
      * Define null work field OHE Backhaul Comment
     C                   EVAL      YN0055 = ' '
      * Define null work field Letter of Credit Number
     C                   EVAL      YN0056 = ' '
      * Define null work field OHE Backhaul Return to Co
     C                   Z-ADD     *ZERO         YN0057
      * Define null work field LD Stop_Drop
     C                   Z-ADD     *ZERO         YN0058
      * Define null work field OHE Unused Number 3_0
     C                   Z-ADD     *ZERO         YN0059
      * Define null work field OHE Pier Pass Fee Amount
     C                   Z-ADD     *ZERO         YN0060
      * Define null work field OHE Port Check Fee Amount
     C                   Z-ADD     *ZERO         YN0061
      * Define null work field OHE Port Cut Time
     C                   Z-ADD     *ZERO         YN0062
      * Define null work field OHE Backhaul Truck Number
     C                   Z-ADD     *ZERO         YN0063
      * Define null work field OHE Load Sched Seq Num
     C                   Z-ADD     *ZERO         YN0064
      * Define null work field Original Appointment Date
     C                   Z-ADD     *ZERO         YN0065
      * Define null work field Original Appointment Time
     C                   Z-ADD     *ZERO         YN0066
      * Define null work field OHE PowerPro Load#_Outbnd
     C                   Z-ADD     *ZERO         YN0067
      * Define null work field OHE PowerPro Load#_Bckhl
     C                   Z-ADD     *ZERO         YN0068
      * Define null work field OHE Unused Numeric 9_0_3
     C                   Z-ADD     *ZERO         YN0069
      * Define null work field OHE Orig ABS Freight Rate
     C                   Z-ADD     *ZERO         YN0070
      * Define null work field OHE Genset Number
     C                   EVAL      YN0071 = ' '
      * Define null work field OHE Email BOL_Sent
     C                   EVAL      YN0072 = ' '
      * Define null work field OHE EDI Order Automated
     C                   EVAL      YN0073 = ' '
      * Define null work field OHE Unused Status 4
     C                   EVAL      YN0074 = ' '
      * Define null work field OHE Unused Text 1
     C                   EVAL      YN0075 = ' '
      * Define null work field OHE Unused Text 2
     C                   EVAL      YN0076 = ' '
      * Define null work field OHE Customer Vendor f_PO
     C                   EVAL      YN0077 = ' '
      * Define null work field OHE Unused Text 5
     C                   EVAL      YN0078 = ' '
      * Define null work field OHE Unused Date 1
     C                   Z-ADD     *ZERO         YN0079
      * Define null work field OHE Unused Date 2
     C                   Z-ADD     *ZERO         YN0080
      * Define null work field EDI Status 1
     C                   EVAL      YN0081 = ' '
      * Define null work field EDI Status 2
     C                   EVAL      YN0082 = ' '
      * Define null work field EDI Status 3
     C                   EVAL      YN0083 = ' '
      * Define null work field Record Status
     C                   EVAL      YN0084 = ' '
      * Define null work field TRADE PARTNER CODE
     C                   EVAL      YN0085 = ' '
      * Define null work field BA101-Related Company
     C                   EVAL      YN0086 = ' '
      * Define null work field BA102-Action Code
     C                   EVAL      YN0087 = ' '
      * Define null work field BA103-Transportation Type
     C                   EVAL      YN0088 = ' '
      * Define null work field BA104-Country Code ISO 2A
     C                   EVAL      YN0089 = ' '
      * Define null work field BA108-Ship From State Cde
     C                   EVAL      YN0090 = ' '
      * Define null work field BA109-IRS Identifier EIN
     C                   EVAL      YN0091 = ' '
      * Define null work field BA110-SCAC
     C                   EVAL      YN0092 = ' '
      * Define null work field BA112-Vessel Name
     C                   EVAL      YN0093 = ' '
      * Define null work field YNQ01-Type of Filing
     C                   EVAL      YN0094 = ' '
      * Define null work field DTM02-Sail Date
     C                   Z-ADD     *ZERO         YN0095
      * Define null work field PS03-Port of Export
     C                   EVAL      YN0096 = ' '
      * Define null work field P503-Port of Unlading
     C                   EVAL      YN0097 = ' '
      * Define null work field REF02-Ref ITN
     C                   EVAL      YN0098 = ' '
      * Define null work field M1201-Customs Entry Type
     C                   EVAL      YN0099 = ' '
      * Define null work field M1202-Customs Entry Nbr
     C                   EVAL      YN0100 = ' '
      * Define null work field M1203-Location ID
     C                   EVAL      YN0101 = ' '
      * Define null work field M1204-Foreign Party Ind
     C                   EVAL      YN0102 = ' '
      * Define null work field EDI ESIH-Unused 1
     C                   EVAL      YN0103 = ' '
      * Define null work field ESIH OHE Booking Nbr
     C                   EVAL      YN0104 = ' '
      * Define null work field EDI ESIH-Unused 3
     C                   EVAL      YN0105 = ' '
      * Define null work field Create Date D8#
     C                   Z-ADD     *ZERO         YN0106
      * Define null work field Create Time
     C                   Z-ADD     *ZERO         YN0107
      * Define local work field OHE Booking Number
     C                   EVAL      YL0001 = ' '
      * Define local work field Record Selected       USR
     C                   EVAL      YL0002 = ' '
      * *DTAARA = *COMPANY N
     C     *DTAARA       DEFINE    YYCOTXA       ##CMP
     C                   IN        *DTAARA
      *................................................................
     C                   EVAL      W0GRP = ' '
      * Load screen
     C                   EXSR      MALDSC
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 USR0752
00002 Y2U0005
