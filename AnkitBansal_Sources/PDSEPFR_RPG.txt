     H/TITLE Prt Load Schdlng Summ1 PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/08/21  Time  : 13:46:44
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDMHCPL6IF  E           K        DISK
      * RSQ : Load Schdlng Position     PCW/LoadId/Item/Prs
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDMHCPL8IF  E           K        DISK
      * RSQ : Load Schdlng Position     DB1 Date/Time
      *
     FPDLLREL1IF  E           K        DISK
      * RTV : PS Primal Group           Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier                   Active records
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FOMFJCPLFIF  E           K        DISK
      * RSQ : Load Header               Whse/SchdShpDt/Load
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPOA3REL2IF  E           K        DISK
      * RSQ : Load Slotting Sched Ctl   Co/Whse/Day  (D)
      *
     FPDSEPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Load Schdlng Summ1 PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     E                    YK01      100 11  A            ARR Load Schdln
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
     I@MHCPYF
      * Load Schdlng Position     DB1 Date/Time
      * Renamed input format fields
     I              MHHGCD                          WBHGCD
     I              MHCQC3                          WBCQC3
     I              MHLQAA                          WBLQAA
     I              MHCUC3                          WBCUC3
     I              MHLUAA                          WBLUAA
     I              MHSPSQ                          WBSPSQ
     I              MHBMSX                          WBBMSX
     I              MHL7DT                          WBL7DT
     I              MHC4NB                          WBC4NB
     I              MHRMNB                          WBRMNB
     I              MHAODT                          WBAODT
     I              MHJPCD                          WBJPCD
     I              MHKBQT                          WBKBQT
     I              MHKCQT                          WBKCQT
     I              MHKHQT                          WBKHQT
     I              MHKDQT                          WBKDQT
     I              MHKEQT                          WBKEQT
     I              MHKFQT                          WBKFQT
     I              MHH1QT                          WBH1QT
     I              MHKGQT                          WBKGQT
     I              MHKZDT                          WBKZDT
     I              MHAXTM                          WBAXTM
     I              MHBOSX                          WBBOSX
     I              MHBPSX                          WBBPSX
     I              MHBQSX                          WBBQSX
     I              MHUNUS                          WBUNUS
     I              MHUNU2                          WBUNU2
     I              MHT4NB                          WBT4NB
     I              MHRVNB                          WBRVNB
     I              MHBUST                          WBBUST
     I              MHSTDT                          WBSTDT
     I              MHN5NY                          WBN5NY
     I              MHRINY                          WBRINY
     I              MHTIDT                          WBTIDT
     I              MHTJDT                          WBTJDT
     I              MHTNDT                          WBTNDT
     I              MHTODT                          WBTODT
     I              MHUVST                          WBUVST
     I              MHUWST                          WBUWST
     I              MHUXST                          WBUXST
     I              MHVSST                          WBVSST
     I              MHAATM                          WBAATM
     I              MHAYNA                          WBAYNA
     I              MHA0NA                          WBA0NA
     I              MHAXDT                          WBAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@FJCPN3
      * Load Header               Whse/SchdShpDt/Load
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IYD01        DS
     I                                        1   6 YI0101
     I                                        7  110YI01
      *
     IYM01        DS                        100
     I                                        1   6 WDXRCD
     I                                        7  152WDSZQT
      *
     IYW01        DS
     I                                        1   6 XAXRCD
     I                                        7  152XASZQT
      *
      * Outward parameters
     IPARC        DS                              8
      * KEY : Order Header TRG          Load Exports
      * I : RST Load ID
     I                                    P   1   40PARMNB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             15
      * KEY: Load Schdlng Position     PCW/LoadId/Item/Prs
      * I : RST LSP Accounting Co
     I                                    P   1   20P1CQC3
      * I : RST LSP Prodution Warehouse
     I                                        3   5 P1LQAA
     IP2PARM      DS
      * FLD: *Arrays
      * I :  From Date             USR
     I                                    P   1   40P2L9DT
      * I :  To Date               USR
     I                                    P   5   80P2MADT
      * I :  From Load ID  USR
     I                                    P   9  120P2HQNX
      * I :  To Load ID  USR
     I                                    P  13  160P2HRNX
      * I :  Export Status
     I                                       17  17 P2U2ST
      * I :  U/M - Load Scheduling USR
     I                                       18  19 P2FGSX
      * I :  Load Grade
     I                                       20  20 P2BPSX
      * I :  Untied Orders Flag USR
     I                                       21  21 P2FHSX
      * I :  Primal Group Code
     I                                       22  27 P2XRCD
     IP3PARM      DS
      * N :  Export Status Dft
     I                                        1   1 P3CXST
     IP4PARM      DS
      * N :  USR Unit of Measure
     I                                        1   2 P4ODCD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Load Schdl
     C           P2L9DT    PARM           WP0001  70       From Date
     C           P2MADT    PARM           WP0002  70       To Date
     C           P2HQNX    PARM           WP0003  70       From Load ID  U
     C           P2HRNX    PARM           WP0004  70       To Load ID  USR
     C           P2U2ST    PARM           WP0005  1        Export Status
     C           P2FGSX    PARM           WP0006  2        U/M - Load Sche
     C           P2BPSX    PARM           WP0007  1        Load Grade
     C           P2FHSX    PARM           WP0008  1        Untied Orders F
     C           P2XRCD    PARM           WP0009  6        Primal Group Co
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Load Schdlng Summ1 PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$GENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Load Schdlng Summ1 PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN MHCQC3    WQKA01           LSP Accounting
     C           *LIKE     DEFN MHLQAA    WQKA02           LSP Prodution W
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           LSP Accounting
     C                     KFLD           WQKA02           LSP Prodution W
      * Setup key
     C                     Z-ADDP1CQC3    WQKA01           LSP Accounting
     C                     MOVELP1LQAA    WQKA02           LSP Prodution W
      * Establish starting position
     C           KRSA      SETLL@MHCPX9                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        LSP Accounting
     C                     MOVEL'Y'       W0AL01  1        LSP Prodution W
     C                     MOVEL'Y'       W0AL02  1        Load ID
     C                     MOVEL'Y'       W0AL03  1        Item Code
     C                     MOVEL'Y'       W0AL04  1        Process Sequenc
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $BAIC3           Company Number
     C                     MOVEL*BLANK    $BADTX           Name
     C                     Z-ADD*ZERO     $BL9DT           From Date
     C                     Z-ADD*ZERO     $BMADT           To Date
     C                     MOVEL*BLANK    $BAJCD           Warehouse Code
     C                     MOVEL*BLANK    $BO6NA           Warehouse Desc
     C                     Z-ADD*ZERO     $BHQNX           From Load ID  U
     C                     Z-ADD*ZERO     $BHRNX           To Load ID  USR
     C                     MOVEL*BLANK    $BXRCD           Primal Group Co
     C                     MOVEL*BLANK    $BVMNA           Primal Group De
     C                     MOVEL*BLANK    $BU2ST           Export Status
     C                     MOVEL*BLANK    $BFGSX           U/M - Load Sche
     C                     Z-ADD*ZERO     $BRADT           Job Date Usr
     C                     Z-ADD*ZERO     $BDHTM           Job Time User
     C                     MOVEL*BLANK    $BBPSX           Load Grade
     C                     MOVEL*BLANK    $BFHSX           Untied Orders F
      * Load related totals format
     C                     MOVEL*BLANK    $FULTX           Day of the Week
     C                     Z-ADD*ZERO     $FBINX           Combo Load Limi
     C                     Z-ADD*ZERO     $FNWNX           Slot Limit for
     C                     Z-ADD*ZERO     $FIUNX           Export Load Lim
     C                     Z-ADD*ZERO     $FNVNX           Slot Limit for
     C                     Z-ADD*ZERO     $FBHNX           Box Load Limit
     C                     Z-ADD*ZERO     $FNXNX           Slot Limit for
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDMHCQC3    $CCQC3           LSP Accounting
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDMHCUC3    $DCUC3           LSP Order Compa
     C                     Z-ADDMHRMNB    $DRMNB           Load ID
     C                     MOVELMHBPSX    $DBPSX           Load Grade
     C                     MOVEL*BLANK    $DDXTX           Trailer Id
     C                     Z-ADD*ZERO     $DKKDT           On Yard Date
     C                     Z-ADD*ZERO     $DT4TM           USR Time 4.0
     C                     Z-ADD*ZERO     $DAVTM           On Yard Time
     C                     MOVEL*BLANK    $DBZNA           Carrier Code
     C                     MOVEL*BLANK    $DADTX           Name
     C                     MOVEL*BLANK    $DWMTX           @Text 15
     C                     MOVEL*BLANK    $DBRTX           Ship To Name
     C                     MOVEL*BLANK    $DDCU1           Text USR 15
     C                     MOVEL*BLANK    $DCVCD           USR U/M 1
     C                     Z-ADD*ZERO     $DSSDT           USR Sched Ship
     C                     Z-ADD*ZERO     $DYANB           Deadline Depart
     C                     Z-ADD*ZERO     $DOTNB           USR Deadline De
     C                     Z-ADDMHT4NB    $DT4NB           Schedule Sequen
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDMHRVNB    $ERVNB           Stop/Drop
     C                     Z-ADDMHSTDT    $ESTDT           LSP Production
     C                     Z-ADDMHN5NY    $EN5NY           Process Sequenc
     C                     Z-ADDMHRINY    $ERINY           Item Age Days
     C                     Z-ADDMHTIDT    $ETIDT           Production Ovr
     C                     Z-ADDMHTJDT    $ETJDT           Production Ovr
     C                     Z-ADDMHHGCD    $EHGCD           Item Code
     C                     Z-ADDMHCQC3    $ECQC3           LSP Accounting
     C                     MOVELMHLQAA    $ELQAA           LSP Prodution W
     C                     Z-ADDMHCUC3    $ECUC3           LSP Order Compa
     C                     MOVELMHLUAA    $ELUAA           LSP Order Wareh
     C                     MOVELMHBOSX    $EBOSX           Order Grade
     C                     Z-ADDMHH1QT    $EH1QT           Scheduled Quant
     C                     Z-ADDMHKGQT    $EKGQT           Scheduling Posi
     C                     Z-ADDMHTNDT    $ETNDT           Production AgeD
     C                     Z-ADDMHTODT    $ETODT           Production AgeD
     C                     MOVELMHBUST    $EBUST           LSP Order Aged
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN MHCQC3    WZA001           LSP Accounting
     C                     Z-ADDMHCQC3    WZA001
     C           *LIKE     DEFN MHLQAA    WZA002           LSP Prodution W
     C                     MOVELMHLQAA    WZA002
     C           *LIKE     DEFN MHRMNB    WZA003           Load ID
     C                     Z-ADDMHRMNB    WZA003
     C           *LIKE     DEFN MHHGCD    WZA004           Item Code
     C                     Z-ADDMHHGCD    WZA004
     C           *LIKE     DEFN MHN5NY    WZA005           Process Sequenc
     C                     Z-ADDMHN5NY    WZA005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@MHCPX9                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.Multiple Warehouses is Multiple Warehouses f/Ld
     C           MHBQSX    IFEQ 'M'                        *IF
      * CASE: LCL.Warehouse Type is Frozen
     C           YL0001    IFEQ 'FZ'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.LSP Prodution Warehouse NE DB1.LSP Prodution Warehouse
     C           P1LQAA    IFNE MHLQAA                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Order tied to a load.
     C                     EXSR UASUBR                     Order tied to a
      * Scheduled Ship Date Selection.
     C                     EXSR UDSUBR                     Scheduled Ship
      * Load ID Selection.
     C                     EXSR UESUBR                     Load ID Selecti
      * Export Status Selection.
     C                     EXSR UFSUBR                     Export Status S
      * Unit of Measure Selection.
     C                     EXSR UGSUBR                     Unit of Measure
      * Load Grade Selection.
     C                     EXSR UHSUBR                     Load Grade Sele
      * 11/13/19 DN S15765-Select By Primal Group Code.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.Primal Group Code is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2XRCD    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * DEL Load Schdlng Summ  DL - *Arrays  * 
     C                     EXSR SODLRC
      * Bld ARR Load Schdlng SmRT - Order Header TRG  * Build Array
     C                     EXSR SPRVGN
     C                     MOVEL*BLANK    YL0008           Primal Group Co
      * RTV Load Schdlng Summ  RT - *Arrays  * Get PG 4/Most Qty Ord
     C                     EXSR SVRVGN
      * If Primal Group Mismatch then Do Not Select Load.
      * CASE: PAR.Primal Group Code EQ LCL.Primal Group Code USR
     C           P2XRCD    IFEQ YL0009                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        LSP Accounting
     C                     MOVEL*BLANK    W0AL01  1        LSP Prodution W
     C                     MOVEL*BLANK    W0AL02  1        Load ID
     C                     MOVEL*BLANK    W0AL03  1        Item Code
     C                     MOVEL*BLANK    W0AL04  1        Process Sequenc
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        LSP Accounting
     C                     MOVEL'Y'       W0AL01  1        LSP Prodution W
     C                     MOVEL'Y'       W0AL02  1        Load ID
     C                     MOVEL'Y'       W0AL03  1        Item Code
     C                     MOVEL'Y'       W0AL04  1        Process Sequenc
     C                     ELSE
      * Next record - Detect level breaks
     C           MHCQC3    IFNE WZA001                     LSP Accounting
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           MHLQAA    IFNE WZA002                     LSP Prodution W
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           MHRMNB    IFNE WZA003                     Load ID
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           MHHGCD    IFNE WZA004                     Item Code
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           MHN5NY    IFNE WZA005                     Process Sequenc
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * 01/18/16 JJH E4687 - Load Scheduling Positioning
      * 09/16/19 DN R15161-Undo Load Scheduling Positioning Logic by JH.
      * RTV Limit Loads f/Slot RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1LQAA    WL0153    P      Ship From Wareh
     C                     Z-ADDP2L9DT    WL0154           Scheduled Ship
     C                     Z-ADD*ZERO     WL0155           Load ID
     C                     Z-ADD$FIUNX    WL0156           Export Load Lim
     C                     Z-ADD$FBINX    WL0157           Combo Load Limi
     C                     Z-ADD$FBHNX    WL0158           Box Load Limit
     C                     MOVELWUYIST    WL0159    P      Record Found -O
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0156    $FIUNX           Export Load Lim
     C                     Z-ADDWL0157    $FBINX           Combo Load Limi
     C                     Z-ADDWL0158    $FBHNX           Box Load Limit
     C                     MOVELWL0159    WUYIST    P      Record Found -O
      * CASE: LCL.Warehouse Type is Fresh
     C           YL0001    IFEQ 'FR'                       *IF
      * ** Rtv week day name, rst on day of week for limits   E000233
      * RTV Day and Week No.   RT - Calendar  * 
     C                     EXSR SZRVGN
      * CUR.Day of the Week USR = Condition name of LCL.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM YL0019    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $FULTX    PARM           W0CNNM 25        Day of the Week
      *
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
     C                     EXSR TARVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD999       $FNWNX           Slot Limit for
     C                     Z-ADD999       $FNXNX           Slot Limit for
     C                     Z-ADD999       $FNVNX           Slot Limit for
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 9
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$FFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Load Schdlng Summ1 PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Load Schdlng Summ1 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP2L9DT    $BL9DT           From Date
     C                     Z-ADDP2MADT    $BMADT           To Date
     C                     Z-ADDP2HQNX    $BHQNX           From Load ID  U
     C                     Z-ADDP2HRNX    $BHRNX           To Load ID  USR
     C                     MOVELP2XRCD    $BXRCD           Primal Group Co
     C                     MOVELP2U2ST    $BU2ST           Export Status
     C                     MOVELP2FGSX    $BFGSX           U/M - Load Sche
     C                     MOVELP2BPSX    $BBPSX           Load Grade
     C                     MOVELP2FHSX    $BFHSX           Untied Orders F
     C                     Z-ADDP1CQC3    $BAIC3           Company Number
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SDRVGN
     C                     MOVELP1LQAA    $BAJCD           Warehouse Code
     C                     MOVEL*BLANK    $BO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SERVGN
      * RTV Newest Rcd         RT - Load Schdlng Position  * 
     C                     EXSR SFRVGN
     C                     MOVEL*BLANK    $BVMNA           Primal Group De
      * Primal Group Desc DRV
      * Rtv Primal Grp Desc   RT - PS Primal Group  * 
     C                     EXSR SGRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert From Date             USR to display format
      * Convert date
     C           1000000   ADD  $BL9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBL9DT
      * Convert To Date               USR to display format
      * Convert date
     C           1000000   ADD  $BMADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBMADT
      * Convert Job Date Usr to display format
      * Convert date
     C           1000000   ADD  $BRADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBRADT
     C                     MOVEL'0'       *IN79
     C           WUTIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$B1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print LSP Accounting Co of Prt Load Schdlng Summ1 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print LSP Prodution Warehouse of Prt Load Schdlng Summ1 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Load ID of Prt Load Schdlng Summ1 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Load ID format
      * 04/19/16 JJH E4687 - Load Scheduling Positioning
      * 09/16/19 DN R15161-Undo Load Scheduling Positioning Logic by JH.
      * RTV Load All Fields    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DRMNB    WL0001           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YN0002           Company Number
     C                     Z-ADDWL0003    YN0003           Scheduled Ship
     C                     MOVELWL0004    YN0004    P      LTL Flag
     C                     MOVELWL0005    YN0005    P      Load Status
     C                     Z-ADDWL0006    YN0006           Reefer Temperat
     C                     MOVELWL0007    YN0007    P      Seal 1
     C                     MOVELWL0008    YN0008    P      Seal 2
     C                     MOVELWL0009    YN0009    P      Seal 3
     C                     MOVELWL0010    YN0010    P      Seal 4
     C                     MOVELWL0011    YN0011    P      Seal 2 Unused
     C                     Z-ADDWL0012    YN0012           Total Load Orde
     C                     Z-ADDWL0013    YN0013           Flat Amount
     C                     MOVELWL0014    YN0014    P      Allocate Pounds
     C                     Z-ADDWL0015    YN0015           Total Stops
     C                     MOVELWL0016    $DDXTX    P      Trailer Id
     C                     MOVELWL0017    YN0016    P      Transloader Car
     C                     Z-ADDWL0018    YN0017           BOL Time
     C                     MOVELWL0019    $DBZNA    P      Carrier Code
     C                     MOVELWL0020    YN0018    P      Truck Size
     C                     Z-ADDWL0021    YN0019           Ld Hdr/Ld Dtl U
     C                     Z-ADDWL0022    YN0020           Rated Freight
     C                     MOVELWL0023    YN0021    P      Ship Status
     C                     MOVELWL0024    YN0022    P      Load Type
     C                     Z-ADDWL0025    YN0023           Number Pallets
     C                     Z-ADDWL0026    YN0024           Number Pallets
     C                     Z-ADDWL0027    YN0025           Load Carrier Pa
     C                     Z-ADDWL0028    YN0026           Estimated Arriv
     C                     Z-ADDWL0029    YN0027           Actual Arrival
     C                     Z-ADDWL0030    YN0028           Actual Arrival
     C                     Z-ADDWL0031    YN0029           Trailer IN Weig
     C                     Z-ADDWL0032    YN0030           Trailer OUT Wei
     C                     Z-ADDWL0033    YN0031           Actual Departur
     C                     Z-ADDWL0034    YN0032           Departure Time
     C                     Z-ADDWL0035    YN0033           Schedule Sequen
     C                     Z-ADDWL0036    YN0034           Product Tempera
     C                     Z-ADDWL0037    YN0035           Number Spacers
     C                     MOVELWL0038    YN0036    P      Car/Veh. Initia
     C                     Z-ADDWL0039    YN0037           Total Load Mile
     C                     MOVELWL0040    YN0038    P      Recorder ID
     C                     MOVELWL0041    YN0039    P      Shipping Method
     C                     MOVELWL0042    YN0040    P      Ship From Wareh
     C                     MOVELWL0043    YN0041    P      Ship To State C
     C                     Z-ADDWL0044    YN0042           Gross Weight
     C                     MOVELWL0045    YN0043    P      Carrier Broker
     C                     MOVELWL0046    YN0044    P      Export Status
     C                     Z-ADDWL0047    YN0045           Actual Ship Dat
     C                     MOVELWL0048    YN0046    P      On Time - (Y/N)
     C                     Z-ADDWL0049    YN0047           Truck Ready Dat
     C                     Z-ADDWL0050    YN0048           Truck Ready Tim
     C                     Z-ADDWL0051    YN0049           Spotted Date
     C                     Z-ADDWL0052    YN0050           Spotted Time
     C                     Z-ADDWL0053    YN0051           Load Finished D
     C                     Z-ADDWL0054    YN0052           Load Finished T
     C                     Z-ADDWL0055    YN0053           BOL Complete Da
     C                     Z-ADDWL0056    YN0054           BOL Complete Ti
     C                     Z-ADDWL0057    YN0055           BOL Received Da
     C                     Z-ADDWL0058    YN0056           BOL Received Ti
     C                     Z-ADDWL0059    YN0057           Truck Departure
     C                     Z-ADDWL0060    YN0058           Truck Departure
     C                     Z-ADDWL0061    YN0059           Adjusted Depart
     C                     Z-ADDWL0062    YN0060           Adjusted Depart
     C                     MOVELWL0063    YN0061    P      Shipping Line
     C                     MOVELWL0064    YN0062    P      Port Delv Termi
     C                     MOVELWL0065    YN0063    P      Vessel Name
     C                     Z-ADDWL0066    YN0064           Voyage
     C                     Z-ADDWL0067    YN0065           Sail Date
     C                     MOVELWL0068    YN0066    P      Booking Number
     C                     MOVELWL0069    YN0067    P      Discharge Port
     C                     Z-ADDWL0070    YN0068           Arrival Date
     C                     MOVELWL0071    YN0069    P      Container Numbe
     C                     Z-ADDWL0072    YN0070           Date In
     C                     Z-ADDWL0073    YN0071           Time In
     C                     Z-ADDWL0074    YN0072           Date Out
     C                     Z-ADDWL0075    YN0073           Time Out
     C                     Z-ADDWL0076    YN0074           Load Total Frei
     C                     Z-ADDWL0077    YN0075           Scheduled Deliv
     C                     Z-ADDWL0078    YN0076           Scheduled Deliv
     C                     MOVELWL0079    YN0077    P      LH Unused Sts
     C                     MOVELWL0080    YN0078    P      LH Carrier Paym
     C                     Z-ADDWL0081    YN0079           Bring Back Mile
     C                     Z-ADDWL0082    YN0080           Requested Deliv
     C                     MOVELWL0083    YN0081    P      Load Acceptance
     C                     MOVELWL0084    YN0082    P      Warehouse Code
     C                     Z-ADDWL0085    $DKKDT           On Yard Date
     C                     Z-ADDWL0086    $DAVTM           On Yard Time
     C                     Z-ADDWL0087    YN0083           Deadline Depart
     C                     Z-ADDWL0088    YN0084           Deadline Depart
     C                     MOVELWL0089    YN0085    P      Load Held Over
     C                     MOVELWL0090    YN0086    P      Load Held Over
     C                     MOVELWL0091    YN0087    P      Load Held Over
     C                     MOVELWL0092    YN0088    P      Ocean BOL Numbe
     C                     MOVELWL0093    YN0089    P      Express Mail Nu
     C                     Z-ADDWL0094    YN0090           Express Mail Da
     C                     MOVELWL0095    YN0091    P      Load Shag Flag
     C                     MOVELWL0096    YN0092    P      Load Wash Flag
     C                     Z-ADDWL0097    YN0093           Product Complet
     C                     Z-ADDWL0098    YN0094           Product Complet
     C                     Z-ADDWL0099    YN0095           Pallets Loaded
     C                     Z-ADDWL0100    YN0096           Avg Pallet Tare
     C                     Z-ADDWL0101    YN0097           Tot Pallet Tare
     C                     MOVELWL0102    YN0098    P      Load Confirmed
     C                     MOVELWL0103    YN0099    P      Load Confirmed
     C                     Z-ADDWL0104    YN0100           Load Confirmati
     C                     Z-ADDWL0105    YN0101           Load Door 1
     C                     Z-ADDWL0106    YN0102           Override Total
     C                     Z-ADDWL0107    YN0103           Load Door 2
     C                     MOVELWL0108    YN0104    P      Partial Load
     C                     MOVELWL0109    YN0105    P      Load Confirmati
     C                     MOVELWL0110    YN0106    P      Export Load USD
     C                     MOVELWL0111    YN0107    P      Late Delivery E
     C                     Z-ADDWL0112    YN0108           Load Actual Fre
     C                     MOVELWL0113    YN0109    P      Hide on WW Load
     C                     MOVELWL0114    YN0110    P      Late Billing Em
     C                     MOVELWL0115    YN0111    P      Shipping Temp C
     C                     MOVELWL0116    YN0112    P      LH Held Over Rs
     C                     MOVELWL0117    YN0113    P      Multi Company L
     C                     MOVELWL0118    YN0114    P      Fax Sent to SSI
     C                     MOVELWL0119    YN0115    P      Schedule Pos Lo
     C                     MOVELWL0120    YN0116    P      LH Power Only L
     C                     MOVELWL0121    YN0117    P      MG Created Load
     C                     MOVELWL0122    YN0118    P      LH Unused Sts 5
     C                     MOVELWL0123    YN0119    P      Load U/M
     C                     MOVELWL0124    YN0120    P      TPM Shipment St
     C                     MOVELWL0125    YN0121    P      LH Unused Sts 8
     C                     MOVELWL0126    YN0122    P      LH On-Time Reas
     C                     MOVELWL0127    YN0123    P      LH Held Over Re
     C                     Z-ADDWL0128    YN0124           LH Carrier Paid
     C                     Z-ADDWL0129    YN0125           LH Carrier Paid
     C                     Z-ADDWL0130    YN0126           LH Last Combo P
     C                     Z-ADDWL0131    YN0127           LH Last Combo P
     C                     Z-ADDWL0132    YN0128           LPT Load Plan S
     C                     Z-ADDWL0133    YN0129           LPT Load Plan S
     C                     Z-ADDWL0134    YN0130           TPM Planned Shi
     C                     Z-ADDWL0135    YN0131           LH Unused Time
     C                     Z-ADDWL0136    YN0132           LH Unused Date
     C                     Z-ADDWL0137    YN0133           LH Unused Time
     C                     Z-ADDWL0138    YN0134           LH Unused Date
     C                     Z-ADDWL0139    YN0135           LH Unused Time
     C                     MOVELWL0140    YN0136    P      EDI Status 1
     C                     MOVELWL0141    YN0137    P      EDI Status 2
     C                     MOVELWL0142    YN0138    P      EDI Status 3
      * 04/04/16 JJH E4687 - Load Scheduling Positioning
      * 09/16/19 DN R15161-Undo Load Scheduling Positioning Logic by JH.
      * RTV Active Carr Name   RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$DBZNA    WL0143    P      Carrier Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0144    $DADTX    P      Name
     C                     MOVEL$DADTX    $DWMTX           @Text 15
      * RTV Ship To Name       RT - Order Header TRG  * 
     C                     EXSR SJRVGN
     C                     MOVEL$DBRTX    $DDCU1           Text USR 15
     C           $DAVTM    DIV  100       $DT4TM           USR Time 4.0
     C                     MOVE MHAODT    $DSSDT           USR Sched Ship
     C                     MOVE MHKZDT    $DYANB           Deadline Depart
     C           MHAXTM    DIV  100       $DOTNB           USR Deadline De
      * print the uom on report
     C                     MOVELWUODCD    $DCVCD           USR U/M 1
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert On Yard Date to display format
      * Convert date
     C           1000000   ADD  $DKKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDKKDT
     C                     MOVEL'0'       *IN79
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Item Code of Prt Load Schdlng Summ1 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Process Sequence of Prt Load Schdlng Summ1 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Detail line. of Prt Load Schdlng Summ1 PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $ETNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VETNDT
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  $ETODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VETODT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Load Schdlng Summ1 PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  12        W0FSUM
     C                     END                             FI
      *
      * * LSP Accounting Co of Prt Load Schdlng Summ1 PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * LSP Prodution Warehouse of Prt Load Schdlng Summ1 PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of Prt Load Schdlng Summ1 PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Item Code of Prt Load Schdlng Summ1 PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Process Sequence of Prt Load Schdlng Summ1 PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Load Schdlng Summ1 PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1LQAA    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Warehouse Type
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    YL0001           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BADTX           Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVEL$BAJCD    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $BO6NA           Warehouse Descr
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWAF8NA    $BO6NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Newest Rcd         RT - Load Schdlng Position  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *HIVAL    SETLL@MHCPYF                    *
     C                     READ @MHCPYF                  90*
      * Data record not found
     C   90                MOVEL'USR2706' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAATM    $BDHTM           Job Time
     C                     Z-ADDWBAXDT    $BRADT           Job Date
     C                     GOTO SFEXIT                     *QUIT
     C                     READ @MHCPYF                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Primal Grp Desc   RT - PS Primal Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           LLXRCD           Primal Group Co
      * Setup key
     C                     MOVELP2XRCD    LLXRCD           Primal Group Co
      * Establish starting position
     C           KRSSG     CHAIN@LLREOY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2505' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $BVMNA           Primal Group De
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLLOJNA    $BVMNA           Primal Group De
     C                     GOTO SGEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Load All Fields    RT - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Status - Y or N
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0001    FJRMNB           Load ID
      * Establish starting position
     C           KRSSH     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAIC3    WL0002           Company Number
     C                     Z-ADDFJAODT    WL0003           Scheduled Ship
     C                     MOVELFJPJST    WL0004           LTL Flag
     C                     MOVELFJPKST    WL0005           Load Status
     C                     Z-ADDFJRNNB    WL0006           Reefer Temperat
     C                     MOVELFJDMTX    WL0007           Seal 1
     C                     MOVELFJDNTX    WL0008           Seal 2
     C                     MOVELFJDOTX    WL0009           Seal 3
     C                     MOVELFJWTTX    WL0010           Seal 4
     C                     MOVELFJWUTX    WL0011           Seal 2 Unused
     C                     Z-ADDFJRPNB    WL0012           Total Load Orde
     C                     Z-ADDFJFLAM    WL0013           Flat Amount
     C                     MOVELFJXQST    WL0014           Allocate Pounds
     C                     Z-ADDFJRRNB    WL0015           Total Stops
     C                     MOVELFJDXTX    WL0016           Trailer Id
     C                     MOVELFJDYTX    WL0017           Transloader Car
     C                     Z-ADDFJSBNB    WL0018           BOL Time
     C                     MOVELFJBZNA    WL0019           Carrier Code
     C                     MOVELFJRONB    WL0020           Truck Size
     C                     Z-ADDFJSQNB    WL0021           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    WL0022           Rated Freight
     C                     MOVELFJVCST    WL0023           Ship Status
     C                     MOVELFJVDST    WL0024           Load Type
     C                     Z-ADDFJSDNB    WL0025           Number Pallets
     C                     Z-ADDFJPAOU    WL0026           Number Pallets
     C                     Z-ADDFJDGWG    WL0027           Load Carrier Pa
     C                     Z-ADDFJSXNB    WL0028           Estimated Arriv
     C                     Z-ADDFJHADT    WL0029           Actual Arrival
     C                     Z-ADDFJAART    WL0030           Actual Arrival
     C                     Z-ADDFJDHWG    WL0031           Trailer IN Weig
     C                     Z-ADDFJDIWG    WL0032           Trailer OUT Wei
     C                     Z-ADDFJAQDT    WL0033           Actual Departur
     C                     Z-ADDFJS6NB    WL0034           Departure Time
     C                     Z-ADDFJT4NB    WL0035           Schedule Sequen
     C                     Z-ADDFJPRTM    WL0036           Product Tempera
     C                     Z-ADDFJNPSV    WL0037           Number Spacers
     C                     MOVELFJJ8TX    WL0038           Car/Veh. Initia
     C                     Z-ADDFJTLMI    WL0039           Total Load Mile
     C                     MOVELFJJ9TX    WL0040           Recorder ID
     C                     MOVELFJQ2CD    WL0041           Shipping Method
     C                     MOVELFJVPCD    WL0042           Ship From Wareh
     C                     MOVELFJDBCD    WL0043           Ship To State C
     C                     Z-ADDFJGRWE    WL0044           Gross Weight
     C                     MOVELFJXCCD    WL0045           Carrier Broker
     C                     MOVELFJU2ST    WL0046           Export Status
     C                     Z-ADDFJF9DT    WL0047           Actual Ship Dat
     C                     MOVELFJONTM    WL0048           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    WL0049           Truck Ready Dat
     C                     Z-ADDFJTRTM    WL0050           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WL0051           Spotted Date
     C                     Z-ADDFJSPTM    WL0052           Spotted Time
     C                     Z-ADDFJJ6DT    WL0053           Load Finished D
     C                     Z-ADDFJLFTM    WL0054           Load Finished T
     C                     Z-ADDFJJ7DT    WL0055           BOL Complete Da
     C                     Z-ADDFJBOTM    WL0056           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WL0057           BOL Received Da
     C                     Z-ADDFJBLTM    WL0058           BOL Received Ti
     C                     Z-ADDFJKIDT    WL0059           Truck Departure
     C                     Z-ADDFJASTM    WL0060           Truck Departure
     C                     Z-ADDFJKADT    WL0061           Adjusted Depart
     C                     Z-ADDFJAJCM    WL0062           Adjusted Depart
     C                     MOVELFJXACD    WL0063           Shipping Line
     C                     MOVELFJOANA    WL0064           Port Delv Termi
     C                     MOVELFJK4TX    WL0065           Vessel Name
     C                     Z-ADDFJVOAG    WL0066           Voyage
     C                     Z-ADDFJKBDT    WL0067           Sail Date
     C                     MOVELFJNBBO    WL0068           Booking Number
     C                     MOVELFJW4CD    WL0069           Discharge Port
     C                     Z-ADDFJEFDT    WL0070           Arrival Date
     C                     MOVELFJCNTN    WL0071           Container Numbe
     C                     Z-ADDFJKCDT    WL0072           Date In
     C                     Z-ADDFJTMIN    WL0073           Time In
     C                     Z-ADDFJKDDT    WL0074           Date Out
     C                     Z-ADDFJVMNB    WL0075           Time Out
     C                     Z-ADDFJOCFR    WL0076           Load Total Frei
     C                     Z-ADDFJKJDT    WL0077           Scheduled Deliv
     C                     Z-ADDFJATTM    WL0078           Scheduled Deliv
     C                     MOVELFJOTRS    WL0079           LH Unused Sts
     C                     MOVELFJRNST    WL0080           LH Carrier Paym
     C                     Z-ADDFJBRBK    WL0081           Bring Back Mile
     C                     Z-ADDFJEIDT    WL0082           Requested Deliv
     C                     MOVELFJRMST    WL0083           Load Acceptance
     C                     MOVELFJAJCD    WL0084           Warehouse Code
     C                     Z-ADDFJKKDT    WL0085           On Yard Date
     C                     Z-ADDFJAVTM    WL0086           On Yard Time
     C                     Z-ADDFJKZDT    WL0087           Deadline Depart
     C                     Z-ADDFJAXTM    WL0088           Deadline Depart
     C                     MOVELFJLHOS    WL0089           Load Held Over
     C                     MOVELFJLHOR    WL0090           Load Held Over
     C                     MOVELFJWNTX    WL0091           Load Held Over
     C                     MOVELFJOITX    WL0092           Ocean BOL Numbe
     C                     MOVELFJOJTX    WL0093           Express Mail Nu
     C                     Z-ADDFJLLDT    WL0094           Express Mail Da
     C                     MOVELFJLSHG    WL0095           Load Shag Flag
     C                     MOVELFJYPST    WL0096           Load Wash Flag
     C                     Z-ADDFJK0DT    WL0097           Product Complet
     C                     Z-ADDFJAYTM    WL0098           Product Complet
     C                     Z-ADDFJKNNX    WL0099           Pallets Loaded
     C                     Z-ADDFJICWG    WL0100           Avg Pallet Tare
     C                     Z-ADDFJIDWG    WL0101           Tot Pallet Tare
     C                     MOVELFJH9SX    WL0102           Load Confirmed
     C                     MOVELFJWOTX    WL0103           Load Confirmed
     C                     Z-ADDFJK1DT    WL0104           Load Confirmati
     C                     Z-ADDFJAZTM    WL0105           Load Door 1
     C                     Z-ADDFJK2DT    WL0106           Override Total
     C                     Z-ADDFJA0TM    WL0107           Load Door 2
     C                     MOVELFJROST    WL0108           Partial Load
     C                     MOVELFJRPST    WL0109           Load Confirmati
     C                     MOVELFJRQST    WL0110           Export Load USD
     C                     MOVELFJRRST    WL0111           Late Delivery E
     C                     Z-ADDFJZBVA    WL0112           Load Actual Fre
     C                     MOVELFJWPTX    WL0113           Hide on WW Load
     C                     MOVELFJWQTX    WL0114           Late Billing Em
     C                     MOVELFJWRTX    WL0115           Shipping Temp C
     C                     MOVELFJWSTX    WL0116           LH Held Over Rs
     C                     MOVELFJRVSX    WL0117           Multi Company L
     C                     MOVELFJRUSX    WL0118           Fax Sent to SSI
     C                     MOVELFJRWSX    WL0119           Schedule Pos Lo
     C                     MOVELFJRXSX    WL0120           LH Power Only L
     C                     MOVELFJRYSX    WL0121           MG Created Load
     C                     MOVELFJRZSX    WL0122           LH Unused Sts 5
     C                     MOVELFJR0SX    WL0123           Load U/M
     C                     MOVELFJR1SX    WL0124           TPM Shipment St
     C                     MOVELFJR2SX    WL0125           LH Unused Sts 8
     C                     MOVELFJR3SX    WL0126           LH On-Time Reas
     C                     MOVELFJR4SX    WL0127           LH Held Over Re
     C                     Z-ADDFJPYDT    WL0128           LH Carrier Paid
     C                     Z-ADDFJCKTM    WL0129           LH Carrier Paid
     C                     Z-ADDFJPZDT    WL0130           LH Last Combo P
     C                     Z-ADDFJCLTM    WL0131           LH Last Combo P
     C                     Z-ADDFJP0DT    WL0132           LPT Load Plan S
     C                     Z-ADDFJCMTM    WL0133           LPT Load Plan S
     C                     Z-ADDFJP1DT    WL0134           TPM Planned Shi
     C                     Z-ADDFJCNTM    WL0135           LH Unused Time
     C                     Z-ADDFJP2DT    WL0136           LH Unused Date
     C                     Z-ADDFJCOTM    WL0137           LH Unused Time
     C                     Z-ADDFJP3DT    WL0138           LH Unused Date
     C                     Z-ADDFJCQTM    WL0139           LH Unused Time
     C                     MOVELFJUVST    WL0140           EDI Status 1
     C                     MOVELFJUWST    WL0141           EDI Status 2
     C                     MOVELFJUXST    WL0142           EDI Status 3
     C                     GOTO SHEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Active Carr Name   RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0143    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSI     CHAIN@FFREUG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0144           Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WL0144           Name
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Ship To Name       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDP1CQC3    BEAIC3           Company Number
     C                     Z-ADDMHC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DBRTX           Ship To Name
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBRTX    $DBRTX           Ship To Name
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Export Status RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDMHRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSK     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P3CXST           Export Status
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJU2ST    P3CXST           Export Status
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code        RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    P4ODCD           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0003           Boxes Total Qua
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSL01           Load ID
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Load ID
     C                     KFLD           WCC4NB           Order Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Load ID
      * Setup key
     C                     Z-ADDMHRMNB    WQSL01           Load ID
     C                     Z-ADDMHC4NB    WCC4NB           Order Number
      * Establish starting position
     C           KPSSL     SETLL@BFCPR0                    *
     C           KRSSL     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SLEXIT                     *QUIT
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0145           Company Number
     C                     Z-ADDWCC4NB    WL0146           Order Number
     C                     Z-ADD1         WL0147           Order Sequence
     C                     MOVELP4ODCD    WL0148    P      USR Unit of Mea
     C                     Z-ADDYL0003    WL0149           Boxes Total Qua
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0148    P4ODCD    P      USR Unit of Mea
     C                     Z-ADDWL0149    YL0003           Boxes Total Qua
      * If doing for one Order, because it isnt tied to a load yet
      * CASE: DB1.Load ID is Blank
     C           WCRMNB    IFEQ 0                          *IF
      * CASE: PAR.USR Unit of Measure is Mixed
     C           P4ODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0150           Company Number
     C                     MOVEL'BOXLOAD' WL0151    P      Company Value C
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    YL0005           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0003    IFLT YL0005                     *IF
     C                     MOVEL'CB'      P4ODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      P4ODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
      * orig code
     C           KRSSL     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Unit of Measure is Mixed
     C           P4ODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0150           Company Number
     C                     MOVEL'BOXLOAD' WL0151    P      Company Value C
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    YL0005           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0003    IFLT YL0005                     *IF
     C                     MOVEL'CB'      P4ODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      P4ODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSM01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSM02           Order Number
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADDWL0145    WQSM01           Company Number
     C                     Z-ADDWL0146    WQSM02           Order Number
     C                     Z-ADDWL0147    OMDPNB           Order Sequence
      * Establish starting position
     C           KPSSM     SETLL@BGWKL1                    *
     C           KRSSM     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0148           USR Unit of Mea
     C                     Z-ADD*ZERO     WL0149           Boxes Total Qua
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SMEXIT                     *QUIT
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/08/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/08/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELOMAGCD    YL0004           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0004    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0004           U/M - Ordered
     C                     END                             *FI
      * Accumulate the Box Quantity for slotting consideration  6/12/01
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0004    IFEQ 'BX'                       *IF
     C                     ADD  OMAVQT    WL0149           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           WL0148    IFEQ *BLANK                     *IF
     C                     MOVELYL0004    WL0148           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0004    IFEQ WL0148                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WL0148           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0150    KMAIC3           Company Number
     C                     MOVELWL0151    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSN     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0152           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SODLRC    BEGSR
      *================================================================
      * DEL Load Schdlng Summ  DL - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Bld ARR Load Schdlng SmRT - Order Header TRG  * Build Array
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSP02           Load ID
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP02           Load ID
      * Setup key
     C                     Z-ADDMHRMNB    WQSP02           Load ID
      * Establish starting position
     C           KRSSP     SETLL@BFCPRQ                    *
     C           KRSSP     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Header Status is Not cancelled
     C           WEGWST    IFEQ 'L'                        *IF
     C           WEGWST    OREQ 'A'
     C           WEGWST    OREQ 'C'
     C           WEGWST    OREQ 'R'
     C           WEGWST    OREQ 'E'
     C           WEGWST    OREQ 'H'
     C           WEGWST    OREQ 'I'
      * Bld ARR Load Schdlng SmRT - Order Detail  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
     C           KRSSP     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Bld ARR Load Schdlng SmRT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSQ02           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQSQ01           Company Number
     C                     Z-ADDWEC4NB    WQSQ02           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@BGWKL1                    *
     C           KRSSQ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * Rtv Primal Group Code RT - Item Default  * 
     C                     EXSR SRRVGN
      * Accum QTY Ordered Per Primal Group Code.
      * UPD Load Schdlng Summ  RT - *Arrays  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C           KRSSQ     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Primal Group Code RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADDOMHGCD    BYHGCD           Item Code
      * Establish starting position
     C           KRSSR     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           Primal Group Co
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYXRCD    YL0006           Primal Group Co
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * UPD Load Schdlng Summ  RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C           YL01      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * Initialize internal index
     C                     MOVEL*LOVAL    YD01
      * Move key fields to ARR Load Schdlng Summ
     C                     MOVELYL0006    YI0101           Primal Group Co
      *
      * Only search if key is not beyond range of current elements
     C           YK01,YL01 IFGT YD01
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE YL0006
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Load Schdlng Summ  CR - *Arrays  * 
     C                     EXSR STCRRC
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '1'
     C           YI01      OCUR YM01
      * USER: Process Data record
     C           WDSZQT    ADD  OMAVQT    YL0007           Total Quantity
      * CHG Load Schdlng Summ  CH - *Arrays  * 
     C                     EXSR SUCHRC
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * CRT Load Schdlng Summ  CR - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Array full, cannot add any more elements
     C           YL01      IFEQ 100
     C                     MOVEL'Y2U0036' W0RTN   7
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     MOVEL*BLANK    XAXRCD           Primal Group Co
     C                     Z-ADD*ZERO     XASZQT           Total Quantity
      * Move all fields to ARR Load Schdlng Summ
     C                     MOVELYL0006    XAXRCD           Primal Group Co
     C                     Z-ADDOMAVQT    XASZQT           Total Quantity
      *
      * Move key fields to ARR Load Schdlng Summ
     C                     MOVELXAXRCD    YI0101           Primal Group Co
      *
      * Check for duplicate primary key
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFEQ XAXRCD
      * Array element already exists
     C                     MOVEL'Y2U0003' W0RTN   7
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Insert after last used element
     C           YL01      ADD  1         Y       50
      * Check if element was a previously deleted element
     C           YK01,Y    IFNE *HIVAL
      * If so, reuse MODS index
     C                     MOVELYK01,Y    YD01
     C                     ELSE
      * If not, use element number as MODS index
     C                     Z-ADDY         YI01
     C                     ENDIF
      *
      * Create(insert) new element
      * Move key fields to ARR Load Schdlng Summ
     C                     MOVELXAXRCD    YI0101           Primal Group Co
      *
     C                     MOVELYD01      YK01,Y
     C           YI01      OCUR YM01
      * Update MODS fields
     C                     MOVELXAXRCD    WDXRCD           Primal Group Co
     C                     Z-ADDXASZQT    WDSZQT           Total Quantity
      * Only sort if element is out of position
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR01      IFGT 0
     C           YR01      ANDLE100
     C           YK01,YR01 ANDGTYD01
     C                     ADD  1         YR01    50
     C                     ENDIF
      * Sort array to place element in correct position
     C                     SORTAYK01
     C                     ENDIF
      * Adjust number of elements currently in array
     C                     ADD  1         YL01
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG Load Schdlng Summ  CH - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to ARR Load Schdlng Summ
     C                     MOVELWDXRCD    YI0101    P      Primal Group Co
      *
      * Reset global index if not within range of current elements
     C           Y         IFGT YL01
     C                     Z-ADD1         Y
     C                     ENDIF
      * Only search if not already pointing to correct element
     C           Y         IFGT 0
     C           YD01      ANDNEYK01,Y
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE WDXRCD
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Element not found in array
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     ENDIF
     C           YI01      OCUR YM01
      *
      * Move all fields to ARR Load Schdlng Summ
     C                     Z-ADDYL0007    WDSZQT           Total Quantity
      *
      *
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Load Schdlng Summ  RT - *Arrays  * Get PG 4/Most Qty Ord
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0009           Primal Group Co
     C                     Z-ADD*ZERO     YL0010           Total Quantity
     C           YL01      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * Initialize internal index
     C                     MOVEL*LOVAL    YD01
      * Move key fields to ARR Load Schdlng Summ
     C                     MOVELYL0008    YI0101           Primal Group Co
      *
      *
      * Only search if key is not beyond range of current elements
     C           YK01,YL01 IFGT YD01
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
     C           *IN90     IFEQ '1'
      * Sequence through qualified elements:
     C                     Z-ADDY         YR01    50
     C           YR01      DOWLEYL01
     C                     Z-ADDYR01      Y
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * USER: Process Data record
      * Send Back the Most Qty Ordered for Primal Group.
      * CASE: DB1.Total Quantity Ordered U GT LCL.Total Quantity Ordered
     C           WDSZQT    IFGT YL0010                     *IF
     C                     Z-ADDWDSZQT    YL0010           Total Quantity
     C                     MOVELWDXRCD    YL0009           Primal Group Co
     C                     END                             *FI
     C                     ADD  1         YR01
     C                     ENDDO
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Limit Loads f/Slot RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0156           Export Load Lim
     C                     Z-ADD*ZERO     WL0157           Combo Load Limi
     C                     Z-ADD*ZERO     WL0158           Box Load Limit
     C                     MOVEL'N'       WL0159           Record Found -O
      * RTV Shipping Co        RT - Warehouse  * 
     C                     EXSR SXRVGN
      * ** Retrieve needed values from System Values file     E000233
      * Rtv Company Ctl Vals  XF - Company Values  * 
     C                     CALL 'PNOQXFR'              90  Rtv Company Ctl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0011    WQ0001  30       Company Number
     C           YL0012    PARM *ZERO     WQ0002  50       Box Load Min Bo
     C           YL0013    PARM *ZERO     WQ0003  70       Partial Load Ma
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * change log
     C                     EXSR UISUBR                     change log
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFVPCD    WQSW02           Ship From Wareh
     C           *LIKE     DEFN WFAODT    WQSW03           Scheduled Ship
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW02           Ship From Wareh
     C                     KFLD           WQSW03           Scheduled Ship
      * Setup key
     C                     MOVELWL0153    WQSW02           Ship From Wareh
     C                     Z-ADDWL0154    WQSW03           Scheduled Ship
      * Establish starting position
     C           KRSSW     SETLL@FJCPN3                    *
     C           KRSSW     READE@FJCPN3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC 9/11/13 E2709
      * Check for Mixed having box qty>BOXLOAD qty, if yes, then BX, else
      * Change Priority 3/14/01    RMC
      * Check for Mixed having a box qty > 60 to stay BX   6/12/01    RMC
      * Per Steve Burke - 6/27/01
      * Dont check just for Prepaid Trucks.  Collect and Prepaid trucks i
      * If Partial Load (<= 20000 lbs) dont count.
      * Priority :  Combo , Export, Box
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.Load Type is Regular
      *   |- c2    : DB1.Total Load Order Weight GT LCL.Partial Load Max
      *   |- c3    : DB1.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WFVDST    IFEQ 'R'                        *IF
     C           WFRPNB    IFGT YL0013                     *IF
     C           WFQ2CD    IFEQ 'CT'                       *IF
     C           WFQ2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Update load found so this load wont be counted again in the calli
      * CASE: DB1.Load ID EQ PAR.Load ID
     C           WFRMNB    IFEQ WL0155                     *IF
     C                     MOVEL'Y'       WL0159           Record Found -O
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0014           Boxes Total Qua
      * 05/11/04 SLM PKTR01 Multi-Company - Function chgd-remove Company
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
     C                     EXSR SYRVGN
      * CASE: LCL.U/M - Ordered is Combos
     C           YL0015    IFEQ 'CB'                       *IF
     C                     ADD  1         WL0157           Combo Load Limi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWFU2ST    YL0017           Export Status D
      * Count Load as Export if order whse = Ship-From-Whse & Export 8/3/
      * CASE: DB1.Export Status is yes
     C           WFU2ST    IFEQ 'Y'                        *IF
      * See if export order whse matches load Shipfrom whse  08/03/07 RMC
      * For example a load could be export sts=Y and ship from whse is GP
      * there are multiple orders, and the one that is export is out of C
      *  in that case, dont count the load as export- per Steve B and Jim
      * RTV ExpOrd Whse for LD XF - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWFRMNB    PARMNB           Load ID
      *
     C                     CALL 'PMK2XFR'              90  RTV ExpOrd Whse
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Head
     C                     PARM WFVPCD    WQ0004  3        Ship From Wareh
     C           YL0017    PARM YL0017    WQ0005  1        Export Status D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMK2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: LCL.Export Status Dft is yes
     C           YL0017    IFEQ 'Y'                        *IF
     C                     ADD  1         WL0156           Export Load Lim
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WL0158           Box Load Limit
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSW     READE@FJCPN3                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0153    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSX     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0011           Shipping Compan
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBWC3    YL0011           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/13/04 SLM PKTR01 Multi-Company - Funt chg to rmv Co RST or Pos
     C                     MOVEL*BLANK    YL0015           USR Unit of Mea
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSY01           Load ID
      * Define keylist
     C           KPSSY     KLIST
     C                     KFLD           WQSY01           Load ID
     C                     KFLD           WCC4NB           Order Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Load ID
      * Setup key
     C                     Z-ADDWFRMNB    WQSY01           Load ID
     C                     Z-ADD*ZERO     WCC4NB           Order Number
      * Establish starting position
     C           KPSSY     SETLL@BFCPR0                    *
     C           KRSSY     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0145           Company Number
     C                     Z-ADDWCC4NB    WL0146           Order Number
     C                     Z-ADD1         WL0147           Order Sequence
     C                     MOVELYL0015    WL0148    P      USR Unit of Mea
     C                     Z-ADDYL0014    WL0149           Boxes Total Qua
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0148    YL0015    P      USR Unit of Mea
     C                     Z-ADDWL0149    YL0014           Boxes Total Qua
     C           KRSSY     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * RMC E2709 added here so it wont need to be in every calling pgm
      * CASE: PAR.USR Unit of Measure is Mixed
     C           YL0015    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0150           Company Number
     C                     MOVEL'BOXLOAD' WL0151    P      Company Value C
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    YL0016           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0014    IFLT YL0016                     *IF
     C                     MOVEL'CB'      YL0015           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0015           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Day and Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN AFBCDT    WQSZ02           Post to G/L Dat
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Post to G/L Dat
      * Setup key
     C                     Z-ADDP1CQC3    WQSZ01           Company Number
     C                     Z-ADDP2L9DT    WQSZ02           Post to G/L Dat
      * Establish starting position
     C           KRSSZ     SETLL@AFREYY                    *
     C           KRSSZ     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDAFETNB    YL0018           Accounting Peri
     C                     MOVELAFA9ST    YL0019           Day of Week
     C                     Z-ADDAFEINB    YL0020           Week Number
     C           KRSSZ     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A3AIC3    WQTA01           Company Number
     C           *LIKE     DEFN A3AJCD    WQTA02           Warehouse Code
     C           *LIKE     DEFN A3A9ST    WQTA03           Day of Week
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Warehouse Code
     C                     KFLD           WQTA03           Day of Week
      * Setup key
     C                     Z-ADDP1CQC3    WQTA01           Company Number
     C                     MOVELP1LQAA    WQTA02           Warehouse Code
     C                     MOVELYL0019    WQTA03           Day of Week
      * Establish starting position
     C           KRSTA     SETLL@A3REI3                    *
     C           KRSTA     READE@A3REI3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3033' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $FNVNX           Slot Limit for
     C                     Z-ADD*ZERO     $FNWNX           Slot Limit for
     C                     Z-ADD*ZERO     $FNXNX           Slot Limit for
     C                     Z-ADD*ZERO     WUIOWG           Weight Limit fo
     C                     Z-ADD*ZERO     WUIPWG           Weight Limit fo
     C                     Z-ADD*ZERO     WUIQWG           Weight Limit fo
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA3NVNX    $FNVNX           Slot Limit for
     C                     Z-ADDA3NWNX    $FNWNX           Slot Limit for
     C                     Z-ADDA3NXNX    $FNXNX           Slot Limit for
     C                     Z-ADDA3IOWG    WUIOWG           Weight Limit fo
     C                     Z-ADDA3IPWG    WUIPWG           Weight Limit fo
     C                     Z-ADDA3IQWG    WUIQWG           Weight Limit fo
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@A3REI3                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Order tied to a load.
      *================================================================
      * CASE: PAR.Untied Orders Flag USR is No
     C           P2FHSX    IFEQ 'N'                        *IF
      * Select Tied Order Only.
     C                     EXSR UBSUBR                     Select Tied Ord
     C                     ELSE
      * CASE: PAR.Untied Orders Flag USR is Yes
     C           P2FHSX    IFEQ 'Y'                        *IF
      * Select Untied Orders Only.
     C                     EXSR UCSUBR                     Select Untied O
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Select Tied Order Only.
      *================================================================
      * CASE: DB1.Load ID is GT Zero
     C           MHRMNB    IFGT *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Select Untied Orders Only.
      *================================================================
      * CASE: DB1.Load ID is Blank
     C           MHRMNB    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Scheduled Ship Date Selection.
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.From Date             USR is Entered
      *   |- c2    : PAR.To Date               USR is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2L9DT    IFNE *ZERO                      *IF
     C           P2MADT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Scheduled Ship Date LT PAR.From Date
      *   |- c2    : DB1.Scheduled Ship Date GT PAR.To Date
      *   '-
     C           MHAODT    IFLT P2L9DT                     *IF
     C           MHAODT    ORGT P2MADT                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Load ID Selection.
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.From Load ID  USR is NE Blank
      *   |- c2    : PAR.To Load ID  USR is NE Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2HQNX    IFNE *ZERO                      *IF
     C           P2HRNX    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Load ID LT PAR.From Load ID  USR
      *   |- c2    : DB1.Load ID GT PAR.To Load ID  USR
      *   '-
     C           MHRMNB    IFLT P2HQNX                     *IF
     C           MHRMNB    ORGT P2HRNX                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Export Status Selection.
      *================================================================
      * CASE: PAR.Export Status is Y/N Values
     C           P2U2ST    IFEQ 'N'                        *IF
     C           P2U2ST    OREQ 'Y'
      * RTV Export Status RT - Load Header  * 
     C                     EXSR SKRVGN
      * CASE: PAR.Export Status Dft NE PAR.Export Status
     C           P3CXST    IFNE P2U2ST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Unit of Measure Selection.
      *================================================================
      * Print the uom on report
      * Need to get the uom regardless if selected on uom or not
      * RTV UM/Whs Code        RT - Order Header TRG  * 
     C                     EXSR SLRVGN
     C                     MOVELP4ODCD    WUODCD           USR Unit of Mea
      * CASE: PAR.U/M - Load Scheduling USR is Not Blank
     C           P2FGSX    IFEQ 'BX'                       *IF
     C           P2FGSX    OREQ 'CB'
     C           P2FGSX    OREQ 'MX'
      * 05/11/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * CASE: PAR.USR Unit of Measure NE PAR.U/M - Load Scheduling USR
     C           P4ODCD    IFNE P2FGSX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Load Grade Selection.
      *================================================================
      * CASE: PAR.Load Grade is Not Blank
     C           P2BPSX    IFEQ 'C'                        *IF
     C           P2BPSX    OREQ 'L'
     C           P2BPSX    OREQ 'X'
     C           P2BPSX    OREQ 'A'
     C           P2BPSX    OREQ 'P'
      * CASE: DB1.Load Grade NE PAR.Load Grade
     C           MHBPSX    IFNE P2BPSX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * change log
      *================================================================
      * 02/03/2010 LJB E000233
      *    Retrieve needed values from System Values file
      * 08/03/07 RMC dly029 Count Load as Export if export order whse
      *    matches ShipFrom Whse on the load   -- per jim n, steve b
      * 05/11/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *    from Logical View
      * 05/17/04 RMC PKTR01 Multi-Company - Use Shipping Co from Whse
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3CXST           Export Status D
     C                     MOVEL*BLANK    P4ODCD           USR Unit of Mea
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display 1
     C                     MOVEL*BLANK    WUTIST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    MHCQC3           LSP Accounting
     C                     MOVEL*LOVAL    MHLQAA           LSP Prodution W
     C                     MOVEL*LOVAL    MHRMNB           Load ID
     C                     MOVEL*LOVAL    MHHGCD           Item Code
     C                     MOVEL*LOVAL    MHN5NY           Process Sequenc
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WABVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBCQC3           LSP Accounting
     C                     Z-ADD*ZERO     WBCUC3           LSP Order Compa
     C                     Z-ADD*ZERO     WBSPSQ           Sequence
     C                     Z-ADD*ZERO     WBL7DT           Thru Scheduled
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBKBQT           Actual Inventor
     C                     Z-ADD*ZERO     WBKCQT           Picked Inventor
     C                     Z-ADD*ZERO     WBKHQT           Available Inven
     C                     Z-ADD*ZERO     WBKDQT           Actual Producti
     C                     Z-ADD*ZERO     WBKEQT           Scheduled Produ
     C                     Z-ADD*ZERO     WBKFQT           Available Produ
     C                     Z-ADD*ZERO     WBH1QT           Scheduled Quant
     C                     Z-ADD*ZERO     WBKGQT           Scheduling Posi
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WBSTDT           LSP Production
     C                     Z-ADD*ZERO     WBN5NY           Process Sequenc
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTNDT           Production AgeD
     C                     Z-ADD*ZERO     WBTODT           Production AgeD
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field USR Unit of Measure
     C                     MOVEL*BLANK    WUODCD  2
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01    50
     C                     Z-ADD1         Y       50
     C                     ENDIF
      *
      * Define work field Record Found -OrdDtlUSR
     C                     MOVEL*BLANK    WUYIST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WFFLAM           Flat Amount
     C                     Z-ADD*ZERO     WFRRNB           Total Stops
     C                     Z-ADD*ZERO     WFSBNB           BOL Time
     C                     Z-ADD*ZERO     WFSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFSDNB           Number Pallets
     C                     Z-ADD*ZERO     WFPAOU           Number Pallets
     C                     Z-ADD*ZERO     WFDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WFSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WFHADT           Actual Arrival
     C                     Z-ADD*ZERO     WFAART           Actual Arrival
     C                     Z-ADD*ZERO     WFDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WFDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WFAQDT           Actual Departur
     C                     Z-ADD*ZERO     WFS6NB           Departure Time
     C                     Z-ADD*ZERO     WFT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WFPRTM           Product Tempera
     C                     Z-ADD*ZERO     WFNPSV           Number Spacers
     C                     Z-ADD*ZERO     WFTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WFGRWE           Gross Weight
     C                     Z-ADD*ZERO     WFF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WFJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WFTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WFJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WFSPTM           Spotted Time
     C                     Z-ADD*ZERO     WFJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WFLFTM           Load Finished T
     C                     Z-ADD*ZERO     WFJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WFBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WFJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WFBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WFKIDT           Truck Departure
     C                     Z-ADD*ZERO     WFASTM           Truck Departure
     C                     Z-ADD*ZERO     WFKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WFAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WFVOAG           Voyage
     C                     Z-ADD*ZERO     WFKBDT           Sail Date
     C                     Z-ADD*ZERO     WFEFDT           Arrival Date
     C                     Z-ADD*ZERO     WFKCDT           Date In
     C                     Z-ADD*ZERO     WFTMIN           Time In
     C                     Z-ADD*ZERO     WFKDDT           Date Out
     C                     Z-ADD*ZERO     WFVMNB           Time Out
     C                     Z-ADD*ZERO     WFOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WFKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WFATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WFBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFKKDT           On Yard Date
     C                     Z-ADD*ZERO     WFAVTM           On Yard Time
     C                     Z-ADD*ZERO     WFKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WFAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WFLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WFK0DT           Product Complet
     C                     Z-ADD*ZERO     WFAYTM           Product Complet
     C                     Z-ADD*ZERO     WFKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WFICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WFIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WFK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WFAZTM           Load Door 1
     C                     Z-ADD*ZERO     WFK2DT           Override Total
     C                     Z-ADD*ZERO     WFA0TM           Load Door 2
     C                     Z-ADD*ZERO     WFZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WFPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WFCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WFPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WFCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WFP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WFCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WFP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WFCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Weight Limit for Export
     C                     Z-ADD*ZERO     WUIOWG 110
      * Define work field Weight Limit for Combo
     C                     Z-ADD*ZERO     WUIPWG 110
      * Define work field Weight Limit for Box/Othr
     C                     Z-ADD*ZERO     WUIQWG 110
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  30
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004  1
     C                     MOVEL*BLANK    WL0005  1
     C                     Z-ADD*ZERO     WL0006  52
     C                     MOVEL*BLANK    WL0007 15
     C                     MOVEL*BLANK    WL0008 15
     C                     MOVEL*BLANK    WL0009 15
     C                     MOVEL*BLANK    WL0010 15
     C                     MOVEL*BLANK    WL0011 15
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013 112
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015  50
     C                     MOVEL*BLANK    WL0016 20
     C                     MOVEL*BLANK    WL0017  3
     C                     Z-ADD*ZERO     WL0018  40
     C                     MOVEL*BLANK    WL0019  3
     C                     MOVEL*BLANK    WL0020  7
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022 112
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     Z-ADD*ZERO     WL0025  50
     C                     Z-ADD*ZERO     WL0026  50
     C                     Z-ADD*ZERO     WL0027 112
     C                     Z-ADD*ZERO     WL0028  60
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030  40
     C                     Z-ADD*ZERO     WL0031 112
     C                     Z-ADD*ZERO     WL0032 112
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  40
     C                     Z-ADD*ZERO     WL0035  50
     C                     Z-ADD*ZERO     WL0036  52
     C                     Z-ADD*ZERO     WL0037  50
     C                     MOVEL*BLANK    WL0038 12
     C                     Z-ADD*ZERO     WL0039  70
     C                     MOVEL*BLANK    WL0040 12
     C                     MOVEL*BLANK    WL0041  2
     C                     MOVEL*BLANK    WL0042  3
     C                     MOVEL*BLANK    WL0043  2
     C                     Z-ADD*ZERO     WL0044  70
     C                     MOVEL*BLANK    WL0045  3
     C                     MOVEL*BLANK    WL0046  1
     C                     Z-ADD*ZERO     WL0047  70
     C                     MOVEL*BLANK    WL0048  1
     C                     Z-ADD*ZERO     WL0049  70
     C                     Z-ADD*ZERO     WL0050  60
     C                     Z-ADD*ZERO     WL0051  70
     C                     Z-ADD*ZERO     WL0052  60
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  60
     C                     Z-ADD*ZERO     WL0055  70
     C                     Z-ADD*ZERO     WL0056  60
     C                     Z-ADD*ZERO     WL0057  70
     C                     Z-ADD*ZERO     WL0058  60
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  60
     C                     Z-ADD*ZERO     WL0061  70
     C                     Z-ADD*ZERO     WL0062  60
     C                     MOVEL*BLANK    WL0063  3
     C                     MOVEL*BLANK    WL0064 20
     C                     MOVEL*BLANK    WL0065 30
     C                     Z-ADD*ZERO     WL0066  50
     C                     Z-ADD*ZERO     WL0067  70
     C                     MOVEL*BLANK    WL0068 12
     C                     MOVEL*BLANK    WL0069 20
     C                     Z-ADD*ZERO     WL0070  70
     C                     MOVEL*BLANK    WL0071 12
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073  60
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  60
     C                     Z-ADD*ZERO     WL0076 112
     C                     Z-ADD*ZERO     WL0077  70
     C                     Z-ADD*ZERO     WL0078  60
     C                     MOVEL*BLANK    WL0079  1
     C                     MOVEL*BLANK    WL0080  1
     C                     Z-ADD*ZERO     WL0081  70
     C                     Z-ADD*ZERO     WL0082  70
     C                     MOVEL*BLANK    WL0083  1
     C                     MOVEL*BLANK    WL0084  3
     C                     Z-ADD*ZERO     WL0085  70
     C                     Z-ADD*ZERO     WL0086  60
     C                     Z-ADD*ZERO     WL0087  70
     C                     Z-ADD*ZERO     WL0088  60
     C                     MOVEL*BLANK    WL0089  1
     C                     MOVEL*BLANK    WL0090  1
     C                     MOVEL*BLANK    WL0091 15
     C                     MOVEL*BLANK    WL0092 25
     C                     MOVEL*BLANK    WL0093 20
     C                     Z-ADD*ZERO     WL0094  70
     C                     MOVEL*BLANK    WL0095  1
     C                     MOVEL*BLANK    WL0096  1
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098  60
     C                     Z-ADD*ZERO     WL0099  50
     C                     Z-ADD*ZERO     WL0100  92
     C                     Z-ADD*ZERO     WL0101  92
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103 25
     C                     Z-ADD*ZERO     WL0104  70
     C                     Z-ADD*ZERO     WL0105  60
     C                     Z-ADD*ZERO     WL0106  70
     C                     Z-ADD*ZERO     WL0107  60
     C                     MOVEL*BLANK    WL0108  1
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110  1
     C                     MOVEL*BLANK    WL0111  1
     C                     Z-ADD*ZERO     WL0112 112
     C                     MOVEL*BLANK    WL0113 15
     C                     MOVEL*BLANK    WL0114 15
     C                     MOVEL*BLANK    WL0115 25
     C                     MOVEL*BLANK    WL0116 25
     C                     MOVEL*BLANK    WL0117  1
     C                     MOVEL*BLANK    WL0118  1
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  1
     C                     MOVEL*BLANK    WL0121  1
     C                     MOVEL*BLANK    WL0122  1
     C                     MOVEL*BLANK    WL0123  2
     C                     MOVEL*BLANK    WL0124  2
     C                     MOVEL*BLANK    WL0125  2
     C                     MOVEL*BLANK    WL0126  3
     C                     MOVEL*BLANK    WL0127  3
     C                     Z-ADD*ZERO     WL0128  70
     C                     Z-ADD*ZERO     WL0129  60
     C                     Z-ADD*ZERO     WL0130  70
     C                     Z-ADD*ZERO     WL0131  60
     C                     Z-ADD*ZERO     WL0132  70
     C                     Z-ADD*ZERO     WL0133  60
     C                     Z-ADD*ZERO     WL0134  70
     C                     Z-ADD*ZERO     WL0135  60
     C                     Z-ADD*ZERO     WL0136  70
     C                     Z-ADD*ZERO     WL0137  60
     C                     Z-ADD*ZERO     WL0138  70
     C                     Z-ADD*ZERO     WL0139  60
     C                     MOVEL*BLANK    WL0140  1
     C                     MOVEL*BLANK    WL0141  1
     C                     MOVEL*BLANK    WL0142  1
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0143  3
     C                     MOVEL*BLANK    WL0144 30
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0145  30
     C                     Z-ADD*ZERO     WL0146  70
     C                     Z-ADD*ZERO     WL0147  30
     C                     MOVEL*BLANK    WL0148  2
     C                     Z-ADD*ZERO     WL0149 112
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0150  30
     C                     MOVEL*BLANK    WL0151 10
     C                     Z-ADD*ZERO     WL0152 155
      * Define local variables for subroutine SWRVGN.
     C                     MOVEL*BLANK    WL0153  3
     C                     Z-ADD*ZERO     WL0154  70
     C                     Z-ADD*ZERO     WL0155  70
     C                     Z-ADD*ZERO     WL0156  30
     C                     Z-ADD*ZERO     WL0157  30
     C                     Z-ADD*ZERO     WL0158  30
     C                     MOVEL*BLANK    WL0159  1
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0001  2
      * Define null work field Thru Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0001  70
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0002  30
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0003  70
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0006  52
      * Define null work field Seal 1
     C                     MOVEL*BLANK    YN0007 15
      * Define null work field Seal 2
     C                     MOVEL*BLANK    YN0008 15
      * Define null work field Seal 3
     C                     MOVEL*BLANK    YN0009 15
      * Define null work field Seal 4
     C                     MOVEL*BLANK    YN0010 15
      * Define null work field Seal 2 Unused
     C                     MOVEL*BLANK    YN0011 15
      * Define null work field Total Load Order Weight
     C                     Z-ADD*ZERO     YN0012  70
      * Define null work field Flat Amount
     C                     Z-ADD*ZERO     YN0013 112
      * Define null work field Allocate Pounds/Miles
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Total Stops
     C                     Z-ADD*ZERO     YN0015  50
      * Define null work field Transloader Carrier Code
     C                     MOVEL*BLANK    YN0016  3
      * Define null work field BOL Time
     C                     Z-ADD*ZERO     YN0017  40
      * Define null work field Truck Size
     C                     MOVEL*BLANK    YN0018  7
      * Define null work field Ld Hdr/Ld Dtl Unused
     C                     Z-ADD*ZERO     YN0019  70
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0020 112
      * Define null work field Ship Status
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0022  1
      * Define null work field Number Pallets Received
     C                     Z-ADD*ZERO     YN0023  50
      * Define null work field Number Pallets Loaded
     C                     Z-ADD*ZERO     YN0024  50
      * Define null work field Load Carrier Pay Amt
     C                     Z-ADD*ZERO     YN0025 112
      * Define null work field Estimated Arrival Time
     C                     Z-ADD*ZERO     YN0026  60
      * Define null work field Actual Arrival Date
     C                     Z-ADD*ZERO     YN0027  70
      * Define null work field Actual Arrival Time
     C                     Z-ADD*ZERO     YN0028  40
      * Define null work field Trailer IN Weight
     C                     Z-ADD*ZERO     YN0029 112
      * Define null work field Trailer OUT Weight
     C                     Z-ADD*ZERO     YN0030 112
      * Define null work field Actual Departure Date
     C                     Z-ADD*ZERO     YN0031  70
      * Define null work field Departure Time
     C                     Z-ADD*ZERO     YN0032  40
      * Define null work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YN0033  50
      * Define null work field Product Temperature
     C                     Z-ADD*ZERO     YN0034  52
      * Define null work field Number Spacers Loaded
     C                     Z-ADD*ZERO     YN0035  50
      * Define null work field Car/Veh. Initials
     C                     MOVEL*BLANK    YN0036 12
      * Define null work field Total Load Miles
     C                     Z-ADD*ZERO     YN0037  70
      * Define null work field Recorder ID
     C                     MOVEL*BLANK    YN0038 12
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0039  2
      * Define null work field Ship From Warehouse
     C                     MOVEL*BLANK    YN0040  3
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0041  2
      * Define null work field Gross Weight
     C                     Z-ADD*ZERO     YN0042  70
      * Define null work field Carrier Broker
     C                     MOVEL*BLANK    YN0043  3
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0044  1
      * Define null work field Actual Ship Date
     C                     Z-ADD*ZERO     YN0045  70
      * Define null work field On Time - (Y/N)
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Truck Ready Date
     C                     Z-ADD*ZERO     YN0047  70
      * Define null work field Truck Ready Time
     C                     Z-ADD*ZERO     YN0048  60
      * Define null work field Spotted Date
     C                     Z-ADD*ZERO     YN0049  70
      * Define null work field Spotted Time
     C                     Z-ADD*ZERO     YN0050  60
      * Define null work field Load Finished Date
     C                     Z-ADD*ZERO     YN0051  70
      * Define null work field Load Finished Time
     C                     Z-ADD*ZERO     YN0052  60
      * Define null work field BOL Complete Date
     C                     Z-ADD*ZERO     YN0053  70
      * Define null work field BOL Complete Time
     C                     Z-ADD*ZERO     YN0054  60
      * Define null work field BOL Received Date
     C                     Z-ADD*ZERO     YN0055  70
      * Define null work field BOL Received Time
     C                     Z-ADD*ZERO     YN0056  60
      * Define null work field Truck Departure Date
     C                     Z-ADD*ZERO     YN0057  70
      * Define null work field Truck Departure Time
     C                     Z-ADD*ZERO     YN0058  60
      * Define null work field Adjusted Departure Date
     C                     Z-ADD*ZERO     YN0059  70
      * Define null work field Adjusted Departure Time
     C                     Z-ADD*ZERO     YN0060  60
      * Define null work field Shipping Line
     C                     MOVEL*BLANK    YN0061  3
      * Define null work field Port Delv Terminal
     C                     MOVEL*BLANK    YN0062 20
      * Define null work field Vessel Name
     C                     MOVEL*BLANK    YN0063 30
      * Define null work field Voyage
     C                     Z-ADD*ZERO     YN0064  50
      * Define null work field Sail Date
     C                     Z-ADD*ZERO     YN0065  70
      * Define null work field Booking Number
     C                     MOVEL*BLANK    YN0066 12
      * Define null work field Discharge Port
     C                     MOVEL*BLANK    YN0067 20
      * Define null work field Arrival Date
     C                     Z-ADD*ZERO     YN0068  70
      * Define null work field Container Number
     C                     MOVEL*BLANK    YN0069 12
      * Define null work field Date In
     C                     Z-ADD*ZERO     YN0070  70
      * Define null work field Time In
     C                     Z-ADD*ZERO     YN0071  60
      * Define null work field Date Out
     C                     Z-ADD*ZERO     YN0072  70
      * Define null work field Time Out
     C                     Z-ADD*ZERO     YN0073  60
      * Define null work field Load Total Freight
     C                     Z-ADD*ZERO     YN0074 112
      * Define null work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YN0075  70
      * Define null work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     YN0076  60
      * Define null work field LH Unused Sts
     C                     MOVEL*BLANK    YN0077  1
      * Define null work field LH Carrier Payment Sts
     C                     MOVEL*BLANK    YN0078  1
      * Define null work field Bring Back Miles
     C                     Z-ADD*ZERO     YN0079  70
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0080  70
      * Define null work field Load Acceptance Flag
     C                     MOVEL*BLANK    YN0081  1
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0082  3
      * Define null work field Deadline Departure Date
     C                     Z-ADD*ZERO     YN0083  70
      * Define null work field Deadline Departure Time
     C                     Z-ADD*ZERO     YN0084  60
      * Define null work field Load Held Over
     C                     MOVEL*BLANK    YN0085  1
      * Define null work field Load Held Over Reason
     C                     MOVEL*BLANK    YN0086  1
      * Define null work field Load Held Over Rsn Cmt
     C                     MOVEL*BLANK    YN0087 15
      * Define null work field Ocean BOL Number
     C                     MOVEL*BLANK    YN0088 25
      * Define null work field Express Mail Number
     C                     MOVEL*BLANK    YN0089 20
      * Define null work field Express Mail Date
     C                     Z-ADD*ZERO     YN0090  70
      * Define null work field Load Shag Flag
     C                     MOVEL*BLANK    YN0091  1
      * Define null work field Load Wash Flag
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Product Complete Date
     C                     Z-ADD*ZERO     YN0093  70
      * Define null work field Product Complete Time
     C                     Z-ADD*ZERO     YN0094  60
      * Define null work field Pallets Loaded
     C                     Z-ADD*ZERO     YN0095  50
      * Define null work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YN0096  92
      * Define null work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YN0097  92
      * Define null work field Load Confirmed Sts
     C                     MOVEL*BLANK    YN0098  1
      * Define null work field Load Confirmed Contact
     C                     MOVEL*BLANK    YN0099 25
      * Define null work field Load Confirmation Time
     C                     Z-ADD*ZERO     YN0100  70
      * Define null work field Load Door 1
     C                     Z-ADD*ZERO     YN0101  60
      * Define null work field Override Total Load Miles
     C                     Z-ADD*ZERO     YN0102  70
      * Define null work field Load Door 2
     C                     Z-ADD*ZERO     YN0103  60
      * Define null work field Partial Load
     C                     MOVEL*BLANK    YN0104  1
      * Define null work field Load Confirmation Fax Sts
     C                     MOVEL*BLANK    YN0105  1
      * Define null work field Export Load USDA-OK
     C                     MOVEL*BLANK    YN0106  1
      * Define null work field Late Delivery Email Flag
     C                     MOVEL*BLANK    YN0107  1
      * Define null work field Load Actual Freight
     C                     Z-ADD*ZERO     YN0108 112
      * Define null work field Hide on WW Load Sts
     C                     MOVEL*BLANK    YN0109 15
      * Define null work field Late Billing Email Flag
     C                     MOVEL*BLANK    YN0110 15
      * Define null work field Shipping Temp C/F txt
     C                     MOVEL*BLANK    YN0111 25
      * Define null work field LH Held Over Rsn Cmt
     C                     MOVEL*BLANK    YN0112 25
      * Define null work field Multi Company Load
     C                     MOVEL*BLANK    YN0113  1
      * Define null work field Fax Sent to SSI Carrier
     C                     MOVEL*BLANK    YN0114  1
      * Define null work field Schedule Pos Load Grade
     C                     MOVEL*BLANK    YN0115  1
      * Define null work field LH Power Only Load
     C                     MOVEL*BLANK    YN0116  1
      * Define null work field MG Created Load
     C                     MOVEL*BLANK    YN0117  1
      * Define null work field LH Unused Sts 5
     C                     MOVEL*BLANK    YN0118  1
      * Define null work field Load U/M
     C                     MOVEL*BLANK    YN0119  2
      * Define null work field TPM Shipment Status
     C                     MOVEL*BLANK    YN0120  2
      * Define null work field LH Unused Sts 8
     C                     MOVEL*BLANK    YN0121  2
      * Define null work field LH On-Time Reason Code
     C                     MOVEL*BLANK    YN0122  3
      * Define null work field LH Held Over Reason
     C                     MOVEL*BLANK    YN0123  3
      * Define null work field LH Carrier Paid Dte
     C                     Z-ADD*ZERO     YN0124  70
      * Define null work field LH Carrier Paid Time
     C                     Z-ADD*ZERO     YN0125  60
      * Define null work field LH Last Combo Prod Date
     C                     Z-ADD*ZERO     YN0126  70
      * Define null work field LH Last Combo Prod Time
     C                     Z-ADD*ZERO     YN0127  60
      * Define null work field LPT Load Plan Start Dt
     C                     Z-ADD*ZERO     YN0128  70
      * Define null work field LPT Load Plan Start Tm
     C                     Z-ADD*ZERO     YN0129  60
      * Define null work field TPM Planned Ship Date
     C                     Z-ADD*ZERO     YN0130  70
      * Define null work field LH Unused Time 4
     C                     Z-ADD*ZERO     YN0131  60
      * Define null work field LH Unused Date 5
     C                     Z-ADD*ZERO     YN0132  70
      * Define null work field LH Unused Time 5
     C                     Z-ADD*ZERO     YN0133  60
      * Define null work field LH Unused Date 6
     C                     Z-ADD*ZERO     YN0134  70
      * Define null work field LH Unused Time 6
     C                     Z-ADD*ZERO     YN0135  60
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0136  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0137  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0138  1
      * Define local work field Live with TPM
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0005  50
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0006  6
      * Define local work field Total Quantity Ordered U
     C                     Z-ADD*ZERO     YL0007  92
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0008  6
      * Define local work field Primal Group Code USR
     C                     MOVEL*BLANK    YL0009  6
      * Define local work field Total Quantity Ordered U
     C                     Z-ADD*ZERO     YL0010  92
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field Partial Load Max Lbs USR
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0014 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0015  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field Export Status Dft
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Accounting Period Code
     C                     Z-ADD*ZERO     YL0018  20
      * Define local work field Day of Week
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Week Number
     C                     Z-ADD*ZERO     YL0020  20
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUTIST           USR Display 1
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SCRVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
