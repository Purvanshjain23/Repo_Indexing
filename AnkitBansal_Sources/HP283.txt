      *****************  RPG PROGRAM HEADING  ************************
      *
      * SYSTEM:      Hog Production System
      * PROGRAM:     HP283-Safedata: Write BGF Weekly Wean Projections Receiving File
      *                        to Editing File
      * PROGRAMMER:  LeAnne Fedor
      * CREATED:     07/12/04
      *
      *        !!!!! NO WEB DATA IS PROCESSED IN THIS PROGRAM !!!!!!!
      *
      *              This program reads records from the Receiving file and writes
      *              them to the Editing file. Thus, this program is only processing
      *              Safedata data...not WEB data.
      *
      *
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      /eject
      ****************************************************************
      * FILE SPECIFICATIONS
      ****************************************************************
      *
     Fhsp283    if   e             disk
      *  Safedata: BGF weekly wean projection receiving file
      *
      *
     Fhsp284    o    e           k disk
      *  Safedata/WEB: BGF weekly wean projection editing file
      *
      /eject
      ****************************************************************
      * DEFINITION SPECIFICATIONS
      ****************************************************************
      *
      ****************************************************************
      * CONSTANTS
      ****************************************************************
      *
     D yes             c                   'Y'
     D no              c                   'N'
      *
      *
      ****************************************************************
      * ARRAYS AND TABLES
      ****************************************************************
      *
      *
      ****************************************************************
      * STANDALONE FIELDS
      ****************************************************************
      *
      * Workfields for date manipulation
      *
     D wkcymdiso       s               D   datfmt(*iso)
     D wkcrdt          s                   like(pwcrdt)
     D wkcrtm          s                   like(pwcrtm)
      *
      ****************************************************************
      * DATA STRUCTURES
      ****************************************************************
      *
      *---------------------------------------------------------------
      * Standard program status data structure
      *---------------------------------------------------------------
      *    externally defined as UTPGFR (record format: PGMDSR)
     D pgmds         esds                  extname(utpgfr)
      *
      *
      *---------------------------------------------------------------
      * Break out single-field input record into individual fields
      *---------------------------------------------------------------
      *
     D inputrec        ds
     D   allfields                   77
      *
     D   xxfscd                       5    overlay(allfields:1)
     D   xxrpcdwk                     2    overlay(allfields:6)
     D   xxrpcdyr                     4    overlay(allfields:8)
      *
      * Week 1 fields
      *
     D   xxsupwhd1                    5    overlay(allfields:12)
     D   xxmopwhd1                    5    overlay(allfields:17)
     D   xxtupwhd1                    5    overlay(allfields:22)
     D   xxwepwhd1                    5    overlay(allfields:27)
     D   xxthpwhd1                    5    overlay(allfields:32)
     D   xxfrpwhd1                    5    overlay(allfields:37)
     D   xxsapwhd1                    5    overlay(allfields:42)
      *
     D   xxpwsohd1                    5    overlay(allfields:47)
      *
     D   xxsocuhd1                    5    overlay(allfields:52)
     D   xxbocuhd1                    5    overlay(allfields:57)
      *
      * Week 2 fields
      *
     D   xxtopwhd2                    5    overlay(allfields:62)
     D   xxpwsohd2                    5    overlay(allfields:67)
      *
     D   xxsdino                      6    overlay(allfields:72)
      *
      *
      * The following is a dummy C-spec to keep the D-specs from
      * running over into the C-specs on the compile listing. It
      * serves no other purpose and can be deleted at any time.
      *
     C                   if        sdpgm = *blank
     C                   endif
      /EJECT
      ****************************************************************
      * MAINLINE
      ****************************************************************
      *
      * Read each record in the Receiving file and extract fields for the
      * record you will write to the editing file.
      *
     C                   dou       *in90 = *on                                  Main do
     C                   read      hsp283                                 90
     C                   if        *in90 = *off                                 If not EOF
      *
     C                   move(p)   u1field       inputrec
      *
      * Test all fields for numerics; set non-numeric fields to 0.
      *
     C                   testn                   xxfscd               92
     C                   if        *in92 = *on
     C                   move      xxfscd        pwfscd
     C                   else
     C                   z-add     0             pwfscd
     C                   endif
      *
     C                   testn                   xxrpcdwk             92
     C                   if        *in92 = *on
     C                   move      xxrpcdwk      pwrpcdwk
     C                   else
     C                   z-add     0             pwrpcdwk
     C                   endif
      *
     C                   testn                   xxrpcdyr             92
     C                   if        *in92 = *on
     C                   move      xxrpcdyr      pwrpcdyr
     C                   else
     C                   z-add     0             pwrpcdyr
     C                   endif
      *
      * Week 1
     C                   testn                   xxsupwhd1            92
     C                   if        *in92 = *on
     C                   move      xxsupwhd1     pwsupwhd
     C                   else
     C                   z-add     0             pwsupwhd
     C                   endif
      *
     C                   testn                   xxmopwhd1            92
     C                   if        *in92 = *on
     C                   move      xxmopwhd1     pwmopwhd
     C                   else
     C                   z-add     0             pwmopwhd
     C                   endif
      *
     C                   testn                   xxtupwhd1            92
     C                   if        *in92 = *on
     C                   move      xxtupwhd1     pwtupwhd
     C                   else
     C                   z-add     0             pwtupwhd
     C                   endif
      *
     C                   testn                   xxwepwhd1            92
     C                   if        *in92 = *on
     C                   move      xxwepwhd1     pwwepwhd
     C                   else
     C                   z-add     0             pwwepwhd
     C                   endif
      *
     C                   testn                   xxthpwhd1            92
     C                   if        *in92 = *on
     C                   move      xxthpwhd1     pwthpwhd
     C                   else
     C                   z-add     0             pwthpwhd
     C                   endif
      *
     C                   testn                   xxfrpwhd1            92
     C                   if        *in92 = *on
     C                   move      xxfrpwhd1     pwfrpwhd
     C                   else
     C                   z-add     0             pwfrpwhd
     C                   endif
      *
     C                   testn                   xxsapwhd1            92
     C                   if        *in92 = *on
     C                   move      xxsapwhd1     pwsapwhd
     C                   else
     C                   z-add     0             pwsapwhd
     C                   endif
      *
     C                   testn                   xxpwsohd1            92
     C                   if        *in92 = *on
     C                   move      xxpwsohd1     pwpwsohd1
     C                   else
     C                   z-add     0             pwpwsohd1
     C                   endif
      *
     C                   testn                   xxsocuhd1            92
     C                   if        *in92 = *on
     C                   move      xxsocuhd1     pwsocuhd1
     C                   else
     C                   z-add     0             pwsocuhd1
     C                   endif
      *
     C                   testn                   xxbocuhd1            92
     C                   if        *in92 = *on
     C                   move      xxbocuhd1     pwbocuhd1
     C                   else
     C                   z-add     0             pwbocuhd1
     C                   endif
      * Week 2
     C                   testn                   xxtopwhd2            92
     C                   if        *in92 = *on
     C                   move      xxtopwhd2     pwtopwhd2
     C                   else
     C                   z-add     0             pwtopwhd2
     C                   endif
      *
     C                   testn                   xxpwsohd2            92
     C                   if        *in92 = *on
     C                   move      xxpwsohd2     pwpwsohd2
     C                   else
     C                   z-add     0             pwpwsohd2
     C                   endif
      *
      * Set the 'data source' field to say 'Safedata'.
      *
     C                   move      'S'           pwdscd
      *
      * Safedata reference number
      *
     C                   testn                   xxsdino              92
     C                   if        *in92 = *on
     C                   move      xxsdino       pwsdino
     C                   else
     C                   z-add     0             pwsdino
     C                   endif
      *
      *
      * Put 'system date/time' into the 'create date/time' fields
      *
     C                   z-add     wkcrdt        pwcrdt
     C                   z-add     wkcrtm        pwcrtm
      *
      * Write a record to the editing file.
      *
     C                   write     pwrec
     C                   clear                   pwrec
     C
     C                   endif                                                  If not EOF
     C                   enddo                                                  Main do
      *
     C                   seton                                        lr
      /eject
      *---------------------------------------------------------------
      * Initialization subroutine
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
      * Put system date/time into work fields to use as 'create date/time'.
      *
     C     *mdy          movel     udate         wkcymdiso
     C                   movel     wkcymdiso     wkcrdt
     C                   time                    wkcrtm
      *
     C                   endsr
      /eject
