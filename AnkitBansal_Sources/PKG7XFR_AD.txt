// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKG7XFR
// ?Date: 14.08.2025 Time: 02:51:40
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modifications and Comments
DO;

//?H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Number
ENDDO;

EXECUTE FUNCTION(HPE056 Payment Type) TYPE(EXCINTFUN)                           AB1189849;
{
 //?Execute internal function

 //?1/10/96  HPE056   Allow payment type to be update based on
 //?                  what the payment status is at the time this
 //?                  tattoo is being updated
}


//?Program Description:     This program is a conversion pgm that only
//?      needs to be run at the beginning of install project HPE056
//?      If needed this pgm could be run at any time to correct the
//?      payment type if needed.
//?Print all tattoos that payment type is equal to blank (Before)
// WRK.*Return code = CND.*Normal
WRK.*Return_code = *BLANK;

// Call program Prt Pymnt Typ=Blnk     UP.
CALL PROGRAM(Prt Pymnt Typ=Blnk     UP) ('PKG9UPC');
PARAMETER(WRK.*Return_code);

// WRK.*Return code = CND.*Normal
WRK.*Return_code = *BLANK;

EXECUTE FUNCTION(Chg Payment Type Cvt  RT) TYPE(RTVOBJ) FILE(PKA1CPP)           AB1190424;
{
 //?USER: Initialize routine

 EXECUTE FUNCTION(HPE056 Payment Type) TYPE(EXCINTFUN)                           AB1189849;
 {
  //?Execute internal function

  //?1/10/96  HPE056   Allow payment type to be update based on
  //?                  what the payment status is at the time this
  //?                  tattoo is being updated
 }

 //?USER: Process Data record

 CASE;

 // IF DB1.TH Payment Type is Carcass/Live
 IF DB1.TH_Payment_Type = 'C'/'L';

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.TH Payment Type = DB1.TH Payment Type
 WRK.TH_Payment_Type = DB1.TH_Payment_Type;

 CASE;

 // IF DB1.TH Payment Sts is Live anything
 IF DB1.TH_Payment_Sts = 'ML'/'PL'/'NL'/'SL'/'IL';

 // WRK.TH Payment Type = CND.Live
 WRK.TH_Payment_Type = 'L';

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.TH Payment Type = CND.Carcass Merit
 WRK.TH_Payment_Type = 'C';

 ENDIF;

 EXECUTE FUNCTION(Chg Payment Type CVT  CH) TYPE(CHGOBJ) FILE(PKA1CPP)           AB1190423;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(WRK.TH_Payment_Type);
 {
  //?USER: Processing before Data read

  EXECUTE FUNCTION(HPE056 Payment Type) TYPE(EXCINTFUN)                           AB1189849;
  {
   //?Execute internal function

   //?1/10/96  HPE056   Allow payment type to be update based on
   //?                  what the payment status is at the time this
   //?                  tattoo is being updated
  }

  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 ENDIF;

}


//?Print all tattoos that payment type is equal to blank (After)
// WRK.*Return code = CND.*Normal
WRK.*Return_code = *BLANK;

// Call program Prt Pymnt Typ=Blnk     UP.
CALL PROGRAM(Prt Pymnt Typ=Blnk     UP) ('PKG9UPC');

