/***************************************************************** */
/*  PROGRAM:       PWBZUPC                                         */
/*  PROGRAM DESC:  CNV PRODUCER SITE     CL  EXECUTE USER PROGRAM  */
/*  PROGRAMMER:    JULIUS HIGH                                     */
/*  DATE:          05/11/2017                                      */
/*  PROJECT ID:    R10425 - Update Producer Site XLS Upload        */
/*                                                                 */
/*  PURPOSE:       One-time conversion (or on demand) program to   */
/*                 create Producer Site (PLATREP) records from     */
/*                 platrepcsv.csv file will be saved to a mapped   */
/*                 network drive on the local pc which is linked   */
/*                 to the IFS directory '/home/CSVUPLOAD'.         */
/*                                                                 */
/* PARMS:          None                                            */
/*******************************************************************/
/*  Modification History                                           */
/*                                                                 */
/*******************************************************************/
             PGM

             DCL        VAR(&MSG) TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGL) TYPE(*DEC) LEN(5 0)

/*-----------------------------------------------------------------*/
/* Copy From Import File                                           */
/*-----------------------------------------------------------------*/
             CPYFRMIMPF FROMSTMF('/home/csvupload/platrepcsv.csv') +
                          TOFILE(*LIBL/PLATREPCSV) MBROPT(*REPLACE) +
                          RCDDLM(*CRLF) RMVCOLNAM(*YES)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/*-----------------------------------------------------------------*/
/* Call Conversion process to recreate records for Producer Site   */
/* files.                                                          */
/*-----------------------------------------------------------------*/
             CALL       PGM(PWB0XFR) PARM('')

             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/
 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM
