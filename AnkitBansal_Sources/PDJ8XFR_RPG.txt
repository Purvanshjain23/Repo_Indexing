     H/TITLE UPD Resync Itm Bal/Dtl XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 01/06/06  Time  : 11:21:00
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FCAB0REL0UF  E           K        DISK
      * UPD : Item Balance              Update index
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WAAIC3
     I              B0HGCD                          WAHGCD
     I              B0AJCD                          WAAJCD
     I              B0AGCS                          WAAGCS
     I              B0AECS                          WAAECS
     I              B0BACS                          WABACS
     I              B0BBCS                          WABBCS
     I              B0CBPR                          WACBPR
     I              B0GUDT                          WAGUDT
     I              B0XYST                          WAXYST
     I              B0CTPR                          WACTPR
     I              B0G4DT                          WAG4DT
     I              B0BOWG                          WABOWG
     I              B0DDQT                          WADDQT
     I              B0DEQT                          WADEQT
     I              B0DFQT                          WADFQT
     I              B0HDQT                          WAHDQT
     I              B0HEQT                          WAHEQT
     I              B0AJQT                          WAAJQT
     I              B0AQQT                          WAAQQT
     I              B0AUQT                          WAAUQT
     I              B0EMQT                          WAEMQT
     I              B0DOQT                          WADOQT
     I              B0ATNA                          WAATNA
     I              B0AKDT                          WAAKDT
     I              B0ANDT                          WAANDT
     I              B0IDVA                          WAIDVA
     I              B0JVST                          WAJVST
     I              B0BZPC                          WABZPC
     I              B0DGQT                          WADGQT
     I              B0DIDT                          WADIDT
     I              B0ALCD                          WAALCD
     I              B0BFDY                          WABFDY
     I              B0DJDT                          WADJDT
     I              B0BGDY                          WABGDY
     I              B0DKDT                          WADKDT
     I              B0J2ST                          WAJ2ST
     I              B0DJQT                          WADJQT
     I              B0BNWG                          WABNWG
     I              B0DLDT                          WADLDT
     I              B0DPQT                          WADPQT
     I              B0DQQT                          WADQQT
     I              B0DMDT                          WADMDT
     I              B0M0ST                          WAM0ST
     I              B0J9ST                          WAJ9ST
     I              B0KBST                          WAKBST
     I              B0AKC8                          WAAKC8
     I              B0RINB                          WARINB
     I              B0RHNB                          WARHNB
     I              B0RGNB                          WARGNB
     I              B0UVST                          WAUVST
     I              B0UWST                          WAUWST
     I              B0UXST                          WAUXST
     I              B0VSST                          WAVSST
     I              B0AATM                          WAAATM
     I              B0AYNA                          WAAYNA
     I              B0A0NA                          WAA0NA
     I              B0AXDT                          WAAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WBAIC3
     I              B1HGCD                          WBHGCD
     I              B1AJCD                          WBAJCD
     I              B1ELDT                          WBELDT
     I              B1ABWG                          WBABWG
     I              B1AGQT                          WBAGQT
     I              B1AHQT                          WBAHQT
     I              B1AIQT                          WBAIQT
     I              B1CTST                          WBCTST
     I              B1ACWG                          WBACWG
     I              B1ARQT                          WBARQT
     I              B1ASQT                          WBASQT
     I              B1ATQT                          WBATQT
     I              B1HDQT                          WBHDQT
     I              B1HEQT                          WBHEQT
     I              B1F6ST                          WBF6ST
     I              B1BMWG                          WBBMWG
     I              B1DSQT                          WBDSQT
     I              B1DTQT                          WBDTQT
     I              B1DUQT                          WBDUQT
     I              B1DHDT                          WBDHDT
     I              B1AGCS                          WBAGCS
     I              B1AECS                          WBAECS
     I              B1IDVA                          WBIDVA
     I              B1K7DT                          WBK7DT
     I              B1RINB                          WBRINB
     I              B1RHNB                          WBRHNB
     I              B1RGNB                          WBRGNB
     I              B1UVST                          WBUVST
     I              B1UWST                          WBUWST
     I              B1UXST                          WBUXST
     I              B1VSST                          WBVSST
     I              B1AATM                          WBAATM
     I              B1AYNA                          WBAYNA
     I              B1A0NA                          WBA0NA
     I              B1AXDT                          WBAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WCAIC3
     I              B0HGCD                          WCHGCD
     I              B0AJCD                          WCAJCD
     I              B0AGCS                          WCAGCS
     I              B0AECS                          WCAECS
     I              B0BACS                          WCBACS
     I              B0BBCS                          WCBBCS
     I              B0CBPR                          WCCBPR
     I              B0GUDT                          WCGUDT
     I              B0XYST                          WCXYST
     I              B0CTPR                          WCCTPR
     I              B0G4DT                          WCG4DT
     I              B0BOWG                          WCBOWG
     I              B0DDQT                          WCDDQT
     I              B0DEQT                          WCDEQT
     I              B0DFQT                          WCDFQT
     I              B0HDQT                          WCHDQT
     I              B0HEQT                          WCHEQT
     I              B0AJQT                          WCAJQT
     I              B0AQQT                          WCAQQT
     I              B0AUQT                          WCAUQT
     I              B0EMQT                          WCEMQT
     I              B0DOQT                          WCDOQT
     I              B0ATNA                          WCATNA
     I              B0AKDT                          WCAKDT
     I              B0ANDT                          WCANDT
     I              B0IDVA                          WCIDVA
     I              B0JVST                          WCJVST
     I              B0BZPC                          WCBZPC
     I              B0DGQT                          WCDGQT
     I              B0DIDT                          WCDIDT
     I              B0ALCD                          WCALCD
     I              B0BFDY                          WCBFDY
     I              B0DJDT                          WCDJDT
     I              B0BGDY                          WCBGDY
     I              B0DKDT                          WCDKDT
     I              B0J2ST                          WCJ2ST
     I              B0DJQT                          WCDJQT
     I              B0BNWG                          WCBNWG
     I              B0DLDT                          WCDLDT
     I              B0DPQT                          WCDPQT
     I              B0DQQT                          WCDQQT
     I              B0DMDT                          WCDMDT
     I              B0M0ST                          WCM0ST
     I              B0J9ST                          WCJ9ST
     I              B0KBST                          WCKBST
     I              B0AKC8                          WCAKC8
     I              B0RINB                          WCRINB
     I              B0RHNB                          WCRHNB
     I              B0RGNB                          WCRGNB
     I              B0UVST                          WCUVST
     I              B0UWST                          WCUWST
     I              B0UXST                          WCUXST
     I              B0VSST                          WCVSST
     I              B0AATM                          WCAATM
     I              B0AYNA                          WCAYNA
     I              B0A0NA                          WCA0NA
     I              B0AXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WCAIC3
     I              B0HGCD                          WCHGCD
     I              B0AJCD                          WCAJCD
     I              B0AGCS                          WCAGCS
     I              B0AECS                          WCAECS
     I              B0BACS                          WCBACS
     I              B0BBCS                          WCBBCS
     I              B0CBPR                          WCCBPR
     I              B0GUDT                          WCGUDT
     I              B0XYST                          WCXYST
     I              B0CTPR                          WCCTPR
     I              B0G4DT                          WCG4DT
     I              B0BOWG                          WCBOWG
     I              B0DDQT                          WCDDQT
     I              B0DEQT                          WCDEQT
     I              B0DFQT                          WCDFQT
     I              B0HDQT                          WCHDQT
     I              B0HEQT                          WCHEQT
     I              B0AJQT                          WCAJQT
     I              B0AQQT                          WCAQQT
     I              B0AUQT                          WCAUQT
     I              B0EMQT                          WCEMQT
     I              B0DOQT                          WCDOQT
     I              B0ATNA                          WCATNA
     I              B0AKDT                          WCAKDT
     I              B0ANDT                          WCANDT
     I              B0IDVA                          WCIDVA
     I              B0JVST                          WCJVST
     I              B0BZPC                          WCBZPC
     I              B0DGQT                          WCDGQT
     I              B0DIDT                          WCDIDT
     I              B0ALCD                          WCALCD
     I              B0BFDY                          WCBFDY
     I              B0DJDT                          WCDJDT
     I              B0BGDY                          WCBGDY
     I              B0DKDT                          WCDKDT
     I              B0J2ST                          WCJ2ST
     I              B0DJQT                          WCDJQT
     I              B0BNWG                          WCBNWG
     I              B0DLDT                          WCDLDT
     I              B0DPQT                          WCDPQT
     I              B0DQQT                          WCDQQT
     I              B0DMDT                          WCDMDT
     I              B0M0ST                          WCM0ST
     I              B0J9ST                          WCJ9ST
     I              B0KBST                          WCKBST
     I              B0AKC8                          WCAKC8
     I              B0RINB                          WCRINB
     I              B0RHNB                          WCRHNB
     I              B0RGNB                          WCRGNB
     I              B0UVST                          WCUVST
     I              B0UWST                          WCUWST
     I              B0UXST                          WCUXST
     I              B0VSST                          WCVSST
     I              B0AATM                          WCAATM
     I              B0AYNA                          WCAYNA
     I              B0A0NA                          WCA0NA
     I              B0AXDT                          WCAXDT
      *
     IYARDCS      DS                            245
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Resync Itm Bal/Dtl XF
      * UPD Resync Itm Bal/Dtl RT - Item Balance  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * UPD Resync Itm Bal/Dtl RT - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0002 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0003 112       On Hand U/M1 Su
     C                     Z-ADD*ZERO     WN0004 112       On Hand U/M2 Su
     C                     Z-ADD*ZERO     WN0005 112       On Hand U/M3 Su
     C                     Z-ADD*ZERO     WN0006 112       Value of On Han
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADD960       WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@B0REJX                    *
     C           KRSSA     READE@B0REJX                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WN0001           Unit Cost Per P
      * RTV Sum Qty,Wgt,Value  RT - Item Balance Detail  * 
     C                     EXSR SBRVGN
      * CASE: PAR.On Hand Weight Summary NE WRK.ZERO
     C           WN0002    IFNE WUW0NB                     *IF
     C           WN0006    DIV  WN0002    WN0001    H      Unit Cost Per P
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0001           Unit Cost Per P
     C                     END                             *FI
      * Chg Item Balance       CH - Item Balance  * 
     C                     EXSR SCCHRC
     C           KRSSA     READE@B0REJX                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Sum Qty,Wgt,Value  RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0002           Quantity on Han
     C                     Z-ADD*ZERO     WN0003           Quantity on Han
     C                     Z-ADD*ZERO     WN0004           Quantity on Han
     C                     Z-ADD*ZERO     WN0005           Quantity on Han
     C                     Z-ADD*ZERO     WN0006           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
     C           *LIKE     DEFN WBAJCD    WQSB03           Warehouse Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
     C                     KFLD           WQSB03           Warehouse Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWAHGCD    WQSB02           Item Code
     C                     MOVELWAAJCD    WQSB03           Warehouse Code
      * Establish starting position
     C           KRSSB     SETLL@B1REJ0                    *
     C           KRSSB     READE@B1REJ0                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WBACWG    WN0002           Quantity on Han
     C                     ADD  WBARQT    WN0003           Quantity on Han
     C                     ADD  WBASQT    WN0004           Quantity on Han
     C                     ADD  WBATQT    WN0005           Quantity on Han
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Quantity on Hand - Weight is Not equal zero
      *   |- c2    : DB1.Quantity on Hand - U/M1 is not equal zero
      *   '-
     C           WBACWG    IFNE *ZERO                      *IF
     C           WBARQT    ORNE *ZERO                      *OR
     C                     ADD  WBIDVA    WN0006           Value of On Han
     C                     END                             *FI
     C           KRSSB     READE@B1REJ0                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Item Balance       CH - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0007  60       Job Time
     C                     MOVEL*BLANK    WN0008 10        User Id
     C                     MOVEL*BLANK    WN0009 10        Job Name
     C                     Z-ADD*ZERO     WN0010  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWAAIC3    WCAIC3           Company Number
     C                     Z-ADDWAHGCD    WCHGCD           Item Code
     C                     MOVELWAAJCD    WCAJCD    P      Warehouse Code
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
     C           KLCHSC    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YARDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWN0001    WCAGCS           Unit Cost Per P
     C                     Z-ADDWAAECS    WCAECS           Last Cost
     C                     Z-ADDWABACS    WCBACS           Cost per Primar
     C                     Z-ADDWABBCS    WCBBCS           Cost per Pricin
     C                     Z-ADDWACBPR    WCCBPR           Revaluation Cos
     C                     Z-ADDWAGUDT    WCGUDT           Revaluation Eff
     C                     MOVELWAXYST    WCXYST    P      Revaluation Cos
     C                     Z-ADDWACTPR    WCCTPR           Last Revaluatio
     C                     Z-ADDWAG4DT    WCG4DT           Last Revaluatio
     C                     Z-ADDWN0002    WCBOWG           On Hand Weight
     C                     Z-ADDWN0003    WCDDQT           On Hand U/M1 Su
     C                     Z-ADDWN0004    WCDEQT           On Hand U/M2 Su
     C                     Z-ADDWN0005    WCDFQT           On Hand U/M3 Su
     C                     Z-ADDWAHDQT    WCHDQT           Quantity In Chi
     C                     Z-ADDWAHEQT    WCHEQT           Weight In Chill
     C                     Z-ADDWAAJQT    WCAJQT           Quantity Schedu
     C                     Z-ADDWAAQQT    WCAQQT           Quantity on Sal
     C                     Z-ADDWAAUQT    WCAUQT           Quantity on Pur
     C                     Z-ADDWAEMQT    WCEMQT           Quantity on Tra
     C                     Z-ADDWN0003    WCDOQT           Quantity Avail.
     C                     MOVELWAATNA    WCATNA    P      Cycle Count Cod
     C                     Z-ADDWAAKDT    WCAKDT           Date of Last Or
     C                     Z-ADDWAANDT    WCANDT           Date of Last Sh
     C                     Z-ADDWN0006    WCIDVA           Value of On Han
     C                     MOVELWAJVST    WCJVST    P      Inventory Plann
     C                     Z-ADDWABZPC    WCBZPC           Safety Allowanc
     C                     Z-ADDWADGQT    WCDGQT           Safety Allowanc
     C                     Z-ADDWADIDT    WCDIDT           Stock Out Date
     C                     MOVELWAALCD    WCALCD    P      Buyer Code
     C                     Z-ADDWABFDY    WCBFDY           Lead Time - Las
     C                     Z-ADDWADJDT    WCDJDT           Lead Time - Dat
     C                     Z-ADDWABGDY    WCBGDY           Lead Time - Nex
     C                     Z-ADDWADKDT    WCDKDT           Lead Time - Dat
     C                     MOVELWAJ2ST    WCJ2ST    P      Lead Time - Exc
     C                     Z-ADDWADJQT    WCDJQT           Usage Qty per C
     C                     Z-ADDWABNWG    WCBNWG           Usage Weight pe
     C                     Z-ADDWADLDT    WCDLDT           Inventory Manag
     C                     Z-ADDWADPQT    WCDPQT           Minimum Quantit
     C                     Z-ADDWADQQT    WCDQQT           Maximum Quantit
     C                     Z-ADDWADMDT    WCDMDT           Last Physical C
     C                     MOVELWAM0ST    WCM0ST    P      Requisition Mod
     C                     MOVELWAJ9ST    WCJ9ST    P      Cost Update Pen
     C                     MOVELWAKBST    WCKBST    P      Post G/L Status
     C                     Z-ADDWAAKC8    WCAKC8           Vendor - Item/W
     C                     Z-ADDWARINB    WCRINB           Item Structure
     C                     Z-ADDWARHNB    WCRHNB           Item Structure
     C                     Z-ADDWARGNB    WCRGNB           Item Structure
     C                     MOVELWAUVST    WCUVST    P      EDI Status 1
     C                     MOVELWAUWST    WCUWST    P      EDI Status 2
     C                     MOVELWAUXST    WCUXST    P      EDI Status 3
     C                     MOVELWAVSST    WCVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WCAATM' defaulted for 'Job Time'.
      * Field '(DB1) WCAYNA' defaulted for 'User Id'.
      * Field '(DB1) WCA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WCAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAECS           Last Cost
     C                     Z-ADD*ZERO     WABACS           Cost per Primar
     C                     Z-ADD*ZERO     WABBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WACBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WAGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WACTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WAG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WABOWG           On Hand Weight
     C                     Z-ADD*ZERO     WADDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WADEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WADFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WAHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WAHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WAAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WAAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WAEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WADOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WAAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WAANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WAIDVA           Value of On Han
     C                     Z-ADD*ZERO     WABZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WADGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WADIDT           Stock Out Date
     C                     Z-ADD*ZERO     WABFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WADJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WABGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WADKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WADJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WABNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WADLDT           Inventory Manag
     C                     Z-ADD*ZERO     WADPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WADQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WADMDT           Last Physical C
     C                     Z-ADD*ZERO     WAAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBABWG           Physical Count
     C                     Z-ADD*ZERO     WBAGQT           Physical Count
     C                     Z-ADD*ZERO     WBAHQT           Physical Count
     C                     Z-ADD*ZERO     WBAIQT           Physical Count
     C                     Z-ADD*ZERO     WBACWG           Quantity on Han
     C                     Z-ADD*ZERO     WBARQT           Quantity on Han
     C                     Z-ADD*ZERO     WBASQT           Quantity on Han
     C                     Z-ADD*ZERO     WBATQT           Quantity on Han
     C                     Z-ADD*ZERO     WBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WBBMWG           Physical Start
     C                     Z-ADD*ZERO     WBDSQT           Physical Start
     C                     Z-ADD*ZERO     WBDTQT           Physical Start
     C                     Z-ADD*ZERO     WBDUQT           Physical Start
     C                     Z-ADD*ZERO     WBDHDT           Physical Start
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAECS           Last Cost
     C                     Z-ADD*ZERO     WBIDVA           Value of On Han
     C                     Z-ADD*ZERO     WBK7DT           Label Date
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
