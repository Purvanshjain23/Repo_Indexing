     H/TITLE UPD Price Audit Update XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/22/10  Time  : 17:09:48
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPLTIF  E           K        DISK
      * RSQ : Order Header TRG         Co/ShpTo/SSD(d) Not C/X
      *
     FOPBGWKL6IF  E           K        DISK
      * RSQ : Order Detail              Co/Order/Item
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FOPBGWKL5IF  E           K        DISK
      * RSQ : Order Detail              Co/Item/Whse/Req date
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL7IF  E           K        DISK
      * RSQ : Order Detail              Mkt Cd/Prc Date
      *
     FCABZRELDIF  E           K        DISK
      * RTV : Company Item              Active Items Only
      *
     FCABZRELLIF  E           K        DISK
      * RSQ : Company Item              Commodity Prc Grp/Item
      *
     FOPBGWKLCIF  E           K        DISK
      * RSQ : Order Detail              Item/Co/Order/Seq
      *
     I@BFCPZK
      * Order Header TRG         Co/ShpTo/SSD(d) Not C/X
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BGWKZL
      * Order Detail              Co/Order/Item
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@IHRERN
      * Price Method Header       Retrieval index
      * Renamed input format fields
     I              IHAIC3                          WCAIC3
     I              IHQ7CD                          WCQ7CD
     I              IHMLNA                          WCMLNA
     I              IHU0ST                          WCU0ST
     I              IHV8ST                          WCV8ST
     I              IHBYST                          WCBYST
     I              IHRMNY                          WCRMNY
     I              IHH3ST                          WCH3ST
     I              IHH5ST                          WCH5ST
     I              IHH6ST                          WCH6ST
     I              IHH7ST                          WCH7ST
     I              IHUVST                          WCUVST
     I              IHUWST                          WCUWST
     I              IHUXST                          WCUXST
     I              IHAATM                          WCAATM
     I              IHAYNA                          WCAYNA
     I              IHA0NA                          WCA0NA
     I              IHAXDT                          WCAXDT
      *
     I@BGWKF7
      * Order Detail              Co/Item/Whse/Req date
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BGWKZM
      * Order Detail              Mkt Cd/Prc Date
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@BZREZG
      * Company Item              Active Items Only
      * Renamed input format fields
     I              BZAIC3                          WGAIC3
     I              BZHGCD                          WGHGCD
     I              BZAVNA                          WGAVNA
     I              BZAWNA                          WGAWNA
     I              BZL7NA                          WGL7NA
     I              BZL8NA                          WGL8NA
     I              BZL6NA                          WGL6NA
     I              BZMFNA                          WGMFNA
     I              BZADCD                          WGADCD
     I              BZAWPC                          WGAWPC
     I              BZLXST                          WGLXST
     I              BZAECD                          WGAECD
     I              BZAXPC                          WGAXPC
     I              BZLYST                          WGLYST
     I              BZAFCD                          WGAFCD
     I              BZAICD                          WGAICD
     I              BZAIWG                          WGAIWG
     I              BZHICD                          WGHICD
     I              BZRBCD                          WGRBCD
     I              BZFZST                          WGFZST
     I              BZAVST                          WGAVST
     I              BZCZWG                          WGCZWG
     I              BZC0WG                          WGC0WG
     I              BZURTN                          WGURTN
     I              BZAJC8                          WGAJC8
     I              BZRINB                          WGRINB
     I              BZRHNB                          WGRHNB
     I              BZRGNB                          WGRGNB
     I              BZLNCD                          WGLNCD
     I              BZTFNB                          WGTFNB
     I              BZN0CD                          WGN0CD
     I              BZX4ST                          WGX4ST
     I              BZTMVA                          WGTMVA
     I              BZTNVA                          WGTNVA
     I              BZBLPR                          WGBLPR
     I              BZBMPR                          WGBMPR
     I              BZLRCD                          WGLRCD
     I              BZU9ST                          WGU9ST
     I              BZCMCO                          WGCMCO
     I              BZQ1CD                          WGQ1CD
     I              BZQ8CD                          WGQ8CD
     I              BZCHTM                          WGCHTM
     I              BZQZCD                          WGQZCD
     I              BZXWST                          WGXWST
     I              BZXXST                          WGXXST
     I              BZVMST                          WGVMST
     I              BZSWGH                          WGSWGH
     I              BZPPHE                          WGPPHE
     I              BZR3CD                          WGR3CD
     I              BZSDCD                          WGSDCD
     I              BZICN1                          WGICN1
     I              BZSVCD                          WGSVCD
     I              BZICN2                          WGICN2
     I              BZSWCD                          WGSWCD
     I              BZV2NB                          WGV2NB
     I              BZSXCD                          WGSXCD
     I              BZITCN                          WGITCN
     I              BZSYCD                          WGSYCD
     I              BZITC5                          WGITC5
     I              BZSZCD                          WGSZCD
     I              BZICN6                          WGICN6
     I              BZS0CD                          WGS0CD
     I              BZICN7                          WGICN7
     I              BZS1CD                          WGS1CD
     I              BZICN8                          WGICN8
     I              BZS2CD                          WGS2CD
     I              BZICN9                          WGICN9
     I              BZS3CD                          WGS3CD
     I              BZICN0                          WGICN0
     I              BZS4CD                          WGS4CD
     I              BZSFNB                          WGSFNB
     I              BZA3WG                          WGA3WG
     I              BZSJNB                          WGSJNB
     I              BZLLCD                          WGLLCD
     I              BZLMCD                          WGLMCD
     I              BZP3ST                          WGP3ST
     I              BZSKNB                          WGSKNB
     I              BZSLNB                          WGSLNB
     I              BZSMNB                          WGSMNB
     I              BZP4ST                          WGP4ST
     I              BZCFNB                          WGCFNB
     I              BZCGNB                          WGCGNB
     I              BZILNB                          WGILNB
     I              BZCHNB                          WGCHNB
     I              BZCINB                          WGCINB
     I              BZCJNB                          WGCJNB
     I              BZCMNB                          WGCMNB
     I              BZCNNB                          WGCNNB
     I              BZCRNB                          WGCRNB
     I              BZCSNB                          WGCSNB
     I              BZCVNB                          WGCVNB
     I              BZCWNB                          WGCWNB
     I              BZCXNB                          WGCXNB
     I              BZCZNB                          WGCZNB
     I              BZC0NB                          WGC0NB
     I              BZN1CD                          WGN1CD
     I              BZB4NB                          WGB4NB
     I              BZB5NB                          WGB5NB
     I              BZX5ST                          WGX5ST
     I              BZX6ST                          WGX6ST
     I              BZX7ST                          WGX7ST
     I              BZPCCT                          WGPCCT
     I              BZBDNB                          WGBDNB
     I              BZBJNB                          WGBJNB
     I              BZSUST                          WGSUST
     I              BZSVST                          WGSVST
     I              BZSYST                          WGSYST
     I              BZSZST                          WGSZST
     I              BZS1ST                          WGS1ST
     I              BZXRCD                          WGXRCD
     I              BZXTCD                          WGXTCD
     I              BZXUCD                          WGXUCD
     I              BZF5WG                          WGF5WG
     I              BZF6WG                          WGF6WG
     I              BZF7WG                          WGF7WG
     I              BZBLNB                          WGBLNB
     I              BZBNNB                          WGBNNB
     I              BZS2ST                          WGS2ST
     I              BZS4ST                          WGS4ST
     I              BZS5ST                          WGS5ST
     I              BZS6ST                          WGS6ST
     I              BZS8ST                          WGS8ST
     I              BZS9ST                          WGS9ST
     I              BZTCST                          WGTCST
     I              BZTDST                          WGTDST
     I              BZUVST                          WGUVST
     I              BZUWST                          WGUWST
     I              BZUXST                          WGUXST
     I              BZVSST                          WGVSST
     I              BZAATM                          WGAATM
     I              BZAYNA                          WGAYNA
     I              BZA0NA                          WGA0NA
     I              BZAXDT                          WGAXDT
      *
     I@BZREFL
      * Company Item              Commodity Prc Grp/Item
      * Renamed input format fields
     I              BZAIC3                          WHAIC3
     I              BZHGCD                          WHHGCD
     I              BZAVNA                          WHAVNA
     I              BZAWNA                          WHAWNA
     I              BZL7NA                          WHL7NA
     I              BZL8NA                          WHL8NA
     I              BZL6NA                          WHL6NA
     I              BZMFNA                          WHMFNA
     I              BZADCD                          WHADCD
     I              BZAWPC                          WHAWPC
     I              BZLXST                          WHLXST
     I              BZAECD                          WHAECD
     I              BZAXPC                          WHAXPC
     I              BZLYST                          WHLYST
     I              BZAFCD                          WHAFCD
     I              BZAICD                          WHAICD
     I              BZAIWG                          WHAIWG
     I              BZHICD                          WHHICD
     I              BZRBCD                          WHRBCD
     I              BZFZST                          WHFZST
     I              BZAVST                          WHAVST
     I              BZCZWG                          WHCZWG
     I              BZC0WG                          WHC0WG
     I              BZURTN                          WHURTN
     I              BZAJC8                          WHAJC8
     I              BZRINB                          WHRINB
     I              BZRHNB                          WHRHNB
     I              BZRGNB                          WHRGNB
     I              BZLNCD                          WHLNCD
     I              BZTFNB                          WHTFNB
     I              BZN0CD                          WHN0CD
     I              BZX4ST                          WHX4ST
     I              BZTMVA                          WHTMVA
     I              BZTNVA                          WHTNVA
     I              BZBLPR                          WHBLPR
     I              BZBMPR                          WHBMPR
     I              BZLRCD                          WHLRCD
     I              BZU9ST                          WHU9ST
     I              BZCMCO                          WHCMCO
     I              BZQ1CD                          WHQ1CD
     I              BZQ8CD                          WHQ8CD
     I              BZCHTM                          WHCHTM
     I              BZQZCD                          WHQZCD
     I              BZXWST                          WHXWST
     I              BZXXST                          WHXXST
     I              BZVMST                          WHVMST
     I              BZSWGH                          WHSWGH
     I              BZPPHE                          WHPPHE
     I              BZR3CD                          WHR3CD
     I              BZSDCD                          WHSDCD
     I              BZICN1                          WHICN1
     I              BZSVCD                          WHSVCD
     I              BZICN2                          WHICN2
     I              BZSWCD                          WHSWCD
     I              BZV2NB                          WHV2NB
     I              BZSXCD                          WHSXCD
     I              BZITCN                          WHITCN
     I              BZSYCD                          WHSYCD
     I              BZITC5                          WHITC5
     I              BZSZCD                          WHSZCD
     I              BZICN6                          WHICN6
     I              BZS0CD                          WHS0CD
     I              BZICN7                          WHICN7
     I              BZS1CD                          WHS1CD
     I              BZICN8                          WHICN8
     I              BZS2CD                          WHS2CD
     I              BZICN9                          WHICN9
     I              BZS3CD                          WHS3CD
     I              BZICN0                          WHICN0
     I              BZS4CD                          WHS4CD
     I              BZSFNB                          WHSFNB
     I              BZA3WG                          WHA3WG
     I              BZSJNB                          WHSJNB
     I              BZLLCD                          WHLLCD
     I              BZLMCD                          WHLMCD
     I              BZP3ST                          WHP3ST
     I              BZSKNB                          WHSKNB
     I              BZSLNB                          WHSLNB
     I              BZSMNB                          WHSMNB
     I              BZP4ST                          WHP4ST
     I              BZCFNB                          WHCFNB
     I              BZCGNB                          WHCGNB
     I              BZILNB                          WHILNB
     I              BZCHNB                          WHCHNB
     I              BZCINB                          WHCINB
     I              BZCJNB                          WHCJNB
     I              BZCMNB                          WHCMNB
     I              BZCNNB                          WHCNNB
     I              BZCRNB                          WHCRNB
     I              BZCSNB                          WHCSNB
     I              BZCVNB                          WHCVNB
     I              BZCWNB                          WHCWNB
     I              BZCXNB                          WHCXNB
     I              BZCZNB                          WHCZNB
     I              BZC0NB                          WHC0NB
     I              BZN1CD                          WHN1CD
     I              BZB4NB                          WHB4NB
     I              BZB5NB                          WHB5NB
     I              BZX5ST                          WHX5ST
     I              BZX6ST                          WHX6ST
     I              BZX7ST                          WHX7ST
     I              BZPCCT                          WHPCCT
     I              BZBDNB                          WHBDNB
     I              BZBJNB                          WHBJNB
     I              BZSUST                          WHSUST
     I              BZSVST                          WHSVST
     I              BZSYST                          WHSYST
     I              BZSZST                          WHSZST
     I              BZS1ST                          WHS1ST
     I              BZXRCD                          WHXRCD
     I              BZXTCD                          WHXTCD
     I              BZXUCD                          WHXUCD
     I              BZF5WG                          WHF5WG
     I              BZF6WG                          WHF6WG
     I              BZF7WG                          WHF7WG
     I              BZBLNB                          WHBLNB
     I              BZBNNB                          WHBNNB
     I              BZS2ST                          WHS2ST
     I              BZS4ST                          WHS4ST
     I              BZS5ST                          WHS5ST
     I              BZS6ST                          WHS6ST
     I              BZS8ST                          WHS8ST
     I              BZS9ST                          WHS9ST
     I              BZTCST                          WHTCST
     I              BZTDST                          WHTDST
     I              BZUVST                          WHUVST
     I              BZUWST                          WHUWST
     I              BZUXST                          WHUXST
     I              BZVSST                          WHVSST
     I              BZAATM                          WHAATM
     I              BZAYNA                          WHAYNA
     I              BZA0NA                          WHA0NA
     I              BZAXDT                          WHAXDT
      *
     I@BGWKFM
      * Order Detail              Item/Co/Order/Seq
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  File Name
     I                                        1  10 P1LBNA
      * I :  Company Number
     I                                    P  11  120P1AIC3
      * I :  Ship To Customer
     I                                    P  13  160P1BKC7
      * I :  Item Code
     I                                    P  17  200P1HGCD
      * I :  Commodity Market Code
     I                                       21  23 P1LQCD
      * I :  Commodity Price Group
     I                                       24  30 P1LRCD
      * I :  Market Price Date
     I                                    P  31  340P1EQDT
      * I :  USR Formula Meth Type Sts
     I                                       35  35 P1YKST
      * I :  USR Market Meth Type Sts
     I                                       36  36 P1YLST
      * I :  USR Manual Meth Type Sts
     I                                       37  37 P1YMST
      * I :  USR Extend Meth Type Sts
     I                                       38  38 P1YNST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1LBNA    PARM           WP0001 10        File Name
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1BKC7    PARM           WP0003  70       Ship To Custome
     C           P1HGCD    PARM           WP0004  70       Item Code
     C           P1LQCD    PARM           WP0005  3        Commodity Marke
     C           P1LRCD    PARM           WP0006  7        Commodity Price
     C           P1EQDT    PARM           WP0007  70       Market Price Da
     C           P1YKST    PARM           WP0008  1        USR Formula Met
     C           P1YLST    PARM           WP0009  1        USR Market Meth
     C           P1YMST    PARM           WP0010  1        USR Manual Meth
     C           P1YNST    PARM           WP0011  1        USR Extend Meth
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Price Audit Update XF
      * CASE: PAR.File Name is PD Customer/Item
     C           P1LBNA    IFEQ 'PDISREP'                  *IF
      * UPD Price Audit Scan   RT - PD Order Header  * 
     C                     EXSR SARVGN
     C                     ELSE
      * CASE: PAR.File Name is Item
     C           P1LBNA    IFEQ 'CABZREP'                  *IF
      * UPD Prc Audit-Item     RT - PD Order Detail  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: PAR.File Name is OM Commodity Mrkt Price
     C           P1LBNA    IFEQ 'OMF0CPP'                  *IF
      * UPD Prc Audit-Mkt Prc  RT - PD Order Detail  * 
     C                     EXSR SFRVGN
     C                     ELSE
      * CASE: PAR.File Name is OM Commodity Price Group
     C           P1LBNA    IFEQ 'OMFZREP'                  *IF
      * UPD Prc Audit-Comm Grp RT - Company/Item  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * UPD Price Audit Scan   RT - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Price Audit
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WABKC7    WQSA02           Ship To Custome
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Ship To Custome
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1BKC7    WQSA02           Ship To Custome
      * Establish starting position
     C           KRSSA     SETLL@BFCPZK                    *
     C           KRSSA     READE@BFCPZK                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * this will not pick up invoiced orders; only orders entered - ship
      * CASE: DB1.Billing Activity Type is Invoice
     C           WAOBST    IFEQ '1'                        *IF
      * CASE: PAR.Price Audit Reason Code is Customer/Item Change
     C           'CIT'     IFEQ 'CIT'                      *IF
      * UPD Prc Audit-Cust/Itm RT - PD Order Detail  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@BFCPZK                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * UPD Prc Audit-Cust/Itm RT - PD Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  1        Price Method Ty
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
     C           *LIKE     DEFN WBHGCD    WQSB03           Item Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           WQSB03           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWAC4NB    WQSB02           Order Number
     C                     Z-ADDP1HGCD    WQSB03           Item Code
      * Establish starting position
     C           KRSSB     SETLL@BGWKZL                    *
     C           KRSSB     READE@BGWKZL                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WBGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Price Meth Type    RT - PD Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     MOVELWBQ7CD    WL0002    P      Price Method Co
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0002    P      Price Method Ty
      * CASE: Match Method and Processing flag
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6) OR (c7 AND c8)
      *   |- c1    : PAR.Price Method Type is Formula Pricing
      *   |- c2    : PAR.USR Formula Meth Type Sts is yes
      *   |- c3    : PAR.Price Method Type is Market Pricing
      *   |- c4    : PAR.USR Market Meth Type Sts is yes
      *   |- c5    : PAR.Price Method Type is Manual Pricing
      *   |- c6    : PAR.USR Manual Meth Type Sts is yes
      *   |- c7    : PAR.Price Method Type is Extended Pricing
      *   |- c8    : PAR.USR Extend Meth Type Sts is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0002    IFEQ 'F'                        *IF
     C           P1YKST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0002    IFEQ 'K'                        *IF
     C           P1YLST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0002    IFEQ 'M'                        *IF
     C           P1YMST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0002    IFEQ 'X'                        *IF
     C           P1YNST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CLC Price/Price Audit  XF - PD Order Header  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0001  30       Company Number
     C                     PARM WBC4NB    WQ0002  70       Order Number
     C                     PARM WBDPNB    WQ0003  30       Order Sequence
     C                     PARM WBUENB    WQ0004  30       Order Secondary
     C                     PARM 'CIC'     WQ0005  3        Pricing Event C
     C           WUB5VL    PARM *ZERO     WQ0006 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0007 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0008  1        Production Hold
     C                     PARM '*NO'     WQ0009  4        USR New Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@BGWKZL                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Price Meth Type    RT - PD Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCQ7CD           Price Method Co
      * Setup key
     C                     Z-ADDWL0001    WCAIC3           Company Number
     C                     MOVELWL0002    WCQ7CD           Price Method Co
      * Establish starting position
     C           KRSSC     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Price Method Ty
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCV8ST    WL0003           Price Method Ty
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * UPD Prc Audit-Item     RT - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       Order Number
     C                     MOVEL*BLANK    WN0004  1        Price Audit
     C                     MOVEL*BLANK    WN0005  1        Price Method Ty
     C                     MOVEL*BLANK    WN0006  2        Event Code
     C                     MOVEL*BLANK    WN0007  1        Billing Activit
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0003           Order Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDHGCD    WQSD02           Item Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSD01           Company Number
     C                     Z-ADDP1HGCD    WQSD02           Item Code
      * Establish starting position
     C           KRSSD     SETLL@BGWKF7                    *
     C           KRSSD     READE@BGWKF7                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Check for new order
      * CASE: PAR.Order Number NE DB1.Order Number
     C           WN0003    IFNE WDC4NB                     *IF
      * RTV Bill Type, Event   RT - OP Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0004           Company Number
     C                     Z-ADDWDC4NB    WL0005           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WN0006    P      Event Code
     C                     MOVELWL0007    WN0007    P      Billing Activit
     C                     Z-ADDWDC4NB    WN0003           Order Number
     C                     END                             *FI
      * CASE: PAR.Billing Activity Type is Credit or Debit Memo
     C           WN0007    IFEQ '2'                        *IF
     C           WN0007    OREQ '3'
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           WN0007    IFEQ '4'                        *IF
     C                     ELSE
      * CASE: DB1.Detail Line Status is Cancelled
     C           WDGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: PAR.Event Code is Invoiced thru History
     C           WN0006    IFGE '06'                       *IF
     C           WN0006    ANDLE'07'
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Price Meth Type    RT - PD Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0001           Company Number
     C                     MOVELWDQ7CD    WL0002    P      Price Method Co
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0005    P      Price Method Ty
      * CASE: Match Method and Processing flag
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6) OR (c7 AND c8)
      *   |- c1    : PAR.Price Method Type is Formula Pricing
      *   |- c2    : PAR.USR Formula Meth Type Sts is yes
      *   |- c3    : PAR.Price Method Type is Market Pricing
      *   |- c4    : PAR.USR Market Meth Type Sts is yes
      *   |- c5    : PAR.Price Method Type is Manual Pricing
      *   |- c6    : PAR.USR Manual Meth Type Sts is yes
      *   |- c7    : PAR.Price Method Type is Extended Pricing
      *   |- c8    : PAR.USR Extend Meth Type Sts is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0005    IFEQ 'F'                        *IF
     C           P1YKST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0005    IFEQ 'K'                        *IF
     C           P1YLST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0005    IFEQ 'M'                        *IF
     C           P1YMST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0005    IFEQ 'X'                        *IF
     C           P1YNST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Commodity Market Code is Entered
     C           P1LQCD    IFNE *BLANK                     *IF
      * CASE: DB1.Commodity Market Code EQ PAR.Commodity Market Code
     C           WDLQCD    IFEQ P1LQCD                     *IF
      * CLC Price/Price Audit  XF - PD Order Header  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0010  30       Company Number
     C                     PARM WDC4NB    WQ0011  70       Order Number
     C                     PARM WDDPNB    WQ0012  30       Order Sequence
     C                     PARM WDUENB    WQ0013  30       Order Secondary
     C                     PARM 'IC'      WQ0014  3        Pricing Event C
     C           WUB5VL    PARM *ZERO     WQ0015 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0016 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0017  1        Production Hold
     C                     PARM '*NO'     WQ0018  4        USR New Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Price/Price Audit  XF - PD Order Header  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0019  30       Company Number
     C                     PARM WDC4NB    WQ0020  70       Order Number
     C                     PARM WDDPNB    WQ0021  30       Order Sequence
     C                     PARM WDUENB    WQ0022  30       Order Secondary
     C                     PARM 'IC'      WQ0023  3        Pricing Event C
     C           WUB5VL    PARM *ZERO     WQ0024 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0025 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0026  1        Production Hold
     C                     PARM '*NO'     WQ0027  4        USR New Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@BGWKF7                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Bill Type, Event   RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0004    WEAIC3           Company Number
     C                     Z-ADDWL0005    WEC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEJPCD    WL0006           Event Code
     C                     MOVELWEOBST    WL0007           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * UPD Prc Audit-Mkt Prc  RT - PD Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0008  1        Price Audit
     C                     MOVEL*BLANK    WN0009  1        Price Method Ty
     C                     Z-ADD*ZERO     WN0010  30       Company Number
     C                     Z-ADD*ZERO     WN0011  70       Order Number
     C                     MOVEL*BLANK    WN0012  2        Event Code
     C                     MOVEL*BLANK    WN0013  1        Billing Activit
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0010           Company Number
     C                     Z-ADD*ZERO     WN0011           Order Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFLQCD    WQSF01           Commodity Marke
     C           *LIKE     DEFN WFGIDT    WQSF02           Pricing Date Us
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Commodity Marke
     C                     KFLD           WQSF02           Pricing Date Us
      * Setup key
     C                     MOVELP1LQCD    WQSF01           Commodity Marke
     C                     Z-ADDP1EQDT    WQSF02           Pricing Date Us
      * Establish starting position
     C           KRSSF     SETLL@BGWKZM                    *
     C           KRSSF     READE@BGWKZM                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Order Number break
      * CASE: Company or Order break
      *  - c1 OR c2
      *   |- c1    : PAR.Accounting Company Number NE DB1.Accounting Comp
      *   |- c2    : PAR.Order Number NE DB1.Order Number
      *   '-
     C           WN0010    IFNE WFAIC3                     *IF
     C           WN0011    ORNE WFC4NB                     *OR
      * RTV Bill Type, Event   RT - OP Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0004           Company Number
     C                     Z-ADDWFC4NB    WL0005           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WN0012    P      Event Code
     C                     MOVELWL0007    WN0013    P      Billing Activit
     C                     Z-ADDWFAIC3    WN0010           Company Number
     C                     Z-ADDWFC4NB    WN0011           Order Number
     C                     END                             *FI
      * CASE: PAR.Billing Activity Type is Credit or Debit Memo
     C           WN0013    IFEQ '2'                        *IF
     C           WN0013    OREQ '3'
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           WN0013    IFEQ '4'                        *IF
     C                     ELSE
      * CASE: PAR.Event Code is Invoiced thru History
     C           WN0012    IFGE '06'                       *IF
     C           WN0012    ANDLE'07'
     C                     ELSE
      * CASE: DB1.Detail Line Status is Cancelled
     C           WFGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Price Meth Type    RT - PD Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0001           Company Number
     C                     MOVELWFQ7CD    WL0002    P      Price Method Co
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0009    P      Price Method Ty
      * CASE: Match Method and Processing flag
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6) OR (c7 AND c8)
      *   |- c1    : PAR.Price Method Type is Formula Pricing
      *   |- c2    : PAR.USR Formula Meth Type Sts is yes
      *   |- c3    : PAR.Price Method Type is Market Pricing
      *   |- c4    : PAR.USR Market Meth Type Sts is yes
      *   |- c5    : PAR.Price Method Type is Manual Pricing
      *   |- c6    : PAR.USR Manual Meth Type Sts is yes
      *   |- c7    : PAR.Price Method Type is Extended Pricing
      *   |- c8    : PAR.USR Extend Meth Type Sts is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0009    IFEQ 'F'                        *IF
     C           P1YKST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0009    IFEQ 'K'                        *IF
     C           P1YLST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0009    IFEQ 'M'                        *IF
     C           P1YMST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0009    IFEQ 'X'                        *IF
     C           P1YNST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Commod Price Group RT - Company/Item  * 
     C                     EXSR SGRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: WRK.Commodity Price Group EQ PAR.Commodity Price Group
     C           WULRCD    IFEQ P1LRCD                     *IF
      * CLC Price/Price Audit  XF - PD Order Header  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WFAIC3    WQ0028  30       Company Number
     C                     PARM WFC4NB    WQ0029  70       Order Number
     C                     PARM WFDPNB    WQ0030  30       Order Sequence
     C                     PARM WFUENB    WQ0031  30       Order Secondary
     C                     PARM 'MPC'     WQ0032  3        Pricing Event C
     C           WUB5VL    PARM *ZERO     WQ0033 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0034 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0035  1        Production Hold
     C                     PARM '*NO'     WQ0036  4        USR New Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@BGWKZM                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Commod Price Group RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREZG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WULRCD           Commodity Price
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGLRCD    WULRCD           Commodity Price
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * UPD Prc Audit-Comm Grp RT - Company/Item  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0014  1        Price Audit
     C                     MOVEL*BLANK    WN0015  1        Price Method Ty
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHLRCD    WQSH01           Commodity Price
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Commodity Price
      * Setup key
     C                     MOVELP1LRCD    WQSH01           Commodity Price
      * Establish starting position
     C           KRSSH     SETLL@BZREFL                    *
     C           KRSSH     READE@BZREFL                  90*
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WHVSST    IFEQ 'A'                        *IF
      * UPD Prc Audit-Comm Grp RT - PD Order Detail  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C           KRSSH     READE@BZREFL                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * UPD Prc Audit-Comm Grp RT - PD Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0016  1        Price Audit
     C                     MOVEL*BLANK    WN0017  1        Price Method Ty
     C                     Z-ADD*ZERO     WN0018  30       Company Number
     C                     Z-ADD*ZERO     WN0019  70       Order Number
     C                     MOVEL*BLANK    WN0020  2        Event Code
     C                     MOVEL*BLANK    WN0021  1        Billing Activit
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0018           Company Number
     C                     Z-ADD*ZERO     WN0019           Order Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHGCD    WQSI01           Item Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Item Code
      * Setup key
     C                     Z-ADDWHHGCD    WQSI01           Item Code
      * Establish starting position
     C           KRSSI     SETLL@BGWKFM                    *
     C           KRSSI     READE@BGWKFM                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Order Number break
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Accounting Company Number NE DB1.Accounting Comp
      *   |- c2    : PAR.Order Number NE DB1.Order Number
      *   '-
     C           WN0018    IFNE WIAIC3                     *IF
     C           WN0019    ORNE WIC4NB                     *OR
      * RTV Bill Type, Event   RT - OP Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIC3    WL0004           Company Number
     C                     Z-ADDWIC4NB    WL0005           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WN0020    P      Event Code
     C                     MOVELWL0007    WN0021    P      Billing Activit
     C                     Z-ADDWIAIC3    WN0018           Company Number
     C                     Z-ADDWIC4NB    WN0019           Order Number
     C                     END                             *FI
      * CASE: PAR.Billing Activity Type is Credit or Debit Memo
     C           WN0021    IFEQ '2'                        *IF
     C           WN0021    OREQ '3'
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           WN0021    IFEQ '4'                        *IF
     C                     ELSE
      * CASE: DB1.Event Code is Invoiced thru History
     C           WIJPCD    IFGE '06'                       *IF
     C           WIJPCD    ANDLE'07'
     C                     ELSE
      * CASE: DB1.Detail Line Status is Cancelled
     C           WIGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Price Meth Type    RT - PD Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIC3    WL0001           Company Number
     C                     MOVELWIQ7CD    WL0002    P      Price Method Co
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0017    P      Price Method Ty
      * CASE: Match Method and Processing flag
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6) OR (c7 AND c8)
      *   |- c1    : PAR.Price Method Type is Formula Pricing
      *   |- c2    : PAR.USR Formula Meth Type Sts is yes
      *   |- c3    : PAR.Price Method Type is Market Pricing
      *   |- c4    : PAR.USR Market Meth Type Sts is yes
      *   |- c5    : PAR.Price Method Type is Manual Pricing
      *   |- c6    : PAR.USR Manual Meth Type Sts is yes
      *   |- c7    : PAR.Price Method Type is Extended Pricing
      *   |- c8    : PAR.USR Extend Meth Type Sts is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0017    IFEQ 'F'                        *IF
     C           P1YKST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0017    IFEQ 'K'                        *IF
     C           P1YLST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0017    IFEQ 'M'                        *IF
     C           P1YMST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0017    IFEQ 'X'                        *IF
     C           P1YNST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CLC Price/Price Audit  XF - PD Order Header  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WIAIC3    WQ0037  30       Company Number
     C                     PARM WIC4NB    WQ0038  70       Order Number
     C                     PARM WIDPNB    WQ0039  30       Order Sequence
     C                     PARM WIUENB    WQ0040  30       Order Secondary
     C                     PARM 'MGC'     WQ0041  3        Pricing Event C
     C           WUB5VL    PARM *ZERO     WQ0042 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0043 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0044  1        Production Hold
     C                     PARM '*NO'     WQ0045  4        USR New Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@BGWKFM                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Unused Date
     C                     Z-ADD*ZERO     WANPDT           OH Unused Date
     C                     Z-ADD*ZERO     WANQDT           OH Unused Date
     C                     Z-ADD*ZERO     WANRDT           OH Unused Date
     C                     Z-ADD*ZERO     WANSDT           OH Unused Date
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Unused Time
     C                     Z-ADD*ZERO     WABSTM           OH Unused Time
     C                     Z-ADD*ZERO     WABTTM           OH Unused Time
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WBDWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WBDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WBDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WBDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WBGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WBTLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WBTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCRMNY           Decimal Places
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Unused Parm - Value   USR
     C                     Z-ADD*ZERO     WUB5VL 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Production Hold
     C                     MOVEL*BLANK    WUXJST  1
      * Define work field Commodity Price Group
     C                     MOVEL*BLANK    WULRCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WGAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WGAIWG           Unit Weight
     C                     Z-ADD*ZERO     WGCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WGC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WGURTN           Number Cases On
     C                     Z-ADD*ZERO     WGAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGTFNB           Transportation
     C                     Z-ADD*ZERO     WGTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WGTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WGBLPR           Market Overage
     C                     Z-ADD*ZERO     WGBMPR           Standard Overag
     C                     Z-ADD*ZERO     WGCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WGCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WGSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WGPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WGICN1           Item Category N
     C                     Z-ADD*ZERO     WGICN2           Item Category N
     C                     Z-ADD*ZERO     WGV2NB           Item Category N
     C                     Z-ADD*ZERO     WGITCN           Item Category N
     C                     Z-ADD*ZERO     WGITC5           Item Category N
     C                     Z-ADD*ZERO     WGICN6           Item Category N
     C                     Z-ADD*ZERO     WGICN7           Item Category N
     C                     Z-ADD*ZERO     WGICN8           Item Category N
     C                     Z-ADD*ZERO     WGICN9           Item Category N
     C                     Z-ADD*ZERO     WGICN0           Item Category N
     C                     Z-ADD*ZERO     WGSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WGA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WGSJNB           Production Lead
     C                     Z-ADD*ZERO     WGSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WGSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WGSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WGCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WGCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WGILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WGCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WGCINB           PM Batch Size
     C                     Z-ADD*ZERO     WGCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WGCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WGCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WGCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WGCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WGCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WGCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WGCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WGCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WGC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WGB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WGB5NB           PM Line Number
     C                     Z-ADD*ZERO     WGBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WGBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WGF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WGF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WGF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WGBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WGBNNB           Production Qty
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  2
     C                     MOVEL*BLANK    WL0007  1
      *================================================================
     CSR         ZZEXIT    ENDSR
