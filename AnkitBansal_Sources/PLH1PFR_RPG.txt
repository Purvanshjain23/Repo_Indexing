     H/TITLE ZZPrt EDI Carc Sum/DtlPF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 02/02/21  Time  : 13:04:16
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKD3CPL4IF  E           K        DISK
      * RSQ : EDI Carcass Summary       Co/KillDt(d)/Prod
      *
     FPKD4CPL1IF  E           K        DISK
      * RTV : EDI Carcass Detail        Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPLH1PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: ZZPrt EDI Carc Sum/DtlPF  Print file
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             12
      * KEY: EDI Carcass Summary       Co/KillDt(d)/Prod
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: EDI Carcas
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * ZZPrt EDI Carc Sum/DtlPF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$LENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * ZZPrt EDI Carc Sum/DtlPF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN D3HMNB    WQKA01           BOH Company Num
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
      * Establish starting position
     C           KRSA      SETLL@D3CPE6                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Kill Date
     C                     MOVEL'Y'       W0AL02  1        PD Producer Cod
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDD3HMNB    $DHMNB           BOH Company Num
     C                     Z-ADDD3B0DT    $DB0DT           TH Kill Date
      * Load related totals format
     C                     Z-ADDD3HMNB    $KHMNB           BOH Company Num
     C                     Z-ADDD3B0DT    $KB0DT           TH Kill Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDD3HMNB    $EHMNB           BOH Company Num
     C                     Z-ADDD3B0DT    $EB0DT           TH Kill Date
     C                     MOVELD3ABCD    $EABCD           PD Producer Cod
      * Load related totals format
     C                     Z-ADDD3HMNB    $JHMNB           BOH Company Num
     C                     Z-ADDD3B0DT    $JB0DT           TH Kill Date
     C                     MOVELD3ABCD    $JABCD           PD Producer Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDD3HMNB    $FHMNB           BOH Company Num
     C                     Z-ADDD3BNNB    $FBNNB           BOH Buy Order N
     C                     Z-ADDD3BONB    $FBONB           BOL Load Number
     C                     Z-ADDD3CVNB    $FCVNB           TH Tattoo Numbe
     C                     Z-ADDD3B0DT    $FB0DT           TH Kill Date
     C                     Z-ADDD3ARDT    $FARDT           BOH Buy Order D
     C                     Z-ADDD3AWDT    $FAWDT           TH Purchase Dat
     C                     Z-ADDD3HGNB    $FHGNB           TH Shipped Weig
     C                     Z-ADDD3OXNB    $FOXNB           TH HPS Movement
     C                     MOVELD3BICD    $FBICD           TH Group Refere
     C                     MOVELD3ACCD    $FACCD           HB Buyer Code
     C                     MOVELD3J9ST    $FJ9ST           TH Payment Type
     C                     MOVELD3BECD    $FBECD           HC Class Code
     C                     MOVELD3ADCD    $FADCD           Commission Prod
     C                     MOVELD3ABCD    $FABCD           PD Producer Cod
     C                     MOVELD3AECD    $FAECD           PL Location Cod
     C                     MOVELD3DKSS    $FDKSS           EDI Load Type
     C                     MOVELD3NYCD    $FNYCD           PS Site ID
     C                     Z-ADDD3LLA1    $FLLA1           PSM Miles to Co
     C                     Z-ADDD3ECDT    $FECDT           TH Head LFT
     C                     Z-ADDD3EDDT    $FEDDT           TH Head EUT/KOA
     C                     Z-ADDD3CXNB    $FCXNB           TH Dead On Arri
     C                     Z-ADDD3CWNB    $FCWNB           TH Head Receive
     C                     Z-ADDD3FCNB    $FFCNB           TH Yard Deads
     C                     Z-ADDD3FDNB    $FFDNB           TH Head Condemn
     C                     Z-ADDD3FENB    $FFENB           TH Head Killed
     C                     Z-ADDD3HENB    $FHENB           TH Head Adds
     C                     Z-ADDD3CYNB    $FCYNB           TH Live Wgt
     C                     Z-ADDD3E0NB    $FE0NB           TH Hot Wgt
     C                     Z-ADDD3LRNB    $FLRNB           TH Adj Live Wgt
     C                     Z-ADDD3F7NB    $FF7NB           TH Avg Live Wgt
     C                     Z-ADDD3HDNB    $FHDNB           TH Avg Hot Wgt
     C                     Z-ADDD3F4NB    $FF4NB           TH Avg Lean Per
     C                     Z-ADDD3F2NB    $FF2NB           TH Avg Backfat
     C                     Z-ADDD3F3NB    $FF3NB           TH Avg Loin Eye
     C                     Z-ADDD3AWPC    $FAWPC           TH Actual Yield
     C                     Z-ADDD3CWPC    $FCWPC           TH Adj Actual Y
     C                     Z-ADDD3VZPR    $FVZPR           USDA Pork Cutou
     C                     Z-ADDD3LZA1    $FLZA1           Carcass Base Pr
     C                     Z-ADDD3V0PR    $FV0PR           Break Even Pric
     C                     Z-ADDD3L0A1    $FL0A1           Break Even Pric
     C                     Z-ADDD3LYA1    $FLYA1           Avg Meat Value
     C                     Z-ADDD3KFOR    $FKFOR           TH Meat Value F
     C                     Z-ADDD3V1PR    $FV1PR           MeatVal Factr A
     C                     Z-ADDD3A2PR    $FA2PR           TH Fixed Cost A
     C                     Z-ADDD3V2PR    $FV2PR           Fixed Cost Fctr
     C                     Z-ADDD3AMPR    $FAMPR           TH CM Base Mkt
     C                     Z-ADDD3ANPR    $FANPR           TH CM Base Mkt
     C                     Z-ADDD3D6PR    $FD6PR           TH CM Bse Mkt L
     C                     Z-ADDD3D7PR    $FD7PR           TH CM Bse Mkt C
     C                     Z-ADDD3AYVA    $FAYVA           TH CM Sort Disc
     C                     Z-ADDD3D8PR    $FD8PR           TH CM Srt Dsc L
     C                     Z-ADDD3D9PR    $FD9PR           TH CM Srt Dsc C
     C                     Z-ADDD3AWVA    $FAWVA           TH CM Yield Gai
     C                     Z-ADDD3EAPR    $FEAPR           TH CM Yld G/L L
     C                     Z-ADDD3EBPR    $FEBPR           TH CM Yld G/L C
     C                     Z-ADDD3AOPR    $FAOPR           TH CM Base Carc
     C                     Z-ADDD3ECPR    $FECPR           TH CM Crc Val L
     C                     Z-ADDD3EDPR    $FEDPR           TH CM Crc Val C
     C                     Z-ADDD3AXVA    $FAXVA           TH CM LN AddOn/
     C                     Z-ADDD3EEPR    $FEEPR           TH CM Lean Prem
     C                     Z-ADDD3EFPR    $FEFPR           TH CM Lean Prem
     C                     Z-ADDD3CBPR    $FCBPR           TH Payment Gros
     C                     Z-ADDD3EGPR    $FEGPR           TH CM Gross Liv
     C                     Z-ADDD3EHPR    $FEHPR           TH CM Gross Car
     C                     Z-ADDD3CCPR    $FCCPR           Th Payment Net
     C                     MOVELD3NDCD    $FNDCD           Deduction Code
     C                     Z-ADDD3VRPR    $FVRPR           Deduction Unit
     C                     MOVELD3Z8ST    $FZ8ST           Deduction UOM 1
     C                     MOVELD3M1TX    $FM1TX           Deduction Desc
     C                     Z-ADDD3M5PR    $FM5PR           Deduction Amt 1
     C                     MOVELD3NECD    $FNECD           Deduction Code
     C                     Z-ADDD3VSPR    $FVSPR           Deduction Unit
     C                     MOVELD3Z9ST    $FZ9ST           Deduction UOM 2
     C                     MOVELD3M2TX    $FM2TX           Deduction Desc
     C                     Z-ADDD3M6PR    $FM6PR           Deduction Amt 2
     C                     MOVELD3NFCD    $FNFCD           Deduction Code
     C                     Z-ADDD3VTPR    $FVTPR           Deduction Unit
     C                     MOVELD3AASS    $FAASS           Deduction UOM 3
     C                     MOVELD3M3TX    $FM3TX           Deduction Desc
     C                     Z-ADDD3M7PR    $FM7PR           Deduction Amt 3
     C                     MOVELD3NGCD    $FNGCD           Deduction Code
     C                     Z-ADDD3VUPR    $FVUPR           Deduction Unit
     C                     MOVELD3ABSS    $FABSS           Deduction UOM 4
     C                     MOVELD3M4TX    $FM4TX           Deduction Desc
     C                     Z-ADDD3M8PR    $FM8PR           Deduction Amt 4
     C                     MOVELD3NHCD    $FNHCD           Deduction Code
     C                     Z-ADDD3VVPR    $FVVPR           Deduction Unit
     C                     MOVELD3ACSS    $FACSS           Deduction UOM 5
     C                     MOVELD3M5TX    $FM5TX           Deduction Desc
     C                     Z-ADDD3M9PR    $FM9PR           Deduction Amt 5
     C                     MOVELD3NICD    $FNICD           Deduction Code
     C                     Z-ADDD3VWPR    $FVWPR           Deduction Unit
     C                     MOVELD3ADSS    $FADSS           Deduction UOM 6
     C                     MOVELD3M6TX    $FM6TX           Deduction Desc
     C                     Z-ADDD3NAPR    $FNAPR           Deduction Amt 6
     C                     MOVELD3NJCD    $FNJCD           Addition Code 1
     C                     Z-ADDD3VXPR    $FVXPR           Addition Unit A
     C                     MOVELD3AESS    $FAESS           Addition UOM 1
     C                     MOVELD3M7TX    $FM7TX           Addition Desc 1
     C                     Z-ADDD3NBPR    $FNBPR           Addition Amt 1
     C                     MOVELD3NKCD    $FNKCD           Addition Code 2
     C                     Z-ADDD3VYPR    $FVYPR           Addition Unit A
     C                     MOVELD3AFSS    $FAFSS           Addition UOM 2
     C                     MOVELD3M8TX    $FM8TX           Addition Desc 2
     C                     Z-ADDD3NCPR    $FNCPR           Addition Amt 2
     C                     MOVELD3M9TX    $FM9TX           Condemned Reaso
     C                     Z-ADDD3CN1R    $FCN1R           Condemned Reaso
     C                     MOVELD3NATX    $FNATX           Condemned Reaso
     C                     Z-ADDD3CN2R    $FCN2R           Condemned Reaso
     C                     MOVELD3NBTX    $FNBTX           Condemned Reaso
     C                     Z-ADDD3CN3R    $FCN3R           Condemned Reaso
     C                     MOVELD3NCTX    $FNCTX           Condemned Reaso
     C                     Z-ADDD3CN4R    $FCN4R           Condemned Reaso
     C                     MOVELD3NDTX    $FNDTX           Condemned Reaso
     C                     Z-ADDD3CN5R    $FCN5R           Condemned Reaso
     C                     MOVELD3O5TX    $FO5TX           Defect Reason 1
     C                     Z-ADDD3DFH1    $FDFH1           Defect Head 1
     C                     MOVELD3O6TX    $FO6TX           Defect Reason 2
     C                     Z-ADDD3DFH2    $FDFH2           Defect Head 2
     C                     MOVELD3O7TX    $FO7TX           Defect Reason 3
     C                     Z-ADDD3DFH3    $FDFH3           Defect Head 3
     C                     MOVELD3O8TX    $FO8TX           Defect Reason 4
     C                     Z-ADDD3DFH4    $FDFH4           Defect Head 4
     C                     MOVELD3O9TX    $FO9TX           Defect Reason 5
     C                     Z-ADDD3DFH5    $FDFH5           Defect Head 5
     C                     Z-ADDD3LTBF    $FLTBF           TH Min LT Backf
     C                     Z-ADDD3HZPC    $FHZPC           TH Min LT LoinE
     C                     Z-ADDD3LTHW    $FLTHW           TH Min LT Hot W
     C                     Z-ADDD3H0PC    $FH0PC           TH Min LT Lean
     C                     Z-ADDD3GTBF    $FGTBF           TH Max GT Backf
     C                     Z-ADDD3H1PC    $FH1PC           TH Max GT LoinE
     C                     Z-ADDD3GTHW    $FGTHW           TH Max GT Hot W
     C                     Z-ADDD3H2PC    $FH2PC           TH Max GT Lean
     C                     Z-ADDD3HLBF    $FHLBF           TH Head LT Back
     C                     Z-ADDD3HLLE    $FHLLE           TH Head LT Loin
     C                     Z-ADDD3HLHW    $FHLHW           TH Head LT Hot
     C                     Z-ADDD3HLLP    $FHLLP           TH Head LT Lean
     C                     Z-ADDD3HGBF    $FHGBF           TH Head GT Back
     C                     Z-ADDD3HGLE    $FHGLE           TH Head GT Loin
     C                     Z-ADDD3HGHW    $FHGHW           TH Head GT Hot
     C                     Z-ADDD3HFLP    $FHFLP           TH Head GT Lean
     C                     Z-ADDD3J9NB    $FJ9NB           TH Head Exclude
     C                     Z-ADDD3TBPR    $FTBPR           TH Excluded Gro
     C                     Z-ADDD3IORP    $FIORP           TH Head Adjuste
     C                     Z-ADDD3OWEO    $FOWEO           TH PHA Head Add
     C                     Z-ADDD3HHPC    $FHHPC           TH PHA Yield Pe
     C                     Z-ADDD3S9PR    $FS9PR           TH PHA Lean Prm
     C                     MOVELD3PQTX    $FPQTX           TH Head Add Rea
     C                     MOVELD3NLCD    $FNLCD           DTS Hog Group C
     C                     MOVELD3NMCD    $FNMCD           DTS Building 1
     C                     MOVELD3NNCD    $FNNCD           DTS Room 1
     C                     Z-ADDD3L1A1    $FL1A1           DTS Delivered H
     C                     MOVELD3NOCD    $FNOCD           DTS Hog Group C
     C                     MOVELD3NPCD    $FNPCD           DTS Building 2
     C                     MOVELD3NQCD    $FNQCD           DTS Room 2
     C                     Z-ADDD3L2A1    $FL2A1           DTS Delivered H
     C                     MOVELD3NRCD    $FNRCD           DTS Hog Group C
     C                     MOVELD3NSCD    $FNSCD           DTS Building 3
     C                     MOVELD3NTCD    $FNTCD           DTS Room 3
     C                     Z-ADDD3L3A1    $FL3A1           DTS Delivered H
     C                     MOVELD3NUCD    $FNUCD           DTS Hog Group C
     C                     MOVELD3NVCD    $FNVCD           DTS Building 4
     C                     MOVELD3NWCD    $FNWCD           DTS Room 4
     C                     Z-ADDD3L4A1    $FL4A1           DTS Delivered H
     C                     Z-ADDD3MVNF    $FMVNF           TH Avg Loin Eye
     C                     Z-ADDD3MCNF    $FMCNF           TH Avg Backfat
     C                     Z-ADDD3EDTP    $FEDTP           EDI Trading Par
     C                     MOVELD3QMST    $FQMST           EDI Process Sta
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt EDI Carc Detail   PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN D3HMNB    WZA001           BOH Company Num
     C                     Z-ADDD3HMNB    WZA001
     C           *LIKE     DEFN D3B0DT    WZA002           TH Kill Date
     C                     Z-ADDD3B0DT    WZA002
     C           *LIKE     DEFN D3ABCD    WZA003           PD Producer Cod
     C                     MOVELD3ABCD    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@D3CPE6                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * RTV Tattoo Record     RT - Tattoo Header  * 
     C                     EXSR SARVGN
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        TH Kill Date
     C                     MOVEL*BLANK    W0AL02  1        PD Producer Cod
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Kill Date
     C                     MOVEL'Y'       W0AL02  1        PD Producer Cod
     C                     ELSE
      * Next record - Detect level breaks
     C           D3HMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           D3B0DT    IFNE WZA002                     TH Kill Date
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           D3ABCD    IFNE WZA003                     PD Producer Cod
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $KB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VKB0DT
      * Print format
     C                     WRITE$KKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt EDI Carc Detail   PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN D4HMNB    WQKB01           BOH Company Num
     C           *LIKE     DEFN D4BNNB    WQKB02           BOH Buy Order N
     C           *LIKE     DEFN D4BONB    WQKB03           BOL Load Number
     C           *LIKE     DEFN D4CVNB    WQKB04           TH Tattoo Numbe
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           BOH Buy Order N
     C                     KFLD           WQKB03           BOL Load Number
     C                     KFLD           WQKB04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDD3HMNB    WQKB01           BOH Company Num
     C                     Z-ADDD3BNNB    WQKB02           BOH Buy Order N
     C                     Z-ADDD3BONB    WQKB03           BOL Load Number
     C                     Z-ADDD3CVNB    WQKB04           TH Tattoo Numbe
      * Establish starting position
     C           KRSB      SETLL@D4CPYT                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDD4HMNB    $IHMNB           BOH Company Num
     C                     Z-ADDD4BNNB    $IBNNB           BOH Buy Order N
     C                     Z-ADDD4BONB    $IBONB           BOL Load Number
     C                     Z-ADDD4CVNB    $ICVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     $ICEA1           Carcass Count 2
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDD4HMNB    $HHMNB           BOH Company Num
     C                     Z-ADDD4BNNB    $HBNNB           BOH Buy Order N
     C                     Z-ADDD4BONB    $HBONB           BOL Load Number
     C                     Z-ADDD4CVNB    $HCVNB           TH Tattoo Numbe
     C                     Z-ADDD4B0DT    $HB0DT           TH Kill Date
     C                     MOVELD4INST    $HINST           CD Record Add/D
     C                     Z-ADDD4ASPC    $HASPC           CD STD Yield
     C                     Z-ADDD4EWNB    $HEWNB           CD Carcass/Hot
     C                     Z-ADDD4AUPC    $HAUPC           CD Lean Percent
     C                     Z-ADDD4V4PR    $HV4PR           Sort Factor
     C                     Z-ADDD4ORJE    $HORJE           CD Lean Prem/Di
     C                     Z-ADDD4IJGR    $HIJGR           CD Meat Value F
     C                     Z-ADDD4IEUF    $HIEUF           CD Meat Value F
     C                     Z-ADDD4V1PR    $HV1PR           MeatVal Factr A
     C                     Z-ADDD4OTJR    $HOTJR           CD Fixed Cost F
     C                     Z-ADDD4ORUE    $HORUE           CD Fixed Cost F
     C                     Z-ADDD4V2PR    $HV2PR           Fixed Cost Fctr
     C                     Z-ADDD4NDPR    $HNDPR           CD Sort Discoun
     C                     Z-ADDD4NEPR    $HNEPR           CD Sort Discoun
     C                     Z-ADDD4EYNB    $HEYNB           CD Crc Value Pe
     C                     Z-ADDD4AVPR    $HAVPR           CD Crc Value $
     C                     Z-ADDD4AWPR    $HAWPR           CD Lean Premium
     C                     Z-ADDD4AXPR    $HAXPR           CD Lean Premium
     C                     Z-ADDD4EZNB    $HEZNB           CD Gross Value
     C                     Z-ADDD4AYPR    $HAYPR           CD Gross Value
     C                     MOVELD4GDST    $HGDST           CD Trim Area
     C                     Z-ADDD4BKDP    $HBKDP           Backfat Depth
     C                     Z-ADDD4G1PC    $HG1PC           Loin-eye Depth
     C                     MOVELD4UTST    $HUTST           CD Adjust/Add T
     C                     Z-ADDD4EDTP    $HEDTP           EDI Trading Par
     C                     MOVELD4QMST    $HQMST           EDI Process Sta
     C                     Z-ADDD4EUNB    $HEUNB           CD Carcass Numb
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN D4HMNB    WZB001           BOH Company Num
     C                     Z-ADDD4HMNB    WZB001
     C           *LIKE     DEFN D4BNNB    WZB002           BOH Buy Order N
     C                     Z-ADDD4BNNB    WZB002
     C           *LIKE     DEFN D4BONB    WZB003           BOL Load Number
     C                     Z-ADDD4BONB    WZB003
     C           *LIKE     DEFN D4CVNB    WZB004           TH Tattoo Numbe
     C                     Z-ADDD4CVNB    WZB004
     C           *LIKE     DEFN D4B0DT    WZB005           TH Kill Date
     C                     Z-ADDD4B0DT    WZB005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@D4CPYT                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0BL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0BL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0BL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0BL04  1        TH Kill Date
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           D4HMNB    IFNE WZB001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           D4BNNB    IFNE WZB002                     BOH Buy Order N
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           D4BONB    IFNE WZB003                     BOL Load Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           D4CVNB    IFNE WZB004                     TH Tattoo Numbe
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           D4B0DT    IFNE WZB005                     TH Kill Date
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Tattoo Number format
     C                     Z-ADDYL0001    $ICEA1           Carcass Count 2
     C                     Z-ADD*ZERO     YL0001           Carcass Count U
     C           D3FENB    SUB  $ICEA1    YL0002           Count USR 2
      * CASE: LCL.Count USR 2 is Entered
     C           YL0002    IFNE *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           YL0002    IFNE *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$IKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of ZZPrt EDI Carc Sum/DtlPF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of ZZPrt EDI Carc Sum/DtlPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of ZZPrt EDI Carc Sum/DtlPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print TH Kill Date of ZZPrt EDI Carc Sum/DtlPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$DKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print PD Producer Code of ZZPrt EDI Carc Sum/DtlPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$EKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of ZZPrt EDI Carc Sum/DtlPF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PGM.*Print format is Do not print format
     C           W0PFM     IFEQ 'N'                        *IF
     C                     GOTO Q0EXIT                     *QUIT
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $FB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VFB0DT
      * Convert BOH Buy Order Date to display format
      * Convert date
     C           1000000   ADD  $FARDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VFARDT
      * Convert TH Purchase Date to display format
      * Convert date
     C           1000000   ADD  $FAWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VFAWDT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt EDI Carc Detail   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Print format
     C                     WRITE$G1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print BOH Company Number of Prt EDI Carc Detail   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt EDI Carc Detail   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print BOL Load Number of Prt EDI Carc Detail   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt EDI Carc Detail   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print TH Kill Date of Prt EDI Carc Detail   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Detail line. of Prt EDI Carc Detail   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * USER: On print of detail format
     C                     ADD  1         YL0001           Carcass Count U
      * Mention hidden format
     C   99N99             WRITE$HDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of ZZPrt EDI Carc Sum/DtlPF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of ZZPrt EDI Carc Sum/DtlPF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of ZZPrt EDI Carc Sum/DtlPF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of ZZPrt EDI Carc Sum/DtlPF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of ZZPrt EDI Carc Sum/DtlPF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt EDI Carc Detail   PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt EDI Carc Detail   PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt EDI Carc Detail   PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt EDI Carc Detail   PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt EDI Carc Detail   PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt EDI Carc Detail   PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt EDI Carc Detail   PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Tattoo Record     RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADDD3HMNB    A1HMNB           BOH Company Num
     C                     Z-ADDD3BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDD3BONB    A1BONB           BOL Load Number
     C                     Z-ADDD3CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDD3B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSA     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA1AWDT    YL0003           TH Purchase Dat
     C                     MOVELA1BICD    YL0004           TH Group Refere
     C                     MOVELA1CPST    YL0005           TH Live Purchas
     C                     Z-ADDA1ACPR    YL0006           TH Live Purchas
     C                     MOVELA1C4ST    YL0007           TH Resale UOM
     C                     Z-ADDA1AIPR    YL0008           TH Recalc Live
     C                     Z-ADDA1A6DT    YL0009           TH Pricing Date
     C                     MOVELA1C2ST    YL0010           TH Resale Sprea
     C                     Z-ADDA1CXNB    YL0011           TH Dead On Arri
     C                     Z-ADDA1CWNB    YL0012           TH Head Receive
     C                     Z-ADDA1FCNB    YL0013           TH Yard Deads
     C                     Z-ADDA1H9NB    YL0014           TH Held Over
     C                     Z-ADDA1FDNB    YL0015           TH Head Condemn
     C                     Z-ADDA1FENB    YL0016           TH Head Killed
     C                     Z-ADDA1HENB    YL0017           TH Head Adds
     C                     Z-ADDA1HFNB    YL0018           TH Head Accepte
     C                     Z-ADDA1CYNB    YL0019           TH Live Wgt
     C                     Z-ADDA1E0NB    YL0020           TH Hot Wgt
     C                     Z-ADDA1A5PC    YL0021           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    YL0022           TH Tot Backfat
     C                     Z-ADDA1A4PC    YL0023           TH Tot Light Re
     C                     Z-ADDA1F7NB    YL0024           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    YL0025           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    YL0026           TH Avg Light Re
     C                     Z-ADDA1F4NB    YL0027           TH Avg Lean Per
     C                     Z-ADDA1F3NB    YL0028           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    YL0029           TH Avg Backfat
     C                     Z-ADDA1AVPC    YL0030           TH Std Yield Pe
     C                     Z-ADDA1AWPC    YL0031           TH Actual Yield
     C                     Z-ADDA1A8PC    YL0032           TH Yield Differ
     C                     Z-ADDA1A7PC    YL0033           TH Recalc Live
     C                     Z-ADDA1AMPR    YL0034           TH CM Base Mkt
     C                     Z-ADDA1ANPR    YL0035           TH CM Base Mkt
     C                     Z-ADDA1AYVA    YL0036           TH CM Sort Disc
     C                     Z-ADDA1AWVA    YL0037           TH CM Yield Gai
     C                     Z-ADDA1AOPR    YL0038           TH CM Base Carc
     C                     Z-ADDA1AXVA    YL0039           TH CM LN AddOn/
     C                     Z-ADDA1APPR    YL0040           TH CM Carcass G
     C                     Z-ADDA1ASPR    YL0041           TH Deduction Am
     C                     Z-ADDA1A4VA    YL0042           TH Total Net WO
     C                     Z-ADDA1ATPR    YL0043           TH Carcass Net
     C                     Z-ADDA1A5VA    YL0044           TH Additions Am
     C                     Z-ADDA1A7VA    YL0045           TH Accrual Amou
     C                     Z-ADDA1A2PR    YL0046           TH Fixed Cost A
     C                     MOVELA1CWST    YL0047           TH Payment Sts
     C                     MOVELA1D7ST    YL0048           TH Header Error
     C                     MOVELA1D8ST    YL0049           TH Detail Error
     C                     MOVELA1DWST    YL0050           TH Kill Balanci
     C                     MOVELA1D6ST    YL0051           TH Bal to Kill
     C                     Z-ADDA1GHNB    YL0052           TH Commission A
     C                     Z-ADDA1BYDT    YL0053           TH Voucher Paym
     C                     MOVELA1E0ST    YL0054           TH User Error O
     C                     MOVELA1E1ST    YL0055           TH Held Over Re
     C                     MOVELA1E2ST    YL0056           TH Sex
     C                     Z-ADDA1BSDT    YL0057           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    YL0058           TH Commission P
     C                     Z-ADDA1BUDT    YL0059           TH Actual Check
     C                     Z-ADDA1HGNB    YL0060           TH Shipped Weig
     C                     Z-ADDA1HHNB    YL0061           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    YL0062           TH FFLI
     C                     Z-ADDA1A3PR    YL0063           TH Kill Product
     C                     Z-ADDA1A4PR    YL0064           TH Cut Product
     C                     Z-ADDA1A6PR    YL0065           TH Render Produ
     C                     Z-ADDA1T2HD    YL0066           TH Shift Held O
     C                     MOVELA1BDCD    YL0067           DF Defect Code
     C                     MOVELA1CSCD    YL0068           THP Process Cod
     C                     MOVELA1ACCD    YL0069           HB Buyer Code
     C                     MOVELA1AGCD    YL0070           GN Genetic Code
     C                     MOVELA1BECD    YL0071           HC Class Code
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt EDI Carc Detail   PO
      *================================================================
      * Prt EDI Carc Detail   PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    D3HMNB           BOH Company Num
     C                     MOVEL*HIVAL    D3B0DT           TH Kill Date
     C                     MOVEL*LOVAL    D3ABCD           PD Producer Cod
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    D4HMNB           BOH Company Num
     C                     MOVEL*LOVAL    D4BNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    D4BONB           BOL Load Number
     C                     MOVEL*LOVAL    D4CVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    D4B0DT           TH Kill Date
     C                     MOVEL*LOVAL    D4EUNB           CD Carcass Numb
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Carcass Count USR
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Count USR 2
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field TH Purchase Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field TH Group Reference
     C                     MOVEL*BLANK    YL0004 10
      * Define local work field TH Live Purchase UOM
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field TH Live Purchase Price
     C                     Z-ADD*ZERO     YL0006  52
      * Define local work field TH Resale UOM
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field TH Recalc Live Wgt Yld
     C                     Z-ADD*ZERO     YL0008  52
      * Define local work field TH Pricing Date
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field TH Resale Spread Sts
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field TH Dead On Arrival
     C                     Z-ADD*ZERO     YL0011  50
      * Define local work field TH Head Received
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field TH Yard Deads
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field TH Held Over
     C                     Z-ADD*ZERO     YL0014  50
      * Define local work field TH Head Condemned
     C                     Z-ADD*ZERO     YL0015  50
      * Define local work field TH Head Killed
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field TH Head Adds
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field TH Head Accepted
     C                     Z-ADD*ZERO     YL0018  50
      * Define local work field TH Live Wgt
     C                     Z-ADD*ZERO     YL0019  71
      * Define local work field TH Hot Wgt
     C                     Z-ADD*ZERO     YL0020  71
      * Define local work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     YL0021  61
      * Define local work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     YL0022  61
      * Define local work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     YL0023  61
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0024  51
      * Define local work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0025  51
      * Define local work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     YL0026  31
      * Define local work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YL0027  31
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0028  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0029  31
      * Define local work field TH Std Yield Percent
     C                     Z-ADD*ZERO     YL0030  52
      * Define local work field TH Actual Yield %
     C                     Z-ADD*ZERO     YL0031  52
      * Define local work field TH Yield Difference
     C                     Z-ADD*ZERO     YL0032  52
      * Define local work field TH Recalc Live Wgt
     C                     Z-ADD*ZERO     YL0033  31
      * Define local work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YL0034  52
      * Define local work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     YL0035  72
      * Define local work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     YL0036  72
      * Define local work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     YL0037  72
      * Define local work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     YL0038  72
      * Define local work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     YL0039  72
      * Define local work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     YL0040  72
      * Define local work field TH Deduction Amt
     C                     Z-ADD*ZERO     YL0041  72
      * Define local work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     YL0042  72
      * Define local work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     YL0043  72
      * Define local work field TH Additions Amt
     C                     Z-ADD*ZERO     YL0044  72
      * Define local work field TH Accrual Amount
     C                     Z-ADD*ZERO     YL0045  72
      * Define local work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YL0046  72
      * Define local work field TH Payment Sts
     C                     MOVEL*BLANK    YL0047  2
      * Define local work field TH Header Error Sts
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field TH Detail Error Sts
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    YL0051  1
      * Define local work field TH Commission A/P Voucher
     C                     Z-ADD*ZERO     YL0052  80
      * Define local work field TH Voucher Payment Date
     C                     Z-ADD*ZERO     YL0053  70
      * Define local work field TH User Error Override
     C                     MOVEL*BLANK    YL0054  1
      * Define local work field TH Held Over Record
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field TH Sex
     C                     MOVEL*BLANK    YL0056  1
      * Define local work field TH Held/Ovr Completed Dte
     C                     Z-ADD*ZERO     YL0057  70
      * Define local work field TH Commission Paid Date
     C                     Z-ADD*ZERO     YL0058  70
      * Define local work field TH Actual Check Date
     C                     Z-ADD*ZERO     YL0059  70
      * Define local work field TH Shipped Weight
     C                     Z-ADD*ZERO     YL0060  71
      * Define local work field TH Avg Hot Wgt EXC/ADD
     C                     Z-ADD*ZERO     YL0061  71
      * Define local work field TH FFLI
     C                     Z-ADD*ZERO     YL0062  31
      * Define local work field TH Kill Product Value
     C                     Z-ADD*ZERO     YL0063  72
      * Define local work field TH Cut Product Value
     C                     Z-ADD*ZERO     YL0064  72
      * Define local work field TH Render Product Value
     C                     Z-ADD*ZERO     YL0065  72
      * Define local work field TH Shift Held Over Head
     C                     Z-ADD*ZERO     YL0066  50
      * Define local work field DF Defect Code
     C                     MOVEL*BLANK    YL0067  6
      * Define local work field THP Process Code
     C                     MOVEL*BLANK    YL0068  6
      * Define local work field HB Buyer Code
     C                     MOVEL*BLANK    YL0069  3
      * Define local work field GN Genetic Code
     C                     MOVEL*BLANK    YL0070  5
      * Define local work field HC Class Code
     C                     MOVEL*BLANK    YL0071  3
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modifications
      * 01/23/2021 ISE H16853 - Increased the length from 5 to 7 and
      *                         corrected the alignment of Buy Order Numb
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
