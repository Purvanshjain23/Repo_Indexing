/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PDYEUPC                                       */
/*  PROGRAM NAME:    Print MASS ORDER CANCEL REPORT                */
/*  PROGRAMMER:      JOHN TREMPER                                  */
/*  CREATE DATE:     04/23/99                                      */
/*                                                                 */
/*  FUNCTION:        This CLP is submitted PROMPT FOR MASS         */
/*                   ORDER CANCEL PROMPT AND VALIDATE SCREEN AND   */
/*                   WILL RUN AN OPEN QUERY FILE TO MINIMIZE       */
/*                   RECORDS.                                      */
/*                                                                 */
/*                   USER OPTIONS ARE PASSED THROUGH THE PARMS.    */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*                                                                 */
/*                                                                 */
/*                                                                 */
/*******************************************************************/
             PGM        PARM(&COMP &FDATE)
/*-----------------------------------------------------------------*/
/*                      PARAMETER                                  */
/*-----------------------------------------------------------------*/
/* INPUT PARAMETERS                                                */
             DCL        VAR(&COMP)  TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&FDATE) TYPE(*DEC)

/*-----------------------------------------------------------------*/
/* PROGRAM VARIABLES                                               */
             DCL        VAR(&FDTE)     TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&QRYCOMP)  TYPE(*CHAR) LEN(3)
             DCL        VAR(&QRYFDATE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&A)        TYPE(*CHAR) LEN(25)
             DCL        VAR(&B)        TYPE(*CHAR) LEN(25)
             DCL        VAR(&C)        TYPE(*CHAR) LEN(25)
             DCL        VAR(&D)        TYPE(*CHAR) LEN(25)
             DCL        VAR(&E)        TYPE(*CHAR) LEN(25)
             DCL        VAR(&F)        TYPE(*CHAR) LEN(200)

/*-----------------------------------------------------------------*/
/* MOVES INPUT TO QUERY FIELDS                                     */
             CHGVAR     VAR(&QRYCOMP)  VALUE(&COMP)
             CHGVAR     VAR(&FDTE)     VALUE(&FDATE)
             CHGVAR     VAR(&QRYFDATE) VALUE(&FDTE)

/*-----------------------------------------------------------------*/
/* OPEN QUERY FILE CONCATS                                         */
             CHGVAR     VAR(&A) VALUE('BEAIC3 *EQ ' *CAT &QRYCOMP)
             CHGVAR     VAR(&B) VALUE('*AND BEAODT *LE ' *CAT +
                          &QRYFDATE)
             CHGVAR     VAR(&F) VALUE(&A *BCAT &B)


/*-----------------------------------------------------------------*/
/* OPEN QUERY                                                      */
/*-----------------------------------------------------------------*/
             OVRDBF     FILE(OPBFCPW1) OVRSCOPE(*JOB) SHARE(*YES)
             OPNQRYF    FILE((OPBFCPW1)) QRYSLT(&F) KEYFLD(*FILE)

/*-----------------------------------------------------------------*/
/*                      PROGRAM END                                */
/*-----------------------------------------------------------------*/
 ENDPGM:

             ENDPGM
