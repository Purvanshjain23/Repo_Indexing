/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - DOWNLOAD LOAD LIST DATA TO AN EXCEL SPREADSHEET      */
/*                                                                  */
/*  SYSTEM   - ORDER MANAGEMENT SYSTEM                              */
/*  PROGRAM  - DOWNLOAD LOAD LIST DATA TO AN EXCEL SPREADSHEET      */
/*  DATE     - 09/22/200/                                           */
/*  PARAMETERS                                                      */
/*  &LCOMPN     - COMPANY NUMBER - BLANK FOR ALL                    */
/*  &OCOMPN     - COMPANY NUMBER - ORDER COMPANY                    */
/*  &SSDATEN    - SCHEDULED SHIP DATE                               */
/*  &LOADSTS    - SHIPPED OR UNSHIPPED                              */
/*  &LOADTYP    - LOAD TYPE                                         */
/*  &WHSE1      - WAREHOUSE 1                                       */
/*  &WHSE2      - WAREHOUSE 2                                       */
/*  &WHSE3      - WAREHOUSE 3                                       */
/*  &WHSE4      - WAREHOUSE 4                                       */
/*  &WHSE5      - WAREHOUSE 5                                       */
/*  &WHSE6      - WAREHOUSE 6                                       */
/*  &WHSE7      - WAREHOUSE 7                                       */
/*  &WHSE8      - WAREHOUSE 8                                       */
/*  &WHSE9      - WAREHOUSE 9                                       */
/*  &WHSE10     - WAREHOUSE 10                                      */
/*  &EMAILADDR  - EMAIL ADDRESS                                     */
/********************************************************************/
/* MM/DD/YYYY XXX ENNNNN - DESCRIPTION                              */
/********************************************************************/
 PMY0UPC:    PGM        PARM(&LCOMPN &OCOMPN &SSDATEN &LOADSTS +
                          &LOADTYP &WHSE1 &WHSE2 &WHSE3 &WHSE4 +
                          &WHSE5 &WHSE6 &WHSE7 &WHSE8 &WHSE9 +
                          &WHSE10 &EMAILADDR)

/* PARMS                                                                      */
             DCL        VAR(&LCOMPN) TYPE(*DEC)
             DCL        VAR(&LCOMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&OCOMPN) TYPE(*DEC)
             DCL        VAR(&OCOMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&SSDATEN) TYPE(*DEC)
             DCL        VAR(&SSDATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&LOADSTS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&WHSE1) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSE2) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSE3) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSE4) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSE5) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSE6) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSE7) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSE8) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSE9) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSE10) TYPE(*CHAR) LEN(3)
             DCL        VAR(&LOADTYP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&EMAILADDR) TYPE(*CHAR) LEN(50)

/* INTERNAL FIELDS                                                            */
             DCL        VAR(&LCOMPA) TYPE(*CHAR) LEN(3)
             DCL        VAR(&OCOMPA) TYPE(*CHAR) LEN(3)
             DCL        VAR(&SSDATEA) TYPE(*CHAR) LEN(7)

/********    MONMSG     MSGID(CPF9999)   ***********/

/********************************************************************/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/********************************************************************/
             CHGVAR     VAR(&LCOMP) VALUE(&LCOMPN)
             CHGVAR     VAR(&LCOMPA) VALUE(&LCOMP)
             CHGVAR     VAR(&OCOMP) VALUE(&OCOMPN)
             CHGVAR     VAR(&OCOMPA) VALUE(&OCOMP)
             CHGVAR     VAR(&SSDATE) VALUE(&SSDATEN)
             CHGVAR     VAR(&SSDATEA) VALUE(&SSDATE)

/********************************************************************/
/* DELETE, THEN CREATE WORK FILE IN QTEMP                           */
/********************************************************************/
             CALL       PGM(PDUHUPR) PARM('QTEMP' 'PMEGCPL0')
             CALL       PGM(PDUHUPR) PARM('QTEMP' 'PMEGCPL1')
             CALL       PGM(PDUHUPR) PARM('QTEMP' 'PMEGCPL2')
             CALL       PGM(PDUHUPR) PARM('QTEMP' 'PMEGCPP')

             CRTDUPOBJ  OBJ(PMEGCPP) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(PMEGCPP) CST(*NO) +
                          TRG(*NO)

             CRTDUPOBJ  OBJ(PMEGCPL0) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(PMEGCPL0) CST(*NO) +
                          TRG(*NO)

             CRTDUPOBJ  OBJ(PMEGCPL1) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(PMEGCPL1) CST(*NO) +
                          TRG(*NO)

             CRTDUPOBJ  OBJ(PMEGCPL2) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(PMEGCPL2) CST(*NO) +
                          TRG(*NO)

/* CREATE RECORDS NEEDED FOR THE SPREADSHEET                        */
             CALL       PGM(PMYXXFR) PARM('' &LCOMP &SSDATE &LOADSTS +
                          &LOADTYP &WHSE1 &WHSE2 &WHSE3 &WHSE4 +
                          &WHSE5 &WHSE6 &WHSE7 &WHSE8 &WHSE9 +
                          &WHSE10 &OCOMP)

             EXECUTE    VIEW(PMEGCPPV) MBROPT(*REPLACE) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG('Load List +
                          Report for Scheduled Ship Date of' *BCAT +
                          &SSDATEA *BCAT 'and Company #' *BCAT &OCOMPA)

 END:        ENDPGM
