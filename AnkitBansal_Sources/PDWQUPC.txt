/*********************************************************************/
/*  SLM 02/24/11 ADD EXPORT DOC ORD COMMENT FILLE                    */
/*  SLM 02/24/11                      PNGTCPP &EXCM                  */
/*  RMC 03/25/04 ADD SHIP INST FILE   PDIECPP &SHIP                  */
/*  RMC 03/25/04 ADD EXPORT DOC FILES PDMRREP &EXHD;PDMSREP &EXDT    */
/*  RMC 05/08/09 ADD MISSING OH AND OD LOGICALS. OD NEEDED OPBGWKNX */
/*  RMC 07/17/18 ADD EXPORT DOC HDR EXT PUA6CPP  &EXEXT              */
/*********************************************************************/
 PDWQUPC:    PGM        PARM(&ERROR &COMPIN &ORDIN)

             DCL        VAR(&ERROR)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&COMPIN) TYPE(*DEC)
             DCL        VAR(&ORDIN)  TYPE(*DEC)

             DCL        VAR(&COMP)   TYPE(*DEC)  LEN(3)
             DCL        VAR(&ORDR)   TYPE(*DEC)  LEN(7)
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OPBF) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&OPBG) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&OMCR) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&OPCP) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&SHIP) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&EXHD) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&EXDT) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&EXCM) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&EXEXT) TYPE(*CHAR) LEN(1) VALUE('N')

/* MAKE CERTAIN THAT LIBRARY QTEMP IS FIRST ON LIBRARY LIST         */
             RMVLIBLE   LIB(QTEMP)
             MONMSG     MSGID(CPF0000)

             ADDLIBLE   LIB(QTEMP) POSITION(*FIRST)
             MONMSG     MSGID(CPF0000)

             CHGVAR     VAR(&COMP) VALUE(&COMPIN)
             CHGVAR     VAR(&ORDR) VALUE(&ORDIN)

/* RETRIEVE DATA FILE LIBRARY FROM SYSTEM                       */
             CALL       PGM(CAQXXFR) PARM(&RETURN &FLIB &HLIB)
             IF         COND(&FLIB *EQ '          ') THEN(DO)
             CHGVAR     VAR(&ERROR) VALUE('Y')
             GOTO       CMDLBL(END)
             ENDDO


/*   ORDER ENTRY FILES                                               */
 ORDHDR:     CHKOBJ     OBJ(QTEMP/OPBFCPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&OPBF) +
                          VALUE('Y'))
 ORDDTL:     CHKOBJ     OBJ(QTEMP/OPBGWKP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&OPBG) +
                          VALUE('Y'))
 SHPDTLF:    CHKOBJ     OBJ(QTEMP/OMCRWKP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&OMCR) +
                          VALUE('Y'))
 ORDTLCMT:   CHKOBJ     OBJ(QTEMP/OPCPCPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&OPCP) +
                          VALUE('Y'))
 SHIPINST:   CHKOBJ     OBJ(QTEMP/PDIECPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&SHIP) +
                          VALUE('Y'))
 EXPHDR:     CHKOBJ     OBJ(QTEMP/PDMRREP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&EXHD) +
                          VALUE('Y'))
 EXPCOM:     CHKOBJ     OBJ(QTEMP/PNGTCPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&EXCM) +
                          VALUE('Y'))
 EXPDTL:     CHKOBJ     OBJ(QTEMP/PDMSREP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&EXDT) +
                          VALUE('Y'))
 EXPEXT:     CHKOBJ     OBJ(QTEMP/PUA6CPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&EXEXT) +
                          VALUE('Y'))

             IF         COND(&OPBF *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/OPBFCPNX)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBFCPLM)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBFCPL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBFCPL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBFCPP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&OPBG *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/OPBGWKNX)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBGWKL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBGWKL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBGWKLA)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBGWKP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&OMCR *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/OMCRWKL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OMCRWKL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OMCRWKL2)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OMCRWKP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&OPCP *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/OPCPCPL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPCPCPL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPCPCPL2)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPCPCPP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&SHIP *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/PDIECPL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDIECPL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDIECPP)
              MONMSG     MSGID(CPF2105)
             ENDDO

             IF         COND(&EXHD *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/PDMRREL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDMRREL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDMRREL3)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDMRREP)
              MONMSG     MSGID(CPF2105)
             ENDDO

             IF         COND(&EXCM *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/PNGTCPL3)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PNGTCPL2)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PNGTCPL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PNGTCPL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PNGTCPP)
              MONMSG     MSGID(CPF2105)
             ENDDO

             IF         COND(&EXDT *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/PDMSREL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDMSREP)
              MONMSG     MSGID(CPF2105)
             ENDDO

             IF         COND(&EXEXT *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/PUA6CPL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PUA6CPL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PUA6CPP)
              MONMSG     MSGID(CPF2105)
             ENDDO

/*** FOR TESTING ONLY ***/
             CRTDUPOBJ  OBJ(OPBFCPP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO) CST(*NO) TRG(*NO)
             CRTDUPOBJ  OBJ(OPBFCPL0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(OPBFCPL1) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(OPBFCPLM) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(OPBFCPNX) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(OPBGWKP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             CRTDUPOBJ  OBJ(OPBGWKL0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(OPBGWKL1) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(OPBGWKLA) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(OPBGWKNX) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(OMCRWKP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             CRTDUPOBJ  OBJ(OMCRWKL0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(OMCRWKL1) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(OMCRWKL2) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(OPCPCPP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             CRTDUPOBJ  OBJ(OPCPCPL0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(OPCPCPL1) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(OPCPCPL2) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(PDIECPP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             CRTDUPOBJ  OBJ(PDIECPL0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(PDIECPL1) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(PDMRREP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             CRTDUPOBJ  OBJ(PDMRREL0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(PDMRREL1) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(PDMRREL3) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(PNGTCPP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             CRTDUPOBJ  OBJ(PNGTCPL0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(PNGTCPL1) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(PNGTCPL2) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(PNGTCPL3) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(PDMSREP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             CRTDUPOBJ  OBJ(PDMSREL0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(PUA6CPP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             CRTDUPOBJ  OBJ(PUA6CPL0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(PUA6CPL1) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

/** ** ** ** ** ** ** CALL CREATE ORDER HEADER * ** ** ** ** **/
             CALL       PGM(PDWUXFR) PARM(' ' &COMP &ORDR)

/** ** ** ** ** ** ** CALL COPY ORDER TEMPLATE  ** ** ** ** **/
             CALL       PGM(PDV4EFR) PARM(' ' &COMP &ORDR)

             CHGVAR     VAR(&OPBF) VALUE('N')
             CHGVAR     VAR(&OPBG) VALUE('N')
             CHGVAR     VAR(&OMCR) VALUE('N')
             CHGVAR     VAR(&OPCP) VALUE('N')
             CHGVAR     VAR(&SHIP) VALUE('N')
             CHGVAR     VAR(&EXHD) VALUE('N')
             CHGVAR     VAR(&EXDT) VALUE('N')
             CHGVAR     VAR(&EXCM) VALUE('N')
             CHGVAR     VAR(&EXEXT) VALUE('N')
             CHKOBJ     OBJ(QTEMP/OPBFCPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&OPBF) +
                          VALUE('Y'))
             CHKOBJ     OBJ(QTEMP/OPBGWKP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&OPBG) +
                          VALUE('Y'))
             CHKOBJ     OBJ(QTEMP/OMCRWKP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&OMCR) +
                          VALUE('Y'))
             CHKOBJ     OBJ(QTEMP/OPCPCPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&OPCP) +
                          VALUE('Y'))
             CHKOBJ     OBJ(QTEMP/PDIECPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&SHIP) +
                          VALUE('Y'))
             CHKOBJ     OBJ(QTEMP/PDMRREP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&EXHD) +
                          VALUE('Y'))
             CHKOBJ     OBJ(QTEMP/PNGTCPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&EXCM) +
                          VALUE('Y'))
             CHKOBJ     OBJ(QTEMP/PDMSREP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&EXDT) +
                          VALUE('Y'))
             CHKOBJ     OBJ(QTEMP/PUA6CPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&EXDT) +
                          VALUE('Y'))

             IF         COND(&OPBF *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/OPBFCPNX)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBFCPLM)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBFCPL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBFCPL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBFCPP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&OPBG *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/OPBGWKNX)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBGWKL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBGWKL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBGWKLA)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPBGWKP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&OMCR *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/OMCRWKL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OMCRWKL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OMCRWKL2)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OMCRWKP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&OPCP *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/OPCPCPL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPCPCPL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPCPCPL2)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/OPCPCPP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&SHIP *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/PDIECPL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDIECPL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDIECPP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&EXHD *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/PDMRREL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDMRREL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDMRREL3)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDMRREP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&EXCM *EQ 'N') THEN(DO)
             DLTF       FILE(QTEMP/PNGTCPL3)
              MONMSG     MSGID(CPF2105)
             DLTF       FILE(QTEMP/PNGTCPL2)
              MONMSG     MSGID(CPF2105)
             DLTF       FILE(QTEMP/PNGTCPL1)
              MONMSG     MSGID(CPF2105)
             DLTF       FILE(QTEMP/PNGTCPL0)
              MONMSG     MSGID(CPF2105)
             DLTF       FILE(QTEMP/PNGTCPP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&EXDT *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/PDMSREL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PDMSREP)
              MONMSG     MSGID(CPF2105)
             ENDDO
             IF         COND(&EXEXT *EQ 'N') THEN(DO)
              DLTF       FILE(QTEMP/PUA6CPL1)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PUA6CPL0)
              MONMSG     MSGID(CPF2105)
              DLTF       FILE(QTEMP/PUA6CPP)
              MONMSG     MSGID(CPF2105)
             ENDDO

 END:        ENDPGM
