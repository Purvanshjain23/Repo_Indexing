// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMOXXFR
// ?Date: 14.08.2025 Time: 03:43:39
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?1.  Performing the Seaboard Print Override
DO;

// LCL.Nbr of Copies-Alpha   USR = PAR.PRT Number of Copies
LCL.Nbr_of_Copies_Alpha_USR = PAR.PRT_Number_of_Copies;

CASE;

// IF PAR.Company Number is High Plains
IF PAR.Company_Number = 361;

// Call program EXC Command SBDOVR     UP.
CALL PROGRAM(EXC Command SBDOVR     UP) ('PDPOUPR');
PARAMETER('PMOMPFR$');
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(LCL.Nbr_of_Copies_Alpha_USR);

// Call program PRT COA for one Batch  PF.
CALL PROGRAM(PRT COA for one Batch  PF) ('PMOMPFR');
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.COA_ULSD_Company_#);
PARAMETER(PAR.COA_Batch_Number);

// Execute command - 'DLTOVR'
EXECUTE COMMAND(USR2787);

// IF PAR.Company Number is Seaboard Energy Kansas
IF PAR.Company_Number = 375;

//?W104274 DN 08/01/22-Added PUWVPFR COA Hugoton Report.
// Call program EXC Command SBDOVR     UP.
CALL PROGRAM(EXC Command SBDOVR     UP) ('PDPOUPR');
PARAMETER('PUWVPFR$');
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(LCL.Nbr_of_Copies_Alpha_USR);

// Call program Zzz COA HUG one Batch  PF.
CALL PROGRAM(Zzz COA HUG one Batch  PF) ('PUWVPFR');
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.COA_ULSD_Company_#);
PARAMETER(PAR.COA_Batch_Number);

// Execute command - 'DLTOVR'
EXECUTE COMMAND(USR2787);

// IF *OTHERWISE
IF *OTHERWISE;

// LCL.Text USR 6 = CON.COASTJ
LCL.Text_USR_6 = 'COASTJ';

// Call program CLP OVRPRTF cmd  w/ovl UP.
CALL PROGRAM(CLP OVRPRTF cmd  w/ovl UP) ('PUJ3UPC');
PARAMETER('PUJ7PFR$');
PARAMETER(*BLANK);
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(1);
PARAMETER(LCL.Text_USR_6);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.COA_ULSD_Company_#);
PARAMETER(PAR.COA_Batch_Number);

ENDIF;

ENDDO;

