     H/TITLE UPS Bld Sch/Pln Night XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/22/10  Time  : 17:07:08
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAAFREL9IF  E           K        DISK
      * RTV : Calendar                  Co/Date KillDaySts=Y
      *
     FCAAFREL8IF  E           K        DISK
      * RTV : Calendar                  Co/Date PrdDaySts=Y
      *
     FPDJWCPL1IF  E           K        DISK
      * RTV : PS Availability Audit     Retrieval index
      *
     FCABZRELPIF  E           K        DISK
      * RTV : Company Item              Unit Wgt Chg Sts = Yes
      *
     FOPBGWKLFIF  E           K        DISK
      * RSQ : Order Detail              Co/Itm/Whs/SSD(d)/Od Omt
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FPDI9CPL7IF  E           K        DISK
      * RSQ : PS Production Adjustment  Co/Dte(d)/Itm/Whs/Typ/#
      *
     FPDJWCPL0UF  E           K        DISK
      * UPD : PS Availability Audit     Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDKNCPL0UF  E           K        DISK
      * UPD : Order Detail Schedule     Update index
      *
     FCABZREL0UF  E           K        DISK
      * UPD : Company Item              Update index
      *
     FPDI9CPL0UF  E           K        DISK
      * UPD : PS Production Adjustment  Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WAAJVN
     I              DRAUNA                          WAAUNA
     I              DRB8NA                          WAB8NA
     I              DRAHVN                          WAAHVN
     I              DRI6ST                          WAI6ST
     I              DRI7ST                          WAI7ST
     I              DRXMST                          WAXMST
     I              DRXNST                          WAXNST
     I              DRI8ST                          WAI8ST
     I              DRNLNB                          WANLNB
     I              DRMPNA                          WAMPNA
     I              DRBCCD                          WABCCD
     I              DRAIC3                          WAAIC3
     I              DRDQCD                          WADQCD
     I              DRDRCD                          WADRCD
     I              DRAJCD                          WAAJCD
     I              DRBUVN                          WABUVN
     I              DRUVST                          WAUVST
     I              DRUWST                          WAUWST
     I              DRUXST                          WAUXST
     I              DRAATM                          WAAATM
     I              DRAYNA                          WAAYNA
     I              DRA0NA                          WAA0NA
     I              DRAXDT                          WAAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WBAJVN
     I              DTDNCD                          WBDNCD
     I              DTAIC3                          WBAIC3
     I              DTDQCD                          WBDQCD
     I              DTDRCD                          WBDRCD
     I              DTAJCD                          WBAJCD
     I              DTJFST                          WBJFST
     I              DTUVST                          WBUVST
     I              DTUWST                          WBUWST
     I              DTUXST                          WBUXST
     I              DTAATM                          WBAATM
     I              DTAYNA                          WBAYNA
     I              DTA0NA                          WBA0NA
     I              DTAXDT                          WBAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WCAIC3
     I              KMV8CD                          WCV8CD
     I              KMAUNA                          WCAUNA
     I              KMI5ST                          WCI5ST
     I              KMBXTX                          WCBXTX
     I              KMM8NB                          WCM8NB
     I              KMUVST                          WCUVST
     I              KMUWST                          WCUWST
     I              KMUXST                          WCUXST
     I              KMVSST                          WCVSST
     I              KMAATM                          WCAATM
     I              KMAYNA                          WCAYNA
     I              KMA0NA                          WCA0NA
     I              KMAXDT                          WCAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WDAIC3
     I              AFBCDT                          WDBCDT
     I              AFCQNB                          WDCQNB
     I              AFESNB                          WDESNB
     I              AFETNB                          WDETNB
     I              AFBZNB                          WDBZNB
     I              AFA9ST                          WDA9ST
     I              AFEINB                          WDEINB
     I              AFC5ST                          WDC5ST
     I              AFAQNB                          WDAQNB
     I              AFCMST                          WDCMST
     I              AFV9ST                          WDV9ST
     I              AFWAST                          WDWAST
     I              AFX2ST                          WDX2ST
     I              AFOJDT                          WDOJDT
     I              AFNQNX                          WDNQNX
     I              AFNRNX                          WDNRNX
     I              AFI9SX                          WDI9SX
     I              AFJASX                          WDJASX
     I              AFOKDT                          WDOKDT
     I              AFOLDT                          WDOLDT
     I              AFUVST                          WDUVST
     I              AFUWST                          WDUWST
     I              AFUXST                          WDUXST
     I              AFAATM                          WDAATM
     I              AFAYNA                          WDAYNA
     I              AFA0NA                          WDA0NA
     I              AFAXDT                          WDAXDT
      *
     I@AFREC2
      * Calendar                  Co/Date KillDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WEAIC3
     I              AFBCDT                          WEBCDT
     I              AFCQNB                          WECQNB
     I              AFESNB                          WEESNB
     I              AFETNB                          WEETNB
     I              AFBZNB                          WEBZNB
     I              AFA9ST                          WEA9ST
     I              AFEINB                          WEEINB
     I              AFC5ST                          WEC5ST
     I              AFAQNB                          WEAQNB
     I              AFCMST                          WECMST
     I              AFV9ST                          WEV9ST
     I              AFWAST                          WEWAST
     I              AFX2ST                          WEX2ST
     I              AFOJDT                          WEOJDT
     I              AFNQNX                          WENQNX
     I              AFNRNX                          WENRNX
     I              AFI9SX                          WEI9SX
     I              AFJASX                          WEJASX
     I              AFOKDT                          WEOKDT
     I              AFOLDT                          WEOLDT
     I              AFUVST                          WEUVST
     I              AFUWST                          WEUWST
     I              AFUXST                          WEUXST
     I              AFAATM                          WEAATM
     I              AFAYNA                          WEAYNA
     I              AFA0NA                          WEA0NA
     I              AFAXDT                          WEAXDT
      *
     I@AFREY1
      * Calendar                  Co/Date PrdDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WFAIC3
     I              AFBCDT                          WFBCDT
     I              AFCQNB                          WFCQNB
     I              AFESNB                          WFESNB
     I              AFETNB                          WFETNB
     I              AFBZNB                          WFBZNB
     I              AFA9ST                          WFA9ST
     I              AFEINB                          WFEINB
     I              AFC5ST                          WFC5ST
     I              AFAQNB                          WFAQNB
     I              AFCMST                          WFCMST
     I              AFV9ST                          WFV9ST
     I              AFWAST                          WFWAST
     I              AFX2ST                          WFX2ST
     I              AFOJDT                          WFOJDT
     I              AFNQNX                          WFNQNX
     I              AFNRNX                          WFNRNX
     I              AFI9SX                          WFI9SX
     I              AFJASX                          WFJASX
     I              AFOKDT                          WFOKDT
     I              AFOLDT                          WFOLDT
     I              AFUVST                          WFUVST
     I              AFUWST                          WFUWST
     I              AFUXST                          WFUXST
     I              AFAATM                          WFAATM
     I              AFAYNA                          WFAYNA
     I              AFA0NA                          WFA0NA
     I              AFAXDT                          WFAXDT
      *
     I@JWCPBB
      * PS Availability Audit     Retrieval index
      * Renamed input format fields
     I              JWAIC3                          WGAIC3
     I              JWHMDT                          WGHMDT
     I              JWZPST                          WGZPST
     I              JWASQN                          WGASQN
     I              JWHYQT                          WGHYQT
     I              JWE8ST                          WGE8ST
     I              JWESWG                          WGESWG
     I              JWHZQT                          WGHZQT
     I              JWEQWG                          WGEQWG
     I              JWH0QT                          WGH0QT
     I              JWERWG                          WGERWG
     I              JWH4QT                          WGH4QT
     I              JWEWWG                          WGEWWG
     I              JWICDT                          WGICDT
     I              JWIDDT                          WGIDDT
     I              JWB7C7                          WGB7C7
     I              JWT0CD                          WGT0CD
     I              JWBXVN                          WGBXVN
     I              JWAORN                          WGAORN
     I              JWAOSN                          WGAOSN
     I              JWAOSL                          WGAOSL
     I              JWPSAT                          WGPSAT
     I              JWPSIS                          WGPSIS
     I              JWUVST                          WGUVST
     I              JWUWST                          WGUWST
     I              JWUXST                          WGUXST
     I              JWAATM                          WGAATM
     I              JWAYNA                          WGAYNA
     I              JWA0NA                          WGA0NA
     I              JWAXDT                          WGAXDT
      *
     I@JWCPBA
      * PS Availability Audit     Update index
      * Renamed input format fields
     I              JWAIC3                          WHAIC3
     I              JWHMDT                          WHHMDT
     I              JWZPST                          WHZPST
     I              JWASQN                          WHASQN
     I              JWHYQT                          WHHYQT
     I              JWE8ST                          WHE8ST
     I              JWESWG                          WHESWG
     I              JWHZQT                          WHHZQT
     I              JWEQWG                          WHEQWG
     I              JWH0QT                          WHH0QT
     I              JWERWG                          WHERWG
     I              JWH4QT                          WHH4QT
     I              JWEWWG                          WHEWWG
     I              JWICDT                          WHICDT
     I              JWIDDT                          WHIDDT
     I              JWB7C7                          WHB7C7
     I              JWT0CD                          WHT0CD
     I              JWBXVN                          WHBXVN
     I              JWAORN                          WHAORN
     I              JWAOSN                          WHAOSN
     I              JWAOSL                          WHAOSL
     I              JWPSAT                          WHPSAT
     I              JWPSIS                          WHPSIS
     I              JWUVST                          WHUVST
     I              JWUWST                          WHUWST
     I              JWUXST                          WHUXST
     I              JWAATM                          WHAATM
     I              JWAYNA                          WHAYNA
     I              JWA0NA                          WHA0NA
     I              JWAXDT                          WHAXDT
      *
     I@BZREIT
      * Company Item              Unit Wgt Chg Sts = Yes
      * Renamed input format fields
     I              BZAIC3                          WIAIC3
     I              BZHGCD                          WIHGCD
     I              BZAVNA                          WIAVNA
     I              BZAWNA                          WIAWNA
     I              BZL7NA                          WIL7NA
     I              BZL8NA                          WIL8NA
     I              BZL6NA                          WIL6NA
     I              BZMFNA                          WIMFNA
     I              BZADCD                          WIADCD
     I              BZAWPC                          WIAWPC
     I              BZLXST                          WILXST
     I              BZAECD                          WIAECD
     I              BZAXPC                          WIAXPC
     I              BZLYST                          WILYST
     I              BZAFCD                          WIAFCD
     I              BZAICD                          WIAICD
     I              BZAIWG                          WIAIWG
     I              BZHICD                          WIHICD
     I              BZRBCD                          WIRBCD
     I              BZFZST                          WIFZST
     I              BZAVST                          WIAVST
     I              BZCZWG                          WICZWG
     I              BZC0WG                          WIC0WG
     I              BZURTN                          WIURTN
     I              BZAJC8                          WIAJC8
     I              BZRINB                          WIRINB
     I              BZRHNB                          WIRHNB
     I              BZRGNB                          WIRGNB
     I              BZLNCD                          WILNCD
     I              BZTFNB                          WITFNB
     I              BZN0CD                          WIN0CD
     I              BZX4ST                          WIX4ST
     I              BZTMVA                          WITMVA
     I              BZTNVA                          WITNVA
     I              BZBLPR                          WIBLPR
     I              BZBMPR                          WIBMPR
     I              BZLRCD                          WILRCD
     I              BZU9ST                          WIU9ST
     I              BZCMCO                          WICMCO
     I              BZQ1CD                          WIQ1CD
     I              BZQ8CD                          WIQ8CD
     I              BZCHTM                          WICHTM
     I              BZQZCD                          WIQZCD
     I              BZXWST                          WIXWST
     I              BZXXST                          WIXXST
     I              BZVMST                          WIVMST
     I              BZSWGH                          WISWGH
     I              BZPPHE                          WIPPHE
     I              BZR3CD                          WIR3CD
     I              BZSDCD                          WISDCD
     I              BZICN1                          WIICN1
     I              BZSVCD                          WISVCD
     I              BZICN2                          WIICN2
     I              BZSWCD                          WISWCD
     I              BZV2NB                          WIV2NB
     I              BZSXCD                          WISXCD
     I              BZITCN                          WIITCN
     I              BZSYCD                          WISYCD
     I              BZITC5                          WIITC5
     I              BZSZCD                          WISZCD
     I              BZICN6                          WIICN6
     I              BZS0CD                          WIS0CD
     I              BZICN7                          WIICN7
     I              BZS1CD                          WIS1CD
     I              BZICN8                          WIICN8
     I              BZS2CD                          WIS2CD
     I              BZICN9                          WIICN9
     I              BZS3CD                          WIS3CD
     I              BZICN0                          WIICN0
     I              BZS4CD                          WIS4CD
     I              BZSFNB                          WISFNB
     I              BZA3WG                          WIA3WG
     I              BZSJNB                          WISJNB
     I              BZLLCD                          WILLCD
     I              BZLMCD                          WILMCD
     I              BZP3ST                          WIP3ST
     I              BZSKNB                          WISKNB
     I              BZSLNB                          WISLNB
     I              BZSMNB                          WISMNB
     I              BZP4ST                          WIP4ST
     I              BZCFNB                          WICFNB
     I              BZCGNB                          WICGNB
     I              BZILNB                          WIILNB
     I              BZCHNB                          WICHNB
     I              BZCINB                          WICINB
     I              BZCJNB                          WICJNB
     I              BZCMNB                          WICMNB
     I              BZCNNB                          WICNNB
     I              BZCRNB                          WICRNB
     I              BZCSNB                          WICSNB
     I              BZCVNB                          WICVNB
     I              BZCWNB                          WICWNB
     I              BZCXNB                          WICXNB
     I              BZCZNB                          WICZNB
     I              BZC0NB                          WIC0NB
     I              BZN1CD                          WIN1CD
     I              BZB4NB                          WIB4NB
     I              BZB5NB                          WIB5NB
     I              BZX5ST                          WIX5ST
     I              BZX6ST                          WIX6ST
     I              BZX7ST                          WIX7ST
     I              BZPCCT                          WIPCCT
     I              BZBDNB                          WIBDNB
     I              BZBJNB                          WIBJNB
     I              BZSUST                          WISUST
     I              BZSVST                          WISVST
     I              BZSYST                          WISYST
     I              BZSZST                          WISZST
     I              BZS1ST                          WIS1ST
     I              BZXRCD                          WIXRCD
     I              BZXTCD                          WIXTCD
     I              BZXUCD                          WIXUCD
     I              BZF5WG                          WIF5WG
     I              BZF6WG                          WIF6WG
     I              BZF7WG                          WIF7WG
     I              BZBLNB                          WIBLNB
     I              BZBNNB                          WIBNNB
     I              BZS2ST                          WIS2ST
     I              BZS4ST                          WIS4ST
     I              BZS5ST                          WIS5ST
     I              BZS6ST                          WIS6ST
     I              BZS8ST                          WIS8ST
     I              BZS9ST                          WIS9ST
     I              BZTCST                          WITCST
     I              BZTDST                          WITDST
     I              BZUVST                          WIUVST
     I              BZUWST                          WIUWST
     I              BZUXST                          WIUXST
     I              BZVSST                          WIVSST
     I              BZAATM                          WIAATM
     I              BZAYNA                          WIAYNA
     I              BZA0NA                          WIA0NA
     I              BZAXDT                          WIAXDT
      *
     I@BGWKKG
      * Order Detail              Co/Itm/Whs/SSD(d)/Od Omt
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMGSPR                          WJGSPR
     I              OMGTPR                          WJGTPR
     I              OMGUPR                          WJGUPR
     I              OMHOST                          WJHOST
     I              OMHPST                          WJHPST
     I              OMIOST                          WJIOST
     I              OMPEWG                          WJPEWG
     I              OMRINY                          WJRINY
     I              OMTIDT                          WJTIDT
     I              OMTJDT                          WJTJDT
     I              OMH2ST                          WJH2ST
     I              OMH0ST                          WJH0ST
     I              OMH1ST                          WJH1ST
     I              OMTKDT                          WJTKDT
     I              OMTLDT                          WJTLDT
     I              OMTMDT                          WJTMDT
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WLAIC3
     I              OMC4NB                          WLC4NB
     I              OMDPNB                          WLDPNB
     I              OMUENB                          WLUENB
     I              OMHGCD                          WLHGCD
     I              OMAJCD                          WLAJCD
     I              OMBKC7                          WLBKC7
     I              OMCFC7                          WLCFC7
     I              OMGMST                          WLGMST
     I              OMGNST                          WLGNST
     I              OMMAVA                          WLMAVA
     I              OMKDVA                          WLKDVA
     I              OML8VA                          WLL8VA
     I              OML9VA                          WLL9VA
     I              OMGTST                          WLGTST
     I              OMGVST                          WLGVST
     I              OMGUST                          WLGUST
     I              OMQFST                          WLQFST
     I              OMAYVA                          WLAYVA
     I              OMEXDT                          WLEXDT
     I              OMLQCD                          WLLQCD
     I              OMRDCD                          WLRDCD
     I              OMQ7CD                          WLQ7CD
     I              OMBZPR                          WLBZPR
     I              OML6NB                          WLL6NB
     I              OMU1ST                          WLU1ST
     I              OMGIDT                          WLGIDT
     I              OMCRCD                          WLCRCD
     I              OMAGCD                          WLAGCD
     I              OMRZST                          WLRZST
     I              OMR0ST                          WLR0ST
     I              OMR1ST                          WLR1ST
     I              OMG7NA                          WLG7NA
     I              OMG8NA                          WLG8NA
     I              OMRPCD                          WLRPCD
     I              OMVEST                          WLVEST
     I              OMVGST                          WLVGST
     I              OMAVST                          WLAVST
     I              OMU0ST                          WLU0ST
     I              OMRFCD                          WLRFCD
     I              OMFZST                          WLFZST
     I              OMR1NB                          WLR1NB
     I              OMAVQT                          WLAVQT
     I              OMD0WG                          WLD0WG
     I              OMCCQT                          WLCCQT
     I              OMAUWG                          WLAUWG
     I              OMCBQT                          WLCBQT
     I              OMATWG                          WLATWG
     I              OMAQCS                          WLAQCS
     I              OMAGCS                          WLAGCS
     I              OMAKPR                          WLAKPR
     I              OMALPR                          WLALPR
     I              OMAUPR                          WLAUPR
     I              OMAVWG                          WLAVWG
     I              OMA4WG                          WLA4WG
     I              OMA5DT                          WLA5DT
     I              OMAODT                          WLAODT
     I              OMGNDT                          WLGNDT
     I              OMAMST                          WLAMST
     I              OMANST                          WLANST
     I              OMVAST                          WLVAST
     I              OMRGNB                          WLRGNB
     I              OMRHNB                          WLRHNB
     I              OMRINB                          WLRINB
     I              OMRBCD                          WLRBCD
     I              OMHICD                          WLHICD
     I              OMRNCD                          WLRNCD
     I              OMROCD                          WLROCD
     I              OMCXDT                          WLCXDT
     I              OMAJVN                          WLAJVN
     I              OMKXCD                          WLKXCD
     I              OMJPCD                          WLJPCD
     I              OMCQCD                          WLCQCD
     I              OMR4CD                          WLR4CD
     I              OMZ1ST                          WLZ1ST
     I              OMZ3ST                          WLZ3ST
     I              OMZ4ST                          WLZ4ST
     I              OMDUPR                          WLDUPR
     I              OMB6VL                          WLB6VL
     I              OMA1AA                          WLA1AA
     I              OMFZSX                          WLFZSX
     I              OMF0SX                          WLF0SX
     I              OMF1SX                          WLF1SX
     I              OMF2SX                          WLF2SX
     I              OMF3SX                          WLF3SX
     I              OMF4SX                          WLF4SX
     I              OMF5SX                          WLF5SX
     I              OMF6SX                          WLF6SX
     I              OMF7SX                          WLF7SX
     I              OMNTDT                          WLNTDT
     I              OMNUDT                          WLNUDT
     I              OMNVDT                          WLNVDT
     I              OMNWDT                          WLNWDT
     I              OMNXDT                          WLNXDT
     I              OMBUTM                          WLBUTM
     I              OMBVTM                          WLBVTM
     I              OMBWTM                          WLBWTM
     I              OMBXTM                          WLBXTM
     I              OMBYTM                          WLBYTM
     I              OMH5NX                          WLH5NX
     I              OMH6NX                          WLH6NX
     I              OMH7NX                          WLH7NX
     I              OMH8NX                          WLH8NX
     I              OMH9NX                          WLH9NX
     I              OMDVPR                          WLDVPR
     I              OMDWPR                          WLDWPR
     I              OMDXPR                          WLDXPR
     I              OMDYPR                          WLDYPR
     I              OMDZPR                          WLDZPR
     I              OMGSPR                          WLGSPR
     I              OMGTPR                          WLGTPR
     I              OMGUPR                          WLGUPR
     I              OMHOST                          WLHOST
     I              OMHPST                          WLHPST
     I              OMIOST                          WLIOST
     I              OMPEWG                          WLPEWG
     I              OMRINY                          WLRINY
     I              OMTIDT                          WLTIDT
     I              OMTJDT                          WLTJDT
     I              OMH2ST                          WLH2ST
     I              OMH0ST                          WLH0ST
     I              OMH1ST                          WLH1ST
     I              OMTKDT                          WLTKDT
     I              OMTLDT                          WLTLDT
     I              OMTMDT                          WLTMDT
     I              OMUVST                          WLUVST
     I              OMUWST                          WLUWST
     I              OMUXST                          WLUXST
     I              OMAATM                          WLAATM
     I              OMAYNA                          WLAYNA
     I              OMA0NA                          WLA0NA
     I              OMAXDT                          WLAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WMAIC3
     I              KNC4NB                          WMC4NB
     I              KNDPNB                          WMDPNB
     I              KNUENB                          WMUENB
     I              KNJGDT                          WMJGDT
     I              KNAODT                          WMAODT
     I              KNAJCD                          WMAJCD
     I              KNAYAA                          WMAYAA
     I              KNHGCD                          WMHGCD
     I              KNIGQT                          WMIGQT
     I              KNFLWG                          WMFLWG
     I              KNIUQT                          WMIUQT
     I              KNF3WG                          WMF3WG
     I              KNIVQT                          WMIVQT
     I              KNF4WG                          WMF4WG
     I              KNP7ST                          WMP7ST
     I              KNP8ST                          WMP8ST
     I              KNQAST                          WMQAST
     I              KNUVST                          WMUVST
     I              KNUWST                          WMUWST
     I              KNUXST                          WMUXST
     I              KNVSST                          WMVSST
     I              KNAATM                          WMAATM
     I              KNAYNA                          WMAYNA
     I              KNA0NA                          WMA0NA
     I              KNAXDT                          WMAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WOAIC3
     I              KNC4NB                          WOC4NB
     I              KNDPNB                          WODPNB
     I              KNUENB                          WOUENB
     I              KNJGDT                          WOJGDT
     I              KNAODT                          WOAODT
     I              KNAJCD                          WOAJCD
     I              KNAYAA                          WOAYAA
     I              KNHGCD                          WOHGCD
     I              KNIGQT                          WOIGQT
     I              KNFLWG                          WOFLWG
     I              KNIUQT                          WOIUQT
     I              KNF3WG                          WOF3WG
     I              KNIVQT                          WOIVQT
     I              KNF4WG                          WOF4WG
     I              KNP7ST                          WOP7ST
     I              KNP8ST                          WOP8ST
     I              KNQAST                          WOQAST
     I              KNUVST                          WOUVST
     I              KNUWST                          WOUWST
     I              KNUXST                          WOUXST
     I              KNVSST                          WOVSST
     I              KNAATM                          WOAATM
     I              KNAYNA                          WOAYNA
     I              KNA0NA                          WOA0NA
     I              KNAXDT                          WOAXDT
      *
     I@BZREJV
      * Company Item              Update index
      * Renamed input format fields
     I              BZAIC3                          WRAIC3
     I              BZHGCD                          WRHGCD
     I              BZAVNA                          WRAVNA
     I              BZAWNA                          WRAWNA
     I              BZL7NA                          WRL7NA
     I              BZL8NA                          WRL8NA
     I              BZL6NA                          WRL6NA
     I              BZMFNA                          WRMFNA
     I              BZADCD                          WRADCD
     I              BZAWPC                          WRAWPC
     I              BZLXST                          WRLXST
     I              BZAECD                          WRAECD
     I              BZAXPC                          WRAXPC
     I              BZLYST                          WRLYST
     I              BZAFCD                          WRAFCD
     I              BZAICD                          WRAICD
     I              BZAIWG                          WRAIWG
     I              BZHICD                          WRHICD
     I              BZRBCD                          WRRBCD
     I              BZFZST                          WRFZST
     I              BZAVST                          WRAVST
     I              BZCZWG                          WRCZWG
     I              BZC0WG                          WRC0WG
     I              BZURTN                          WRURTN
     I              BZAJC8                          WRAJC8
     I              BZRINB                          WRRINB
     I              BZRHNB                          WRRHNB
     I              BZRGNB                          WRRGNB
     I              BZLNCD                          WRLNCD
     I              BZTFNB                          WRTFNB
     I              BZN0CD                          WRN0CD
     I              BZX4ST                          WRX4ST
     I              BZTMVA                          WRTMVA
     I              BZTNVA                          WRTNVA
     I              BZBLPR                          WRBLPR
     I              BZBMPR                          WRBMPR
     I              BZLRCD                          WRLRCD
     I              BZU9ST                          WRU9ST
     I              BZCMCO                          WRCMCO
     I              BZQ1CD                          WRQ1CD
     I              BZQ8CD                          WRQ8CD
     I              BZCHTM                          WRCHTM
     I              BZQZCD                          WRQZCD
     I              BZXWST                          WRXWST
     I              BZXXST                          WRXXST
     I              BZVMST                          WRVMST
     I              BZSWGH                          WRSWGH
     I              BZPPHE                          WRPPHE
     I              BZR3CD                          WRR3CD
     I              BZSDCD                          WRSDCD
     I              BZICN1                          WRICN1
     I              BZSVCD                          WRSVCD
     I              BZICN2                          WRICN2
     I              BZSWCD                          WRSWCD
     I              BZV2NB                          WRV2NB
     I              BZSXCD                          WRSXCD
     I              BZITCN                          WRITCN
     I              BZSYCD                          WRSYCD
     I              BZITC5                          WRITC5
     I              BZSZCD                          WRSZCD
     I              BZICN6                          WRICN6
     I              BZS0CD                          WRS0CD
     I              BZICN7                          WRICN7
     I              BZS1CD                          WRS1CD
     I              BZICN8                          WRICN8
     I              BZS2CD                          WRS2CD
     I              BZICN9                          WRICN9
     I              BZS3CD                          WRS3CD
     I              BZICN0                          WRICN0
     I              BZS4CD                          WRS4CD
     I              BZSFNB                          WRSFNB
     I              BZA3WG                          WRA3WG
     I              BZSJNB                          WRSJNB
     I              BZLLCD                          WRLLCD
     I              BZLMCD                          WRLMCD
     I              BZP3ST                          WRP3ST
     I              BZSKNB                          WRSKNB
     I              BZSLNB                          WRSLNB
     I              BZSMNB                          WRSMNB
     I              BZP4ST                          WRP4ST
     I              BZCFNB                          WRCFNB
     I              BZCGNB                          WRCGNB
     I              BZILNB                          WRILNB
     I              BZCHNB                          WRCHNB
     I              BZCINB                          WRCINB
     I              BZCJNB                          WRCJNB
     I              BZCMNB                          WRCMNB
     I              BZCNNB                          WRCNNB
     I              BZCRNB                          WRCRNB
     I              BZCSNB                          WRCSNB
     I              BZCVNB                          WRCVNB
     I              BZCWNB                          WRCWNB
     I              BZCXNB                          WRCXNB
     I              BZCZNB                          WRCZNB
     I              BZC0NB                          WRC0NB
     I              BZN1CD                          WRN1CD
     I              BZB4NB                          WRB4NB
     I              BZB5NB                          WRB5NB
     I              BZX5ST                          WRX5ST
     I              BZX6ST                          WRX6ST
     I              BZX7ST                          WRX7ST
     I              BZPCCT                          WRPCCT
     I              BZBDNB                          WRBDNB
     I              BZBJNB                          WRBJNB
     I              BZSUST                          WRSUST
     I              BZSVST                          WRSVST
     I              BZSYST                          WRSYST
     I              BZSZST                          WRSZST
     I              BZS1ST                          WRS1ST
     I              BZXRCD                          WRXRCD
     I              BZXTCD                          WRXTCD
     I              BZXUCD                          WRXUCD
     I              BZF5WG                          WRF5WG
     I              BZF6WG                          WRF6WG
     I              BZF7WG                          WRF7WG
     I              BZBLNB                          WRBLNB
     I              BZBNNB                          WRBNNB
     I              BZS2ST                          WRS2ST
     I              BZS4ST                          WRS4ST
     I              BZS5ST                          WRS5ST
     I              BZS6ST                          WRS6ST
     I              BZS8ST                          WRS8ST
     I              BZS9ST                          WRS9ST
     I              BZTCST                          WRTCST
     I              BZTDST                          WRTDST
     I              BZUVST                          WRUVST
     I              BZUWST                          WRUWST
     I              BZUXST                          WRUXST
     I              BZVSST                          WRVSST
     I              BZAATM                          WRAATM
     I              BZAYNA                          WRAYNA
     I              BZA0NA                          WRA0NA
     I              BZAXDT                          WRAXDT
      *
     I@I9CPN1
      * PS Production Adjustment  Co/Dte(d)/Itm/Whs/Typ/#
      * Renamed input format fields
     I              I9AIC3                          WSAIC3
     I              I9ELDT                          WSELDT
     I              I9HGCD                          WSHGCD
     I              I9AJCD                          WSAJCD
     I              I9PSAD                          WSPSAD
     I              I9PSAN                          WSPSAN
     I              I9PIAD                          WSPIAD
     I              I9V6ST                          WSV6ST
     I              I9D8C7                          WSD8C7
     I              I9UVST                          WSUVST
     I              I9UWST                          WSUWST
     I              I9UXST                          WSUXST
     I              I9VSST                          WSVSST
     I              I9AATM                          WSAATM
     I              I9AYNA                          WSAYNA
     I              I9A0NA                          WSA0NA
     I              I9AXDT                          WSAXDT
      *
     I@I9CPUU
      * PS Production Adjustment  Update index
      * Renamed input format fields
     I              I9AIC3                          WTAIC3
     I              I9ELDT                          WTELDT
     I              I9HGCD                          WTHGCD
     I              I9AJCD                          WTAJCD
     I              I9PSAD                          WTPSAD
     I              I9PSAN                          WTPSAN
     I              I9PIAD                          WTPIAD
     I              I9V6ST                          WTV6ST
     I              I9D8C7                          WTD8C7
     I              I9UVST                          WTUVST
     I              I9UWST                          WTUWST
     I              I9UXST                          WTUXST
     I              I9VSST                          WTVSST
     I              I9AATM                          WTAATM
     I              I9AYNA                          WTAYNA
     I              I9A0NA                          WTA0NA
     I              I9AXDT                          WTAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDJW1    E DSPDJWCPL0
      * UPD : PS Availability Audit     Update index
      * Renamed input format fields
     I              JWAIC3                          WHAIC3
     I              JWHMDT                          WHHMDT
     I              JWZPST                          WHZPST
     I              JWASQN                          WHASQN
     I              JWHYQT                          WHHYQT
     I              JWE8ST                          WHE8ST
     I              JWESWG                          WHESWG
     I              JWHZQT                          WHHZQT
     I              JWEQWG                          WHEQWG
     I              JWH0QT                          WHH0QT
     I              JWERWG                          WHERWG
     I              JWH4QT                          WHH4QT
     I              JWEWWG                          WHEWWG
     I              JWICDT                          WHICDT
     I              JWIDDT                          WHIDDT
     I              JWB7C7                          WHB7C7
     I              JWT0CD                          WHT0CD
     I              JWBXVN                          WHBXVN
     I              JWAORN                          WHAORN
     I              JWAOSN                          WHAOSN
     I              JWAOSL                          WHAOSL
     I              JWPSAT                          WHPSAT
     I              JWPSIS                          WHPSIS
     I              JWUVST                          WHUVST
     I              JWUWST                          WHUWST
     I              JWUXST                          WHUXST
     I              JWAATM                          WHAATM
     I              JWAYNA                          WHAYNA
     I              JWA0NA                          WHA0NA
     I              JWAXDT                          WHAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WLAIC3
     I              OMC4NB                          WLC4NB
     I              OMDPNB                          WLDPNB
     I              OMUENB                          WLUENB
     I              OMHGCD                          WLHGCD
     I              OMAJCD                          WLAJCD
     I              OMBKC7                          WLBKC7
     I              OMCFC7                          WLCFC7
     I              OMGMST                          WLGMST
     I              OMGNST                          WLGNST
     I              OMMAVA                          WLMAVA
     I              OMKDVA                          WLKDVA
     I              OML8VA                          WLL8VA
     I              OML9VA                          WLL9VA
     I              OMGTST                          WLGTST
     I              OMGVST                          WLGVST
     I              OMGUST                          WLGUST
     I              OMQFST                          WLQFST
     I              OMAYVA                          WLAYVA
     I              OMEXDT                          WLEXDT
     I              OMLQCD                          WLLQCD
     I              OMRDCD                          WLRDCD
     I              OMQ7CD                          WLQ7CD
     I              OMBZPR                          WLBZPR
     I              OML6NB                          WLL6NB
     I              OMU1ST                          WLU1ST
     I              OMGIDT                          WLGIDT
     I              OMCRCD                          WLCRCD
     I              OMAGCD                          WLAGCD
     I              OMRZST                          WLRZST
     I              OMR0ST                          WLR0ST
     I              OMR1ST                          WLR1ST
     I              OMG7NA                          WLG7NA
     I              OMG8NA                          WLG8NA
     I              OMRPCD                          WLRPCD
     I              OMVEST                          WLVEST
     I              OMVGST                          WLVGST
     I              OMAVST                          WLAVST
     I              OMU0ST                          WLU0ST
     I              OMRFCD                          WLRFCD
     I              OMFZST                          WLFZST
     I              OMR1NB                          WLR1NB
     I              OMAVQT                          WLAVQT
     I              OMD0WG                          WLD0WG
     I              OMCCQT                          WLCCQT
     I              OMAUWG                          WLAUWG
     I              OMCBQT                          WLCBQT
     I              OMATWG                          WLATWG
     I              OMAQCS                          WLAQCS
     I              OMAGCS                          WLAGCS
     I              OMAKPR                          WLAKPR
     I              OMALPR                          WLALPR
     I              OMAUPR                          WLAUPR
     I              OMAVWG                          WLAVWG
     I              OMA4WG                          WLA4WG
     I              OMA5DT                          WLA5DT
     I              OMAODT                          WLAODT
     I              OMGNDT                          WLGNDT
     I              OMAMST                          WLAMST
     I              OMANST                          WLANST
     I              OMVAST                          WLVAST
     I              OMRGNB                          WLRGNB
     I              OMRHNB                          WLRHNB
     I              OMRINB                          WLRINB
     I              OMRBCD                          WLRBCD
     I              OMHICD                          WLHICD
     I              OMRNCD                          WLRNCD
     I              OMROCD                          WLROCD
     I              OMCXDT                          WLCXDT
     I              OMAJVN                          WLAJVN
     I              OMKXCD                          WLKXCD
     I              OMJPCD                          WLJPCD
     I              OMCQCD                          WLCQCD
     I              OMR4CD                          WLR4CD
     I              OMZ1ST                          WLZ1ST
     I              OMZ3ST                          WLZ3ST
     I              OMZ4ST                          WLZ4ST
     I              OMDUPR                          WLDUPR
     I              OMB6VL                          WLB6VL
     I              OMA1AA                          WLA1AA
     I              OMFZSX                          WLFZSX
     I              OMF0SX                          WLF0SX
     I              OMF1SX                          WLF1SX
     I              OMF2SX                          WLF2SX
     I              OMF3SX                          WLF3SX
     I              OMF4SX                          WLF4SX
     I              OMF5SX                          WLF5SX
     I              OMF6SX                          WLF6SX
     I              OMF7SX                          WLF7SX
     I              OMNTDT                          WLNTDT
     I              OMNUDT                          WLNUDT
     I              OMNVDT                          WLNVDT
     I              OMNWDT                          WLNWDT
     I              OMNXDT                          WLNXDT
     I              OMBUTM                          WLBUTM
     I              OMBVTM                          WLBVTM
     I              OMBWTM                          WLBWTM
     I              OMBXTM                          WLBXTM
     I              OMBYTM                          WLBYTM
     I              OMH5NX                          WLH5NX
     I              OMH6NX                          WLH6NX
     I              OMH7NX                          WLH7NX
     I              OMH8NX                          WLH8NX
     I              OMH9NX                          WLH9NX
     I              OMDVPR                          WLDVPR
     I              OMDWPR                          WLDWPR
     I              OMDXPR                          WLDXPR
     I              OMDYPR                          WLDYPR
     I              OMDZPR                          WLDZPR
     I              OMGSPR                          WLGSPR
     I              OMGTPR                          WLGTPR
     I              OMGUPR                          WLGUPR
     I              OMHOST                          WLHOST
     I              OMHPST                          WLHPST
     I              OMIOST                          WLIOST
     I              OMPEWG                          WLPEWG
     I              OMRINY                          WLRINY
     I              OMTIDT                          WLTIDT
     I              OMTJDT                          WLTJDT
     I              OMH2ST                          WLH2ST
     I              OMH0ST                          WLH0ST
     I              OMH1ST                          WLH1ST
     I              OMTKDT                          WLTKDT
     I              OMTLDT                          WLTLDT
     I              OMTMDT                          WLTMDT
     I              OMUVST                          WLUVST
     I              OMUWST                          WLUWST
     I              OMUXST                          WLUXST
     I              OMAATM                          WLAATM
     I              OMAYNA                          WLAYNA
     I              OMA0NA                          WLA0NA
     I              OMAXDT                          WLAXDT
      *
     IYARDCS      DS                            525
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WOAIC3
     I              KNC4NB                          WOC4NB
     I              KNDPNB                          WODPNB
     I              KNUENB                          WOUENB
     I              KNJGDT                          WOJGDT
     I              KNAODT                          WOAODT
     I              KNAJCD                          WOAJCD
     I              KNAYAA                          WOAYAA
     I              KNHGCD                          WOHGCD
     I              KNIGQT                          WOIGQT
     I              KNFLWG                          WOFLWG
     I              KNIUQT                          WOIUQT
     I              KNF3WG                          WOF3WG
     I              KNIVQT                          WOIVQT
     I              KNF4WG                          WOF4WG
     I              KNP7ST                          WOP7ST
     I              KNP8ST                          WOP8ST
     I              KNQAST                          WOQAST
     I              KNUVST                          WOUVST
     I              KNUWST                          WOUWST
     I              KNUXST                          WOUXST
     I              KNVSST                          WOVSST
     I              KNAATM                          WOAATM
     I              KNAYNA                          WOAYNA
     I              KNA0NA                          WOA0NA
     I              KNAXDT                          WOAXDT
      *
     IYBRDCS      DS                            100
     IQCABZ1    E DSCABZREL0
      * UPD : Company Item              Update index
      * Renamed input format fields
     I              BZAIC3                          WRAIC3
     I              BZHGCD                          WRHGCD
     I              BZAVNA                          WRAVNA
     I              BZAWNA                          WRAWNA
     I              BZL7NA                          WRL7NA
     I              BZL8NA                          WRL8NA
     I              BZL6NA                          WRL6NA
     I              BZMFNA                          WRMFNA
     I              BZADCD                          WRADCD
     I              BZAWPC                          WRAWPC
     I              BZLXST                          WRLXST
     I              BZAECD                          WRAECD
     I              BZAXPC                          WRAXPC
     I              BZLYST                          WRLYST
     I              BZAFCD                          WRAFCD
     I              BZAICD                          WRAICD
     I              BZAIWG                          WRAIWG
     I              BZHICD                          WRHICD
     I              BZRBCD                          WRRBCD
     I              BZFZST                          WRFZST
     I              BZAVST                          WRAVST
     I              BZCZWG                          WRCZWG
     I              BZC0WG                          WRC0WG
     I              BZURTN                          WRURTN
     I              BZAJC8                          WRAJC8
     I              BZRINB                          WRRINB
     I              BZRHNB                          WRRHNB
     I              BZRGNB                          WRRGNB
     I              BZLNCD                          WRLNCD
     I              BZTFNB                          WRTFNB
     I              BZN0CD                          WRN0CD
     I              BZX4ST                          WRX4ST
     I              BZTMVA                          WRTMVA
     I              BZTNVA                          WRTNVA
     I              BZBLPR                          WRBLPR
     I              BZBMPR                          WRBMPR
     I              BZLRCD                          WRLRCD
     I              BZU9ST                          WRU9ST
     I              BZCMCO                          WRCMCO
     I              BZQ1CD                          WRQ1CD
     I              BZQ8CD                          WRQ8CD
     I              BZCHTM                          WRCHTM
     I              BZQZCD                          WRQZCD
     I              BZXWST                          WRXWST
     I              BZXXST                          WRXXST
     I              BZVMST                          WRVMST
     I              BZSWGH                          WRSWGH
     I              BZPPHE                          WRPPHE
     I              BZR3CD                          WRR3CD
     I              BZSDCD                          WRSDCD
     I              BZICN1                          WRICN1
     I              BZSVCD                          WRSVCD
     I              BZICN2                          WRICN2
     I              BZSWCD                          WRSWCD
     I              BZV2NB                          WRV2NB
     I              BZSXCD                          WRSXCD
     I              BZITCN                          WRITCN
     I              BZSYCD                          WRSYCD
     I              BZITC5                          WRITC5
     I              BZSZCD                          WRSZCD
     I              BZICN6                          WRICN6
     I              BZS0CD                          WRS0CD
     I              BZICN7                          WRICN7
     I              BZS1CD                          WRS1CD
     I              BZICN8                          WRICN8
     I              BZS2CD                          WRS2CD
     I              BZICN9                          WRICN9
     I              BZS3CD                          WRS3CD
     I              BZICN0                          WRICN0
     I              BZS4CD                          WRS4CD
     I              BZSFNB                          WRSFNB
     I              BZA3WG                          WRA3WG
     I              BZSJNB                          WRSJNB
     I              BZLLCD                          WRLLCD
     I              BZLMCD                          WRLMCD
     I              BZP3ST                          WRP3ST
     I              BZSKNB                          WRSKNB
     I              BZSLNB                          WRSLNB
     I              BZSMNB                          WRSMNB
     I              BZP4ST                          WRP4ST
     I              BZCFNB                          WRCFNB
     I              BZCGNB                          WRCGNB
     I              BZILNB                          WRILNB
     I              BZCHNB                          WRCHNB
     I              BZCINB                          WRCINB
     I              BZCJNB                          WRCJNB
     I              BZCMNB                          WRCMNB
     I              BZCNNB                          WRCNNB
     I              BZCRNB                          WRCRNB
     I              BZCSNB                          WRCSNB
     I              BZCVNB                          WRCVNB
     I              BZCWNB                          WRCWNB
     I              BZCXNB                          WRCXNB
     I              BZCZNB                          WRCZNB
     I              BZC0NB                          WRC0NB
     I              BZN1CD                          WRN1CD
     I              BZB4NB                          WRB4NB
     I              BZB5NB                          WRB5NB
     I              BZX5ST                          WRX5ST
     I              BZX6ST                          WRX6ST
     I              BZX7ST                          WRX7ST
     I              BZPCCT                          WRPCCT
     I              BZBDNB                          WRBDNB
     I              BZBJNB                          WRBJNB
     I              BZSUST                          WRSUST
     I              BZSVST                          WRSVST
     I              BZSYST                          WRSYST
     I              BZSZST                          WRSZST
     I              BZS1ST                          WRS1ST
     I              BZXRCD                          WRXRCD
     I              BZXTCD                          WRXTCD
     I              BZXUCD                          WRXUCD
     I              BZF5WG                          WRF5WG
     I              BZF6WG                          WRF6WG
     I              BZF7WG                          WRF7WG
     I              BZBLNB                          WRBLNB
     I              BZBNNB                          WRBNNB
     I              BZS2ST                          WRS2ST
     I              BZS4ST                          WRS4ST
     I              BZS5ST                          WRS5ST
     I              BZS6ST                          WRS6ST
     I              BZS8ST                          WRS8ST
     I              BZS9ST                          WRS9ST
     I              BZTCST                          WRTCST
     I              BZTDST                          WRTDST
     I              BZUVST                          WRUVST
     I              BZUWST                          WRUWST
     I              BZUXST                          WRUXST
     I              BZVSST                          WRVSST
     I              BZAATM                          WRAATM
     I              BZAYNA                          WRAYNA
     I              BZA0NA                          WRA0NA
     I              BZAXDT                          WRAXDT
      *
     IYCRDCS      DS                            605
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDI91    E DSPDI9CPL0
      * UPD : PS Production Adjustment  Update index
      * Renamed input format fields
     I              I9AIC3                          WTAIC3
     I              I9ELDT                          WTELDT
     I              I9HGCD                          WTHGCD
     I              I9AJCD                          WTAJCD
     I              I9PSAD                          WTPSAD
     I              I9PSAN                          WTPSAN
     I              I9PIAD                          WTPIAD
     I              I9V6ST                          WTV6ST
     I              I9D8C7                          WTD8C7
     I              I9UVST                          WTUVST
     I              I9UWST                          WTUWST
     I              I9UXST                          WTUXST
     I              I9VSST                          WTVSST
     I              I9AATM                          WTAATM
     I              I9AYNA                          WTAYNA
     I              I9A0NA                          WTA0NA
     I              I9AXDT                          WTAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Company Number
     I                                    P   1   20P1AIC3
      * N :  Kill Date
     I                                    P   3   60P1GGDT
      * N :  Kill Date RGF
     I                                    P   7  100P1IEDT
      * N :  Kill Date RGT
     I                                    P  11  140P1IFDT
      * N :  Production Date
     I                                    P  15  180P1ELDT
      * N :  Production Date RGF
     I                                    P  19  220P1GVDT
      * N :  Production Date RGT
     I                                    P  23  260P1GWDT
     IP2PARM      DS
      * N :  System Value Numeric
     I                                    P   1   85P2M8NB
     IP3PARM      DS
      * N :  Average Live Weight
     I                                    P   1   30P3Z6NB
     IP4PARM      DS
      * FLD: Calendar
      * N :  Kill Day Status
     I                                        1   1 P4V9ST
      * N :  Production Day Status
     I                                        2   2 P4WAST
     IP5PARM      DS
      * FLD: User Profile Control
      * N :  User Code Model
     I                                        1  10 P5BUVN
     IP6PARM      DS
      * N :  Production Date USR
     I                                    P   1   40P6GXDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * zPS Bld Sch/Pln Night XF
      * FP1054 chg duration from 25 to 40 days -- lcl,*duration (factor)
      * Set Up Kill & Production Date / Kill & Production Date Ranges
     C                     EXSR UASUBR                     Set Up Kill & P
      * Del Avail Audit       RT - PS Availability Audit  * 
     C                     EXSR SHRVGN
      * Rtv Kill/Prod Day Sts RT - Calendar  * 
     C                     EXSR SJRVGN
      * Recalculate Weight Scheduled for Item with Unit Weight Changed.
      * UPS ReClc Wgt Sched   RT - Company Item  * 
     C                     EXSR SKRVGN
      * Build Schedule
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Kill Day Status is yes
      *   |- c2    : PAR.Production Day Status is yes
      *   '-
     C           P4V9ST    IFEQ 'Y'                        *IF
     C           P4WAST    OREQ 'Y'                        *OR
      * UPS Bld Sched/Plan    XF - PS Prod Schedule  * 
     C                     CALL 'PDRQXFR'              90  zPS Bld Sched/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0010  30       Company Number
     C                     PARM P1GGDT    WQ0011  70       Kill Date
     C                     PARM P1IEDT    WQ0012  70       Kill Date RGF
     C                     PARM P1IFDT    WQ0013  70       Kill Date RGT
     C                     PARM P1ELDT    WQ0014  70       Production Date
     C                     PARM P1GVDT    WQ0015  70       Production Date
     C                     PARM P1GWDT    WQ0016  70       Production Date
     C                     PARM 'Y'       WQ0017  1        First Lvl Prod
     C                     PARM 'N'       WQ0018  1        Overlay Schedul
     C                     PARM 'JOBSCHED'WQ0019 10        PSAA Program Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPD FRZTRMPROD To 'N'  XF - Company Values  * 
     C                     CALL 'PDC6XFR'              90  UPD FRZTRMPROD
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0020  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDC6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * PAR.Production Date USR = PAR.Production Date + CON.-1 *DAYS
     C           P1ELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P6GXDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P6GXDT
     C                     END
      * Del One Time Prod Adj RT - PS Production Adjustment  * 
     C                     EXSR SSRVGN
      * Roll Current Kill Date to Next Kill Date
      * CASE: PAR.Kill Day Status is yes
     C           P4V9ST    IFEQ 'Y'                        *IF
      * UPS Upd Kill Dates    XF - PS Prod Schedule  * 
     C                     CALL 'PDTMXFR'              90  UPS Upd Kill Da
     C                     PARM *BLANK    W0RTN   7
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     WAAJVN           User Profile Na
      * Establish starting position
     C           KRSSA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P5BUVN           User Code Model
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABUVN    P5BUVN           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Appl. Default Co   RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJVN           User Profile Na
     C                     KFLD           WBDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    WBAJVN           User Profile Na
     C                     MOVELWL0002    WBDNCD           Application Cod
      * Establish starting position
     C           KRSSB     CHAIN@DTRETE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0767' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0003           Company Number
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAIC3    WL0003           Company Number
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    WCAIC3           Company Number
     C                     MOVEL@CN,01    WCV8CD           Company Value C
      * Establish starting position
     C           KRSSC     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCM8NB    P2M8NB           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Next Kill Date     RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WDBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSD01           Company Number
     C                     Z-ADDP1GGDT    WDBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSD     SETLL@AFREBE                    *
     C           KRSSD     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P1IEDT           Kill Date
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Post to G/L Date EQ PAR.Post to G/L Date
     C           WDBCDT    IFEQ P1GGDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Kill Day Status is yes
     C           WDV9ST    IFEQ 'Y'                        *IF
     C                     Z-ADDWDBCDT    P1IEDT           Kill Date
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV KillDay Dte-Durtn  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WEBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSE01           Company Number
     C                     Z-ADDP1IEDT    WEBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSE     SETLL@AFREC2                    *
     C           KRSSE     READE@AFREC2                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ YL0001                     *IF
     C                     Z-ADDWEBCDT    P1IFDT           *DATE
     C                     GOTO SEEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSE     READE@AFREC2                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Prdctn Dt w/Kill  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSF01           Company Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WDBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSF01           Company Number
     C                     Z-ADDP1GGDT    WDBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSF     SETLL@AFREBE                    *
     C           KRSSF     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Production Day Status is yes
     C           WDWAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWDBCDT    P1ELDT           Production Date
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSG01           Company Number
     C                     Z-ADDP1GVDT    WFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSG     SETLL@AFREY1                    *
     C           KRSSG     READE@AFREY1                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ YL0001                     *IF
     C                     Z-ADDWFBCDT    P1GWDT           *DATE
     C                     GOTO SGEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSG     READE@AFREY1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Del Avail Audit       RT - PS Availability Audit  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSH01           Company Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSH01           Company Number
      * Establish starting position
     C           KRSSH     SETLL@JWCPBB                    *
     C           KRSSH     READE@JWCPBB                  90*
      * Data record not found
     C   90                MOVEL'USR2001' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Avail Audit       DL - PS Availability Audit  * 
     C                     EXSR SIDLRC
     C           KRSSH     READE@JWCPBB                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * Del Avail Audit       DL - PS Availability Audit  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JWCPBA
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGHMDT    WHHMDT           PSAA Audit Date
     C                     MOVELWGZPST    WHZPST           PSAA Audit Type
     C                     Z-ADDWGASQN    WHASQN           PSAA Audit Sequ
      *
     C           KLDLSI    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHMDT           PSAA Audit Date
     C                     KFLD           WHZPST           PSAA Audit Type
     C                     KFLD           WHASQN           PSAA Audit Sequ
     C           KLDLSI    CHAIN@JWCPBA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJWCPL0'MDACP
     C                     MOVEL'@JWCPBA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JWCPBA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Kill/Prod Day Sts RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
     C                     Z-ADD##JDT     WDBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSJ     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P4V9ST           Kill Day Status
     C                     MOVEL*BLANK    P4WAST           Production Day
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDV9ST    P4V9ST           Kill Day Status
     C                     MOVELWDWAST    P4WAST           Production Day
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * UPS ReClc Wgt Sched   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSK01           Company Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSK01           Company Number
      * Establish starting position
     C           KRSSK     SETLL@BZREIT                    *
     C           KRSSK     READE@BZREIT                  90*
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * UPS ReClc Wgt Sched   RT - PD Order Detail  * 
     C                     EXSR SLRVGN
      * Chg Unit Wgt Chg Sts  CH - Company/Item  * 
     C                     EXSR SRCHRC
     C           KRSSK     READE@BZREIT                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * UPS ReClc Wgt Sched   RT - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0002 112       Weight Schedule
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WJHGCD    WQSL02           Item Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Item Code
      * Setup key
     C                     Z-ADDWIAIC3    WQSL01           Company Number
     C                     Z-ADDWIHGCD    WQSL02           Item Code
      * Establish starting position
     C           KRSSL     SETLL@BGWKKG                    *
     C           KRSSL     READE@BGWKKG                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
     C                     EXSR SMRVGN
      * CASE: LCL.Billing Activity Type is Invoice or Transfer
     C           YL0003    IFEQ '1'                        *IF
     C           YL0003    OREQ '4'
     C           WJCCQT    MULT WIAIWG    WN0002    H      Weight Schedule
     C           WJAVQT    MULT WIAIWG    WN0001    H      Weight Ordered
      * Chg Wgt Sched,Unit Wt CH - Order Detail  * 
     C                     EXSR SNCHRC
      * UPS ReClc Wgt Sched   RT - Order Detail Schedule  * 
     C                     EXSR SORVGN
      * ****    PDD012   ********
      * EDT Post Open Orders   XF - PD Order Header  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WJAIC3    WQ0001  30       Company Number
     C                     PARM WJC4NB    WQ0002  70       Order Number
     C                     PARM WJBKC7    WQ0003  70       Ship To Custome
     C           WUB5VL    PARM WUB5VL    WQ0004 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0005 112       Order Weight To
     C                     PARM 'UWC'     WQ0006  3        Pricing Event C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Load ID            RT - PD Order Header  * 
     C                     EXSR SQRVGN
      * RMC 02/05/07 do this only if there is a Load on the Order
      * CASE: WRK.Load ID is NE Blank
     C           WURMNB    IFNE *ZERO                      *IF
      * RTV UPD Ld Abs.Frt/Wgt XF - PD Order Header  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WURMNB    WQ0007  70       Load ID
     C           WURPNB    PARM WURPNB    WQ0008  70       Total Load Orde
     C           WURQNB    PARM WURQNB    WQ0009 112       Total Freight
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@BGWKKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
      * Setup key
     C                     Z-ADDWJAIC3    WKAIC3           Company Number
     C                     Z-ADDWJC4NB    WKC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKGWST    YL0002           Header Status
     C                     MOVELWKOBST    YL0003           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Wgt Sched,Unit Wt CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       Item Code
     C                     MOVEL*BLANK    WN0004  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0005  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0006  70       Order Group Cod
     C                     MOVEL*BLANK    WN0007  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0008  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0009 112       Billing Detail
     C                     Z-ADD*ZERO     WN0010 112       Billing Detail
     C                     Z-ADD*ZERO     WN0011 112       Billing Detail
     C                     Z-ADD*ZERO     WN0012 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0013  1        Comment Print A
     C                     MOVEL*BLANK    WN0014  1        Comment Print I
     C                     MOVEL*BLANK    WN0015  1        Comment Print P
     C                     MOVEL*BLANK    WN0016  1        Comment Print S
     C                     Z-ADD*ZERO     WN0017 112       Extended Amount
     C                     Z-ADD*ZERO     WN0018  70       Market Pricing
     C                     MOVEL*BLANK    WN0019  3        Commodity Marke
     C                     MOVEL*BLANK    WN0020  3        Date Method Cod
     C                     MOVEL*BLANK    WN0021  3        Price Method Co
     C                     Z-ADD*ZERO     WN0022 114       Price Overage O
     C                     Z-ADD*ZERO     WN0023  70       Contract Number
     C                     MOVEL*BLANK    WN0024  1        Price Status
     C                     Z-ADD*ZERO     WN0025  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0026  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0027  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0028  1        Work Confirm St
     C                     MOVEL*BLANK    WN0029  1        Work Over/Short
     C                     MOVEL*BLANK    WN0030  1        OD Production P
     C                     MOVEL*BLANK    WN0031 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0032 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0033  1        Age Code
     C                     MOVEL*BLANK    WN0034  1        Palletize
     C                     MOVEL*BLANK    WN0035  1        Slip Sheet
     C                     MOVEL*BLANK    WN0036  1        Catch Weight St
     C                     MOVEL*BLANK    WN0037  1        Price Audit
     C                     MOVEL*BLANK    WN0038  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0039  1        Production Date
     C                     Z-ADD*ZERO     WN0040 112       Rated Freight
     C                     Z-ADD*ZERO     WN0041 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0042 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0043 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0044 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0045 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Price
     C                     Z-ADD*ZERO     WN0048 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0049 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0050 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0051  70       Requested Ship
     C                     Z-ADD*ZERO     WN0052  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0053  70       Actual Shipped
     C                     MOVEL*BLANK    WN0054  1        Affect Inventor
     C                     MOVEL*BLANK    WN0055  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0056  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0057  30       Item Structure
     C                     Z-ADD*ZERO     WN0058  30       Item Structure
     C                     Z-ADD*ZERO     WN0059  30       Item Structure
     C                     MOVEL*BLANK    WN0060  2        Item Level
     C                     MOVEL*BLANK    WN0061  2        Quality Level
     C                     MOVEL*BLANK    WN0062  2        Pricing Product
     C                     MOVEL*BLANK    WN0063  2        Season Product
     C                     Z-ADD*ZERO     WN0064  70       Date of Origina
     C                     MOVEL*BLANK    WN0065 10        User Profile Na
     C                     MOVEL*BLANK    WN0066  6        Country Code
     C                     MOVEL*BLANK    WN0067  2        Event Code
     C                     MOVEL*BLANK    WN0068  3        Reason Code
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  1        Modified Flag
     C                     MOVEL*BLANK    WN0071  1        Substituted Fla
     C                     MOVEL*BLANK    WN0072  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0073 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0074 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0075  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0076  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0077  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0078  1        Affect Commissi
     C                     MOVEL*BLANK    WN0079  1        Affect Pricing
     C                     MOVEL*BLANK    WN0080  1        Released by Use
     C                     MOVEL*BLANK    WN0081  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0082  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0083  3        Production Ware
     C                     MOVEL*BLANK    WN0084  3        OD Price Type
     C                     Z-ADD*ZERO     WN0085  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0086  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0087  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0088  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0089  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0090  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0091  60       Price Code
     C                     Z-ADD*ZERO     WN0092  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0093  60       Substitution Li
     C                     Z-ADD*ZERO     WN0094  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0095 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0096 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0097 112       OD Item Target
     C                     Z-ADD*ZERO     WN0098 112       OD Minimum Unit
     C                     Z-ADD*ZERO     WN0099 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0100 114       Order Gate Pric
     C                     Z-ADD*ZERO     WN0101 114       OD Base MKT Ovr
     C                     Z-ADD*ZERO     WN0102 114       OD Unused Prc 3
     C                     Z-ADD*ZERO     WN0103 114       OD Unused Prc 4
     C                     Z-ADD*ZERO     WN0104 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0105 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0106 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0107 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0108  1        OD UnUsed Price
     C                     MOVEL*BLANK    WN0109  1        OD UnUsed Price
     C                     MOVEL*BLANK    WN0110  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0111 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0112  40       Delv Ageing Day
     C                     Z-ADD*ZERO     WN0113  70       Production Ovr
     C                     Z-ADD*ZERO     WN0114  70       Production Ovr
     C                     MOVEL*BLANK    WN0115  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0116  2        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0117  3        OD UnUsed Statu
     C                     Z-ADD*ZERO     WN0118  70       OD UnUsed Date
     C                     Z-ADD*ZERO     WN0119  70       OD UnUsed Date
     C                     Z-ADD*ZERO     WN0120  70       OD UnUsed Date
     C                     MOVEL*BLANK    WN0121  1        EDI Status 1
     C                     MOVEL*BLANK    WN0122  1        EDI Status 2
     C                     MOVEL*BLANK    WN0123  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0124  60       Job Time
     C                     MOVEL*BLANK    WN0125 10        User Id
     C                     MOVEL*BLANK    WN0126 10        Job Name
     C                     Z-ADD*ZERO     WN0127  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWJAIC3    WLAIC3           Company Number
     C                     Z-ADDWJC4NB    WLC4NB           Order Number
     C                     Z-ADDWJDPNB    WLDPNB           Order Sequence
     C                     Z-ADDWJUENB    WLUENB           Order Secondary
      *
     C           KLCHSN    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
     C           KLCHSN    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWN0001    WLD0WG           Weight Ordered
     C                     Z-ADDWN0002    WLAUWG           Weight Schedule
     C                     Z-ADDWIAIWG    WLAVWG           Unit Weight Ord
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * UPS ReClc Wgt Sched   RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0128 112       OD Weight Sched
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WMC4NB    WQSO02           Order Number
     C           *LIKE     DEFN WMDPNB    WQSO03           Order Sequence
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           WQSO03           Order Sequence
      * Setup key
     C                     Z-ADDWJAIC3    WQSO01           Company Number
     C                     Z-ADDWJC4NB    WQSO02           Order Number
     C                     Z-ADDWJDPNB    WQSO03           Order Sequence
      * Establish starting position
     C           KRSSO     SETLL@KNCPHO                    *
     C           KRSSO     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WMIGQT    MULT WIAIWG    WN0128    H      OD Weight Sched
      * CHG Weight Scheduled   CH - PD Order Detail Schedule  * 
     C                     EXSR SPCHRC
     C           KRSSO     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG Weight Scheduled   CH - PD Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0129  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0130  3        Warehouse Code
     C                     MOVEL*BLANK    WN0131  3        Order From Ware
     C                     Z-ADD*ZERO     WN0132  70       Item Code
     C                     Z-ADD*ZERO     WN0133 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0134 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0135 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0136 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0137 112       OD Weight Unuse
     C                     MOVEL*BLANK    WN0138  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0139  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0140  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0141  1        EDI Status 1
     C                     MOVEL*BLANK    WN0142  1        EDI Status 2
     C                     MOVEL*BLANK    WN0143  1        EDI Status 3
     C                     MOVEL*BLANK    WN0144  1        Record Status
     C                     Z-ADD*ZERO     WN0145  60       Job Time
     C                     MOVEL*BLANK    WN0146 10        User Id
     C                     MOVEL*BLANK    WN0147 10        Job Name
     C                     Z-ADD*ZERO     WN0148  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWMAIC3    WOAIC3           Company Number
     C                     Z-ADDWMC4NB    WOC4NB           Order Number
     C                     Z-ADDWMDPNB    WODPNB           Order Sequence
     C                     Z-ADDWMUENB    WOUENB           Order Secondary
     C                     Z-ADDWMJGDT    WOJGDT           OD Production D
      *
     C           KLCHSP    KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOC4NB           Order Number
     C                     KFLD           WODPNB           Order Sequence
     C                     KFLD           WOUENB           Order Secondary
     C                     KFLD           WOJGDT           OD Production D
     C           KLCHSP    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YBRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0128    WOFLWG           OD Weight Sched
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WOAATM           Job Time
     C                     MOVEL##USR     WOAYNA           User Id
     C                     MOVEL##JOB     WOA0NA           Job Name
     C                     Z-ADD##JDT     WOAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Load ID            RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
      * Setup key
     C                     Z-ADDWJAIC3    WKAIC3           Company Number
     C                     Z-ADDWJC4NB    WKC4NB           Order Number
      * Establish starting position
     C           KRSSQ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WURMNB           Load ID
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKRMNB    WURMNB           Load ID
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Unit Wgt Chg Sts  CH - Company/Item  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0149 30        Description Lin
     C                     MOVEL*BLANK    WN0150 30        Description Lin
     C                     MOVEL*BLANK    WN0151 32        Item Label Line
     C                     MOVEL*BLANK    WN0152 32        Item Label Line
     C                     MOVEL*BLANK    WN0153 32        Item Label Line
     C                     MOVEL*BLANK    WN0154 32        Item Label Line
     C                     MOVEL*BLANK    WN0155  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0156  94       Conversion Fact
     C                     MOVEL*BLANK    WN0157  1        Operation Facto
     C                     MOVEL*BLANK    WN0158  2        U/M - Second
     C                     Z-ADD*ZERO     WN0159  94       Conversion Fact
     C                     MOVEL*BLANK    WN0160  1        Operation Facto
     C                     MOVEL*BLANK    WN0161  2        U/M - Third
     C                     MOVEL*BLANK    WN0162  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0163 112       Unit Weight
     C                     MOVEL*BLANK    WN0164  2        Quality Level
     C                     MOVEL*BLANK    WN0165  2        Item Level
     C                     MOVEL*BLANK    WN0166  1        Production Date
     C                     MOVEL*BLANK    WN0167  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0168 112       Minimum Weight
     C                     Z-ADD*ZERO     WN0169 112       Maximum Weight
     C                     Z-ADD*ZERO     WN0170  50       Number Cases On
     C                     Z-ADD*ZERO     WN0171  80       Vendor - Item D
     C                     Z-ADD*ZERO     WN0172  30       Item Structure
     C                     Z-ADD*ZERO     WN0173  30       Item Structure
     C                     Z-ADD*ZERO     WN0174  30       Item Structure
     C                     MOVEL*BLANK    WN0175  3        Default Commod
     C                     Z-ADD*ZERO     WN0176  30       Transportation
     C                     MOVEL*BLANK    WN0177  3        Item Type Code
     C                     MOVEL*BLANK    WN0178  1        Package Type Co
     C                     Z-ADD*ZERO     WN0179 112       Maximum Audit V
     C                     Z-ADD*ZERO     WN0180 112       Minimum Audit V
     C                     Z-ADD*ZERO     WN0181 114       Market Overage
     C                     Z-ADD*ZERO     WN0182 114       Standard Overag
     C                     MOVEL*BLANK    WN0183  7        Commodity Price
     C                     MOVEL*BLANK    WN0184  1        Item Pricing Op
     C                     Z-ADD*ZERO     WN0185 114       Item Pricing Co
     C                     MOVEL*BLANK    WN0186  3        Default Warehou
     C                     MOVEL*BLANK    WN0187  3        Price Method De
     C                     Z-ADD*ZERO     WN0188  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0189  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0190  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0191  1        Frozen Make to
     C                     MOVEL*BLANK    WN0192  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0193 112       Std Weight/Head
     C                     Z-ADD*ZERO     WN0194  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0195  6        Department Code
     C                     MOVEL*BLANK    WN0196  1        Group for Packa
     C                     Z-ADD*ZERO     WN0197  20       Item Category N
     C                     MOVEL*BLANK    WN0198  3        MTO Code
     C                     Z-ADD*ZERO     WN0199  20       Item Category N
     C                     MOVEL*BLANK    WN0200  3        Item Category C
     C                     Z-ADD*ZERO     WN0201  20       Item Category N
     C                     MOVEL*BLANK    WN0202  3        Item Category C
     C                     Z-ADD*ZERO     WN0203  20       Item Category N
     C                     MOVEL*BLANK    WN0204  3        G/L Sub Code
     C                     Z-ADD*ZERO     WN0205  20       Item Category N
     C                     MOVEL*BLANK    WN0206  3        Item Category C
     C                     Z-ADD*ZERO     WN0207  20       Item Category N
     C                     MOVEL*BLANK    WN0208  3        Item Category C
     C                     Z-ADD*ZERO     WN0209  20       Item Category N
     C                     MOVEL*BLANK    WN0210  3        Item Category C
     C                     Z-ADD*ZERO     WN0211  20       Item Category N
     C                     MOVEL*BLANK    WN0212  3        Item Category C
     C                     Z-ADD*ZERO     WN0213  20       Item Category N
     C                     MOVEL*BLANK    WN0214  3        Item Category C
     C                     Z-ADD*ZERO     WN0215  20       Item Category N
     C                     MOVEL*BLANK    WN0216  3        Item Category C
     C                     Z-ADD*ZERO     WN0217  52       Pallet Tare Wei
     C                     Z-ADD*ZERO     WN0218  52       Misc Tare Weigh
     C                     Z-ADD*ZERO     WN0219  30       Production Lead
     C                     MOVEL*BLANK    WN0220  3        Packaging Code
     C                     MOVEL*BLANK    WN0221  3        Item Market Cod
     C                     MOVEL*BLANK    WN0222  1        TF Co-Ownership
     C                     Z-ADD*ZERO     WN0223  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0224  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0225  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0226  1        PA Base Avail R
     C                     Z-ADD*ZERO     WN0227 114       PM Pounds per H
     C                     Z-ADD*ZERO     WN0228  74       Item Frt Overag
     C                     Z-ADD*ZERO     WN0229  74       PM % 2nds Facto
     C                     Z-ADD*ZERO     WN0230  30       Use/Freeze/Sell
     C                     Z-ADD*ZERO     WN0231 114       PM Batch Size
     C                     Z-ADD*ZERO     WN0232 114       PM Lot Size
     C                     Z-ADD*ZERO     WN0233  70       Partial Item Co
     C                     Z-ADD*ZERO     WN0234  70       WIP Item Code
     C                     Z-ADD*ZERO     WN0235  70       WIP Reject Code
     C                     Z-ADD*ZERO     WN0236  92       Std Costing Uni
     C                     Z-ADD*ZERO     WN0237  92       FP Std Green We
     C                     Z-ADD*ZERO     WN0238 114       PM Standard LBS
     C                     Z-ADD*ZERO     WN0239 114       PM Raw Meat LBS
     C                     Z-ADD*ZERO     WN0240 114       PM Formula LBS/
     C                     Z-ADD*ZERO     WN0241 114       PM Finished LBS
     C                     MOVEL*BLANK    WN0242  3        SH Unused (was
     C                     Z-ADD*ZERO     WN0243  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WN0244  50       PM Line Number
     C                     MOVEL*BLANK    WN0245  1        Seconds Item
     C                     MOVEL*BLANK    WN0246  2        Print on Realiz
     C                     MOVEL*BLANK    WN0247  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0248  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0249  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0250  1        Export/Domestic
     C                     MOVEL*BLANK    WN0251  1        Print On Schedu
     C                     MOVEL*BLANK    WN0252  1        Fresh Inv Alloc
     C                     MOVEL*BLANK    WN0253  1        Fresh Sched As
     C                     MOVEL*BLANK    WN0254  1        Frozen Inv Allo
     C                     MOVEL*BLANK    WN0255  6        Primal Group Co
     C                     MOVEL*BLANK    WN0256 12        UPC Code 1
     C                     MOVEL*BLANK    WN0257 12        UPC Code 2
     C                     Z-ADD*ZERO     WN0258 112       Item Target Pri
     C                     Z-ADD*ZERO     WN0259 112       Minimum Piece W
     C                     Z-ADD*ZERO     WN0260 112       Maximum Piece W
     C                     Z-ADD*ZERO     WN0261  70       Seaboard Equiva
     C                     Z-ADD*ZERO     WN0262  70       Production Qty
     C                     MOVEL*BLANK    WN0263  1        Scheduling Posi
     C                     MOVEL*BLANK    WN0264  1        Sold 100% Froze
     C                     MOVEL*BLANK    WN0265  1        Maximum Shifts
     C                     MOVEL*BLANK    WN0266  1        Value Added Sts
     C                     MOVEL*BLANK    WN0267  2        Label Type
     C                     MOVEL*BLANK    WN0268  2        Item TF Exempt
     C                     MOVEL*BLANK    WN0269  3        Item TF Classif
     C                     MOVEL*BLANK    WN0270  3        Default Workcen
     C                     MOVEL*BLANK    WN0271  1        EDI Status 1
     C                     MOVEL*BLANK    WN0272  1        EDI Status 2
     C                     MOVEL*BLANK    WN0273  1        EDI Status 3
     C                     MOVEL*BLANK    WN0274  1        Record Status
     C                     Z-ADD*ZERO     WN0275  60       Job Time
     C                     MOVEL*BLANK    WN0276 10        User Id
     C                     MOVEL*BLANK    WN0277 10        Job Name
     C                     Z-ADD*ZERO     WN0278  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BZREJV
     C                     Z-ADDWIAIC3    WRAIC3           Company Number
     C                     Z-ADDWIHGCD    WRHGCD           Item Code
      *
     C           KLCHSR    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRHGCD           Item Code
     C           KLCHSR    CHAIN@BZREJV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CABZREL0'MDACP
     C                     MOVEL'@BZREJV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCABZ1    YCRDCS
      * Move non-key fields to @BZREJV
     C                     MOVEL'NO'      WRX7ST    P      Unit Weight Cha
      *
      * Set PGM.*Record Data Changed flag
     C           QCABZ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCABZ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BZREJV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCABZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Del One Time Prod Adj RT - PS Production Adjustment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQSS01           Company Number
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WSELDT           Production Date
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSS01           Company Number
     C                     Z-ADDP6GXDT    WSELDT           Production Date
      * Establish starting position
     C           KPSSS     SETLL@I9CPN1                    *
     C           KRSSS     READE@I9CPN1                  90*
      * Data record not found
     C   90                MOVEL'USR1765' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Prod. Adjustment  DL - PS Production Adjustment  * 
     C                     EXSR STDLRC
     C           KRSSS     READE@I9CPN1                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STDLRC    BEGSR
      *================================================================
      * Dlt Prod. Adjustment  DL - PS Production Adjustment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @I9CPUU
     C                     Z-ADDWSAIC3    WTAIC3           Company Number
     C                     Z-ADDWSELDT    WTELDT           Production Date
     C                     Z-ADDWSHGCD    WTHGCD           Item Code
     C                     MOVELWSAJCD    WTAJCD           Warehouse Code
     C                     MOVELWSPSAD    WTPSAD           PS Adjustment T
     C                     Z-ADDWSPSAN    WTPSAN           PS Adjustment N
      *
     C           KLDLST    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C                     KFLD           WTPSAD           PS Adjustment T
     C                     KFLD           WTPSAN           PS Adjustment N
     C           KLDLST    CHAIN@I9CPUU              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI9CPL0'MDACP
     C                     MOVEL'@I9CPUU' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@I9CPUU                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Set Up Kill & Production Date / Kill & Production Date Ranges
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR SARVGN
      * CASE: PAR.User Code Model is equal to blank
     C           P5BUVN    IFEQ *BLANK                     *IF
      * RTV Appl. Default Co   RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0001    P      User Profile Na
     C                     MOVEL'P/S'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    P1AIC3           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Default Co   RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP5BUVN    WL0001    P      User Profile Na
     C                     MOVEL'P/S'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    P1AIC3           Company Number
     C                     END                             *FI
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SCRVGN
      * PAR.Kill Date = PAR.System Value Numeric
     C                     Z-ADDP2M8NB    P1GGDT           Kill Date
      * RTV Next Kill Date     RT - Calendar  * 
     C                     EXSR SDRVGN
     C                     Z-ADD40        YL0001           *Duration (fact
      * RTV KillDay Dte-Durtn  RT - Calendar  * 
     C                     EXSR SERVGN
      * Rtv Prdctn Dt w/Kill  RT - Calendar  * 
     C                     EXSR SFRVGN
     C                     Z-ADDP1ELDT    P1GVDT           Production Date
     C                     Z-ADD40        YL0001           *Duration (fact
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
     C                     EXSR SGRVGN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     Z-ADD*ZERO     P1GGDT           Kill Date
     C                     Z-ADD*ZERO     P1IEDT           Kill Date RGF
     C                     Z-ADD*ZERO     P1IFDT           Kill Date RGT
     C                     Z-ADD*ZERO     P1ELDT           Production Date
     C                     Z-ADD*ZERO     P1GVDT           Production Date
     C                     Z-ADD*ZERO     P1GWDT           Production Date
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     Z-ADD*ZERO     P3Z6NB           Average Live We
     C                     MOVEL*BLANK    P4V9ST           Kill Day Status
     C                     MOVEL*BLANK    P4WAST           Production Day
     C                     MOVEL*BLANK    P5BUVN           User Code Model
     C                     Z-ADD*ZERO     P6GXDT           Production Date
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WANLNB           Entity Number
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCM8NB           System Value Nu
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WDCQNB           Julian Date
     C                     Z-ADD*ZERO     WDESNB           Accounting Year
     C                     Z-ADD*ZERO     WDETNB           Accounting Peri
     C                     Z-ADD*ZERO     WDBZNB           OM Week
     C                     Z-ADD*ZERO     WDEINB           Week Number
     C                     Z-ADD*ZERO     WDAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WDOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WDNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WDNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WDOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WDOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHMDT           PSAA Audit Date
     C                     Z-ADD*ZERO     WGASQN           PSAA Audit Sequ
     C                     Z-ADD*ZERO     WGHYQT           PSAA Quantity O
     C                     Z-ADD*ZERO     WGESWG           PSAA Weight Ord
     C                     Z-ADD*ZERO     WGHZQT           PSAA Quantity A
     C                     Z-ADD*ZERO     WGEQWG           PSAA Weight All
     C                     Z-ADD*ZERO     WGH0QT           PSAA Quantity S
     C                     Z-ADD*ZERO     WGERWG           PSAA Weight Shi
     C                     Z-ADD*ZERO     WGH4QT           PSAA Quantity A
     C                     Z-ADD*ZERO     WGEWWG           PSAA Weight Adj
     C                     Z-ADD*ZERO     WGICDT           PSAA Ship Date
     C                     Z-ADD*ZERO     WGIDDT           PSAA Production
     C                     Z-ADD*ZERO     WGB7C7           PSAA Item Code
     C                     Z-ADD*ZERO     WGAORN           PSAA Order Numb
     C                     Z-ADD*ZERO     WGAOSN           PSAA Order Seq
     C                     Z-ADD*ZERO     WGAOSL           PSAA Order Seco
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WIAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WIAIWG           Unit Weight
     C                     Z-ADD*ZERO     WICZWG           Minimum Weight
     C                     Z-ADD*ZERO     WIC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WIURTN           Number Cases On
     C                     Z-ADD*ZERO     WIAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WITFNB           Transportation
     C                     Z-ADD*ZERO     WITMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WITNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WIBLPR           Market Overage
     C                     Z-ADD*ZERO     WIBMPR           Standard Overag
     C                     Z-ADD*ZERO     WICMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WICHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WISWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WIPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WIICN1           Item Category N
     C                     Z-ADD*ZERO     WIICN2           Item Category N
     C                     Z-ADD*ZERO     WIV2NB           Item Category N
     C                     Z-ADD*ZERO     WIITCN           Item Category N
     C                     Z-ADD*ZERO     WIITC5           Item Category N
     C                     Z-ADD*ZERO     WIICN6           Item Category N
     C                     Z-ADD*ZERO     WIICN7           Item Category N
     C                     Z-ADD*ZERO     WIICN8           Item Category N
     C                     Z-ADD*ZERO     WIICN9           Item Category N
     C                     Z-ADD*ZERO     WIICN0           Item Category N
     C                     Z-ADD*ZERO     WISFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WIA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WISJNB           Production Lead
     C                     Z-ADD*ZERO     WISKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WISLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WISMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WICFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WICGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WIILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WICHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WICINB           PM Batch Size
     C                     Z-ADD*ZERO     WICJNB           PM Lot Size
     C                     Z-ADD*ZERO     WICMNB           Partial Item Co
     C                     Z-ADD*ZERO     WICNNB           WIP Item Code
     C                     Z-ADD*ZERO     WICRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WICSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WICVNB           FP Std Green We
     C                     Z-ADD*ZERO     WICWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WICXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WICZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WIC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WIB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WIB5NB           PM Line Number
     C                     Z-ADD*ZERO     WIBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WIBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WIF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WIF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WIF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WIBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WIBNNB           Production Qty
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJDPNB           Order Sequence
     C                     Z-ADD*ZERO     WJUENB           Order Secondary
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WJMAVA           Billing Detail
     C                     Z-ADD*ZERO     WJKDVA           Billing Detail
     C                     Z-ADD*ZERO     WJL8VA           Billing Detail
     C                     Z-ADD*ZERO     WJL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WJAYVA           Extended Amount
     C                     Z-ADD*ZERO     WJEXDT           Market Pricing
     C                     Z-ADD*ZERO     WJBZPR           Price Overage O
     C                     Z-ADD*ZERO     WJL6NB           Contract Number
     C                     Z-ADD*ZERO     WJGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WJD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WJCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WJAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WJCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WJATWG           Weight Shipped
     C                     Z-ADD*ZERO     WJAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WJAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WJAKPR           Unit Price
     C                     Z-ADD*ZERO     WJALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WJAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WJAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WJA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WJA5DT           Requested Ship
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJCXDT           Date of Origina
     C                     Z-ADD*ZERO     WJDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WJB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WJA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WJNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WJNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WJNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WJNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WJNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WJBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WJBVTM           Price Code
     C                     Z-ADD*ZERO     WJBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WJBXTM           Substitution Li
     C                     Z-ADD*ZERO     WJBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WJH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WJH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WJH7NX           OD Item Target
     C                     Z-ADD*ZERO     WJH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WJH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WJDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WJDWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WJDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WJDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WJDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WJGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WJGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WJGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WJPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WJRINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WJTIDT           Production Ovr
     C                     Z-ADD*ZERO     WJTJDT           Production Ovr
     C                     Z-ADD*ZERO     WJTKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WJTLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WJTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WKA0DT           Order Date
     C                     Z-ADD*ZERO     WKA5DT           Requested Ship
     C                     Z-ADD*ZERO     WKGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WKACDT           Cancel Date
     C                     Z-ADD*ZERO     WKAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WKCXDT           Date of Origina
     C                     Z-ADD*ZERO     WKJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WKA1WG           Order Weight To
     C                     Z-ADD*ZERO     WKEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WKAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WKRMNB           Load ID
     C                     Z-ADD*ZERO     WKTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
     C                     Z-ADD*ZERO     WKRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WKATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WKRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WKT3NB           Attach to Order
     C                     Z-ADD*ZERO     WKCONB           Invoice Number
     C                     Z-ADD*ZERO     WKAWDT           Invoice Date
     C                     Z-ADD*ZERO     WKVRVA           A/R order Value
     C                     Z-ADD*ZERO     WKB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WKNODT           OH Unused Date
     C                     Z-ADD*ZERO     WKNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WKNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WKNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WKNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WKBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WKBQTM           Time of Origina
     C                     Z-ADD*ZERO     WKBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WKBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WKBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WKH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WKH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WKH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WKH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WKH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WKC0C7           Claim Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMDPNB           Order Sequence
     C                     Z-ADD*ZERO     WMUENB           Order Secondary
     C                     Z-ADD*ZERO     WMJGDT           OD Production D
     C                     Z-ADD*ZERO     WMAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WMFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WMIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WMF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WMIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WMF4WG           OD Weight Unuse
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Unused Parm - Value   USR
     C                     Z-ADD*ZERO     WUB5VL 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Freight
     C                     Z-ADD*ZERO     WURQNB 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSELDT           Production Date
     C                     Z-ADD*ZERO     WSHGCD           Item Code
     C                     Z-ADD*ZERO     WSPSAN           PS Adjustment N
     C                     Z-ADD*ZERO     WSPIAD           PS Adjustment Q
     C                     Z-ADD*ZERO     WSD8C7           PS Consumed Ite
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
      * Define local work field *Duration (factor)
     C                     Z-ADD*ZERO     YL0001  80
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0003  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 CURKILLDTE
