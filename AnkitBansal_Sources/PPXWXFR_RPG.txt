     H/TITLE SEL Invc to Print&Post XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 11/09/21  Time  : 15:40:16
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPLVIF  E           K        DISK
      * RSQ : Order Header TRG          Co Order#/Shipped
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FPNF7REL1IF  E           K        DISK
      * RTV : Cust Distribution Entry   Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDLYREL1IF  E           K        DISK
      * RTV : Trailer                   Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPEYCPL5IF  E           K        DISK
      * RSQ : Order Events              Customer/Order/Event   N
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOPBFCPL5IF  E           K        DISK
      * RSQ : Order Header TRG          Invoice Print Selection
      *
     FPMAFCPL2IF  E           K        DISK
      * RSQ : WF Invoice/Combine Drv    Job/Co/CstPO/Shpto/Ord
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     FPDJ4CPL0IF  E           K        DISK                      A
      * UPD : WF Invoice List Work      Update index
      *
     FPDLYREL0UF  E           K        DISK
      * UPD : Trailer                   Update index
      *
     FOPEYCPL0IF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@BFCPZW
      * Order Header TRG          Co Order#/Shipped
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@ASREGT
      * Company Control           Retrieval index       NV
      * Renamed input format fields
     I              ASAIC3                          WDAIC3
     I              ASAXNB                          WDAXNB
     I              ASNGNB                          WDNGNB
     I              ASBZNB                          WDBZNB
     I              ASC5NB                          WDC5NB
     I              ASC3NB                          WDC3NB
     I              ASCYNB                          WDCYNB
     I              ASIONB                          WDIONB
     I              ASI6NB                          WDI6NB
     I              ASDCNB                          WDDCNB
     I              ASC7NB                          WDC7NB
     I              ASC2NB                          WDC2NB
     I              ASC1NB                          WDC1NB
     I              ASL8NB                          WDL8NB
     I              ASBANB                          WDBANB
     I              ASCHST                          WDCHST
     I              ASCKST                          WDCKST
     I              ASCIST                          WDCIST
     I              ASCGST                          WDCGST
     I              ASAIPC                          WDAIPC
     I              ASASPC                          WDASPC
     I              ASA2VA                          WDA2VA
     I              ASC2ST                          WDC2ST
     I              ASD8ST                          WDD8ST
     I              ASD7ST                          WDD7ST
     I              ASA8NA                          WDA8NA
     I              ASA9NA                          WDA9NA
     I              ASBANA                          WDBANA
     I              ASBBNA                          WDBBNA
     I              ASEUST                          WDEUST
     I              ASAADY                          WDAADY
     I              ASABDY                          WDABDY
     I              ASACDY                          WDACDY
     I              ASADDY                          WDADDY
     I              ASAEDY                          WDAEDY
     I              ASAFDY                          WDAFDY
     I              ASAGDY                          WDAGDY
     I              ASAHDY                          WDAHDY
     I              ASAENB                          WDAENB
     I              ASALNB                          WDALNB
     I              ASEVNB                          WDEVNB
     I              ASRPOP                          WDRPOP
     I              ASDWNB                          WDDWNB
     I              ASR3NB                          WDR3NB
     I              ASPNST                          WDPNST
     I              ASR4NB                          WDR4NB
     I              ASPOST                          WDPOST
     I              ASSCNB                          WDSCNB
     I              ASVIST                          WDVIST
     I              ASVJST                          WDVJST
     I              ASBVVN                          WDBVVN
     I              ASUVST                          WDUVST
     I              ASUWST                          WDUWST
     I              ASUXST                          WDUXST
     I              ASVSST                          WDVSST
     I              ASAATM                          WDAATM
     I              ASAYNA                          WDAYNA
     I              ASA0NA                          WDA0NA
     I              ASAXDT                          WDAXDT
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WEAIC3
     I              ASAXNB                          WEAXNB
     I              ASNGNB                          WENGNB
     I              ASBZNB                          WEBZNB
     I              ASC5NB                          WEC5NB
     I              ASC3NB                          WEC3NB
     I              ASCYNB                          WECYNB
     I              ASIONB                          WEIONB
     I              ASI6NB                          WEI6NB
     I              ASDCNB                          WEDCNB
     I              ASC7NB                          WEC7NB
     I              ASC2NB                          WEC2NB
     I              ASC1NB                          WEC1NB
     I              ASL8NB                          WEL8NB
     I              ASBANB                          WEBANB
     I              ASCHST                          WECHST
     I              ASCKST                          WECKST
     I              ASCIST                          WECIST
     I              ASCGST                          WECGST
     I              ASAIPC                          WEAIPC
     I              ASASPC                          WEASPC
     I              ASA2VA                          WEA2VA
     I              ASC2ST                          WEC2ST
     I              ASD8ST                          WED8ST
     I              ASD7ST                          WED7ST
     I              ASA8NA                          WEA8NA
     I              ASA9NA                          WEA9NA
     I              ASBANA                          WEBANA
     I              ASBBNA                          WEBBNA
     I              ASEUST                          WEEUST
     I              ASAADY                          WEAADY
     I              ASABDY                          WEABDY
     I              ASACDY                          WEACDY
     I              ASADDY                          WEADDY
     I              ASAEDY                          WEAEDY
     I              ASAFDY                          WEAFDY
     I              ASAGDY                          WEAGDY
     I              ASAHDY                          WEAHDY
     I              ASAENB                          WEAENB
     I              ASALNB                          WEALNB
     I              ASEVNB                          WEEVNB
     I              ASRPOP                          WERPOP
     I              ASDWNB                          WEDWNB
     I              ASR3NB                          WER3NB
     I              ASPNST                          WEPNST
     I              ASR4NB                          WER4NB
     I              ASPOST                          WEPOST
     I              ASSCNB                          WESCNB
     I              ASVIST                          WEVIST
     I              ASVJST                          WEVJST
     I              ASBVVN                          WEBVVN
     I              ASUVST                          WEUVST
     I              ASUWST                          WEUWST
     I              ASUXST                          WEUXST
     I              ASVSST                          WEVSST
     I              ASAATM                          WEAATM
     I              ASAYNA                          WEAYNA
     I              ASA0NA                          WEA0NA
     I              ASAXDT                          WEAXDT
      *
     I@BUREBI
      * PFS Interface             Retrieval index
      * Renamed input format fields
     I              BUY1NX                          WFY1NX
     I              BUGYAA                          WFGYAA
     I              BURENA                          WFRENA
     I              BUWSSX                          WFWSSX
     I              BUWUSX                          WFWUSX
     I              BUQEDT                          WFQEDT
     I              BUCUTM                          WFCUTM
     I              BUB0NY                          WFB0NY
     I              BUB1NY                          WFB1NY
     I              BUWXSX                          WFWXSX
     I              BUWVSX                          WFWVSX
     I              BUWWSX                          WFWWSX
     I              BUUWSX                          WFUWSX
     I              BUUXSX                          WFUXSX
     I              BUV3SX                          WFV3SX
     I              BUAHNY                          WFAHNY
     I              BUAINY                          WFAINY
     I              BUAJNY                          WFAJNY
     I              BUAKNY                          WFAKNY
      *
     I@F7REFP
      * Cust Distribution Entry   Retrieval index
      * Renamed input format fields
     I              F7BKC7                          WGBKC7
     I              F7MNAA                          WGMNAA
     I              F7RNNY                          WGRNNY
     I              F7WLT1                          WGWLT1
     I              F7IRST                          WGIRST
     I              F7WMT1                          WGWMT1
     I              F7VSST                          WGVSST
     I              F7MJDT                          WGMJDT
     I              F7BETM                          WGBETM
     I              F7CCVN                          WGCCVN
     I              F7CDVN                          WGCDVN
     I              F7MKDT                          WGMKDT
     I              F7BFTM                          WGBFTM
     I              F7CEVN                          WGCEVN
     I              F7CFVN                          WGCFVN
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WHBKC7
     I              BBAYTX                          WHAYTX
     I              BBACNA                          WHACNA
     I              BBADNA                          WHADNA
     I              BBAENA                          WHAENA
     I              BBAJNA                          WHAJNA
     I              BBBGCD                          WHBGCD
     I              BBG5CD                          WHG5CD
     I              BBBTTX                          WHBTTX
     I              BBBVTX                          WHBVTX
     I              BBBWTX                          WHBWTX
     I              BBABTX                          WHABTX
     I              BBA2NA                          WHA2NA
     I              BBCBST                          WHCBST
     I              BBB0NA                          WHB0NA
     I              BBP3NB                          WHP3NB
     I              BBAXNA                          WHAXNA
     I              BBI6DT                          WHI6DT
     I              BBAYDT                          WHAYDT
     I              BBANC7                          WHANC7
     I              BBBTC7                          WHBTC7
     I              BBK6ST                          WHK6ST
     I              BBUZST                          WHUZST
     I              BBKXCD                          WHKXCD
     I              BBLTCD                          WHLTCD
     I              BBQNST                          WHQNST
     I              BBS2NB                          WHS2NB
     I              BBVHVA                          WHVHVA
     I              BBI7DT                          WHI7DT
     I              BBRJST                          WHRJST
     I              BBRKST                          WHRKST
     I              BBQWST                          WHQWST
     I              BBQXST                          WHQXST
     I              BBQYST                          WHQYST
     I              BBUNCS                          WHUNCS
     I              BBUVST                          WHUVST
     I              BBUWST                          WHUWST
     I              BBUXST                          WHUXST
     I              BBVSST                          WHVSST
     I              BBAATM                          WHAATM
     I              BBAYNA                          WHAYNA
     I              BBA0NA                          WHA0NA
     I              BBAXDT                          WHAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WIAIC3
     I              JYZ9ST                          WIZ9ST
     I              JYCSST                          WICSST
     I              JYZ8ST                          WIZ8ST
     I              JYCXST                          WICXST
     I              JYSWST                          WISWST
     I              JYXXTM                          WIXXTM
     I              JYUECD                          WIUECD
     I              JYHSST                          WIHSST
     I              JYAMEO                          WIAMEO
     I              JYSSDF                          WISSDF
     I              JYPDFT                          WIPDFT
     I              JYYISX                          WIYISX
     I              JYYJSX                          WIYJSX
     I              JYYKSX                          WIYKSX
     I              JYYLSX                          WIYLSX
     I              JYYMSX                          WIYMSX
     I              JYYNSX                          WIYNSX
     I              JYUVST                          WIUVST
     I              JYUWST                          WIUWST
     I              JYUXST                          WIUXST
     I              JYVSST                          WIVSST
     I              JYAATM                          WIAATM
     I              JYAYNA                          WIAYNA
     I              JYA0NA                          WIA0NA
     I              JYAXDT                          WIAXDT
      *
     I@J4CPDG
      * WF Invoice List Work      Update index
      * Renamed input format fields
     I              J4B2VN                          WJB2VN
     I              J4C4NB                          WJC4NB
     I              J4JZVA                          WJJZVA
     I              J4A1WG                          WJA1WG
     I              J4BRTX                          WJBRTX
     I              J4AETX                          WJAETX
     I              J4RLST                          WJRLST
     I              J4CBC7                          WJCBC7
     I              J4BKC7                          WJBKC7
     I              J4AIC3                          WJAIC3
     I              J4CONB                          WJCONB
     I              J4CEST                          WJCEST
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WKRMNB
     I              FJAIC3                          WKAIC3
     I              FJAODT                          WKAODT
     I              FJPJST                          WKPJST
     I              FJPKST                          WKPKST
     I              FJRNNB                          WKRNNB
     I              FJDMTX                          WKDMTX
     I              FJDNTX                          WKDNTX
     I              FJDOTX                          WKDOTX
     I              FJWTTX                          WKWTTX
     I              FJWUTX                          WKWUTX
     I              FJRPNB                          WKRPNB
     I              FJFLAM                          WKFLAM
     I              FJXQST                          WKXQST
     I              FJRRNB                          WKRRNB
     I              FJDXTX                          WKDXTX
     I              FJDYTX                          WKDYTX
     I              FJSBNB                          WKSBNB
     I              FJBZNA                          WKBZNA
     I              FJRONB                          WKRONB
     I              FJSQNB                          WKSQNB
     I              FJR1NB                          WKR1NB
     I              FJVCST                          WKVCST
     I              FJVDST                          WKVDST
     I              FJSDNB                          WKSDNB
     I              FJPAOU                          WKPAOU
     I              FJDGWG                          WKDGWG
     I              FJSXNB                          WKSXNB
     I              FJHADT                          WKHADT
     I              FJAART                          WKAART
     I              FJDHWG                          WKDHWG
     I              FJDIWG                          WKDIWG
     I              FJAQDT                          WKAQDT
     I              FJS6NB                          WKS6NB
     I              FJT4NB                          WKT4NB
     I              FJPRTM                          WKPRTM
     I              FJNPSV                          WKNPSV
     I              FJJ8TX                          WKJ8TX
     I              FJTLMI                          WKTLMI
     I              FJJ9TX                          WKJ9TX
     I              FJQ2CD                          WKQ2CD
     I              FJVPCD                          WKVPCD
     I              FJDBCD                          WKDBCD
     I              FJGRWE                          WKGRWE
     I              FJXCCD                          WKXCCD
     I              FJU2ST                          WKU2ST
     I              FJF9DT                          WKF9DT
     I              FJONTM                          WKONTM
     I              FJJ4DT                          WKJ4DT
     I              FJTRTM                          WKTRTM
     I              FJJ5DT                          WKJ5DT
     I              FJSPTM                          WKSPTM
     I              FJJ6DT                          WKJ6DT
     I              FJLFTM                          WKLFTM
     I              FJJ7DT                          WKJ7DT
     I              FJBOTM                          WKBOTM
     I              FJJ8DT                          WKJ8DT
     I              FJBLTM                          WKBLTM
     I              FJKIDT                          WKKIDT
     I              FJASTM                          WKASTM
     I              FJKADT                          WKKADT
     I              FJAJCM                          WKAJCM
     I              FJXACD                          WKXACD
     I              FJOANA                          WKOANA
     I              FJK4TX                          WKK4TX
     I              FJVOAG                          WKVOAG
     I              FJKBDT                          WKKBDT
     I              FJNBBO                          WKNBBO
     I              FJW4CD                          WKW4CD
     I              FJEFDT                          WKEFDT
     I              FJCNTN                          WKCNTN
     I              FJKCDT                          WKKCDT
     I              FJTMIN                          WKTMIN
     I              FJKDDT                          WKKDDT
     I              FJVMNB                          WKVMNB
     I              FJOCFR                          WKOCFR
     I              FJKJDT                          WKKJDT
     I              FJATTM                          WKATTM
     I              FJOTRS                          WKOTRS
     I              FJRNST                          WKRNST
     I              FJBRBK                          WKBRBK
     I              FJEIDT                          WKEIDT
     I              FJRMST                          WKRMST
     I              FJAJCD                          WKAJCD
     I              FJKKDT                          WKKKDT
     I              FJAVTM                          WKAVTM
     I              FJKZDT                          WKKZDT
     I              FJAXTM                          WKAXTM
     I              FJLHOS                          WKLHOS
     I              FJLHOR                          WKLHOR
     I              FJWNTX                          WKWNTX
     I              FJOITX                          WKOITX
     I              FJOJTX                          WKOJTX
     I              FJLLDT                          WKLLDT
     I              FJLSHG                          WKLSHG
     I              FJYPST                          WKYPST
     I              FJK0DT                          WKK0DT
     I              FJAYTM                          WKAYTM
     I              FJKNNX                          WKKNNX
     I              FJICWG                          WKICWG
     I              FJIDWG                          WKIDWG
     I              FJH9SX                          WKH9SX
     I              FJWOTX                          WKWOTX
     I              FJK1DT                          WKK1DT
     I              FJAZTM                          WKAZTM
     I              FJK2DT                          WKK2DT
     I              FJA0TM                          WKA0TM
     I              FJROST                          WKROST
     I              FJRPST                          WKRPST
     I              FJRQST                          WKRQST
     I              FJRRST                          WKRRST
     I              FJZBVA                          WKZBVA
     I              FJWPTX                          WKWPTX
     I              FJWQTX                          WKWQTX
     I              FJWRTX                          WKWRTX
     I              FJWSTX                          WKWSTX
     I              FJRVSX                          WKRVSX
     I              FJRUSX                          WKRUSX
     I              FJRWSX                          WKRWSX
     I              FJRXSX                          WKRXSX
     I              FJRYSX                          WKRYSX
     I              FJRZSX                          WKRZSX
     I              FJR0SX                          WKR0SX
     I              FJR1SX                          WKR1SX
     I              FJR2SX                          WKR2SX
     I              FJR3SX                          WKR3SX
     I              FJR4SX                          WKR4SX
     I              FJPYDT                          WKPYDT
     I              FJCKTM                          WKCKTM
     I              FJPZDT                          WKPZDT
     I              FJCLTM                          WKCLTM
     I              FJP0DT                          WKP0DT
     I              FJCMTM                          WKCMTM
     I              FJP1DT                          WKP1DT
     I              FJCNTM                          WKCNTM
     I              FJP2DT                          WKP2DT
     I              FJCOTM                          WKCOTM
     I              FJP3DT                          WKP3DT
     I              FJCQTM                          WKCQTM
     I              FJUVST                          WKUVST
     I              FJUWST                          WKUWST
     I              FJUXST                          WKUXST
     I              FJAATM                          WKAATM
     I              FJAYNA                          WKAYNA
     I              FJA0NA                          WKA0NA
     I              FJAXDT                          WKAXDT
      *
     I@LYRER3
      * Trailer                   Retrieval index
      * Renamed input format fields
     I              LYBZNA                          WLBZNA
     I              LYDXTX                          WLDXTX
     I              LYAIC3                          WLAIC3
     I              LYVDST                          WLVDST
     I              LYX3ST                          WLX3ST
     I              LYXGST                          WLXGST
     I              LYSTOY                          WLSTOY
     I              LYKKDT                          WLKKDT
     I              LYAVTM                          WLAVTM
     I              LYSTAS                          WLSTAS
     I              LYXRST                          WLXRST
     I              LYX7CD                          WLX7CD
     I              LYGXTX                          WLGXTX
     I              LYXTST                          WLXTST
     I              LYXVST                          WLXVST
     I              LYSTU3                          WLSTU3
     I              LYSTU4                          WLSTU4
     I              LYSTU5                          WLSTU5
     I              LYLCDT                          WLLCDT
     I              LYLDDT                          WLLDDT
     I              LYLEDT                          WLLEDT
     I              LYLFDT                          WLLFDT
     I              LYLGDT                          WLLGDT
     I              LYUVST                          WLUVST
     I              LYUWST                          WLUWST
     I              LYUXST                          WLUXST
     I              LYVSST                          WLVSST
     I              LYAATM                          WLAATM
     I              LYAYNA                          WLAYNA
     I              LYA0NA                          WLA0NA
     I              LYAXDT                          WLAXDT
      *
     I@LYRER2
      * Trailer                   Update index
      * Renamed input format fields
     I              LYBZNA                          WMBZNA
     I              LYDXTX                          WMDXTX
     I              LYAIC3                          WMAIC3
     I              LYVDST                          WMVDST
     I              LYX3ST                          WMX3ST
     I              LYXGST                          WMXGST
     I              LYSTOY                          WMSTOY
     I              LYKKDT                          WMKKDT
     I              LYAVTM                          WMAVTM
     I              LYSTAS                          WMSTAS
     I              LYXRST                          WMXRST
     I              LYX7CD                          WMX7CD
     I              LYGXTX                          WMGXTX
     I              LYXTST                          WMXTST
     I              LYXVST                          WMXVST
     I              LYSTU3                          WMSTU3
     I              LYSTU4                          WMSTU4
     I              LYSTU5                          WMSTU5
     I              LYLCDT                          WMLCDT
     I              LYLDDT                          WMLDDT
     I              LYLEDT                          WMLEDT
     I              LYLFDT                          WMLFDT
     I              LYLGDT                          WMLGDT
     I              LYUVST                          WMUVST
     I              LYUWST                          WMUWST
     I              LYUXST                          WMUXST
     I              LYVSST                          WMVSST
     I              LYAATM                          WMAATM
     I              LYAYNA                          WMAYNA
     I              LYA0NA                          WMA0NA
     I              LYAXDT                          WMAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WOAIC3
     I              AMC4NB                          WOC4NB
     I              AMRMNB                          WORMNB
     I              AMRUNB                          WORUNB
     I              AMXACD                          WOXACD
     I              AMOANA                          WOOANA
     I              AMHBAA                          WOHBAA
     I              AMJ0T1                          WOJ0T1
     I              AMGENY                          WOGENY
     I              AMJ1T1                          WOJ1T1
     I              AMHCAA                          WOHCAA
     I              AMQWDT                          WOQWDT
     I              AMQXDT                          WOQXDT
     I              AMQYDT                          WOQYDT
     I              AMHDAA                          WOHDAA
     I              AMCCTX                          WOCCTX
     I              AMJ2T1                          WOJ2T1
     I              AMRLNA                          WORLNA
     I              AMRMNA                          WORMNA
     I              AMGINY                          WOGINY
     I              AMGFNY                          WOGFNY
     I              AMGGNY                          WOGGNY
     I              AMGHNY                          WOGHNY
     I              AMHEVL                          WOHEVL
     I              AMHFVL                          WOHFVL
     I              AMHGVL                          WOHGVL
     I              AMQZDT                          WOQZDT
     I              AMQ0DT                          WOQ0DT
     I              AMQ1DT                          WOQ1DT
     I              AMQ2DT                          WOQ2DT
     I              AMC2TX                          WOC2TX
     I              AMC3TX                          WOC3TX
     I              AMC6TX                          WOC6TX
     I              AMCHTX                          WOCHTX
     I              AMCITX                          WOCITX
     I              AMCLTX                          WOCLTX
     I              AMB4TX                          WOB4TX
     I              AMCUTX                          WOCUTX
     I              AMCVTX                          WOCVTX
     I              AMB9TX                          WOB9TX
     I              AMJWSC                          WOJWSC
     I              AMITNY                          WOITNY
     I              AMLMT1                          WOLMT1
     I              AMLWAA                          WOLWAA
     I              AMFVST                          WOFVST
     I              AMF0ST                          WOF0ST
     I              AMF2ST                          WOF2ST
     I              AMF3ST                          WOF3ST
     I              AMJUSC                          WOJUSC
     I              AMJVSC                          WOJVSC
     I              AMV3T1                          WOV3T1
     I              AMV4T1                          WOV4T1
     I              AMV5T1                          WOV5T1
     I              AMV6T1                          WOV6T1
     I              AMV7T1                          WOV7T1
     I              AMV8T1                          WOV8T1
     I              AMV9T1                          WOV9T1
     I              AMWAT1                          WOWAT1
     I              AMWBT1                          WOWBT1
     I              AMWCT1                          WOWCT1
     I              AMWDT1                          WOWDT1
     I              AMQJNY                          WOQJNY
     I              AMQKNY                          WOQKNY
     I              AMQLNY                          WOQLNY
     I              AMP8NY                          WOP8NY
     I              AMP9NY                          WOP9NY
     I              AMQANY                          WOQANY
     I              AMQCNY                          WOQCNY
     I              AMQDNY                          WOQDNY
     I              AMQENY                          WOQENY
     I              AMQFNY                          WOQFNY
     I              AMQGNY                          WOQGNY
     I              AMQHNY                          WOQHNY
     I              AMQINY                          WOQINY
     I              AMQMNY                          WOQMNY
     I              AMMYU1                          WOMYU1
     I              AMJXSC                          WOJXSC
     I              AMJYSC                          WOJYSC
     I              AMJZSC                          WOJZSC
     I              AMJ0SC                          WOJ0SC
     I              AMMZU1                          WOMZU1
     I              AMM0U1                          WOM0U1
     I              AMM1U1                          WOM1U1
     I              AMM2U1                          WOM2U1
     I              AMM3U1                          WOM3U1
     I              AMW5DT                          WOW5DT
     I              AMW6DT                          WOW6DT
     I              AMUVST                          WOUVST
     I              AMUWST                          WOUWST
     I              AMUXST                          WOUXST
     I              AMVSST                          WOVSST
     I              AMAATM                          WOAATM
     I              AMAYNA                          WOAYNA
     I              AMA0NA                          WOA0NA
     I              AMAXDT                          WOAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WRAIC3
     I              EYC4NB                          WRC4NB
     I              EYQ2NB                          WRQ2NB
     I              EYJPCD                          WRJPCD
     I              EYAUC3                          WRAUC3
     I              EYQ7NB                          WRQ7NB
     I              EYOMST                          WROMST
     I              EYD2DT                          WRD2DT
     I              EYONST                          WRONST
     I              EYOOST                          WROOST
     I              EYOPST                          WROPST
     I              EYAWC3                          WRAWC3
     I              EYQ8NB                          WRQ8NB
     I              EYQ9NB                          WRQ9NB
     I              EYBKC7                          WRBKC7
     I              EYUVST                          WRUVST
     I              EYUWST                          WRUWST
     I              EYUXST                          WRUXST
     I              EYAATM                          WRAATM
     I              EYAYNA                          WRAYNA
     I              EYA0NA                          WRA0NA
     I              EYAXDT                          WRAXDT
      *
     I@EYCPZR
      * Order Events              Customer/Order/Event   N
      * Renamed input format fields
     I              EYAIC3                          WSAIC3
     I              EYC4NB                          WSC4NB
     I              EYQ2NB                          WSQ2NB
     I              EYJPCD                          WSJPCD
     I              EYAUC3                          WSAUC3
     I              EYQ7NB                          WSQ7NB
     I              EYOMST                          WSOMST
     I              EYD2DT                          WSD2DT
     I              EYONST                          WSONST
     I              EYOOST                          WSOOST
     I              EYOPST                          WSOPST
     I              EYAWC3                          WSAWC3
     I              EYQ8NB                          WSQ8NB
     I              EYQ9NB                          WSQ9NB
     I              EYBKC7                          WSBKC7
     I              EYUVST                          WSUVST
     I              EYUWST                          WSUWST
     I              EYUXST                          WSUXST
     I              EYAATM                          WSAATM
     I              EYAYNA                          WSAYNA
     I              EYA0NA                          WSA0NA
     I              EYAXDT                          WSAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WTAIC3
     I              EYC4NB                          WTC4NB
     I              EYQ2NB                          WTQ2NB
     I              EYJPCD                          WTJPCD
     I              EYAUC3                          WTAUC3
     I              EYQ7NB                          WTQ7NB
     I              EYOMST                          WTOMST
     I              EYD2DT                          WTD2DT
     I              EYONST                          WTONST
     I              EYOOST                          WTOOST
     I              EYOPST                          WTOPST
     I              EYAWC3                          WTAWC3
     I              EYQ8NB                          WTQ8NB
     I              EYQ9NB                          WTQ9NB
     I              EYBKC7                          WTBKC7
     I              EYUVST                          WTUVST
     I              EYUWST                          WTUWST
     I              EYUXST                          WTUXST
     I              EYAATM                          WTAATM
     I              EYAYNA                          WTAYNA
     I              EYA0NA                          WTA0NA
     I              EYAXDT                          WTAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WVAIC3
     I              OMC4NB                          WVC4NB
     I              OMDPNB                          WVDPNB
     I              OMUENB                          WVUENB
     I              OMHGCD                          WVHGCD
     I              OMAJCD                          WVAJCD
     I              OMBKC7                          WVBKC7
     I              OMCFC7                          WVCFC7
     I              OMGMST                          WVGMST
     I              OMGNST                          WVGNST
     I              OMMAVA                          WVMAVA
     I              OMKDVA                          WVKDVA
     I              OML8VA                          WVL8VA
     I              OML9VA                          WVL9VA
     I              OMGTST                          WVGTST
     I              OMGVST                          WVGVST
     I              OMGUST                          WVGUST
     I              OMQFST                          WVQFST
     I              OMAYVA                          WVAYVA
     I              OMEXDT                          WVEXDT
     I              OMLQCD                          WVLQCD
     I              OMRDCD                          WVRDCD
     I              OMQ7CD                          WVQ7CD
     I              OMBZPR                          WVBZPR
     I              OML6NB                          WVL6NB
     I              OMU1ST                          WVU1ST
     I              OMGIDT                          WVGIDT
     I              OMCRCD                          WVCRCD
     I              OMAGCD                          WVAGCD
     I              OMRZST                          WVRZST
     I              OMR0ST                          WVR0ST
     I              OMR1ST                          WVR1ST
     I              OMG7NA                          WVG7NA
     I              OMG8NA                          WVG8NA
     I              OMRPCD                          WVRPCD
     I              OMVEST                          WVVEST
     I              OMVGST                          WVVGST
     I              OMAVST                          WVAVST
     I              OMU0ST                          WVU0ST
     I              OMRFCD                          WVRFCD
     I              OMFZST                          WVFZST
     I              OMR1NB                          WVR1NB
     I              OMAVQT                          WVAVQT
     I              OMD0WG                          WVD0WG
     I              OMCCQT                          WVCCQT
     I              OMAUWG                          WVAUWG
     I              OMCBQT                          WVCBQT
     I              OMATWG                          WVATWG
     I              OMAQCS                          WVAQCS
     I              OMAGCS                          WVAGCS
     I              OMAKPR                          WVAKPR
     I              OMALPR                          WVALPR
     I              OMAUPR                          WVAUPR
     I              OMAVWG                          WVAVWG
     I              OMA4WG                          WVA4WG
     I              OMA5DT                          WVA5DT
     I              OMAODT                          WVAODT
     I              OMGNDT                          WVGNDT
     I              OMAMST                          WVAMST
     I              OMANST                          WVANST
     I              OMVAST                          WVVAST
     I              OMRGNB                          WVRGNB
     I              OMRHNB                          WVRHNB
     I              OMRINB                          WVRINB
     I              OMRBCD                          WVRBCD
     I              OMHICD                          WVHICD
     I              OMRNCD                          WVRNCD
     I              OMROCD                          WVROCD
     I              OMCXDT                          WVCXDT
     I              OMAJVN                          WVAJVN
     I              OMKXCD                          WVKXCD
     I              OMJPCD                          WVJPCD
     I              OMCQCD                          WVCQCD
     I              OMR4CD                          WVR4CD
     I              OMZ1ST                          WVZ1ST
     I              OMZ3ST                          WVZ3ST
     I              OMZ4ST                          WVZ4ST
     I              OMDUPR                          WVDUPR
     I              OMB6VL                          WVB6VL
     I              OMA1AA                          WVA1AA
     I              OMFZSX                          WVFZSX
     I              OMF0SX                          WVF0SX
     I              OMF1SX                          WVF1SX
     I              OMF2SX                          WVF2SX
     I              OMF3SX                          WVF3SX
     I              OMF4SX                          WVF4SX
     I              OMF5SX                          WVF5SX
     I              OMF6SX                          WVF6SX
     I              OMF7SX                          WVF7SX
     I              OMNTDT                          WVNTDT
     I              OMNUDT                          WVNUDT
     I              OMNVDT                          WVNVDT
     I              OMNWDT                          WVNWDT
     I              OMNXDT                          WVNXDT
     I              OMBUTM                          WVBUTM
     I              OMBVTM                          WVBVTM
     I              OMBWTM                          WVBWTM
     I              OMBXTM                          WVBXTM
     I              OMBYTM                          WVBYTM
     I              OMH5NX                          WVH5NX
     I              OMH6NX                          WVH6NX
     I              OMH7NX                          WVH7NX
     I              OMH8NX                          WVH8NX
     I              OMH9NX                          WVH9NX
     I              OMDVPR                          WVDVPR
     I              OMDWPR                          WVDWPR
     I              OMDXPR                          WVDXPR
     I              OMDYPR                          WVDYPR
     I              OMDZPR                          WVDZPR
     I              OMGSPR                          WVGSPR
     I              OMGTPR                          WVGTPR
     I              OMGUPR                          WVGUPR
     I              OMHOST                          WVHOST
     I              OMHPST                          WVHPST
     I              OMIOST                          WVIOST
     I              OMPEWG                          WVPEWG
     I              OMRINY                          WVRINY
     I              OMTIDT                          WVTIDT
     I              OMTJDT                          WVTJDT
     I              OMH2ST                          WVH2ST
     I              OMH0ST                          WVH0ST
     I              OMH1ST                          WVH1ST
     I              OMTKDT                          WVTKDT
     I              OMTLDT                          WVTLDT
     I              OMTMDT                          WVTMDT
     I              OMUVST                          WVUVST
     I              OMUWST                          WVUWST
     I              OMUXST                          WVUXST
     I              OMAATM                          WVAATM
     I              OMAYNA                          WVAYNA
     I              OMA0NA                          WVA0NA
     I              OMAXDT                          WVAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WWAIC3
     I              OMC4NB                          WWC4NB
     I              OMDPNB                          WWDPNB
     I              OMUENB                          WWUENB
     I              OMHGCD                          WWHGCD
     I              OMAJCD                          WWAJCD
     I              OMBKC7                          WWBKC7
     I              OMCFC7                          WWCFC7
     I              OMGMST                          WWGMST
     I              OMGNST                          WWGNST
     I              OMMAVA                          WWMAVA
     I              OMKDVA                          WWKDVA
     I              OML8VA                          WWL8VA
     I              OML9VA                          WWL9VA
     I              OMGTST                          WWGTST
     I              OMGVST                          WWGVST
     I              OMGUST                          WWGUST
     I              OMQFST                          WWQFST
     I              OMAYVA                          WWAYVA
     I              OMEXDT                          WWEXDT
     I              OMLQCD                          WWLQCD
     I              OMRDCD                          WWRDCD
     I              OMQ7CD                          WWQ7CD
     I              OMBZPR                          WWBZPR
     I              OML6NB                          WWL6NB
     I              OMU1ST                          WWU1ST
     I              OMGIDT                          WWGIDT
     I              OMCRCD                          WWCRCD
     I              OMAGCD                          WWAGCD
     I              OMRZST                          WWRZST
     I              OMR0ST                          WWR0ST
     I              OMR1ST                          WWR1ST
     I              OMG7NA                          WWG7NA
     I              OMG8NA                          WWG8NA
     I              OMRPCD                          WWRPCD
     I              OMVEST                          WWVEST
     I              OMVGST                          WWVGST
     I              OMAVST                          WWAVST
     I              OMU0ST                          WWU0ST
     I              OMRFCD                          WWRFCD
     I              OMFZST                          WWFZST
     I              OMR1NB                          WWR1NB
     I              OMAVQT                          WWAVQT
     I              OMD0WG                          WWD0WG
     I              OMCCQT                          WWCCQT
     I              OMAUWG                          WWAUWG
     I              OMCBQT                          WWCBQT
     I              OMATWG                          WWATWG
     I              OMAQCS                          WWAQCS
     I              OMAGCS                          WWAGCS
     I              OMAKPR                          WWAKPR
     I              OMALPR                          WWALPR
     I              OMAUPR                          WWAUPR
     I              OMAVWG                          WWAVWG
     I              OMA4WG                          WWA4WG
     I              OMA5DT                          WWA5DT
     I              OMAODT                          WWAODT
     I              OMGNDT                          WWGNDT
     I              OMAMST                          WWAMST
     I              OMANST                          WWANST
     I              OMVAST                          WWVAST
     I              OMRGNB                          WWRGNB
     I              OMRHNB                          WWRHNB
     I              OMRINB                          WWRINB
     I              OMRBCD                          WWRBCD
     I              OMHICD                          WWHICD
     I              OMRNCD                          WWRNCD
     I              OMROCD                          WWROCD
     I              OMCXDT                          WWCXDT
     I              OMAJVN                          WWAJVN
     I              OMKXCD                          WWKXCD
     I              OMJPCD                          WWJPCD
     I              OMCQCD                          WWCQCD
     I              OMR4CD                          WWR4CD
     I              OMZ1ST                          WWZ1ST
     I              OMZ3ST                          WWZ3ST
     I              OMZ4ST                          WWZ4ST
     I              OMDUPR                          WWDUPR
     I              OMB6VL                          WWB6VL
     I              OMA1AA                          WWA1AA
     I              OMFZSX                          WWFZSX
     I              OMF0SX                          WWF0SX
     I              OMF1SX                          WWF1SX
     I              OMF2SX                          WWF2SX
     I              OMF3SX                          WWF3SX
     I              OMF4SX                          WWF4SX
     I              OMF5SX                          WWF5SX
     I              OMF6SX                          WWF6SX
     I              OMF7SX                          WWF7SX
     I              OMNTDT                          WWNTDT
     I              OMNUDT                          WWNUDT
     I              OMNVDT                          WWNVDT
     I              OMNWDT                          WWNWDT
     I              OMNXDT                          WWNXDT
     I              OMBUTM                          WWBUTM
     I              OMBVTM                          WWBVTM
     I              OMBWTM                          WWBWTM
     I              OMBXTM                          WWBXTM
     I              OMBYTM                          WWBYTM
     I              OMH5NX                          WWH5NX
     I              OMH6NX                          WWH6NX
     I              OMH7NX                          WWH7NX
     I              OMH8NX                          WWH8NX
     I              OMH9NX                          WWH9NX
     I              OMDVPR                          WWDVPR
     I              OMDWPR                          WWDWPR
     I              OMDXPR                          WWDXPR
     I              OMDYPR                          WWDYPR
     I              OMDZPR                          WWDZPR
     I              OMGSPR                          WWGSPR
     I              OMGTPR                          WWGTPR
     I              OMGUPR                          WWGUPR
     I              OMHOST                          WWHOST
     I              OMHPST                          WWHPST
     I              OMIOST                          WWIOST
     I              OMPEWG                          WWPEWG
     I              OMRINY                          WWRINY
     I              OMTIDT                          WWTIDT
     I              OMTJDT                          WWTJDT
     I              OMH2ST                          WWH2ST
     I              OMH0ST                          WWH0ST
     I              OMH1ST                          WWH1ST
     I              OMTKDT                          WWTKDT
     I              OMTLDT                          WWTLDT
     I              OMTMDT                          WWTMDT
     I              OMUVST                          WWUVST
     I              OMUWST                          WWUWST
     I              OMUXST                          WWUXST
     I              OMAATM                          WWAATM
     I              OMAYNA                          WWAYNA
     I              OMA0NA                          WWA0NA
     I              OMAXDT                          WWAXDT
      *
     I@BFCPL7
      * Order Header TRG          Invoice Print Selection
      * Renamed input format fields
     I              BEAIC3                          WXAIC3
     I              BEC4NB                          WXC4NB
     I              BEJNCD                          WXJNCD
     I              BEANC7                          WXANC7
     I              BEBKC7                          WXBKC7
     I              BEBRTX                          WXBRTX
     I              BEHMNA                          WXHMNA
     I              BEHONA                          WXHONA
     I              BEHPNA                          WXHPNA
     I              BEHNNA                          WXHNNA
     I              BEDBCD                          WXDBCD
     I              BECKTX                          WXCKTX
     I              BEB0C7                          WXB0C7
     I              BEAETX                          WXAETX
     I              BEB1NA                          WXB1NA
     I              BEB3NA                          WXB3NA
     I              BEB4NA                          WXB4NA
     I              BEB2NA                          WXB2NA
     I              BEBHCD                          WXBHCD
     I              BEC8TX                          WXC8TX
     I              BEBCNA                          WXBCNA
     I              BEA0DT                          WXA0DT
     I              BEA5DT                          WXA5DT
     I              BEGNDT                          WXGNDT
     I              BEACDT                          WXACDT
     I              BEAQCD                          WXAQCD
     I              BEB6NA                          WXB6NA
     I              BEBYNA                          WXBYNA
     I              BEBZNA                          WXBZNA
     I              BEGTST                          WXGTST
     I              BEGVST                          WXGVST
     I              BEGUST                          WXGUST
     I              BEQFST                          WXQFST
     I              BECQCD                          WXCQCD
     I              BEGJST                          WXGJST
     I              BEGWST                          WXGWST
     I              BEGXST                          WXGXST
     I              BEGYST                          WXGYST
     I              BEAODT                          WXAODT
     I              BEAIVN                          WXAIVN
     I              BECXDT                          WXCXDT
     I              BEJZVA                          WXJZVA
     I              BEA1WG                          WXA1WG
     I              BEXIST                          WXXIST
     I              BEXJST                          WXXJST
     I              BEXKST                          WXXKST
     I              BEEIDT                          WXEIDT
     I              BEAFTM                          WXAFTM
     I              BEE8CD                          WXE8CD
     I              BEE9CD                          WXE9CD
     I              BERMNB                          WXRMNB
     I              BETBNB                          WXTBNB
     I              BER1NB                          WXR1NB
     I              BEPJST                          WXPJST
     I              BEU0ST                          WXU0ST
     I              BEU1ST                          WXU1ST
     I              BEQ2CD                          WXQ2CD
     I              BEU2ST                          WXU2ST
     I              BEVEST                          WXVEST
     I              BEVFST                          WXVFST
     I              BEVGST                          WXVGST
     I              BERPCD                          WXRPCD
     I              BERNNB                          WXRNNB
     I              BEVDST                          WXVDST
     I              BEATIN                          WXATIN
     I              BEU4ST                          WXU4ST
     I              BEU5ST                          WXU5ST
     I              BERSRN                          WXRSRN
     I              BEMHNA                          WXMHNA
     I              BEMINA                          WXMINA
     I              BEWBST                          WXWBST
     I              BER4CD                          WXR4CD
     I              BEBFCD                          WXBFCD
     I              BEQ4CD                          WXQ4CD
     I              BET3NB                          WXT3NB
     I              BESICD                          WXSICD
     I              BECONB                          WXCONB
     I              BECEST                          WXCEST
     I              BEAWDT                          WXAWDT
     I              BEJPCD                          WXJPCD
     I              BEXUST                          WXXUST
     I              BEZ1ST                          WXZ1ST
     I              BEVRVA                          WXVRVA
     I              BEOBST                          WXOBST
     I              BEBCST                          WXBCST
     I              BEBDST                          WXBDST
     I              BEB7VL                          WXB7VL
     I              BEGASX                          WXGASX
     I              BEGBSX                          WXGBSX
     I              BEGCSX                          WXGCSX
     I              BEGDSX                          WXGDSX
     I              BEFNSX                          WXFNSX
     I              BEFOSX                          WXFOSX
     I              BEFPSX                          WXFPSX
     I              BEFQSX                          WXFQSX
     I              BEFRSX                          WXFRSX
     I              BEFSSX                          WXFSSX
     I              BEFTSX                          WXFTSX
     I              BEFUSX                          WXFUSX
     I              BEFVSX                          WXFVSX
     I              BEFWSX                          WXFWSX
     I              BEFXSX                          WXFXSX
     I              BEFYSX                          WXFYSX
     I              BENODT                          WXNODT
     I              BENPDT                          WXNPDT
     I              BENQDT                          WXNQDT
     I              BENRDT                          WXNRDT
     I              BENSDT                          WXNSDT
     I              BEBPTM                          WXBPTM
     I              BEBQTM                          WXBQTM
     I              BEBRTM                          WXBRTM
     I              BEBSTM                          WXBSTM
     I              BEBTTM                          WXBTTM
     I              BEH0NX                          WXH0NX
     I              BEH1NX                          WXH1NX
     I              BEH2NX                          WXH2NX
     I              BEH3NX                          WXH3NX
     I              BEH4NX                          WXH4NX
     I              BEC0C7                          WXC0C7
     I              BEUVST                          WXUVST
     I              BEUWST                          WXUWST
     I              BEUXST                          WXUXST
     I              BEAATM                          WXAATM
     I              BEAYNA                          WXAYNA
     I              BEA0NA                          WXA0NA
     I              BEAXDT                          WXAXDT
      *
     I@AFCPHX
      * WF Invoice/Combine Drv    Job/Co/CstPO/Shpto/Ord
      * Renamed input format fields
     I              AFB2VN                          WYB2VN
     I              AFDJVN                          WYDJVN
     I              AFC4NB                          WYC4NB
     I              AFAETX                          WYAETX
     I              AFJZVA                          WYJZVA
     I              AFA1WG                          WYA1WG
     I              AFBRTX                          WYBRTX
     I              AFRLST                          WYRLST
     I              AFHUSX                          WYHUSX
     I              AFBCNA                          WYBCNA
     I              AFA8TX                          WYA8TX
     I              AFBETX                          WYBETX
     I              AFGNDT                          WYGNDT
     I              AFBKC7                          WYBKC7
     I              AFEMC7                          WYEMC7
     I              AFAIC3                          WYAIC3
     I              AFCONB                          WYCONB
     I              AFCEST                          WYCEST
     I              AFVSST                          WYVSST
     I              AFMJDT                          WYMJDT
     I              AFBETM                          WYBETM
     I              AFCCVN                          WYCCVN
     I              AFCDVN                          WYCDVN
     I              AFMKDT                          WYMKDT
     I              AFBFTM                          WYBFTM
     I              AFCEVN                          WYCEVN
     I              AFCFVN                          WYCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      * Outward parameters
     IPBRC        DS                              4
      * KEY : Customer EXT              Retrieval index
      * I : RST Ship To Customer
     I                                    P   1   40PBBKC7
      *
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WEAIC3
     I              ASAXNB                          WEAXNB
     I              ASNGNB                          WENGNB
     I              ASBZNB                          WEBZNB
     I              ASC5NB                          WEC5NB
     I              ASC3NB                          WEC3NB
     I              ASCYNB                          WECYNB
     I              ASIONB                          WEIONB
     I              ASI6NB                          WEI6NB
     I              ASDCNB                          WEDCNB
     I              ASC7NB                          WEC7NB
     I              ASC2NB                          WEC2NB
     I              ASC1NB                          WEC1NB
     I              ASL8NB                          WEL8NB
     I              ASBANB                          WEBANB
     I              ASCHST                          WECHST
     I              ASCKST                          WECKST
     I              ASCIST                          WECIST
     I              ASCGST                          WECGST
     I              ASAIPC                          WEAIPC
     I              ASASPC                          WEASPC
     I              ASA2VA                          WEA2VA
     I              ASC2ST                          WEC2ST
     I              ASD8ST                          WED8ST
     I              ASD7ST                          WED7ST
     I              ASA8NA                          WEA8NA
     I              ASA9NA                          WEA9NA
     I              ASBANA                          WEBANA
     I              ASBBNA                          WEBBNA
     I              ASEUST                          WEEUST
     I              ASAADY                          WEAADY
     I              ASABDY                          WEABDY
     I              ASACDY                          WEACDY
     I              ASADDY                          WEADDY
     I              ASAEDY                          WEAEDY
     I              ASAFDY                          WEAFDY
     I              ASAGDY                          WEAGDY
     I              ASAHDY                          WEAHDY
     I              ASAENB                          WEAENB
     I              ASALNB                          WEALNB
     I              ASEVNB                          WEEVNB
     I              ASRPOP                          WERPOP
     I              ASDWNB                          WEDWNB
     I              ASR3NB                          WER3NB
     I              ASPNST                          WEPNST
     I              ASR4NB                          WER4NB
     I              ASPOST                          WEPOST
     I              ASSCNB                          WESCNB
     I              ASVIST                          WEVIST
     I              ASVJST                          WEVJST
     I              ASBVVN                          WEBVVN
     I              ASUVST                          WEUVST
     I              ASUWST                          WEUWST
     I              ASUXST                          WEUXST
     I              ASVSST                          WEVSST
     I              ASAATM                          WEAATM
     I              ASAYNA                          WEAYNA
     I              ASA0NA                          WEA0NA
     I              ASAXDT                          WEAXDT
      *
     IYBRDCS      DS                            278
     IYCRDCS      DS                            779
     IQPDJ41    E DSPDJ4CPL0
      * UPD : WF Invoice List Work      Update index
      * Renamed input format fields
     I              J4B2VN                          WJB2VN
     I              J4C4NB                          WJC4NB
     I              J4JZVA                          WJJZVA
     I              J4A1WG                          WJA1WG
     I              J4BRTX                          WJBRTX
     I              J4AETX                          WJAETX
     I              J4RLST                          WJRLST
     I              J4CBC7                          WJCBC7
     I              J4BKC7                          WJBKC7
     I              J4AIC3                          WJAIC3
     I              J4CONB                          WJCONB
     I              J4CEST                          WJCEST
      *
     IQPDLY1    E DSPDLYREL0
      * UPD : Trailer                   Update index
      * Renamed input format fields
     I              LYBZNA                          WMBZNA
     I              LYDXTX                          WMDXTX
     I              LYAIC3                          WMAIC3
     I              LYVDST                          WMVDST
     I              LYX3ST                          WMX3ST
     I              LYXGST                          WMXGST
     I              LYSTOY                          WMSTOY
     I              LYKKDT                          WMKKDT
     I              LYAVTM                          WMAVTM
     I              LYSTAS                          WMSTAS
     I              LYXRST                          WMXRST
     I              LYX7CD                          WMX7CD
     I              LYGXTX                          WMGXTX
     I              LYXTST                          WMXTST
     I              LYXVST                          WMXVST
     I              LYSTU3                          WMSTU3
     I              LYSTU4                          WMSTU4
     I              LYSTU5                          WMSTU5
     I              LYLCDT                          WMLCDT
     I              LYLDDT                          WMLDDT
     I              LYLEDT                          WMLEDT
     I              LYLFDT                          WMLFDT
     I              LYLGDT                          WMLGDT
     I              LYUVST                          WMUVST
     I              LYUWST                          WMUWST
     I              LYUXST                          WMUXST
     I              LYVSST                          WMVSST
     I              LYAATM                          WMAATM
     I              LYAYNA                          WMAYNA
     I              LYA0NA                          WMA0NA
     I              LYAXDT                          WMAXDT
      *
      * Outward parameters
     IPCRC        DS                              7
      * KEY : Load Detail               Retrieval index
      * I : RST Load ID
     I                                    P   1   40PCRMNB
      *
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WTAIC3
     I              EYC4NB                          WTC4NB
     I              EYQ2NB                          WTQ2NB
     I              EYJPCD                          WTJPCD
     I              EYAUC3                          WTAUC3
     I              EYQ7NB                          WTQ7NB
     I              EYOMST                          WTOMST
     I              EYD2DT                          WTD2DT
     I              EYONST                          WTONST
     I              EYOOST                          WTOOST
     I              EYOPST                          WTOPST
     I              EYAWC3                          WTAWC3
     I              EYQ8NB                          WTQ8NB
     I              EYQ9NB                          WTQ9NB
     I              EYBKC7                          WTBKC7
     I              EYUVST                          WTUVST
     I              EYUWST                          WTUWST
     I              EYUXST                          WTUXST
     I              EYAATM                          WTAATM
     I              EYAYNA                          WTAYNA
     I              EYA0NA                          WTA0NA
     I              EYAXDT                          WTAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WWAIC3
     I              OMC4NB                          WWC4NB
     I              OMDPNB                          WWDPNB
     I              OMUENB                          WWUENB
     I              OMHGCD                          WWHGCD
     I              OMAJCD                          WWAJCD
     I              OMBKC7                          WWBKC7
     I              OMCFC7                          WWCFC7
     I              OMGMST                          WWGMST
     I              OMGNST                          WWGNST
     I              OMMAVA                          WWMAVA
     I              OMKDVA                          WWKDVA
     I              OML8VA                          WWL8VA
     I              OML9VA                          WWL9VA
     I              OMGTST                          WWGTST
     I              OMGVST                          WWGVST
     I              OMGUST                          WWGUST
     I              OMQFST                          WWQFST
     I              OMAYVA                          WWAYVA
     I              OMEXDT                          WWEXDT
     I              OMLQCD                          WWLQCD
     I              OMRDCD                          WWRDCD
     I              OMQ7CD                          WWQ7CD
     I              OMBZPR                          WWBZPR
     I              OML6NB                          WWL6NB
     I              OMU1ST                          WWU1ST
     I              OMGIDT                          WWGIDT
     I              OMCRCD                          WWCRCD
     I              OMAGCD                          WWAGCD
     I              OMRZST                          WWRZST
     I              OMR0ST                          WWR0ST
     I              OMR1ST                          WWR1ST
     I              OMG7NA                          WWG7NA
     I              OMG8NA                          WWG8NA
     I              OMRPCD                          WWRPCD
     I              OMVEST                          WWVEST
     I              OMVGST                          WWVGST
     I              OMAVST                          WWAVST
     I              OMU0ST                          WWU0ST
     I              OMRFCD                          WWRFCD
     I              OMFZST                          WWFZST
     I              OMR1NB                          WWR1NB
     I              OMAVQT                          WWAVQT
     I              OMD0WG                          WWD0WG
     I              OMCCQT                          WWCCQT
     I              OMAUWG                          WWAUWG
     I              OMCBQT                          WWCBQT
     I              OMATWG                          WWATWG
     I              OMAQCS                          WWAQCS
     I              OMAGCS                          WWAGCS
     I              OMAKPR                          WWAKPR
     I              OMALPR                          WWALPR
     I              OMAUPR                          WWAUPR
     I              OMAVWG                          WWAVWG
     I              OMA4WG                          WWA4WG
     I              OMA5DT                          WWA5DT
     I              OMAODT                          WWAODT
     I              OMGNDT                          WWGNDT
     I              OMAMST                          WWAMST
     I              OMANST                          WWANST
     I              OMVAST                          WWVAST
     I              OMRGNB                          WWRGNB
     I              OMRHNB                          WWRHNB
     I              OMRINB                          WWRINB
     I              OMRBCD                          WWRBCD
     I              OMHICD                          WWHICD
     I              OMRNCD                          WWRNCD
     I              OMROCD                          WWROCD
     I              OMCXDT                          WWCXDT
     I              OMAJVN                          WWAJVN
     I              OMKXCD                          WWKXCD
     I              OMJPCD                          WWJPCD
     I              OMCQCD                          WWCQCD
     I              OMR4CD                          WWR4CD
     I              OMZ1ST                          WWZ1ST
     I              OMZ3ST                          WWZ3ST
     I              OMZ4ST                          WWZ4ST
     I              OMDUPR                          WWDUPR
     I              OMB6VL                          WWB6VL
     I              OMA1AA                          WWA1AA
     I              OMFZSX                          WWFZSX
     I              OMF0SX                          WWF0SX
     I              OMF1SX                          WWF1SX
     I              OMF2SX                          WWF2SX
     I              OMF3SX                          WWF3SX
     I              OMF4SX                          WWF4SX
     I              OMF5SX                          WWF5SX
     I              OMF6SX                          WWF6SX
     I              OMF7SX                          WWF7SX
     I              OMNTDT                          WWNTDT
     I              OMNUDT                          WWNUDT
     I              OMNVDT                          WWNVDT
     I              OMNWDT                          WWNWDT
     I              OMNXDT                          WWNXDT
     I              OMBUTM                          WWBUTM
     I              OMBVTM                          WWBVTM
     I              OMBWTM                          WWBWTM
     I              OMBXTM                          WWBXTM
     I              OMBYTM                          WWBYTM
     I              OMH5NX                          WWH5NX
     I              OMH6NX                          WWH6NX
     I              OMH7NX                          WWH7NX
     I              OMH8NX                          WWH8NX
     I              OMH9NX                          WWH9NX
     I              OMDVPR                          WWDVPR
     I              OMDWPR                          WWDWPR
     I              OMDXPR                          WWDXPR
     I              OMDYPR                          WWDYPR
     I              OMDZPR                          WWDZPR
     I              OMGSPR                          WWGSPR
     I              OMGTPR                          WWGTPR
     I              OMGUPR                          WWGUPR
     I              OMHOST                          WWHOST
     I              OMHPST                          WWHPST
     I              OMIOST                          WWIOST
     I              OMPEWG                          WWPEWG
     I              OMRINY                          WWRINY
     I              OMTIDT                          WWTIDT
     I              OMTJDT                          WWTJDT
     I              OMH2ST                          WWH2ST
     I              OMH0ST                          WWH0ST
     I              OMH1ST                          WWH1ST
     I              OMTKDT                          WWTKDT
     I              OMTLDT                          WWTLDT
     I              OMTMDT                          WWTMDT
     I              OMUVST                          WWUVST
     I              OMUWST                          WWUWST
     I              OMUXST                          WWUXST
     I              OMAATM                          WWAATM
     I              OMAYNA                          WWAYNA
     I              OMA0NA                          WWA0NA
     I              OMAXDT                          WWAXDT
      *
     IYDRDCS      DS                            525
     IYERDCS      DS                            779
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Actual Shipped Date
     I                                    P   7  100P1GNDT
      * I :  Load ID
     I                                    P  11  140P1RMNB
      * B :  Invoice Number
     I                                    P  15  180P1CONB
      * I :  Billing Activity Type
     I                                       19  19 P1OBST
     IP2PARM      DS
      * FLD: *Arrays
      * I :  PRT Description
     I                                        1  25 P2G3TX
      * B :  PRT Printer Device
     I                                       26  35 P2WRST
      * B :  PRT Hold Output Sts
     I                                       36  39 P2WSST
      * B :  PRT Save Output Sts
     I                                       40  43 P2WTST
      * B :  PRT Night Queue Run Sts
     I                                       44  44 P2WUST
      * B :  PRT Night Queue
     I                                       45  54 P2BVVN
      * B :  System Value Numeric
     I                                    P  55  625P2M8NB
     IP3PARM      DS
      * B :  Count USR
     I                                    P   1   30P3CNTU
     IP4PARM      DS
      * I :  Job Name
     I                                        1  10 P4A0NA
     IP5PARM      DS
      * I :  Process Cust Types Usr
     I                                        1   2 P5YDSX
     IP6PARM      DS
      * FLD: *Arrays
      * I :  USR Update Flag
     I                                        1   1 P6R4ST
      * I :  Status - Y or N
     I                                        2   2 P6B8ST
      * B :  USR Status (Y/N)
     I                                        3   3 P6E6ST
     IP7PARM      DS
      * FLD: *Arrays
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1GNDT    PARM           WP0003  70       Actual Shipped
     C           P1RMNB    PARM           WP0004  70       Load ID
     C           P1CONB    PARM P1CONB    WP0005  70       Invoice Number
     C           P1OBST    PARM           WP0006  1        Billing Activit
     C           P2G3TX    PARM           WP0007 25        PRT Description
     C           P2WRST    PARM P2WRST    WP0008 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WP0009  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WP0010  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WP0011  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WP0012 10        PRT Night Queue
     C           P2M8NB    PARM P2M8NB    WP0013 155       System Value Nu
     C           P3CNTU    PARM P3CNTU    WP0014  50       Count USR
     C           P4A0NA    PARM           WP0015 10        Job Name
     C           P5YDSX    PARM           WP0016  2        Process Cust Ty
     C           P6R4ST    PARM           WP0017  1        USR Update Flag
     C           P6B8ST    PARM           WP0018  1        Status - Y or N
     C           P6E6ST    PARM P6E6ST    WP0019  1        USR Status (Y/N
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * SEL Invc to Print&Post XF
      * ** Note - the Status Y/N field is received from the menu and
      * ** determines whether or not amounts are printed on invoices
      * ** and/or reports.
      * CASE: PAR.Order Number is Not equal to zeros
     C           P1C4NB    IFNE *ZERO                      *IF
      * *****
      * FP1110 RMC added 7/18/08 - new for HPB ONLY
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM *BLANK    WQ0002  1        Plant Company S
     C           YL0001    PARM *BLANK    WQ0003  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * FP1110 HPB-Upd Batch Header RIN with RIN for ONE inv that pass va
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0001    IFEQ 'H'                        *IF
      * Exc Upd 1 Ord frm Inv XF - COA Batch Header  * 
     C                     CALL 'PMWUXFR'              90  Exc Upd 1 Ord f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0004  30       Company Number
     C                     PARM P1C4NB    WQ0005  70       Order Number
     C                     PARM P5YDSX    WQ0006  2        Process Cust Ty
     C                     PARM P6B8ST    WQ0007  1        Status - Y or N
     C                     PARM P1GNDT    WQ0008  70       Actual Shipped
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMWUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *****
      * SEL 1 Inv to Prnt&Post RT - Order Header TRG  * 
     C                     EXSR SARVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * *****
      * FP1110 RMC added 7/18/08 - new for HPB ONLY
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0324  30       Company Number
     C                     PARM *BLANK    WQ0325  1        Plant Company S
     C           YL0001    PARM *BLANK    WQ0326  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * FP1110 HPB-Upd Batch Header RIN with RIN for all inv that pass va
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0001    IFEQ 'H'                        *IF
      * Exc Upd from Invoicng XF - COA Batch Header  * 
     C                     CALL 'PMWIXFR'              90  Exc Upd from In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0327  30       COA Shipping Co
     C                     PARM P5YDSX    WQ0328  2        Process Cust Ty
     C                     PARM P6B8ST    WQ0329  1        Status - Y or N
     C                     PARM P1GNDT    WQ0330  70       Actual Shipped
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMWIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *****
      * SEL Invc to Print&Post RT - Order Header TRG  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
     C                     MOVEL##JOB     YL0087           Job Name CDE
     C                     MOVEL##JNO     YL0088           Job Number Cde
      * ** Flag Reprint or Reprint(Form) in the RT            E002016
      * SEL Inv to Prnt& Post  RT - WF Invoice/Combine Drv  * 
     C                     EXSR TARVGN
      * ** Print Exception List if there are any exceptions
      * PRT Invc Except List   PF - Order Header TRG  * 
     C                     CALL 'PPXSPFR'              90  PRT Invc Except
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0657  30       Company Number
     C                     PARM P1C4NB    WQ0658  70       Order Number
     C                     PARM P1GNDT    WQ0659  70       Actual Shipped
     C                     PARM P1RMNB    WQ0660  70       Load ID
     C                     PARM '1'       WQ0661  1        Billing Activit
     C                     PARM @CN,002   WQ0662 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0663 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0664  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0665  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0666  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0667 10        PRT Night Queue
     C           P2M8NB    PARM P2M8NB    WQ0668 155       System Value Nu
     C                     PARM P4A0NA    WQ0669 10        Job Name
     C                     PARM P5YDSX    WQ0670  2        Process Cust Ty
     C                     PARM P6B8ST    WQ0671  1        Status - Y or N
     C           P6E6ST    PARM P6E6ST    WQ0672  1        USR Status (Y/N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPXSPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * SEL 1 Inv to Prnt&Post RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0002  70       Invoice Date
     C                     MOVEL*BLANK    WN0003  1        Order Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P3CNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1C4NB    WQSA02           Order Number
      * Establish starting position
     C           KRSSA     SETLL@BFCPZW                    *
     C           KRSSA     READE@BFCPZW                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WUGYST           Order Type Prin
     C                     MOVEL'IN'      WN0001           Invoice Suffix
     C                     Z-ADD##JDT     WN0002           Invoice Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * ** If Billing Activity Type = 1 Invoice
      * CASE: DB1.Billing Activity Type is Invoice
     C           WAOBST    IFEQ '1'                        *IF
      * Sel Customer Type     XF - Company Customer  * 
     C                     CALL 'PPUOXFR'              90  Sel Customer Ty
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0009  30       Company Number
     C                     PARM WABKC7    WQ0010  70       Ship To Custome
     C           YL0002    PARM YL0002    WQ0011  2        Type Code
     C                     PARM P5YDSX    WQ0012  2        Process Cust Ty
     C           W0RSL     PARM W0RSL     WQ0013  1        *Record selecte
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPUOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Process selected Customer Type (Third Party or Inter-Company)
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * ** Process record for any possible errors. Flag the header with
      * ** the results so the print program knows whether or not to print
      * ** this invoice.
      * 05/01/18 DN R12926-Removed Absorbed Freight Rate CWT Parm on PPX8
      * PRT Invc Excpt Select  XF - Order Header TRG  * 
     C                     CALL 'PPX8XFR'              90  PRT Invc Excpt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0014  30       Company Number
     C                     PARM WAC4NB    WQ0015  70       Order Number
     C                     PARM WAJNCD    WQ0016  2        Order Type - Sa
     C                     PARM WAANC7    WQ0017  70       A/R Customer Nu
     C                     PARM WABKC7    WQ0018  70       Ship To Custome
     C                     PARM WABCNA    WQ0019 15        Customer Purcha
     C                     PARM WAA0DT    WQ0020  70       Order Date
     C                     PARM WAGNDT    WQ0021  70       Actual Shipped
     C                     PARM WAGWST    WQ0022  1        Header Status
     C                     PARM WAGXST    WQ0023  1        Header Status L
     C                     PARM WAAODT    WQ0024  70       Scheduled Ship
     C                     PARM WARMNB    WQ0025  70       Load ID
     C                     PARM WAU0ST    WQ0026  1        Price Audit
     C                     PARM WAU1ST    WQ0027  1        Price Status
     C                     PARM WAQ2CD    WQ0028  2        Shipping Method
     C                     PARM WAR4CD    WQ0029  3        Sales Route Cod
     C                     PARM WAJPCD    WQ0030  2        Event Code
     C                     PARM WAOBST    WQ0031  1        Billing Activit
     C                     PARM P1C4NB    WQ0032  70       USR Order Numbe
     C                     PARM P1RMNB    WQ0033  70       Load ID USR
     C                     PARM '1'       WQ0034  1        USR Billing Act
     C                     PARM P1GNDT    WQ0035  70       USR Actual Ship
     C           YL0003    PARM YL0003    WQ0036  1        Update Exceptio
     C           W0RSL     PARM W0RSL     WQ0037  1        *Record selecte
     C           YL0004    PARM *BLANK    WQ0038  1        Print Pre-Inv/E
     C           YL0005    PARM *BLANK    WQ0039  1        Departure Sts U
     C           YL0006    PARM YL0006    WQ0040 155       System Value Nu
     C           YL0007    PARM YL0007    WQ0041  1        Manual Prc Err
     C           YL0008    PARM YL0008    WQ0042 114       Projected Marke
     C           YL0009    PARM YL0009    WQ0043  1        Average Ship Wg
     C           YL0010    PARM YL0010    WQ0044  1        InterCo Price E
     C           YL0011    PARM YL0011    WQ0045  1        Record Found US
     C           WN0003    PARM WN0003    WQ0046  1        Order Status
     C           YL0012    PARM YL0012    WQ0047  1        GTIN Error Sts
     C           YL0013    PARM YL0013    WQ0048  70       GTIN Error Item
     C                     PARM *ZERO     WQ0049  70       Item Code USR
     C                     PARM *ZERO     WQ0050  70       Item Code
     C           YL0014    PARM YL0014    WQ0051  3        Default Commod
     C           YL0015    PARM YL0015    WQ0052 114       Market Overage
     C           YL0016    PARM YL0016    WQ0053  7        Commodity Price
     C           YL0017    PARM *ZERO     WQ0054 114       Price Overage O
     C                     PARM P5YDSX    WQ0055  2        Process Cust Ty
     C           WUJDST    PARM WUJDST    WQ0056  1        USR Check Y/N S
     C           YL0018    PARM YL0018    WQ0057  1        D-EDI INV PROC
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPX8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * ** Update header if record is ready to invoice
      * CASE: LCL.Print Pre-Inv/Exception is Print on Pre-Invoice Reg
     C           YL0004    IFEQ 'P'                        *IF
     C                     MOVEL'Y'       WUGYST           Order Type Prin
      * CHG Ord Typ PrtSts     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     MOVELWUGYST    WL0003    P      Order Type Prin
     C                     EXSR SBRVGN
      * Combo PO Update the Order Type Print Status  Yes or No
     C                     EXSR UASUBR                     Combo PO Update
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Update header if record has exceptions
      * CASE: LCL.Print Pre-Inv/Exception is Print on Exception
     C           YL0004    IFEQ 'E'                        *IF
     C                     MOVEL'N'       WUGYST           Order Type Prin
      * CHG Ord Typ PrtSts     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     MOVELWUGYST    WL0003    P      Order Type Prin
     C                     EXSR SBRVGN
      * Combo PO Update the Order Type Print Status  Yes or No
     C                     EXSR UBSUBR                     Combo PO Update
     C                     END                             *FI
     C                     END                             *FI
      * ** Process records that are flagged ready to invoice
      * CASE: WRK.Order Type Print Status is yes
     C           WUGYST    IFEQ 'Y'                        *IF
      * Order is priced
      * CASE: DB1.Price Status is Priced
     C           WAU1ST    IFEQ 'P'                        *IF
      * 09/18/07 PKD DLY029 Moved this here instead of the post. The
      *              Sales Tax and Discounts are needed for printing
      *              the Invoices.
      * Process Auto Accruals
      * CASE: DB1.Affect Auto Accruals is Affect Auto Accruals
     C           WAWBST    IFEQ 'Y'                        *IF
      * E4057 JJH 04/27/15 - New I Parm:  Attach to Order Number
      * UPD Auto Accruals      XF - Order Detail  * 
     C                     CALL 'PDT5XFR'              90  UPD Auto Accrua
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0070  30       Company Number
     C                     PARM WAC4NB    WQ0071  70       Order Number
     C                     PARM WAANC7    WQ0072  70       A/R Customer Nu
     C                     PARM WACXDT    WQ0073  70       Date of Origina
     C                     PARM WARMNB    WQ0074  70       Load ID
     C                     PARM WATBNB    WQ0075  52       Absorbed Freigh
     C                     PARM WAT3NB    WQ0076  70       Attach to Order
     C                     PARM WAAWDT    WQ0077  70       Invoice Date
     C                     PARM WAOBST    WQ0078  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDT5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Print all invoices
      * CASE: Select all invoices
      *  - c1 AND c2 ANDc3
      *   |- c1    : PAR.Order Number is Equal to zeros
      *   |- c2    : PAR.Actual Shipped Date is not entered
      *   |- c3    : PAR.Load ID is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1C4NB    IFEQ 0                          *IF
     C           P1GNDT    IFEQ 0                          *IF
     C           P1RMNB    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN0127  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0128  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0129  70       Parent Customer
     C                     MOVEL*BLANK    WN0130 30        Ship To Name
     C                     MOVEL*BLANK    WN0131 30        Ship To Address
     C                     MOVEL*BLANK    WN0132 30        Ship To Address
     C                     MOVEL*BLANK    WN0133 30        Ship To Address
     C                     MOVEL*BLANK    WN0134 20        Ship To City
     C                     MOVEL*BLANK    WN0135  2        Ship To State C
     C                     MOVEL*BLANK    WN0136 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0137  70       Bill to Custome
     C                     MOVEL*BLANK    WN0138 30        Bill to Name
     C                     MOVEL*BLANK    WN0139 30        Bill to Address
     C                     MOVEL*BLANK    WN0140 30        Bill to Address
     C                     MOVEL*BLANK    WN0141 30        Bill to Address
     C                     MOVEL*BLANK    WN0142 20        Bill to City
     C                     MOVEL*BLANK    WN0143  2        Bill to State C
     C                     MOVEL*BLANK    WN0144 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0145 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0146  70       Order Date
     C                     Z-ADD*ZERO     WN0147  70       Requested Ship
     C                     Z-ADD*ZERO     WN0148  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0149  70       Cancel Date
     C                     MOVEL*BLANK    WN0150  2        Terms Code
     C                     MOVEL*BLANK    WN0151 40        Special Instruc
     C                     MOVEL*BLANK    WN0152 40        Special Instruc
     C                     MOVEL*BLANK    WN0153  3        Carrier Code
     C                     MOVEL*BLANK    WN0154  1        Comment Print A
     C                     MOVEL*BLANK    WN0155  1        Comment Print I
     C                     MOVEL*BLANK    WN0156  1        Comment Print P
     C                     MOVEL*BLANK    WN0157  1        Comment Print S
     C                     MOVEL*BLANK    WN0158  3        Reason Code
     C                     MOVEL*BLANK    WN0159  1        Order in Use
     C                     MOVEL*BLANK    WN0160  1        Header Status
     C                     MOVEL*BLANK    WN0161  1        Header Status L
     C                     MOVEL*BLANK    WN0162  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0163  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0164 10        User Original E
     C                     Z-ADD*ZERO     WN0165  70       Date of Origina
     C                     Z-ADD*ZERO     WN0166 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0167 112       Order Weight To
     C                     MOVEL*BLANK    WN0168  1        Credit Hold
     C                     MOVEL*BLANK    WN0169  1        Production Hold
     C                     MOVEL*BLANK    WN0170  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0171  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0172  40       Requested Deliv
     C                     MOVEL*BLANK    WN0173  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0174 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0175  70       Load ID
     C                     Z-ADD*ZERO     WN0176  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0177 112       Rated Freight
     C                     MOVEL*BLANK    WN0178  1        LTL Flag
     C                     MOVEL*BLANK    WN0179  1        Price Audit
     C                     MOVEL*BLANK    WN0180  1        Price Status
     C                     MOVEL*BLANK    WN0181  2        Shipping Method
     C                     MOVEL*BLANK    WN0182  1        Export Status
     C                     MOVEL*BLANK    WN0183  1        Palletize
     C                     MOVEL*BLANK    WN0184  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0185  1        Slip Sheet
     C                     MOVEL*BLANK    WN0186  1        Age Code
     C                     Z-ADD*ZERO     WN0187  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0188  1        Load Type
     C                     Z-ADD*ZERO     WN0189  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0190  1        Load Plan Order
     C                     MOVEL*BLANK    WN0191  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0192  70       Resell Referenc
     C                     MOVEL*BLANK    WN0193 30        Special Comment
     C                     MOVEL*BLANK    WN0194 30        Special Comment
     C                     MOVEL*BLANK    WN0195  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0196  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0197  2        Manager Level C
     C                     MOVEL*BLANK    WN0198  3        VP Level Code
     C                     Z-ADD*ZERO     WN0199  70       Attach to Order
     C                     MOVEL*BLANK    WN0200  3        Reason for Pric
     C                     MOVEL*BLANK    WN0201  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0202  1        Modified Flag
     C                     Z-ADD*ZERO     WN0203 112       A/R order Value
     C                     MOVEL*BLANK    WN0204  1        Billing Activit
     C                     MOVEL*BLANK    WN0205  1        Block Order Fla
     C                     MOVEL*BLANK    WN0206  1        Order Certifica
     C                     Z-ADD*ZERO     WN0207 112       Invoice Order V
     C                     MOVEL*BLANK    WN0208  1        Process Sts for
     C                     MOVEL*BLANK    WN0209  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0210  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0211  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0212  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0213  1        Email Cust On O
     C                     MOVEL*BLANK    WN0214  1        Order Emailed
     C                     MOVEL*BLANK    WN0215  1        Export Docs Go
     C                     MOVEL*BLANK    WN0216  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0217  1        Broker Order St
     C                     MOVEL*BLANK    WN0218  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0219  2        Order Requires
     C                     MOVEL*BLANK    WN0220  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0221  2        Export USDA App
     C                     MOVEL*BLANK    WN0222  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0223  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0224  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0225  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0226  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0227  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0228  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0229  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0230  60       Time of Origina
     C                     Z-ADD*ZERO     WN0231  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0232  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0233  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0234 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0235 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0236 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0237 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0238 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0239  70       Claim Number
     C                     MOVEL*BLANK    WN0240  1        EDI Status 1
     C                     MOVEL*BLANK    WN0241  1        EDI Status 2
     C                     MOVEL*BLANK    WN0242  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0243  60       Job Time
     C                     MOVEL*BLANK    WN0244 10        User Id
     C                     MOVEL*BLANK    WN0245 10        Job Name
     C                     Z-ADD*ZERO     WN0246  70       Job Date
      *
      * SEL Process Prt Invc   IF
      * 2/18/05 PKD use company number 000
      * UPD Next Invoice Nbr   RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD*ZERO     WL0004           Company Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P1CONB           Next Invoice Nu
      * CHG Invoice #, Date    CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0006           Company Number
     C                     Z-ADDWAC4NB    WL0007           Order Number
     C                     Z-ADDP1CONB    WL0008           Invoice Number
     C                     MOVELWN0001    WL0009    P      Invoice Suffix
     C                     Z-ADDWN0002    WL0010           Invoice Date
     C                     EXSR SFCHRC
      * *----------------------------------------------------------------
      * P000198
      * Retrieve Order information for creating Inv List Work & Combine I
     C                     EXSR UCSUBR                     Retrieve Order
      * *----------------------------------------------------------------
     C                     MOVEL##JOB     YL0058           Job Name CDE
     C                     MOVEL##JNO     YL0059           Job Number Cde
      * Create WF Inv/Memo Combo for combine invoices
      * Print Invoice & crt WF Invoice List Work
      * CASE: LCL.Print Invoice Sts is no
     C           YL0055    IFEQ 'N'                        *IF
      * *** Print = N --> Crt Invoice List Work
      * ** Set fax invoice flag to Yes for fax/email program  P000198
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWAC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWAAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN0001    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0085 10        Job Name CDE
     C                     PARM YL0059    WQ0086 10        Job Number Cde
     C                     PARM WAC4NB    WQ0087  70       Order Number
     C                     PARM WAAIC3    WQ0088  30       Company Number
     C           YL0056    PARM *BLANK    WQ0089  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/06/2006 slm -- Do not print the org inv routine
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWAC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWAAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN0001    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0090 10        Job Name CDE
     C                     PARM YL0059    WQ0091 10        Job Number Cde
     C                     PARM WAC4NB    WQ0092  70       Order Number
     C                     PARM WAAIC3    WQ0093  30       Company Number
     C           YL0056    PARM *BLANK    WQ0094  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Print=Y --> Print Invoice. Print will create Invoice List Wor
      * If custom program then print the invoice custom program
      * Department is INCST1
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0095  30       Company Number
     C                     PARM 'IN'      WQ0096  2        CDD Type
     C                     PARM 'INCST1'  WQ0097  6        CDD Department
     C                     PARM *BLANK    WQ0098  8        CDD Name of Ove
     C           YL0063    PARM *BLANK    WQ0099 10        CDD Program Nam
     C                     PARM *BLANK    WQ0100 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0101 10        CDD Additional
     C                     PARM *BLANK    WQ0102 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0103 25        CDD Sender Fax
     C           YL0064    PARM *BLANK    WQ0104 10        Output Queue
     C           YL0065    PARM *BLANK    WQ0105  4        Hold File
     C           YL0066    PARM *BLANK    WQ0106  4        Save File
     C           YL0067    PARM *ZERO     WQ0107  30       Source Drawer
     C                     PARM *BLANK    WQ0108 10        Printer Device
     C                     PARM *ZERO     WQ0109  30       Page Length 2
     C                     PARM *ZERO     WQ0110  30       Page Width 2
     C                     PARM *ZERO     WQ0111  30       Page LPI
     C                     PARM *ZERO     WQ0112  31       Page CPI
     C                     PARM *ZERO     WQ0113  30       Page Overflow
     C                     PARM *BLANK    WQ0114  5        Page Rotation
     C                     PARM *BLANK    WQ0115 50        CDD Comment 1
     C                     PARM *BLANK    WQ0116 50        CDD Comment 2
     C                     PARM *BLANK    WQ0117 50        CDD Comment 3
     C                     PARM *BLANK    WQ0118 50        CDD Comment 4
     C                     PARM *BLANK    WQ0119 50        CDD Comment 5
     C                     PARM *BLANK    WQ0120  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Invoice
      * CASE: LCL.CDD Program Name is Not entered
     C           YL0063    IFEQ *BLANK                     *IF
      * PRT Inv/Memo 8LPI      PF - Order Header TRG  * 
     C                     CALL 'PDR4PFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0121  30       Company Number
     C                     PARM WAC4NB    WQ0122  70       Order Number
     C                     PARM 'N'       WQ0123  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR4PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * If Daily's or HPB
      * CASE: LCL.Company Organization is Daily's
     C           YL0057    IFEQ 'D'                        *IF
      * This will be called three times Customer/Org/Office
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0124  30       Company Number
     C                     PARM WAC4NB    WQ0125  70       Order Number
     C                     PARM 'N'       WQ0126  1        Printed Status
     C                     PARM 'CS'      WQ0127  2        @Invoice Type
     C                     PARM YL0058    WQ0128 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0129  30       Company Number
     C                     PARM WAC4NB    WQ0130  70       Order Number
     C                     PARM 'N'       WQ0131  1        Printed Status
     C                     PARM 'OF'      WQ0132  2        @Invoice Type
     C                     PARM YL0058    WQ0133 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0134  30       Company Number
     C                     PARM WAC4NB    WQ0135  70       Order Number
     C                     PARM 'N'       WQ0136  1        Printed Status
     C                     PARM 'OR'      WQ0137  2        @Invoice Type
     C                     PARM YL0058    WQ0138 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0057    IFEQ 'H'                        *IF
      * FP1110 7/21/08 RMC - Print HPB BOL if COA Batch# is on the Order
     C                     Z-ADD*ZERO     YL0068           HPB COA Batch N
      * VAL OHE exsts for HPB RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0081           Company Number
     C                     Z-ADDWAC4NB    WL0082           Order Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0083    YL0068           HPB COA Batch N
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.HPB COA Batch Number is Entered
      *   |- c2    : LCL.Load ID is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0068    IFGT 0                          *IF
     C           YL0048    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PRT Bill of Lading-HPB PF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDYL0048    PCRMNB           Load ID
      *
     C                     CALL 'PMO7PFR'              90  PRT Bill of Lad
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C                     PARM WAAIC3    WQ0139  30       Company Number
     C                     PARM WN0182    WQ0140  1        Export Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMO7PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * PRT Inv/Memo 8LPI HPB  PF - Order Header TRG  * 
     C                     CALL 'PMRCPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0141  30       Company Number
     C                     PARM WAC4NB    WQ0142  70       Order Number
     C                     PARM 'N'       WQ0143  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------------
      * CRT Invoice Events     RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0084           Company Number
     C                     Z-ADDWAC4NB    WL0085           Order Number
     C                     MOVEL'06'      WL0086    P      Event Code
     C                     Z-ADDWAAIC3    WL0087           Invoice/Memo Co
     C                     Z-ADDP1CONB    WL0088           Invoice/Memo Nu
     C                     MOVELWN0001    WL0089    P      Invoice/Memo Su
     C                     Z-ADDWAANC7    WL0090           Ship To Custome
     C                     EXSR SSRVGN
      * UPD Event: Hdr,O/S Dtl RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0106           Company Number
     C                     Z-ADDWAC4NB    WL0107           Order Number
     C                     MOVEL'06'      WL0108    P      Event Code
     C                     EXSR SVRVGN
     C                     ADD  1         P3CNTU           Count USR
     C                     END                             *FI
      * Print Invoice for order on the selected load
      * CASE: Load ID Selected
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Load ID is NE Blank
      *   |- c2    : DB1.Load ID EQ PAR.Load ID
      *   |- c3    : DB1.Actual Shipped Date is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1RMNB    IFNE 0                          *IF
     C           WARMNB    IFEQ P1RMNB                     *IF
     C           WAGNDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN0682  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0683  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0684  70       Parent Customer
     C                     MOVEL*BLANK    WN0685 30        Ship To Name
     C                     MOVEL*BLANK    WN0686 30        Ship To Address
     C                     MOVEL*BLANK    WN0687 30        Ship To Address
     C                     MOVEL*BLANK    WN0688 30        Ship To Address
     C                     MOVEL*BLANK    WN0689 20        Ship To City
     C                     MOVEL*BLANK    WN0690  2        Ship To State C
     C                     MOVEL*BLANK    WN0691 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0692  70       Bill to Custome
     C                     MOVEL*BLANK    WN0693 30        Bill to Name
     C                     MOVEL*BLANK    WN0694 30        Bill to Address
     C                     MOVEL*BLANK    WN0695 30        Bill to Address
     C                     MOVEL*BLANK    WN0696 30        Bill to Address
     C                     MOVEL*BLANK    WN0697 20        Bill to City
     C                     MOVEL*BLANK    WN0698  2        Bill to State C
     C                     MOVEL*BLANK    WN0699 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0700 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0701  70       Order Date
     C                     Z-ADD*ZERO     WN0702  70       Requested Ship
     C                     Z-ADD*ZERO     WN0703  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0704  70       Cancel Date
     C                     MOVEL*BLANK    WN0705  2        Terms Code
     C                     MOVEL*BLANK    WN0706 40        Special Instruc
     C                     MOVEL*BLANK    WN0707 40        Special Instruc
     C                     MOVEL*BLANK    WN0708  3        Carrier Code
     C                     MOVEL*BLANK    WN0709  1        Comment Print A
     C                     MOVEL*BLANK    WN0710  1        Comment Print I
     C                     MOVEL*BLANK    WN0711  1        Comment Print P
     C                     MOVEL*BLANK    WN0712  1        Comment Print S
     C                     MOVEL*BLANK    WN0713  3        Reason Code
     C                     MOVEL*BLANK    WN0714  1        Order in Use
     C                     MOVEL*BLANK    WN0715  1        Header Status
     C                     MOVEL*BLANK    WN0716  1        Header Status L
     C                     MOVEL*BLANK    WN0717  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0718  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0719 10        User Original E
     C                     Z-ADD*ZERO     WN0720  70       Date of Origina
     C                     Z-ADD*ZERO     WN0721 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0722 112       Order Weight To
     C                     MOVEL*BLANK    WN0723  1        Credit Hold
     C                     MOVEL*BLANK    WN0724  1        Production Hold
     C                     MOVEL*BLANK    WN0725  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0726  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0727  40       Requested Deliv
     C                     MOVEL*BLANK    WN0728  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0729 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0730  70       Load ID
     C                     Z-ADD*ZERO     WN0731  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0732 112       Rated Freight
     C                     MOVEL*BLANK    WN0733  1        LTL Flag
     C                     MOVEL*BLANK    WN0734  1        Price Audit
     C                     MOVEL*BLANK    WN0735  1        Price Status
     C                     MOVEL*BLANK    WN0736  2        Shipping Method
     C                     MOVEL*BLANK    WN0737  1        Export Status
     C                     MOVEL*BLANK    WN0738  1        Palletize
     C                     MOVEL*BLANK    WN0739  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0740  1        Slip Sheet
     C                     MOVEL*BLANK    WN0741  1        Age Code
     C                     Z-ADD*ZERO     WN0742  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0743  1        Load Type
     C                     Z-ADD*ZERO     WN0744  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0745  1        Load Plan Order
     C                     MOVEL*BLANK    WN0746  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0747  70       Resell Referenc
     C                     MOVEL*BLANK    WN0748 30        Special Comment
     C                     MOVEL*BLANK    WN0749 30        Special Comment
     C                     MOVEL*BLANK    WN0750  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0751  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0752  2        Manager Level C
     C                     MOVEL*BLANK    WN0753  3        VP Level Code
     C                     Z-ADD*ZERO     WN0754  70       Attach to Order
     C                     MOVEL*BLANK    WN0755  3        Reason for Pric
     C                     MOVEL*BLANK    WN0756  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0757  1        Modified Flag
     C                     Z-ADD*ZERO     WN0758 112       A/R order Value
     C                     MOVEL*BLANK    WN0759  1        Billing Activit
     C                     MOVEL*BLANK    WN0760  1        Block Order Fla
     C                     MOVEL*BLANK    WN0761  1        Order Certifica
     C                     Z-ADD*ZERO     WN0762 112       Invoice Order V
     C                     MOVEL*BLANK    WN0763  1        Process Sts for
     C                     MOVEL*BLANK    WN0764  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0765  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0766  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0767  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0768  1        Email Cust On O
     C                     MOVEL*BLANK    WN0769  1        Order Emailed
     C                     MOVEL*BLANK    WN0770  1        Export Docs Go
     C                     MOVEL*BLANK    WN0771  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0772  1        Broker Order St
     C                     MOVEL*BLANK    WN0773  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0774  2        Order Requires
     C                     MOVEL*BLANK    WN0775  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0776  2        Export USDA App
     C                     MOVEL*BLANK    WN0777  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0778  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0779  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0780  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0781  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0782  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0783  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0784  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0785  60       Time of Origina
     C                     Z-ADD*ZERO     WN0786  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0787  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0788  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0789 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0790 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0791 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0792 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0793 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0794  70       Claim Number
     C                     MOVEL*BLANK    WN0795  1        EDI Status 1
     C                     MOVEL*BLANK    WN0796  1        EDI Status 2
     C                     MOVEL*BLANK    WN0797  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0798  60       Job Time
     C                     MOVEL*BLANK    WN0799 10        User Id
     C                     MOVEL*BLANK    WN0800 10        Job Name
     C                     Z-ADD*ZERO     WN0801  70       Job Date
      *
      * SEL Process Prt Invc   IF
      * 2/18/05 PKD use company number 000
      * UPD Next Invoice Nbr   RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD*ZERO     WL0004           Company Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P1CONB           Next Invoice Nu
      * CHG Invoice #, Date    CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0006           Company Number
     C                     Z-ADDWAC4NB    WL0007           Order Number
     C                     Z-ADDP1CONB    WL0008           Invoice Number
     C                     MOVELWN0001    WL0009    P      Invoice Suffix
     C                     Z-ADDWN0002    WL0010           Invoice Date
     C                     EXSR SFCHRC
      * *----------------------------------------------------------------
      * P000198
      * Retrieve Order information for creating Inv List Work & Combine I
     C                     EXSR UDSUBR                     Retrieve Order
      * *----------------------------------------------------------------
     C                     MOVEL##JOB     YL0058           Job Name CDE
     C                     MOVEL##JNO     YL0059           Job Number Cde
      * Create WF Inv/Memo Combo for combine invoices
      * Print Invoice & crt WF Invoice List Work
      * CASE: LCL.Print Invoice Sts is no
     C           YL0055    IFEQ 'N'                        *IF
      * *** Print = N --> Crt Invoice List Work
      * ** Set fax invoice flag to Yes for fax/email program  P000198
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWAC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWAAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN0001    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0145 10        Job Name CDE
     C                     PARM YL0059    WQ0146 10        Job Number Cde
     C                     PARM WAC4NB    WQ0147  70       Order Number
     C                     PARM WAAIC3    WQ0148  30       Company Number
     C           YL0056    PARM *BLANK    WQ0149  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/06/2006 slm -- Do not print the org inv routine
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWAC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWAAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN0001    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0150 10        Job Name CDE
     C                     PARM YL0059    WQ0151 10        Job Number Cde
     C                     PARM WAC4NB    WQ0152  70       Order Number
     C                     PARM WAAIC3    WQ0153  30       Company Number
     C           YL0056    PARM *BLANK    WQ0154  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Print=Y --> Print Invoice. Print will create Invoice List Wor
      * If custom program then print the invoice custom program
      * Department is INCST1
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0155  30       Company Number
     C                     PARM 'IN'      WQ0156  2        CDD Type
     C                     PARM 'INCST1'  WQ0157  6        CDD Department
     C                     PARM *BLANK    WQ0158  8        CDD Name of Ove
     C           YL0063    PARM *BLANK    WQ0159 10        CDD Program Nam
     C                     PARM *BLANK    WQ0160 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0161 10        CDD Additional
     C                     PARM *BLANK    WQ0162 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0163 25        CDD Sender Fax
     C           YL0064    PARM *BLANK    WQ0164 10        Output Queue
     C           YL0065    PARM *BLANK    WQ0165  4        Hold File
     C           YL0066    PARM *BLANK    WQ0166  4        Save File
     C           YL0067    PARM *ZERO     WQ0167  30       Source Drawer
     C                     PARM *BLANK    WQ0168 10        Printer Device
     C                     PARM *ZERO     WQ0169  30       Page Length 2
     C                     PARM *ZERO     WQ0170  30       Page Width 2
     C                     PARM *ZERO     WQ0171  30       Page LPI
     C                     PARM *ZERO     WQ0172  31       Page CPI
     C                     PARM *ZERO     WQ0173  30       Page Overflow
     C                     PARM *BLANK    WQ0174  5        Page Rotation
     C                     PARM *BLANK    WQ0175 50        CDD Comment 1
     C                     PARM *BLANK    WQ0176 50        CDD Comment 2
     C                     PARM *BLANK    WQ0177 50        CDD Comment 3
     C                     PARM *BLANK    WQ0178 50        CDD Comment 4
     C                     PARM *BLANK    WQ0179 50        CDD Comment 5
     C                     PARM *BLANK    WQ0180  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Invoice
      * CASE: LCL.CDD Program Name is Not entered
     C           YL0063    IFEQ *BLANK                     *IF
      * PRT Inv/Memo 8LPI      PF - Order Header TRG  * 
     C                     CALL 'PDR4PFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0181  30       Company Number
     C                     PARM WAC4NB    WQ0182  70       Order Number
     C                     PARM 'N'       WQ0183  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR4PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * If Daily's or HPB
      * CASE: LCL.Company Organization is Daily's
     C           YL0057    IFEQ 'D'                        *IF
      * This will be called three times Customer/Org/Office
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0184  30       Company Number
     C                     PARM WAC4NB    WQ0185  70       Order Number
     C                     PARM 'N'       WQ0186  1        Printed Status
     C                     PARM 'CS'      WQ0187  2        @Invoice Type
     C                     PARM YL0058    WQ0188 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0189  30       Company Number
     C                     PARM WAC4NB    WQ0190  70       Order Number
     C                     PARM 'N'       WQ0191  1        Printed Status
     C                     PARM 'OF'      WQ0192  2        @Invoice Type
     C                     PARM YL0058    WQ0193 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0194  30       Company Number
     C                     PARM WAC4NB    WQ0195  70       Order Number
     C                     PARM 'N'       WQ0196  1        Printed Status
     C                     PARM 'OR'      WQ0197  2        @Invoice Type
     C                     PARM YL0058    WQ0198 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0057    IFEQ 'H'                        *IF
      * FP1110 7/21/08 RMC - Print HPB BOL if COA Batch# is on the Order
     C                     Z-ADD*ZERO     YL0068           HPB COA Batch N
      * VAL OHE exsts for HPB RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0081           Company Number
     C                     Z-ADDWAC4NB    WL0082           Order Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0083    YL0068           HPB COA Batch N
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.HPB COA Batch Number is Entered
      *   |- c2    : LCL.Load ID is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0068    IFGT 0                          *IF
     C           YL0048    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PRT Bill of Lading-HPB PF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDYL0048    PCRMNB           Load ID
      *
     C                     CALL 'PMO7PFR'              90  PRT Bill of Lad
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C                     PARM WAAIC3    WQ0199  30       Company Number
     C                     PARM WN0737    WQ0200  1        Export Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMO7PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * PRT Inv/Memo 8LPI HPB  PF - Order Header TRG  * 
     C                     CALL 'PMRCPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0201  30       Company Number
     C                     PARM WAC4NB    WQ0202  70       Order Number
     C                     PARM 'N'       WQ0203  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------------
      * CRT Invoice Events     RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0084           Company Number
     C                     Z-ADDWAC4NB    WL0085           Order Number
     C                     MOVEL'06'      WL0086    P      Event Code
     C                     Z-ADDWAAIC3    WL0087           Invoice/Memo Co
     C                     Z-ADDP1CONB    WL0088           Invoice/Memo Nu
     C                     MOVELWN0001    WL0089    P      Invoice/Memo Su
     C                     Z-ADDWAANC7    WL0090           Ship To Custome
     C                     EXSR SSRVGN
      * UPD Event: Hdr,O/S Dtl RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0106           Company Number
     C                     Z-ADDWAC4NB    WL0107           Order Number
     C                     MOVEL'06'      WL0108    P      Event Code
     C                     EXSR SVRVGN
     C                     ADD  1         P3CNTU           Count USR
     C                     END                             *FI
      * Print Invoice for order selected
      * CASE: Order Selected
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Order Number is Not equal to zeros
      *   |- c2    : DB1.Order Number EQ PAR.Order Number
      *   |- c3    : DB1.Actual Shipped Date is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1C4NB    IFNE 0                          *IF
     C           WAC4NB    IFEQ P1C4NB                     *IF
     C           WAGNDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN0802  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0803  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0804  70       Parent Customer
     C                     MOVEL*BLANK    WN0805 30        Ship To Name
     C                     MOVEL*BLANK    WN0806 30        Ship To Address
     C                     MOVEL*BLANK    WN0807 30        Ship To Address
     C                     MOVEL*BLANK    WN0808 30        Ship To Address
     C                     MOVEL*BLANK    WN0809 20        Ship To City
     C                     MOVEL*BLANK    WN0810  2        Ship To State C
     C                     MOVEL*BLANK    WN0811 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0812  70       Bill to Custome
     C                     MOVEL*BLANK    WN0813 30        Bill to Name
     C                     MOVEL*BLANK    WN0814 30        Bill to Address
     C                     MOVEL*BLANK    WN0815 30        Bill to Address
     C                     MOVEL*BLANK    WN0816 30        Bill to Address
     C                     MOVEL*BLANK    WN0817 20        Bill to City
     C                     MOVEL*BLANK    WN0818  2        Bill to State C
     C                     MOVEL*BLANK    WN0819 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0820 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0821  70       Order Date
     C                     Z-ADD*ZERO     WN0822  70       Requested Ship
     C                     Z-ADD*ZERO     WN0823  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0824  70       Cancel Date
     C                     MOVEL*BLANK    WN0825  2        Terms Code
     C                     MOVEL*BLANK    WN0826 40        Special Instruc
     C                     MOVEL*BLANK    WN0827 40        Special Instruc
     C                     MOVEL*BLANK    WN0828  3        Carrier Code
     C                     MOVEL*BLANK    WN0829  1        Comment Print A
     C                     MOVEL*BLANK    WN0830  1        Comment Print I
     C                     MOVEL*BLANK    WN0831  1        Comment Print P
     C                     MOVEL*BLANK    WN0832  1        Comment Print S
     C                     MOVEL*BLANK    WN0833  3        Reason Code
     C                     MOVEL*BLANK    WN0834  1        Order in Use
     C                     MOVEL*BLANK    WN0835  1        Header Status
     C                     MOVEL*BLANK    WN0836  1        Header Status L
     C                     MOVEL*BLANK    WN0837  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0838  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0839 10        User Original E
     C                     Z-ADD*ZERO     WN0840  70       Date of Origina
     C                     Z-ADD*ZERO     WN0841 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0842 112       Order Weight To
     C                     MOVEL*BLANK    WN0843  1        Credit Hold
     C                     MOVEL*BLANK    WN0844  1        Production Hold
     C                     MOVEL*BLANK    WN0845  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0846  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0847  40       Requested Deliv
     C                     MOVEL*BLANK    WN0848  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0849 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0850  70       Load ID
     C                     Z-ADD*ZERO     WN0851  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0852 112       Rated Freight
     C                     MOVEL*BLANK    WN0853  1        LTL Flag
     C                     MOVEL*BLANK    WN0854  1        Price Audit
     C                     MOVEL*BLANK    WN0855  1        Price Status
     C                     MOVEL*BLANK    WN0856  2        Shipping Method
     C                     MOVEL*BLANK    WN0857  1        Export Status
     C                     MOVEL*BLANK    WN0858  1        Palletize
     C                     MOVEL*BLANK    WN0859  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0860  1        Slip Sheet
     C                     MOVEL*BLANK    WN0861  1        Age Code
     C                     Z-ADD*ZERO     WN0862  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0863  1        Load Type
     C                     Z-ADD*ZERO     WN0864  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0865  1        Load Plan Order
     C                     MOVEL*BLANK    WN0866  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0867  70       Resell Referenc
     C                     MOVEL*BLANK    WN0868 30        Special Comment
     C                     MOVEL*BLANK    WN0869 30        Special Comment
     C                     MOVEL*BLANK    WN0870  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0871  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0872  2        Manager Level C
     C                     MOVEL*BLANK    WN0873  3        VP Level Code
     C                     Z-ADD*ZERO     WN0874  70       Attach to Order
     C                     MOVEL*BLANK    WN0875  3        Reason for Pric
     C                     MOVEL*BLANK    WN0876  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0877  1        Modified Flag
     C                     Z-ADD*ZERO     WN0878 112       A/R order Value
     C                     MOVEL*BLANK    WN0879  1        Billing Activit
     C                     MOVEL*BLANK    WN0880  1        Block Order Fla
     C                     MOVEL*BLANK    WN0881  1        Order Certifica
     C                     Z-ADD*ZERO     WN0882 112       Invoice Order V
     C                     MOVEL*BLANK    WN0883  1        Process Sts for
     C                     MOVEL*BLANK    WN0884  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0885  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0886  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0887  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0888  1        Email Cust On O
     C                     MOVEL*BLANK    WN0889  1        Order Emailed
     C                     MOVEL*BLANK    WN0890  1        Export Docs Go
     C                     MOVEL*BLANK    WN0891  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0892  1        Broker Order St
     C                     MOVEL*BLANK    WN0893  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0894  2        Order Requires
     C                     MOVEL*BLANK    WN0895  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0896  2        Export USDA App
     C                     MOVEL*BLANK    WN0897  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0898  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0899  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0900  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0901  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0902  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0903  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0904  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0905  60       Time of Origina
     C                     Z-ADD*ZERO     WN0906  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0907  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0908  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0909 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0910 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0911 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0912 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0913 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0914  70       Claim Number
     C                     MOVEL*BLANK    WN0915  1        EDI Status 1
     C                     MOVEL*BLANK    WN0916  1        EDI Status 2
     C                     MOVEL*BLANK    WN0917  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0918  60       Job Time
     C                     MOVEL*BLANK    WN0919 10        User Id
     C                     MOVEL*BLANK    WN0920 10        Job Name
     C                     Z-ADD*ZERO     WN0921  70       Job Date
      *
      * SEL Process Prt Invc   IF
      * 2/18/05 PKD use company number 000
      * UPD Next Invoice Nbr   RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD*ZERO     WL0004           Company Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P1CONB           Next Invoice Nu
      * CHG Invoice #, Date    CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0006           Company Number
     C                     Z-ADDWAC4NB    WL0007           Order Number
     C                     Z-ADDP1CONB    WL0008           Invoice Number
     C                     MOVELWN0001    WL0009    P      Invoice Suffix
     C                     Z-ADDWN0002    WL0010           Invoice Date
     C                     EXSR SFCHRC
      * *----------------------------------------------------------------
      * P000198
      * Retrieve Order information for creating Inv List Work & Combine I
     C                     EXSR UESUBR                     Retrieve Order
      * *----------------------------------------------------------------
     C                     MOVEL##JOB     YL0058           Job Name CDE
     C                     MOVEL##JNO     YL0059           Job Number Cde
      * Create WF Inv/Memo Combo for combine invoices
      * Print Invoice & crt WF Invoice List Work
      * CASE: LCL.Print Invoice Sts is no
     C           YL0055    IFEQ 'N'                        *IF
      * *** Print = N --> Crt Invoice List Work
      * ** Set fax invoice flag to Yes for fax/email program  P000198
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWAC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWAAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN0001    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0205 10        Job Name CDE
     C                     PARM YL0059    WQ0206 10        Job Number Cde
     C                     PARM WAC4NB    WQ0207  70       Order Number
     C                     PARM WAAIC3    WQ0208  30       Company Number
     C           YL0056    PARM *BLANK    WQ0209  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/06/2006 slm -- Do not print the org inv routine
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWAC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWAAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN0001    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0210 10        Job Name CDE
     C                     PARM YL0059    WQ0211 10        Job Number Cde
     C                     PARM WAC4NB    WQ0212  70       Order Number
     C                     PARM WAAIC3    WQ0213  30       Company Number
     C           YL0056    PARM *BLANK    WQ0214  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Print=Y --> Print Invoice. Print will create Invoice List Wor
      * If custom program then print the invoice custom program
      * Department is INCST1
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0215  30       Company Number
     C                     PARM 'IN'      WQ0216  2        CDD Type
     C                     PARM 'INCST1'  WQ0217  6        CDD Department
     C                     PARM *BLANK    WQ0218  8        CDD Name of Ove
     C           YL0063    PARM *BLANK    WQ0219 10        CDD Program Nam
     C                     PARM *BLANK    WQ0220 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0221 10        CDD Additional
     C                     PARM *BLANK    WQ0222 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0223 25        CDD Sender Fax
     C           YL0064    PARM *BLANK    WQ0224 10        Output Queue
     C           YL0065    PARM *BLANK    WQ0225  4        Hold File
     C           YL0066    PARM *BLANK    WQ0226  4        Save File
     C           YL0067    PARM *ZERO     WQ0227  30       Source Drawer
     C                     PARM *BLANK    WQ0228 10        Printer Device
     C                     PARM *ZERO     WQ0229  30       Page Length 2
     C                     PARM *ZERO     WQ0230  30       Page Width 2
     C                     PARM *ZERO     WQ0231  30       Page LPI
     C                     PARM *ZERO     WQ0232  31       Page CPI
     C                     PARM *ZERO     WQ0233  30       Page Overflow
     C                     PARM *BLANK    WQ0234  5        Page Rotation
     C                     PARM *BLANK    WQ0235 50        CDD Comment 1
     C                     PARM *BLANK    WQ0236 50        CDD Comment 2
     C                     PARM *BLANK    WQ0237 50        CDD Comment 3
     C                     PARM *BLANK    WQ0238 50        CDD Comment 4
     C                     PARM *BLANK    WQ0239 50        CDD Comment 5
     C                     PARM *BLANK    WQ0240  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Invoice
      * CASE: LCL.CDD Program Name is Not entered
     C           YL0063    IFEQ *BLANK                     *IF
      * PRT Inv/Memo 8LPI      PF - Order Header TRG  * 
     C                     CALL 'PDR4PFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0241  30       Company Number
     C                     PARM WAC4NB    WQ0242  70       Order Number
     C                     PARM 'N'       WQ0243  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR4PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * If Daily's or HPB
      * CASE: LCL.Company Organization is Daily's
     C           YL0057    IFEQ 'D'                        *IF
      * This will be called three times Customer/Org/Office
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0244  30       Company Number
     C                     PARM WAC4NB    WQ0245  70       Order Number
     C                     PARM 'N'       WQ0246  1        Printed Status
     C                     PARM 'CS'      WQ0247  2        @Invoice Type
     C                     PARM YL0058    WQ0248 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0249  30       Company Number
     C                     PARM WAC4NB    WQ0250  70       Order Number
     C                     PARM 'N'       WQ0251  1        Printed Status
     C                     PARM 'OF'      WQ0252  2        @Invoice Type
     C                     PARM YL0058    WQ0253 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0254  30       Company Number
     C                     PARM WAC4NB    WQ0255  70       Order Number
     C                     PARM 'N'       WQ0256  1        Printed Status
     C                     PARM 'OR'      WQ0257  2        @Invoice Type
     C                     PARM YL0058    WQ0258 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0057    IFEQ 'H'                        *IF
      * FP1110 7/21/08 RMC - Print HPB BOL if COA Batch# is on the Order
     C                     Z-ADD*ZERO     YL0068           HPB COA Batch N
      * VAL OHE exsts for HPB RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0081           Company Number
     C                     Z-ADDWAC4NB    WL0082           Order Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0083    YL0068           HPB COA Batch N
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.HPB COA Batch Number is Entered
      *   |- c2    : LCL.Load ID is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0068    IFGT 0                          *IF
     C           YL0048    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PRT Bill of Lading-HPB PF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDYL0048    PCRMNB           Load ID
      *
     C                     CALL 'PMO7PFR'              90  PRT Bill of Lad
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C                     PARM WAAIC3    WQ0259  30       Company Number
     C                     PARM WN0857    WQ0260  1        Export Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMO7PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * PRT Inv/Memo 8LPI HPB  PF - Order Header TRG  * 
     C                     CALL 'PMRCPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0261  30       Company Number
     C                     PARM WAC4NB    WQ0262  70       Order Number
     C                     PARM 'N'       WQ0263  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------------
      * CRT Invoice Events     RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0084           Company Number
     C                     Z-ADDWAC4NB    WL0085           Order Number
     C                     MOVEL'06'      WL0086    P      Event Code
     C                     Z-ADDWAAIC3    WL0087           Invoice/Memo Co
     C                     Z-ADDP1CONB    WL0088           Invoice/Memo Nu
     C                     MOVELWN0001    WL0089    P      Invoice/Memo Su
     C                     Z-ADDWAANC7    WL0090           Ship To Custome
     C                     EXSR SSRVGN
      * UPD Event: Hdr,O/S Dtl RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0106           Company Number
     C                     Z-ADDWAC4NB    WL0107           Order Number
     C                     MOVEL'06'      WL0108    P      Event Code
     C                     EXSR SVRVGN
     C                     ADD  1         P3CNTU           Count USR
     C                     END                             *FI
      * Print Invoice for order with Actual Ship Date LE selected ship da
      * CASE: Actual Shipped Date Selected
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : PAR.Order Number is Equal to zeros
      *   |- c2    : PAR.Load ID is Blank
      *   |- c3    : PAR.Actual Shipped Date is entered
      *   |- c4    : DB1.Actual Shipped Date LE PAR.Actual Shipped Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1C4NB    IFEQ 0                          *IF
     C           P1RMNB    IFEQ 0                          *IF
     C           P1GNDT    IFNE 0                          *IF
     C           WAGNDT    IFLE P1GNDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN0922  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0923  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0924  70       Parent Customer
     C                     MOVEL*BLANK    WN0925 30        Ship To Name
     C                     MOVEL*BLANK    WN0926 30        Ship To Address
     C                     MOVEL*BLANK    WN0927 30        Ship To Address
     C                     MOVEL*BLANK    WN0928 30        Ship To Address
     C                     MOVEL*BLANK    WN0929 20        Ship To City
     C                     MOVEL*BLANK    WN0930  2        Ship To State C
     C                     MOVEL*BLANK    WN0931 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0932  70       Bill to Custome
     C                     MOVEL*BLANK    WN0933 30        Bill to Name
     C                     MOVEL*BLANK    WN0934 30        Bill to Address
     C                     MOVEL*BLANK    WN0935 30        Bill to Address
     C                     MOVEL*BLANK    WN0936 30        Bill to Address
     C                     MOVEL*BLANK    WN0937 20        Bill to City
     C                     MOVEL*BLANK    WN0938  2        Bill to State C
     C                     MOVEL*BLANK    WN0939 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0940 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0941  70       Order Date
     C                     Z-ADD*ZERO     WN0942  70       Requested Ship
     C                     Z-ADD*ZERO     WN0943  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0944  70       Cancel Date
     C                     MOVEL*BLANK    WN0945  2        Terms Code
     C                     MOVEL*BLANK    WN0946 40        Special Instruc
     C                     MOVEL*BLANK    WN0947 40        Special Instruc
     C                     MOVEL*BLANK    WN0948  3        Carrier Code
     C                     MOVEL*BLANK    WN0949  1        Comment Print A
     C                     MOVEL*BLANK    WN0950  1        Comment Print I
     C                     MOVEL*BLANK    WN0951  1        Comment Print P
     C                     MOVEL*BLANK    WN0952  1        Comment Print S
     C                     MOVEL*BLANK    WN0953  3        Reason Code
     C                     MOVEL*BLANK    WN0954  1        Order in Use
     C                     MOVEL*BLANK    WN0955  1        Header Status
     C                     MOVEL*BLANK    WN0956  1        Header Status L
     C                     MOVEL*BLANK    WN0957  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0958  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0959 10        User Original E
     C                     Z-ADD*ZERO     WN0960  70       Date of Origina
     C                     Z-ADD*ZERO     WN0961 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0962 112       Order Weight To
     C                     MOVEL*BLANK    WN0963  1        Credit Hold
     C                     MOVEL*BLANK    WN0964  1        Production Hold
     C                     MOVEL*BLANK    WN0965  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0966  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0967  40       Requested Deliv
     C                     MOVEL*BLANK    WN0968  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0969 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0970  70       Load ID
     C                     Z-ADD*ZERO     WN0971  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0972 112       Rated Freight
     C                     MOVEL*BLANK    WN0973  1        LTL Flag
     C                     MOVEL*BLANK    WN0974  1        Price Audit
     C                     MOVEL*BLANK    WN0975  1        Price Status
     C                     MOVEL*BLANK    WN0976  2        Shipping Method
     C                     MOVEL*BLANK    WN0977  1        Export Status
     C                     MOVEL*BLANK    WN0978  1        Palletize
     C                     MOVEL*BLANK    WN0979  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0980  1        Slip Sheet
     C                     MOVEL*BLANK    WN0981  1        Age Code
     C                     Z-ADD*ZERO     WN0982  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0983  1        Load Type
     C                     Z-ADD*ZERO     WN0984  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0985  1        Load Plan Order
     C                     MOVEL*BLANK    WN0986  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0987  70       Resell Referenc
     C                     MOVEL*BLANK    WN0988 30        Special Comment
     C                     MOVEL*BLANK    WN0989 30        Special Comment
     C                     MOVEL*BLANK    WN0990  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0991  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0992  2        Manager Level C
     C                     MOVEL*BLANK    WN0993  3        VP Level Code
     C                     Z-ADD*ZERO     WN0994  70       Attach to Order
     C                     MOVEL*BLANK    WN0995  3        Reason for Pric
     C                     MOVEL*BLANK    WN0996  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0997  1        Modified Flag
     C                     Z-ADD*ZERO     WN0998 112       A/R order Value
     C                     MOVEL*BLANK    WN0999  1        Billing Activit
     C                     MOVEL*BLANK    WN1000  1        Block Order Fla
     C                     MOVEL*BLANK    WN1001  1        Order Certifica
     C                     Z-ADD*ZERO     WN1002 112       Invoice Order V
     C                     MOVEL*BLANK    WN1003  1        Process Sts for
     C                     MOVEL*BLANK    WN1004  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1005  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1006  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1007  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1008  1        Email Cust On O
     C                     MOVEL*BLANK    WN1009  1        Order Emailed
     C                     MOVEL*BLANK    WN1010  1        Export Docs Go
     C                     MOVEL*BLANK    WN1011  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1012  1        Broker Order St
     C                     MOVEL*BLANK    WN1013  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1014  2        Order Requires
     C                     MOVEL*BLANK    WN1015  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1016  2        Export USDA App
     C                     MOVEL*BLANK    WN1017  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1018  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1019  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1020  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1021  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1022  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1023  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1024  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1025  60       Time of Origina
     C                     Z-ADD*ZERO     WN1026  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1027  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1028  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1029 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1030 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1031 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1032 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1033 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1034  70       Claim Number
     C                     MOVEL*BLANK    WN1035  1        EDI Status 1
     C                     MOVEL*BLANK    WN1036  1        EDI Status 2
     C                     MOVEL*BLANK    WN1037  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1038  60       Job Time
     C                     MOVEL*BLANK    WN1039 10        User Id
     C                     MOVEL*BLANK    WN1040 10        Job Name
     C                     Z-ADD*ZERO     WN1041  70       Job Date
      *
      * SEL Process Prt Invc   IF
      * 2/18/05 PKD use company number 000
      * UPD Next Invoice Nbr   RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD*ZERO     WL0004           Company Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P1CONB           Next Invoice Nu
      * CHG Invoice #, Date    CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0006           Company Number
     C                     Z-ADDWAC4NB    WL0007           Order Number
     C                     Z-ADDP1CONB    WL0008           Invoice Number
     C                     MOVELWN0001    WL0009    P      Invoice Suffix
     C                     Z-ADDWN0002    WL0010           Invoice Date
     C                     EXSR SFCHRC
      * *----------------------------------------------------------------
      * P000198
      * Retrieve Order information for creating Inv List Work & Combine I
     C                     EXSR UFSUBR                     Retrieve Order
      * *----------------------------------------------------------------
     C                     MOVEL##JOB     YL0058           Job Name CDE
     C                     MOVEL##JNO     YL0059           Job Number Cde
      * Create WF Inv/Memo Combo for combine invoices
      * Print Invoice & crt WF Invoice List Work
      * CASE: LCL.Print Invoice Sts is no
     C           YL0055    IFEQ 'N'                        *IF
      * *** Print = N --> Crt Invoice List Work
      * ** Set fax invoice flag to Yes for fax/email program  P000198
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWAC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWAAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN0001    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0265 10        Job Name CDE
     C                     PARM YL0059    WQ0266 10        Job Number Cde
     C                     PARM WAC4NB    WQ0267  70       Order Number
     C                     PARM WAAIC3    WQ0268  30       Company Number
     C           YL0056    PARM *BLANK    WQ0269  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/06/2006 slm -- Do not print the org inv routine
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWAC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWAAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN0001    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0270 10        Job Name CDE
     C                     PARM YL0059    WQ0271 10        Job Number Cde
     C                     PARM WAC4NB    WQ0272  70       Order Number
     C                     PARM WAAIC3    WQ0273  30       Company Number
     C           YL0056    PARM *BLANK    WQ0274  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Print=Y --> Print Invoice. Print will create Invoice List Wor
      * If custom program then print the invoice custom program
      * Department is INCST1
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0275  30       Company Number
     C                     PARM 'IN'      WQ0276  2        CDD Type
     C                     PARM 'INCST1'  WQ0277  6        CDD Department
     C                     PARM *BLANK    WQ0278  8        CDD Name of Ove
     C           YL0063    PARM *BLANK    WQ0279 10        CDD Program Nam
     C                     PARM *BLANK    WQ0280 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0281 10        CDD Additional
     C                     PARM *BLANK    WQ0282 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0283 25        CDD Sender Fax
     C           YL0064    PARM *BLANK    WQ0284 10        Output Queue
     C           YL0065    PARM *BLANK    WQ0285  4        Hold File
     C           YL0066    PARM *BLANK    WQ0286  4        Save File
     C           YL0067    PARM *ZERO     WQ0287  30       Source Drawer
     C                     PARM *BLANK    WQ0288 10        Printer Device
     C                     PARM *ZERO     WQ0289  30       Page Length 2
     C                     PARM *ZERO     WQ0290  30       Page Width 2
     C                     PARM *ZERO     WQ0291  30       Page LPI
     C                     PARM *ZERO     WQ0292  31       Page CPI
     C                     PARM *ZERO     WQ0293  30       Page Overflow
     C                     PARM *BLANK    WQ0294  5        Page Rotation
     C                     PARM *BLANK    WQ0295 50        CDD Comment 1
     C                     PARM *BLANK    WQ0296 50        CDD Comment 2
     C                     PARM *BLANK    WQ0297 50        CDD Comment 3
     C                     PARM *BLANK    WQ0298 50        CDD Comment 4
     C                     PARM *BLANK    WQ0299 50        CDD Comment 5
     C                     PARM *BLANK    WQ0300  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Invoice
      * CASE: LCL.CDD Program Name is Not entered
     C           YL0063    IFEQ *BLANK                     *IF
      * PRT Inv/Memo 8LPI      PF - Order Header TRG  * 
     C                     CALL 'PDR4PFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0301  30       Company Number
     C                     PARM WAC4NB    WQ0302  70       Order Number
     C                     PARM 'N'       WQ0303  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR4PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * If Daily's or HPB
      * CASE: LCL.Company Organization is Daily's
     C           YL0057    IFEQ 'D'                        *IF
      * This will be called three times Customer/Org/Office
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0304  30       Company Number
     C                     PARM WAC4NB    WQ0305  70       Order Number
     C                     PARM 'N'       WQ0306  1        Printed Status
     C                     PARM 'CS'      WQ0307  2        @Invoice Type
     C                     PARM YL0058    WQ0308 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0309  30       Company Number
     C                     PARM WAC4NB    WQ0310  70       Order Number
     C                     PARM 'N'       WQ0311  1        Printed Status
     C                     PARM 'OF'      WQ0312  2        @Invoice Type
     C                     PARM YL0058    WQ0313 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0314  30       Company Number
     C                     PARM WAC4NB    WQ0315  70       Order Number
     C                     PARM 'N'       WQ0316  1        Printed Status
     C                     PARM 'OR'      WQ0317  2        @Invoice Type
     C                     PARM YL0058    WQ0318 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0057    IFEQ 'H'                        *IF
      * FP1110 7/21/08 RMC - Print HPB BOL if COA Batch# is on the Order
     C                     Z-ADD*ZERO     YL0068           HPB COA Batch N
      * VAL OHE exsts for HPB RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0081           Company Number
     C                     Z-ADDWAC4NB    WL0082           Order Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0083    YL0068           HPB COA Batch N
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.HPB COA Batch Number is Entered
      *   |- c2    : LCL.Load ID is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0068    IFGT 0                          *IF
     C           YL0048    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PRT Bill of Lading-HPB PF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDYL0048    PCRMNB           Load ID
      *
     C                     CALL 'PMO7PFR'              90  PRT Bill of Lad
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C                     PARM WAAIC3    WQ0319  30       Company Number
     C                     PARM WN0977    WQ0320  1        Export Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMO7PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * PRT Inv/Memo 8LPI HPB  PF - Order Header TRG  * 
     C                     CALL 'PMRCPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0321  30       Company Number
     C                     PARM WAC4NB    WQ0322  70       Order Number
     C                     PARM 'N'       WQ0323  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0071           Company Number
     C                     Z-ADDWAC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------------
      * CRT Invoice Events     RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0084           Company Number
     C                     Z-ADDWAC4NB    WL0085           Order Number
     C                     MOVEL'06'      WL0086    P      Event Code
     C                     Z-ADDWAAIC3    WL0087           Invoice/Memo Co
     C                     Z-ADDP1CONB    WL0088           Invoice/Memo Nu
     C                     MOVELWN0001    WL0089    P      Invoice/Memo Su
     C                     Z-ADDWAANC7    WL0090           Ship To Custome
     C                     EXSR SSRVGN
      * UPD Event: Hdr,O/S Dtl RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0106           Company Number
     C                     Z-ADDWAC4NB    WL0107           Order Number
     C                     MOVEL'06'      WL0108    P      Event Code
     C                     EXSR SVRVGN
     C                     ADD  1         P3CNTU           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@BFCPZW                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * CHG Ord Typ PrtSts     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Ord Typ Prt Status CH - Order Header TRG  * 
     C                     EXSR SCCHRC
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * CHG Ord Typ Prt Status CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0004  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0005  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0006  70       Ship To Custome
     C                     MOVEL*BLANK    WN0007 30        Ship To Name
     C                     MOVEL*BLANK    WN0008 30        Ship To Address
     C                     MOVEL*BLANK    WN0009 30        Ship To Address
     C                     MOVEL*BLANK    WN0010 30        Ship To Address
     C                     MOVEL*BLANK    WN0011 20        Ship To City
     C                     MOVEL*BLANK    WN0012  2        Ship To State C
     C                     MOVEL*BLANK    WN0013 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0014  70       Bill to Custome
     C                     MOVEL*BLANK    WN0015 30        Bill to Name
     C                     MOVEL*BLANK    WN0016 30        Bill to Address
     C                     MOVEL*BLANK    WN0017 30        Bill to Address
     C                     MOVEL*BLANK    WN0018 30        Bill to Address
     C                     MOVEL*BLANK    WN0019 20        Bill to City
     C                     MOVEL*BLANK    WN0020  2        Bill to State C
     C                     MOVEL*BLANK    WN0021 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0022 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0023  70       Order Date
     C                     Z-ADD*ZERO     WN0024  70       Requested Ship
     C                     Z-ADD*ZERO     WN0025  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0026  70       Cancel Date
     C                     MOVEL*BLANK    WN0027  2        Terms Code
     C                     MOVEL*BLANK    WN0028 40        Special Instruc
     C                     MOVEL*BLANK    WN0029 40        Special Instruc
     C                     MOVEL*BLANK    WN0030  3        Carrier Code
     C                     MOVEL*BLANK    WN0031  1        Comment Print A
     C                     MOVEL*BLANK    WN0032  1        Comment Print I
     C                     MOVEL*BLANK    WN0033  1        Comment Print P
     C                     MOVEL*BLANK    WN0034  1        Comment Print S
     C                     MOVEL*BLANK    WN0035  3        Reason Code
     C                     MOVEL*BLANK    WN0036  1        Order in Use
     C                     MOVEL*BLANK    WN0037  1        Header Status
     C                     MOVEL*BLANK    WN0038  1        Header Status L
     C                     Z-ADD*ZERO     WN0039  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0040 10        User Original E
     C                     Z-ADD*ZERO     WN0041  70       Date of Origina
     C                     Z-ADD*ZERO     WN0042 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0043 112       Order Weight To
     C                     MOVEL*BLANK    WN0044  1        Credit Hold
     C                     MOVEL*BLANK    WN0045  1        Production Hold
     C                     MOVEL*BLANK    WN0046  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0047  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0048  40       Requested Deliv
     C                     MOVEL*BLANK    WN0049  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0050 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0051  70       Load ID
     C                     Z-ADD*ZERO     WN0052  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0053 112       Rated Freight
     C                     MOVEL*BLANK    WN0054  1        LTL Flag
     C                     MOVEL*BLANK    WN0055  1        Price Audit
     C                     MOVEL*BLANK    WN0056  1        Price Status
     C                     MOVEL*BLANK    WN0057  2        Shipping Method
     C                     MOVEL*BLANK    WN0058  1        Export Status
     C                     MOVEL*BLANK    WN0059  1        Palletize
     C                     MOVEL*BLANK    WN0060  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0061  1        Slip Sheet
     C                     MOVEL*BLANK    WN0062  1        Age Code
     C                     Z-ADD*ZERO     WN0063  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0064  1        Load Type
     C                     Z-ADD*ZERO     WN0065  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0066  1        Load Plan Order
     C                     MOVEL*BLANK    WN0067  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0068  70       Resell Referenc
     C                     MOVEL*BLANK    WN0069 30        Special Comment
     C                     MOVEL*BLANK    WN0070 30        Special Comment
     C                     MOVEL*BLANK    WN0071  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0072  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0073  2        Manager Level C
     C                     MOVEL*BLANK    WN0074  3        VP Level Code
     C                     Z-ADD*ZERO     WN0075  70       Attach to Order
     C                     MOVEL*BLANK    WN0076  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0077  70       Invoice Number
     C                     MOVEL*BLANK    WN0078  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0079  70       Invoice Date
     C                     MOVEL*BLANK    WN0080  2        Event Code
     C                     MOVEL*BLANK    WN0081  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0082  1        Modified Flag
     C                     Z-ADD*ZERO     WN0083 112       A/R order Value
     C                     MOVEL*BLANK    WN0084  1        Billing Activit
     C                     MOVEL*BLANK    WN0085  1        Block Order Fla
     C                     MOVEL*BLANK    WN0086  1        Order Certifica
     C                     Z-ADD*ZERO     WN0087 112       Invoice Order V
     C                     MOVEL*BLANK    WN0088  1        Process Sts for
     C                     MOVEL*BLANK    WN0089  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0090  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0091  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0092  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0093  1        Email Cust On O
     C                     MOVEL*BLANK    WN0094  1        Order Emailed
     C                     MOVEL*BLANK    WN0095  1        Export Docs Go
     C                     MOVEL*BLANK    WN0096  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0097  1        Broker Order St
     C                     MOVEL*BLANK    WN0098  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0099  2        Order Requires
     C                     MOVEL*BLANK    WN0100  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0101  2        Export USDA App
     C                     MOVEL*BLANK    WN0102  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0103  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0104  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0105  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0106  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0107  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0108  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0109  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0110  60       Time of Origina
     C                     Z-ADD*ZERO     WN0111  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0112  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0113  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0114 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0115 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0116 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0117 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0118 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0119  70       Claim Number
     C                     MOVEL*BLANK    WN0120  1        EDI Status 1
     C                     MOVEL*BLANK    WN0121  1        EDI Status 2
     C                     MOVEL*BLANK    WN0122  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0123  60       Job Time
     C                     MOVEL*BLANK    WN0124 10        User Id
     C                     MOVEL*BLANK    WN0125 10        Job Name
     C                     Z-ADD*ZERO     WN0126  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHSC    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0003    WCGYST    P      Order Type Prin
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWCAIC3    PAAIC3           Company Number
     C                     Z-ADDWCC4NB    PAC4NB           Order Number
     C                     MOVELWCJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWCANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWCBKC7    PABKC7           Ship To Custome
     C                     MOVELWCBRTX    PABRTX    P      Ship To Name
     C                     MOVELWCHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWCHONA    PAHONA    P      Ship To Address
     C                     MOVELWCHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWCHNNA    PAHNNA    P      Ship To City
     C                     MOVELWCDBCD    PADBCD    P      Ship To State C
     C                     MOVELWCCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWCB0C7    PAB0C7           Bill to Custome
     C                     MOVELWCAETX    PAAETX    P      Bill to Name
     C                     MOVELWCB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWCB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWCB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWCB2NA    PAB2NA    P      Bill to City
     C                     MOVELWCBHCD    PABHCD    P      Bill to State C
     C                     MOVELWCC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWCBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWCA0DT    PAA0DT           Order Date
     C                     Z-ADDWCA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWCGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWCACDT    PAACDT           Cancel Date
     C                     MOVELWCAQCD    PAAQCD    P      Terms Code
     C                     MOVELWCB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWCBYNA    PABYNA    P      Special Instruc
     C                     MOVELWCBZNA    PABZNA    P      Carrier Code
     C                     MOVELWCGTST    PAGTST    P      Comment Print A
     C                     MOVELWCGVST    PAGVST    P      Comment Print I
     C                     MOVELWCGUST    PAGUST    P      Comment Print P
     C                     MOVELWCQFST    PAQFST    P      Comment Print S
     C                     MOVELWCCQCD    PACQCD    P      Reason Code
     C                     MOVELWCGJST    PAGJST    P      Order in Use
     C                     MOVELWCGWST    PAGWST    P      Header Status
     C                     MOVELWCGXST    PAGXST    P      Header Status L
     C                     MOVELWL0003    PAGYST    P      Order Type Prin
     C                     Z-ADDWCAODT    PAAODT           Scheduled Ship
     C                     MOVELWCAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWCCXDT    PACXDT           Date of Origina
     C                     Z-ADDWCJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWCA1WG    PAA1WG           Order Weight To
     C                     MOVELWCXIST    PAXIST    P      Credit Hold
     C                     MOVELWCXJST    PAXJST    P      Production Hold
     C                     MOVELWCXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWCEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWCAFTM    PAAFTM           Requested Deliv
     C                     MOVELWCE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWCE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWCRMNB    PARMNB           Load ID
     C                     Z-ADDWCTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWCR1NB    PAR1NB           Rated Freight
     C                     MOVELWCPJST    PAPJST    P      LTL Flag
     C                     MOVELWCU0ST    PAU0ST    P      Price Audit
     C                     MOVELWCU1ST    PAU1ST    P      Price Status
     C                     MOVELWCQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWCU2ST    PAU2ST    P      Export Status
     C                     MOVELWCVEST    PAVEST    P      Palletize
     C                     MOVELWCVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWCVGST    PAVGST    P      Slip Sheet
     C                     MOVELWCRPCD    PARPCD    P      Age Code
     C                     Z-ADDWCRNNB    PARNNB           Reefer Temperat
     C                     MOVELWCVDST    PAVDST    P      Load Type
     C                     Z-ADDWCATIN    PAATIN           Attach to Invoi
     C                     MOVELWCU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWCU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWCRSRN    PARSRN           Resell Referenc
     C                     MOVELWCMHNA    PAMHNA    P      Special Comment
     C                     MOVELWCMINA    PAMINA    P      Special Comment
     C                     MOVELWCWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWCR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWCBFCD    PABFCD    P      Manager Level C
     C                     MOVELWCQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWCT3NB    PAT3NB           Attach to Order
     C                     MOVELWCSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWCCONB    PACONB           Invoice Number
     C                     MOVELWCCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWCAWDT    PAAWDT           Invoice Date
     C                     MOVELWCJPCD    PAJPCD    P      Event Code
     C                     MOVELWCXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWCZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWCVRVA    PAVRVA           A/R order Value
     C                     MOVELWCOBST    PAOBST    P      Billing Activit
     C                     MOVELWCBCST    PABCST    P      Block Order Fla
     C                     MOVELWCBDST    PABDST    P      Order Certifica
     C                     Z-ADDWCB7VL    PAB7VL           Invoice Order V
     C                     MOVELWCGASX    PAGASX    P      Process Sts for
     C                     MOVELWCGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWCGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWCGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWCFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWCFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWCFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWCFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWCFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWCFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWCFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWCFUSX    PAFUSX    P      Order Requires
     C                     MOVELWCFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWCFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWCFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWCFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWCNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWCNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWCNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWCNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWCNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWCBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWCBQTM    PABQTM           Time of Origina
     C                     Z-ADDWCBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWCBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWCBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWCH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWCH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWCH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWCH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWCH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWCC0C7    PAC0C7           Claim Number
     C                     MOVELWCUVST    PAUVST    P      EDI Status 1
     C                     MOVELWCUWST    PAUWST    P      EDI Status 2
     C                     MOVELWCUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWCAATM    PAAATM           Job Time
     C                     MOVELWCAYNA    PAAYNA    P      User Id
     C                     MOVELWCA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWCAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * UPD Next Invoice Nbr   RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0004    WDAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * 2/18/05 PKD get invoice number from company 000
      * CHG Next Invoice Nbr   CH - Company Control  * 
     C                     EXSR SECHRC
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * CHG Next Invoice Nbr   CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0247  40       Current Account
     C                     Z-ADD*ZERO     WN0248  20       Current Account
     C                     Z-ADD*ZERO     WN0249  30       OM Week
     C                     Z-ADD*ZERO     WN0250  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0251  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0252  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0253  70       Next Charge Bac
     C                     Z-ADD*ZERO     WN0254  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0255  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0256  70       Next Customer #
     C                     Z-ADD*ZERO     WN0257  70       Next Inventory
     C                     Z-ADD*ZERO     WN0258  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0259  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0260  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0261  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0262  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0263  1        Auto Customers
     C                     MOVEL*BLANK    WN0264  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0265  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0266  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0267 112       Late Charge Min
     C                     MOVEL*BLANK    WN0268  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0269  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0270  1        Allocate Credit
     C                     MOVEL*BLANK    WN0271 30        Message Line 1
     C                     MOVEL*BLANK    WN0272 30        Message Line 2
     C                     MOVEL*BLANK    WN0273 30        Message Line 3
     C                     MOVEL*BLANK    WN0274 30        Message Line 4
     C                     MOVEL*BLANK    WN0275  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0276  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0277  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0278  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0279  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0280  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0281  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0282  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0283  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0284  30       Retention Perio
     C                     Z-ADD*ZERO     WN0285  30       Retention Perio
     C                     Z-ADD*ZERO     WN0286  30       Retention Perio
     C                     Z-ADD*ZERO     WN0287  30       Retention Perio
     C                     Z-ADD*ZERO     WN0288  30       Retention Perio
     C                     Z-ADD*ZERO     WN0289  70       Next Load ID
     C                     MOVEL*BLANK    WN0290  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0291  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0292  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0293  30       Production Numb
     C                     MOVEL*BLANK    WN0294  1        Freight by Poun
     C                     MOVEL*BLANK    WN0295  1        Price Audit Act
     C                     MOVEL*BLANK    WN0296 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0297  1        EDI Status 1
     C                     MOVEL*BLANK    WN0298  1        EDI Status 2
     C                     MOVEL*BLANK    WN0299  1        EDI Status 3
     C                     MOVEL*BLANK    WN0300  1        Record Status
     C                     Z-ADD*ZERO     WN0301  60       Job Time
     C                     MOVEL*BLANK    WN0302 10        User Id
     C                     MOVEL*BLANK    WN0303 10        Job Name
     C                     Z-ADD*ZERO     WN0304  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADD*ZERO     WEAIC3           Company Number
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C           KLCHSE    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YBRDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Assumes Invoice numbers always automatically assigned
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
      * Val Invoice Exists    XF - A/R Header  * 
     C                     CALL 'PMQIXFR'              90  Val Invoice Exi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEC3NB    WQ0079  70       Invoice Number
     C           YL0020    PARM *BLANK    WQ0080  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMQIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * DO WHILE: LCL.Record Found USR is Record Found
     C           YL0020    DOWEQ'Y'                        *DOW
     C                     ADD  1         WEC3NB           Next Invoice Nu
      * Val Invoice Exists    XF - A/R Header  * 
     C                     CALL 'PMQIXFR'              90  Val Invoice Exi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEC3NB    WQ0081  70       Invoice Number
     C           YL0020    PARM *BLANK    WQ0082  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMQIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *ITR
     C                     Z-ADDWEC3NB    WL0005           USR Next Invoic
     C                     ADD  1         WEC3NB           Next Invoice Nu
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG Invoice #, Date    CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0305  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0306  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0307  70       Ship To Custome
     C                     MOVEL*BLANK    WN0308 30        Ship To Name
     C                     MOVEL*BLANK    WN0309 30        Ship To Address
     C                     MOVEL*BLANK    WN0310 30        Ship To Address
     C                     MOVEL*BLANK    WN0311 30        Ship To Address
     C                     MOVEL*BLANK    WN0312 20        Ship To City
     C                     MOVEL*BLANK    WN0313  2        Ship To State C
     C                     MOVEL*BLANK    WN0314 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0315  70       Bill to Custome
     C                     MOVEL*BLANK    WN0316 30        Bill to Name
     C                     MOVEL*BLANK    WN0317 30        Bill to Address
     C                     MOVEL*BLANK    WN0318 30        Bill to Address
     C                     MOVEL*BLANK    WN0319 30        Bill to Address
     C                     MOVEL*BLANK    WN0320 20        Bill to City
     C                     MOVEL*BLANK    WN0321  2        Bill to State C
     C                     MOVEL*BLANK    WN0322 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0323 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0324  70       Order Date
     C                     Z-ADD*ZERO     WN0325  70       Requested Ship
     C                     Z-ADD*ZERO     WN0326  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0327  70       Cancel Date
     C                     MOVEL*BLANK    WN0328  2        Terms Code
     C                     MOVEL*BLANK    WN0329 40        Special Instruc
     C                     MOVEL*BLANK    WN0330 40        Special Instruc
     C                     MOVEL*BLANK    WN0331  3        Carrier Code
     C                     MOVEL*BLANK    WN0332  1        Comment Print A
     C                     MOVEL*BLANK    WN0333  1        Comment Print I
     C                     MOVEL*BLANK    WN0334  1        Comment Print P
     C                     MOVEL*BLANK    WN0335  1        Comment Print S
     C                     MOVEL*BLANK    WN0336  3        Reason Code
     C                     MOVEL*BLANK    WN0337  1        Order in Use
     C                     MOVEL*BLANK    WN0338  1        Header Status
     C                     MOVEL*BLANK    WN0339  1        Header Status L
     C                     MOVEL*BLANK    WN0340  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0341  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0342 10        User Original E
     C                     Z-ADD*ZERO     WN0343  70       Date of Origina
     C                     Z-ADD*ZERO     WN0344 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0345 112       Order Weight To
     C                     MOVEL*BLANK    WN0346  1        Credit Hold
     C                     MOVEL*BLANK    WN0347  1        Production Hold
     C                     MOVEL*BLANK    WN0348  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0349  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0350  40       Requested Deliv
     C                     MOVEL*BLANK    WN0351  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0352 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0353  70       Load ID
     C                     Z-ADD*ZERO     WN0354  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0355 112       Rated Freight
     C                     MOVEL*BLANK    WN0356  1        LTL Flag
     C                     MOVEL*BLANK    WN0357  1        Price Audit
     C                     MOVEL*BLANK    WN0358  1        Price Status
     C                     MOVEL*BLANK    WN0359  2        Shipping Method
     C                     MOVEL*BLANK    WN0360  1        Export Status
     C                     MOVEL*BLANK    WN0361  1        Palletize
     C                     MOVEL*BLANK    WN0362  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0363  1        Slip Sheet
     C                     MOVEL*BLANK    WN0364  1        Age Code
     C                     Z-ADD*ZERO     WN0365  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0366  1        Load Type
     C                     Z-ADD*ZERO     WN0367  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0368  1        Load Plan Order
     C                     MOVEL*BLANK    WN0369  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0370  70       Resell Referenc
     C                     MOVEL*BLANK    WN0371 30        Special Comment
     C                     MOVEL*BLANK    WN0372 30        Special Comment
     C                     MOVEL*BLANK    WN0373  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0374  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0375  2        Manager Level C
     C                     MOVEL*BLANK    WN0376  3        VP Level Code
     C                     Z-ADD*ZERO     WN0377  70       Attach to Order
     C                     MOVEL*BLANK    WN0378  3        Reason for Pric
     C                     MOVEL*BLANK    WN0379  2        Event Code
     C                     MOVEL*BLANK    WN0380  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0381  1        Modified Flag
     C                     Z-ADD*ZERO     WN0382 112       A/R order Value
     C                     MOVEL*BLANK    WN0383  1        Billing Activit
     C                     MOVEL*BLANK    WN0384  1        Block Order Fla
     C                     MOVEL*BLANK    WN0385  1        Order Certifica
     C                     Z-ADD*ZERO     WN0386 112       Invoice Order V
     C                     MOVEL*BLANK    WN0387  1        Process Sts for
     C                     MOVEL*BLANK    WN0388  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0389  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0390  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0391  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0392  1        Email Cust On O
     C                     MOVEL*BLANK    WN0393  1        Order Emailed
     C                     MOVEL*BLANK    WN0394  1        Export Docs Go
     C                     MOVEL*BLANK    WN0395  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0396  1        Broker Order St
     C                     MOVEL*BLANK    WN0397  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0398  2        Order Requires
     C                     MOVEL*BLANK    WN0399  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0400  2        Export USDA App
     C                     MOVEL*BLANK    WN0401  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0402  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0403  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0404  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0405  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0406  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0407  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0408  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0409  60       Time of Origina
     C                     Z-ADD*ZERO     WN0410  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0411  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0412  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0413 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0414 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0415 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0416 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0417 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0418  70       Claim Number
     C                     MOVEL*BLANK    WN0419  1        EDI Status 1
     C                     MOVEL*BLANK    WN0420  1        EDI Status 2
     C                     MOVEL*BLANK    WN0421  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0422  60       Job Time
     C                     MOVEL*BLANK    WN0423 10        User Id
     C                     MOVEL*BLANK    WN0424 10        Job Name
     C                     Z-ADD*ZERO     WN0425  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0006    WCAIC3           Company Number
     C                     Z-ADDWL0007    WCC4NB           Order Number
      *
     C           KLCHSF    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHSF    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0008    WCCONB           Invoice Number
     C                     MOVELWL0009    WCCEST    P      Invoice Suffix
     C                     Z-ADDWL0010    WCAWDT           Invoice Date
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWCAIC3    PAAIC3           Company Number
     C                     Z-ADDWCC4NB    PAC4NB           Order Number
     C                     MOVELWCJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWCANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWCBKC7    PABKC7           Ship To Custome
     C                     MOVELWCBRTX    PABRTX    P      Ship To Name
     C                     MOVELWCHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWCHONA    PAHONA    P      Ship To Address
     C                     MOVELWCHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWCHNNA    PAHNNA    P      Ship To City
     C                     MOVELWCDBCD    PADBCD    P      Ship To State C
     C                     MOVELWCCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWCB0C7    PAB0C7           Bill to Custome
     C                     MOVELWCAETX    PAAETX    P      Bill to Name
     C                     MOVELWCB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWCB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWCB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWCB2NA    PAB2NA    P      Bill to City
     C                     MOVELWCBHCD    PABHCD    P      Bill to State C
     C                     MOVELWCC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWCBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWCA0DT    PAA0DT           Order Date
     C                     Z-ADDWCA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWCGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWCACDT    PAACDT           Cancel Date
     C                     MOVELWCAQCD    PAAQCD    P      Terms Code
     C                     MOVELWCB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWCBYNA    PABYNA    P      Special Instruc
     C                     MOVELWCBZNA    PABZNA    P      Carrier Code
     C                     MOVELWCGTST    PAGTST    P      Comment Print A
     C                     MOVELWCGVST    PAGVST    P      Comment Print I
     C                     MOVELWCGUST    PAGUST    P      Comment Print P
     C                     MOVELWCQFST    PAQFST    P      Comment Print S
     C                     MOVELWCCQCD    PACQCD    P      Reason Code
     C                     MOVELWCGJST    PAGJST    P      Order in Use
     C                     MOVELWCGWST    PAGWST    P      Header Status
     C                     MOVELWCGXST    PAGXST    P      Header Status L
     C                     MOVELWCGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWCAODT    PAAODT           Scheduled Ship
     C                     MOVELWCAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWCCXDT    PACXDT           Date of Origina
     C                     Z-ADDWCJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWCA1WG    PAA1WG           Order Weight To
     C                     MOVELWCXIST    PAXIST    P      Credit Hold
     C                     MOVELWCXJST    PAXJST    P      Production Hold
     C                     MOVELWCXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWCEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWCAFTM    PAAFTM           Requested Deliv
     C                     MOVELWCE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWCE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWCRMNB    PARMNB           Load ID
     C                     Z-ADDWCTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWCR1NB    PAR1NB           Rated Freight
     C                     MOVELWCPJST    PAPJST    P      LTL Flag
     C                     MOVELWCU0ST    PAU0ST    P      Price Audit
     C                     MOVELWCU1ST    PAU1ST    P      Price Status
     C                     MOVELWCQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWCU2ST    PAU2ST    P      Export Status
     C                     MOVELWCVEST    PAVEST    P      Palletize
     C                     MOVELWCVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWCVGST    PAVGST    P      Slip Sheet
     C                     MOVELWCRPCD    PARPCD    P      Age Code
     C                     Z-ADDWCRNNB    PARNNB           Reefer Temperat
     C                     MOVELWCVDST    PAVDST    P      Load Type
     C                     Z-ADDWCATIN    PAATIN           Attach to Invoi
     C                     MOVELWCU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWCU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWCRSRN    PARSRN           Resell Referenc
     C                     MOVELWCMHNA    PAMHNA    P      Special Comment
     C                     MOVELWCMINA    PAMINA    P      Special Comment
     C                     MOVELWCWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWCR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWCBFCD    PABFCD    P      Manager Level C
     C                     MOVELWCQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWCT3NB    PAT3NB           Attach to Order
     C                     MOVELWCSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWCCONB    PACONB           Invoice Number
     C                     MOVELWCCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWCAWDT    PAAWDT           Invoice Date
     C                     MOVELWCJPCD    PAJPCD    P      Event Code
     C                     MOVELWCXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWCZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWCVRVA    PAVRVA           A/R order Value
     C                     MOVELWCOBST    PAOBST    P      Billing Activit
     C                     MOVELWCBCST    PABCST    P      Block Order Fla
     C                     MOVELWCBDST    PABDST    P      Order Certifica
     C                     Z-ADDWCB7VL    PAB7VL           Invoice Order V
     C                     MOVELWCGASX    PAGASX    P      Process Sts for
     C                     MOVELWCGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWCGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWCGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWCFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWCFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWCFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWCFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWCFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWCFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWCFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWCFUSX    PAFUSX    P      Order Requires
     C                     MOVELWCFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWCFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWCFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWCFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWCNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWCNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWCNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWCNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWCNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWCBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWCBQTM    PABQTM           Time of Origina
     C                     Z-ADDWCBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWCBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWCBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWCH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWCH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWCH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWCH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWCH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWCC0C7    PAC0C7           Claim Number
     C                     MOVELWCUVST    PAUVST    P      EDI Status 1
     C                     MOVELWCUWST    PAUWST    P      EDI Status 2
     C                     MOVELWCUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWCAATM    PAAATM           Job Time
     C                     MOVELWCAYNA    PAAYNA    P      User Id
     C                     MOVELWCA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWCAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * E00196 10/3/12 RMC CAT2 calls regular pfs interface
      * Rtv Active Status     RT - PFS Interface  * 
     C                     EXSR SGRVGN
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0022    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCRMNB    WQ0083  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFY1NX           PFS Company Num
     C                     KFLD           WFGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWCAIC3    WFY1NX           PFS Company Num
     C                     MOVEL'LDORDD'  WFGYAA           PFS Interface C
      * Establish starting position
     C           KRSSG     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0021           PFS AccuSort Ac
     C                     MOVEL*BLANK    YL0022           PFS Carlisle Ac
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFWSSX    YL0021           PFS AccuSort Ac
     C                     MOVELWFWUSX    YL0022           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0011    WBAIC3           Company Number
     C                     Z-ADDWL0012    WBC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0013           Order Type - Sa
     C                     Z-ADD*ZERO     WL0014           A/R Customer Nu
     C                     Z-ADD*ZERO     WL0015           Ship To Custome
     C                     MOVEL*BLANK    WL0016           Ship To Name
     C                     MOVEL*BLANK    WL0017           Ship To Address
     C                     MOVEL*BLANK    WL0018           Ship To Address
     C                     MOVEL*BLANK    WL0019           Ship To Address
     C                     MOVEL*BLANK    WL0020           Ship To City
     C                     MOVEL*BLANK    WL0021           Ship To State C
     C                     MOVEL*BLANK    WL0022           Ship To Zip/Pos
     C                     Z-ADD*ZERO     WL0023           Bill to Custome
     C                     MOVEL*BLANK    WL0024           Bill to Name
     C                     MOVEL*BLANK    WL0025           Bill to Address
     C                     MOVEL*BLANK    WL0026           Bill to Address
     C                     MOVEL*BLANK    WL0027           Bill to Address
     C                     MOVEL*BLANK    WL0028           Bill to City
     C                     MOVEL*BLANK    WL0029           Bill to State C
     C                     MOVEL*BLANK    WL0030           Bill to Zip/Pos
     C                     MOVEL*BLANK    WL0031           Customer Purcha
     C                     Z-ADD*ZERO     WL0032           Order Date
     C                     Z-ADD*ZERO     WL0033           Actual Shipped
     C                     MOVEL*BLANK    WL0034           Terms Code
     C                     MOVEL*BLANK    WL0035           Carrier Code
     C                     Z-ADD*ZERO     WL0036           Order Value Tot
     C                     Z-ADD*ZERO     WL0037           Order Weight To
     C                     Z-ADD*ZERO     WL0038           Load ID
     C                     MOVEL*BLANK    WL0039           Sales Route Cod
     C                     Z-ADD*ZERO     WL0040           Invoice Number
     C                     Z-ADD*ZERO     WL0041           Invoice Date
     C                     MOVEL*BLANK    WL0042           Billing Activit
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBJNCD    WL0013           Order Type - Sa
     C                     Z-ADDWBANC7    WL0014           A/R Customer Nu
     C                     Z-ADDWBBKC7    WL0015           Ship To Custome
     C                     MOVELWBBRTX    WL0016           Ship To Name
     C                     MOVELWBHMNA    WL0017           Ship To Address
     C                     MOVELWBHONA    WL0018           Ship To Address
     C                     MOVELWBHPNA    WL0019           Ship To Address
     C                     MOVELWBHNNA    WL0020           Ship To City
     C                     MOVELWBDBCD    WL0021           Ship To State C
     C                     MOVELWBCKTX    WL0022           Ship To Zip/Pos
     C                     Z-ADDWBB0C7    WL0023           Bill to Custome
     C                     MOVELWBAETX    WL0024           Bill to Name
     C                     MOVELWBB1NA    WL0025           Bill to Address
     C                     MOVELWBB3NA    WL0026           Bill to Address
     C                     MOVELWBB4NA    WL0027           Bill to Address
     C                     MOVELWBB2NA    WL0028           Bill to City
     C                     MOVELWBBHCD    WL0029           Bill to State C
     C                     MOVELWBC8TX    WL0030           Bill to Zip/Pos
     C                     MOVELWBBCNA    WL0031           Customer Purcha
     C                     Z-ADDWBA0DT    WL0032           Order Date
     C                     Z-ADDWBGNDT    WL0033           Actual Shipped
     C                     MOVELWBAQCD    WL0034           Terms Code
     C                     MOVELWBBZNA    WL0035           Carrier Code
     C                     Z-ADDWBJZVA    WL0036           Order Value Tot
     C                     Z-ADDWBA1WG    WL0037           Order Weight To
     C                     Z-ADDWBRMNB    WL0038           Load ID
     C                     MOVELWBR4CD    WL0039           Sales Route Cod
     C                     Z-ADDWBCONB    WL0040           Invoice Number
     C                     Z-ADDWBAWDT    WL0041           Invoice Date
     C                     MOVELWBOBST    WL0042           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV CDE 1 Fax only    RT - Cust Distribution Entry  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0046           CDE Name
     C                     MOVEL*BLANK    WL0047           CDE Destination
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGBKC7    WQSI01           Ship To Custome
     C           *LIKE     DEFN WGMNAA    WQSI02           Distribution Co
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Ship To Custome
     C                     KFLD           WQSI02           Distribution Co
     C                     KFLD           WGRNNY           CDE Sequence Nu
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Ship To Custome
     C                     KFLD           WQSI02           Distribution Co
      * Setup key
     C                     Z-ADDWL0043    WQSI01           Ship To Custome
     C                     MOVELWL0044    WQSI02           Distribution Co
     C                     Z-ADDWL0045    WGRNNY           CDE Sequence Nu
      * Establish starting position
     C           KPSSI     SETLL@F7REFP                    *
     C           KRSSI     READE@F7REFP                  90*
      * Data record not found
     C   90                MOVEL'USR4289' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Return 1st active record with a fax number
      * CASE: DB1.CDE Destination Type is Fax
     C           WGIRST    IFEQ 'F'                        *IF
      * CASE: DB1.Record Status is Active
     C           WGVSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELWGWLT1    WL0046           CDE Name
     C                     MOVELWGWMT1    WL0047           CDE Destination
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@F7REFP                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV CDE 1st Eml only  RT - Cust Distribution Entry  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0051           CDE Name
     C                     MOVEL*BLANK    WL0052           CDE Destination
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGBKC7    WQSJ01           Ship To Custome
     C           *LIKE     DEFN WGMNAA    WQSJ02           Distribution Co
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Ship To Custome
     C                     KFLD           WQSJ02           Distribution Co
     C                     KFLD           WGRNNY           CDE Sequence Nu
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Ship To Custome
     C                     KFLD           WQSJ02           Distribution Co
      * Setup key
     C                     Z-ADDWL0048    WQSJ01           Ship To Custome
     C                     MOVELWL0049    WQSJ02           Distribution Co
     C                     Z-ADDWL0050    WGRNNY           CDE Sequence Nu
      * Establish starting position
     C           KPSSJ     SETLL@F7REFP                    *
     C           KRSSJ     READE@F7REFP                  90*
      * Data record not found
     C   90                MOVEL'USR4289' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Return 1st active record with an email address
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.CDE Destination Type is Email
      *   |- c2    : DB1.CDE Destination Type is One Email/Invoice
      *   '-
     C           WGIRST    IFEQ 'E'                        *IF
     C           WGIRST    OREQ 'O'                        *OR
      * R14851 4/15/19  RMC ADDED Type = O
      * CASE: DB1.Record Status is Active
     C           WGVSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELWGWLT1    WL0051           CDE Name
     C                     MOVELWGWMT1    WL0052           CDE Destination
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@F7REFP                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0053    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0054           EDI Invoice Sts
     C                     MOVEL*BLANK    WL0055           Print Invoice S
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHLTCD    WL0054           EDI Invoice Sts
     C                     MOVELWHQXST    WL0055           Print Invoice S
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0056    WIAIC3           Company Number
      * Establish starting position
     C           KRSSL     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0057           Plant Company S
     C                     MOVEL*BLANK    WL0058           Company Organiz
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIYISX    WL0057           Plant Company S
     C                     MOVELWIYJSX    WL0058           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @J4CPDG
     C                     MOVELWL0059    WJB2VN           Job Name CDE
     C                     Z-ADDWL0060    WJC4NB           Order Number
     C                     Z-ADDWL0061    WJJZVA           Order Value Tot
     C                     Z-ADDWL0062    WJA1WG           Order Weight To
     C                     MOVELWL0063    WJBRTX           Ship To Name
     C                     MOVELWL0064    WJAETX           Bill to Name
     C                     MOVELWL0065    WJRLST           Fax Invoice Fla
     C                     Z-ADDWL0066    WJCBC7           Ship to Custome
     C                     Z-ADDWL0067    WJBKC7           Ship To Custome
     C                     Z-ADDWL0068    WJAIC3           Company Number
     C                     Z-ADDWL0069    WJCONB           Invoice Number
     C                     MOVELWL0070    WJCEST           Invoice Suffix
      *
     C           KLCRSM    KLIST
     C                     KFLD           WJB2VN           Job Name CDE
     C                     KFLD           WJC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSM    SETLL@J4CPDG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2069' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@J4CPDG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0073           Scheduled Ship
     C                     Z-ADD*ZERO     WL0074           Load ID
     C                     MOVEL*BLANK    WL0075           Load Plan Order
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0071    WBAIC3           Company Number
     C                     Z-ADDWL0072    WBC4NB           Order Number
      * Establish starting position
     C           KRSSN     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAODT    WL0073           Scheduled Ship
     C                     Z-ADDWBRMNB    WL0074           Load ID
     C                     MOVELWBU4ST    WL0075           Load Plan Order
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Carrier & Trailer  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WKRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0076    WKRMNB           Load ID
      * Establish starting position
     C           KRSSO     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKDXTX    WL0077           Trailer Id
     C                     MOVELWKBZNA    WL0078           Carrier Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WLBZNA           Carrier Code
     C                     KFLD           WLDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0079    WLBZNA           Carrier Code
     C                     MOVELWL0080    WLDXTX           Trailer Id
      * Establish starting position
     C           KRSSP     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
      * * Not an error, may have been deleted from another order on load
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * DLT Trailer            DO - Trailer  * 
     C                     EXSR SQDLRC
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQDLRC    BEGSR
      *================================================================
      * DLT Trailer            DO - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @LYRER2
     C                     MOVELWLBZNA    WMBZNA           Carrier Code
     C                     MOVELWLDXTX    WMDXTX           Trailer Id
      *
     C           KLDLSQ    KLIST
     C                     KFLD           WMBZNA           Carrier Code
     C                     KFLD           WMDXTX           Trailer Id
     C           KLDLSQ    CHAIN@LYRER2              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLYREL0'MDACP
     C                     MOVEL'@LYRER2' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@LYRER2                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * VAL OHE exsts for HPB RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0081    WOAIC3           Company Number
     C                     Z-ADDWL0082    WOC4NB           Order Number
      * Establish starting position
     C           KRSSR     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOITNY    WL0083           HPB COA Batch N
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * CRT Invoice Events     RT - Order Events  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0426  50       Event Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0426           Event Number
      * RTV Latest Event/Date  RT - OP Order Events  * 
     C                     EXSR STRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WRC4NB    WQSS02           Order Number
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Order Number
      * Setup key
     C                     Z-ADDWL0084    WQSS01           Company Number
     C                     Z-ADDWL0085    WQSS02           Order Number
      * Establish starting position
     C           KRSSS     SETLL@EYCPY2                    *
     C           KRSSS     READE@EYCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
      * CRT OP Order Events    CR - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0084    WL0091           Company Number
     C                     Z-ADDWL0085    WL0092           Order Number
     C                     Z-ADD1         WL0093           Event Number
     C                     MOVELWL0086    WL0094    P      Event Code
     C                     Z-ADDWL0084    WL0095           Invoice/Memo Co
     C                     Z-ADD*ZERO     WL0096           Invoice/Memo Nu
     C                     MOVEL*BLANK    WL0097           Invoice/Memo Su
     C                     Z-ADD##JDT     WL0098           Event Date
     C                     MOVEL'Y'       WL0099    P      Activity Comple
     C                     MOVEL'N'       WL0100    P      Activity Hold
     C                     MOVEL'Y'       WL0101    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0102           Cross Event Ref
     C                     Z-ADD*ZERO     WL0103           Cross Event Ref
     C                     Z-ADD*ZERO     WL0104           Cross Event Ref
     C                     Z-ADD*ZERO     WL0105           Ship To Custome
     C                     EXSR SUCRRC
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN0426           Event Number
      * CRT OP Order Events    CR - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0084    WL0091           Company Number
     C                     Z-ADDWL0085    WL0092           Order Number
     C                     Z-ADDWN0426    WL0093           Event Number
     C                     MOVELWL0086    WL0094    P      Event Code
     C                     Z-ADDWL0084    WL0095           Invoice/Memo Co
     C                     Z-ADDWL0088    WL0096           Invoice/Memo Nu
     C                     MOVELWL0089    WL0097    P      Invoice/Memo Su
     C                     Z-ADD##JDT     WL0098           Event Date
     C                     MOVEL'Y'       WL0099    P      Activity Comple
     C                     MOVEL'N'       WL0100    P      Activity Hold
     C                     MOVEL'N'       WL0101    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0102           Cross Event Ref
     C                     Z-ADD*ZERO     WL0103           Cross Event Ref
     C                     Z-ADD*ZERO     WL0104           Cross Event Ref
     C                     Z-ADDWL0090    WL0105           Ship To Custome
     C                     EXSR SUCRRC
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Latest Event/Date  RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQST01           Company Number
     C           *LIKE     DEFN WSC4NB    WQST02           Order Number
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Order Number
      * Setup key
     C                     Z-ADDWL0084    WQST01           Company Number
     C                     Z-ADDWL0085    WQST02           Order Number
      * Establish starting position
     C           KRSST     SETLL@EYCPZR                    *
     C           KRSST     READE@EYCPZR                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWSQ2NB    WN0426           Event Number
     C                     MOVELWSJPCD    WUG0TX           Event Code
     C                     Z-ADDWSD2DT    WUNFNN           Event Date
     C                     MOVELWSOOST    WUG0TX           Activity Hold
     C           KRSST     READE@EYCPZR                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - OP Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0427  1        EDI Status 1
     C                     MOVEL*BLANK    WN0428  1        EDI Status 2
     C                     MOVEL*BLANK    WN0429  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0430  60       Job Time
     C                     MOVEL*BLANK    WN0431 10        User Id
     C                     MOVEL*BLANK    WN0432 10        Job Name
     C                     Z-ADD*ZERO     WN0433  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWL0091    WTAIC3           Company Number
     C                     Z-ADDWL0092    WTC4NB           Order Number
     C                     Z-ADDWL0093    WTQ2NB           Event Number
     C                     MOVELWL0094    WTJPCD           Event Code
     C                     Z-ADDWL0095    WTAUC3           Invoice/Memo Co
     C                     Z-ADDWL0096    WTQ7NB           Invoice/Memo Nu
     C                     MOVELWL0097    WTOMST           Invoice/Memo Su
     C                     Z-ADDWL0098    WTD2DT           Event Date
     C                     MOVELWL0099    WTONST           Activity Comple
     C                     MOVELWL0100    WTOOST           Activity Hold
     C                     MOVELWL0101    WTOPST           Post Cash Compl
     C                     Z-ADDWL0102    WTAWC3           Cross Event Ref
     C                     Z-ADDWL0103    WTQ8NB           Cross Event Ref
     C                     Z-ADDWL0104    WTQ9NB           Cross Event Ref
     C                     Z-ADDWL0105    WTBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##JOB     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
     C           KLCRSU    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTC4NB           Order Number
     C                     KFLD           WTQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSU    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * UPD Event: Hdr,O/S Dtl RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0106    WBAIC3           Company Number
     C                     Z-ADDWL0107    WBC4NB           Order Number
      * Establish starting position
     C           KRSSV     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * UPD Event: Ship Detail RT - PD Order Detail  * 
     C                     EXSR SWRVGN
      * CHG Ord Event & Stat.  CH - PD Order Header  * 
     C                     EXSR SYCHRC
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * UPD Event: Ship Detail RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVAIC3    WQSW01           Company Number
     C           *LIKE     DEFN WVC4NB    WQSW02           Order Number
      * Define keylist
     C           KPSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Order Number
     C                     KFLD           WVDPNB           Order Sequence
     C                     KFLD           WVUENB           Order Secondary
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSW01           Company Number
     C                     Z-ADDWBC4NB    WQSW02           Order Number
     C                     Z-ADD*ZERO     WVDPNB           Order Sequence
     C                     Z-ADD*ZERO     WVUENB           Order Secondary
      * Establish starting position
     C           KPSSW     SETLL@BGWKAE                    *
     C           KRSSW     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Shipping Event     CH - PD Order Detail  * 
     C                     EXSR SXCHRC
     C           KRSSW     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * CHG Shipping Event     CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0434  70       Item Code
     C                     MOVEL*BLANK    WN0435  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0436  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0437  70       Order Group Cod
     C                     MOVEL*BLANK    WN0438  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0439  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0440 112       Billing Detail
     C                     Z-ADD*ZERO     WN0441 112       Billing Detail
     C                     Z-ADD*ZERO     WN0442 112       Billing Detail
     C                     Z-ADD*ZERO     WN0443 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0444  1        Comment Print A
     C                     MOVEL*BLANK    WN0445  1        Comment Print I
     C                     MOVEL*BLANK    WN0446  1        Comment Print P
     C                     MOVEL*BLANK    WN0447  1        Comment Print S
     C                     Z-ADD*ZERO     WN0448 112       Extended Amount
     C                     Z-ADD*ZERO     WN0449  70       Market Pricing
     C                     MOVEL*BLANK    WN0450  3        Commodity Marke
     C                     MOVEL*BLANK    WN0451  3        Date Method Cod
     C                     MOVEL*BLANK    WN0452  3        Price Method Co
     C                     Z-ADD*ZERO     WN0453 114       Price Overage O
     C                     Z-ADD*ZERO     WN0454  70       Contract Number
     C                     MOVEL*BLANK    WN0455  1        Price Status
     C                     Z-ADD*ZERO     WN0456  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0457  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0458  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0459  1        Work Confirm St
     C                     MOVEL*BLANK    WN0460  1        Work Over/Short
     C                     MOVEL*BLANK    WN0461  1        OD Production P
     C                     MOVEL*BLANK    WN0462 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0463 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0464  1        Age Code
     C                     MOVEL*BLANK    WN0465  1        Palletize
     C                     MOVEL*BLANK    WN0466  1        Slip Sheet
     C                     MOVEL*BLANK    WN0467  1        Catch Weight St
     C                     MOVEL*BLANK    WN0468  1        Price Audit
     C                     MOVEL*BLANK    WN0469  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0470  1        Production Date
     C                     Z-ADD*ZERO     WN0471 112       Rated Freight
     C                     Z-ADD*ZERO     WN0472 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0473 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0474 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0475 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0476 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0477 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0478 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0479 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0480 114       Unit Price
     C                     Z-ADD*ZERO     WN0481 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0482 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0483 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0484 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0485  70       Requested Ship
     C                     Z-ADD*ZERO     WN0486  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0487  70       Actual Shipped
     C                     MOVEL*BLANK    WN0488  1        Affect Inventor
     C                     MOVEL*BLANK    WN0489  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0490  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0491  30       Item Structure
     C                     Z-ADD*ZERO     WN0492  30       Item Structure
     C                     Z-ADD*ZERO     WN0493  30       Item Structure
     C                     MOVEL*BLANK    WN0494  2        Item Level
     C                     MOVEL*BLANK    WN0495  2        Quality Level
     C                     MOVEL*BLANK    WN0496  2        Pricing Product
     C                     MOVEL*BLANK    WN0497  2        Season Product
     C                     Z-ADD*ZERO     WN0498  70       Date of Origina
     C                     MOVEL*BLANK    WN0499 10        User Profile Na
     C                     MOVEL*BLANK    WN0500  6        Country Code
     C                     MOVEL*BLANK    WN0501  3        Reason Code
     C                     MOVEL*BLANK    WN0502  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0503  1        Modified Flag
     C                     MOVEL*BLANK    WN0504  1        Substituted Fla
     C                     MOVEL*BLANK    WN0505  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0506 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0507 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0508  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0509  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0510  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0511  1        Affect Commissi
     C                     MOVEL*BLANK    WN0512  1        Affect Pricing
     C                     MOVEL*BLANK    WN0513  1        Released by Use
     C                     MOVEL*BLANK    WN0514  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0515  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0516  3        Production Ware
     C                     MOVEL*BLANK    WN0517  3        OD Price Type
     C                     Z-ADD*ZERO     WN0518  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0519  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0520  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0521  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0522  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0523  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0524  60       Price Code
     C                     Z-ADD*ZERO     WN0525  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0526  60       Substitution Li
     C                     Z-ADD*ZERO     WN0527  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0528 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0529 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0530 112       OD Item Target
     C                     Z-ADD*ZERO     WN0531 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0532 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0533 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0534 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0535 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0536 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0537 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0538 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0539 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0540 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0541  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0542  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0543  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0544 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0545  40       Item Age Days
     C                     Z-ADD*ZERO     WN0546  70       Production Ovr
     C                     Z-ADD*ZERO     WN0547  70       Production Ovr
     C                     MOVEL*BLANK    WN0548  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0549  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0550  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0551  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0552  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0553  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0554  1        EDI Status 1
     C                     MOVEL*BLANK    WN0555  1        EDI Status 2
     C                     MOVEL*BLANK    WN0556  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0557  60       Job Time
     C                     MOVEL*BLANK    WN0558 10        User Id
     C                     MOVEL*BLANK    WN0559 10        Job Name
     C                     Z-ADD*ZERO     WN0560  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWVAIC3    WWAIC3           Company Number
     C                     Z-ADDWVC4NB    WWC4NB           Order Number
     C                     Z-ADDWVDPNB    WWDPNB           Order Sequence
     C                     Z-ADDWVUENB    WWUENB           Order Secondary
      *
     C           KLCHSX    KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWC4NB           Order Number
     C                     KFLD           WWDPNB           Order Sequence
     C                     KFLD           WWUENB           Order Secondary
     C           KLCHSX    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YDRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0108    WWJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WWAATM           Job Time
     C                     MOVEL##USR     WWAYNA           User Id
     C                     MOVEL##JOB     WWA0NA           Job Name
     C                     Z-ADD##JDT     WWAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * CHG Ord Event & Stat.  CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0561  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0562  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0563  70       Ship To Custome
     C                     MOVEL*BLANK    WN0564 30        Ship To Name
     C                     MOVEL*BLANK    WN0565 30        Ship To Address
     C                     MOVEL*BLANK    WN0566 30        Ship To Address
     C                     MOVEL*BLANK    WN0567 30        Ship To Address
     C                     MOVEL*BLANK    WN0568 20        Ship To City
     C                     MOVEL*BLANK    WN0569  2        Ship To State C
     C                     MOVEL*BLANK    WN0570 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0571  70       Bill to Custome
     C                     MOVEL*BLANK    WN0572 30        Bill to Name
     C                     MOVEL*BLANK    WN0573 30        Bill to Address
     C                     MOVEL*BLANK    WN0574 30        Bill to Address
     C                     MOVEL*BLANK    WN0575 30        Bill to Address
     C                     MOVEL*BLANK    WN0576 20        Bill to City
     C                     MOVEL*BLANK    WN0577  2        Bill to State C
     C                     MOVEL*BLANK    WN0578 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0579 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0580  70       Order Date
     C                     Z-ADD*ZERO     WN0581  70       Requested Ship
     C                     Z-ADD*ZERO     WN0582  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0583  70       Cancel Date
     C                     MOVEL*BLANK    WN0584  2        Terms Code
     C                     MOVEL*BLANK    WN0585 40        Special Instruc
     C                     MOVEL*BLANK    WN0586 40        Special Instruc
     C                     MOVEL*BLANK    WN0587  3        Carrier Code
     C                     MOVEL*BLANK    WN0588  1        Comment Print A
     C                     MOVEL*BLANK    WN0589  1        Comment Print I
     C                     MOVEL*BLANK    WN0590  1        Comment Print P
     C                     MOVEL*BLANK    WN0591  1        Comment Print S
     C                     MOVEL*BLANK    WN0592  3        Reason Code
     C                     MOVEL*BLANK    WN0593  1        Order in Use
     C                     MOVEL*BLANK    WN0594  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0595  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0596 10        User Original E
     C                     Z-ADD*ZERO     WN0597  70       Date of Origina
     C                     Z-ADD*ZERO     WN0598 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0599 112       Order Weight To
     C                     MOVEL*BLANK    WN0600  1        Credit Hold
     C                     MOVEL*BLANK    WN0601  1        Production Hold
     C                     MOVEL*BLANK    WN0602  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0603  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0604  40       Requested Deliv
     C                     MOVEL*BLANK    WN0605  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0606 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0607  70       Load ID
     C                     Z-ADD*ZERO     WN0608  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0609 112       Rated Freight
     C                     MOVEL*BLANK    WN0610  1        LTL Flag
     C                     MOVEL*BLANK    WN0611  1        Price Audit
     C                     MOVEL*BLANK    WN0612  1        Price Status
     C                     MOVEL*BLANK    WN0613  2        Shipping Method
     C                     MOVEL*BLANK    WN0614  1        Export Status
     C                     MOVEL*BLANK    WN0615  1        Palletize
     C                     MOVEL*BLANK    WN0616  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0617  1        Slip Sheet
     C                     MOVEL*BLANK    WN0618  1        Age Code
     C                     Z-ADD*ZERO     WN0619  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0620  1        Load Type
     C                     Z-ADD*ZERO     WN0621  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0622  1        Load Plan Order
     C                     MOVEL*BLANK    WN0623  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0624  70       Resell Referenc
     C                     MOVEL*BLANK    WN0625 30        Special Comment
     C                     MOVEL*BLANK    WN0626 30        Special Comment
     C                     MOVEL*BLANK    WN0627  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0628  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0629  2        Manager Level C
     C                     MOVEL*BLANK    WN0630  3        VP Level Code
     C                     Z-ADD*ZERO     WN0631  70       Attach to Order
     C                     MOVEL*BLANK    WN0632  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0633  70       Invoice Number
     C                     MOVEL*BLANK    WN0634  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0635  70       Invoice Date
     C                     MOVEL*BLANK    WN0636  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0637  1        Modified Flag
     C                     Z-ADD*ZERO     WN0638 112       A/R order Value
     C                     MOVEL*BLANK    WN0639  1        Billing Activit
     C                     MOVEL*BLANK    WN0640  1        Block Order Fla
     C                     MOVEL*BLANK    WN0641  1        Order Certifica
     C                     Z-ADD*ZERO     WN0642 112       Invoice Order V
     C                     MOVEL*BLANK    WN0643  1        Process Sts for
     C                     MOVEL*BLANK    WN0644  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0645  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0646  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0647  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0648  1        Email Cust On O
     C                     MOVEL*BLANK    WN0649  1        Order Emailed
     C                     MOVEL*BLANK    WN0650  1        Export Docs Go
     C                     MOVEL*BLANK    WN0651  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0652  1        Broker Order St
     C                     MOVEL*BLANK    WN0653  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0654  2        Order Requires
     C                     MOVEL*BLANK    WN0655  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0656  2        Export USDA App
     C                     MOVEL*BLANK    WN0657  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0658  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0659  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0660  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0661  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0662  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0663  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0664  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0665  60       Time of Origina
     C                     Z-ADD*ZERO     WN0666  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0667  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0668  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0669 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0670 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0671 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0672 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0673 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0674  70       Claim Number
     C                     MOVEL*BLANK    WN0675  1        EDI Status 1
     C                     MOVEL*BLANK    WN0676  1        EDI Status 2
     C                     MOVEL*BLANK    WN0677  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0678  60       Job Time
     C                     MOVEL*BLANK    WN0679 10        User Id
     C                     MOVEL*BLANK    WN0680 10        Job Name
     C                     Z-ADD*ZERO     WN0681  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
      *
     C           KLCHSY    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHSY    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YERDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWBGWST    WCGWST    P      Header Status
     C                     MOVELWBGXST    WCGXST    P      Header Status L
     C                     MOVELWL0108    WCJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWCAIC3    PAAIC3           Company Number
     C                     Z-ADDWCC4NB    PAC4NB           Order Number
     C                     MOVELWCJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWCANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWCBKC7    PABKC7           Ship To Custome
     C                     MOVELWCBRTX    PABRTX    P      Ship To Name
     C                     MOVELWCHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWCHONA    PAHONA    P      Ship To Address
     C                     MOVELWCHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWCHNNA    PAHNNA    P      Ship To City
     C                     MOVELWCDBCD    PADBCD    P      Ship To State C
     C                     MOVELWCCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWCB0C7    PAB0C7           Bill to Custome
     C                     MOVELWCAETX    PAAETX    P      Bill to Name
     C                     MOVELWCB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWCB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWCB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWCB2NA    PAB2NA    P      Bill to City
     C                     MOVELWCBHCD    PABHCD    P      Bill to State C
     C                     MOVELWCC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWCBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWCA0DT    PAA0DT           Order Date
     C                     Z-ADDWCA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWCGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWCACDT    PAACDT           Cancel Date
     C                     MOVELWCAQCD    PAAQCD    P      Terms Code
     C                     MOVELWCB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWCBYNA    PABYNA    P      Special Instruc
     C                     MOVELWCBZNA    PABZNA    P      Carrier Code
     C                     MOVELWCGTST    PAGTST    P      Comment Print A
     C                     MOVELWCGVST    PAGVST    P      Comment Print I
     C                     MOVELWCGUST    PAGUST    P      Comment Print P
     C                     MOVELWCQFST    PAQFST    P      Comment Print S
     C                     MOVELWCCQCD    PACQCD    P      Reason Code
     C                     MOVELWCGJST    PAGJST    P      Order in Use
     C                     MOVELWCGWST    PAGWST    P      Header Status
     C                     MOVELWCGXST    PAGXST    P      Header Status L
     C                     MOVELWCGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWCAODT    PAAODT           Scheduled Ship
     C                     MOVELWCAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWCCXDT    PACXDT           Date of Origina
     C                     Z-ADDWCJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWCA1WG    PAA1WG           Order Weight To
     C                     MOVELWCXIST    PAXIST    P      Credit Hold
     C                     MOVELWCXJST    PAXJST    P      Production Hold
     C                     MOVELWCXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWCEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWCAFTM    PAAFTM           Requested Deliv
     C                     MOVELWCE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWCE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWCRMNB    PARMNB           Load ID
     C                     Z-ADDWCTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWCR1NB    PAR1NB           Rated Freight
     C                     MOVELWCPJST    PAPJST    P      LTL Flag
     C                     MOVELWCU0ST    PAU0ST    P      Price Audit
     C                     MOVELWCU1ST    PAU1ST    P      Price Status
     C                     MOVELWCQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWCU2ST    PAU2ST    P      Export Status
     C                     MOVELWCVEST    PAVEST    P      Palletize
     C                     MOVELWCVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWCVGST    PAVGST    P      Slip Sheet
     C                     MOVELWCRPCD    PARPCD    P      Age Code
     C                     Z-ADDWCRNNB    PARNNB           Reefer Temperat
     C                     MOVELWCVDST    PAVDST    P      Load Type
     C                     Z-ADDWCATIN    PAATIN           Attach to Invoi
     C                     MOVELWCU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWCU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWCRSRN    PARSRN           Resell Referenc
     C                     MOVELWCMHNA    PAMHNA    P      Special Comment
     C                     MOVELWCMINA    PAMINA    P      Special Comment
     C                     MOVELWCWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWCR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWCBFCD    PABFCD    P      Manager Level C
     C                     MOVELWCQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWCT3NB    PAT3NB           Attach to Order
     C                     MOVELWCSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWCCONB    PACONB           Invoice Number
     C                     MOVELWCCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWCAWDT    PAAWDT           Invoice Date
     C                     MOVELWCJPCD    PAJPCD    P      Event Code
     C                     MOVELWCXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWCZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWCVRVA    PAVRVA           A/R order Value
     C                     MOVELWCOBST    PAOBST    P      Billing Activit
     C                     MOVELWCBCST    PABCST    P      Block Order Fla
     C                     MOVELWCBDST    PABDST    P      Order Certifica
     C                     Z-ADDWCB7VL    PAB7VL           Invoice Order V
     C                     MOVELWCGASX    PAGASX    P      Process Sts for
     C                     MOVELWCGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWCGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWCGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWCFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWCFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWCFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWCFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWCFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWCFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWCFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWCFUSX    PAFUSX    P      Order Requires
     C                     MOVELWCFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWCFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWCFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWCFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWCNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWCNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWCNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWCNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWCNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWCBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWCBQTM    PABQTM           Time of Origina
     C                     Z-ADDWCBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWCBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWCBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWCH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWCH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWCH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWCH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWCH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWCC0C7    PAC0C7           Claim Number
     C                     MOVELWCUVST    PAUVST    P      EDI Status 1
     C                     MOVELWCUWST    PAUWST    P      EDI Status 2
     C                     MOVELWCUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWCAATM    PAAATM           Job Time
     C                     MOVELWCAYNA    PAAYNA    P      User Id
     C                     MOVELWCA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWCAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * SEL Invc to Print&Post RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1042  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN1043  70       Invoice Date
     C                     MOVEL*BLANK    WN1044  1        Order Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P3CNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQSZ01           Company Number
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSZ01           Company Number
      * Establish starting position
     C           KRSSZ     SETLL@BFCPL7                    *
     C           KRSSZ     READE@BFCPL7                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WUGYST           Order Type Prin
     C                     MOVEL'IN'      WN1042           Invoice Suffix
     C                     Z-ADD##JDT     WN1043           Invoice Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * ** If Billing Activity Type = 1 for Invoice
      * CASE: DB1.Billing Activity Type is Invoice
     C           WXOBST    IFEQ '1'                        *IF
      * Sel Customer Type     XF - Company Customer  * 
     C                     CALL 'PPUOXFR'              90  Sel Customer Ty
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0331  30       Company Number
     C                     PARM WXBKC7    WQ0332  70       Ship To Custome
     C           YL0069    PARM YL0069    WQ0333  2        Type Code
     C                     PARM P5YDSX    WQ0334  2        Process Cust Ty
     C           W0RSL     PARM W0RSL     WQ0335  1        *Record selecte
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPUOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Process selected Customer Type (Third Party or Inter-Company)
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * ** Process record for any possible errors. Flag the header with
      * ** the results so the print program knows whether or not to print
      * ** this invoice.
      * 05/01/18 DN R12926-Removed Absorbed Freight Rate CWT Parm on PPX8
      * PRT Invc Excpt Select  XF - Order Header TRG  * 
     C                     CALL 'PPX8XFR'              90  PRT Invc Excpt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0336  30       Company Number
     C                     PARM WXC4NB    WQ0337  70       Order Number
     C                     PARM WXJNCD    WQ0338  2        Order Type - Sa
     C                     PARM WXANC7    WQ0339  70       A/R Customer Nu
     C                     PARM WXBKC7    WQ0340  70       Ship To Custome
     C                     PARM WXBCNA    WQ0341 15        Customer Purcha
     C                     PARM WXA0DT    WQ0342  70       Order Date
     C                     PARM WXGNDT    WQ0343  70       Actual Shipped
     C                     PARM WXGWST    WQ0344  1        Header Status
     C                     PARM WXGXST    WQ0345  1        Header Status L
     C                     PARM WXAODT    WQ0346  70       Scheduled Ship
     C                     PARM WXRMNB    WQ0347  70       Load ID
     C                     PARM WXU0ST    WQ0348  1        Price Audit
     C                     PARM WXU1ST    WQ0349  1        Price Status
     C                     PARM WXQ2CD    WQ0350  2        Shipping Method
     C                     PARM WXR4CD    WQ0351  3        Sales Route Cod
     C                     PARM WXJPCD    WQ0352  2        Event Code
     C                     PARM WXOBST    WQ0353  1        Billing Activit
     C                     PARM P1C4NB    WQ0354  70       USR Order Numbe
     C                     PARM P1RMNB    WQ0355  70       Load ID USR
     C                     PARM '1'       WQ0356  1        USR Billing Act
     C                     PARM P1GNDT    WQ0357  70       USR Actual Ship
     C           YL0070    PARM YL0070    WQ0358  1        Update Exceptio
     C           W0RSL     PARM W0RSL     WQ0359  1        *Record selecte
     C           YL0071    PARM *BLANK    WQ0360  1        Print Pre-Inv/E
     C           YL0072    PARM *BLANK    WQ0361  1        Departure Sts U
     C           YL0073    PARM YL0073    WQ0362 155       System Value Nu
     C           YL0074    PARM YL0074    WQ0363  1        Manual Prc Err
     C           YL0075    PARM YL0075    WQ0364 114       Projected Marke
     C           YL0076    PARM YL0076    WQ0365  1        Average Ship Wg
     C           YL0077    PARM YL0077    WQ0366  1        InterCo Price E
     C           YL0078    PARM YL0078    WQ0367  1        Record Found US
     C           WN1044    PARM WN1044    WQ0368  1        Order Status
     C           YL0079    PARM YL0079    WQ0369  1        GTIN Error Sts
     C           YL0080    PARM YL0080    WQ0370  70       GTIN Error Item
     C                     PARM *ZERO     WQ0371  70       Item Code USR
     C                     PARM *ZERO     WQ0372  70       Item Code
     C           YL0081    PARM YL0081    WQ0373  3        Default Commod
     C           YL0082    PARM YL0082    WQ0374 114       Market Overage
     C           YL0083    PARM YL0083    WQ0375  7        Commodity Price
     C           YL0084    PARM *ZERO     WQ0376 114       Price Overage O
     C                     PARM P5YDSX    WQ0377  2        Process Cust Ty
     C           WUJDST    PARM WUJDST    WQ0378  1        USR Check Y/N S
     C           YL0085    PARM YL0085    WQ0379  1        D-EDI INV PROC
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPX8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * ** Upd hdr if rec is ready to inv(no exceptions) Or Not Ready
      * CASE: LCL.Print Pre-Inv/Exception is Print on Pre-Invoice Reg
     C           YL0071    IFEQ 'P'                        *IF
      * No Exception Print
     C                     MOVEL'Y'       WUGYST           Order Type Prin
      * CHG Ord Typ PrtSts     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0001           Company Number
     C                     Z-ADDWXC4NB    WL0002           Order Number
     C                     MOVELWUGYST    WL0003    P      Order Type Prin
     C                     EXSR SBRVGN
      * Combo PO Update the Order Type Print Status  Yes or No
     C                     EXSR UGSUBR                     Combo PO Update
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Update header if record has exceptions and Combo Po Update
      * CASE: LCL.Print Pre-Inv/Exception is Print on Exception
     C           YL0071    IFEQ 'E'                        *IF
     C                     MOVEL'N'       WUGYST           Order Type Prin
      * CHG Ord Typ PrtSts     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0001           Company Number
     C                     Z-ADDWXC4NB    WL0002           Order Number
     C                     MOVELWUGYST    WL0003    P      Order Type Prin
     C                     EXSR SBRVGN
      * Combo PO Update the Order Type Print Status  Yes or No
     C                     EXSR UHSUBR                     Combo PO Update
     C                     END                             *FI
     C                     END                             *FI
      * ** Process records that are flagged ready to invoice
      * CASE: WRK.Order Type Print Status is yes
     C           WUGYST    IFEQ 'Y'                        *IF
      * Order is priced
      * CASE: DB1.Price Status is Priced
     C           WXU1ST    IFEQ 'P'                        *IF
      * 09/18/07 PKD DLY029 Moved this here instead of the post. The
      *              Sales Tax and Discounts are needed for printing
      *              the Invoices.
      * 02/14/2014 LJB E002966 Delete the Trailer from the Trailer File
      *              after the Invoice has printed
      * Process Auto Accruals
      * CASE: DB1.Affect Auto Accruals is Affect Auto Accruals
     C           WXWBST    IFEQ 'Y'                        *IF
      * E4057 JJH 04/27/15 - Pass in new parm: Attach to Order Number
      * UPD Auto Accruals      XF - Order Detail  * 
     C                     CALL 'PDT5XFR'              90  UPD Auto Accrua
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0392  30       Company Number
     C                     PARM WXC4NB    WQ0393  70       Order Number
     C                     PARM WXANC7    WQ0394  70       A/R Customer Nu
     C                     PARM WXCXDT    WQ0395  70       Date of Origina
     C                     PARM WXRMNB    WQ0396  70       Load ID
     C                     PARM WXTBNB    WQ0397  52       Absorbed Freigh
     C                     PARM WXT3NB    WQ0398  70       Attach to Order
     C                     PARM WXAWDT    WQ0399  70       Invoice Date
     C                     PARM WXOBST    WQ0400  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDT5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Print all invoices
      * CASE: Select all invoices
      *  - c1 AND c2 ANDc3
      *   |- c1    : PAR.Order Number is Equal to zeros
      *   |- c2    : PAR.Actual Shipped Date is not entered
      *   |- c3    : PAR.Load ID is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1C4NB    IFEQ 0                          *IF
     C           P1GNDT    IFEQ 0                          *IF
     C           P1RMNB    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN1045  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1046  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1047  70       Parent Customer
     C                     MOVEL*BLANK    WN1048 30        Ship To Name
     C                     MOVEL*BLANK    WN1049 30        Ship To Address
     C                     MOVEL*BLANK    WN1050 30        Ship To Address
     C                     MOVEL*BLANK    WN1051 30        Ship To Address
     C                     MOVEL*BLANK    WN1052 20        Ship To City
     C                     MOVEL*BLANK    WN1053  2        Ship To State C
     C                     MOVEL*BLANK    WN1054 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1055  70       Bill to Custome
     C                     MOVEL*BLANK    WN1056 30        Bill to Name
     C                     MOVEL*BLANK    WN1057 30        Bill to Address
     C                     MOVEL*BLANK    WN1058 30        Bill to Address
     C                     MOVEL*BLANK    WN1059 30        Bill to Address
     C                     MOVEL*BLANK    WN1060 20        Bill to City
     C                     MOVEL*BLANK    WN1061  2        Bill to State C
     C                     MOVEL*BLANK    WN1062 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1063 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1064  70       Order Date
     C                     Z-ADD*ZERO     WN1065  70       Requested Ship
     C                     Z-ADD*ZERO     WN1066  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1067  70       Cancel Date
     C                     MOVEL*BLANK    WN1068  2        Terms Code
     C                     MOVEL*BLANK    WN1069 40        Special Instruc
     C                     MOVEL*BLANK    WN1070 40        Special Instruc
     C                     MOVEL*BLANK    WN1071  3        Carrier Code
     C                     MOVEL*BLANK    WN1072  1        Comment Print A
     C                     MOVEL*BLANK    WN1073  1        Comment Print I
     C                     MOVEL*BLANK    WN1074  1        Comment Print P
     C                     MOVEL*BLANK    WN1075  1        Comment Print S
     C                     MOVEL*BLANK    WN1076  3        Reason Code
     C                     MOVEL*BLANK    WN1077  1        Order in Use
     C                     MOVEL*BLANK    WN1078  1        Header Status
     C                     MOVEL*BLANK    WN1079  1        Header Status L
     C                     MOVEL*BLANK    WN1080  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1081  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1082 10        User Original E
     C                     Z-ADD*ZERO     WN1083  70       Date of Origina
     C                     Z-ADD*ZERO     WN1084 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1085 112       Order Weight To
     C                     MOVEL*BLANK    WN1086  1        Credit Hold
     C                     MOVEL*BLANK    WN1087  1        Production Hold
     C                     MOVEL*BLANK    WN1088  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1089  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1090  40       Requested Deliv
     C                     MOVEL*BLANK    WN1091  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1092 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1093  70       Load ID
     C                     Z-ADD*ZERO     WN1094  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN1095 112       Rated Freight
     C                     MOVEL*BLANK    WN1096  1        LTL Flag
     C                     MOVEL*BLANK    WN1097  1        Price Audit
     C                     MOVEL*BLANK    WN1098  1        Price Status
     C                     MOVEL*BLANK    WN1099  2        Shipping Method
     C                     MOVEL*BLANK    WN1100  1        Export Status
     C                     MOVEL*BLANK    WN1101  1        Palletize
     C                     MOVEL*BLANK    WN1102  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1103  1        Slip Sheet
     C                     MOVEL*BLANK    WN1104  1        Age Code
     C                     Z-ADD*ZERO     WN1105  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1106  1        Load Type
     C                     Z-ADD*ZERO     WN1107  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1108  1        Load Plan Order
     C                     MOVEL*BLANK    WN1109  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1110  70       Resell Referenc
     C                     MOVEL*BLANK    WN1111 30        Special Comment
     C                     MOVEL*BLANK    WN1112 30        Special Comment
     C                     MOVEL*BLANK    WN1113  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1114  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1115  2        Manager Level C
     C                     MOVEL*BLANK    WN1116  3        VP Level Code
     C                     Z-ADD*ZERO     WN1117  70       Attach to Order
     C                     MOVEL*BLANK    WN1118  3        Reason for Pric
     C                     MOVEL*BLANK    WN1119  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1120  1        Modified Flag
     C                     Z-ADD*ZERO     WN1121 112       A/R order Value
     C                     MOVEL*BLANK    WN1122  1        Billing Activit
     C                     MOVEL*BLANK    WN1123  1        Block Order Fla
     C                     MOVEL*BLANK    WN1124  1        Order Certifica
     C                     Z-ADD*ZERO     WN1125 112       Invoice Order V
     C                     MOVEL*BLANK    WN1126  1        Process Sts for
     C                     MOVEL*BLANK    WN1127  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1128  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1129  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1130  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1131  1        Email Cust On O
     C                     MOVEL*BLANK    WN1132  1        Order Emailed
     C                     MOVEL*BLANK    WN1133  1        Export Docs Go
     C                     MOVEL*BLANK    WN1134  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1135  1        Broker Order St
     C                     MOVEL*BLANK    WN1136  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1137  2        Order Requires
     C                     MOVEL*BLANK    WN1138  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1139  2        Export USDA App
     C                     MOVEL*BLANK    WN1140  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1141  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1142  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1143  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1144  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1145  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1146  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1147  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1148  60       Time of Origina
     C                     Z-ADD*ZERO     WN1149  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1150  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1151  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1152 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1153 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1154 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1155 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1156 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1157  70       Claim Number
     C                     MOVEL*BLANK    WN1158  1        EDI Status 1
     C                     MOVEL*BLANK    WN1159  1        EDI Status 2
     C                     MOVEL*BLANK    WN1160  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1161  60       Job Time
     C                     MOVEL*BLANK    WN1162 10        User Id
     C                     MOVEL*BLANK    WN1163 10        Job Name
     C                     Z-ADD*ZERO     WN1164  70       Job Date
      *
      * SEL Process Prt Invc   IF
      * 2/18/05 PKD use company number 000
      * UPD Next Invoice Nbr   RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD*ZERO     WL0004           Company Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P1CONB           Next Invoice Nu
      * CHG Invoice #, Date    CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0006           Company Number
     C                     Z-ADDWXC4NB    WL0007           Order Number
     C                     Z-ADDP1CONB    WL0008           Invoice Number
     C                     MOVELWN1042    WL0009    P      Invoice Suffix
     C                     Z-ADDWN1043    WL0010           Invoice Date
     C                     EXSR SFCHRC
      * *----------------------------------------------------------------
      * P000198
      * Retrieve Order information for creating Inv List Work & Combine I
     C                     EXSR UISUBR                     Retrieve Order
      * *----------------------------------------------------------------
     C                     MOVEL##JOB     YL0058           Job Name CDE
     C                     MOVEL##JNO     YL0059           Job Number Cde
      * Create WF Inv/Memo Combo for combine invoices
      * Print Invoice & crt WF Invoice List Work
      * CASE: LCL.Print Invoice Sts is no
     C           YL0055    IFEQ 'N'                        *IF
      * *** Print = N --> Crt Invoice List Work
      * ** Set fax invoice flag to Yes for fax/email program  P000198
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWXC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWXAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN1042    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0402 10        Job Name CDE
     C                     PARM YL0059    WQ0403 10        Job Number Cde
     C                     PARM WXC4NB    WQ0404  70       Order Number
     C                     PARM WXAIC3    WQ0405  30       Company Number
     C           YL0056    PARM *BLANK    WQ0406  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/06/2006 slm -- Do not print the org inv routine
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWXC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWXAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN1042    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0407 10        Job Name CDE
     C                     PARM YL0059    WQ0408 10        Job Number Cde
     C                     PARM WXC4NB    WQ0409  70       Order Number
     C                     PARM WXAIC3    WQ0410  30       Company Number
     C           YL0056    PARM *BLANK    WQ0411  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Print=Y --> Print Invoice. Print will create Invoice List Wor
      * If custom program then print the invoice custom program
      * Department is INCST1
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0412  30       Company Number
     C                     PARM 'IN'      WQ0413  2        CDD Type
     C                     PARM 'INCST1'  WQ0414  6        CDD Department
     C                     PARM *BLANK    WQ0415  8        CDD Name of Ove
     C           YL0063    PARM *BLANK    WQ0416 10        CDD Program Nam
     C                     PARM *BLANK    WQ0417 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0418 10        CDD Additional
     C                     PARM *BLANK    WQ0419 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0420 25        CDD Sender Fax
     C           YL0064    PARM *BLANK    WQ0421 10        Output Queue
     C           YL0065    PARM *BLANK    WQ0422  4        Hold File
     C           YL0066    PARM *BLANK    WQ0423  4        Save File
     C           YL0067    PARM *ZERO     WQ0424  30       Source Drawer
     C                     PARM *BLANK    WQ0425 10        Printer Device
     C                     PARM *ZERO     WQ0426  30       Page Length 2
     C                     PARM *ZERO     WQ0427  30       Page Width 2
     C                     PARM *ZERO     WQ0428  30       Page LPI
     C                     PARM *ZERO     WQ0429  31       Page CPI
     C                     PARM *ZERO     WQ0430  30       Page Overflow
     C                     PARM *BLANK    WQ0431  5        Page Rotation
     C                     PARM *BLANK    WQ0432 50        CDD Comment 1
     C                     PARM *BLANK    WQ0433 50        CDD Comment 2
     C                     PARM *BLANK    WQ0434 50        CDD Comment 3
     C                     PARM *BLANK    WQ0435 50        CDD Comment 4
     C                     PARM *BLANK    WQ0436 50        CDD Comment 5
     C                     PARM *BLANK    WQ0437  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Invoice
      * CASE: LCL.CDD Program Name is Not entered
     C           YL0063    IFEQ *BLANK                     *IF
      * PRT Inv/Memo 8LPI      PF - Order Header TRG  * 
     C                     CALL 'PDR4PFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0438  30       Company Number
     C                     PARM WXC4NB    WQ0439  70       Order Number
     C                     PARM 'N'       WQ0440  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR4PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * If Daily's or HPB
      * CASE: LCL.Company Organization is Daily's
     C           YL0057    IFEQ 'D'                        *IF
      * This will be called three times Customer/Org/Office
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0441  30       Company Number
     C                     PARM WXC4NB    WQ0442  70       Order Number
     C                     PARM 'N'       WQ0443  1        Printed Status
     C                     PARM 'CS'      WQ0444  2        @Invoice Type
     C                     PARM YL0058    WQ0445 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0446  30       Company Number
     C                     PARM WXC4NB    WQ0447  70       Order Number
     C                     PARM 'N'       WQ0448  1        Printed Status
     C                     PARM 'OF'      WQ0449  2        @Invoice Type
     C                     PARM YL0058    WQ0450 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0451  30       Company Number
     C                     PARM WXC4NB    WQ0452  70       Order Number
     C                     PARM 'N'       WQ0453  1        Printed Status
     C                     PARM 'OR'      WQ0454  2        @Invoice Type
     C                     PARM YL0058    WQ0455 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0057    IFEQ 'H'                        *IF
      * FP1110 7/21/08 RMC - Print HPB BOL if COA Batch# is on the Order
     C                     Z-ADD*ZERO     YL0068           HPB COA Batch N
      * VAL OHE exsts for HPB RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0081           Company Number
     C                     Z-ADDWXC4NB    WL0082           Order Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0083    YL0068           HPB COA Batch N
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.HPB COA Batch Number is Entered
      *   |- c2    : LCL.Load ID is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0068    IFGT 0                          *IF
     C           YL0048    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PRT Bill of Lading-HPB PF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDYL0048    PCRMNB           Load ID
      *
     C                     CALL 'PMO7PFR'              90  PRT Bill of Lad
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C                     PARM WXAIC3    WQ0456  30       Company Number
     C                     PARM WN1100    WQ0457  1        Export Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMO7PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * PRT Inv/Memo 8LPI HPB  PF - Order Header TRG  * 
     C                     CALL 'PMRCPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0458  30       Company Number
     C                     PARM WXC4NB    WQ0459  70       Order Number
     C                     PARM 'N'       WQ0460  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------------
      * CRT Invoice Events     RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0084           Company Number
     C                     Z-ADDWXC4NB    WL0085           Order Number
     C                     MOVEL'06'      WL0086    P      Event Code
     C                     Z-ADDWXAIC3    WL0087           Invoice/Memo Co
     C                     Z-ADDP1CONB    WL0088           Invoice/Memo Nu
     C                     MOVELWN1042    WL0089    P      Invoice/Memo Su
     C                     Z-ADDWXANC7    WL0090           Ship To Custome
     C                     EXSR SSRVGN
      * UPD Event: Hdr,O/S Dtl RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0106           Company Number
     C                     Z-ADDWXC4NB    WL0107           Order Number
     C                     MOVEL'06'      WL0108    P      Event Code
     C                     EXSR SVRVGN
     C                     ADD  1         P3CNTU           Count USR
     C                     END                             *FI
      * Print Invoice for order on the selected load
      * CASE: Load ID Selected
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Load ID is NE Blank
      *   |- c2    : DB1.Load ID EQ PAR.Load ID
      *   |- c3    : DB1.Actual Shipped Date is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1RMNB    IFNE 0                          *IF
     C           WXRMNB    IFEQ P1RMNB                     *IF
     C           WXGNDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN1165  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1166  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1167  70       Parent Customer
     C                     MOVEL*BLANK    WN1168 30        Ship To Name
     C                     MOVEL*BLANK    WN1169 30        Ship To Address
     C                     MOVEL*BLANK    WN1170 30        Ship To Address
     C                     MOVEL*BLANK    WN1171 30        Ship To Address
     C                     MOVEL*BLANK    WN1172 20        Ship To City
     C                     MOVEL*BLANK    WN1173  2        Ship To State C
     C                     MOVEL*BLANK    WN1174 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1175  70       Bill to Custome
     C                     MOVEL*BLANK    WN1176 30        Bill to Name
     C                     MOVEL*BLANK    WN1177 30        Bill to Address
     C                     MOVEL*BLANK    WN1178 30        Bill to Address
     C                     MOVEL*BLANK    WN1179 30        Bill to Address
     C                     MOVEL*BLANK    WN1180 20        Bill to City
     C                     MOVEL*BLANK    WN1181  2        Bill to State C
     C                     MOVEL*BLANK    WN1182 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1183 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1184  70       Order Date
     C                     Z-ADD*ZERO     WN1185  70       Requested Ship
     C                     Z-ADD*ZERO     WN1186  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1187  70       Cancel Date
     C                     MOVEL*BLANK    WN1188  2        Terms Code
     C                     MOVEL*BLANK    WN1189 40        Special Instruc
     C                     MOVEL*BLANK    WN1190 40        Special Instruc
     C                     MOVEL*BLANK    WN1191  3        Carrier Code
     C                     MOVEL*BLANK    WN1192  1        Comment Print A
     C                     MOVEL*BLANK    WN1193  1        Comment Print I
     C                     MOVEL*BLANK    WN1194  1        Comment Print P
     C                     MOVEL*BLANK    WN1195  1        Comment Print S
     C                     MOVEL*BLANK    WN1196  3        Reason Code
     C                     MOVEL*BLANK    WN1197  1        Order in Use
     C                     MOVEL*BLANK    WN1198  1        Header Status
     C                     MOVEL*BLANK    WN1199  1        Header Status L
     C                     MOVEL*BLANK    WN1200  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1201  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1202 10        User Original E
     C                     Z-ADD*ZERO     WN1203  70       Date of Origina
     C                     Z-ADD*ZERO     WN1204 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1205 112       Order Weight To
     C                     MOVEL*BLANK    WN1206  1        Credit Hold
     C                     MOVEL*BLANK    WN1207  1        Production Hold
     C                     MOVEL*BLANK    WN1208  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1209  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1210  40       Requested Deliv
     C                     MOVEL*BLANK    WN1211  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1212 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1213  70       Load ID
     C                     Z-ADD*ZERO     WN1214  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN1215 112       Rated Freight
     C                     MOVEL*BLANK    WN1216  1        LTL Flag
     C                     MOVEL*BLANK    WN1217  1        Price Audit
     C                     MOVEL*BLANK    WN1218  1        Price Status
     C                     MOVEL*BLANK    WN1219  2        Shipping Method
     C                     MOVEL*BLANK    WN1220  1        Export Status
     C                     MOVEL*BLANK    WN1221  1        Palletize
     C                     MOVEL*BLANK    WN1222  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1223  1        Slip Sheet
     C                     MOVEL*BLANK    WN1224  1        Age Code
     C                     Z-ADD*ZERO     WN1225  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1226  1        Load Type
     C                     Z-ADD*ZERO     WN1227  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1228  1        Load Plan Order
     C                     MOVEL*BLANK    WN1229  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1230  70       Resell Referenc
     C                     MOVEL*BLANK    WN1231 30        Special Comment
     C                     MOVEL*BLANK    WN1232 30        Special Comment
     C                     MOVEL*BLANK    WN1233  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1234  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1235  2        Manager Level C
     C                     MOVEL*BLANK    WN1236  3        VP Level Code
     C                     Z-ADD*ZERO     WN1237  70       Attach to Order
     C                     MOVEL*BLANK    WN1238  3        Reason for Pric
     C                     MOVEL*BLANK    WN1239  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1240  1        Modified Flag
     C                     Z-ADD*ZERO     WN1241 112       A/R order Value
     C                     MOVEL*BLANK    WN1242  1        Billing Activit
     C                     MOVEL*BLANK    WN1243  1        Block Order Fla
     C                     MOVEL*BLANK    WN1244  1        Order Certifica
     C                     Z-ADD*ZERO     WN1245 112       Invoice Order V
     C                     MOVEL*BLANK    WN1246  1        Process Sts for
     C                     MOVEL*BLANK    WN1247  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1248  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1249  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1250  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1251  1        Email Cust On O
     C                     MOVEL*BLANK    WN1252  1        Order Emailed
     C                     MOVEL*BLANK    WN1253  1        Export Docs Go
     C                     MOVEL*BLANK    WN1254  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1255  1        Broker Order St
     C                     MOVEL*BLANK    WN1256  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1257  2        Order Requires
     C                     MOVEL*BLANK    WN1258  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1259  2        Export USDA App
     C                     MOVEL*BLANK    WN1260  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1261  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1262  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1263  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1264  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1265  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1266  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1267  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1268  60       Time of Origina
     C                     Z-ADD*ZERO     WN1269  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1270  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1271  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1272 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1273 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1274 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1275 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1276 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1277  70       Claim Number
     C                     MOVEL*BLANK    WN1278  1        EDI Status 1
     C                     MOVEL*BLANK    WN1279  1        EDI Status 2
     C                     MOVEL*BLANK    WN1280  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1281  60       Job Time
     C                     MOVEL*BLANK    WN1282 10        User Id
     C                     MOVEL*BLANK    WN1283 10        Job Name
     C                     Z-ADD*ZERO     WN1284  70       Job Date
      *
      * SEL Process Prt Invc   IF
      * 2/18/05 PKD use company number 000
      * UPD Next Invoice Nbr   RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD*ZERO     WL0004           Company Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P1CONB           Next Invoice Nu
      * CHG Invoice #, Date    CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0006           Company Number
     C                     Z-ADDWXC4NB    WL0007           Order Number
     C                     Z-ADDP1CONB    WL0008           Invoice Number
     C                     MOVELWN1042    WL0009    P      Invoice Suffix
     C                     Z-ADDWN1043    WL0010           Invoice Date
     C                     EXSR SFCHRC
      * *----------------------------------------------------------------
      * P000198
      * Retrieve Order information for creating Inv List Work & Combine I
     C                     EXSR UJSUBR                     Retrieve Order
      * *----------------------------------------------------------------
     C                     MOVEL##JOB     YL0058           Job Name CDE
     C                     MOVEL##JNO     YL0059           Job Number Cde
      * Create WF Inv/Memo Combo for combine invoices
      * Print Invoice & crt WF Invoice List Work
      * CASE: LCL.Print Invoice Sts is no
     C           YL0055    IFEQ 'N'                        *IF
      * *** Print = N --> Crt Invoice List Work
      * ** Set fax invoice flag to Yes for fax/email program  P000198
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWXC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWXAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN1042    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0462 10        Job Name CDE
     C                     PARM YL0059    WQ0463 10        Job Number Cde
     C                     PARM WXC4NB    WQ0464  70       Order Number
     C                     PARM WXAIC3    WQ0465  30       Company Number
     C           YL0056    PARM *BLANK    WQ0466  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/06/2006 slm -- Do not print the org inv routine
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWXC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWXAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN1042    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0467 10        Job Name CDE
     C                     PARM YL0059    WQ0468 10        Job Number Cde
     C                     PARM WXC4NB    WQ0469  70       Order Number
     C                     PARM WXAIC3    WQ0470  30       Company Number
     C           YL0056    PARM *BLANK    WQ0471  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Print=Y --> Print Invoice. Print will create Invoice List Wor
      * If custom program then print the invoice custom program
      * Department is INCST1
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0472  30       Company Number
     C                     PARM 'IN'      WQ0473  2        CDD Type
     C                     PARM 'INCST1'  WQ0474  6        CDD Department
     C                     PARM *BLANK    WQ0475  8        CDD Name of Ove
     C           YL0063    PARM *BLANK    WQ0476 10        CDD Program Nam
     C                     PARM *BLANK    WQ0477 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0478 10        CDD Additional
     C                     PARM *BLANK    WQ0479 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0480 25        CDD Sender Fax
     C           YL0064    PARM *BLANK    WQ0481 10        Output Queue
     C           YL0065    PARM *BLANK    WQ0482  4        Hold File
     C           YL0066    PARM *BLANK    WQ0483  4        Save File
     C           YL0067    PARM *ZERO     WQ0484  30       Source Drawer
     C                     PARM *BLANK    WQ0485 10        Printer Device
     C                     PARM *ZERO     WQ0486  30       Page Length 2
     C                     PARM *ZERO     WQ0487  30       Page Width 2
     C                     PARM *ZERO     WQ0488  30       Page LPI
     C                     PARM *ZERO     WQ0489  31       Page CPI
     C                     PARM *ZERO     WQ0490  30       Page Overflow
     C                     PARM *BLANK    WQ0491  5        Page Rotation
     C                     PARM *BLANK    WQ0492 50        CDD Comment 1
     C                     PARM *BLANK    WQ0493 50        CDD Comment 2
     C                     PARM *BLANK    WQ0494 50        CDD Comment 3
     C                     PARM *BLANK    WQ0495 50        CDD Comment 4
     C                     PARM *BLANK    WQ0496 50        CDD Comment 5
     C                     PARM *BLANK    WQ0497  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Invoice
      * CASE: LCL.CDD Program Name is Not entered
     C           YL0063    IFEQ *BLANK                     *IF
      * PRT Inv/Memo 8LPI      PF - Order Header TRG  * 
     C                     CALL 'PDR4PFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0498  30       Company Number
     C                     PARM WXC4NB    WQ0499  70       Order Number
     C                     PARM 'N'       WQ0500  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR4PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * If Daily's or HPB
      * CASE: LCL.Company Organization is Daily's
     C           YL0057    IFEQ 'D'                        *IF
      * This will be called three times Customer/Org/Office
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0501  30       Company Number
     C                     PARM WXC4NB    WQ0502  70       Order Number
     C                     PARM 'N'       WQ0503  1        Printed Status
     C                     PARM 'CS'      WQ0504  2        @Invoice Type
     C                     PARM YL0058    WQ0505 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0506  30       Company Number
     C                     PARM WXC4NB    WQ0507  70       Order Number
     C                     PARM 'N'       WQ0508  1        Printed Status
     C                     PARM 'OF'      WQ0509  2        @Invoice Type
     C                     PARM YL0058    WQ0510 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0511  30       Company Number
     C                     PARM WXC4NB    WQ0512  70       Order Number
     C                     PARM 'N'       WQ0513  1        Printed Status
     C                     PARM 'OR'      WQ0514  2        @Invoice Type
     C                     PARM YL0058    WQ0515 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0057    IFEQ 'H'                        *IF
      * FP1110 7/21/08 RMC - Print HPB BOL if COA Batch# is on the Order
     C                     Z-ADD*ZERO     YL0068           HPB COA Batch N
      * VAL OHE exsts for HPB RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0081           Company Number
     C                     Z-ADDWXC4NB    WL0082           Order Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0083    YL0068           HPB COA Batch N
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.HPB COA Batch Number is Entered
      *   |- c2    : LCL.Load ID is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0068    IFGT 0                          *IF
     C           YL0048    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PRT Bill of Lading-HPB PF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDYL0048    PCRMNB           Load ID
      *
     C                     CALL 'PMO7PFR'              90  PRT Bill of Lad
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C                     PARM WXAIC3    WQ0516  30       Company Number
     C                     PARM WN1220    WQ0517  1        Export Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMO7PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * PRT Inv/Memo 8LPI HPB  PF - Order Header TRG  * 
     C                     CALL 'PMRCPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0518  30       Company Number
     C                     PARM WXC4NB    WQ0519  70       Order Number
     C                     PARM 'N'       WQ0520  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------------
      * CRT Invoice Events     RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0084           Company Number
     C                     Z-ADDWXC4NB    WL0085           Order Number
     C                     MOVEL'06'      WL0086    P      Event Code
     C                     Z-ADDWXAIC3    WL0087           Invoice/Memo Co
     C                     Z-ADDP1CONB    WL0088           Invoice/Memo Nu
     C                     MOVELWN1042    WL0089    P      Invoice/Memo Su
     C                     Z-ADDWXANC7    WL0090           Ship To Custome
     C                     EXSR SSRVGN
      * UPD Event: Hdr,O/S Dtl RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0106           Company Number
     C                     Z-ADDWXC4NB    WL0107           Order Number
     C                     MOVEL'06'      WL0108    P      Event Code
     C                     EXSR SVRVGN
     C                     ADD  1         P3CNTU           Count USR
     C                     END                             *FI
      * Print Invoice for order selected
      * CASE: Order Selected
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Order Number is Not equal to zeros
      *   |- c2    : DB1.Order Number EQ PAR.Order Number
      *   |- c3    : DB1.Actual Shipped Date is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1C4NB    IFNE 0                          *IF
     C           WXC4NB    IFEQ P1C4NB                     *IF
     C           WXGNDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN1285  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1286  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1287  70       Parent Customer
     C                     MOVEL*BLANK    WN1288 30        Ship To Name
     C                     MOVEL*BLANK    WN1289 30        Ship To Address
     C                     MOVEL*BLANK    WN1290 30        Ship To Address
     C                     MOVEL*BLANK    WN1291 30        Ship To Address
     C                     MOVEL*BLANK    WN1292 20        Ship To City
     C                     MOVEL*BLANK    WN1293  2        Ship To State C
     C                     MOVEL*BLANK    WN1294 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1295  70       Bill to Custome
     C                     MOVEL*BLANK    WN1296 30        Bill to Name
     C                     MOVEL*BLANK    WN1297 30        Bill to Address
     C                     MOVEL*BLANK    WN1298 30        Bill to Address
     C                     MOVEL*BLANK    WN1299 30        Bill to Address
     C                     MOVEL*BLANK    WN1300 20        Bill to City
     C                     MOVEL*BLANK    WN1301  2        Bill to State C
     C                     MOVEL*BLANK    WN1302 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1303 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1304  70       Order Date
     C                     Z-ADD*ZERO     WN1305  70       Requested Ship
     C                     Z-ADD*ZERO     WN1306  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1307  70       Cancel Date
     C                     MOVEL*BLANK    WN1308  2        Terms Code
     C                     MOVEL*BLANK    WN1309 40        Special Instruc
     C                     MOVEL*BLANK    WN1310 40        Special Instruc
     C                     MOVEL*BLANK    WN1311  3        Carrier Code
     C                     MOVEL*BLANK    WN1312  1        Comment Print A
     C                     MOVEL*BLANK    WN1313  1        Comment Print I
     C                     MOVEL*BLANK    WN1314  1        Comment Print P
     C                     MOVEL*BLANK    WN1315  1        Comment Print S
     C                     MOVEL*BLANK    WN1316  3        Reason Code
     C                     MOVEL*BLANK    WN1317  1        Order in Use
     C                     MOVEL*BLANK    WN1318  1        Header Status
     C                     MOVEL*BLANK    WN1319  1        Header Status L
     C                     MOVEL*BLANK    WN1320  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1321  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1322 10        User Original E
     C                     Z-ADD*ZERO     WN1323  70       Date of Origina
     C                     Z-ADD*ZERO     WN1324 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1325 112       Order Weight To
     C                     MOVEL*BLANK    WN1326  1        Credit Hold
     C                     MOVEL*BLANK    WN1327  1        Production Hold
     C                     MOVEL*BLANK    WN1328  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1329  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1330  40       Requested Deliv
     C                     MOVEL*BLANK    WN1331  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1332 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1333  70       Load ID
     C                     Z-ADD*ZERO     WN1334  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN1335 112       Rated Freight
     C                     MOVEL*BLANK    WN1336  1        LTL Flag
     C                     MOVEL*BLANK    WN1337  1        Price Audit
     C                     MOVEL*BLANK    WN1338  1        Price Status
     C                     MOVEL*BLANK    WN1339  2        Shipping Method
     C                     MOVEL*BLANK    WN1340  1        Export Status
     C                     MOVEL*BLANK    WN1341  1        Palletize
     C                     MOVEL*BLANK    WN1342  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1343  1        Slip Sheet
     C                     MOVEL*BLANK    WN1344  1        Age Code
     C                     Z-ADD*ZERO     WN1345  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1346  1        Load Type
     C                     Z-ADD*ZERO     WN1347  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1348  1        Load Plan Order
     C                     MOVEL*BLANK    WN1349  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1350  70       Resell Referenc
     C                     MOVEL*BLANK    WN1351 30        Special Comment
     C                     MOVEL*BLANK    WN1352 30        Special Comment
     C                     MOVEL*BLANK    WN1353  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1354  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1355  2        Manager Level C
     C                     MOVEL*BLANK    WN1356  3        VP Level Code
     C                     Z-ADD*ZERO     WN1357  70       Attach to Order
     C                     MOVEL*BLANK    WN1358  3        Reason for Pric
     C                     MOVEL*BLANK    WN1359  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1360  1        Modified Flag
     C                     Z-ADD*ZERO     WN1361 112       A/R order Value
     C                     MOVEL*BLANK    WN1362  1        Billing Activit
     C                     MOVEL*BLANK    WN1363  1        Block Order Fla
     C                     MOVEL*BLANK    WN1364  1        Order Certifica
     C                     Z-ADD*ZERO     WN1365 112       Invoice Order V
     C                     MOVEL*BLANK    WN1366  1        Process Sts for
     C                     MOVEL*BLANK    WN1367  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1368  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1369  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1370  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1371  1        Email Cust On O
     C                     MOVEL*BLANK    WN1372  1        Order Emailed
     C                     MOVEL*BLANK    WN1373  1        Export Docs Go
     C                     MOVEL*BLANK    WN1374  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1375  1        Broker Order St
     C                     MOVEL*BLANK    WN1376  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1377  2        Order Requires
     C                     MOVEL*BLANK    WN1378  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1379  2        Export USDA App
     C                     MOVEL*BLANK    WN1380  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1381  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1382  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1383  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1384  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1385  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1386  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1387  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1388  60       Time of Origina
     C                     Z-ADD*ZERO     WN1389  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1390  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1391  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1392 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1393 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1394 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1395 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1396 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1397  70       Claim Number
     C                     MOVEL*BLANK    WN1398  1        EDI Status 1
     C                     MOVEL*BLANK    WN1399  1        EDI Status 2
     C                     MOVEL*BLANK    WN1400  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1401  60       Job Time
     C                     MOVEL*BLANK    WN1402 10        User Id
     C                     MOVEL*BLANK    WN1403 10        Job Name
     C                     Z-ADD*ZERO     WN1404  70       Job Date
      *
      * SEL Process Prt Invc   IF
      * 2/18/05 PKD use company number 000
      * UPD Next Invoice Nbr   RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD*ZERO     WL0004           Company Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P1CONB           Next Invoice Nu
      * CHG Invoice #, Date    CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0006           Company Number
     C                     Z-ADDWXC4NB    WL0007           Order Number
     C                     Z-ADDP1CONB    WL0008           Invoice Number
     C                     MOVELWN1042    WL0009    P      Invoice Suffix
     C                     Z-ADDWN1043    WL0010           Invoice Date
     C                     EXSR SFCHRC
      * *----------------------------------------------------------------
      * P000198
      * Retrieve Order information for creating Inv List Work & Combine I
     C                     EXSR UKSUBR                     Retrieve Order
      * *----------------------------------------------------------------
     C                     MOVEL##JOB     YL0058           Job Name CDE
     C                     MOVEL##JNO     YL0059           Job Number Cde
      * Create WF Inv/Memo Combo for combine invoices
      * Print Invoice & crt WF Invoice List Work
      * CASE: LCL.Print Invoice Sts is no
     C           YL0055    IFEQ 'N'                        *IF
      * *** Print = N --> Crt Invoice List Work
      * ** Set fax invoice flag to Yes for fax/email program  P000198
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWXC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWXAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN1042    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0522 10        Job Name CDE
     C                     PARM YL0059    WQ0523 10        Job Number Cde
     C                     PARM WXC4NB    WQ0524  70       Order Number
     C                     PARM WXAIC3    WQ0525  30       Company Number
     C           YL0056    PARM *BLANK    WQ0526  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/06/2006 slm -- Do not print the org inv routine
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWXC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWXAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN1042    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0527 10        Job Name CDE
     C                     PARM YL0059    WQ0528 10        Job Number Cde
     C                     PARM WXC4NB    WQ0529  70       Order Number
     C                     PARM WXAIC3    WQ0530  30       Company Number
     C           YL0056    PARM *BLANK    WQ0531  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Print=Y --> Print Invoice. Print will create Invoice List Wor
      * If custom program then print the invoice custom program
      * Department is INCST1
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0532  30       Company Number
     C                     PARM 'IN'      WQ0533  2        CDD Type
     C                     PARM 'INCST1'  WQ0534  6        CDD Department
     C                     PARM *BLANK    WQ0535  8        CDD Name of Ove
     C           YL0063    PARM *BLANK    WQ0536 10        CDD Program Nam
     C                     PARM *BLANK    WQ0537 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0538 10        CDD Additional
     C                     PARM *BLANK    WQ0539 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0540 25        CDD Sender Fax
     C           YL0064    PARM *BLANK    WQ0541 10        Output Queue
     C           YL0065    PARM *BLANK    WQ0542  4        Hold File
     C           YL0066    PARM *BLANK    WQ0543  4        Save File
     C           YL0067    PARM *ZERO     WQ0544  30       Source Drawer
     C                     PARM *BLANK    WQ0545 10        Printer Device
     C                     PARM *ZERO     WQ0546  30       Page Length 2
     C                     PARM *ZERO     WQ0547  30       Page Width 2
     C                     PARM *ZERO     WQ0548  30       Page LPI
     C                     PARM *ZERO     WQ0549  31       Page CPI
     C                     PARM *ZERO     WQ0550  30       Page Overflow
     C                     PARM *BLANK    WQ0551  5        Page Rotation
     C                     PARM *BLANK    WQ0552 50        CDD Comment 1
     C                     PARM *BLANK    WQ0553 50        CDD Comment 2
     C                     PARM *BLANK    WQ0554 50        CDD Comment 3
     C                     PARM *BLANK    WQ0555 50        CDD Comment 4
     C                     PARM *BLANK    WQ0556 50        CDD Comment 5
     C                     PARM *BLANK    WQ0557  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Invoice
      * CASE: LCL.CDD Program Name is Not entered
     C           YL0063    IFEQ *BLANK                     *IF
      * PRT Inv/Memo 8LPI      PF - Order Header TRG  * 
     C                     CALL 'PDR4PFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0558  30       Company Number
     C                     PARM WXC4NB    WQ0559  70       Order Number
     C                     PARM 'N'       WQ0560  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR4PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * If Daily's or HPB
      * CASE: LCL.Company Organization is Daily's
     C           YL0057    IFEQ 'D'                        *IF
      * This will be called three times Customer/Org/Office
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0561  30       Company Number
     C                     PARM WXC4NB    WQ0562  70       Order Number
     C                     PARM 'N'       WQ0563  1        Printed Status
     C                     PARM 'CS'      WQ0564  2        @Invoice Type
     C                     PARM YL0058    WQ0565 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0566  30       Company Number
     C                     PARM WXC4NB    WQ0567  70       Order Number
     C                     PARM 'N'       WQ0568  1        Printed Status
     C                     PARM 'OF'      WQ0569  2        @Invoice Type
     C                     PARM YL0058    WQ0570 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0571  30       Company Number
     C                     PARM WXC4NB    WQ0572  70       Order Number
     C                     PARM 'N'       WQ0573  1        Printed Status
     C                     PARM 'OR'      WQ0574  2        @Invoice Type
     C                     PARM YL0058    WQ0575 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0057    IFEQ 'H'                        *IF
      * FP1110 7/21/08 RMC - Print HPB BOL if COA Batch# is on the Order
     C                     Z-ADD*ZERO     YL0068           HPB COA Batch N
      * VAL OHE exsts for HPB RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0081           Company Number
     C                     Z-ADDWXC4NB    WL0082           Order Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0083    YL0068           HPB COA Batch N
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.HPB COA Batch Number is Entered
      *   |- c2    : LCL.Load ID is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0068    IFGT 0                          *IF
     C           YL0048    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PRT Bill of Lading-HPB PF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDYL0048    PCRMNB           Load ID
      *
     C                     CALL 'PMO7PFR'              90  PRT Bill of Lad
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C                     PARM WXAIC3    WQ0576  30       Company Number
     C                     PARM WN1340    WQ0577  1        Export Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMO7PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * PRT Inv/Memo 8LPI HPB  PF - Order Header TRG  * 
     C                     CALL 'PMRCPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0578  30       Company Number
     C                     PARM WXC4NB    WQ0579  70       Order Number
     C                     PARM 'N'       WQ0580  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------------
      * CRT Invoice Events     RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0084           Company Number
     C                     Z-ADDWXC4NB    WL0085           Order Number
     C                     MOVEL'06'      WL0086    P      Event Code
     C                     Z-ADDWXAIC3    WL0087           Invoice/Memo Co
     C                     Z-ADDP1CONB    WL0088           Invoice/Memo Nu
     C                     MOVELWN1042    WL0089    P      Invoice/Memo Su
     C                     Z-ADDWXANC7    WL0090           Ship To Custome
     C                     EXSR SSRVGN
      * UPD Event: Hdr,O/S Dtl RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0106           Company Number
     C                     Z-ADDWXC4NB    WL0107           Order Number
     C                     MOVEL'06'      WL0108    P      Event Code
     C                     EXSR SVRVGN
     C                     ADD  1         P3CNTU           Count USR
     C                     END                             *FI
      * Print Invoice for order with Actual Ship Date LE selected ship da
      * CASE: Actual Shipped Date Selected
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : PAR.Order Number is Equal to zeros
      *   |- c2    : PAR.Load ID is Blank
      *   |- c3    : PAR.Actual Shipped Date is entered
      *   |- c4    : DB1.Actual Shipped Date LE PAR.Actual Shipped Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1C4NB    IFEQ 0                          *IF
     C           P1RMNB    IFEQ 0                          *IF
     C           P1GNDT    IFNE 0                          *IF
     C           WXGNDT    IFLE P1GNDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN1405  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1406  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1407  70       Parent Customer
     C                     MOVEL*BLANK    WN1408 30        Ship To Name
     C                     MOVEL*BLANK    WN1409 30        Ship To Address
     C                     MOVEL*BLANK    WN1410 30        Ship To Address
     C                     MOVEL*BLANK    WN1411 30        Ship To Address
     C                     MOVEL*BLANK    WN1412 20        Ship To City
     C                     MOVEL*BLANK    WN1413  2        Ship To State C
     C                     MOVEL*BLANK    WN1414 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1415  70       Bill to Custome
     C                     MOVEL*BLANK    WN1416 30        Bill to Name
     C                     MOVEL*BLANK    WN1417 30        Bill to Address
     C                     MOVEL*BLANK    WN1418 30        Bill to Address
     C                     MOVEL*BLANK    WN1419 30        Bill to Address
     C                     MOVEL*BLANK    WN1420 20        Bill to City
     C                     MOVEL*BLANK    WN1421  2        Bill to State C
     C                     MOVEL*BLANK    WN1422 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1423 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1424  70       Order Date
     C                     Z-ADD*ZERO     WN1425  70       Requested Ship
     C                     Z-ADD*ZERO     WN1426  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1427  70       Cancel Date
     C                     MOVEL*BLANK    WN1428  2        Terms Code
     C                     MOVEL*BLANK    WN1429 40        Special Instruc
     C                     MOVEL*BLANK    WN1430 40        Special Instruc
     C                     MOVEL*BLANK    WN1431  3        Carrier Code
     C                     MOVEL*BLANK    WN1432  1        Comment Print A
     C                     MOVEL*BLANK    WN1433  1        Comment Print I
     C                     MOVEL*BLANK    WN1434  1        Comment Print P
     C                     MOVEL*BLANK    WN1435  1        Comment Print S
     C                     MOVEL*BLANK    WN1436  3        Reason Code
     C                     MOVEL*BLANK    WN1437  1        Order in Use
     C                     MOVEL*BLANK    WN1438  1        Header Status
     C                     MOVEL*BLANK    WN1439  1        Header Status L
     C                     MOVEL*BLANK    WN1440  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1441  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1442 10        User Original E
     C                     Z-ADD*ZERO     WN1443  70       Date of Origina
     C                     Z-ADD*ZERO     WN1444 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1445 112       Order Weight To
     C                     MOVEL*BLANK    WN1446  1        Credit Hold
     C                     MOVEL*BLANK    WN1447  1        Production Hold
     C                     MOVEL*BLANK    WN1448  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1449  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1450  40       Requested Deliv
     C                     MOVEL*BLANK    WN1451  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1452 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1453  70       Load ID
     C                     Z-ADD*ZERO     WN1454  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN1455 112       Rated Freight
     C                     MOVEL*BLANK    WN1456  1        LTL Flag
     C                     MOVEL*BLANK    WN1457  1        Price Audit
     C                     MOVEL*BLANK    WN1458  1        Price Status
     C                     MOVEL*BLANK    WN1459  2        Shipping Method
     C                     MOVEL*BLANK    WN1460  1        Export Status
     C                     MOVEL*BLANK    WN1461  1        Palletize
     C                     MOVEL*BLANK    WN1462  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1463  1        Slip Sheet
     C                     MOVEL*BLANK    WN1464  1        Age Code
     C                     Z-ADD*ZERO     WN1465  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1466  1        Load Type
     C                     Z-ADD*ZERO     WN1467  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1468  1        Load Plan Order
     C                     MOVEL*BLANK    WN1469  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1470  70       Resell Referenc
     C                     MOVEL*BLANK    WN1471 30        Special Comment
     C                     MOVEL*BLANK    WN1472 30        Special Comment
     C                     MOVEL*BLANK    WN1473  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1474  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1475  2        Manager Level C
     C                     MOVEL*BLANK    WN1476  3        VP Level Code
     C                     Z-ADD*ZERO     WN1477  70       Attach to Order
     C                     MOVEL*BLANK    WN1478  3        Reason for Pric
     C                     MOVEL*BLANK    WN1479  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1480  1        Modified Flag
     C                     Z-ADD*ZERO     WN1481 112       A/R order Value
     C                     MOVEL*BLANK    WN1482  1        Billing Activit
     C                     MOVEL*BLANK    WN1483  1        Block Order Fla
     C                     MOVEL*BLANK    WN1484  1        Order Certifica
     C                     Z-ADD*ZERO     WN1485 112       Invoice Order V
     C                     MOVEL*BLANK    WN1486  1        Process Sts for
     C                     MOVEL*BLANK    WN1487  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1488  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1489  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1490  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1491  1        Email Cust On O
     C                     MOVEL*BLANK    WN1492  1        Order Emailed
     C                     MOVEL*BLANK    WN1493  1        Export Docs Go
     C                     MOVEL*BLANK    WN1494  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1495  1        Broker Order St
     C                     MOVEL*BLANK    WN1496  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1497  2        Order Requires
     C                     MOVEL*BLANK    WN1498  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1499  2        Export USDA App
     C                     MOVEL*BLANK    WN1500  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1501  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1502  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1503  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1504  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1505  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1506  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1507  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1508  60       Time of Origina
     C                     Z-ADD*ZERO     WN1509  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1510  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1511  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1512 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1513 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1514 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1515 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1516 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1517  70       Claim Number
     C                     MOVEL*BLANK    WN1518  1        EDI Status 1
     C                     MOVEL*BLANK    WN1519  1        EDI Status 2
     C                     MOVEL*BLANK    WN1520  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1521  60       Job Time
     C                     MOVEL*BLANK    WN1522 10        User Id
     C                     MOVEL*BLANK    WN1523 10        Job Name
     C                     Z-ADD*ZERO     WN1524  70       Job Date
      *
      * SEL Process Prt Invc   IF
      * 2/18/05 PKD use company number 000
      * UPD Next Invoice Nbr   RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD*ZERO     WL0004           Company Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P1CONB           Next Invoice Nu
      * CHG Invoice #, Date    CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0006           Company Number
     C                     Z-ADDWXC4NB    WL0007           Order Number
     C                     Z-ADDP1CONB    WL0008           Invoice Number
     C                     MOVELWN1042    WL0009    P      Invoice Suffix
     C                     Z-ADDWN1043    WL0010           Invoice Date
     C                     EXSR SFCHRC
      * *----------------------------------------------------------------
      * P000198
      * Retrieve Order information for creating Inv List Work & Combine I
     C                     EXSR ULSUBR                     Retrieve Order
      * *----------------------------------------------------------------
     C                     MOVEL##JOB     YL0058           Job Name CDE
     C                     MOVEL##JNO     YL0059           Job Number Cde
      * Create WF Inv/Memo Combo for combine invoices
      * Print Invoice & crt WF Invoice List Work
      * CASE: LCL.Print Invoice Sts is no
     C           YL0055    IFEQ 'N'                        *IF
      * *** Print = N --> Crt Invoice List Work
      * ** Set fax invoice flag to Yes for fax/email program  P000198
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWXC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWXAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN1042    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0582 10        Job Name CDE
     C                     PARM YL0059    WQ0583 10        Job Number Cde
     C                     PARM WXC4NB    WQ0584  70       Order Number
     C                     PARM WXAIC3    WQ0585  30       Company Number
     C           YL0056    PARM *BLANK    WQ0586  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0056    IFEQ 'Y'                        *IF
     C           YL0051    IFEQ '3'                        *IF
     C           YL0051    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/06/2006 slm -- Do not print the org inv routine
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##JOB     WL0059    P      Job Name CDE
     C                     Z-ADDWXC4NB    WL0060           Order Number
     C                     Z-ADDYL0046    WL0061           Order Value Tot
     C                     Z-ADDYL0047    WL0062           Order Weight To
     C                     MOVELYL0026    WL0063    P      Ship To Name
     C                     MOVELYL0034    WL0064    P      Bill to Name
     C                     MOVEL'Y'       WL0065    P      Fax Invoice Fla
     C                     Z-ADDYL0025    WL0066           Ship to Custome
     C                     Z-ADDYL0024    WL0067           Ship To Custome
     C                     Z-ADDWXAIC3    WL0068           Company Number
     C                     Z-ADDP1CONB    WL0069           Invoice Number
     C                     MOVELWN1042    WL0070    P      Invoice Suffix
     C                     EXSR SMCRRC
      * CRT 1 WF Invoice/Cmb   XF - WF Invoice/Combine Drv  * 
     C                     CALL 'PMCPXFR'              90  CRT 1 WF Invoic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0058    WQ0587 10        Job Name CDE
     C                     PARM YL0059    WQ0588 10        Job Number Cde
     C                     PARM WXC4NB    WQ0589  70       Order Number
     C                     PARM WXAIC3    WQ0590  30       Company Number
     C           YL0056    PARM *BLANK    WQ0591  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Print=Y --> Print Invoice. Print will create Invoice List Wor
      * If custom program then print the invoice custom program
      * Department is INCST1
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0592  30       Company Number
     C                     PARM 'IN'      WQ0593  2        CDD Type
     C                     PARM 'INCST1'  WQ0594  6        CDD Department
     C                     PARM *BLANK    WQ0595  8        CDD Name of Ove
     C           YL0063    PARM *BLANK    WQ0596 10        CDD Program Nam
     C                     PARM *BLANK    WQ0597 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0598 10        CDD Additional
     C                     PARM *BLANK    WQ0599 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0600 25        CDD Sender Fax
     C           YL0064    PARM *BLANK    WQ0601 10        Output Queue
     C           YL0065    PARM *BLANK    WQ0602  4        Hold File
     C           YL0066    PARM *BLANK    WQ0603  4        Save File
     C           YL0067    PARM *ZERO     WQ0604  30       Source Drawer
     C                     PARM *BLANK    WQ0605 10        Printer Device
     C                     PARM *ZERO     WQ0606  30       Page Length 2
     C                     PARM *ZERO     WQ0607  30       Page Width 2
     C                     PARM *ZERO     WQ0608  30       Page LPI
     C                     PARM *ZERO     WQ0609  31       Page CPI
     C                     PARM *ZERO     WQ0610  30       Page Overflow
     C                     PARM *BLANK    WQ0611  5        Page Rotation
     C                     PARM *BLANK    WQ0612 50        CDD Comment 1
     C                     PARM *BLANK    WQ0613 50        CDD Comment 2
     C                     PARM *BLANK    WQ0614 50        CDD Comment 3
     C                     PARM *BLANK    WQ0615 50        CDD Comment 4
     C                     PARM *BLANK    WQ0616 50        CDD Comment 5
     C                     PARM *BLANK    WQ0617  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Invoice
      * CASE: LCL.CDD Program Name is Not entered
     C           YL0063    IFEQ *BLANK                     *IF
      * PRT Inv/Memo 8LPI      PF - Order Header TRG  * 
     C                     CALL 'PDR4PFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0618  30       Company Number
     C                     PARM WXC4NB    WQ0619  70       Order Number
     C                     PARM 'N'       WQ0620  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR4PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * If Daily's or HPB
      * CASE: LCL.Company Organization is Daily's
     C           YL0057    IFEQ 'D'                        *IF
      * This will be called three times Customer/Org/Office
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0621  30       Company Number
     C                     PARM WXC4NB    WQ0622  70       Order Number
     C                     PARM 'N'       WQ0623  1        Printed Status
     C                     PARM 'CS'      WQ0624  2        @Invoice Type
     C                     PARM YL0058    WQ0625 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0626  30       Company Number
     C                     PARM WXC4NB    WQ0627  70       Order Number
     C                     PARM 'N'       WQ0628  1        Printed Status
     C                     PARM 'OF'      WQ0629  2        @Invoice Type
     C                     PARM YL0058    WQ0630 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inv/Memo 8LPI Dly  PF - Order Header TRG  * 
     C                     CALL 'PMIVPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0631  30       Company Number
     C                     PARM WXC4NB    WQ0632  70       Order Number
     C                     PARM 'N'       WQ0633  1        Printed Status
     C                     PARM 'OR'      WQ0634  2        @Invoice Type
     C                     PARM YL0058    WQ0635 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMIVPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0057    IFEQ 'H'                        *IF
      * FP1110 7/21/08 RMC - Print HPB BOL if COA Batch# is on the Order
     C                     Z-ADD*ZERO     YL0068           HPB COA Batch N
      * VAL OHE exsts for HPB RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0081           Company Number
     C                     Z-ADDWXC4NB    WL0082           Order Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0083    YL0068           HPB COA Batch N
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.HPB COA Batch Number is Entered
      *   |- c2    : LCL.Load ID is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0068    IFGT 0                          *IF
     C           YL0048    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PRT Bill of Lading-HPB PF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDYL0048    PCRMNB           Load ID
      *
     C                     CALL 'PMO7PFR'              90  PRT Bill of Lad
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C                     PARM WXAIC3    WQ0636  30       Company Number
     C                     PARM WN1460    WQ0637  1        Export Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMO7PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * PRT Inv/Memo 8LPI HPB  PF - Order Header TRG  * 
     C                     CALL 'PMRCPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0638  30       Company Number
     C                     PARM WXC4NB    WQ0639  70       Order Number
     C                     PARM 'N'       WQ0640  1        Printed Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Delete trailer if Seaboard & Print (not reprint)    E002966
      * CASE: LCL.Company Organization is Seaboard
     C           YL0057    IFEQ 'S'                        *IF
      * CASE: LCL.Billing Activity Type is Invoice
     C           YL0051    IFEQ '1'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0071           Company Number
     C                     Z-ADDWXC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YL0060           Scheduled Ship
     C                     Z-ADDWL0074    YL0048           Load ID
     C                     MOVELWL0075    YL0061    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0061    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0048    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0062    P      Trailer Id
     C                     MOVELWL0078    YL0045    P      Carrier Code
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0079    P      Carrier Code
     C                     MOVELYL0062    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------------
      * CRT Invoice Events     RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0084           Company Number
     C                     Z-ADDWXC4NB    WL0085           Order Number
     C                     MOVEL'06'      WL0086    P      Event Code
     C                     Z-ADDWXAIC3    WL0087           Invoice/Memo Co
     C                     Z-ADDP1CONB    WL0088           Invoice/Memo Nu
     C                     MOVELWN1042    WL0089    P      Invoice/Memo Su
     C                     Z-ADDWXANC7    WL0090           Ship To Custome
     C                     EXSR SSRVGN
      * UPD Event: Hdr,O/S Dtl RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0106           Company Number
     C                     Z-ADDWXC4NB    WL0107           Order Number
     C                     MOVEL'06'      WL0108    P      Event Code
     C                     EXSR SVRVGN
     C                     ADD  1         P3CNTU           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSZ     READE@BFCPL7                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * SEL Inv to Prnt& Post  RT - WF Invoice/Combine Drv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYB2VN    WQTA01           Job Name CDE
     C           *LIKE     DEFN WYDJVN    WQTA02           Job Number Cde
     C           *LIKE     DEFN WYAIC3    WQTA03           Company Number
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Job Name CDE
     C                     KFLD           WQTA02           Job Number Cde
     C                     KFLD           WQTA03           Company Number
      * Setup key
     C                     MOVELYL0087    WQTA01           Job Name CDE
     C                     MOVELYL0088    WQTA02           Job Number Cde
     C                     Z-ADDP1AIC3    WQTA03           Company Number
      * Establish starting position
     C           KRSTA     SETLL@AFCPHX                    *
     C           KRSTA     READE@AFCPHX                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3671' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'N'       YL0089           Break
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.One Invoice Per PO is Yes
      *   |- c2    : DB1.WF Inv/Comb Billing Type is Invoice or Debit Mem
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WYHUSX    IFEQ 'Y'                        *IF
     C           WYBETX    IFEQ '3'                        *IF
     C           WYBETX    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * This process is already restricting by Job and company
      * CHG:  Actual Shipped Date/Ship To Customer/Customer PO
      * CASE: LCL.Actual Shipped Date NE DB1.Actual Shipped Date
     C           YL0090    IFNE WYGNDT                     *IF
     C                     MOVEL'Y'       YL0089           Break
     C                     ELSE
      * CASE: LCL.Ship To Customer NE DB1.Ship To Customer
     C           YL0091    IFNE WYBKC7                     *IF
     C                     MOVEL'Y'       YL0089           Break
     C                     ELSE
      * CASE: LCL.Customer Purchase Order # NE DB1.Customer Purchase Orde
     C           YL0092    IFNE WYBCNA                     *IF
     C                     MOVEL'Y'       YL0089           Break
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Break logic print the combine invoice on the first one
      * CASE: LCL.Break is Yes
     C           YL0089    IFEQ 'Y'                        *IF
      * * establish first logic break, only select print of combine invoi
      * when the ship to and customer po number changes
      * ** Depending on option, format for Form or No Form    E002016
      * CASE: PAR.Reprint Status USR is Reprint
     C           'Y'       IFEQ 'R'                        *IF
      * PRT Inv/Fast FaxCMB 6LPPF - Order Header TRG  * 
     C                     CALL 'PMCKPFR'              90  PRT Inv/Fast Fa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WYAIC3    WQ0641  30       Company Number
     C                     PARM WYC4NB    WQ0642  70       Order Number
     C                     PARM WYBKC7    WQ0643  70       Ship To Custome
     C                     PARM WYBCNA    WQ0644 15        Customer Purcha
     C                     PARM WYGNDT    WQ0645  70       Actual Shipped
     C           YL0093    PARM YL0093    WQ0646  1        Printed Status
     C                     PARM WYB2VN    WQ0647 10        Job Name CDE
     C                     PARM WYDJVN    WQ0648 10        Job Number Cde
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCKPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PRT Inv/Memo 8LPI CB   PF - Order Header TRG  * 
     C                     CALL 'PMCJPFR'              90  PRT Inv/Memo 8L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WYAIC3    WQ0649  30       Company Number
     C                     PARM WYC4NB    WQ0650  70       Order Number
     C                     PARM WYBKC7    WQ0651  70       Ship To Custome
     C                     PARM WYBCNA    WQ0652 15        Customer Purcha
     C                     PARM WYGNDT    WQ0653  70       Actual Shipped
     C                     PARM P6B8ST    WQ0654  1        Printed Status
     C                     PARM WYB2VN    WQ0655 10        Job Name CDE
     C                     PARM WYDJVN    WQ0656 10        Job Number Cde
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCJPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Dlt trailer for Invoiced order, Seaboard only         E002966
      * CASE: DB1.WF Inv/Comb Billing Type is Invoice
     C           WYBETX    IFEQ '1'                        *IF
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWYAIC3    WL0056           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    YN0025    P      Plant Company S
     C                     MOVELWL0058    YL0094    P      Company Organiz
      * CASE: LCL.Company Organization is Seaboard
     C           YL0094    IFEQ 'S'                        *IF
      * RTV Ld Id for Orders  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWYAIC3    WL0071           Company Number
     C                     Z-ADDWYC4NB    WL0072           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    YN0026           Scheduled Ship
     C                     Z-ADDWL0074    YL0095           Load ID
     C                     MOVELWL0075    YL0096    P      Load Plan Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           YL0096    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Carrier & Trailer  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0095    WL0076           Load ID
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0097    P      Trailer Id
     C                     MOVELWL0078    YL0098    P      Carrier Code
      * * Not an error if no trailer                          E002966
      * RTV/DLT Assigned Trlr  RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0098    WL0079    P      Carrier Code
     C                     MOVELYL0097    WL0080    P      Trailer Id
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWYBKC7    YL0091           Ship To Custome
     C                     MOVELWYBCNA    YL0092           Customer Purcha
     C                     Z-ADDWYGNDT    YL0090           Actual Shipped
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTA     READE@AFCPHX                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Combo PO Update the Order Type Print Status  Yes or No
      *================================================================
      * 04/27 SLM Put in the Combo PO, change all orders to YES
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDWABKC7    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0019    PARM *BLANK    WQ0058  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.One Invoice Per PO is Yes
     C           YL0019    IFEQ 'Y'                        *IF
      * CHG Po and its Ords    XF - Order Header TRG  * 
     C                     CALL 'PMF8XFR'              90  CHG Po and its
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0059  30       Company Number
     C                     PARM WABKC7    WQ0060  70       Ship To Custome
     C                     PARM WABCNA    WQ0061 15        Customer Purcha
     C                     PARM WUGYST    WQ0062  1        Order Type Prin
     C                     PARM WAAODT    WQ0063  70       Scheduled Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMF8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Combo PO Update the Order Type Print Status  Yes or No
      *================================================================
      * 04/27 SLM Put in the Combo PO, change all orders to YES
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDWABKC7    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0019    PARM *BLANK    WQ0064  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.One Invoice Per PO is Yes
     C           YL0019    IFEQ 'Y'                        *IF
      * CHG Po and its Ords    XF - Order Header TRG  * 
     C                     CALL 'PMF8XFR'              90  CHG Po and its
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0065  30       Company Number
     C                     PARM WABKC7    WQ0066  70       Ship To Custome
     C                     PARM WABCNA    WQ0067 15        Customer Purcha
     C                     PARM WUGYST    WQ0068  1        Order Type Prin
     C                     PARM WAAODT    WQ0069  70       Scheduled Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMF8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Retrieve Order information for creating Inv List Work & Combine
      *================================================================
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDWAC4NB    WL0012           Order Number
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      Order Type - Sa
     C                     Z-ADDWL0014    YL0024           A/R Customer Nu
     C                     Z-ADDWL0015    YL0025           Ship To Custome
     C                     MOVELWL0016    YL0026    P      Ship To Name
     C                     MOVELWL0017    YL0027    P      Ship To Address
     C                     MOVELWL0018    YL0028    P      Ship To Address
     C                     MOVELWL0019    YL0029    P      Ship To Address
     C                     MOVELWL0020    YL0030    P      Ship To City
     C                     MOVELWL0021    YL0031    P      Ship To State C
     C                     MOVELWL0022    YL0032    P      Ship To Zip/Pos
     C                     Z-ADDWL0023    YL0033           Bill to Custome
     C                     MOVELWL0024    YL0034    P      Bill to Name
     C                     MOVELWL0025    YL0035    P      Bill to Address
     C                     MOVELWL0026    YL0036    P      Bill to Address
     C                     MOVELWL0027    YL0037    P      Bill to Address
     C                     MOVELWL0028    YL0038    P      Bill to City
     C                     MOVELWL0029    YL0039    P      Bill to State C
     C                     MOVELWL0030    YL0040    P      Bill to Zip/Pos
     C                     MOVELWL0031    YL0041    P      Customer Purcha
     C                     Z-ADDWL0032    YL0042           Order Date
     C                     Z-ADDWL0033    YL0043           Actual Shipped
     C                     MOVELWL0034    YL0044    P      Terms Code
     C                     MOVELWL0035    YL0045    P      Carrier Code
     C                     Z-ADDWL0036    YL0046           Order Value Tot
     C                     Z-ADDWL0037    YL0047           Order Weight To
     C                     Z-ADDWL0038    YL0048           Load ID
     C                     MOVELWL0039    YL0049    P      Sales Route Cod
     C                     Z-ADDWL0040    WUCONB           Invoice Number
     C                     Z-ADDWL0041    YL0050           Invoice Date
     C                     MOVELWL0042    YL0051    P      Billing Activit
      * RTV CDE 1st Fax only  IF
      * RTV CDE 1 Fax only    RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0043           Ship To Custome
     C                     MOVEL@CN,001   WL0044    P      Distribution Co
     C                     Z-ADD*ZERO     WL0045           CDE Sequence Nu
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WUWLT1    P      CDE Name
     C                     MOVELWL0047    WUWMT1    P      CDE Destination
      * Set flag if faxing invoice                            P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     END                             *FI
      * RTV CDE 1st Eml only  RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0048           Ship To Custome
     C                     MOVEL@CN,001   WL0049    P      Distribution Co
     C                     Z-ADD*ZERO     WL0050           CDE Sequence Nu
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    WUWLT1    P      CDE Name
     C                     MOVELWL0052    WUWMT1    P      CDE Destination
      * Set flag if emailing invoice                          P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
      * ** Set Fax Invoice Flag so the wf rec won't get deleted before
      * ** it gets faxed or invoiced.
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     MOVEL'E'       YL0053           Email Selection
     C                     END                             *FI
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0053           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YL0054    P      EDI Invoice Sts
     C                     MOVELWL0055    YL0055    P      Print Invoice S
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDYL0025    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0056    PARM *BLANK    WQ0084  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * credit memo
      * CASE: LCL.Billing Activity Type is Credit Memo
     C           YL0051    IFEQ '2'                        *IF
     C           *ZERO     SUB  YL0046    YL0046           Order Value Tot
     C                     END                             *FI
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0056           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    YN0004    P      Plant Company S
     C                     MOVELWL0058    YL0057    P      Company Organiz
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Retrieve Order information for creating Inv List Work & Combine
      *================================================================
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDWAC4NB    WL0012           Order Number
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      Order Type - Sa
     C                     Z-ADDWL0014    YL0024           A/R Customer Nu
     C                     Z-ADDWL0015    YL0025           Ship To Custome
     C                     MOVELWL0016    YL0026    P      Ship To Name
     C                     MOVELWL0017    YL0027    P      Ship To Address
     C                     MOVELWL0018    YL0028    P      Ship To Address
     C                     MOVELWL0019    YL0029    P      Ship To Address
     C                     MOVELWL0020    YL0030    P      Ship To City
     C                     MOVELWL0021    YL0031    P      Ship To State C
     C                     MOVELWL0022    YL0032    P      Ship To Zip/Pos
     C                     Z-ADDWL0023    YL0033           Bill to Custome
     C                     MOVELWL0024    YL0034    P      Bill to Name
     C                     MOVELWL0025    YL0035    P      Bill to Address
     C                     MOVELWL0026    YL0036    P      Bill to Address
     C                     MOVELWL0027    YL0037    P      Bill to Address
     C                     MOVELWL0028    YL0038    P      Bill to City
     C                     MOVELWL0029    YL0039    P      Bill to State C
     C                     MOVELWL0030    YL0040    P      Bill to Zip/Pos
     C                     MOVELWL0031    YL0041    P      Customer Purcha
     C                     Z-ADDWL0032    YL0042           Order Date
     C                     Z-ADDWL0033    YL0043           Actual Shipped
     C                     MOVELWL0034    YL0044    P      Terms Code
     C                     MOVELWL0035    YL0045    P      Carrier Code
     C                     Z-ADDWL0036    YL0046           Order Value Tot
     C                     Z-ADDWL0037    YL0047           Order Weight To
     C                     Z-ADDWL0038    YL0048           Load ID
     C                     MOVELWL0039    YL0049    P      Sales Route Cod
     C                     Z-ADDWL0040    WUCONB           Invoice Number
     C                     Z-ADDWL0041    YL0050           Invoice Date
     C                     MOVELWL0042    YL0051    P      Billing Activit
      * RTV CDE 1st Fax only  IF
      * RTV CDE 1 Fax only    RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0043           Ship To Custome
     C                     MOVEL@CN,001   WL0044    P      Distribution Co
     C                     Z-ADD*ZERO     WL0045           CDE Sequence Nu
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WUWLT1    P      CDE Name
     C                     MOVELWL0047    WUWMT1    P      CDE Destination
      * Set flag if faxing invoice                            P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     END                             *FI
      * RTV CDE 1st Eml only  RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0048           Ship To Custome
     C                     MOVEL@CN,001   WL0049    P      Distribution Co
     C                     Z-ADD*ZERO     WL0050           CDE Sequence Nu
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    WUWLT1    P      CDE Name
     C                     MOVELWL0052    WUWMT1    P      CDE Destination
      * Set flag if emailing invoice                          P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
      * ** Set Fax Invoice Flag so the wf rec won't get deleted before
      * ** it gets faxed or invoiced.
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     MOVEL'E'       YL0053           Email Selection
     C                     END                             *FI
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0053           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YL0054    P      EDI Invoice Sts
     C                     MOVELWL0055    YL0055    P      Print Invoice S
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDYL0025    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0056    PARM *BLANK    WQ0144  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * credit memo
      * CASE: LCL.Billing Activity Type is Credit Memo
     C           YL0051    IFEQ '2'                        *IF
     C           *ZERO     SUB  YL0046    YL0046           Order Value Tot
     C                     END                             *FI
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0056           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    YN0004    P      Plant Company S
     C                     MOVELWL0058    YL0057    P      Company Organiz
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Retrieve Order information for creating Inv List Work & Combine
      *================================================================
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDWAC4NB    WL0012           Order Number
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      Order Type - Sa
     C                     Z-ADDWL0014    YL0024           A/R Customer Nu
     C                     Z-ADDWL0015    YL0025           Ship To Custome
     C                     MOVELWL0016    YL0026    P      Ship To Name
     C                     MOVELWL0017    YL0027    P      Ship To Address
     C                     MOVELWL0018    YL0028    P      Ship To Address
     C                     MOVELWL0019    YL0029    P      Ship To Address
     C                     MOVELWL0020    YL0030    P      Ship To City
     C                     MOVELWL0021    YL0031    P      Ship To State C
     C                     MOVELWL0022    YL0032    P      Ship To Zip/Pos
     C                     Z-ADDWL0023    YL0033           Bill to Custome
     C                     MOVELWL0024    YL0034    P      Bill to Name
     C                     MOVELWL0025    YL0035    P      Bill to Address
     C                     MOVELWL0026    YL0036    P      Bill to Address
     C                     MOVELWL0027    YL0037    P      Bill to Address
     C                     MOVELWL0028    YL0038    P      Bill to City
     C                     MOVELWL0029    YL0039    P      Bill to State C
     C                     MOVELWL0030    YL0040    P      Bill to Zip/Pos
     C                     MOVELWL0031    YL0041    P      Customer Purcha
     C                     Z-ADDWL0032    YL0042           Order Date
     C                     Z-ADDWL0033    YL0043           Actual Shipped
     C                     MOVELWL0034    YL0044    P      Terms Code
     C                     MOVELWL0035    YL0045    P      Carrier Code
     C                     Z-ADDWL0036    YL0046           Order Value Tot
     C                     Z-ADDWL0037    YL0047           Order Weight To
     C                     Z-ADDWL0038    YL0048           Load ID
     C                     MOVELWL0039    YL0049    P      Sales Route Cod
     C                     Z-ADDWL0040    WUCONB           Invoice Number
     C                     Z-ADDWL0041    YL0050           Invoice Date
     C                     MOVELWL0042    YL0051    P      Billing Activit
      * RTV CDE 1st Fax only  IF
      * RTV CDE 1 Fax only    RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0043           Ship To Custome
     C                     MOVEL@CN,001   WL0044    P      Distribution Co
     C                     Z-ADD*ZERO     WL0045           CDE Sequence Nu
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WUWLT1    P      CDE Name
     C                     MOVELWL0047    WUWMT1    P      CDE Destination
      * Set flag if faxing invoice                            P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     END                             *FI
      * RTV CDE 1st Eml only  RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0048           Ship To Custome
     C                     MOVEL@CN,001   WL0049    P      Distribution Co
     C                     Z-ADD*ZERO     WL0050           CDE Sequence Nu
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    WUWLT1    P      CDE Name
     C                     MOVELWL0052    WUWMT1    P      CDE Destination
      * Set flag if emailing invoice                          P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
      * ** Set Fax Invoice Flag so the wf rec won't get deleted before
      * ** it gets faxed or invoiced.
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     MOVEL'E'       YL0053           Email Selection
     C                     END                             *FI
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0053           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YL0054    P      EDI Invoice Sts
     C                     MOVELWL0055    YL0055    P      Print Invoice S
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDYL0025    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0056    PARM *BLANK    WQ0204  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * credit memo
      * CASE: LCL.Billing Activity Type is Credit Memo
     C           YL0051    IFEQ '2'                        *IF
     C           *ZERO     SUB  YL0046    YL0046           Order Value Tot
     C                     END                             *FI
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0056           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    YN0004    P      Plant Company S
     C                     MOVELWL0058    YL0057    P      Company Organiz
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Retrieve Order information for creating Inv List Work & Combine
      *================================================================
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDWAC4NB    WL0012           Order Number
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      Order Type - Sa
     C                     Z-ADDWL0014    YL0024           A/R Customer Nu
     C                     Z-ADDWL0015    YL0025           Ship To Custome
     C                     MOVELWL0016    YL0026    P      Ship To Name
     C                     MOVELWL0017    YL0027    P      Ship To Address
     C                     MOVELWL0018    YL0028    P      Ship To Address
     C                     MOVELWL0019    YL0029    P      Ship To Address
     C                     MOVELWL0020    YL0030    P      Ship To City
     C                     MOVELWL0021    YL0031    P      Ship To State C
     C                     MOVELWL0022    YL0032    P      Ship To Zip/Pos
     C                     Z-ADDWL0023    YL0033           Bill to Custome
     C                     MOVELWL0024    YL0034    P      Bill to Name
     C                     MOVELWL0025    YL0035    P      Bill to Address
     C                     MOVELWL0026    YL0036    P      Bill to Address
     C                     MOVELWL0027    YL0037    P      Bill to Address
     C                     MOVELWL0028    YL0038    P      Bill to City
     C                     MOVELWL0029    YL0039    P      Bill to State C
     C                     MOVELWL0030    YL0040    P      Bill to Zip/Pos
     C                     MOVELWL0031    YL0041    P      Customer Purcha
     C                     Z-ADDWL0032    YL0042           Order Date
     C                     Z-ADDWL0033    YL0043           Actual Shipped
     C                     MOVELWL0034    YL0044    P      Terms Code
     C                     MOVELWL0035    YL0045    P      Carrier Code
     C                     Z-ADDWL0036    YL0046           Order Value Tot
     C                     Z-ADDWL0037    YL0047           Order Weight To
     C                     Z-ADDWL0038    YL0048           Load ID
     C                     MOVELWL0039    YL0049    P      Sales Route Cod
     C                     Z-ADDWL0040    WUCONB           Invoice Number
     C                     Z-ADDWL0041    YL0050           Invoice Date
     C                     MOVELWL0042    YL0051    P      Billing Activit
      * RTV CDE 1st Fax only  IF
      * RTV CDE 1 Fax only    RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0043           Ship To Custome
     C                     MOVEL@CN,001   WL0044    P      Distribution Co
     C                     Z-ADD*ZERO     WL0045           CDE Sequence Nu
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WUWLT1    P      CDE Name
     C                     MOVELWL0047    WUWMT1    P      CDE Destination
      * Set flag if faxing invoice                            P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     END                             *FI
      * RTV CDE 1st Eml only  RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0048           Ship To Custome
     C                     MOVEL@CN,001   WL0049    P      Distribution Co
     C                     Z-ADD*ZERO     WL0050           CDE Sequence Nu
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    WUWLT1    P      CDE Name
     C                     MOVELWL0052    WUWMT1    P      CDE Destination
      * Set flag if emailing invoice                          P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
      * ** Set Fax Invoice Flag so the wf rec won't get deleted before
      * ** it gets faxed or invoiced.
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     MOVEL'E'       YL0053           Email Selection
     C                     END                             *FI
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0053           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YL0054    P      EDI Invoice Sts
     C                     MOVELWL0055    YL0055    P      Print Invoice S
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDYL0025    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0056    PARM *BLANK    WQ0264  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * credit memo
      * CASE: LCL.Billing Activity Type is Credit Memo
     C           YL0051    IFEQ '2'                        *IF
     C           *ZERO     SUB  YL0046    YL0046           Order Value Tot
     C                     END                             *FI
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0056           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    YN0004    P      Plant Company S
     C                     MOVELWL0058    YL0057    P      Company Organiz
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Combo PO Update the Order Type Print Status  Yes or No
      *================================================================
      * 04/27 SLM Put in the Combo PO, change all orders to YES Or No
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDWXBKC7    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0086    PARM *BLANK    WQ0380  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.One Invoice Per PO is Yes
     C           YL0086    IFEQ 'Y'                        *IF
      * CHG Po and its Ords    XF - Order Header TRG  * 
     C                     CALL 'PMF8XFR'              90  CHG Po and its
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0381  30       Company Number
     C                     PARM WXBKC7    WQ0382  70       Ship To Custome
     C                     PARM WXBCNA    WQ0383 15        Customer Purcha
     C                     PARM WUGYST    WQ0384  1        Order Type Prin
     C                     PARM WXAODT    WQ0385  70       Scheduled Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMF8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Combo PO Update the Order Type Print Status  Yes or No
      *================================================================
      * 04/27 SLM Put in the Combo PO, change all orders to YES Or No
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDWXBKC7    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0086    PARM *BLANK    WQ0386  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.One Invoice Per PO is Yes
     C           YL0086    IFEQ 'Y'                        *IF
      * CHG Po and its Ords    XF - Order Header TRG  * 
     C                     CALL 'PMF8XFR'              90  CHG Po and its
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0387  30       Company Number
     C                     PARM WXBKC7    WQ0388  70       Ship To Custome
     C                     PARM WXBCNA    WQ0389 15        Customer Purcha
     C                     PARM WUGYST    WQ0390  1        Order Type Prin
     C                     PARM WXAODT    WQ0391  70       Scheduled Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMF8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Retrieve Order information for creating Inv List Work & Combine
      *================================================================
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0011           Company Number
     C                     Z-ADDWXC4NB    WL0012           Order Number
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      Order Type - Sa
     C                     Z-ADDWL0014    YL0024           A/R Customer Nu
     C                     Z-ADDWL0015    YL0025           Ship To Custome
     C                     MOVELWL0016    YL0026    P      Ship To Name
     C                     MOVELWL0017    YL0027    P      Ship To Address
     C                     MOVELWL0018    YL0028    P      Ship To Address
     C                     MOVELWL0019    YL0029    P      Ship To Address
     C                     MOVELWL0020    YL0030    P      Ship To City
     C                     MOVELWL0021    YL0031    P      Ship To State C
     C                     MOVELWL0022    YL0032    P      Ship To Zip/Pos
     C                     Z-ADDWL0023    YL0033           Bill to Custome
     C                     MOVELWL0024    YL0034    P      Bill to Name
     C                     MOVELWL0025    YL0035    P      Bill to Address
     C                     MOVELWL0026    YL0036    P      Bill to Address
     C                     MOVELWL0027    YL0037    P      Bill to Address
     C                     MOVELWL0028    YL0038    P      Bill to City
     C                     MOVELWL0029    YL0039    P      Bill to State C
     C                     MOVELWL0030    YL0040    P      Bill to Zip/Pos
     C                     MOVELWL0031    YL0041    P      Customer Purcha
     C                     Z-ADDWL0032    YL0042           Order Date
     C                     Z-ADDWL0033    YL0043           Actual Shipped
     C                     MOVELWL0034    YL0044    P      Terms Code
     C                     MOVELWL0035    YL0045    P      Carrier Code
     C                     Z-ADDWL0036    YL0046           Order Value Tot
     C                     Z-ADDWL0037    YL0047           Order Weight To
     C                     Z-ADDWL0038    YL0048           Load ID
     C                     MOVELWL0039    YL0049    P      Sales Route Cod
     C                     Z-ADDWL0040    WUCONB           Invoice Number
     C                     Z-ADDWL0041    YL0050           Invoice Date
     C                     MOVELWL0042    YL0051    P      Billing Activit
      * RTV CDE 1st Fax only  IF
      * RTV CDE 1 Fax only    RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0043           Ship To Custome
     C                     MOVEL@CN,001   WL0044    P      Distribution Co
     C                     Z-ADD*ZERO     WL0045           CDE Sequence Nu
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WUWLT1    P      CDE Name
     C                     MOVELWL0047    WUWMT1    P      CDE Destination
      * Set flag if faxing invoice                            P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     END                             *FI
      * RTV CDE 1st Eml only  RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0048           Ship To Custome
     C                     MOVEL@CN,001   WL0049    P      Distribution Co
     C                     Z-ADD*ZERO     WL0050           CDE Sequence Nu
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    WUWLT1    P      CDE Name
     C                     MOVELWL0052    WUWMT1    P      CDE Destination
      * Set flag if emailing invoice                          P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
      * ** Set Fax Invoice Flag so the wf rec won't get deleted before
      * ** it gets faxed or invoiced.
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     MOVEL'E'       YL0053           Email Selection
     C                     END                             *FI
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0053           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YL0054    P      EDI Invoice Sts
     C                     MOVELWL0055    YL0055    P      Print Invoice S
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDYL0025    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0056    PARM *BLANK    WQ0401  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * credit memo
      * CASE: LCL.Billing Activity Type is Credit Memo
     C           YL0051    IFEQ '2'                        *IF
     C           *ZERO     SUB  YL0046    YL0046           Order Value Tot
     C                     END                             *FI
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0056           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    YN0004    P      Plant Company S
     C                     MOVELWL0058    YL0057    P      Company Organiz
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Retrieve Order information for creating Inv List Work & Combine
      *================================================================
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0011           Company Number
     C                     Z-ADDWXC4NB    WL0012           Order Number
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      Order Type - Sa
     C                     Z-ADDWL0014    YL0024           A/R Customer Nu
     C                     Z-ADDWL0015    YL0025           Ship To Custome
     C                     MOVELWL0016    YL0026    P      Ship To Name
     C                     MOVELWL0017    YL0027    P      Ship To Address
     C                     MOVELWL0018    YL0028    P      Ship To Address
     C                     MOVELWL0019    YL0029    P      Ship To Address
     C                     MOVELWL0020    YL0030    P      Ship To City
     C                     MOVELWL0021    YL0031    P      Ship To State C
     C                     MOVELWL0022    YL0032    P      Ship To Zip/Pos
     C                     Z-ADDWL0023    YL0033           Bill to Custome
     C                     MOVELWL0024    YL0034    P      Bill to Name
     C                     MOVELWL0025    YL0035    P      Bill to Address
     C                     MOVELWL0026    YL0036    P      Bill to Address
     C                     MOVELWL0027    YL0037    P      Bill to Address
     C                     MOVELWL0028    YL0038    P      Bill to City
     C                     MOVELWL0029    YL0039    P      Bill to State C
     C                     MOVELWL0030    YL0040    P      Bill to Zip/Pos
     C                     MOVELWL0031    YL0041    P      Customer Purcha
     C                     Z-ADDWL0032    YL0042           Order Date
     C                     Z-ADDWL0033    YL0043           Actual Shipped
     C                     MOVELWL0034    YL0044    P      Terms Code
     C                     MOVELWL0035    YL0045    P      Carrier Code
     C                     Z-ADDWL0036    YL0046           Order Value Tot
     C                     Z-ADDWL0037    YL0047           Order Weight To
     C                     Z-ADDWL0038    YL0048           Load ID
     C                     MOVELWL0039    YL0049    P      Sales Route Cod
     C                     Z-ADDWL0040    WUCONB           Invoice Number
     C                     Z-ADDWL0041    YL0050           Invoice Date
     C                     MOVELWL0042    YL0051    P      Billing Activit
      * RTV CDE 1st Fax only  IF
      * RTV CDE 1 Fax only    RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0043           Ship To Custome
     C                     MOVEL@CN,001   WL0044    P      Distribution Co
     C                     Z-ADD*ZERO     WL0045           CDE Sequence Nu
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WUWLT1    P      CDE Name
     C                     MOVELWL0047    WUWMT1    P      CDE Destination
      * Set flag if faxing invoice                            P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     END                             *FI
      * RTV CDE 1st Eml only  RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0048           Ship To Custome
     C                     MOVEL@CN,001   WL0049    P      Distribution Co
     C                     Z-ADD*ZERO     WL0050           CDE Sequence Nu
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    WUWLT1    P      CDE Name
     C                     MOVELWL0052    WUWMT1    P      CDE Destination
      * Set flag if emailing invoice                          P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
      * ** Set Fax Invoice Flag so the wf rec won't get deleted before
      * ** it gets faxed or invoiced.
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     MOVEL'E'       YL0053           Email Selection
     C                     END                             *FI
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0053           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YL0054    P      EDI Invoice Sts
     C                     MOVELWL0055    YL0055    P      Print Invoice S
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDYL0025    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0056    PARM *BLANK    WQ0461  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * credit memo
      * CASE: LCL.Billing Activity Type is Credit Memo
     C           YL0051    IFEQ '2'                        *IF
     C           *ZERO     SUB  YL0046    YL0046           Order Value Tot
     C                     END                             *FI
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0056           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    YN0004    P      Plant Company S
     C                     MOVELWL0058    YL0057    P      Company Organiz
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Retrieve Order information for creating Inv List Work & Combine
      *================================================================
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0011           Company Number
     C                     Z-ADDWXC4NB    WL0012           Order Number
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      Order Type - Sa
     C                     Z-ADDWL0014    YL0024           A/R Customer Nu
     C                     Z-ADDWL0015    YL0025           Ship To Custome
     C                     MOVELWL0016    YL0026    P      Ship To Name
     C                     MOVELWL0017    YL0027    P      Ship To Address
     C                     MOVELWL0018    YL0028    P      Ship To Address
     C                     MOVELWL0019    YL0029    P      Ship To Address
     C                     MOVELWL0020    YL0030    P      Ship To City
     C                     MOVELWL0021    YL0031    P      Ship To State C
     C                     MOVELWL0022    YL0032    P      Ship To Zip/Pos
     C                     Z-ADDWL0023    YL0033           Bill to Custome
     C                     MOVELWL0024    YL0034    P      Bill to Name
     C                     MOVELWL0025    YL0035    P      Bill to Address
     C                     MOVELWL0026    YL0036    P      Bill to Address
     C                     MOVELWL0027    YL0037    P      Bill to Address
     C                     MOVELWL0028    YL0038    P      Bill to City
     C                     MOVELWL0029    YL0039    P      Bill to State C
     C                     MOVELWL0030    YL0040    P      Bill to Zip/Pos
     C                     MOVELWL0031    YL0041    P      Customer Purcha
     C                     Z-ADDWL0032    YL0042           Order Date
     C                     Z-ADDWL0033    YL0043           Actual Shipped
     C                     MOVELWL0034    YL0044    P      Terms Code
     C                     MOVELWL0035    YL0045    P      Carrier Code
     C                     Z-ADDWL0036    YL0046           Order Value Tot
     C                     Z-ADDWL0037    YL0047           Order Weight To
     C                     Z-ADDWL0038    YL0048           Load ID
     C                     MOVELWL0039    YL0049    P      Sales Route Cod
     C                     Z-ADDWL0040    WUCONB           Invoice Number
     C                     Z-ADDWL0041    YL0050           Invoice Date
     C                     MOVELWL0042    YL0051    P      Billing Activit
      * RTV CDE 1st Fax only  IF
      * RTV CDE 1 Fax only    RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0043           Ship To Custome
     C                     MOVEL@CN,001   WL0044    P      Distribution Co
     C                     Z-ADD*ZERO     WL0045           CDE Sequence Nu
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WUWLT1    P      CDE Name
     C                     MOVELWL0047    WUWMT1    P      CDE Destination
      * Set flag if faxing invoice                            P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     END                             *FI
      * RTV CDE 1st Eml only  RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0048           Ship To Custome
     C                     MOVEL@CN,001   WL0049    P      Distribution Co
     C                     Z-ADD*ZERO     WL0050           CDE Sequence Nu
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    WUWLT1    P      CDE Name
     C                     MOVELWL0052    WUWMT1    P      CDE Destination
      * Set flag if emailing invoice                          P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
      * ** Set Fax Invoice Flag so the wf rec won't get deleted before
      * ** it gets faxed or invoiced.
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     MOVEL'E'       YL0053           Email Selection
     C                     END                             *FI
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0053           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YL0054    P      EDI Invoice Sts
     C                     MOVELWL0055    YL0055    P      Print Invoice S
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDYL0025    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0056    PARM *BLANK    WQ0521  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * credit memo
      * CASE: LCL.Billing Activity Type is Credit Memo
     C           YL0051    IFEQ '2'                        *IF
     C           *ZERO     SUB  YL0046    YL0046           Order Value Tot
     C                     END                             *FI
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0056           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    YN0004    P      Plant Company S
     C                     MOVELWL0058    YL0057    P      Company Organiz
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Retrieve Order information for creating Inv List Work & Combine
      *================================================================
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0011           Company Number
     C                     Z-ADDWXC4NB    WL0012           Order Number
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      Order Type - Sa
     C                     Z-ADDWL0014    YL0024           A/R Customer Nu
     C                     Z-ADDWL0015    YL0025           Ship To Custome
     C                     MOVELWL0016    YL0026    P      Ship To Name
     C                     MOVELWL0017    YL0027    P      Ship To Address
     C                     MOVELWL0018    YL0028    P      Ship To Address
     C                     MOVELWL0019    YL0029    P      Ship To Address
     C                     MOVELWL0020    YL0030    P      Ship To City
     C                     MOVELWL0021    YL0031    P      Ship To State C
     C                     MOVELWL0022    YL0032    P      Ship To Zip/Pos
     C                     Z-ADDWL0023    YL0033           Bill to Custome
     C                     MOVELWL0024    YL0034    P      Bill to Name
     C                     MOVELWL0025    YL0035    P      Bill to Address
     C                     MOVELWL0026    YL0036    P      Bill to Address
     C                     MOVELWL0027    YL0037    P      Bill to Address
     C                     MOVELWL0028    YL0038    P      Bill to City
     C                     MOVELWL0029    YL0039    P      Bill to State C
     C                     MOVELWL0030    YL0040    P      Bill to Zip/Pos
     C                     MOVELWL0031    YL0041    P      Customer Purcha
     C                     Z-ADDWL0032    YL0042           Order Date
     C                     Z-ADDWL0033    YL0043           Actual Shipped
     C                     MOVELWL0034    YL0044    P      Terms Code
     C                     MOVELWL0035    YL0045    P      Carrier Code
     C                     Z-ADDWL0036    YL0046           Order Value Tot
     C                     Z-ADDWL0037    YL0047           Order Weight To
     C                     Z-ADDWL0038    YL0048           Load ID
     C                     MOVELWL0039    YL0049    P      Sales Route Cod
     C                     Z-ADDWL0040    WUCONB           Invoice Number
     C                     Z-ADDWL0041    YL0050           Invoice Date
     C                     MOVELWL0042    YL0051    P      Billing Activit
      * RTV CDE 1st Fax only  IF
      * RTV CDE 1 Fax only    RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0043           Ship To Custome
     C                     MOVEL@CN,001   WL0044    P      Distribution Co
     C                     Z-ADD*ZERO     WL0045           CDE Sequence Nu
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WUWLT1    P      CDE Name
     C                     MOVELWL0047    WUWMT1    P      CDE Destination
      * Set flag if faxing invoice                            P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     END                             *FI
      * RTV CDE 1st Eml only  RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0048           Ship To Custome
     C                     MOVEL@CN,001   WL0049    P      Distribution Co
     C                     Z-ADD*ZERO     WL0050           CDE Sequence Nu
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    WUWLT1    P      CDE Name
     C                     MOVELWL0052    WUWMT1    P      CDE Destination
      * Set flag if emailing invoice                          P000198
      * CASE: WRK.CDE Name is Not Blank
     C           WUWLT1    IFNE *BLANK                     *IF
      * ** Set Fax Invoice Flag so the wf rec won't get deleted before
      * ** it gets faxed or invoiced.
     C                     MOVEL'Y'       YL0052           Fax Invoice Fla
     C                     MOVEL'E'       YL0053           Email Selection
     C                     END                             *FI
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0024    WL0053           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YL0054    P      EDI Invoice Sts
     C                     MOVELWL0055    YL0055    P      Print Invoice S
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPBRC
     C                     Z-ADDYL0025    PBBKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Customer E
     C           YL0056    PARM *BLANK    WQ0581  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * credit memo
      * CASE: LCL.Billing Activity Type is Credit Memo
     C           YL0051    IFEQ '2'                        *IF
     C           *ZERO     SUB  YL0046    YL0046           Order Value Tot
     C                     END                             *FI
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0056           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    YN0004    P      Plant Company S
     C                     MOVELWL0058    YL0057    P      Company Organiz
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Order Type Print Status
     C                     MOVEL*BLANK    WUGYST  1
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAXNB           Current Account
     C                     Z-ADD*ZERO     WDNGNB           Current Account
     C                     Z-ADD*ZERO     WDBZNB           OM Week
     C                     Z-ADD*ZERO     WDC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WDC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WDCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WDIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WDI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WDDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WDC7NB           Next Customer #
     C                     Z-ADD*ZERO     WDC2NB           Next Inventory
     C                     Z-ADD*ZERO     WDC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WDL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WDBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WDAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WDASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WDA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WDAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WDABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WDACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WDADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WDAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAENB           Retention Perio
     C                     Z-ADD*ZERO     WDALNB           Retention Perio
     C                     Z-ADD*ZERO     WDEVNB           Retention Perio
     C                     Z-ADD*ZERO     WDRPOP           Retention Perio
     C                     Z-ADD*ZERO     WDDWNB           Retention Perio
     C                     Z-ADD*ZERO     WDR3NB           Next Load ID
     C                     Z-ADD*ZERO     WDR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WDSCNB           Production Numb
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WFQEDT           PFS Last Update
     C                     Z-ADD*ZERO     WFCUTM           PFS Last Update
     C                     Z-ADD*ZERO     WFB0NY           PFS Hours Betwe
     C                     Z-ADD*ZERO     WFB1NY           PFS Minutes Btw
     C                     Z-ADD*ZERO     WFUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WFAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WFAINY           PFS Create Time
     C                     Z-ADD*ZERO     WFAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WFAKNY           PFS Change time
      * Define work field Invoice Number
     C                     Z-ADD*ZERO     WUCONB  70
      * Define work field CDE Name
     C                     MOVEL*BLANK    WUWLT1 30
      * Define work field CDE Destination
     C                     MOVEL*BLANK    WUWMT1 50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGRNNY           CDE Sequence Nu
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHP3NB           D & B Number
     C                     Z-ADD*ZERO     WHI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WHAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WHANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WHBTC7           Parent Customer
     C                     Z-ADD*ZERO     WHS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WHVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WHI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIXXTM           Departure Time
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WJA1WG           Order Weight To
     C                     Z-ADD*ZERO     WJCBC7           Ship to Custome
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJCONB           Invoice Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKRMNB           Load ID
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WKRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WKRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WKFLAM           Flat Amount
     C                     Z-ADD*ZERO     WKRRNB           Total Stops
     C                     Z-ADD*ZERO     WKSBNB           BOL Time
     C                     Z-ADD*ZERO     WKSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
     C                     Z-ADD*ZERO     WKSDNB           Number Pallets
     C                     Z-ADD*ZERO     WKPAOU           Number Pallets
     C                     Z-ADD*ZERO     WKDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WKSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WKHADT           Actual Arrival
     C                     Z-ADD*ZERO     WKAART           Actual Arrival
     C                     Z-ADD*ZERO     WKDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WKDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WKAQDT           Actual Departur
     C                     Z-ADD*ZERO     WKS6NB           Departure Time
     C                     Z-ADD*ZERO     WKT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WKPRTM           Product Tempera
     C                     Z-ADD*ZERO     WKNPSV           Number Spacers
     C                     Z-ADD*ZERO     WKTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WKGRWE           Gross Weight
     C                     Z-ADD*ZERO     WKF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WKJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WKTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WKJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WKSPTM           Spotted Time
     C                     Z-ADD*ZERO     WKJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WKLFTM           Load Finished T
     C                     Z-ADD*ZERO     WKJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WKBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WKJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WKBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WKKIDT           Truck Departure
     C                     Z-ADD*ZERO     WKASTM           Truck Departure
     C                     Z-ADD*ZERO     WKKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WKAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WKVOAG           Voyage
     C                     Z-ADD*ZERO     WKKBDT           Sail Date
     C                     Z-ADD*ZERO     WKEFDT           Arrival Date
     C                     Z-ADD*ZERO     WKKCDT           Date In
     C                     Z-ADD*ZERO     WKTMIN           Time In
     C                     Z-ADD*ZERO     WKKDDT           Date Out
     C                     Z-ADD*ZERO     WKVMNB           Time Out
     C                     Z-ADD*ZERO     WKOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WKKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WKATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WKBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WKEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WKKKDT           On Yard Date
     C                     Z-ADD*ZERO     WKAVTM           On Yard Time
     C                     Z-ADD*ZERO     WKKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WKAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WKLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WKK0DT           Product Complet
     C                     Z-ADD*ZERO     WKAYTM           Product Complet
     C                     Z-ADD*ZERO     WKKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WKICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WKIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WKK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WKAZTM           Load Door 1
     C                     Z-ADD*ZERO     WKK2DT           Override Total
     C                     Z-ADD*ZERO     WKA0TM           Load Door 2
     C                     Z-ADD*ZERO     WKZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WKPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WKCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WKPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WKCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WKP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WKCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WKP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WKCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WKP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WKCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WKP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WKCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLKKDT           On Yard Date
     C                     Z-ADD*ZERO     WLAVTM           On Yard Time
     C                     Z-ADD*ZERO     WLLCDT           Date Unused 1
     C                     Z-ADD*ZERO     WLLDDT           Date Unused 2
     C                     Z-ADD*ZERO     WLLEDT           Date Unused 3
     C                     Z-ADD*ZERO     WLLFDT           Date Unused 4
     C                     Z-ADD*ZERO     WLLGDT           Date Unused 5
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOC4NB           Order Number
     C                     Z-ADD*ZERO     WORMNB           Load ID
     C                     Z-ADD*ZERO     WORUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WOQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WOQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WOQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WOGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WOGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WOGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WOGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WOHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WOHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WOHGVL           Transload Termi
     C                     Z-ADD*ZERO     WOQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WOQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WOQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WOQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WOITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WOQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WOQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WOQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WOP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WOP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WOQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WOQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WOQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WOQENY           Original Appoin
     C                     Z-ADD*ZERO     WOQFNY           Original Appoin
     C                     Z-ADD*ZERO     WOQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WOQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WOQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WOQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WOW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WOW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRC4NB           Order Number
     C                     Z-ADD*ZERO     WRQ2NB           Event Number
     C                     Z-ADD*ZERO     WRAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WRQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WRD2DT           Event Date
     C                     Z-ADD*ZERO     WRAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WRQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WRQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WRBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Clear all neither parameters
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVAIC3           Company Number
     C                     Z-ADD*ZERO     WVC4NB           Order Number
     C                     Z-ADD*ZERO     WVDPNB           Order Sequence
     C                     Z-ADD*ZERO     WVUENB           Order Secondary
     C                     Z-ADD*ZERO     WVHGCD           Item Code
     C                     Z-ADD*ZERO     WVBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WVCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WVMAVA           Billing Detail
     C                     Z-ADD*ZERO     WVKDVA           Billing Detail
     C                     Z-ADD*ZERO     WVL8VA           Billing Detail
     C                     Z-ADD*ZERO     WVL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WVAYVA           Extended Amount
     C                     Z-ADD*ZERO     WVEXDT           Market Pricing
     C                     Z-ADD*ZERO     WVBZPR           Price Overage O
     C                     Z-ADD*ZERO     WVL6NB           Contract Number
     C                     Z-ADD*ZERO     WVGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WVR1NB           Rated Freight
     C                     Z-ADD*ZERO     WVAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WVD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WVCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WVAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WVCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WVATWG           Weight Shipped
     C                     Z-ADD*ZERO     WVAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WVAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WVAKPR           Unit Price
     C                     Z-ADD*ZERO     WVALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WVAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WVAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WVA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WVA5DT           Requested Ship
     C                     Z-ADD*ZERO     WVAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WVGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WVRGNB           Item Structure
     C                     Z-ADD*ZERO     WVRHNB           Item Structure
     C                     Z-ADD*ZERO     WVRINB           Item Structure
     C                     Z-ADD*ZERO     WVCXDT           Date of Origina
     C                     Z-ADD*ZERO     WVDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WVB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WVA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WVNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WVNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WVNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WVNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WVNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WVBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WVBVTM           Price Code
     C                     Z-ADD*ZERO     WVBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WVBXTM           Substitution Li
     C                     Z-ADD*ZERO     WVBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WVH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WVH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WVH7NX           OD Item Target
     C                     Z-ADD*ZERO     WVH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WVH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WVDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WVDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WVDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WVDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WVDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WVGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WVGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WVGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WVPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WVRINY           Item Age Days
     C                     Z-ADD*ZERO     WVTIDT           Production Ovr
     C                     Z-ADD*ZERO     WVTJDT           Production Ovr
     C                     Z-ADD*ZERO     WVTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WVTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WVTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYC4NB           Order Number
     C                     Z-ADD*ZERO     WYJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WYA1WG           Order Weight To
     C                     Z-ADD*ZERO     WYGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WYBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WYEMC7           Bill to Custome
     C                     Z-ADD*ZERO     WYAIC3           Company Number
     C                     Z-ADD*ZERO     WYCONB           Invoice Number
     C                     Z-ADD*ZERO     WYMJDT           Create Date
     C                     Z-ADD*ZERO     WYBETM           Create Time
     C                     Z-ADD*ZERO     WYMKDT           Change Date
     C                     Z-ADD*ZERO     WYBFTM           Change Time
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
      * Define local variables for subroutine SFCHRC.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  2
     C                     Z-ADD*ZERO     WL0010  70
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     MOVEL*BLANK    WL0013  2
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016 30
     C                     MOVEL*BLANK    WL0017 30
     C                     MOVEL*BLANK    WL0018 30
     C                     MOVEL*BLANK    WL0019 30
     C                     MOVEL*BLANK    WL0020 20
     C                     MOVEL*BLANK    WL0021  2
     C                     MOVEL*BLANK    WL0022 11
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024 30
     C                     MOVEL*BLANK    WL0025 30
     C                     MOVEL*BLANK    WL0026 30
     C                     MOVEL*BLANK    WL0027 30
     C                     MOVEL*BLANK    WL0028 20
     C                     MOVEL*BLANK    WL0029  2
     C                     MOVEL*BLANK    WL0030 11
     C                     MOVEL*BLANK    WL0031 15
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  70
     C                     MOVEL*BLANK    WL0034  2
     C                     MOVEL*BLANK    WL0035  3
     C                     Z-ADD*ZERO     WL0036 112
     C                     Z-ADD*ZERO     WL0037 112
     C                     Z-ADD*ZERO     WL0038  70
     C                     MOVEL*BLANK    WL0039  3
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  1
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0043  70
     C                     MOVEL*BLANK    WL0044 10
     C                     Z-ADD*ZERO     WL0045  30
     C                     MOVEL*BLANK    WL0046 30
     C                     MOVEL*BLANK    WL0047 50
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0048  70
     C                     MOVEL*BLANK    WL0049 10
     C                     Z-ADD*ZERO     WL0050  30
     C                     MOVEL*BLANK    WL0051 30
     C                     MOVEL*BLANK    WL0052 50
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0053  70
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055  1
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0056  30
     C                     MOVEL*BLANK    WL0057  1
     C                     MOVEL*BLANK    WL0058  1
      * Define local variables for subroutine SMCRRC.
     C                     MOVEL*BLANK    WL0059 10
     C                     Z-ADD*ZERO     WL0060  70
     C                     Z-ADD*ZERO     WL0061 112
     C                     Z-ADD*ZERO     WL0062 112
     C                     MOVEL*BLANK    WL0063 30
     C                     MOVEL*BLANK    WL0064 30
     C                     MOVEL*BLANK    WL0065  1
     C                     Z-ADD*ZERO     WL0066  70
     C                     Z-ADD*ZERO     WL0067  70
     C                     Z-ADD*ZERO     WL0068  30
     C                     Z-ADD*ZERO     WL0069  70
     C                     MOVEL*BLANK    WL0070  2
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0071  30
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  70
     C                     MOVEL*BLANK    WL0075  1
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0076  70
     C                     MOVEL*BLANK    WL0077 20
     C                     MOVEL*BLANK    WL0078  3
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0079  3
     C                     MOVEL*BLANK    WL0080 20
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0081  30
     C                     Z-ADD*ZERO     WL0082  70
     C                     Z-ADD*ZERO     WL0083  50
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0084  30
     C                     Z-ADD*ZERO     WL0085  70
     C                     MOVEL*BLANK    WL0086  2
     C                     Z-ADD*ZERO     WL0087  30
     C                     Z-ADD*ZERO     WL0088  70
     C                     MOVEL*BLANK    WL0089  2
     C                     Z-ADD*ZERO     WL0090  70
      * Define local variables for subroutine SUCRRC.
     C                     Z-ADD*ZERO     WL0091  30
     C                     Z-ADD*ZERO     WL0092  70
     C                     Z-ADD*ZERO     WL0093  50
     C                     MOVEL*BLANK    WL0094  2
     C                     Z-ADD*ZERO     WL0095  30
     C                     Z-ADD*ZERO     WL0096  70
     C                     MOVEL*BLANK    WL0097  2
     C                     Z-ADD*ZERO     WL0098  70
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  1
     C                     MOVEL*BLANK    WL0101  1
     C                     Z-ADD*ZERO     WL0102  30
     C                     Z-ADD*ZERO     WL0103  70
     C                     Z-ADD*ZERO     WL0104  50
     C                     Z-ADD*ZERO     WL0105  70
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0106  30
     C                     Z-ADD*ZERO     WL0107  70
     C                     MOVEL*BLANK    WL0108  2
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Update Exception Status
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Print Pre-Inv/Exception
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Departure Sts USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field System Value Numeric
     C                     Z-ADD*ZERO     YL0006 155
      * Define local work field Manual Prc Err Sts USR
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Projected Market Price
     C                     Z-ADD*ZERO     YL0008 114
      * Define local work field Average Ship Wgt Err USR
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field InterCo Price Err USR
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field GTIN Error Sts USR
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field GTIN Error Item Code USR
     C                     Z-ADD*ZERO     YL0013  70
      * Define null work field Item Code USR
     C                     Z-ADD*ZERO     YN0002  70
      * Define null work field Item Code
     C                     Z-ADD*ZERO     YN0003  70
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0015 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0016  7
      * Define local work field Price Overage Override
     C                     Z-ADD*ZERO     YL0017 114
      * Define local work field D-EDI INV PROC FLAG
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field One Invoice Per PO
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Order Type - Sales
     C                     MOVEL*BLANK    YL0023  2
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0024  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0025  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0026 30
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0027 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0028 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0029 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0030 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0031  2
      * Define local work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YL0032 11
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0034 30
      * Define local work field Bill to Address Line 1
     C                     MOVEL*BLANK    YL0035 30
      * Define local work field Bill to Address Line 2
     C                     MOVEL*BLANK    YL0036 30
      * Define local work field Bill to Address Line 3
     C                     MOVEL*BLANK    YL0037 30
      * Define local work field Bill to City
     C                     MOVEL*BLANK    YL0038 20
      * Define local work field Bill to State Code
     C                     MOVEL*BLANK    YL0039  2
      * Define local work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YL0040 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0041 15
      * Define local work field Order Date
     C                     Z-ADD*ZERO     YL0042  70
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0043  70
      * Define local work field Terms Code
     C                     MOVEL*BLANK    YL0044  2
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0045  3
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0046 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0047 112
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0048  70
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0049  3
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0050  70
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0051  1
      * Define local work field Fax Invoice Flag
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field Email Selection usr
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field EDI Invoice Sts
     C                     MOVEL*BLANK    YL0054  1
      * Define local work field Print Invoice Sts
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field One Invoice Per PO
     C                     MOVEL*BLANK    YL0056  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0057  1
      * Define local work field Job Name CDE
     C                     MOVEL*BLANK    YL0058 10
      * Define local work field Job Number Cde
     C                     MOVEL*BLANK    YL0059 10
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0060  70
      * Define local work field Load Plan Order
     C                     MOVEL*BLANK    YL0061  1
      * Define local work field Trailer Id
     C                     MOVEL*BLANK    YL0062 20
      * Define null work field CDD Name of Overlay
     C                     MOVEL*BLANK    YN0005  8
      * Define local work field CDD Program Name
     C                     MOVEL*BLANK    YL0063 10
      * Define null work field CDD Printer File Name
     C                     MOVEL*BLANK    YN0006 10
      * Define null work field CDD Additional Object
     C                     MOVEL*BLANK    YN0007 10
      * Define null work field CDD Sender Phone
     C                     MOVEL*BLANK    YN0008 25
      * Define null work field CDD Sender Fax
     C                     MOVEL*BLANK    YN0009 25
      * Define local work field Output Queue
     C                     MOVEL*BLANK    YL0064 10
      * Define local work field Hold File
     C                     MOVEL*BLANK    YL0065  4
      * Define local work field Save File
     C                     MOVEL*BLANK    YL0066  4
      * Define local work field Source Drawer
     C                     Z-ADD*ZERO     YL0067  30
      * Define null work field Printer Device Type
     C                     MOVEL*BLANK    YN0010 10
      * Define null work field Page Length 2
     C                     Z-ADD*ZERO     YN0011  30
      * Define null work field Page Width 2
     C                     Z-ADD*ZERO     YN0012  30
      * Define null work field Page LPI
     C                     Z-ADD*ZERO     YN0013  30
      * Define null work field Page CPI
     C                     Z-ADD*ZERO     YN0014  31
      * Define null work field Page Overflow
     C                     Z-ADD*ZERO     YN0015  30
      * Define null work field Page Rotation
     C                     MOVEL*BLANK    YN0016  5
      * Define null work field CDD Comment 1
     C                     MOVEL*BLANK    YN0017 50
      * Define null work field CDD Comment 2
     C                     MOVEL*BLANK    YN0018 50
      * Define null work field CDD Comment 3
     C                     MOVEL*BLANK    YN0019 50
      * Define null work field CDD Comment 4
     C                     MOVEL*BLANK    YN0020 50
      * Define null work field CDD Comment 5
     C                     MOVEL*BLANK    YN0021 50
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0022  1
      * Define local work field HPB COA Batch Number
     C                     Z-ADD*ZERO     YL0068  50
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0069  2
      * Define local work field Update Exception Status
     C                     MOVEL*BLANK    YL0070  1
      * Define local work field Print Pre-Inv/Exception
     C                     MOVEL*BLANK    YL0071  1
      * Define local work field Departure Sts USR
     C                     MOVEL*BLANK    YL0072  1
      * Define local work field System Value Numeric
     C                     Z-ADD*ZERO     YL0073 155
      * Define local work field Manual Prc Err Sts USR
     C                     MOVEL*BLANK    YL0074  1
      * Define local work field Projected Market Price
     C                     Z-ADD*ZERO     YL0075 114
      * Define local work field Average Ship Wgt Err USR
     C                     MOVEL*BLANK    YL0076  1
      * Define local work field InterCo Price Err USR
     C                     MOVEL*BLANK    YL0077  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0078  1
      * Define local work field GTIN Error Sts USR
     C                     MOVEL*BLANK    YL0079  1
      * Define local work field GTIN Error Item Code USR
     C                     Z-ADD*ZERO     YL0080  70
      * Define null work field Item Code USR
     C                     Z-ADD*ZERO     YN0023  70
      * Define null work field Item Code
     C                     Z-ADD*ZERO     YN0024  70
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0081  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0082 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0083  7
      * Define local work field Price Overage Override
     C                     Z-ADD*ZERO     YL0084 114
      * Define local work field D-EDI INV PROC FLAG
     C                     MOVEL*BLANK    YL0085  1
      * Define local work field One Invoice Per PO
     C                     MOVEL*BLANK    YL0086  1
      * Define local work field Job Name CDE
     C                     MOVEL*BLANK    YL0087 10
      * Define local work field Job Number Cde
     C                     MOVEL*BLANK    YL0088 10
      * Define local work field Break
     C                     MOVEL*BLANK    YL0089  1
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0090  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0091  70
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0092 15
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0093  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0025  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0094  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0026  70
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0095  70
      * Define local work field Load Plan Order
     C                     MOVEL*BLANK    YL0096  1
      * Define local work field Trailer Id
     C                     MOVEL*BLANK    YL0097 20
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0098  3
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 AR-INVOICE
00002 Invoice Exception Report
