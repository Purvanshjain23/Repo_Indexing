     H/TITLE Prt Pick List-NoLdDLY PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/24/11  Time  : 09:28:29
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPLQIF  E           K        DISK
      * RSQ : Order Header TRG          Co.,Order,Cust. - Sel Pi
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBGWKM1IF  E           K        DISK
      * RSQ : Order Detail              Co/Ord/IST/ISG/ISC DS<>X
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FOPCPCPL1IF  E           K        DISK
      * RTV : Order Detail Comment      Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country                   Retrieval index
      *
     FOPCOCPL1IF  E           K        DISK
      * RTV : Order Comment             Retrieval index       NV
      *
     FPNV0PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Pick List-NoLdDLY PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UAD         6 34               Name/Address
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@BGWKPA
      * Order Detail              Co/Ord/IST/ISG/ISC DS<>X
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Load ID
     I                                    P   1   40P1RMNB
     IP2PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P2AIC3
      * I : RST Order Number
     I                                    P   3   60P2C4NB
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P2AIC3    PARM           WP0002  30       Company Number
     C           P2C4NB    PARM           WP0003  70       Order Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Pick List-NoLdDLY PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$SENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Pick List-NoLdDLY PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEAIC3    WQKA01           Company Number
     C           *LIKE     DEFN BEC4NB    WQKA02           Order Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
     C                     KFLD           WQKA02           Order Number
      * Setup key
     C                     Z-ADDP2AIC3    WQKA01           Company Number
     C                     Z-ADDP2C4NB    WQKA02           Order Number
      * Establish starting position
     C           KRSA      SETLL@BFCPY8                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Order Number
     C                     MOVEL'Y'       W0AL02  1        Ship To Custome
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $RCDWG           USR Weight Accu
     C                     Z-ADD*ZERO     $RA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     $RWUNB           USR Weight Bill
     C                     Z-ADD*ZERO     $RFVQT           USR Quantity Ac
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBEAIC3    $DAIC3           Company Number
     C                     Z-ADDBEC4NB    $DC4NB           Order Number
     C                     MOVELBEJNCD    $DJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $DANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $DBKC7           Ship To Custome
     C                     MOVELBEHMNA    $DHMNA           Ship To Address
     C                     MOVELBEHONA    $DHONA           Ship To Address
     C                     MOVELBEHPNA    $DHPNA           Ship To Address
     C                     MOVELBEHNNA    $DHNNA           Ship To City
     C                     MOVELBEDBCD    $DDBCD           Ship To State C
     C                     MOVELBECKTX    $DCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $DB0C7           Bill to Custome
     C                     MOVELBEAETX    $DAETX           Bill to Name
     C                     MOVELBEB1NA    $DB1NA           Bill to Address
     C                     MOVELBEB3NA    $DB3NA           Bill to Address
     C                     MOVELBEB4NA    $DB4NA           Bill to Address
     C                     MOVELBEB2NA    $DB2NA           Bill to City
     C                     MOVELBEBHCD    $DBHCD           Bill to State C
     C                     MOVELBEC8TX    $DC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $DBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $DA0DT           Order Date
     C                     Z-ADDBEA5DT    $DA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $DGNDT           Actual Shipped
     C                     Z-ADDBEACDT    $DACDT           Cancel Date
     C                     MOVELBEAQCD    $DAQCD           Terms Code
     C                     MOVELBEB6NA    $DB6NA           Special Instruc
     C                     MOVELBEBYNA    $DBYNA           Special Instruc
     C                     MOVELBEBZNA    $DBZNA           Carrier Code
     C                     MOVELBEGTST    $DGTST           Comment Print A
     C                     MOVELBEGVST    $DGVST           Comment Print I
     C                     MOVELBEGUST    $DGUST           Comment Print P
     C                     MOVELBEQFST    $DQFST           Comment Print S
     C                     MOVELBECQCD    $DCQCD           Reason Code
     C                     MOVELBEGJST    $DGJST           Order in Use
     C                     MOVELBEGWST    $DGWST           Header Status
     C                     MOVELBEGXST    $DGXST           Header Status L
     C                     MOVELBEGYST    $DGYST           Order Type Prin
     C                     Z-ADDBEAODT    $DAODT           Scheduled Ship
     C                     MOVELBEAIVN    $DAIVN           User Original E
     C                     Z-ADDBECXDT    $DCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $DJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $DA1WG           Order Weight To
     C                     MOVELBEXIST    $DXIST           Credit Hold
     C                     MOVELBEXJST    $DXJST           Production Hold
     C                     MOVELBEXKST    $DXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $DEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $DAFTM           Requested Deliv
     C                     MOVELBEE8CD    $DE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $DE9CD           Accounts Receiv
     C                     Z-ADDBERMNB    $DRMNB           Load ID
     C                     Z-ADDBETBNB    $DTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $DR1NB           Rated Freight
     C                     MOVELBEPJST    $DPJST           LTL Flag
     C                     MOVELBEU0ST    $DU0ST           Price Audit
     C                     MOVELBEU1ST    $DU1ST           Price Status
     C                     MOVELBEQ2CD    $DQ2CD           Shipping Method
     C                     MOVEL*BLANK    $DAJCD           Warehouse Code
     C                     MOVELBEBRTX    $DBRTX           Ship To Name
     C                     MOVELBEU2ST    $DU2ST           Export Status
     C                     MOVELBEVEST    $DVEST           Palletize
     C                     MOVELBEVFST    $DVFST           Shrink Wrap
     C                     MOVELBEVGST    $DVGST           Slip Sheet
     C                     MOVELBERPCD    $DRPCD           Age Code
     C                     Z-ADDBERNNB    $DRNNB           Reefer Temperat
     C                     MOVELBEVDST    $DVDST           Load Type
     C                     Z-ADDBEATIN    $DATIN           Attach to Invoi
     C                     MOVELBEU4ST    $DU4ST           Load Plan Order
     C                     MOVELBEU5ST    $DU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $DRSRN           Resell Referenc
     C                     MOVELBEMHNA    $DMHNA           Special Comment
     C                     MOVELBEMINA    $DMINA           Special Comment
     C                     MOVELBEWBST    $DWBST           Affect Auto Acc
     C                     MOVELBER4CD    $DR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $DBFCD           Manager Level C
     C                     MOVELBEQ4CD    $DQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $DT3NB           Attach to Order
     C                     MOVELBESICD    $DSICD           Reason for Pric
     C                     Z-ADDBECONB    $DCONB           Invoice Number
     C                     MOVELBECEST    $DCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $DAWDT           Invoice Date
     C                     MOVELBEJPCD    $DJPCD           Event Code
     C                     MOVELBEXUST    $DXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $DZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $DVRVA           A/R order Value
     C                     MOVELBEOBST    $DOBST           Billing Activit
     C                     MOVELBEBCST    $DBCST           Block Order Fla
     C                     MOVELBEBDST    $DBDST           Order Certifica
     C                     Z-ADDBEB7VL    $DB7VL           Invoice Order V
     C                     MOVELBEGASX    $DGASX           Invoice Price T
     C                     MOVELBEGBSX    $DGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $DGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $DGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $DFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $DFOSX           Email Cust On O
     C                     MOVELBEFPSX    $DFPSX           Order Emailed
     C                     MOVELBEFQSX    $DFQSX           Export Docs Go
     C                     MOVELBEFRSX    $DFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $DFSSX           Broker Order St
     C                     MOVELBEFTSX    $DFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $DFUSX           Signal Demand S
     C                     MOVELBEFVSX    $DFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $DFWSX           Export USDA App
     C                     MOVELBEFXSX    $DFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $DFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $DNODT           OH Unused Date
     C                     Z-ADDBENPDT    $DNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $DNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $DNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $DNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $DBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $DBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $DBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $DBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $DBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $DH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $DH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $DH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $DH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $DH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $DC0C7           Claim Number
     C                     MOVELBEUVST    $DUVST           EDI Status 1
     C                     MOVELBEUWST    $DUWST           EDI Status 2
     C                     MOVELBEUXST    $DUXST           EDI Status 3
     C                     Z-ADDBEAATM    $DAATM           Job Time
     C                     MOVELBEAYNA    $DAYNA           User Id
     C                     MOVELBEA0NA    $DA0NA           Job Name
     C                     Z-ADDBEAXDT    $DAXDT           Job Date
      * Load related totals format
     C                     Z-ADDBEAIC3    $NAIC3           Company Number
     C                     Z-ADDBEC4NB    $NC4NB           Order Number
     C                     MOVELBEJNCD    $NJNCD           Order Type - Sa
     C                     Z-ADDBEBKC7    $NBKC7           Ship To Custome
     C                     MOVELBEBCNA    $NBCNA           Customer Purcha
     C                     MOVEL*BLANK    $NGNNA           USR Compressed
     C                     MOVELBER4CD    $NR4CD           Sales Route Cod
     C                     MOVEL*BLANK    $NMZNA           Sales Route Des
     C                     MOVEL*BLANK    $NGONA           USR Compressed
     C                     MOVEL*BLANK    $NGPNA           USR Compressed
     C                     MOVEL*BLANK    $NGQNA           USR Compressed
     C                     MOVEL*BLANK    $NGRNA           USR Compressed
     C                     MOVEL*BLANK    $NNWNA           USR Compressed
     C                     MOVEL*BLANK    $NCDTX           USR Telephone C
     C                     MOVELBEBRTX    $NBRTX           Ship To Name
     C                     MOVELBEHMNA    $NHMNA           Ship To Address
     C                     MOVELBEHONA    $NHONA           Ship To Address
     C                     MOVELBEHPNA    $NHPNA           Ship To Address
     C                     MOVELBEHNNA    $NHNNA           Ship To City
     C                     MOVELBEDBCD    $NDBCD           Ship To State C
     C                     MOVELBECKTX    $NCKTX           Ship To Zip/Pos
     C                     Z-ADDBEANC7    $NANC7           A/R Customer Nu
     C                     Z-ADDBEB0C7    $NB0C7           Bill to Custome
     C                     MOVELBEAETX    $NAETX           Bill to Name
     C                     MOVELBEB1NA    $NB1NA           Bill to Address
     C                     MOVELBEB3NA    $NB3NA           Bill to Address
     C                     MOVELBEB4NA    $NB4NA           Bill to Address
     C                     MOVELBEB2NA    $NB2NA           Bill to City
     C                     MOVELBEBHCD    $NBHCD           Bill to State C
     C                     MOVELBEC8TX    $NC8TX           Bill to Zip/Pos
     C                     Z-ADDBEA0DT    $NA0DT           Order Date
     C                     Z-ADDBEA5DT    $NA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $NGNDT           Actual Shipped
     C                     Z-ADDBEACDT    $NACDT           Cancel Date
     C                     MOVELBEAQCD    $NAQCD           Terms Code
     C                     MOVELBEB6NA    $NB6NA           Special Instruc
     C                     MOVELBEBYNA    $NBYNA           Special Instruc
     C                     MOVELBEBZNA    $NBZNA           Carrier Code
     C                     MOVELBEGTST    $NGTST           Comment Print A
     C                     MOVELBEGVST    $NGVST           Comment Print I
     C                     MOVELBEGUST    $NGUST           Comment Print P
     C                     MOVELBEQFST    $NQFST           Comment Print S
     C                     MOVELBECQCD    $NCQCD           Reason Code
     C                     MOVELBEGJST    $NGJST           Order in Use
     C                     MOVELBEGWST    $NGWST           Header Status
     C                     MOVELBEGXST    $NGXST           Header Status L
     C                     MOVELBEGYST    $NGYST           Order Type Prin
     C                     Z-ADDBEAODT    $NAODT           Scheduled Ship
     C                     MOVELBEAIVN    $NAIVN           User Original E
     C                     Z-ADDBECXDT    $NCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $NJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $NA1WG           Order Weight To
     C                     MOVELBEXIST    $NXIST           Credit Hold
     C                     MOVELBEXJST    $NXJST           Production Hold
     C                     MOVELBEXKST    $NXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $NEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $NAFTM           Requested Deliv
     C                     MOVELBEE8CD    $NE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $NE9CD           Accounts Receiv
     C                     Z-ADDBERMNB    $NRMNB           Load ID
     C                     Z-ADDBETBNB    $NTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $NR1NB           Rated Freight
     C                     MOVELBEPJST    $NPJST           LTL Flag
     C                     MOVELBEU0ST    $NU0ST           Price Audit
     C                     MOVELBEU1ST    $NU1ST           Price Status
     C                     MOVELBEQ2CD    $NQ2CD           Shipping Method
     C                     MOVELBEU2ST    $NU2ST           Export Status
     C                     MOVELBEVEST    $NVEST           Palletize
     C                     MOVELBEVFST    $NVFST           Shrink Wrap
     C                     MOVELBEVGST    $NVGST           Slip Sheet
     C                     MOVELBERPCD    $NRPCD           Age Code
     C                     Z-ADDBERNNB    $NRNNB           Reefer Temperat
     C                     MOVELBEVDST    $NVDST           Load Type
     C                     Z-ADDBEATIN    $NATIN           Attach to Invoi
     C                     MOVELBEU4ST    $NU4ST           Load Plan Order
     C                     MOVELBEU5ST    $NU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $NRSRN           Resell Referenc
     C                     MOVELBEMHNA    $NMHNA           Special Comment
     C                     MOVELBEMINA    $NMINA           Special Comment
     C                     MOVELBEWBST    $NWBST           Affect Auto Acc
     C                     MOVELBEBFCD    $NBFCD           Manager Level C
     C                     MOVELBEQ4CD    $NQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $NT3NB           Attach to Order
     C                     MOVELBESICD    $NSICD           Reason for Pric
     C                     Z-ADDBECONB    $NCONB           Invoice Number
     C                     MOVELBECEST    $NCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $NAWDT           Invoice Date
     C                     MOVELBEJPCD    $NJPCD           Event Code
     C                     MOVELBEXUST    $NXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $NZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $NVRVA           A/R order Value
     C                     MOVELBEOBST    $NOBST           Billing Activit
     C                     MOVELBEBCST    $NBCST           Block Order Fla
     C                     MOVELBEBDST    $NBDST           Order Certifica
     C                     Z-ADDBEB7VL    $NB7VL           Invoice Order V
     C                     MOVELBEGASX    $NGASX           Invoice Price T
     C                     MOVELBEGBSX    $NGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $NGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $NGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $NFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $NFOSX           Email Cust On O
     C                     MOVELBEFPSX    $NFPSX           Order Emailed
     C                     MOVELBEFQSX    $NFQSX           Export Docs Go
     C                     MOVELBEFRSX    $NFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $NFSSX           Broker Order St
     C                     MOVELBEFTSX    $NFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $NFUSX           Signal Demand S
     C                     MOVELBEFVSX    $NFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $NFWSX           Export USDA App
     C                     MOVELBEFXSX    $NFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $NFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $NNODT           OH Unused Date
     C                     Z-ADDBENPDT    $NNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $NNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $NNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $NNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $NBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $NBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $NBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $NBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $NBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $NH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $NH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $NH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $NH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $NH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $NC0C7           Claim Number
     C                     MOVELBEUVST    $NUVST           EDI Status 1
     C                     MOVELBEUWST    $NUWST           EDI Status 2
     C                     MOVELBEUXST    $NUXST           EDI Status 3
     C                     Z-ADDBEAATM    $NAATM           Job Time
     C                     MOVELBEAYNA    $NAYNA           User Id
     C                     MOVELBEA0NA    $NA0NA           Job Name
     C                     Z-ADDBEAXDT    $NAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBEAIC3    $EAIC3           Company Number
     C                     Z-ADDBEC4NB    $EC4NB           Order Number
     C                     MOVELBEJNCD    $EJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $EANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $EBKC7           Ship To Custome
     C                     MOVELBEBRTX    $EBRTX           Ship To Name
     C                     MOVELBEHMNA    $EHMNA           Ship To Address
     C                     MOVELBEHONA    $EHONA           Ship To Address
     C                     MOVELBEHPNA    $EHPNA           Ship To Address
     C                     MOVELBEHNNA    $EHNNA           Ship To City
     C                     MOVELBEDBCD    $EDBCD           Ship To State C
     C                     MOVELBECKTX    $ECKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $EB0C7           Bill to Custome
     C                     MOVELBEAETX    $EAETX           Bill to Name
     C                     MOVELBEB1NA    $EB1NA           Bill to Address
     C                     MOVELBEB3NA    $EB3NA           Bill to Address
     C                     MOVELBEB4NA    $EB4NA           Bill to Address
     C                     MOVELBEB2NA    $EB2NA           Bill to City
     C                     MOVELBEBHCD    $EBHCD           Bill to State C
     C                     MOVELBEC8TX    $EC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $EBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $EA0DT           Order Date
     C                     Z-ADDBEA5DT    $EA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $EGNDT           Actual Shipped
     C                     Z-ADDBEACDT    $EACDT           Cancel Date
     C                     MOVELBEAQCD    $EAQCD           Terms Code
     C                     MOVELBEB6NA    $EB6NA           Special Instruc
     C                     MOVELBEBYNA    $EBYNA           Special Instruc
     C                     MOVELBEBZNA    $EBZNA           Carrier Code
     C                     MOVELBEGTST    $EGTST           Comment Print A
     C                     MOVELBEGVST    $EGVST           Comment Print I
     C                     MOVELBEGUST    $EGUST           Comment Print P
     C                     MOVELBEQFST    $EQFST           Comment Print S
     C                     MOVELBECQCD    $ECQCD           Reason Code
     C                     MOVELBEGJST    $EGJST           Order in Use
     C                     MOVELBEGWST    $EGWST           Header Status
     C                     MOVELBEGXST    $EGXST           Header Status L
     C                     MOVELBEGYST    $EGYST           Order Type Prin
     C                     Z-ADDBEAODT    $EAODT           Scheduled Ship
     C                     MOVELBEAIVN    $EAIVN           User Original E
     C                     Z-ADDBECXDT    $ECXDT           Date of Origina
     C                     Z-ADDBEJZVA    $EJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $EA1WG           Order Weight To
     C                     MOVELBEXIST    $EXIST           Credit Hold
     C                     MOVELBEXJST    $EXJST           Production Hold
     C                     MOVELBEXKST    $EXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $EEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $EAFTM           Requested Deliv
     C                     MOVELBEE8CD    $EE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $EE9CD           Accounts Receiv
     C                     Z-ADDBERMNB    $ERMNB           Load ID
     C                     Z-ADDBETBNB    $ETBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $ER1NB           Rated Freight
     C                     MOVELBEPJST    $EPJST           LTL Flag
     C                     MOVELBEU0ST    $EU0ST           Price Audit
     C                     MOVELBEU1ST    $EU1ST           Price Status
     C                     MOVELBEQ2CD    $EQ2CD           Shipping Method
     C                     MOVELBEU2ST    $EU2ST           Export Status
     C                     MOVELBEVEST    $EVEST           Palletize
     C                     MOVELBEVFST    $EVFST           Shrink Wrap
     C                     MOVELBEVGST    $EVGST           Slip Sheet
     C                     MOVELBERPCD    $ERPCD           Age Code
     C                     Z-ADDBERNNB    $ERNNB           Reefer Temperat
     C                     MOVELBEVDST    $EVDST           Load Type
     C                     Z-ADDBEATIN    $EATIN           Attach to Invoi
     C                     MOVELBEU4ST    $EU4ST           Load Plan Order
     C                     MOVELBEU5ST    $EU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $ERSRN           Resell Referenc
     C                     MOVELBEMHNA    $EMHNA           Special Comment
     C                     MOVELBEMINA    $EMINA           Special Comment
     C                     MOVELBEWBST    $EWBST           Affect Auto Acc
     C                     MOVELBER4CD    $ER4CD           Sales Route Cod
     C                     MOVELBEBFCD    $EBFCD           Manager Level C
     C                     MOVELBEQ4CD    $EQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $ET3NB           Attach to Order
     C                     MOVELBESICD    $ESICD           Reason for Pric
     C                     Z-ADDBECONB    $ECONB           Invoice Number
     C                     MOVELBECEST    $ECEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $EAWDT           Invoice Date
     C                     MOVELBEJPCD    $EJPCD           Event Code
     C                     MOVELBEXUST    $EXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $EZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $EVRVA           A/R order Value
     C                     MOVELBEOBST    $EOBST           Billing Activit
     C                     MOVELBEBCST    $EBCST           Block Order Fla
     C                     MOVELBEBDST    $EBDST           Order Certifica
     C                     Z-ADDBEB7VL    $EB7VL           Invoice Order V
     C                     MOVELBEGASX    $EGASX           Invoice Price T
     C                     MOVELBEGBSX    $EGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $EGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $EGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $EFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $EFOSX           Email Cust On O
     C                     MOVELBEFPSX    $EFPSX           Order Emailed
     C                     MOVELBEFQSX    $EFQSX           Export Docs Go
     C                     MOVELBEFRSX    $EFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $EFSSX           Broker Order St
     C                     MOVELBEFTSX    $EFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $EFUSX           Signal Demand S
     C                     MOVELBEFVSX    $EFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $EFWSX           Export USDA App
     C                     MOVELBEFXSX    $EFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $EFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $ENODT           OH Unused Date
     C                     Z-ADDBENPDT    $ENPDT           OH Unused Date
     C                     Z-ADDBENQDT    $ENQDT           OH Unused Date
     C                     Z-ADDBENRDT    $ENRDT           OH Unused Date
     C                     Z-ADDBENSDT    $ENSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $EBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $EBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $EBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $EBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $EBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $EH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $EH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $EH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $EH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $EH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $EC0C7           Claim Number
     C                     MOVELBEUVST    $EUVST           EDI Status 1
     C                     MOVELBEUWST    $EUWST           EDI Status 2
     C                     MOVELBEUXST    $EUXST           EDI Status 3
     C                     Z-ADDBEAATM    $EAATM           Job Time
     C                     MOVELBEAYNA    $EAYNA           User Id
     C                     MOVELBEA0NA    $EA0NA           Job Name
     C                     Z-ADDBEAXDT    $EAXDT           Job Date
      * Load related totals format
     C                     Z-ADDBEAIC3    $MAIC3           Company Number
     C                     Z-ADDBEC4NB    $MC4NB           Order Number
     C                     MOVELBEJNCD    $MJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $MANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $MBKC7           Ship To Custome
     C                     MOVELBEBRTX    $MBRTX           Ship To Name
     C                     MOVELBEHMNA    $MHMNA           Ship To Address
     C                     MOVELBEHONA    $MHONA           Ship To Address
     C                     MOVELBEHPNA    $MHPNA           Ship To Address
     C                     MOVELBEHNNA    $MHNNA           Ship To City
     C                     MOVELBEDBCD    $MDBCD           Ship To State C
     C                     MOVELBECKTX    $MCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $MB0C7           Bill to Custome
     C                     MOVELBEAETX    $MAETX           Bill to Name
     C                     MOVELBEB1NA    $MB1NA           Bill to Address
     C                     MOVELBEB3NA    $MB3NA           Bill to Address
     C                     MOVELBEB4NA    $MB4NA           Bill to Address
     C                     MOVELBEB2NA    $MB2NA           Bill to City
     C                     MOVELBEBHCD    $MBHCD           Bill to State C
     C                     MOVELBEC8TX    $MC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $MBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $MA0DT           Order Date
     C                     Z-ADDBEA5DT    $MA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $MGNDT           Actual Shipped
     C                     Z-ADDBEACDT    $MACDT           Cancel Date
     C                     MOVELBEAQCD    $MAQCD           Terms Code
     C                     MOVELBEB6NA    $MB6NA           Special Instruc
     C                     MOVELBEBYNA    $MBYNA           Special Instruc
     C                     MOVELBEBZNA    $MBZNA           Carrier Code
     C                     MOVELBEGTST    $MGTST           Comment Print A
     C                     MOVELBEGVST    $MGVST           Comment Print I
     C                     MOVELBEGUST    $MGUST           Comment Print P
     C                     MOVELBEQFST    $MQFST           Comment Print S
     C                     MOVELBECQCD    $MCQCD           Reason Code
     C                     MOVELBEGJST    $MGJST           Order in Use
     C                     MOVELBEGWST    $MGWST           Header Status
     C                     MOVELBEGXST    $MGXST           Header Status L
     C                     MOVELBEGYST    $MGYST           Order Type Prin
     C                     Z-ADDBEAODT    $MAODT           Scheduled Ship
     C                     MOVELBEAIVN    $MAIVN           User Original E
     C                     Z-ADDBECXDT    $MCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $MJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $MA1WG           Order Weight To
     C                     MOVELBEXIST    $MXIST           Credit Hold
     C                     MOVELBEXJST    $MXJST           Production Hold
     C                     MOVELBEXKST    $MXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $MEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $MAFTM           Requested Deliv
     C                     MOVELBEE8CD    $ME8CD           Accounts Receiv
     C                     MOVELBEE9CD    $ME9CD           Accounts Receiv
     C                     Z-ADDBERMNB    $MRMNB           Load ID
     C                     Z-ADDBETBNB    $MTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $MR1NB           Rated Freight
     C                     MOVELBEPJST    $MPJST           LTL Flag
     C                     MOVELBEU0ST    $MU0ST           Price Audit
     C                     MOVELBEU1ST    $MU1ST           Price Status
     C                     MOVELBEQ2CD    $MQ2CD           Shipping Method
     C                     MOVELBEU2ST    $MU2ST           Export Status
     C                     MOVELBEVEST    $MVEST           Palletize
     C                     MOVELBEVFST    $MVFST           Shrink Wrap
     C                     MOVELBEVGST    $MVGST           Slip Sheet
     C                     MOVELBERPCD    $MRPCD           Age Code
     C                     Z-ADDBERNNB    $MRNNB           Reefer Temperat
     C                     MOVELBEVDST    $MVDST           Load Type
     C                     Z-ADDBEATIN    $MATIN           Attach to Invoi
     C                     MOVELBEU4ST    $MU4ST           Load Plan Order
     C                     MOVELBEU5ST    $MU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $MRSRN           Resell Referenc
     C                     MOVELBEMHNA    $MMHNA           Special Comment
     C                     MOVELBEMINA    $MMINA           Special Comment
     C                     MOVELBEWBST    $MWBST           Affect Auto Acc
     C                     MOVELBER4CD    $MR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $MBFCD           Manager Level C
     C                     MOVELBEQ4CD    $MQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $MT3NB           Attach to Order
     C                     MOVELBESICD    $MSICD           Reason for Pric
     C                     Z-ADDBECONB    $MCONB           Invoice Number
     C                     MOVELBECEST    $MCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $MAWDT           Invoice Date
     C                     MOVELBEJPCD    $MJPCD           Event Code
     C                     MOVELBEXUST    $MXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $MZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $MVRVA           A/R order Value
     C                     MOVELBEOBST    $MOBST           Billing Activit
     C                     MOVELBEBCST    $MBCST           Block Order Fla
     C                     MOVELBEBDST    $MBDST           Order Certifica
     C                     Z-ADDBEB7VL    $MB7VL           Invoice Order V
     C                     MOVELBEGASX    $MGASX           Invoice Price T
     C                     MOVELBEGBSX    $MGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $MGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $MGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $MFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $MFOSX           Email Cust On O
     C                     MOVELBEFPSX    $MFPSX           Order Emailed
     C                     MOVELBEFQSX    $MFQSX           Export Docs Go
     C                     MOVELBEFRSX    $MFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $MFSSX           Broker Order St
     C                     MOVELBEFTSX    $MFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $MFUSX           Signal Demand S
     C                     MOVELBEFVSX    $MFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $MFWSX           Export USDA App
     C                     MOVELBEFXSX    $MFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $MFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $MNODT           OH Unused Date
     C                     Z-ADDBENPDT    $MNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $MNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $MNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $MNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $MBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $MBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $MBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $MBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $MBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $MH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $MH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $MH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $MH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $MH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $MC0C7           Claim Number
     C                     MOVELBEUVST    $MUVST           EDI Status 1
     C                     MOVELBEUWST    $MUWST           EDI Status 2
     C                     MOVELBEUXST    $MUXST           EDI Status 3
     C                     Z-ADDBEAATM    $MAATM           Job Time
     C                     MOVELBEAYNA    $MAYNA           User Id
     C                     MOVELBEA0NA    $MA0NA           Job Name
     C                     Z-ADDBEAXDT    $MAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBEAIC3    $FAIC3           Company Number
     C                     Z-ADDBEC4NB    $FC4NB           Order Number
     C                     MOVELBEJNCD    $FJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $FANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $FBKC7           Ship To Custome
     C                     MOVELBEBRTX    $FBRTX           Ship To Name
     C                     MOVELBEHMNA    $FHMNA           Ship To Address
     C                     MOVELBEHONA    $FHONA           Ship To Address
     C                     MOVELBEHPNA    $FHPNA           Ship To Address
     C                     MOVELBEHNNA    $FHNNA           Ship To City
     C                     MOVELBEDBCD    $FDBCD           Ship To State C
     C                     MOVELBECKTX    $FCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $FB0C7           Bill to Custome
     C                     MOVELBEAETX    $FAETX           Bill to Name
     C                     MOVELBEB1NA    $FB1NA           Bill to Address
     C                     MOVELBEB3NA    $FB3NA           Bill to Address
     C                     MOVELBEB4NA    $FB4NA           Bill to Address
     C                     MOVELBEB2NA    $FB2NA           Bill to City
     C                     MOVELBEBHCD    $FBHCD           Bill to State C
     C                     MOVELBEC8TX    $FC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $FBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $FA0DT           Order Date
     C                     Z-ADDBEA5DT    $FA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $FGNDT           Actual Shipped
     C                     Z-ADDBEACDT    $FACDT           Cancel Date
     C                     MOVELBEAQCD    $FAQCD           Terms Code
     C                     MOVELBEB6NA    $FB6NA           Special Instruc
     C                     MOVELBEBYNA    $FBYNA           Special Instruc
     C                     MOVELBEBZNA    $FBZNA           Carrier Code
     C                     MOVELBEGTST    $FGTST           Comment Print A
     C                     MOVELBEGVST    $FGVST           Comment Print I
     C                     MOVELBEGUST    $FGUST           Comment Print P
     C                     MOVELBEQFST    $FQFST           Comment Print S
     C                     MOVELBECQCD    $FCQCD           Reason Code
     C                     MOVELBEGJST    $FGJST           Order in Use
     C                     MOVELBEGWST    $FGWST           Header Status
     C                     MOVELBEGXST    $FGXST           Header Status L
     C                     MOVELBEGYST    $FGYST           Order Type Prin
     C                     Z-ADDBEAODT    $FAODT           Scheduled Ship
     C                     MOVELBEAIVN    $FAIVN           User Original E
     C                     Z-ADDBECXDT    $FCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $FJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $FA1WG           Order Weight To
     C                     MOVELBEXIST    $FXIST           Credit Hold
     C                     MOVELBEXJST    $FXJST           Production Hold
     C                     MOVELBEXKST    $FXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $FEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $FAFTM           Requested Deliv
     C                     MOVELBEE8CD    $FE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $FE9CD           Accounts Receiv
     C                     Z-ADDBERMNB    $FRMNB           Load ID
     C                     Z-ADDBETBNB    $FTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $FR1NB           Rated Freight
     C                     MOVELBEPJST    $FPJST           LTL Flag
     C                     MOVELBEU0ST    $FU0ST           Price Audit
     C                     MOVELBEU1ST    $FU1ST           Price Status
     C                     MOVELBEQ2CD    $FQ2CD           Shipping Method
     C                     MOVELBEU2ST    $FU2ST           Export Status
     C                     MOVELBEVEST    $FVEST           Palletize
     C                     MOVELBEVFST    $FVFST           Shrink Wrap
     C                     MOVELBEVGST    $FVGST           Slip Sheet
     C                     MOVELBERPCD    $FRPCD           Age Code
     C                     Z-ADDBERNNB    $FRNNB           Reefer Temperat
     C                     MOVELBEVDST    $FVDST           Load Type
     C                     Z-ADDBEATIN    $FATIN           Attach to Invoi
     C                     MOVELBEU4ST    $FU4ST           Load Plan Order
     C                     MOVELBEU5ST    $FU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $FRSRN           Resell Referenc
     C                     MOVELBEMHNA    $FMHNA           Special Comment
     C                     MOVELBEMINA    $FMINA           Special Comment
     C                     MOVELBEWBST    $FWBST           Affect Auto Acc
     C                     MOVELBER4CD    $FR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $FBFCD           Manager Level C
     C                     MOVELBEQ4CD    $FQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $FT3NB           Attach to Order
     C                     MOVELBESICD    $FSICD           Reason for Pric
     C                     Z-ADDBECONB    $FCONB           Invoice Number
     C                     MOVELBECEST    $FCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $FAWDT           Invoice Date
     C                     MOVELBEJPCD    $FJPCD           Event Code
     C                     MOVELBEXUST    $FXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $FZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $FVRVA           A/R order Value
     C                     MOVELBEOBST    $FOBST           Billing Activit
     C                     MOVELBEBCST    $FBCST           Block Order Fla
     C                     MOVELBEBDST    $FBDST           Order Certifica
     C                     Z-ADDBEB7VL    $FB7VL           Invoice Order V
     C                     MOVELBEGASX    $FGASX           Invoice Price T
     C                     MOVELBEGBSX    $FGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $FGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $FGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $FFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $FFOSX           Email Cust On O
     C                     MOVELBEFPSX    $FFPSX           Order Emailed
     C                     MOVELBEFQSX    $FFQSX           Export Docs Go
     C                     MOVELBEFRSX    $FFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $FFSSX           Broker Order St
     C                     MOVELBEFTSX    $FFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $FFUSX           Signal Demand S
     C                     MOVELBEFVSX    $FFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $FFWSX           Export USDA App
     C                     MOVELBEFXSX    $FFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $FFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $FNODT           OH Unused Date
     C                     Z-ADDBENPDT    $FNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $FNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $FNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $FNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $FBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $FBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $FBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $FBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $FBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $FH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $FH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $FH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $FH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $FH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $FC0C7           Claim Number
     C                     MOVELBEUVST    $FUVST           EDI Status 1
     C                     MOVELBEUWST    $FUWST           EDI Status 2
     C                     MOVELBEUXST    $FUXST           EDI Status 3
     C                     Z-ADDBEAATM    $FAATM           Job Time
     C                     MOVELBEAYNA    $FAYNA           User Id
     C                     MOVELBEA0NA    $FA0NA           Job Name
     C                     Z-ADDBEAXDT    $FAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Pick Slip Daily's  PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BEAIC3    WZA001           Company Number
     C                     Z-ADDBEAIC3    WZA001
     C           *LIKE     DEFN BEC4NB    WZA002           Order Number
     C                     Z-ADDBEC4NB    WZA002
     C           *LIKE     DEFN BEBKC7    WZA003           Ship To Custome
     C                     Z-ADDBEBKC7    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@BFCPY8                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Order Number
     C                     MOVEL*BLANK    W0AL02  1        Ship To Custome
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Order Number
     C                     MOVEL'Y'       W0AL02  1        Ship To Custome
     C                     ELSE
      * Next record - Detect level breaks
     C           BEAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           BEC4NB    IFNE WZA002                     Order Number
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           BEBKC7    IFNE WZA003                     Ship To Custome
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$MKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
      * RTV Customer Telephone RT - Customer  * 
     C                     EXSR SHRVGN
      * RTV Country Code       RT - Customer  * 
     C                     EXSR SIRVGN
      * RTV Description        RT - Sales Route  * 
     C                     EXSR SJRVGN
      * Print country if not USA
      * CASE: WRK.Country Code is USA
     C           WUKXCD    IFEQ 'USA'                      *IF
     C                     MOVEL'N'       WUD4ST           USR Flag 1
      * ** Clear country description if USA           05/10/2007
     C                     MOVEL*BLANK    WUDATX           Country Descrip
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUD4ST           USR Flag 1
      * RTV Desc, Status       RT - Country  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     MOVEL$NBRTX    WUADTX           Name
     C                     MOVEL$NHMNA    WUACNA           Address Line 1
     C                     MOVEL$NHONA    WUADNA           Address Line 2
     C                     MOVEL$NHPNA    WUAENA           Address Line 3
     C                     MOVEL$NHNNA    WUAJNA           City
     C                     MOVEL$NDBCD    WUEINA           State
     C                     MOVEL$NCKTX    WUBTTX           Zip/Postal Code
      * RTV Comprs Nme/Add/CtryUS - /UT User Source  * Ship To Address
      * Use this function to compress name/address information
      *
     C                     MOVELWUADTX    UUADTX           Name
     C                     MOVELWUACNA    UUACNA           Address 1
     C                     MOVELWUADNA    UUADNA           Address 2
     C                     MOVELWUAENA    UUAENA           Address 3
     C                     MOVELWUAJNA    UUAJNA           City
     C                     MOVELWUEINA    UUEINA           State
     C                     MOVELWUBTTX    UUBTTX           Zip
     C                     MOVELWUDATX    UUDATX           Country
     C                     EXSR UJ1UF
     C                     MOVELUAD,1     $NGNNA
     C                     MOVELUAD,2     $NGONA
     C                     MOVELUAD,3     $NGPNA
     C                     MOVELUAD,4     $NGQNA
     C                     MOVELUAD,5     $NGRNA
     C                     MOVELUAD,6     $NNWNA
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 14
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $NBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$NBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VNBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VNBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$NKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * PRTOBJ calls after print of Order Number format
      * Embedded PRTOBJ : PRT Header comments    PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     Z-ADDYL0003    $RFVQT           USR Quantity Ac
     C                     Z-ADDYL0002    $RCDWG           USR Weight Accu
     C                     Z-ADDYL0001    $RA4WG           Tare Weight Tot
     C           $RCDWG    ADD  $RA4WG    $RWUNB           USR Weight Bill
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 8
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$RFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Pick Slip Daily's  PO: Mainline
      *================================================================
      * PRT Pick Slip Daily's  PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQKB01           Company Number
     C           *LIKE     DEFN WAC4NB    WQKB02           Order Number
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
      * Setup key
     C                     Z-ADD$FAIC3    WQKB01           Company Number
     C                     Z-ADD$FC4NB    WQKB02           Order Number
      * Establish starting position
     C           KRSB      SETLL@BGWKPA                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Item Structure
     C                     MOVEL'Y'       W0BL03  1        Item Structure
     C                     MOVEL'Y'       W0BL04  1        Item Structure
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWAC4NB    $GC4NB           Order Number
     C                     MOVEL*BLANK    $GOTTX           Blank for 4
     C                     Z-ADDWAAIC3    $GAIC3           Company Number
      * Load related totals format
     C                     Z-ADDWAAIC3    $LAIC3           Company Number
     C                     Z-ADDWAC4NB    $LC4NB           Order Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWAAIC3    $HAIC3           Company Number
     C                     Z-ADDWAC4NB    $HC4NB           Order Number
     C                     Z-ADDWADPNB    $HDPNB           Order Sequence
     C                     Z-ADDWAUENB    $HUENB           Order Secondary
     C                     Z-ADDWAHGCD    $HHGCD           Item Code
     C                     MOVELWAG7NA    $HG7NA           Order Desc. Lin
     C                     Z-ADD*ZERO     $HCDWG           USR Weight Accu
     C                     Z-ADDWAAUWG    $HAUWG           Weight Schedule
     C                     Z-ADDWAA4WG    $HA4WG           Tare Weight Tot
     C                     MOVELWAAVST    $HAVST           Catch Weight St
     C                     Z-ADDWACCQT    $HCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     $HASNX           Quantity Sched
     C                     MOVELWAAGCD    $HAGCD           U/M - Ordered
     C                     Z-ADDWAGSPR    $HGSPR           OD Unused Prc 6
     C                     Z-ADDWAGTPR    $HGTPR           OD Unused Prc 7
     C                     Z-ADDWAGUPR    $HGUPR           OD Unused Prc 8
     C                     MOVELWAHOST    $HHOST           OD UnUsed Price
     C                     MOVELWAHPST    $HHPST           OD UnUsed Price
     C                     MOVELWAIOST    $HIOST           OD UnUsed Price
     C                     Z-ADDWAPEWG    $HPEWG           Weight Amount E
     C                     Z-ADDWARINY    $HRINY           Item Age Days
     C                     Z-ADDWATIDT    $HTIDT           Production Ovr
     C                     Z-ADDWATJDT    $HTJDT           Production Ovr
     C                     MOVELWAH2ST    $HH2ST           OD UnUsed Statu
     C                     MOVELWAH0ST    $HH0ST           OD UnUsed Statu
     C                     MOVELWAH1ST    $HH1ST           OD UnUsed Statu
     C                     Z-ADDWATKDT    $HTKDT           OD Market Begin
     C                     Z-ADDWATLDT    $HTLDT           OD Market Endin
     C                     Z-ADDWATMDT    $HTMDT           OD UnUsed Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Detail Comment     PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     MOVEL'N'       WUJDST           USR Check Y/N S
     C                     ADD  $HCDWG    YL0002           USR Weight Accu
     C                     ADD  $HA4WG    YL0001           Tare Weight Tot
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WAAIC3    WZB001           Company Number
     C                     Z-ADDWAAIC3    WZB001
     C           *LIKE     DEFN WAC4NB    WZB002           Order Number
     C                     Z-ADDWAC4NB    WZB002
     C           *LIKE     DEFN WARGNB    WZB003           Item Structure
     C                     Z-ADDWARGNB    WZB003
     C           *LIKE     DEFN WARHNB    WZB004           Item Structure
     C                     Z-ADDWARHNB    WZB004
     C           *LIKE     DEFN WARINB    WZB005           Item Structure
     C                     Z-ADDWARINB    WZB005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@BGWKPA                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Do not include if Cancelled    (Todd Johnson 08/29/2007)
      * CASE: DB1.Detail Line Status is Cancelled
     C           WAGMST    IFEQ 'X'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Order Number
     C                     MOVEL*BLANK    W0BL02  1        Item Structure
     C                     MOVEL*BLANK    W0BL03  1        Item Structure
     C                     MOVEL*BLANK    W0BL04  1        Item Structure
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Item Structure
     C                     MOVEL'Y'       W0BL03  1        Item Structure
     C                     MOVEL'Y'       W0BL04  1        Item Structure
     C                     ELSE
      * Next record - Detect level breaks
     C           WAAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WAC4NB    IFNE WZB002                     Order Number
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           WARGNB    IFNE WZB003                     Item Structure
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           WARHNB    IFNE WZB004                     Item Structure
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           WARINB    IFNE WZB005                     Item Structure
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$LKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * PRT Detail Comment     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN CPAIC3    WQKC01           Company Number
     C           *LIKE     DEFN CPC4NB    WQKC02           Order Number
     C           *LIKE     DEFN CPDPNB    WQKC03           Order Sequence
     C           *LIKE     DEFN CPUENB    WQKC04           Order Secondary
      * Define keylist
     C           KPSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
     C                     KFLD           WQKC03           Order Sequence
     C                     KFLD           WQKC04           Order Secondary
     C                     KFLD           CPDXNB           Sequence Number
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
     C                     KFLD           WQKC03           Order Sequence
     C                     KFLD           WQKC04           Order Secondary
      * Setup key
     C                     Z-ADD$HAIC3    WQKC01           Company Number
     C                     Z-ADD$HC4NB    WQKC02           Order Number
     C                     Z-ADD$HDPNB    WQKC03           Order Sequence
     C                     Z-ADD$HUENB    WQKC04           Order Secondary
     C                     Z-ADD*ZERO     CPDXNB           Sequence Number
      * Establish starting position
     C           KPSC      SETLL@CPCPOL                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDCPAIC3    $IAIC3           Company Number
     C                     Z-ADDCPC4NB    $IC4NB           Order Number
     C                     Z-ADDCPDPNB    $IDPNB           Order Sequence
     C                     Z-ADDCPUENB    $IUENB           Order Secondary
      * Load related totals format
     C                     Z-ADDCPAIC3    $KAIC3           Company Number
     C                     Z-ADDCPC4NB    $KC4NB           Order Number
     C                     Z-ADDCPDPNB    $KDPNB           Order Sequence
     C                     Z-ADDCPUENB    $KUENB           Order Secondary
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDCPAIC3    $JAIC3           Company Number
     C                     Z-ADDCPC4NB    $JC4NB           Order Number
     C                     Z-ADDCPDPNB    $JDPNB           Order Sequence
     C                     Z-ADDCPUENB    $JUENB           Order Secondary
     C                     MOVELCPG4NA    $JG4NA           Comment Text
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN CPAIC3    WZC001           Company Number
     C                     Z-ADDCPAIC3    WZC001
     C           *LIKE     DEFN CPC4NB    WZC002           Order Number
     C                     Z-ADDCPC4NB    WZC002
     C           *LIKE     DEFN CPDPNB    WZC003           Order Sequence
     C                     Z-ADDCPDPNB    WZC003
     C           *LIKE     DEFN CPUENB    WZC004           Order Secondary
     C                     Z-ADDCPUENB    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@CPCPOL                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Order Number
     C                     MOVEL*BLANK    W0CL02  1        Order Sequence
     C                     MOVEL*BLANK    W0CL03  1        Order Secondary
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           CPAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           CPC4NB    IFNE WZC002                     Order Number
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           CPDPNB    IFNE WZC003                     Order Sequence
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           CPUENB    IFNE WZC004                     Order Secondary
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$KKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * PRT Header comments    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN COAIC3    WQKD01           Company Number
     C           *LIKE     DEFN COC4NB    WQKD02           Order Number
     C           *LIKE     DEFN COI1SX    WQKD03           Comment Type
      * Define keylist
     C           KPSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Order Number
     C                     KFLD           WQKD03           Comment Type
     C                     KFLD           CODXNB           Sequence Number
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Order Number
     C                     KFLD           WQKD03           Comment Type
      * Setup key
     C                     Z-ADD$NAIC3    WQKD01           Company Number
     C                     Z-ADD$NC4NB    WQKD02           Order Number
     C                     MOVEL'PI'      WQKD03           Comment Type
     C                     Z-ADD1         CODXNB           Sequence Number
      * Establish starting position
     C           KPSD      SETLL@COCPNU                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Order Number
     C                     MOVEL'Y'       W0DL02  1        Comment Type
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDCOAIC3    $OAIC3           Company Number
     C                     Z-ADDCOC4NB    $OC4NB           Order Number
     C                     MOVELCOI1SX    $OI1SX           Comment Type
     C                     MOVEL*BLANK    $OHLTX           Condition Desc.
     C                     MOVEL*BLANK    $OSHTX           Text USR 40
      * Load related totals format
     C                     Z-ADDCOAIC3    $QAIC3           Company Number
     C                     Z-ADDCOC4NB    $QC4NB           Order Number
     C                     MOVELCOI1SX    $QI1SX           Comment Type
      * USER: Process before print of Comment Type format
      * Get the text definition of the Comment type for Heading SAZ 2/8/0
      * CUR.Text USR 40 = Condition name of CUR.Comment Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1603273   Y2LSNO  70       List number
     C                     PARM $OI1SX    W0INVL 25        Comment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $OSHTX    PARM           W0CNNM 25        Text USR 40
      *
     C                     Z-ADD1         ZQ      50
     C           $OSHTX    CAT  @CN,002:ZQ$OSHTX    P      Text USR 40
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDCOAIC3    $PAIC3           Company Number
     C                     Z-ADDCOC4NB    $PC4NB           Order Number
     C                     MOVELCOI1SX    $PI1SX           Comment Type
     C                     MOVELCOG4NA    $PG4NA           Comment Text
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN COAIC3    WZD001           Company Number
     C                     Z-ADDCOAIC3    WZD001
     C           *LIKE     DEFN COC4NB    WZD002           Order Number
     C                     Z-ADDCOC4NB    WZD002
     C           *LIKE     DEFN COI1SX    WZD003           Comment Type
     C                     MOVELCOI1SX    WZD003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@COCPNU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        Company Number
     C                     MOVEL*BLANK    W0DL01  1        Order Number
     C                     MOVEL*BLANK    W0DL02  1        Comment Type
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Order Number
     C                     MOVEL'Y'       W0DL02  1        Comment Type
     C                     ELSE
      * Next record - Detect level breaks
     C           COAIC3    IFNE WZD001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           COC4NB    IFNE WZD002                     Order Number
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           COI1SX    IFNE WZD003                     Comment Type
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$QKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Pick List-NoLdDLY PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Pick List-NoLdDLY PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of Prt Pick List-NoLdDLY PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Order Number of Prt Pick List-NoLdDLY PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
      * RTV 1st Warehouse      RT - Order Detail  * 
     C                     EXSR SDRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DC4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $DAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDAODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  $DEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDEIDT
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Ship To Customer of Prt Pick List-NoLdDLY PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Print format
     C                     WRITE$EKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of Prt Pick List-NoLdDLY PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$FDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Pick Slip Daily's  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of PRT Pick Slip Daily's  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Order Number of PRT Pick Slip Daily's  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Print format
     C                     WRITE$GKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0BP01
     C                     END                             FI
      * Print Item Structure Type Code of PRT Pick Slip Daily's  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Item Structure Group Code of PRT Pick Slip Daily's  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Item Structure Class Code of PRT Pick Slip Daily's  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Detail line. of PRT Pick Slip Daily's  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     Z-ADD$HCCQT    $HASNX           Quantity Sched
     C                     ADD  $HASNX    YL0003           USR Quantity Ac
      * Rtv Tare Weight/PDC   RT - Company Item  * 
     C                     EXSR SERVGN
      * RTV Item Box Tare Wgt  RT - Item Bill Of Material  * 
     C                     EXSR SFRVGN
     C           WUA3WG    ADD  WUAIWG    WUA4WG           Tare Weight Tot
     C           WUA4WG    MULT $HCCQT    WN0001    H      @Weight
     C                     Z-ADDWN0001    $HA4WG           Tare Weight Tot
     C           $HA4WG    ADD  WAAUWG    $HCDWG           USR Weight Accu
     C                     Z-ADD78        WUPGLN           Page Length
      * CASE: LCL.Status - Y or N is yes
     C           YL0005    IFEQ 'Y'                        *IF
     C                     Z-ADD16        W0FSUM           *line counter
     C                     END                             *FI
     C                     MOVEL'N'       YL0005           Status - Y or N
      * 8 lines print per detail line -- check overflow
     C           W0FSUM    ADD  8         YL0006           USR Counter
      * CASE: LCL.USR Counter GT WRK.Page Length
     C           YL0006    IFGT WUPGLN                     *IF
     C                     MOVEL'Y'       W0NEWP           *new page flag
      * Set New Page          US - /UT User Source  * 
     C                     MOVE 'Y'       W0NEWP
     C                     MOVEL'Y'       YL0005           Status - Y or N
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $HHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$HHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VHHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VHHGCD           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           $HAVST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0004    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Order Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Print format
     C                     WRITE$IKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of PRT Detail Comment     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$JCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$JDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Company Number of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print Order Number of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print Comment Type of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Print format
     C                     WRITE$OKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print Detail line. of PRT Header comments    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$PCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$PDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Pick List-NoLdDLY PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Pick List-NoLdDLY PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt Pick List-NoLdDLY PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  6         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of Prt Pick List-NoLdDLY PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Pick List-NoLdDLY PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Pick Slip Daily's  PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Pick Slip Daily's  PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Pick Slip Daily's  PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  7         W0FSUM
     C                     END                             FI
      *
      * * Item Structure Type Code of PRT Pick Slip Daily's  PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Structure Group Code of PRT Pick Slip Daily's  PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Structure Class Code of PRT Pick Slip Daily's  PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Pick Slip Daily's  PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD10        W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Detail Comment     PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Detail Comment     PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Detail Comment     PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Detail Comment     PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT Detail Comment     PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Detail Comment     PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Header comments    PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Header comments    PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Header comments    PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Comment Type of PRT Header comments    PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Header comments    PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * TOP = PAR By name
     C                     Z-ADDP2AIC3    $BAIC3           Company Number
     C                     Z-ADDP2C4NB    $BC4NB           Order Number
     C                     MOVEL*BLANK    $BSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BC4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBC4NB           CD7 Ext Numeric
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BSQTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BSQTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSD01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSD02           Order Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    WQSD01           Company Number
     C                     Z-ADD$DC4NB    WQSD02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSD     SETLL@BGWKL1                    *
     C           KRSSD     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELOMAJCD    $DAJCD           Warehouse Code
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Tare Weight/PDC   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$HAIC3    BZAIC3           Company Number
     C                     Z-ADD$HHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZFZST    YL0004           Production Date
     C                     Z-ADDBZA3WG    WUA3WG           Misc Tare Weigh
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Item Box Tare Wgt  RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  3        Item Type Code
     C                     MOVEL*BLANK    WN0003  1        Package Type Co
     C                     Z-ADD*ZERO     WN0004 112       Unit Weight USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSF01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSF02           Item Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Item Code
      * Setup key
     C                     Z-ADD$HAIC3    WQSF01           Company Number
     C                     Z-ADD$HHGCD    WQSF02           Item Code
      * Establish starting position
     C           KRSSF     SETLL@IORETI                    *
     C           KRSSF     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * RTV Type/Pack/Unit Wgt RT - Company Item  * 
     C                     EXSR SGRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Packaging and Supplies
      *   |- c2    : PAR.Package Type Code is Box
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0002    IFEQ 'PS'                       *IF
     C           WN0003    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SFEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     END                             *FI
     C           KRSSF     READE@IORETI                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDWN0004    WUAIWG           Unit Weight
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Type/Pack/Unit Wgt RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDIOAIC3    BZAIC3           Company Number
     C                     Z-ADDIOC9NB    BZHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WUAIWG           Unit Weight
     C                     MOVELBZN0CD    WN0002           Item Type Code
     C                     MOVELBZX4ST    WN0003           Package Type Co
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$NBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBBVTX    $NCDTX           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Country Code       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$NBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBKXCD    WUKXCD           Country Code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Description        RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL$NR4CD    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSJ     CHAIN@JEREWF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $NMZNA           Sales Route Des
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEMZNA    $NMZNA           Sales Route Des
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Desc, Status       RT - Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVELWUKXCD    E5KXCD           Country Code
      * Establish starting position
     C           KRSSK     CHAIN@E5REB8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1158' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUDATX           Country Descrip
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELE5DATX    WUDATX           Country Descrip
     C                     MOVELE5VSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Pick Slip Daily's  PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       @Weight
      *
      * PRT Pick Slip Daily's  PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Detail Comment     PO
      *================================================================
      * PRT Detail Comment     PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Header comments    PO
      *================================================================
      * PRT Header comments    PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
     C           UJ1UF     BEGSR
      *============================================================
      * UJ1UF - COMPRESS NAME/ADDRESS/COUNTRY INFORMATION
      *============================================================
      *
     C           *LIKE     DEFN WUADTX    UUADTX
     C           *LIKE     DEFN WUACNA    UUACNA
     C           *LIKE     DEFN WUADNA    UUADNA
     C           *LIKE     DEFN WUAENA    UUAENA
     C           *LIKE     DEFN WUAJNA    UUAJNA
     C           *LIKE     DEFN WUEINA    UUEINA
     C           *LIKE     DEFN WUBTTX    UUBTTX- 1
     C           *LIKE     DEFN WUDATX    UUDATX
      * FILL OUTPUT ARRAY
     C                     MOVE *BLANK    UAD
     C                     Z-ADD1         UX      20
     C                     MOVELUUADTX    UAD,UX
     C                     ADD  1         UX
     C           UUACNA    IFNE *BLANK
     C                     MOVELUUACNA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C           UUADNA    IFNE *BLANK
     C                     MOVELUUADNA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C           UUAENA    IFNE *BLANK
     C                     MOVELUUAENA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C                     MOVE *BLANK    UUCSTZ 34
     C                     MOVELUUAJNA    UUCST  23
     C                     MOVE UUEINA    UUCST
     C                     MOVELUUCST     UUCSTZ
     C                     MOVE UUBTTX    UUCSTZ
     C                     MOVELUUCSTZ    UAD,UX
     C           UUDATX    IFNE *BLANK
     C                     ADD  1         UX
     C                     MOVELUUDATX    UAD,UX
     C                     END
     C                     ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Pick Slip Daily's  PO: Initialise
      *================================================================
      * USER: Initialize program
      * SET Page Length        UP - /UT User Source  * 
     C                     Z-ADD78        @$PGL
     C                     MOVEL'Y'       WUJDST           USR Check Y/N S
     C                     Z-ADD*ZERO     YL0002           USR Weight Accu
     C                     Z-ADD*ZERO     YL0001           Tare Weight Tot
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BEAIC3           Company Number
     C                     MOVEL*LOVAL    BEC4NB           Order Number
     C                     MOVEL*LOVAL    BEBKC7           Ship To Custome
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Unused Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WADYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WADZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WAGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WAAIC3           Company Number
     C                     MOVEL*LOVAL    WAC4NB           Order Number
     C                     MOVEL*LOVAL    WARGNB           Item Structure
     C                     MOVEL*LOVAL    WARHNB           Item Structure
     C                     MOVEL*LOVAL    WARINB           Item Structure
      * Define work field Misc Tare Weight
     C                     Z-ADD*ZERO     WUA3WG  52
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Tare Weight Total
     C                     Z-ADD*ZERO     WUA4WG 112
      * Define work field Page Length
     C                     Z-ADD*ZERO     WUPGLN  30
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    CPAIC3           Company Number
     C                     MOVEL*LOVAL    CPC4NB           Order Number
     C                     MOVEL*LOVAL    CPDPNB           Order Sequence
     C                     MOVEL*LOVAL    CPUENB           Order Secondary
     C                     MOVEL*LOVAL    CPDXNB           Sequence Number
      * Define work field Country Code
     C                     MOVEL*BLANK    WUKXCD  6
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field Country Description
     C                     MOVEL*BLANK    WUDATX 30
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field Address Line 1
     C                     MOVEL*BLANK    WUACNA 30
      * Define work field Address Line 2
     C                     MOVEL*BLANK    WUADNA 30
      * Define work field Address Line 3
     C                     MOVEL*BLANK    WUAENA 30
      * Define work field City
     C                     MOVEL*BLANK    WUAJNA 20
      * Define work field State
     C                     MOVEL*BLANK    WUEINA  2
      * Define work field Zip/Postal Code
     C                     MOVEL*BLANK    WUBTTX 11
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    COAIC3           Company Number
     C                     MOVEL*LOVAL    COC4NB           Order Number
     C                     MOVEL*LOVAL    COI1SX           Comment Type
     C                     MOVEL*LOVAL    CODXNB           Sequence Number
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Tare Weight Total
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field USR Weight Accumulated
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field USR Quantity Accumulated
     C                     Z-ADD*ZERO     YL0003  70
      * Define null work field Description Line One
     C                     MOVEL*BLANK    YN0001 30
      * Define local work field Production Date Control
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0006  50
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * ** Change Log
      *  E01342 New report for orders that are NOT load planned
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 Comments
