// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBIJXFR
// ?Date: 14.08.2025 Time: 03:48:07
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?E2540 4/12/13 new so sales knows what to report as cancelled for the week
//?Run sql MPRCANCEL for orders cancelled during the week.
EXECUTE FUNCTION(Rtv Prior Monday      RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1674394;
PARAMETER(360);
PARAMETER(JOB.*Job_date);
PARAMETER(LCL.Date_Mon_USR);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Day of Week is Monday
 IF DB1.Day_of_Week = '2';

 // PAR.Date Mon USR = DB1.Post to G/L Date
 PAR.Date_Mon_USR = DB1.Post_to_G_L_Date;

 QUIT;

 ENDIF;

}


EXECUTE FUNCTION(RTV Next Saturday      RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1674395;
PARAMETER(360);
PARAMETER(JOB.*Job_date);
PARAMETER(LCL.Date_Sat_USR);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Day of Week is Saturday
 IF DB1.Day_of_Week = '7';

 // PAR.Scheduled Ship Date = DB1.Post to G/L Date
 PAR.Scheduled_Ship_Date = DB1.Post_to_G_L_Date;

 QUIT;

 ENDIF;

}


// LCL.Number Value - 7 = LCL.Date Mon USR
LCL.Number_Value_7 = LCL.Date_Mon_USR;

// LCL.Numeric Field Needed  USR = LCL.Date Sat USR
LCL.Numeric_Field_Needed_USR = LCL.Date_Sat_USR;

// Call program Rtv Alpha Value       XF.
CALL PROGRAM(Rtv Alpha Value       XF) ('POMTXFR');
PARAMETER(360);
PARAMETER('MPRCANCEL');
PARAMETER(LCL.Distr_List_Usr);

// Execute command - 'EXECUTE SQL View'
EXECUTE COMMAND(USR4592);
PARAMETER(LCL.Distr_List_Usr);
PARAMETER(LCL.Number_Value_7);
PARAMETER(LCL.Numeric_Field_Needed_USR);

