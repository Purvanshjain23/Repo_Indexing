     H/TITLE CLC Read/Proc. Detail  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 05/04/18  Time  : 16:49:46
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDIKREL1IF  E           K        DISK
      * RTV : Price Method Detail       Retrieval index
      *
     FPDIPREL5IF  E           K        DISK
      * RSQ : Market Date Method        Sys/DtTyp/Co/DtMth
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPNGBREL1IF  E           K        DISK
      * RTV : IP Item Market Details    Retrieval index
      *
     FPDIOREL3IF  E           K        DISK
      * RSQ : Item Bill Of Material     Consumed Items
      *
     FPDISREL2IF  E           K        DISK
      * RTV : Company Customer Item     Active Only
      *
     FPDIOREL4IF  E           K        DISK
      * RSQ : Item Bill Of Material     Produced Items
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAEOREL2IF  E           K        DISK
      * RTV : Company Customer          Active Records         N
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FOMHLREL1IF  E           K        DISK
      * RTV : Accrual Program           Retrieval index
      *
     FOMHPREL1IF  E           K        DISK
      * RTV : Customer Accrual Item     Retrieval index
      *
     FOPBGWKLDIF  E           K        DISK
      * RSQ : Order Detail              Co/Order#/Item/Whse Not
      *
     FPOC8REL1IF  E           K        DISK
      * RTV : Customer Accrual Str      Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDIMCPW0IF  E           K        DISK                      A
      * UPD : Order Detail Pricing      Upd Index for Work File
      *
     FPDIMCPL0IF  E           K        DISK                      A
      * UPD : Order Detail Pricing      Update index
      *
     FPDJKCPW0IF  E           K        DISK                      A
      * UPD : Order Dtl Formula Dtl     Upd Index for Work File
      *
     FPDJKCPL0IF  E           K        DISK                      A
      * UPD : Order Dtl Formula Dtl     Update index
      *
      * Long constants
     E                    @CN#    1  28  6   @CN    25
     I@IKRESI
      * Price Method Detail       Retrieval index
      * Renamed input format fields
     I              IKAIC3                          WAAIC3
     I              IKQ7CD                          WAQ7CD
     I              IKPMSQ                          WAPMSQ
     I              IKQ9CD                          WAQ9CD
     I              IKU6ST                          WAU6ST
     I              IKUVST                          WAUVST
     I              IKUWST                          WAUWST
     I              IKUXST                          WAUXST
     I              IKAATM                          WAAATM
     I              IKAYNA                          WAAYNA
     I              IKA0NA                          WAA0NA
     I              IKAXDT                          WAAXDT
      *
     I@IPREHD
      * Market Date Method        Sys/DtTyp/Co/DtMth
      * Renamed input format fields
     I              IPAIC3                          WBAIC3
     I              IPRDCD                          WBRDCD
     I              IPMNNA                          WBMNNA
     I              IPRECD                          WBRECD
     I              IPCPRD                          WBCPRD
     I              IPQMNB                          WBQMNB
     I              IPU7ST                          WBU7ST
     I              IPCNOT                          WBCNOT
     I              IPU8ST                          WBU8ST
     I              IPCDOW                          WBCDOW
     I              IPBXST                          WBBXST
     I              IPUVST                          WBUVST
     I              IPUWST                          WBUWST
     I              IPUXST                          WBUXST
     I              IPAATM                          WBAATM
     I              IPAYNA                          WBAYNA
     I              IPA0NA                          WBA0NA
     I              IPAXDT                          WBAXDT
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                          WCLQCD
     I              F0LRCD                          WCLRCD
     I              F0EQDT                          WCEQDT
     I              F0A5PR                          WCA5PR
     I              F0B8PR                          WCB8PR
     I              F0UVST                          WCUVST
     I              F0UWST                          WCUWST
     I              F0UXST                          WCUXST
     I              F0VSST                          WCVSST
     I              F0AATM                          WCAATM
     I              F0AYNA                          WCAYNA
     I              F0A0NA                          WCA0NA
     I              F0AXDT                          WCAXDT
      *
     I@GBREGM
      * IP Item Market Details    Retrieval index
      * Renamed input format fields
     I              GBHGCD                          WDHGCD
     I              GBLQCD                          WDLQCD
     I              GBLRCD                          WDLRCD
     I              GBG2PC                          WDG2PC
     I              GBG8PR                          WDG8PR
     I              GBVSST                          WDVSST
     I              GBMJDT                          WDMJDT
     I              GBBETM                          WDBETM
     I              GBCCVN                          WDCCVN
     I              GBCDVN                          WDCDVN
     I              GBMKDT                          WDMKDT
     I              GBBFTM                          WDBFTM
     I              GBCEVN                          WDCEVN
     I              GBCFVN                          WDCFVN
      *
     I@IMCPZ4
      * Order Detail Pricing      Upd Index for Work File
      * Renamed input format fields
     I              IMAIC3                          WEAIC3
     I              IMC4NB                          WEC4NB
     I              IMDPNB                          WEDPNB
     I              IMUENB                          WEUENB
     I              IMQ9CD                          WEQ9CD
     I              IMPDSQ                          WEPDSQ
     I              IMBNPR                          WEBNPR
     I              IMU6ST                          WEU6ST
     I              IMUVST                          WEUVST
     I              IMUWST                          WEUWST
     I              IMUXST                          WEUXST
     I              IMAATM                          WEAATM
     I              IMAYNA                          WEAYNA
     I              IMA0NA                          WEA0NA
     I              IMAXDT                          WEAXDT
      *
     I@IMCPSD
      * Order Detail Pricing      Update index
      * Renamed input format fields
     I              IMAIC3                          WFAIC3
     I              IMC4NB                          WFC4NB
     I              IMDPNB                          WFDPNB
     I              IMUENB                          WFUENB
     I              IMQ9CD                          WFQ9CD
     I              IMPDSQ                          WFPDSQ
     I              IMBNPR                          WFBNPR
     I              IMU6ST                          WFU6ST
     I              IMUVST                          WFUVST
     I              IMUWST                          WFUWST
     I              IMUXST                          WFUXST
     I              IMAATM                          WFAATM
     I              IMAYNA                          WFAYNA
     I              IMA0NA                          WFA0NA
     I              IMAXDT                          WFAXDT
      *
     I@IOREYG
      * Item Bill Of Material     Consumed Items
      * Renamed input format fields
     I              IOAIC3                          WGAIC3
     I              IOHGCD                          WGHGCD
     I              IOC9NB                          WGC9NB
     I              IOV2ST                          WGV2ST
     I              IOBOPR                          WGBOPR
     I              IOBPPR                          WGBPPR
     I              IOHGQT                          WGHGQT
     I              IOHHCD                          WGHHCD
     I              IOYAST                          WGYAST
     I              IOCNSM                          WGCNSM
     I              IOBMY1                          WGBMY1
     I              IOBMY2                          WGBMY2
     I              IOIXQT                          WGIXQT
     I              IOIYQT                          WGIYQT
     I              IORSST                          WGRSST
     I              IORTST                          WGRTST
     I              IOUVST                          WGUVST
     I              IOUWST                          WGUWST
     I              IOUXST                          WGUXST
     I              IOVSST                          WGVSST
     I              IOAATM                          WGAATM
     I              IOAYNA                          WGAYNA
     I              IOA0NA                          WGA0NA
     I              IOAXDT                          WGAXDT
      *
     I@JKCPZ6
      * Order Dtl Formula Dtl     Upd Index for Work File
      * Renamed input format fields
     I              JKAIC3                          WHAIC3
     I              JKC4NB                          WHC4NB
     I              JKDPNB                          WHDPNB
     I              JKUENB                          WHUENB
     I              JKQ9CD                          WHQ9CD
     I              JKHGCD                          WHHGCD
     I              JKZXNB                          WHZXNB
     I              JKBOPR                          WHBOPR
     I              JKCDPR                          WHCDPR
     I              JKCEPR                          WHCEPR
     I              JKU6ST                          WHU6ST
     I              JKUVST                          WHUVST
     I              JKUWST                          WHUWST
     I              JKUXST                          WHUXST
     I              JKAATM                          WHAATM
     I              JKAYNA                          WHAYNA
     I              JKA0NA                          WHA0NA
     I              JKAXDT                          WHAXDT
      *
     I@JKCPYE
      * Order Dtl Formula Dtl     Update index
      * Renamed input format fields
     I              JKAIC3                          WIAIC3
     I              JKC4NB                          WIC4NB
     I              JKDPNB                          WIDPNB
     I              JKUENB                          WIUENB
     I              JKQ9CD                          WIQ9CD
     I              JKHGCD                          WIHGCD
     I              JKZXNB                          WIZXNB
     I              JKBOPR                          WIBOPR
     I              JKCDPR                          WICDPR
     I              JKCEPR                          WICEPR
     I              JKU6ST                          WIU6ST
     I              JKUVST                          WIUVST
     I              JKUWST                          WIUWST
     I              JKUXST                          WIUXST
     I              JKAATM                          WIAATM
     I              JKAYNA                          WIAYNA
     I              JKA0NA                          WIA0NA
     I              JKAXDT                          WIAXDT
      *
     I@ISREV7
      * Company Customer Item     Active Only
      * Renamed input format fields
     I              ISAIC3                          WJAIC3
     I              ISBKC7                          WJBKC7
     I              ISHGCD                          WJHGCD
     I              ISERDT                          WJERDT
     I              ISESDT                          WJESDT
     I              ISBWPR                          WJBWPR
     I              ISBLPR                          WJBLPR
     I              ISBXPR                          WJBXPR
     I              ISBYPR                          WJBYPR
     I              ISLQCD                          WJLQCD
     I              ISUVST                          WJUVST
     I              ISUWST                          WJUWST
     I              ISUXST                          WJUXST
     I              ISVSST                          WJVSST
     I              ISAATM                          WJAATM
     I              ISAYNA                          WJAYNA
     I              ISA0NA                          WJA0NA
     I              ISAXDT                          WJAXDT
      *
     I@IOREYH
      * Item Bill Of Material     Produced Items
      * Renamed input format fields
     I              IOAIC3                          WKAIC3
     I              IOHGCD                          WKHGCD
     I              IOC9NB                          WKC9NB
     I              IOV2ST                          WKV2ST
     I              IOBOPR                          WKBOPR
     I              IOBPPR                          WKBPPR
     I              IOHGQT                          WKHGQT
     I              IOHHCD                          WKHHCD
     I              IOYAST                          WKYAST
     I              IOCNSM                          WKCNSM
     I              IOBMY1                          WKBMY1
     I              IOBMY2                          WKBMY2
     I              IOIXQT                          WKIXQT
     I              IOIYQT                          WKIYQT
     I              IORSST                          WKRSST
     I              IORTST                          WKRTST
     I              IOUVST                          WKUVST
     I              IOUWST                          WKUWST
     I              IOUXST                          WKUXST
     I              IOVSST                          WKVSST
     I              IOAATM                          WKAATM
     I              IOAYNA                          WKAYNA
     I              IOA0NA                          WKA0NA
     I              IOAXDT                          WKAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WLAIC3
     I              BZHGCD                          WLHGCD
     I              BZAVNA                          WLAVNA
     I              BZAWNA                          WLAWNA
     I              BZL7NA                          WLL7NA
     I              BZL8NA                          WLL8NA
     I              BZL6NA                          WLL6NA
     I              BZMFNA                          WLMFNA
     I              BZADCD                          WLADCD
     I              BZAWPC                          WLAWPC
     I              BZLXST                          WLLXST
     I              BZAECD                          WLAECD
     I              BZAXPC                          WLAXPC
     I              BZLYST                          WLLYST
     I              BZAFCD                          WLAFCD
     I              BZAICD                          WLAICD
     I              BZAIWG                          WLAIWG
     I              BZHICD                          WLHICD
     I              BZRBCD                          WLRBCD
     I              BZFZST                          WLFZST
     I              BZAVST                          WLAVST
     I              BZCZWG                          WLCZWG
     I              BZC0WG                          WLC0WG
     I              BZURTN                          WLURTN
     I              BZAJC8                          WLAJC8
     I              BZRINB                          WLRINB
     I              BZRHNB                          WLRHNB
     I              BZRGNB                          WLRGNB
     I              BZLNCD                          WLLNCD
     I              BZTFNB                          WLTFNB
     I              BZN0CD                          WLN0CD
     I              BZX4ST                          WLX4ST
     I              BZTMVA                          WLTMVA
     I              BZTNVA                          WLTNVA
     I              BZBLPR                          WLBLPR
     I              BZBMPR                          WLBMPR
     I              BZLRCD                          WLLRCD
     I              BZU9ST                          WLU9ST
     I              BZCMCO                          WLCMCO
     I              BZQ1CD                          WLQ1CD
     I              BZQ8CD                          WLQ8CD
     I              BZCHTM                          WLCHTM
     I              BZQZCD                          WLQZCD
     I              BZXWST                          WLXWST
     I              BZXXST                          WLXXST
     I              BZVMST                          WLVMST
     I              BZSWGH                          WLSWGH
     I              BZPPHE                          WLPPHE
     I              BZR3CD                          WLR3CD
     I              BZSDCD                          WLSDCD
     I              BZICN1                          WLICN1
     I              BZSVCD                          WLSVCD
     I              BZICN2                          WLICN2
     I              BZSWCD                          WLSWCD
     I              BZV2NB                          WLV2NB
     I              BZSXCD                          WLSXCD
     I              BZITCN                          WLITCN
     I              BZSYCD                          WLSYCD
     I              BZITC5                          WLITC5
     I              BZSZCD                          WLSZCD
     I              BZICN6                          WLICN6
     I              BZS0CD                          WLS0CD
     I              BZICN7                          WLICN7
     I              BZS1CD                          WLS1CD
     I              BZICN8                          WLICN8
     I              BZS2CD                          WLS2CD
     I              BZICN9                          WLICN9
     I              BZS3CD                          WLS3CD
     I              BZICN0                          WLICN0
     I              BZS4CD                          WLS4CD
     I              BZSFNB                          WLSFNB
     I              BZA3WG                          WLA3WG
     I              BZSJNB                          WLSJNB
     I              BZLLCD                          WLLLCD
     I              BZLMCD                          WLLMCD
     I              BZP3ST                          WLP3ST
     I              BZSKNB                          WLSKNB
     I              BZSLNB                          WLSLNB
     I              BZSMNB                          WLSMNB
     I              BZP4ST                          WLP4ST
     I              BZCFNB                          WLCFNB
     I              BZCGNB                          WLCGNB
     I              BZILNB                          WLILNB
     I              BZCHNB                          WLCHNB
     I              BZCINB                          WLCINB
     I              BZCJNB                          WLCJNB
     I              BZCMNB                          WLCMNB
     I              BZCNNB                          WLCNNB
     I              BZCRNB                          WLCRNB
     I              BZCSNB                          WLCSNB
     I              BZCVNB                          WLCVNB
     I              BZCWNB                          WLCWNB
     I              BZCXNB                          WLCXNB
     I              BZCZNB                          WLCZNB
     I              BZC0NB                          WLC0NB
     I              BZN1CD                          WLN1CD
     I              BZB4NB                          WLB4NB
     I              BZB5NB                          WLB5NB
     I              BZX5ST                          WLX5ST
     I              BZX6ST                          WLX6ST
     I              BZX7ST                          WLX7ST
     I              BZPCCT                          WLPCCT
     I              BZBDNB                          WLBDNB
     I              BZBJNB                          WLBJNB
     I              BZSUST                          WLSUST
     I              BZSVST                          WLSVST
     I              BZSYST                          WLSYST
     I              BZSZST                          WLSZST
     I              BZS1ST                          WLS1ST
     I              BZXRCD                          WLXRCD
     I              BZXTCD                          WLXTCD
     I              BZXUCD                          WLXUCD
     I              BZF5WG                          WLF5WG
     I              BZF6WG                          WLF6WG
     I              BZF7WG                          WLF7WG
     I              BZBLNB                          WLBLNB
     I              BZBNNB                          WLBNNB
     I              BZS2ST                          WLS2ST
     I              BZS4ST                          WLS4ST
     I              BZS5ST                          WLS5ST
     I              BZS6ST                          WLS6ST
     I              BZS8ST                          WLS8ST
     I              BZS9ST                          WLS9ST
     I              BZTCST                          WLTCST
     I              BZTDST                          WLTDST
     I              BZUVST                          WLUVST
     I              BZUWST                          WLUWST
     I              BZUXST                          WLUXST
     I              BZVSST                          WLVSST
     I              BZAATM                          WLAATM
     I              BZAYNA                          WLAYNA
     I              BZA0NA                          WLA0NA
     I              BZAXDT                          WLAXDT
      *
     I@EOREUB
      * Company Customer          Active Records         N
      * Renamed input format fields
     I              EOAIC3                          WMAIC3
     I              EOBKC7                          WMBKC7
     I              EOAQCD                          WMAQCD
     I              EOR4CD                          WMR4CD
     I              EOBYNA                          WMBYNA
     I              EOB6NA                          WMB6NA
     I              EOBZNA                          WMBZNA
     I              EOLLST                          WMLLST
     I              EOPPST                          WMPPST
     I              EOR5NB                          WMR5NB
     I              EOR6NB                          WMR6NB
     I              EOQGST                          WMQGST
     I              EOBOCD                          WMBOCD
     I              EOTBNB                          WMTBNB
     I              EOMTCU                          WMMTCU
     I              EOW2NB                          WMW2NB
     I              EORPCD                          WMRPCD
     I              EOAJCD                          WMAJCD
     I              EOX9ST                          WMX9ST
     I              EOT9CD                          WMT9CD
     I              EOUBCD                          WMUBCD
     I              EOISTX                          WMISTX
     I              EOLQCD                          WMLQCD
     I              EONJNA                          WMNJNA
     I              EOI0TX                          WMI0TX
     I              EONKNA                          WMNKNA
     I              EOI1TX                          WMI1TX
     I              EOVLST                          WMVLST
     I              EORLST                          WMRLST
     I              EOMMTX                          WMMMTX
     I              EOOHNA                          WMOHNA
     I              EOQ6ST                          WMQ6ST
     I              EOQ8ST                          WMQ8ST
     I              EORBST                          WMRBST
     I              EOREST                          WMREST
     I              EOUVST                          WMUVST
     I              EOUWST                          WMUWST
     I              EOUXST                          WMUXST
     I              EOVSST                          WMVSST
     I              EOAATM                          WMAATM
     I              EOAYNA                          WMAYNA
     I              EOA0NA                          WMA0NA
     I              EOAXDT                          WMAXDT
      *
     I@HORELA
      * Customer Accrual          Retrieval index
      * Renamed input format fields
     I              HOBKC7                          WOBKC7
     I              HOOJCD                          WOOJCD
     I              HOGUNY                          WOGUNY
     I              HOBFDT                          WOBFDT
     I              HOA2DT                          WOA2DT
     I              HOBKPR                          WOBKPR
     I              HOTTST                          WOTTST
     I              HOSHSX                          WOSHSX
     I              HOQDSX                          WOQDSX
     I              HOPJDT                          WOPJDT
     I              HOPKDT                          WOPKDT
     I              HOECVL                          WOECVL
     I              HOQESX                          WOQESX
     I              HOQFSX                          WOQFSX
     I              HOHHAA                          WOHHAA
     I              HOHQVL                          WOHQVL
     I              HOQGSX                          WOQGSX
     I              HOQHSX                          WOQHSX
     I              HOQISX                          WOQISX
     I              HOQJSX                          WOQJSX
     I              HOUVST                          WOUVST
     I              HOUWST                          WOUWST
     I              HOUXST                          WOUXST
     I              HOAATM                          WOAATM
     I              HOAYNA                          WOAYNA
     I              HOA0NA                          WOA0NA
     I              HOAXDT                          WOAXDT
      *
     I@HLREK4
      * Accrual Program           Retrieval index
      * Renamed input format fields
     I              HLOJCD                          WROJCD
     I              HLLENA                          WRLENA
     I              HLTOST                          WRTOST
     I              HLTQST                          WRTQST
     I              HLTRST                          WRTRST
     I              HLTSST                          WRTSST
     I              HLOKCD                          WROKCD
     I              HLTYST                          WRTYST
     I              HLOQCD                          WROQCD
     I              HLHHCD                          WRHHCD
     I              HLI2TX                          WRI2TX
     I              HLJFTX                          WRJFTX
     I              HLI3TX                          WRI3TX
     I              HLJGTX                          WRJGTX
     I              HLLEDG                          WRLEDG
     I              HLTTST                          WRTTST
     I              HLBKPR                          WRBKPR
     I              HLSHSX                          WRSHSX
     I              HLQFSX                          WRQFSX
     I              HLFDTX                          WRFDTX
     I              HLFETX                          WRFETX
     I              HLFFTX                          WRFFTX
     I              HLFGTX                          WRFGTX
     I              HLHQVL                          WRHQVL
     I              HLFHTX                          WRFHTX
     I              HLUVST                          WRUVST
     I              HLUWST                          WRUWST
     I              HLUXST                          WRUXST
     I              HLVSST                          WRVSST
     I              HLAATM                          WRAATM
     I              HLAYNA                          WRAYNA
     I              HLA0NA                          WRA0NA
     I              HLAXDT                          WRAXDT
      *
     I@HPRELD
      * Customer Accrual Item     Retrieval index
      * Renamed input format fields
     I              HPBKC7                          WSBKC7
     I              HPOJCD                          WSOJCD
     I              HPGUNY                          WSGUNY
     I              HPHGCD                          WSHGCD
     I              HPBKPR                          WSBKPR
     I              HPSHSX                          WSSHSX
     I              HPUVST                          WSUVST
     I              HPUWST                          WSUWST
     I              HPUXST                          WSUXST
     I              HPAATM                          WSAATM
     I              HPAYNA                          WSAYNA
     I              HPA0NA                          WSA0NA
     I              HPAXDT                          WSAXDT
      *
     I@BGWKFW
      * Order Detail              Co/Order#/Item/Whse Not
      * Renamed input format fields
     I              OMAIC3                          WTAIC3
     I              OMC4NB                          WTC4NB
     I              OMDPNB                          WTDPNB
     I              OMUENB                          WTUENB
     I              OMHGCD                          WTHGCD
     I              OMAJCD                          WTAJCD
     I              OMBKC7                          WTBKC7
     I              OMCFC7                          WTCFC7
     I              OMGMST                          WTGMST
     I              OMGNST                          WTGNST
     I              OMMAVA                          WTMAVA
     I              OMKDVA                          WTKDVA
     I              OML8VA                          WTL8VA
     I              OML9VA                          WTL9VA
     I              OMGTST                          WTGTST
     I              OMGVST                          WTGVST
     I              OMGUST                          WTGUST
     I              OMQFST                          WTQFST
     I              OMAYVA                          WTAYVA
     I              OMEXDT                          WTEXDT
     I              OMLQCD                          WTLQCD
     I              OMRDCD                          WTRDCD
     I              OMQ7CD                          WTQ7CD
     I              OMBZPR                          WTBZPR
     I              OML6NB                          WTL6NB
     I              OMU1ST                          WTU1ST
     I              OMGIDT                          WTGIDT
     I              OMCRCD                          WTCRCD
     I              OMAGCD                          WTAGCD
     I              OMRZST                          WTRZST
     I              OMR0ST                          WTR0ST
     I              OMR1ST                          WTR1ST
     I              OMG7NA                          WTG7NA
     I              OMG8NA                          WTG8NA
     I              OMRPCD                          WTRPCD
     I              OMVEST                          WTVEST
     I              OMVGST                          WTVGST
     I              OMAVST                          WTAVST
     I              OMU0ST                          WTU0ST
     I              OMRFCD                          WTRFCD
     I              OMFZST                          WTFZST
     I              OMR1NB                          WTR1NB
     I              OMAVQT                          WTAVQT
     I              OMD0WG                          WTD0WG
     I              OMCCQT                          WTCCQT
     I              OMAUWG                          WTAUWG
     I              OMCBQT                          WTCBQT
     I              OMATWG                          WTATWG
     I              OMAQCS                          WTAQCS
     I              OMAGCS                          WTAGCS
     I              OMAKPR                          WTAKPR
     I              OMALPR                          WTALPR
     I              OMAUPR                          WTAUPR
     I              OMAVWG                          WTAVWG
     I              OMA4WG                          WTA4WG
     I              OMA5DT                          WTA5DT
     I              OMAODT                          WTAODT
     I              OMGNDT                          WTGNDT
     I              OMAMST                          WTAMST
     I              OMANST                          WTANST
     I              OMVAST                          WTVAST
     I              OMRGNB                          WTRGNB
     I              OMRHNB                          WTRHNB
     I              OMRINB                          WTRINB
     I              OMRBCD                          WTRBCD
     I              OMHICD                          WTHICD
     I              OMRNCD                          WTRNCD
     I              OMROCD                          WTROCD
     I              OMCXDT                          WTCXDT
     I              OMAJVN                          WTAJVN
     I              OMKXCD                          WTKXCD
     I              OMJPCD                          WTJPCD
     I              OMCQCD                          WTCQCD
     I              OMR4CD                          WTR4CD
     I              OMZ1ST                          WTZ1ST
     I              OMZ3ST                          WTZ3ST
     I              OMZ4ST                          WTZ4ST
     I              OMDUPR                          WTDUPR
     I              OMB6VL                          WTB6VL
     I              OMA1AA                          WTA1AA
     I              OMFZSX                          WTFZSX
     I              OMF0SX                          WTF0SX
     I              OMF1SX                          WTF1SX
     I              OMF2SX                          WTF2SX
     I              OMF3SX                          WTF3SX
     I              OMF4SX                          WTF4SX
     I              OMF5SX                          WTF5SX
     I              OMF6SX                          WTF6SX
     I              OMF7SX                          WTF7SX
     I              OMNTDT                          WTNTDT
     I              OMNUDT                          WTNUDT
     I              OMNVDT                          WTNVDT
     I              OMNWDT                          WTNWDT
     I              OMNXDT                          WTNXDT
     I              OMBUTM                          WTBUTM
     I              OMBVTM                          WTBVTM
     I              OMBWTM                          WTBWTM
     I              OMBXTM                          WTBXTM
     I              OMBYTM                          WTBYTM
     I              OMH5NX                          WTH5NX
     I              OMH6NX                          WTH6NX
     I              OMH7NX                          WTH7NX
     I              OMH8NX                          WTH8NX
     I              OMH9NX                          WTH9NX
     I              OMDVPR                          WTDVPR
     I              OMDWPR                          WTDWPR
     I              OMDXPR                          WTDXPR
     I              OMDYPR                          WTDYPR
     I              OMDZPR                          WTDZPR
     I              OMGSPR                          WTGSPR
     I              OMGTPR                          WTGTPR
     I              OMGUPR                          WTGUPR
     I              OMHOST                          WTHOST
     I              OMHPST                          WTHPST
     I              OMIOST                          WTIOST
     I              OMPEWG                          WTPEWG
     I              OMRINY                          WTRINY
     I              OMTIDT                          WTTIDT
     I              OMTJDT                          WTTJDT
     I              OMH2ST                          WTH2ST
     I              OMH0ST                          WTH0ST
     I              OMH1ST                          WTH1ST
     I              OMTKDT                          WTTKDT
     I              OMTLDT                          WTTLDT
     I              OMTMDT                          WTTMDT
     I              OMUVST                          WTUVST
     I              OMUWST                          WTUWST
     I              OMUXST                          WTUXST
     I              OMAATM                          WTAATM
     I              OMAYNA                          WTAYNA
     I              OMA0NA                          WTA0NA
     I              OMAXDT                          WTAXDT
      *
     I@C8RES1
      * Customer Accrual Str      Retrieval index
      * Renamed input format fields
     I              C8BKC7                          WVBKC7
     I              C8OJCD                          WVOJCD
     I              C8GUNY                          WVGUNY
     I              C8RGNB                          WVRGNB
     I              C8RHNB                          WVRHNB
     I              C8RINB                          WVRINB
     I              C8BKPR                          WVBKPR
     I              C8SHSX                          WVSHSX
     I              C8QTSX                          WVQTSX
     I              C8QUSX                          WVQUSX
     I              C8FKPR                          WVFKPR
     I              C8FLPR                          WVFLPR
     I              C8UVST                          WVUVST
     I              C8UWST                          WVUWST
     I              C8UXST                          WVUXST
     I              C8VSST                          WVVSST
     I              C8AATM                          WVAATM
     I              C8AYNA                          WVAYNA
     I              C8A0NA                          WVA0NA
     I              C8AXDT                          WVAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WWAIC3
     I              BEC4NB                          WWC4NB
     I              BEJNCD                          WWJNCD
     I              BEANC7                          WWANC7
     I              BEBKC7                          WWBKC7
     I              BEBRTX                          WWBRTX
     I              BEHMNA                          WWHMNA
     I              BEHONA                          WWHONA
     I              BEHPNA                          WWHPNA
     I              BEHNNA                          WWHNNA
     I              BEDBCD                          WWDBCD
     I              BECKTX                          WWCKTX
     I              BEB0C7                          WWB0C7
     I              BEAETX                          WWAETX
     I              BEB1NA                          WWB1NA
     I              BEB3NA                          WWB3NA
     I              BEB4NA                          WWB4NA
     I              BEB2NA                          WWB2NA
     I              BEBHCD                          WWBHCD
     I              BEC8TX                          WWC8TX
     I              BEBCNA                          WWBCNA
     I              BEA0DT                          WWA0DT
     I              BEA5DT                          WWA5DT
     I              BEGNDT                          WWGNDT
     I              BEACDT                          WWACDT
     I              BEAQCD                          WWAQCD
     I              BEB6NA                          WWB6NA
     I              BEBYNA                          WWBYNA
     I              BEBZNA                          WWBZNA
     I              BEGTST                          WWGTST
     I              BEGVST                          WWGVST
     I              BEGUST                          WWGUST
     I              BEQFST                          WWQFST
     I              BECQCD                          WWCQCD
     I              BEGJST                          WWGJST
     I              BEGWST                          WWGWST
     I              BEGXST                          WWGXST
     I              BEGYST                          WWGYST
     I              BEAODT                          WWAODT
     I              BEAIVN                          WWAIVN
     I              BECXDT                          WWCXDT
     I              BEJZVA                          WWJZVA
     I              BEA1WG                          WWA1WG
     I              BEXIST                          WWXIST
     I              BEXJST                          WWXJST
     I              BEXKST                          WWXKST
     I              BEEIDT                          WWEIDT
     I              BEAFTM                          WWAFTM
     I              BEE8CD                          WWE8CD
     I              BEE9CD                          WWE9CD
     I              BERMNB                          WWRMNB
     I              BETBNB                          WWTBNB
     I              BER1NB                          WWR1NB
     I              BEPJST                          WWPJST
     I              BEU0ST                          WWU0ST
     I              BEU1ST                          WWU1ST
     I              BEQ2CD                          WWQ2CD
     I              BEU2ST                          WWU2ST
     I              BEVEST                          WWVEST
     I              BEVFST                          WWVFST
     I              BEVGST                          WWVGST
     I              BERPCD                          WWRPCD
     I              BERNNB                          WWRNNB
     I              BEVDST                          WWVDST
     I              BEATIN                          WWATIN
     I              BEU4ST                          WWU4ST
     I              BEU5ST                          WWU5ST
     I              BERSRN                          WWRSRN
     I              BEMHNA                          WWMHNA
     I              BEMINA                          WWMINA
     I              BEWBST                          WWWBST
     I              BER4CD                          WWR4CD
     I              BEBFCD                          WWBFCD
     I              BEQ4CD                          WWQ4CD
     I              BET3NB                          WWT3NB
     I              BESICD                          WWSICD
     I              BECONB                          WWCONB
     I              BECEST                          WWCEST
     I              BEAWDT                          WWAWDT
     I              BEJPCD                          WWJPCD
     I              BEXUST                          WWXUST
     I              BEZ1ST                          WWZ1ST
     I              BEVRVA                          WWVRVA
     I              BEOBST                          WWOBST
     I              BEBCST                          WWBCST
     I              BEBDST                          WWBDST
     I              BEB7VL                          WWB7VL
     I              BEGASX                          WWGASX
     I              BEGBSX                          WWGBSX
     I              BEGCSX                          WWGCSX
     I              BEGDSX                          WWGDSX
     I              BEFNSX                          WWFNSX
     I              BEFOSX                          WWFOSX
     I              BEFPSX                          WWFPSX
     I              BEFQSX                          WWFQSX
     I              BEFRSX                          WWFRSX
     I              BEFSSX                          WWFSSX
     I              BEFTSX                          WWFTSX
     I              BEFUSX                          WWFUSX
     I              BEFVSX                          WWFVSX
     I              BEFWSX                          WWFWSX
     I              BEFXSX                          WWFXSX
     I              BEFYSX                          WWFYSX
     I              BENODT                          WWNODT
     I              BENPDT                          WWNPDT
     I              BENQDT                          WWNQDT
     I              BENRDT                          WWNRDT
     I              BENSDT                          WWNSDT
     I              BEBPTM                          WWBPTM
     I              BEBQTM                          WWBQTM
     I              BEBRTM                          WWBRTM
     I              BEBSTM                          WWBSTM
     I              BEBTTM                          WWBTTM
     I              BEH0NX                          WWH0NX
     I              BEH1NX                          WWH1NX
     I              BEH2NX                          WWH2NX
     I              BEH3NX                          WWH3NX
     I              BEH4NX                          WWH4NX
     I              BEC0C7                          WWC0C7
     I              BEUVST                          WWUVST
     I              BEUWST                          WWUWST
     I              BEUXST                          WWUXST
     I              BEAATM                          WWAATM
     I              BEAYNA                          WWAYNA
     I              BEA0NA                          WWA0NA
     I              BEAXDT                          WWAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDIM1    E DSPDIMCPW0
      * UPD : Order Detail Pricing      Upd Index for Work File
      * Renamed input format fields
     I              IMAIC3                          WEAIC3
     I              IMC4NB                          WEC4NB
     I              IMDPNB                          WEDPNB
     I              IMUENB                          WEUENB
     I              IMQ9CD                          WEQ9CD
     I              IMPDSQ                          WEPDSQ
     I              IMBNPR                          WEBNPR
     I              IMU6ST                          WEU6ST
     I              IMUVST                          WEUVST
     I              IMUWST                          WEUWST
     I              IMUXST                          WEUXST
     I              IMAATM                          WEAATM
     I              IMAYNA                          WEAYNA
     I              IMA0NA                          WEA0NA
     I              IMAXDT                          WEAXDT
      *
     IQPDIM2    E DSPDIMCPL0
      * UPD : Order Detail Pricing      Update index
      * Renamed input format fields
     I              IMAIC3                          WFAIC3
     I              IMC4NB                          WFC4NB
     I              IMDPNB                          WFDPNB
     I              IMUENB                          WFUENB
     I              IMQ9CD                          WFQ9CD
     I              IMPDSQ                          WFPDSQ
     I              IMBNPR                          WFBNPR
     I              IMU6ST                          WFU6ST
     I              IMUVST                          WFUVST
     I              IMUWST                          WFUWST
     I              IMUXST                          WFUXST
     I              IMAATM                          WFAATM
     I              IMAYNA                          WFAYNA
     I              IMA0NA                          WFA0NA
     I              IMAXDT                          WFAXDT
      *
     IQPDJK1    E DSPDJKCPW0
      * UPD : Order Dtl Formula Dtl     Upd Index for Work File
      * Renamed input format fields
     I              JKAIC3                          WHAIC3
     I              JKC4NB                          WHC4NB
     I              JKDPNB                          WHDPNB
     I              JKUENB                          WHUENB
     I              JKQ9CD                          WHQ9CD
     I              JKHGCD                          WHHGCD
     I              JKZXNB                          WHZXNB
     I              JKBOPR                          WHBOPR
     I              JKCDPR                          WHCDPR
     I              JKCEPR                          WHCEPR
     I              JKU6ST                          WHU6ST
     I              JKUVST                          WHUVST
     I              JKUWST                          WHUWST
     I              JKUXST                          WHUXST
     I              JKAATM                          WHAATM
     I              JKAYNA                          WHAYNA
     I              JKA0NA                          WHA0NA
     I              JKAXDT                          WHAXDT
      *
     IQPDJK2    E DSPDJKCPL0
      * UPD : Order Dtl Formula Dtl     Update index
      * Renamed input format fields
     I              JKAIC3                          WIAIC3
     I              JKC4NB                          WIC4NB
     I              JKDPNB                          WIDPNB
     I              JKUENB                          WIUENB
     I              JKQ9CD                          WIQ9CD
     I              JKHGCD                          WIHGCD
     I              JKZXNB                          WIZXNB
     I              JKBOPR                          WIBOPR
     I              JKCDPR                          WICDPR
     I              JKCEPR                          WICEPR
     I              JKU6ST                          WIU6ST
     I              JKUVST                          WIUVST
     I              JKUWST                          WIUWST
     I              JKUXST                          WIUXST
     I              JKAATM                          WIAATM
     I              JKAYNA                          WIAYNA
     I              JKA0NA                          WIA0NA
     I              JKAXDT                          WIAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Price Method Type
     I                                        1   1 P1V8ST
      * I :  Decimal Places Rounded
     I                                    P   2   30P1RMNY
      * I :  PMH Price Type
     I                                        4   4 P1H3ST
      * I :  Company Number
     I                                    P   5   60P1AIC3
      * I :  Price Method Code
     I                                        7   9 P1Q7CD
      * I :  Ship To Customer
     I                                    P  10  130P1BKC7
      * I :  Actual Shipped Date
     I                                    P  14  170P1GNDT
      * I :  Requested Delivery Date
     I                                    P  18  210P1EIDT
      * I :  U/M - Ordered
     I                                       22  23 P1AGCD
      * I :  Quantity Ordered
     I                                    P  24  292P1AVQT
      * I :  Requested Ship Date
     I                                    P  30  330P1A5DT
      * B :  Unit Price
     I                                    P  34  394P1AKPR
      * I :  Item Code
     I                                    P  40  430P1HGCD
      * I :  Date of Orig. Entry Det.
     I                                    P  44  470P1D3DT
      * I :  Commodity Market Code
     I                                       48  50 P1LQCD
      * I :  Market Pricing Date
     I                                    P  51  540P1EXDT
      * B :  Price Status
     I                                       55  55 P1U1ST
      * I :  Date Method Code
     I                                       56  58 P1RDCD
      * B :  Pricing Date Used
     I                                    P  59  620P1GIDT
      * B :  Pricing Retrieved Amount
     I                                    P  63  684P1TPVA
      * I :  Event Called From
     I                                       69  70 P1SJCD
      * N :  Commodity Price Group
     I                                       71  77 P1LRCD
      * N :  Starting Product Price
     I                                    P  78  834P1CGPR
      * N :  Sales Yield
     I                                    P  84  862P1BOPR
      * N :  Market Value
     I                                    P  87  924P1CDPR
      * N :  Credit Value
     I                                    P  93  984P1CEPR
      * N :  Price Adjustment Amount
     I                                    P  99 1044P1LOVA
      * N :  Price Detail Sequence
     I                                    P 105 1060P1PDSQ
      * I :  OD Ceiling Price
     I                                    P 107 1124P1DWPR
      * I :  OD Market Begin Date
     I                                    P 113 1160P1TKDT
      * I :  OD Market Ending Date
     I                                    P 117 1200P1TLDT
     IP2PARM      DS
      * B :  Error Return
     I                                        1   5 P2WZST
     IP3PARM      DS
      * FLD: Order Detail
      * I :  Order Number
     I                                    P   1   40P3C4NB
      * I :  Order Sequence Number
     I                                    P   5   60P3DPNB
      * I :  Order Secondary Line Seq
     I                                    P   7   80P3UENB
      * I :  Price Overage Override
     I                                    P   9  144P3BZPR
     IP4PARM      DS
      * FLD: Company Customer Item
      * N :  Market Overage
     I                                    P   1   64P4BLPR
      * N :  Formula Differential
     I                                    P   7  124P4BXPR
      * N :  Formula Processing Fee
     I                                    P  13  184P4BYPR
     IP5PARM      DS
      * N :  USR Return Code
     I                                        1   1 P5N7CD
     IP6PARM      DS
      * FLD: Company Item
      * B :  U/M - Primary
     I                                        1   2 P6ADCD
      * N :  Conversion Factor 1
     I                                    P   3   74P6AWPC
      * N :  Operation Factor 1
     I                                        8   8 P6LXST
      * B :  U/M - Second
     I                                        9  10 P6AECD
      * N :  Conversion Factor 2
     I                                    P  11  154P6AXPC
      * N :  Operation Factor 2
     I                                       16  16 P6LYST
      * B :  U/M - Third
     I                                       17  18 P6AFCD
      * B :  U/M - Pricing
     I                                       19  20 P6AICD
      * N :  Unit Weight
     I                                    P  21  262P6AIWG
      * N :  Default Commod Mark basis
     I                                       27  29 P6LNCD
      * N :  Standard Overage/Underage
     I                                    P  30  354P6BMPR
      * N :  Item Pricing Operation
     I                                       36  36 P6U9ST
      * N :  Item Pricing Constant
     I                                    P  37  424P6CMCO
     IP7PARM      DS
      * FLD: STR Quantity/Price Convrt
      * B :  Price based on U/M1 S
     I                                    P   1   64P7APPR
      * B :  Price based on U/M2 S
     I                                    P   7  124P7AQPR
      * B :  Price based on U/M3 S
     I                                    P  13  184P7ARPR
     IP8PARM      DS
      * I :  Price Type Status
     I                                        1   1 P8Y0ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1V8ST    PARM           WP0001  1        Price Method Ty
     C           P1RMNY    PARM           WP0002  20       Decimal Places
     C           P1H3ST    PARM           WP0003  1        PMH Price Type
     C           P1AIC3    PARM           WP0004  30       Company Number
     C           P1Q7CD    PARM           WP0005  3        Price Method Co
     C           P1BKC7    PARM           WP0006  70       Ship To Custome
     C           P1GNDT    PARM           WP0007  70       Actual Shipped
     C           P1EIDT    PARM           WP0008  70       Requested Deliv
     C           P1AGCD    PARM           WP0009  2        U/M - Ordered
     C           P1AVQT    PARM           WP0010 112       Quantity Ordere
     C           P1A5DT    PARM           WP0011  70       Requested Ship
     C           P1AKPR    PARM P1AKPR    WP0012 114       Unit Price
     C           P1HGCD    PARM           WP0013  70       Item Code
     C           P1D3DT    PARM           WP0014  70       Date of Orig. E
     C           P1LQCD    PARM           WP0015  3        Commodity Marke
     C           P1EXDT    PARM           WP0016  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WP0017  1        Price Status
     C           P1RDCD    PARM           WP0018  3        Date Method Cod
     C           P1GIDT    PARM P1GIDT    WP0019  70       Pricing Date Us
     C           P1TPVA    PARM P1TPVA    WP0020 114       Pricing Retriev
     C           P1SJCD    PARM           WP0021  2        Event Called Fr
     C           P1DWPR    PARM           WP0022 114       OD Ceiling Pric
     C           P1TKDT    PARM           WP0023  70       OD Market Begin
     C           P1TLDT    PARM           WP0024  70       OD Market Endin
     C           P2WZST    PARM P2WZST    WP0025  5        Error Return
     C           P3C4NB    PARM           WP0026  70       Order Number
     C           P3DPNB    PARM           WP0027  30       Order Sequence
     C           P3UENB    PARM           WP0028  30       Order Secondary
     C           P3BZPR    PARM           WP0029 114       Price Overage O
     C           P6ADCD    PARM P6ADCD    WP0030  2        U/M - Primary
     C           P6AECD    PARM P6AECD    WP0031  2        U/M - Second
     C           P6AFCD    PARM P6AFCD    WP0032  2        U/M - Third
     C           P6AICD    PARM P6AICD    WP0033  2        U/M - Pricing
     C           P7APPR    PARM P7APPR    WP0034 114       Price based on
     C           P7AQPR    PARM P7AQPR    WP0035 114       Price based on
     C           P7ARPR    PARM P7ARPR    WP0036 114       Price based on
     C           P8Y0ST    PARM           WP0037  1        Price Type Stat
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CLC Read/Proc. Detail  XF
      * CLC Read/Proc. Detail  RT - Price Method Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NASUBR    BEGSR
      *================================================================
      * Customer Sales Freight Overage
      *================================================================
      * RTV Pricing: CSFRTO   XF - Price Method Componant  * 
     C                     CALL 'PNQ7XFR'              90  RTV Pricing: CS
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0208  30       Company Number
     C                     PARM P1HGCD    WQ0209  70       Item Code
     C                     PARM P1BKC7    WQ0210  70       Ship To Custome
     C           P1TPVA    PARM P1TPVA    WQ0211 114       Pricing Retriev
     C           P2WZST    PARM *BLANK    WQ0212  5        Error Return
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'IOM'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBSUBR    BEGSR
      *================================================================
      * Price Sheet Item Price
      *================================================================
      * RTV Pricing: PSITPR   XF - Price Method Componant  * 
     C                     CALL 'PNQ8XFR'              90  RTV Pricing: PS
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0213  30       Company Number
     C                     PARM P1BKC7    WQ0214  70       Ship To Custome
     C                     PARM P1GNDT    WQ0215  70       Actual Shipped
     C                     PARM P1EIDT    WQ0216  70       Requested Deliv
     C                     PARM P1A5DT    WQ0217  70       Requested Ship
     C                     PARM P1HGCD    WQ0218  70       Item Code
     C                     PARM P1D3DT    WQ0219  70       Date of Orig. E
     C                     PARM P1LQCD    WQ0220  3        Commodity Marke
     C                     PARM P1EXDT    WQ0221  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WQ0222  1        Price Status
     C                     PARM P1RDCD    WQ0223  3        Date Method Cod
     C           P1GIDT    PARM P1GIDT    WQ0224  70       Pricing Date Us
     C           P1TPVA    PARM P1TPVA    WQ0225 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0226  2        Event Called Fr
     C                     PARM WN0004    WQ0227  7        Commodity Price
     C                     PARM P1TKDT    WQ0228  70       OD Market Begin
     C                     PARM P1TLDT    WQ0229  70       OD Market Endin
     C           P2WZST    PARM *BLANK    WQ0230  5        Error Return
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQ8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'MKT'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCSUBR    BEGSR
      *================================================================
      * Item Market +/-
      *================================================================
      * RTV Pricing: ITMKTO   XF - Price Method Componant  * 
     C                     CALL 'PNQ9XFR'              90  RTV Pricing: IT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0231  30       Company Number
     C                     PARM P1HGCD    WQ0232  70       Item Code
     C                     PARM P1LQCD    WQ0233  3        Commodity Marke
     C           P1TPVA    PARM P1TPVA    WQ0234 114       Pricing Retriev
     C           P2WZST    PARM *BLANK    WQ0235  5        Error Return
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQ9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'IOM'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDSUBR    BEGSR
      *================================================================
      * Item Market Overage
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0121 114       Market Overage
     C                     Z-ADD*ZERO     WN0122 114       Price Adjustmen
      *
      * RTV Pricing: MKTOVR   IF
      * Rtv Market Details    RT - IP Item Market Details  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HGCD    WL0006           Item Code
     C                     MOVELP1LQCD    WL0007    P      Commodity Marke
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0080    P      Commodity Price
     C                     Z-ADDWL0009    YN0081           Market Percent
     C                     Z-ADDWL0010    WN0121           Market Prem/Ded
     C                     MOVELWUGSTX    P2WZST           Error Return
      * Convert Market Overage to CWT if not Zero
      * CASE: PAR.Market Overage is Not Zeros
     C           WN0121    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0236  30       Company Number
     C                     PARM P1HGCD    WQ0237  70       Item Code
     C                     PARM WN0121    WQ0238 114       Unit Price
     C           WN0122    PARM *ZERO     WQ0239 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Load PAR.Pricing Retrieved Amount from Overage Converted to CWT
      * CASE: PAR.Price Adjustment Amount NE WRK.ZERO
     C           WN0122    IFNE WUW0NB                     *IF
     C                     Z-ADDWN0122    P1TPVA           Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0121    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'IOM'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NESUBR    BEGSR
      *================================================================
      * Gate price adjustment
      *================================================================
      * RTV Pricing: GATADJ   XF - Price Method Componant  * 
     C                     CALL 'PBIHXFR'              90  RTV Pricing: GA
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0240  30       Company Number
     C           P1U1ST    PARM P1U1ST    WQ0241  1        Price Status
     C           P1TPVA    PARM P1TPVA    WQ0242 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0243  2        Event Called Fr
     C                     PARM P3C4NB    WQ0244  70       Order Number
     C                     PARM P3DPNB    WQ0245  30       Order Sequence
     C                     PARM P3UENB    WQ0246  30       Order Secondary
     C           P2WZST    PARM *BLANK    WQ0247  5        Error Return
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBIHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'GAT'     P2WZST           Error Return
     C                     GOTO NEEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail with Gate price adjustment
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           P1TPVA    IFNE 0                          *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFSUBR    BEGSR
      *================================================================
      * Flat Duty Item Pricing
      *================================================================
      * RTV Pricing: DVFADJ   XF - Price Method Componant  * 
     C                     CALL 'PBIPXFR'              90  RTV Pricing: DV
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0248  30       Company Number
     C           P1U1ST    PARM P1U1ST    WQ0249  1        Price Status
     C           P1TPVA    PARM P1TPVA    WQ0250 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0251  2        Event Called Fr
     C                     PARM P3C4NB    WQ0252  70       Order Number
     C                     PARM P3DPNB    WQ0253  30       Order Sequence
     C                     PARM P3UENB    WQ0254  30       Order Secondary
     C           P2WZST    PARM *BLANK    WQ0255  5        Error Return
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBIPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'DVF'     P2WZST           Error Return
     C                     GOTO NFEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail with Gate price adjustment
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           P1TPVA    IFNE 0                          *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGSUBR    BEGSR
      *================================================================
      * Company Customer Item Overage
      *================================================================
      * RTV Pricing: CCITOV   XF - Price Method Componant  * 
     C                     CALL 'PNS6XFR'              90  RTV Pricing: CC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0256  30       Company Number
     C                     PARM P1HGCD    WQ0257  70       Item Code
     C                     PARM P1BKC7    WQ0258  70       Ship To Custome
     C           P1TPVA    PARM P1TPVA    WQ0259 114       Pricing Retriev
     C           P2WZST    PARM *BLANK    WQ0260  5        Error Return
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'CCI'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * CLC Read/Proc. Detail  RT - Price Method Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Item Structure
     C                     Z-ADD*ZERO     WN0002  30       Item Structure
     C                     Z-ADD*ZERO     WN0003  30       Item Structure
     C                     MOVEL*BLANK    WN0004  7        Commodity Price
     C                     Z-ADD*ZERO     WN0005 114       Starting Produc
     C                     Z-ADD*ZERO     WN0006  52       Sales Yield
     C                     Z-ADD*ZERO     WN0007 114       Market Value
     C                     Z-ADD*ZERO     WN0008 114       Credit Value
     C                     Z-ADD*ZERO     WN0009 114       Price Adjustmen
     C                     Z-ADD*ZERO     WN0010  30       Price Detail Se
     C                     Z-ADD*ZERO     WN0011 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0012 114       Market Overage
     C                     Z-ADD*ZERO     WN0013 114       Formula Differe
     C                     Z-ADD*ZERO     WN0014 114       Formula Process
     C                     MOVEL*BLANK    WN0015  1        USR Return Code
     C                     Z-ADD*ZERO     WN0016  94       Conversion Fact
     C                     MOVEL*BLANK    WN0017  1        Operation Facto
     C                     Z-ADD*ZERO     WN0018  94       Conversion Fact
     C                     MOVEL*BLANK    WN0019  1        Operation Facto
     C                     Z-ADD*ZERO     WN0020 112       Unit Weight
     C                     MOVEL*BLANK    WN0021  1        Catch Weight St
     C                     MOVEL*BLANK    WN0022  3        Default Commod
     C                     Z-ADD*ZERO     WN0023 114       Standard Overag
     C                     MOVEL*BLANK    WN0024  1        Item Pricing Op
     C                     Z-ADD*ZERO     WN0025 114       Item Pricing Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C           YL0001    PARM *BLANK    WQ0002  1        Plant Company S
     C           YL0002    PARM *BLANK    WQ0003  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD0         P1AKPR           Unit Price
     C                     Z-ADDWUW0NB    P1TPVA           Pricing Retriev
     C                     MOVELWUGSTX    P2WZST           Error Return
     C                     MOVELWUGSTX    P6ADCD           U/M - Primary
     C                     MOVELWUGSTX    P6AECD           U/M - Second
     C                     MOVELWUGSTX    P6AFCD           U/M - Third
     C                     MOVELWUGSTX    P6AICD           U/M - Pricing
     C                     Z-ADDWUW0NB    P7APPR           Price based on
     C                     Z-ADDWUW0NB    P7AQPR           Price based on
     C                     Z-ADDWUW0NB    P7ARPR           Price based on
      * RTV Item Dtls W/CW     XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDGMXFR'              90  RTV Item Dtls W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0004  30       Company Number
     C                     PARM P1HGCD    WQ0005  70       Item Code
     C           P6ADCD    PARM *BLANK    WQ0006  2        U/M - Primary
     C           WN0016    PARM *ZERO     WQ0007  94       Conversion Fact
     C           WN0017    PARM *BLANK    WQ0008  1        Operation Facto
     C           P6AECD    PARM *BLANK    WQ0009  2        U/M - Second
     C           WN0018    PARM *ZERO     WQ0010  94       Conversion Fact
     C           WN0019    PARM *BLANK    WQ0011  1        Operation Facto
     C           P6AFCD    PARM *BLANK    WQ0012  2        U/M - Third
     C           P6AICD    PARM *BLANK    WQ0013  2        U/M - Pricing
     C           WN0020    PARM *ZERO     WQ0014 112       Unit Weight
     C           WUAVST    PARM *BLANK    WQ0015  1        Catch Weight St
     C           WUBLPR    PARM *ZERO     WQ0016 114       Market Overage
     C           WUBMPR    PARM *ZERO     WQ0017 114       Standard Overag
     C           WN0004    PARM *BLANK    WQ0018  7        Commodity Price
     C           WN0024    PARM *BLANK    WQ0019  1        Item Pricing Op
     C           WN0025    PARM *ZERO     WQ0020 114       Item Pricing Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * p205 - Sales price book  *** C2742 8/27/13 COMMENT - NEVER IMPLEM
      * ** Save U/M - Pricing, this will be replace later.
     C                     MOVELP6AICD    WUAICD           U/M - Pricing
     C                     MOVEL'P'       P1U1ST           Price Status
     C                     Z-ADD1         WN0010           Price Detail Se
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAQ7CD    WQSA02           Price Method Co
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Price Method Co
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     MOVELP1Q7CD    WQSA02           Price Method Co
      * Establish starting position
     C           KRSSA     SETLL@IKRESI                    *
     C           KRSSA     READE@IKRESI                  90*
      * Data record not found
     C   90                MOVEL'USR1671' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** If a change is made here or a routine is added here then a
      * ** similar routine must be added to the CLC Pricing using File RT
      * ** in the Order Detail Pricing file. These need to be kept in syn
      * *** 01 PROCESS COMPONANT MKTPRC IF SELECTED AND IS ACTIVE-*
      * CASE: Retrieve Market Price
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is MKTPRC
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,001                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * NOTE: Price received from this routine has been converted to CWT
      * Retrieve Market Pricing
     C                     EXSR UBSUBR                     Retrieve Market
     C                     END                             *FI
      * *** 02 PROCESS COMPONANT STRITM IF SELECTED AND IS ACTIVE-*
      * CASE: Calculate Formula Price
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is STRITM
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,003                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Retrieve Starting Item Prices
     C                     EXSR UDSUBR                     Retrieve Starti
     C                     END                             *FI
      * *** 03 PROCESS COMPONANT CIDIFF IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CIDIFF
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,004                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Customer/Item Differential
     C                     EXSR UHSUBR                     Customer/Item D
     C                     END                             *FI
      * *** 04 PROCESS COMPONANT TCRDVY IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is TCRDVY
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,005                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0076  70       Date Used for C
     C                     Z-ADD*ZERO     WN0077 114       Price Adjustmen
      *
      * xRTV Pricing: TCRDVY   IF
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1EIDT' defaulted for 'Requested Delivery Date'.
      * Field '(PAR) P1TKDT' defaulted for 'OD Market Begin Date'.
      * Field '(PAR) P1TLDT' defaulted for 'OD Market Ending Date'.
      * UPD Produced Items     RT - PD Item Bill Of Material  * 
     C                     EXSR SKRVGN
      * Error Routine - Exit if Error
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Error Return is All Entered Values
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C           W0RTN     OREQ @CN,002                    *OR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: PAR.Error Return is Week Prior Avg Error
     C           P2WZST    IFEQ 'WPA'                      *IF
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'WPC'     P2WZST           Error Return
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'PNF'     P2WZST           Error Return
     C                     END                             *FI
     C                     END                             *FI
      * Update if Pricing Retrieved Amount is EQUAL to Zero(should always
      * CASE: PAR.Pricing Retrieved Amount EQ WRK.ZERO
     C           P1TPVA    IFEQ WUW0NB                     *IF
      * Update for a zero Quantity Record for Componant TCRDVY)
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADD0         WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADD0         WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADD0         WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADD0         WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update for Credit Yield Total (use Componant TLCRDY)
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVEL'TLCRDY'  WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDWN0006    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVEL'TLCRDY'  WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDWN0006    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVEL'TLCRDY'  WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDWN0006    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVEL'TLCRDY'  WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDWN0006    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update for Credit Value Total (Use Componant TLCRDV)
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVEL'TLCRDV'  WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDWN0008    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVEL'TLCRDV'  WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDWN0008    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVEL'TLCRDV'  WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDWN0008    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVEL'TLCRDV'  WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDWN0008    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
      * **(Price is not accumulated in this routine)
     C                     END                             *FI
     C                     END                             *FI
      * *** 05 PROCESS COMPONANT SUBCRD IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is SUBCRD
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,006                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * xRTV Pricing: SUBCRD   IF
      * Note: No CWT Conversion is needed
     C                     MOVEL*BLANK    WN0015           USR Return Code
     C                     Z-ADD0         P1TPVA           Pricing Retriev
     C                     SUB  WN0008    P1TPVA           Pricing Retriev
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'SUB'     P2WZST           Error Return
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
      * Update if Pricing Retrieved Amount is Not Equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
     C                     END                             *FI
      * *** 06 PROCESS COMPONANT MSCYLD IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is MSCYLD
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,007                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Calculate Muscle Yield
     C                     EXSR UKSUBR                     Calculate Muscl
     C                     END                             *FI
      * *** 07 PROCESS COMPONANT CIFMPF IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CIFMPF
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,008                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Customer/Item Processing Fee
     C                     EXSR ULSUBR                     Customer/Item P
     C                     END                             *FI
      * *** 08 PROCESS COMPONANT IOVRFM IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is IOVRFM
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,009                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Item Overage Formula
     C                     EXSR UMSUBR                     Item Overage Fo
     C                     END                             *FI
      * *** 09 PROCESS COMPONANT CFRTOV IF SELECTED AND IS ACTIVE-*
      * CASE: Retrieve Freight Overage
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CFRTOV
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,010                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Company/Customer freight Rate Overage
     C                     EXSR UNSUBR                     Company/Custome
     C                     END                             *FI
      * *** 10 PROCESS COMPONANT CIOVMK IF SELECTED AND IS ACTIVE-*
      * CASE: Retrieve Market Overage
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CIOVMK
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,011                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Item Market Overage
     C                     EXSR UOSUBR                     Item Market Ove
     C                     END                             *FI
      * *** 11 PROCESS COMPONANT IOVMKT IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is IOVMKT
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,012                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Item Market Overage
     C                     EXSR UPSUBR                     Item Market Ove
     C                     END                             *FI
      * *** 12 PROCESS COMPONANT EXTEND IF SELECTED AND IS ACTIVE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is EXTEND
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,013                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Extended Price Method
     C                     EXSR UQSUBR                     Extended Price
     C                     END                             *FI
      * *** 13 PROCESS COMPONANT OVRIDE IF SELECTED AND IS ACTIVE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is OVRIDE
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,014                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Manual Pricing
     C                     EXSR URSUBR                     Manual Pricing
     C                     END                             *FI
      * *** 14 Process Componant ACCRLS if Selected and is Active-*
      * CASE: Retrieve Accruals
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is ACCRLS
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,015                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * NOTE: Price received from this routine has been converted to CWT
      * Retrieve Accruals
     C                     EXSR USSUBR                     Retrieve Accrua
     C                     END                             *FI
      * *** 15 PROCESS COMPONANT CFRTAB IF SELECTED AND IS ACTIVE-*
      * CASE: Retrieve Freight Overage
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CFRTAB
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,016                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Company/Customer freight Rate Overage
     C                     EXSR UUSUBR                     Company/Custome
     C                     END                             *FI
      * *** 16 PROCESS COMPONANT IOVFRT IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is IOVFRT
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,017                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Item Freight Overage
     C                     EXSR UVSUBR                     Item Freight Ov
     C                     END                             *FI
      * *** 17 PROCESS COMPONANT CIMSLV IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CIMSLV
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,018                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Customer Item Muscle Value
     C                     EXSR UWSUBR                     Customer Item M
     C                     END                             *FI
      * *** 18 PROCESS COMPONANT CIPFEE IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CIPFEE
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,019                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Customer Item Processing Fee
     C                     EXSR UXSUBR                     Customer Item P
     C                     END                             *FI
      * *** 19 PROCESS COMPONANT CIFRTO IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CIFRTO
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,020                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Customer Item Freight Overage
     C                     EXSR UYSUBR                     Customer Item F
     C                     END                             *FI
      * *** 20 PROCESS COMPONANT CITMOV IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CITMOV
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,021                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Customer Item Market +/-
     C                     EXSR UZSUBR                     Customer Item M
     C                     END                             *FI
      * *** 21 PROCESS COMPONANT CSFRTO IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CSFRTO
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,022                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Customer Sales Freight Overage
     C                     EXSR NASUBR                     Customer Sales
     C                     END                             *FI
      * *** 22 PROCESS COMPONANT PSITPR IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is PSITPR
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,023                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Price Sheet Item Price
     C                     EXSR NBSUBR                     Price Sheet Ite
     C                     END                             *FI
      * *** 23 PROCESS COMPONANT ITMKTO IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is ITMKTO
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,024                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Item Market +/-
     C                     EXSR NCSUBR                     Item Market +/-
     C                     END                             *FI
      * *** 24 PROCESS COMPONANT MKTOVR IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is MKTOVR
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,025                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Item Market Overage
     C                     EXSR NDSUBR                     Item Market Ove
     C                     END                             *FI
      * *** 25 PROCESS COMPONENT GATADJ IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is GATADJ
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,026                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Gate price adjustment
     C                     EXSR NESUBR                     Gate price adju
     C                     END                             *FI
      * *** 26 PROCESS COMPONENT DVGADJ IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is DVFADJ
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,027                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Flat Duty Item Pricing
     C                     EXSR NFSUBR                     Flat Duty Item
     C                     END                             *FI
      * *** 27 PROCESS COMPONANT CCITOV IF SELECTED AND IS ACTIVE-*
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Componant is CCITOV
      *   |- c2    : DB1.PD Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAQ9CD    IFEQ @CN,028                    *IF
     C           WAU6ST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Company Customer Item Overage
     C                     EXSR NGSUBR                     Company Custome
     C                     END                             *FI
     C           KRSSA     READE@IKRESI                  90*
     C                     ENDDO
      * USER: Exit processing
      * Convert from CWT to Pricing U/M if Market or Formula Pricing
      * CASE:
      *  - c1 OR (c2 AND c3) OR c4
      *   |- c1    : PAR.Price Method Type is Market or Formula
      *   |- c2    : PAR.Price Method Type is Contract Pricing
      *   |- c3    : PAR.PMH Price Type is Ceiling Price
      *   |- c4    : PAR.Price Method Type is Published Pricing
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1V8ST    IFEQ 'F'                        *IF
     C           P1V8ST    OREQ 'K'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P1V8ST    IFEQ 'Q'                        *IF
     C           P1H3ST    IFEQ 'C'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P1V8ST    IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CLC Cvt Price-From CW  XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDZ2XFR'              90  CLC Cvt Price-F
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0261  30       Company Number
     C                     PARM P1HGCD    WQ0262  70       Item Code
     C                     PARM P1AKPR    WQ0263 114       Unit Price
     C           WN0009    PARM *ZERO     WQ0264 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZ2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 05/05/10 PKD P000205 Sales Price Book: Decimal Places & Ceiling P
      * Cvt Decimal Places    IF
      * CASE: PAR.Decimal Places Rounded is Zero
     C           P1RMNY    IFEQ 0                          *IF
     C           WN0009    MULT 1         YL0015    H      Price 11.0 USR
     C                     Z-ADDYL0015    P1AKPR           Unit Price
     C                     ELSE
      * CASE: PAR.Decimal Places Rounded is One
     C           P1RMNY    IFEQ 1                          *IF
     C           WN0009    MULT 1         YL0016    H      Price 11.1 USR
     C                     Z-ADDYL0016    P1AKPR           Unit Price
     C                     ELSE
      * CASE: PAR.Decimal Places Rounded is Two
     C           P1RMNY    IFEQ 2                          *IF
     C           WN0009    MULT 1         YL0017    H      Price 11.2 USR
     C                     Z-ADDYL0017    P1AKPR           Unit Price
     C                     ELSE
      * CASE: PAR.Decimal Places Rounded is Three
     C           P1RMNY    IFEQ 3                          *IF
     C           WN0009    MULT 1         YL0018    H      Price 11.3 USR
     C                     Z-ADDYL0018    P1AKPR           Unit Price
     C                     ELSE
      * CASE: PAR.Decimal Places Rounded is Four
     C           P1RMNY    IFEQ 4                          *IF
     C           WN0009    MULT 1         YL0019           Price 11.4 USR
     C                     Z-ADDYL0019    P1AKPR           Unit Price
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Ceiling Price
      * CASE: PAR.OD Ceiling Price is Greater than zero
     C           P1DWPR    IFGT 0                          *IF
      * CASE: PAR.Unit Price GT PAR.OD Ceiling Price
     C           P1AKPR    IFGT P1DWPR                     *IF
     C                     Z-ADDP1DWPR    P1AKPR           Unit Price
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Price has been converted to Pricing U/M Price
      * Now convert to the 3 U/M's Parms which will also calc Selling
      * U/M Price.
      * CLC Convert Price Qtys XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKGXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0265  30       Company Number
     C                     PARM P1HGCD    WQ0266  70       Item Code
     C           P6AICD    PARM P6AICD    WQ0267  2        U/M - Pricing
     C           P7APPR    PARM P7APPR    WQ0268 114       Price based on
     C           P7AQPR    PARM P7AQPR    WQ0269 114       Price based on
     C           P7ARPR    PARM P7ARPR    WQ0270 114       Price based on
     C                     PARM P1AKPR    WQ0271 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * U/M - Pricing was moved to Wrk context at the beginning.  If the
      * Pricing Method = EXT then the "Par.U/M - Price" was changed to th
      * U/M - Ordered in order to be able to divide the Extended amount b
      * the quantity order to determine the selling U/M Price, therefore
      * move back the original value prior to exit.
     C                     Z-ADDP1AKPR    P1TPVA           Pricing Retriev
     C                     MOVELWUAICD    P6AICD           U/M - Pricing
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Date Range Avg Cd RT - Market Date Method  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBXST    WQSB01           System using Da
     C           *LIKE     DEFN WBRECD    WQSB02           CTL Date Type
     C           *LIKE     DEFN WBAIC3    WQSB03           Company Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           System using Da
     C                     KFLD           WQSB02           CTL Date Type
     C                     KFLD           WQSB03           Company Number
      * Setup key
     C                     MOVEL'O'       WQSB01           System using Da
     C                     MOVEL'R'       WQSB02           CTL Date Type
     C                     Z-ADDWAAIC3    WQSB03           Company Number
      * Establish starting position
     C           KRSSB     SETLL@IPREHD                    *
     C           KRSSB     READE@IPREHD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1681' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Date Method Cod
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBRDCD    YL0004           Date Method Cod
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@IPREHD                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCLQCD    WQSC01           Commodity Marke
     C           *LIKE     DEFN WCLRCD    WQSC02           Commodity Price
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Commodity Marke
     C                     KFLD           WQSC02           Commodity Price
     C                     KFLD           WCEQDT           Market Price Da
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Commodity Marke
     C                     KFLD           WQSC02           Commodity Price
      * Setup key
     C                     MOVELWL0001    WQSC01           Commodity Marke
     C                     MOVELWL0002    WQSC02           Commodity Price
     C                     Z-ADDWL0003    WCEQDT           Market Price Da
      * Establish starting position
     C           KPSSC     SETLL@F0CPEP                    *
     C           KRSSC     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Commodity Marke
     C                     Z-ADD*ZERO     WL0005           USR Date Priced
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWCA5PR    WL0004           Commodity Marke
     C                     Z-ADDWCEQDT    WL0005           USR Date Priced
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Market Details    RT - IP Item Market Details  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDLQCD           Commodity Marke
      * Setup key
     C                     Z-ADDWL0006    WDHGCD           Item Code
     C                     MOVELWL0007    WDLQCD           Commodity Marke
      * Establish starting position
     C           KRSSD     CHAIN@GBREGM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4314' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           Commodity Price
     C                     Z-ADD*ZERO     WL0009           Market Percent
     C                     Z-ADD*ZERO     WL0010           Market Prem/Ded
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDLRCD    WL0008           Commodity Price
     C                     Z-ADDWDG2PC    WL0009           Market Percent
     C                     Z-ADDWDG8PR    WL0010           Market Prem/Ded
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0038  60       Job Time
     C                     MOVEL*BLANK    WN0039 10        User Id
     C                     MOVEL*BLANK    WN0040 10        Job Name
     C                     Z-ADD*ZERO     WN0041  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @IMCPZ4
     C                     Z-ADDWL0011    WEAIC3           Company Number
     C                     Z-ADDWL0012    WEC4NB           Order Number
     C                     Z-ADDWL0013    WEDPNB           Order Sequence
     C                     Z-ADDWL0014    WEUENB           Order Secondary
     C                     MOVELWL0015    WEQ9CD           Price Method Co
     C                     Z-ADDWL0016    WEPDSQ           Price Detail Se
     C                     Z-ADDWL0017    WEBNPR           Componant Price
     C                     MOVELWL0018    WEU6ST           PD Status
     C                     MOVELWL0019    WEUVST           EDI Status 1
     C                     MOVELWL0020    WEUWST           EDI Status 2
     C                     MOVELWL0021    WEUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEQ9CD           Price Method Co
      * Check for duplicate primary key
     C           KLCRSE    SETLL@IMCPZ4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1676' W0RTN   7
      * Send message 'Order Detail Pricing   EX'
     C                     MOVEL'USR1676' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@IMCPZ4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0042  60       Job Time
     C                     MOVEL*BLANK    WN0043 10        User Id
     C                     MOVEL*BLANK    WN0044 10        Job Name
     C                     Z-ADD*ZERO     WN0045  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @IMCPSD
     C                     Z-ADDWL0022    WFAIC3           Company Number
     C                     Z-ADDWL0023    WFC4NB           Order Number
     C                     Z-ADDWL0024    WFDPNB           Order Sequence
     C                     Z-ADDWL0025    WFUENB           Order Secondary
     C                     MOVELWL0026    WFQ9CD           Price Method Co
     C                     Z-ADDWL0027    WFPDSQ           Price Detail Se
     C                     Z-ADDWL0028    WFBNPR           Componant Price
     C                     MOVELWL0029    WFU6ST           PD Status
     C                     MOVELWL0030    WFUVST           EDI Status 1
     C                     MOVELWL0031    WFUWST           EDI Status 2
     C                     MOVELWL0032    WFUXST           EDI Status 3
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFQ9CD           Price Method Co
      * Check for duplicate primary key
     C           KLCRSF    SETLL@IMCPSD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1676' W0RTN   7
      * Send message 'Order Detail Pricing   EX'
     C                     MOVEL'USR1676' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@IMCPSD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * UPD Consumed Items     RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0049  7        Commodity Price
     C                     Z-ADD*ZERO     WN0050  52       Sales Yield
     C                     Z-ADD*ZERO     WN0051 114       Price Adjustmen
     C                     Z-ADD*ZERO     WN0052  70       Date Used for C
     C                     MOVEL*BLANK    WN0053  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0054  94       Conversion Fact
     C                     MOVEL*BLANK    WN0055  1        Operation Facto
     C                     MOVEL*BLANK    WN0056  2        U/M - Second
     C                     Z-ADD*ZERO     WN0057  94       Conversion Fact
     C                     MOVEL*BLANK    WN0058  1        Operation Facto
     C                     MOVEL*BLANK    WN0059  2        U/M - Third
     C                     MOVEL*BLANK    WN0060  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0061 112       Unit Weight
     C                     Z-ADD*ZERO     WN0062 114       Market Overage
     C                     Z-ADD*ZERO     WN0063 114       Standard Overag
     C                     MOVEL*BLANK    WN0064  1        Item Pricing Op
     C                     Z-ADD*ZERO     WN0065 114       Item Pricing Co
     C                     Z-ADD*ZERO     WN0066 114       Market Value
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Conversion Documentation
     C                     EXSR UESUBR                     Conversion Docu
     C                     Z-ADD0         WUZXNB           Pricing Sequenc
     C                     Z-ADD0         P1TPVA           Pricing Retriev
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGHGCD    WQSG02           Item Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSG01           Company Number
     C                     Z-ADDP1HGCD    WQSG02           Item Code
      * Establish starting position
     C           KRSSG     SETLL@IOREYG                    *
     C           KRSSG     READE@IOREYG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     MOVEL'U'       P1U1ST           Price Status
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'CNF'     P2WZST           Error Return
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Retrieve Starting Item Details
      * XF RTV Item Details    XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKAXFR'              90  RTV Item Detail
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0064  30       Company Number
     C                     PARM WGC9NB    WQ0065  70       Item Code
     C           WN0053    PARM *BLANK    WQ0066  2        U/M - Primary
     C           WN0054    PARM *ZERO     WQ0067  94       Conversion Fact
     C           WN0055    PARM *BLANK    WQ0068  1        Operation Facto
     C           WN0056    PARM *BLANK    WQ0069  2        U/M - Second
     C           WN0057    PARM *ZERO     WQ0070  94       Conversion Fact
     C           WN0058    PARM *BLANK    WQ0071  1        Operation Facto
     C           WN0059    PARM *BLANK    WQ0072  2        U/M - Third
     C           WN0060    PARM *BLANK    WQ0073  2        U/M - Pricing
     C           WN0061    PARM *ZERO     WQ0074 112       Unit Weight
     C           WUBLPR    PARM *ZERO     WQ0075 114       Market Overage
     C           WUBMPR    PARM *ZERO     WQ0076 114       Standard Overag
     C           WN0049    PARM *BLANK    WQ0077  7        Commodity Price
     C           WN0064    PARM *BLANK    WQ0078  1        Item Pricing Op
     C           WN0065    PARM *ZERO     WQ0079 114       Item Pricing Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *** Price Routine was call on or after Shipping, Calculate Price
      * CASE: PAR.Event Called From is All Values
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '99'
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * *** Calculate or Retrieve Market Date Method Processing
      * CASE: PAR.Date Method Code is Entered
     C           P1RDCD    IFNE *BLANK                     *IF
      * CLC Date Method        XF - Market Date Method  * 
     C                     CALL 'PDLJXFR'              90  CLC Date Method
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0080  30       Company Number
     C                     PARM P1RDCD    WQ0081  3        Date Method Cod
     C                     PARM P1GNDT    WQ0082  70       Actual Shipped
     C                     PARM P1EIDT    WQ0083  70       Requested Deliv
     C                     PARM P1A5DT    WQ0084  70       Requested Ship
     C                     PARM P1D3DT    WQ0085  70       Date of Orig. E
     C                     PARM P1LQCD    WQ0086  3        Commodity Marke
     C                     PARM P1EXDT    WQ0087  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WQ0088  1        Price Status
     C           P1GIDT    PARM *ZERO     WQ0089  70       Pricing Date Us
     C           WUTPVA    PARM WUTPVA    WQ0090 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0091  2        Event Called Fr
     C                     PARM WN0049    WQ0092  7        Commodity Price
     C                     PARM P1TKDT    WQ0093  70       OD Market Begin
     C                     PARM P1TLDT    WQ0094  70       OD Market Endin
     C           WN0052    PARM WN0052    WQ0095  70       Date Used for C
     C           P2WZST    PARM *BLANK    WQ0096  5        Date Error Retu
     C                     PARM WGHGCD    WQ0097  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *** Retrieve Market Pricing if the Following criteria is met
      * CASE: PAR.Date Method Code is Not Entered
     C           P1RDCD    IFEQ *BLANK                     *IF
      * Load Date used for calculation (to retrieve Market date)
      * CASE: PAR.Market Pricing Date is NE Zero
     C           P1EXDT    IFNE 0                          *IF
     C                     Z-ADDP1EXDT    WN0052           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Date Used for Calculation is not entered
     C           WN0052    IFEQ 0                          *IF
      * CASE: PAR.Actual Shipped Date is entered
     C           P1GNDT    IFNE 0                          *IF
     C                     Z-ADDP1GNDT    WN0052           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1A5DT    WN0052           Date Used for C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Market Price       RT - OM Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1LQCD    WL0001    P      Commodity Marke
     C                     MOVELWN0049    WL0002    P      Commodity Price
     C                     Z-ADDWN0052    WL0003           Market Price Da
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WUTPVA           Commodity Marke
     C                     Z-ADDWL0005    P1GIDT           USR Date Priced
      * Flag as Unpriced if Price Date doesn't match Market date entered
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Date Used for Calculation NE WRK.Pricing Date Us
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           WN0052    IFNE WUGIDT                     *IF
     C           W0RTN     OREQ @CN,002                    *OR
     C                     MOVEL'U'       P1U1ST           Price Status
      * If no pricing record was found then flag as pricing error.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'STR'     P2WZST           Error Return
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calc Pct Amount of Starting Item & Accumulate Amount & Write Rcd
     C                     EXSR UFSUBR                     Calc Pct Amount
     C                     ADD  WN0066    P1TPVA           Pricing Retriev
     C           KRSSG     READE@IOREYG                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT Temporary Record   CR - PD Ship Dtl Formula Dtl  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0067  60       Job Time
     C                     MOVEL*BLANK    WN0068 10        User Id
     C                     MOVEL*BLANK    WN0069 10        Job Name
     C                     Z-ADD*ZERO     WN0070  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @JKCPZ6
     C                     Z-ADDWL0033    WHAIC3           Company Number
     C                     Z-ADDWL0034    WHC4NB           Order Number
     C                     Z-ADDWL0035    WHDPNB           Order Sequence
     C                     Z-ADDWL0036    WHUENB           Order Secondary
     C                     MOVELWL0037    WHQ9CD           Price Method Co
     C                     Z-ADDWL0038    WHHGCD           Item Code
     C                     Z-ADDWL0039    WHZXNB           Pricing Sequenc
     C                     Z-ADDWL0040    WHBOPR           Sales Yield
     C                     Z-ADDWL0041    WHCDPR           Market Value
     C                     Z-ADDWL0042    WHCEPR           Credit Value
     C                     MOVELWL0043    WHU6ST           PD Status
     C                     MOVELWL0044    WHUVST           EDI Status 1
     C                     MOVELWL0045    WHUWST           EDI Status 2
     C                     MOVELWL0046    WHUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSH    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHQ9CD           Price Method Co
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHZXNB           Pricing Sequenc
      * Check for duplicate primary key
     C           KLCRSH    SETLL@JKCPZ6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1871' W0RTN   7
      * Send message 'Order Dtl Formula Dtl  EX'
     C                     MOVEL'USR1871' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@JKCPZ6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * CRT Ship Dtl Formula   CR - PD Ship Dtl Formula Dtl  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0071  60       Job Time
     C                     MOVEL*BLANK    WN0072 10        User Id
     C                     MOVEL*BLANK    WN0073 10        Job Name
     C                     Z-ADD*ZERO     WN0074  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @JKCPYE
     C                     Z-ADDWL0047    WIAIC3           Company Number
     C                     Z-ADDWL0048    WIC4NB           Order Number
     C                     Z-ADDWL0049    WIDPNB           Order Sequence
     C                     Z-ADDWL0050    WIUENB           Order Secondary
     C                     MOVELWL0051    WIQ9CD           Price Method Co
     C                     Z-ADDWL0052    WIHGCD           Item Code
     C                     Z-ADDWL0053    WIZXNB           Pricing Sequenc
     C                     Z-ADDWL0054    WIBOPR           Sales Yield
     C                     Z-ADDWL0055    WICDPR           Market Value
     C                     Z-ADDWL0056    WICEPR           Credit Value
     C                     MOVELWL0057    WIU6ST           PD Status
     C                     MOVELWL0058    WIUVST           EDI Status 1
     C                     MOVELWL0059    WIUWST           EDI Status 2
     C                     MOVELWL0060    WIUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRSI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIQ9CD           Price Method Co
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIZXNB           Pricing Sequenc
      * Check for duplicate primary key
     C           KLCRSI    SETLL@JKCPYE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1871' W0RTN   7
      * Send message 'Order Dtl Formula Dtl  EX'
     C                     MOVEL'USR1871' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@JKCPYE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Overages           RT - Customer Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJBKC7           Ship To Custome
     C                     KFLD           WJHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0061    WJAIC3           Company Number
     C                     Z-ADDWL0062    WJBKC7           Ship To Custome
     C                     Z-ADDWL0063    WJHGCD           Item Code
      * Establish starting position
     C           KRSSJ     CHAIN@ISREV7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1687' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0064           Market Overage
     C                     Z-ADD*ZERO     WL0065           Formula Differe
     C                     Z-ADD*ZERO     WL0066           Formula Process
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJBLPR    WL0064           Market Overage
     C                     Z-ADDWJBXPR    WL0065           Formula Differe
     C                     Z-ADDWJBYPR    WL0066           Formula Process
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * UPD Produced Items     RT - PD Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0078  7        Commodity Price
     C                     Z-ADD*ZERO     WN0079  70       Date Used for C
     C                     MOVEL*BLANK    WN0080  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0081  94       Conversion Fact
     C                     MOVEL*BLANK    WN0082  1        Operation Facto
     C                     MOVEL*BLANK    WN0083  2        U/M - Second
     C                     Z-ADD*ZERO     WN0084  94       Conversion Fact
     C                     MOVEL*BLANK    WN0085  1        Operation Facto
     C                     MOVEL*BLANK    WN0086  2        U/M - Third
     C                     MOVEL*BLANK    WN0087  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0088 112       Unit Weight
     C                     Z-ADD*ZERO     WN0089 114       Market Overage
     C                     Z-ADD*ZERO     WN0090 114       Standard Overag
     C                     MOVEL*BLANK    WN0091  1        Item Pricing Op
     C                     Z-ADD*ZERO     WN0092 114       Item Pricing Co
     C                     Z-ADD*ZERO     WN0093 114       Price Adjustmen
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUZXNB           Pricing Sequenc
     C                     Z-ADD0         P1TPVA           Pricing Retriev
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WKHGCD    WQSK02           Item Code
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSK01           Company Number
     C                     Z-ADDP1HGCD    WQSK02           Item Code
      * Establish starting position
     C           KRSSK     SETLL@IOREYH                    *
     C           KRSSK     READE@IOREYH                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     MOVEL'U'       P1U1ST           Price Status
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'PNF'     P2WZST           Error Return
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Retrieve Credit(Produced) Item Details
      * XF RTV Item Details    XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKAXFR'              90  RTV Item Detail
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WKAIC3    WQ0106  30       Company Number
     C                     PARM WKC9NB    WQ0107  70       Item Code
     C           WN0080    PARM *BLANK    WQ0108  2        U/M - Primary
     C           WN0081    PARM *ZERO     WQ0109  94       Conversion Fact
     C           WN0082    PARM *BLANK    WQ0110  1        Operation Facto
     C           WN0083    PARM *BLANK    WQ0111  2        U/M - Second
     C           WN0084    PARM *ZERO     WQ0112  94       Conversion Fact
     C           WN0085    PARM *BLANK    WQ0113  1        Operation Facto
     C           WN0086    PARM *BLANK    WQ0114  2        U/M - Third
     C           WN0087    PARM *BLANK    WQ0115  2        U/M - Pricing
     C           WN0088    PARM *ZERO     WQ0116 112       Unit Weight
     C           WUBLPR    PARM *ZERO     WQ0117 114       Market Overage
     C           WUBMPR    PARM *ZERO     WQ0118 114       Standard Overag
     C           WN0078    PARM *BLANK    WQ0119  7        Commodity Price
     C           WN0091    PARM *BLANK    WQ0120  1        Item Pricing Op
     C           WN0092    PARM *ZERO     WQ0121 114       Item Pricing Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *** Price Routine
      * CASE: PAR.Event Called From is All Values
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '99'
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * *** Calculate or Retrieve Market Date Method Processing
      * CASE: PAR.Date Method Code is Entered
     C           P1RDCD    IFNE *BLANK                     *IF
      * CLC Date Method        XF - Market Date Method  * 
     C                     CALL 'PDLJXFR'              90  CLC Date Method
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0122  30       Company Number
     C                     PARM P1RDCD    WQ0123  3        Date Method Cod
     C                     PARM P1GNDT    WQ0124  70       Actual Shipped
     C                     PARM P1EIDT    WQ0125  70       Requested Deliv
     C                     PARM P1A5DT    WQ0126  70       Requested Ship
     C                     PARM P1D3DT    WQ0127  70       Date of Orig. E
     C                     PARM P1LQCD    WQ0128  3        Commodity Marke
     C                     PARM P1EXDT    WQ0129  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WQ0130  1        Price Status
     C           WUGIDT    PARM *ZERO     WQ0131  70       Pricing Date Us
     C           P1TPVA    PARM P1TPVA    WQ0132 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0133  2        Event Called Fr
     C                     PARM WN0078    WQ0134  7        Commodity Price
     C                     PARM P1TKDT    WQ0135  70       OD Market Begin
     C                     PARM P1TLDT    WQ0136  70       OD Market Endin
     C           WN0079    PARM WN0079    WQ0137  70       Date Used for C
     C           P2WZST    PARM *BLANK    WQ0138  5        Date Error Retu
     C                     PARM WKHGCD    WQ0139  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *** Retrieve Market Pricing if the Following criteria is met
      * CASE: PAR.Date Method Code is Not Entered
     C           P1RDCD    IFEQ *BLANK                     *IF
      * Load Date used for calculation (to retrieve Market date)
      * CASE: PAR.Market Pricing Date is NE Zero
     C           P1EXDT    IFNE 0                          *IF
     C                     Z-ADDP1EXDT    WN0079           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Date Used for Calculation is not entered
     C           WN0079    IFEQ 0                          *IF
      * CASE: PAR.Actual Shipped Date is entered
     C           P1GNDT    IFNE 0                          *IF
     C                     Z-ADDP1GNDT    WN0079           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1A5DT    WN0079           Date Used for C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Market Price       RT - OM Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1LQCD    WL0001    P      Commodity Marke
     C                     MOVELWN0078    WL0002    P      Commodity Price
     C                     Z-ADDWN0079    WL0003           Market Price Da
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    P1TPVA           Commodity Marke
     C                     Z-ADDWL0005    WUGIDT           USR Date Priced
      * Flag as Unpriced if Price Date doesn't match Market date entered
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Date Used for Calculation NE WRK.Pricing Date Us
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           WN0079    IFNE WUGIDT                     *IF
     C           W0RTN     OREQ @CN,002                    *OR
     C                     MOVEL'U'       P1U1ST           Price Status
      * If no pricing record was found then flag as pricing error.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'TRC'     P2WZST           Error Return
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calc Pct Amount of Credit Items & Write record to Formula Detail
     C                     EXSR UJSUBR                     Calc Pct Amount
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           KRSSK     READE@IOREYH                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Formula Overage    RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0067    WLAIC3           Company Number
     C                     Z-ADDWL0068    WLHGCD           Item Code
      * Establish starting position
     C           KRSSL     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLBLPR    WL0069           Market Overage
     C                     Z-ADDWLBMPR    WL0070           Standard Overag
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Mkt/Form Overage   RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWAAIC3    WMAIC3           Company Number
     C                     Z-ADDP1BKC7    WMBKC7           Ship To Custome
      * Establish starting position
     C           KRSSM     CHAIN@EOREUB              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMW2NB    WN0097           Co/Cust Overage
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Dsc,U/M,PrcInf,Str RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WLAIC3           Company Number
     C                     Z-ADDP1HGCD    WLHGCD           Item Code
      * Establish starting position
     C           KRSSN     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           U/M - Pricing
     C                     Z-ADD*ZERO     YL0007           Unit Weight
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLAICD    YL0006           U/M - Pricing
     C                     Z-ADDWLAIWG    YL0007           Unit Weight
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Accrual Info      RT - Customer Accrual  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0110  30       Item Structure
     C                     Z-ADD*ZERO     WN0111  30       Item Structure
     C                     Z-ADD*ZERO     WN0112  30       Item Structure
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         P1TPVA           Pricing Retriev
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOBKC7    WQSO01           Ship To Custome
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSO01           Ship To Custome
      * Establish starting position
     C           KRSSO     SETLL@HORELA                    *
     C           KRSSO     READE@HORELA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1520' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBKPR           Accrual Rate
     C                     Z-ADD*ZERO     P1TPVA           Pricing Retriev
     C                     Z-ADD*ZERO     WN0110           Item Structure
     C                     Z-ADD*ZERO     WN0111           Item Structure
     C                     Z-ADD*ZERO     WN0112           Item Structure
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** The par.period begin date is either the Actual Shipped date
      * ** from the Order Detail file unless it is zeros, then it is
      * ** replaced by the Requested Ship Date.
      * ** Select the record where the ASD is within the date range
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Period Beginning Date GE DB1.Period Beginning Da
      *   |- c2    : PAR.Period Beginning Date LE DB1.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUFADT    IFGE WOBFDT                     *IF
     C           WUFADT    IFLE WOA2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Accrual Info-All   RT - Accrual Program  * 
     C                     EXSR SPRVGN
      * CASE: LCL.Affect Invoice Price is yes
     C           YL0010    IFEQ 'Y'                        *IF
      * ** Accumulate rate based on All Products Y/N value
      * CASE: DB1.All Products (Y/N) is Yes
     C           WOTTST    IFEQ 'Y'                        *IF
     C                     Z-ADDWOBKPR    YL0011           Accrual Rate
      * ** If YES, then use the rate from the Customer Accrual record
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0009    IFEQ 'S'                        *IF
     C           0         SUB  WOBKPR    YL0011           Accrual Rate
     C                     END                             *FI
     C                     ADD  YL0011    P1TPVA           Pricing Retriev
     C                     ELSE
      * CASE: DB1.All Products (Y/N) is Yes + Exceptions
     C           WOTTST    IFEQ 'X'                        *IF
      * ** If YES + Exceptions, then add the rate from either the Custome
      * ** Accrual Str or Customer Accrual Item file. The value in
      * ** the Accrual Detail Search field will determine which file.
      * ** If no record in either file then add the Customer Accural rate
      * Retrieve Accrual Rate
      * CASE: DB1.Accrual Detail Search is Item
     C           WOQFSX    IFEQ 'I'                        *IF
      * Rtv Item Accrual Rate RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0071           Ship To Custome
     C                     MOVELWOOJCD    WL0072    P      Accrual Code
     C                     Z-ADDWOGUNY    WL0073           CAH Sequence No
     C                     Z-ADDP1HGCD    WL0074           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0075    YL0011           Accrual Rate
     C                     ELSE
      * CASE: DB1.Accrual Detail Search is Item Structure
     C           WOQFSX    IFEQ 'S'                        *IF
      * ** Retrieve the Item Structure fields from the Order Detail
      * Rtv Item FOB Price    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0076           Company Number
     C                     Z-ADDP3C4NB    WL0077           Order Number
     C                     Z-ADDP1HGCD    WL0078           Item Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    YN0052           Price Overage O
     C                     Z-ADDWL0080    YN0053           Contract Number
     C                     MOVELWL0081    YN0054    P      Price Status
     C                     MOVELWL0082    YN0055    P      U/M - Ordered
     C                     Z-ADDWL0083    YN0056           Unit Price
     C                     Z-ADDWL0084    YN0057           Unit Price - Cr
     C                     Z-ADDWL0085    YN0058           Unit Price Orde
     C                     Z-ADDWL0086    YN0059           Unit Weight Ord
     C                     Z-ADDWL0087    YN0060           Actual Shipped
     C                     MOVELWL0088    YN0061    P      Affect Inventor
     C                     MOVELWL0089    YN0062    P      Affect Sales Do
     C                     MOVELWL0090    YN0063    P      Affect Sales Pn
     C                     Z-ADDWL0091    WN0110           Item Structure
     C                     Z-ADDWL0092    WN0111           Item Structure
     C                     Z-ADDWL0093    WN0112           Item Structure
     C                     MOVELWL0094    YN0064    P      Affect Trade Fu
     C                     MOVELWL0095    YN0065    P      Affect Commissi
     C                     MOVELWL0096    YN0066    P      Affect Pricing
     C                     MOVELWL0097    YN0067    P      Ord TF Exempt C
      * PKD/SZ 07/20/09 Should check with Type/Group/Class first then jus
      *                 Type/Group.
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0098           Ship To Custome
     C                     MOVELWOOJCD    WL0099    P      Accrual Code
     C                     Z-ADDWOGUNY    WL0100           CAH Sequence No
     C                     Z-ADDWN0110    WL0101           Item Structure
     C                     Z-ADDWN0111    WL0102           Item Structure
     C                     Z-ADDWN0112    WL0103           Item Structure
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0104    YL0011           Accrual Rate
     C                     MOVELWL0105    YN0044    P      Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0098           Ship To Custome
     C                     MOVELWOOJCD    WL0099    P      Accrual Code
     C                     Z-ADDWOGUNY    WL0100           CAH Sequence No
     C                     Z-ADDWN0110    WL0101           Item Structure
     C                     Z-ADDWN0111    WL0102           Item Structure
     C                     Z-ADD0         WL0103           Item Structure
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0104    YL0011           Accrual Rate
     C                     MOVELWL0105    YN0044    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SZ 07/17/09 commented out. was overlaying when the accrual except
      * PKD/SZ 07/20/09 -- Needed to check if the Item was found or not.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWOBKPR    YL0011           Accrual Rate
     C                     END                             *FI
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0009    IFEQ 'S'                        *IF
     C           0         SUB  YL0011    YL0011           Accrual Rate
     C                     END                             *FI
     C                     ADD  YL0011    P1TPVA           Pricing Retriev
     C                     ELSE
      * CASE: DB1.All Products (Y/N) is No
     C           WOTTST    IFEQ 'N'                        *IF
      * ** If NO, then only accumulate the rate if there is a record
      * ** in either the Customer Accrual Str or Customer Accrual Item
      * ** file. If no record in either file, just add zeros.
      * CASE: DB1.Accrual Detail Search is Item
     C           WOQFSX    IFEQ 'I'                        *IF
      * Rtv Item Accrual Rate RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0071           Ship To Custome
     C                     MOVELWOOJCD    WL0072    P      Accrual Code
     C                     Z-ADDWOGUNY    WL0073           CAH Sequence No
     C                     Z-ADDP1HGCD    WL0074           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0075    YL0011           Accrual Rate
     C                     ELSE
      * CASE: DB1.Accrual Detail Search is Item Structure
     C           WOQFSX    IFEQ 'S'                        *IF
      * Rtv Item FOB Price    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0076           Company Number
     C                     Z-ADDP3C4NB    WL0077           Order Number
     C                     Z-ADDP1HGCD    WL0078           Item Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    YN0052           Price Overage O
     C                     Z-ADDWL0080    YN0053           Contract Number
     C                     MOVELWL0081    YN0054    P      Price Status
     C                     MOVELWL0082    YN0055    P      U/M - Ordered
     C                     Z-ADDWL0083    YN0056           Unit Price
     C                     Z-ADDWL0084    YN0057           Unit Price - Cr
     C                     Z-ADDWL0085    YN0058           Unit Price Orde
     C                     Z-ADDWL0086    YN0059           Unit Weight Ord
     C                     Z-ADDWL0087    YN0060           Actual Shipped
     C                     MOVELWL0088    YN0061    P      Affect Inventor
     C                     MOVELWL0089    YN0062    P      Affect Sales Do
     C                     MOVELWL0090    YN0063    P      Affect Sales Pn
     C                     Z-ADDWL0091    WN0110           Item Structure
     C                     Z-ADDWL0092    WN0111           Item Structure
     C                     Z-ADDWL0093    WN0112           Item Structure
     C                     MOVELWL0094    YN0064    P      Affect Trade Fu
     C                     MOVELWL0095    YN0065    P      Affect Commissi
     C                     MOVELWL0096    YN0066    P      Affect Pricing
     C                     MOVELWL0097    YN0067    P      Ord TF Exempt C
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Item Structure Type Code is Not Entered
      *   |- c2    : PAR.Item Structure Group Code is Not Entered
      *   '-
     C           WN0110    IFEQ 0                          *IF
     C           WN0111    OREQ 0                          *OR
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
     C                     EXSR STRVGN
     C                     END                             *FI
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0098           Ship To Custome
     C                     MOVELWOOJCD    WL0099    P      Accrual Code
     C                     Z-ADDWOGUNY    WL0100           CAH Sequence No
     C                     Z-ADDWN0110    WL0101           Item Structure
     C                     Z-ADDWN0111    WL0102           Item Structure
     C                     Z-ADDWN0112    WL0103           Item Structure
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0104    YL0011           Accrual Rate
     C                     MOVELWL0105    YN0044    P      Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0098           Ship To Custome
     C                     MOVELWOOJCD    WL0099    P      Accrual Code
     C                     Z-ADDWOGUNY    WL0100           CAH Sequence No
     C                     Z-ADDWN0110    WL0101           Item Structure
     C                     Z-ADDWN0111    WL0102           Item Structure
     C                     Z-ADD0         WL0103           Item Structure
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0104    YL0011           Accrual Rate
     C                     MOVELWL0105    YN0044    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0009    IFEQ 'S'                        *IF
     C           0         SUB  YL0011    YL0011           Accrual Rate
     C                     END                             *FI
     C                     ADD  YL0011    P1TPVA           Pricing Retriev
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@HORELA                  90*
     C                     ENDDO
      * USER: Exit processing
      * RTV Item Pricing Info  RT - Company Item  * 
     C                     EXSR SURVGN
      * CASE:
      *  - c1 OR c3 OR c4
      *   |- c1    : LCL.U/M - Pricing is Carcass Hundred Weight
      *   |- c3    : LCL.U/M - Pricing is Thousand
      *   |- c4    : LCL.U/M - Pricing is Tons
      *   '-
     C           YL0012    IFEQ 'CW'                       *IF
     C           YL0012    OREQ 'M'                        *OR
     C           YL0012    OREQ 'TN'                       *OR
      * Hundred Weight
      * CASE: LCL.U/M - Pricing is Hundred Weight
     C           YL0012    IFEQ 'CW'                       *IF
      * PAR.Pricing Retrieved Amount =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pricing Retrieved Amount
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.100
     C           P1TPVA    MULT 100       W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Thousand
      * CASE: LCL.U/M - Pricing is Thousand
     C           YL0012    IFEQ 'M'                        *IF
      * PAR.Pricing Retrieved Amount =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pricing Retrieved Amount
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.1000
     C           P1TPVA    MULT 1000      W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Tons
      * CASE: LCL.U/M - Pricing is Tons
     C           YL0012    IFEQ 'TN'                       *IF
      * PAR.Pricing Retrieved Amount =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pricing Retrieved Amount
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.2000
     C           P1TPVA    MULT 2000      W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    P1TPVA           Pricing Retriev
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Accrual Info-All   RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WROJCD           Accrual Code
      * Setup key
     C                     MOVELWOOJCD    WROJCD           Accrual Code
      * Establish starting position
     C           KRSSP     CHAIN@HLREK4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0009           Add-on/Allowanc
     C                     MOVEL*BLANK    YL0010           Affect Invoice
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWRTSST    YL0009           Add-on/Allowanc
     C                     MOVELWRFFTX    YL0010           Affect Invoice
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Item Accrual Rate RT - Customer Accrual Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WSBKC7           Ship To Custome
     C                     KFLD           WSOJCD           Accrual Code
     C                     KFLD           WSGUNY           CAH Sequence No
     C                     KFLD           WSHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0071    WSBKC7           Ship To Custome
     C                     MOVELWL0072    WSOJCD           Accrual Code
     C                     Z-ADDWL0073    WSGUNY           CAH Sequence No
     C                     Z-ADDWL0074    WSHGCD           Item Code
      * Establish starting position
     C           KRSSQ     CHAIN@HPRELD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1522' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0075           Accrual Rate
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWSBKPR    WL0075           Accrual Rate
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Item FOB Price    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQSR01           Company Number
     C           *LIKE     DEFN WTC4NB    WQSR02           Order Number
     C           *LIKE     DEFN WTHGCD    WQSR03           Item Code
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
     C                     KFLD           WQSR03           Item Code
      * Setup key
     C                     Z-ADDWL0076    WQSR01           Company Number
     C                     Z-ADDWL0077    WQSR02           Order Number
     C                     Z-ADDWL0078    WQSR03           Item Code
      * Establish starting position
     C           KRSSR     SETLL@BGWKFW                    *
     C           KRSSR     READE@BGWKFW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0079           Price Overage O
     C                     Z-ADD*ZERO     WL0080           Contract Number
     C                     MOVEL*BLANK    WL0081           Price Status
     C                     MOVEL*BLANK    WL0082           U/M - Ordered
     C                     Z-ADD*ZERO     WL0083           Unit Price
     C                     Z-ADD*ZERO     WL0084           Unit Price - Cr
     C                     Z-ADD*ZERO     WL0085           Unit Price Orde
     C                     Z-ADD*ZERO     WL0086           Unit Weight Ord
     C                     Z-ADD*ZERO     WL0087           Actual Shipped
     C                     MOVEL*BLANK    WL0088           Affect Inventor
     C                     MOVEL*BLANK    WL0089           Affect Sales Do
     C                     MOVEL*BLANK    WL0090           Affect Sales Pn
     C                     Z-ADD*ZERO     WL0091           Item Structure
     C                     Z-ADD*ZERO     WL0092           Item Structure
     C                     Z-ADD*ZERO     WL0093           Item Structure
     C                     MOVEL*BLANK    WL0094           Affect Trade Fu
     C                     MOVEL*BLANK    WL0095           Affect Commissi
     C                     MOVEL*BLANK    WL0096           Affect Pricing
     C                     MOVEL*BLANK    WL0097           Ord TF Exempt C
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWTBZPR    WL0079           Price Overage O
     C                     Z-ADDWTL6NB    WL0080           Contract Number
     C                     MOVELWTU1ST    WL0081           Price Status
     C                     MOVELWTAGCD    WL0082           U/M - Ordered
     C                     Z-ADDWTAKPR    WL0083           Unit Price
     C                     Z-ADDWTALPR    WL0084           Unit Price - Cr
     C                     Z-ADDWTAUPR    WL0085           Unit Price Orde
     C                     Z-ADDWTAVWG    WL0086           Unit Weight Ord
     C                     Z-ADDWTGNDT    WL0087           Actual Shipped
     C                     MOVELWTAMST    WL0088           Affect Inventor
     C                     MOVELWTANST    WL0089           Affect Sales Do
     C                     MOVELWTVAST    WL0090           Affect Sales Pn
     C                     Z-ADDWTRGNB    WL0091           Item Structure
     C                     Z-ADDWTRHNB    WL0092           Item Structure
     C                     Z-ADDWTRINB    WL0093           Item Structure
     C                     MOVELWTF0SX    WL0094           Affect Trade Fu
     C                     MOVELWTF1SX    WL0095           Affect Commissi
     C                     MOVELWTF2SX    WL0096           Affect Pricing
     C                     MOVELWTF4SX    WL0097           Ord TF Exempt C
     C           KRSSR     READE@BGWKFW                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WVBKC7           Ship To Custome
     C                     KFLD           WVOJCD           Accrual Code
     C                     KFLD           WVGUNY           CAH Sequence No
     C                     KFLD           WVRGNB           Item Structure
     C                     KFLD           WVRHNB           Item Structure
     C                     KFLD           WVRINB           Item Structure
      * Setup key
     C                     Z-ADDWL0098    WVBKC7           Ship To Custome
     C                     MOVELWL0099    WVOJCD           Accrual Code
     C                     Z-ADDWL0100    WVGUNY           CAH Sequence No
     C                     Z-ADDWL0101    WVRGNB           Item Structure
     C                     Z-ADDWL0102    WVRHNB           Item Structure
     C                     Z-ADDWL0103    WVRINB           Item Structure
      * Establish starting position
     C           KRSSS     CHAIN@C8RES1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3294' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0104           Accrual Rate
     C                     MOVEL*BLANK    WL0105           Accrual Rate Ty
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWVBKPR    WL0104           Accrual Rate
     C                     MOVELWVSHSX    WL0105           Accrual Rate Ty
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WLAIC3           Company Number
     C                     Z-ADDP1HGCD    WLHGCD           Item Code
      * Establish starting position
     C           KRSST     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLRINB    WN0112           Item Structure
     C                     Z-ADDWLRHNB    WN0111           Item Structure
     C                     Z-ADDWLRGNB    WN0110           Item Structure
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Item Pricing Info  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WLAIC3           Company Number
     C                     Z-ADDP1HGCD    WLHGCD           Item Code
      * Establish starting position
     C           KRSSU     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLAICD    YL0012           U/M - Pricing
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Shipping Method   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WWAIC3           Company Number
     C                     Z-ADDP3C4NB    WWC4NB           Order Number
      * Establish starting position
     C           KRSSV     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0013           Shipping Method
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWWQ2CD    YL0013           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Absorbed Frt Rate RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0113           Absorbed Freigh
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WWAIC3           Company Number
     C                     Z-ADDP3C4NB    WWC4NB           Order Number
      * Establish starting position
     C           KRSSW     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWWTBNB    WN0113           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Item Freight Over RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WLAIC3           Company Number
     C                     Z-ADDP1HGCD    WLHGCD           Item Code
      * Establish starting position
     C           KRSSX     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLCGNB    YL0014           Item Frt Overag
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *** C2742 8/27/13 RMC COMMENT sales price book rtv - NEVER IMPLEM
      * *****
      * ** 05/02/2013 RMC E2494 Flat Duty Item pricing component
      * *****
      * ** 04/01/2013 RMC E2494 Gate Adjustment component
      * *****
      * ** 05/23/2007 LJB DLY029
      * ** Add calculation for new ACCRLS Pricing Component for Dailys.
      * *****
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Retrieve Market Pricing
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0026  70       Date Used for C
     C                     MOVEL*BLANK    WN0027  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0028  94       Conversion Fact
     C                     MOVEL*BLANK    WN0029  1        Operation Facto
     C                     MOVEL*BLANK    WN0030  2        U/M - Second
     C                     Z-ADD*ZERO     WN0031  94       Conversion Fact
     C                     MOVEL*BLANK    WN0032  1        Operation Facto
     C                     MOVEL*BLANK    WN0033  2        U/M - Third
     C                     MOVEL*BLANK    WN0034  2        U/M - Pricing
     C                     MOVEL*BLANK    WN0035  3        Default Commod
     C                     Z-ADD*ZERO     WN0036 114       Price Adjustmen
     C                     MOVEL*BLANK    WN0037  7        Commodity Price
      *
      * RTV Pricing: MKTPRC   IF
      * Conversion Documentation
     C                     EXSR UCSUBR                     Conversion Docu
      * E3947 2/23/2015 RMC
      *  If commodity price group is TPA, use item code as the group inst
     C                     MOVELWN0004    WN0037           Commodity Price
      * *** Price Routine was call on or after Shipping, Calculate Price
      * CASE: PAR.Event Called From is All Values
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '99'
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Commodity Price Group is Third Party Avg
     C           WN0004    IFEQ 'TPA'                      *IF
     C                     MOVEL*BLANK    YL0003           Item Code Txt
     C                     MOVELP1HGCD    YL0003           Item Code Txt
     C                     MOVELYL0003    WN0037           Commodity Price
     C                     END                             *FI
      * *** Calculate Date Method Price if Selected
      * CASE: PAR.Date Method Code is Entered
     C           P1RDCD    IFNE *BLANK                     *IF
      * CLC Date Method        XF - Market Date Method  * 
     C                     CALL 'PDLJXFR'              90  CLC Date Method
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0021  30       Company Number
     C                     PARM P1RDCD    WQ0022  3        Date Method Cod
     C                     PARM P1GNDT    WQ0023  70       Actual Shipped
     C                     PARM P1EIDT    WQ0024  70       Requested Deliv
     C                     PARM P1A5DT    WQ0025  70       Requested Ship
     C                     PARM P1D3DT    WQ0026  70       Date of Orig. E
     C                     PARM P1LQCD    WQ0027  3        Commodity Marke
     C                     PARM P1EXDT    WQ0028  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WQ0029  1        Price Status
     C           P1GIDT    PARM *ZERO     WQ0030  70       Pricing Date Us
     C           P1TPVA    PARM P1TPVA    WQ0031 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0032  2        Event Called Fr
     C                     PARM WN0037    WQ0033  7        Commodity Price
     C                     PARM P1TKDT    WQ0034  70       OD Market Begin
     C                     PARM P1TLDT    WQ0035  70       OD Market Endin
     C           WN0026    PARM WN0026    WQ0036  70       Date Used for C
     C           P2WZST    PARM *BLANK    WQ0037  5        Date Error Retu
     C                     PARM P1HGCD    WQ0038  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Market Price Date Range Entered
      *  - (c2 AND c3)
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1TKDT    IFNE 0                          *IF
     C           P1TLDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Date Range Avg Cd RT - Market Date Method  * 
     C                     EXSR SBRVGN
      * CLC Date Method        XF - Market Date Method  * 
     C                     CALL 'PDLJXFR'              90  CLC Date Method
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0039  30       Company Number
     C                     PARM YL0004    WQ0040  3        Date Method Cod
     C                     PARM P1GNDT    WQ0041  70       Actual Shipped
     C                     PARM P1EIDT    WQ0042  70       Requested Deliv
     C                     PARM P1A5DT    WQ0043  70       Requested Ship
     C                     PARM P1D3DT    WQ0044  70       Date of Orig. E
     C                     PARM P1LQCD    WQ0045  3        Commodity Marke
     C                     PARM P1EXDT    WQ0046  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WQ0047  1        Price Status
     C           P1GIDT    PARM *ZERO     WQ0048  70       Pricing Date Us
     C           P1TPVA    PARM P1TPVA    WQ0049 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0050  2        Event Called Fr
     C                     PARM WN0037    WQ0051  7        Commodity Price
     C                     PARM P1TKDT    WQ0052  70       OD Market Begin
     C                     PARM P1TLDT    WQ0053  70       OD Market Endin
     C           WN0026    PARM WN0026    WQ0054  70       Date Used for C
     C           P2WZST    PARM *BLANK    WQ0055  5        Date Error Retu
     C                     PARM P1HGCD    WQ0056  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Load Date used for calculation (to retrieve Market date)
      * CASE: PAR.Market Pricing Date is NE Zero
     C           P1EXDT    IFNE 0                          *IF
     C                     Z-ADDP1EXDT    WN0026           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Date Used for Calculation is not entered
     C           WN0026    IFEQ 0                          *IF
      * CASE: PAR.Actual Shipped Date is entered
     C           P1GNDT    IFNE 0                          *IF
     C                     Z-ADDP1GNDT    WN0026           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1A5DT    WN0026           Date Used for C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1LQCD    WL0001    P      Commodity Marke
     C                     MOVELWN0037    WL0002    P      Commodity Price
     C                     Z-ADDWN0026    WL0003           Market Price Da
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    P1TPVA           Commodity Marke
     C                     Z-ADDWL0005    P1GIDT           USR Date Priced
      * Flag as Unpriced if Price Date doesn't match Market date entered
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Pricing Date Used NE PAR.Date Used for Calculati
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           P1GIDT    IFNE WN0026                     *IF
     C           W0RTN     OREQ @CN,002                    *OR
     C                     MOVEL'U'       P1U1ST           Price Status
      * If no pricing record was found then flag as pricing error.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'MKT'     P2WZST           Error Return
     C                     END                             *FI
     C                     END                             *FI
      * If record not found use default commodity market from company/ite
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
      * RTV Dflt Comm Mrkt     XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDMNXFR'              90  RTV Dflt Comm M
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0057  30       Company Number
     C                     PARM P1HGCD    WQ0058  70       Item Code
     C           WN0035    PARM *BLANK    WQ0059  3        Default Commod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Commodity Market Code NE PAR.Default Commod Mark basis
     C           P1LQCD    IFNE WN0035                     *IF
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0035    WL0001    P      Commodity Marke
     C                     MOVELWN0037    WL0002    P      Commodity Price
     C                     Z-ADDWN0026    WL0003           Market Price Da
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    P1TPVA           Commodity Marke
     C                     Z-ADDWL0005    P1GIDT           USR Date Priced
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Market Details    RT - IP Item Market Details  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HGCD    WL0006           Item Code
     C                     MOVELP1LQCD    WL0007    P      Commodity Marke
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0001    P      Commodity Price
     C                     Z-ADDWL0009    YL0005           Market Percent
     C                     Z-ADDWL0010    YN0002           Market Prem/Ded
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Pricing Retrieved Amount is Not Zeros
      *   |- c2    : LCL.Market Percent is not equal to zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1TPVA    IFNE 0                          *IF
     C           YL0005    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pricing Retrieved Amount
      * PAR.Pricing Retrieved Amount =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.Pricing Retrieved Amount
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : LCL.Market Percent
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           YL0005    DIV  100       W0WD01    H      *Synon (17,7) w
     C           P1TPVA    MULT W0WD01    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    P1TPVA           Pricing Retriev
     C                     END                             *FI
     C                     END                             *FI
      * Convert Price to CWT
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           P1TPVA    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0060  30       Company Number
     C                     PARM P1HGCD    WQ0061  70       Item Code
     C                     PARM P1TPVA    WQ0062 114       Unit Price
     C           WN0036    PARM *ZERO     WQ0063 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWN0036    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Error Routine - Exit if Error
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Error Return is All Entered Values
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C           W0RTN     OREQ @CN,002                    *OR
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'MKT'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Retrieved Amount is not equal to 0
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Conversion Documentation
      *================================================================
      * Market Price will be converted to CWT because Overages will be
      * by CWT if it is Customer Overage, and Market Price may not be.
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Retrieve Starting Item Prices
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0046  70       Date Used for C
     C                     Z-ADD*ZERO     WN0047  52       Sales Yield
     C                     Z-ADD*ZERO     WN0048 114       Sales Yield Tot
      *
      * xRTV Pricing: STRITM   IF
      * UPD Consumed Items     RT - Item Bill Of Material  * 
     C                     EXSR SGRVGN
      * Error Routine - Exit if Error
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Error Return is All Entered Values
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C           W0RTN     OREQ @CN,002                    *OR
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: PAR.Error Return is Week Prior Avg Error
     C           P2WZST    IFEQ 'WPA'                      *IF
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'WPS'     P2WZST           Error Return
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'STR'     P2WZST           Error Return
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'CNF'     P2WZST           Error Return
     C                     END                             *FI
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Retrieved Amount is not equal to 0
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Conversion Documentation
      *================================================================
      * Market Prices for each Bill of Material Starting Item will be
      * converted to CWT.
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Calc Pct Amount of Starting Item & Accumulate Amount & Write Rcd
      *================================================================
      * Conversion Documentation
     C                     EXSR UGSUBR                     Conversion Docu
      * Convert Price to CWT
      * CASE: WRK.Pricing Retrieved Amount is Not Zeros
     C           WUTPVA    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0098  30       Company Number
     C                     PARM WGC9NB    WQ0099  70       Item Code
     C                     PARM WUTPVA    WQ0100 114       Unit Price
     C           WN0051    PARM *ZERO     WQ0101 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWN0051    WUTPVA           Pricing Retriev
     C                     END                             *FI
      * DO NOT Convert Sales Yield into Hundred weight
      * CASE: PAR.Price Type Status is Inventory
     C           P8Y0ST    IFEQ 'I'                        *IF
     C                     Z-ADDWGBPPR    WUBOPR           Sales Yield
     C                     Z-ADDWGBPPR    WN0050           Sales Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWGBOPR    WUBOPR           Sales Yield
     C                     Z-ADDWGBOPR    WN0050           Sales Yield
     C                     END                             *FI
     C                     DIV  100       WUBOPR           Sales Yield
     C           WUTPVA    MULT WUBOPR    WN0066           Market Value
      * Write Order Detail if Order exist
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
     C                     ADD  1         WUZXNB           Pricing Sequenc
      * Update Pricing formula detail record, depending on where called
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Temporary Record   CR - PD Ship Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0033           Company Number
     C                     Z-ADDP3C4NB    WL0034           Order Number
     C                     Z-ADDP3DPNB    WL0035           Order Sequence
     C                     Z-ADDP3UENB    WL0036           Order Secondary
     C                     MOVEL'STRITM'  WL0037    P      Price Method Co
     C                     Z-ADDWGC9NB    WL0038           Item Code
     C                     Z-ADDWUZXNB    WL0039           Pricing Sequenc
     C                     Z-ADDWN0050    WL0040           Sales Yield
     C                     Z-ADDWN0066    WL0041           Market Value
     C                     Z-ADDWUW0NB    WL0042           Credit Value
     C                     MOVEL'A'       WL0043    P      PD Status
     C                     MOVELWUGSTX    WL0044    P      EDI Status 1
     C                     MOVELWUGSTX    WL0045    P      EDI Status 2
     C                     MOVELWUGSTX    WL0046    P      EDI Status 3
     C                     EXSR SHCRRC
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Dtl Formula   CR - PD Ship Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0047           Company Number
     C                     Z-ADDP3C4NB    WL0048           Order Number
     C                     Z-ADDP3DPNB    WL0049           Order Sequence
     C                     Z-ADDP3UENB    WL0050           Order Secondary
     C                     MOVEL'STRITM'  WL0051    P      Price Method Co
     C                     Z-ADDWGC9NB    WL0052           Item Code
     C                     Z-ADDWUZXNB    WL0053           Pricing Sequenc
     C                     Z-ADDWN0050    WL0054           Sales Yield
     C                     Z-ADDWN0066    WL0055           Market Value
     C                     Z-ADDWUW0NB    WL0056           Credit Value
     C                     MOVEL'A'       WL0057    P      PD Status
     C                     MOVELWUGSTX    WL0058    P      EDI Status 1
     C                     MOVELWUGSTX    WL0059    P      EDI Status 2
     C                     MOVELWUGSTX    WL0060    P      EDI Status 3
     C                     EXSR SICRRC
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Dtl Formula   CR - PD Ship Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0047           Company Number
     C                     Z-ADDP3C4NB    WL0048           Order Number
     C                     Z-ADDP3DPNB    WL0049           Order Sequence
     C                     Z-ADDP3UENB    WL0050           Order Secondary
     C                     MOVEL'STRITM'  WL0051    P      Price Method Co
     C                     Z-ADDWGC9NB    WL0052           Item Code
     C                     Z-ADDWUZXNB    WL0053           Pricing Sequenc
     C                     Z-ADDWN0050    WL0054           Sales Yield
     C                     Z-ADDWN0066    WL0055           Market Value
     C                     Z-ADDWUW0NB    WL0056           Credit Value
     C                     MOVEL'A'       WL0057    P      PD Status
     C                     MOVELWUGSTX    WL0058    P      EDI Status 1
     C                     MOVELWUGSTX    WL0059    P      EDI Status 2
     C                     MOVELWUGSTX    WL0060    P      EDI Status 3
     C                     EXSR SICRRC
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Dtl Formula   CR - PD Ship Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0047           Company Number
     C                     Z-ADDP3C4NB    WL0048           Order Number
     C                     Z-ADDP3DPNB    WL0049           Order Sequence
     C                     Z-ADDP3UENB    WL0050           Order Secondary
     C                     MOVEL'STRITM'  WL0051    P      Price Method Co
     C                     Z-ADDWGC9NB    WL0052           Item Code
     C                     Z-ADDWUZXNB    WL0053           Pricing Sequenc
     C                     Z-ADDWN0050    WL0054           Sales Yield
     C                     Z-ADDWN0066    WL0055           Market Value
     C                     Z-ADDWUW0NB    WL0056           Credit Value
     C                     MOVEL'A'       WL0057    P      PD Status
     C                     MOVELWUGSTX    WL0058    P      EDI Status 1
     C                     MOVELWUGSTX    WL0059    P      EDI Status 2
     C                     MOVELWUGSTX    WL0060    P      EDI Status 3
     C                     EXSR SICRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Conversion Documentation
      *================================================================
      * Retrieved Market Price will be converted to CWT for each BOM reco
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Customer/Item Differential
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0075 114       Price Adjustmen
      *
      * xRTV Pricing: CIDIFF   IF
      * Return Customer/Item Overages
      * CASE: PAR.USR Return Code is Not Returned
     C           WN0015    IFEQ *BLANK                     *IF
      * RTV Overages           RT - Customer Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0061           Company Number
     C                     Z-ADDP1BKC7    WL0062           Ship To Custome
     C                     Z-ADDP1HGCD    WL0063           Item Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0064    WN0012           Market Overage
     C                     Z-ADDWL0065    WN0013           Formula Differe
     C                     Z-ADDWL0066    WN0014           Formula Process
     C                     MOVEL'R'       WN0015           USR Return Code
     C                     END                             *FI
      * Conversion Documentation
     C                     EXSR UISUBR                     Conversion Docu
      * Convert PAR.Formula Differential to CWT
      * CASE: PAR.Formula Differential is Not Zeros
     C           WN0013    IFNE 0                          *IF
     C                     Z-ADD0         WN0075           Price Adjustmen
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0102  30       Company Number
     C                     PARM P1HGCD    WQ0103  70       Item Code
     C                     PARM WN0013    WQ0104 114       Unit Price
     C           WN0075    PARM *ZERO     WQ0105 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Load PAR.Pricing Retrieved Amount
      * CASE: PAR.Price Adjustment Amount NE WRK.ZERO
     C           WN0075    IFNE WUW0NB                     *IF
     C                     Z-ADDWN0075    P1TPVA           Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0013    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Update Pricing Retrieved Amount is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Conversion Documentation
      *================================================================
      * Convert Formula Differential into Hundred weight
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Calc Pct Amount of Credit Items & Write record to Formula Detail
      *================================================================
      * Convert Item Constant into CW if Add or Subtract
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Item Pricing Operation is Add
      *   |- c2    : PAR.Item Pricing Operation is Subtract
      *   '-
     C           WN0091    IFEQ '+'                        *IF
     C           WN0091    OREQ '-'                        *OR
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0140  30       Company Number
     C                     PARM WKC9NB    WQ0141  70       Item Code
     C                     PARM WN0092    WQ0142 114       Unit Price
     C           WN0093    PARM *ZERO     WQ0143 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Load PAR.Item Constant with converted CWT Price
      * CASE: PAR.Price Adjustment Amount NE WRK.ZERO
     C           WN0093    IFNE WUW0NB                     *IF
     C                     Z-ADDWN0093    WN0092           Item Pricing Co
     C                     END                             *FI
     C                     END                             *FI
      * Convert Pricing Retrieved amount to CWT
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           P1TPVA    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0144  30       Company Number
     C                     PARM WKC9NB    WQ0145  70       Item Code
     C                     PARM P1TPVA    WQ0146 114       Unit Price
     C           WN0093    PARM *ZERO     WQ0147 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Load PAR.Pricing Retrieved amount with CWT converted Price
      * CASE: PAR.Price Adjustment Amount NE WRK.ZERO
     C           WN0093    IFNE WUW0NB                     *IF
     C                     Z-ADDWN0093    P1TPVA           Pricing Retriev
     C                     END                             *FI
     C                     END                             *FI
      * DO NOT Convert Sales Yield into Hundred weight
      * CASE: PAR.Price Type Status is Inventory
     C           P8Y0ST    IFEQ 'I'                        *IF
     C                     Z-ADDWKBPPR    WUBOPR           Sales Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWKBOPR    WUBOPR           Sales Yield
     C                     END                             *FI
      * Process Calculation as setup in the Item File for WRK.Market Valu
      * Process Operation if = (-) Subtraction
      * CASE: PAR.Item Pricing Operation is Subtract
     C           WN0091    IFEQ '-'                        *IF
     C           P1TPVA    SUB  WN0092    WUCDPR           Market Value
     C                     END                             *FI
      * Process Operation if = (+) Addition
      * CASE: PAR.Item Pricing Operation is Add
     C           WN0091    IFEQ '+'                        *IF
     C           P1TPVA    ADD  WN0092    WUCDPR           Market Value
     C                     END                             *FI
      * Process Operation if = (*) Multiply
      * CASE: PAR.Item Pricing Operation is Multiply
     C           WN0091    IFEQ '*'                        *IF
      * CASE: PAR.Item Pricing Constant NE WRK.ZERO
     C           WN0092    IFNE WUW0NB                     *IF
     C           P1TPVA    MULT WN0092    WUCDPR           Market Value
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1TPVA    WUCDPR           Market Value
     C                     END                             *FI
     C                     END                             *FI
      * Process Operation if = (/) Divide
      * CASE: PAR.Item Pricing Operation is Divide
     C           WN0091    IFEQ '/'                        *IF
      * CASE: PAR.Item Pricing Constant NE WRK.ZERO
     C           WN0092    IFNE WUW0NB                     *IF
     C           P1TPVA    MULT WN0092    WUCDPR           Market Value
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1TPVA    WUCDPR           Market Value
     C                     END                             *FI
     C                     END                             *FI
      * Process Operation if = (Blank)
      * CASE: PAR.Item Pricing Operation is Blank
     C           WN0091    IFEQ *BLANK                     *IF
     C                     Z-ADDP1TPVA    WUCDPR           Market Value
     C                     END                             *FI
      * First Step in calculating Credit Value
     C           WUCDPR    DIV  100       WUTPVA           Pricing Retriev
      * Calculate Credit Value
     C           WUBOPR    MULT WUTPVA    WUCEPR           Credit Value
      * Write Order Detail Pricing if Order Exist
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * Add 1 to Sequence Number
     C                     ADD  1         WUZXNB           Pricing Sequenc
      * Update Pricing formula detail record, depending on where called
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Temporary Record   CR - PD Ship Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0033           Company Number
     C                     Z-ADDP3C4NB    WL0034           Order Number
     C                     Z-ADDP3DPNB    WL0035           Order Sequence
     C                     Z-ADDP3UENB    WL0036           Order Secondary
     C                     MOVEL'TCRDVY'  WL0037    P      Price Method Co
     C                     Z-ADDWKC9NB    WL0038           Item Code
     C                     Z-ADDWUZXNB    WL0039           Pricing Sequenc
     C                     Z-ADDWUBOPR    WL0040           Sales Yield
     C                     Z-ADDWUCDPR    WL0041           Market Value
     C                     Z-ADDWUCEPR    WL0042           Credit Value
     C                     MOVEL'A'       WL0043    P      PD Status
     C                     MOVELWUGSTX    WL0044    P      EDI Status 1
     C                     MOVELWUGSTX    WL0045    P      EDI Status 2
     C                     MOVELWUGSTX    WL0046    P      EDI Status 3
     C                     EXSR SHCRRC
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Dtl Formula   CR - PD Ship Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0047           Company Number
     C                     Z-ADDP3C4NB    WL0048           Order Number
     C                     Z-ADDP3DPNB    WL0049           Order Sequence
     C                     Z-ADDP3UENB    WL0050           Order Secondary
     C                     MOVEL'TCRDVY'  WL0051    P      Price Method Co
     C                     Z-ADDWKC9NB    WL0052           Item Code
     C                     Z-ADDWUZXNB    WL0053           Pricing Sequenc
     C                     Z-ADDWUBOPR    WL0054           Sales Yield
     C                     Z-ADDWUCDPR    WL0055           Market Value
     C                     Z-ADDWUCEPR    WL0056           Credit Value
     C                     MOVEL'A'       WL0057    P      PD Status
     C                     MOVELWUGSTX    WL0058    P      EDI Status 1
     C                     MOVELWUGSTX    WL0059    P      EDI Status 2
     C                     MOVELWUGSTX    WL0060    P      EDI Status 3
     C                     EXSR SICRRC
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Dtl Formula   CR - PD Ship Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0047           Company Number
     C                     Z-ADDP3C4NB    WL0048           Order Number
     C                     Z-ADDP3DPNB    WL0049           Order Sequence
     C                     Z-ADDP3UENB    WL0050           Order Secondary
     C                     MOVEL'TCRDVY'  WL0051    P      Price Method Co
     C                     Z-ADDWKC9NB    WL0052           Item Code
     C                     Z-ADDWUZXNB    WL0053           Pricing Sequenc
     C                     Z-ADDWUBOPR    WL0054           Sales Yield
     C                     Z-ADDWUCDPR    WL0055           Market Value
     C                     Z-ADDWUCEPR    WL0056           Credit Value
     C                     MOVEL'A'       WL0057    P      PD Status
     C                     MOVELWUGSTX    WL0058    P      EDI Status 1
     C                     MOVELWUGSTX    WL0059    P      EDI Status 2
     C                     MOVELWUGSTX    WL0060    P      EDI Status 3
     C                     EXSR SICRRC
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Dtl Formula   CR - PD Ship Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0047           Company Number
     C                     Z-ADDP3C4NB    WL0048           Order Number
     C                     Z-ADDP3DPNB    WL0049           Order Sequence
     C                     Z-ADDP3UENB    WL0050           Order Secondary
     C                     MOVEL'TCRDVY'  WL0051    P      Price Method Co
     C                     Z-ADDWKC9NB    WL0052           Item Code
     C                     Z-ADDWUZXNB    WL0053           Pricing Sequenc
     C                     Z-ADDWUBOPR    WL0054           Sales Yield
     C                     Z-ADDWUCDPR    WL0055           Market Value
     C                     Z-ADDWUCEPR    WL0056           Credit Value
     C                     MOVEL'A'       WL0057    P      PD Status
     C                     MOVELWUGSTX    WL0058    P      EDI Status 1
     C                     MOVELWUGSTX    WL0059    P      EDI Status 2
     C                     MOVELWUGSTX    WL0060    P      EDI Status 3
     C                     EXSR SICRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  WUBOPR    WN0006           Sales Yield
     C                     ADD  WUCDPR    WN0007           Market Value
     C                     ADD  WUCEPR    WN0008           Credit Value
     C                     Z-ADD0         P1TPVA           Pricing Retriev
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Calculate Muscle Yield
      *================================================================
      * xRTV Pricing: MSCYLD   IF
      * Note: no CWT Conversion is needed.
     C                     MOVEL*BLANK    WN0015           USR Return Code
     C           100       SUB  WN0006    WUCHPR           Muscle Yield Pr
     C                     Z-ADDWUCHPR    P1TPVA           Pricing Retriev
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'MSC'     P2WZST           Error Return
     C                     GOTO UKEXIT                     *QUIT
     C                     END                             *FI
      * Update if Pricing Retrieved Amount is Not Equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Update for Muscle Yield Total (use Componant MSCYLD)
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVEL'MSCYLD'  WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVEL'MSCYLD'  WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVEL'MSCYLD'  WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVEL'MSCYLD'  WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C           P1TPVA    DIV  100       WUCHPR           Muscle Yield Pr
      * Divide running Unit Price total by Muscle Yield (if not equal 0)
      * CASE: WRK.Muscle Yield Price NE WRK.ZERO
     C           WUCHPR    IFNE WUW0NB                     *IF
     C                     DIV  WUCHPR    P1AKPR           Unit Price
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Customer/Item Processing Fee
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0094 114       Price Adjustmen
      *
      * xRTV Pricing: CIFMPF   IF
     C                     MOVELWUGSTX    P2WZST           Error Return
      * Retrieve Customer/Item Overages
      * CASE: PAR.USR Return Code is Not Returned
     C           WN0015    IFEQ *BLANK                     *IF
      * RTV Overages           RT - PD Customer/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0061           Company Number
     C                     Z-ADDP1BKC7    WL0062           Ship To Custome
     C                     Z-ADDP1HGCD    WL0063           Item Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0064    WN0012           Market Overage
     C                     Z-ADDWL0065    WN0013           Formula Differe
     C                     Z-ADDWL0066    WN0014           Formula Process
     C                     MOVEL'R'       WN0015           USR Return Code
     C                     END                             *FI
      * Convert Formula Processing fee to CWT if NE 0
      * CASE: PAR.Formula Processing Fee is Not Zeros
     C           WN0014    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0148  30       Company Number
     C                     PARM P1HGCD    WQ0149  70       Item Code
     C                     PARM WN0014    WQ0150 114       Unit Price
     C           WN0094    PARM *ZERO     WQ0151 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Load PAR.Price Retrieved Amount after CWT Convert
      * CASE: PAR.Price Adjustment Amount NE WRK.ZERO
     C           WN0094    IFNE WUW0NB                     *IF
     C                     Z-ADDWN0094    P1TPVA           Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0014    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'CIF'     P2WZST           Error Return
     C                     GOTO ULEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail if Processing Fee is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Item Overage Formula
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0095 114       Standard Overag
     C                     Z-ADD*ZERO     WN0096 114       Price Adjustmen
      *
      * xRTV Pricing: IOVRFM   IF
      * RTV Formula Overage    RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0067           Company Number
     C                     Z-ADDP1HGCD    WL0068           Item Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    WUBLPR           Market Overage
     C                     Z-ADDWL0070    WN0095           Standard Overag
     C                     MOVELWUGSTX    P2WZST           Error Return
     C                     Z-ADDWN0095    P1TPVA           Pricing Retriev
      * Convert Formula Overage to CWT if Not Zero
      * CASE: PAR.Formula Overage is Not Zeros
     C           WN0095    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0152  30       Company Number
     C                     PARM P1HGCD    WQ0153  70       Item Code
     C                     PARM WN0095    WQ0154 114       Unit Price
     C           WN0096    PARM *ZERO     WQ0155 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Load PAR.Pricing Retrieved Amount after converting to CWT
      * CASE: PAR.Price Adjustment Amount NE WRK.ZERO
     C           WN0096    IFNE WUW0NB                     *IF
     C                     Z-ADDWN0096    P1TPVA           Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0095    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'CFR'     P2WZST           Error Return
     C                     GOTO UMEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail if retrieved amount NE Zero
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           P1TPVA    IFNE 0                          *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Company/Customer freight Rate Overage
      *================================================================
      * This Overage is keyed in by Hundred Weight, if Pricing U/M is not
      * Hundred Weight, the it must be converted to the Items Pricing U/M
      *
     C                     Z-ADD*ZERO     WN0097 112       Co/Cust Overage
     C                     Z-ADD*ZERO     WN0098  70       Item Code
     C                     Z-ADD*ZERO     WN0099 114       Price based on
     C                     Z-ADD*ZERO     WN0100 114       Price based on
     C                     Z-ADD*ZERO     WN0101 114       Price based on
     C                     Z-ADD*ZERO     WN0102 114       Price Adjustmen
      *
      * RTV Pricing: CFRTOV   IF
      * RTV Mkt/Form Overage   RT - Company Customer  * 
     C                     EXSR SMRVGN
      * Company Customer Overage is entered as Hundred weight, therefore
      * Converting to Hundred weight is not necessary.
     C                     Z-ADDWN0097    P1TPVA           Pricing Retriev
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     GOTO UNEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail if Freight Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Item Market Overage
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0103 114       Price Adjustmen
      *
      * RTV Pricing: CIOVMK   IF
     C                     MOVELWUGSTX    P2WZST           Error Return
      * Retrieve Customer/Item Overage
      * CASE: PAR.USR Return Code is Not Returned
     C           WN0015    IFEQ *BLANK                     *IF
      * RTV Overages           RT - Company Customer Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0061           Company Number
     C                     Z-ADDP1BKC7    WL0062           Ship To Custome
     C                     Z-ADDP1HGCD    WL0063           Item Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0064    WN0012           Market Overage
     C                     Z-ADDWL0065    WN0013           Formula Differe
     C                     Z-ADDWL0066    WN0014           Formula Process
      * CASE: PAR.Market Overage is Not Zeros
     C           WN0012    IFNE 0                          *IF
      * RTV Dsc,U/M,PrcInf,Str RT - Company Item  * 
     C                     EXSR SNRVGN
      * Convert to CWT if Pricing UM is not in any form of pounds (Ex: LB
      * CASE: LCL.U/M - Pricing is Cases
     C           YL0006    IFEQ 'CS'                       *IF
      * PAR.Market Overage =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.Market Overage
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.Unit Weight
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0012    DIV  YL0007    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0012           Market Overage
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'R'       WN0015           USR Return Code
     C                     END                             *FI
      * Convert Overage to CWT is not zero
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           P1TPVA    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0156  30       Company Number
     C                     PARM P1HGCD    WQ0157  70       Item Code
     C                     PARM WN0012    WQ0158 114       Unit Price
     C           WN0103    PARM *ZERO     WQ0159 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Load PAR.Pricing Retrieved Amount from Market Overage after CWT C
      * CASE: PAR.Price Adjustment Amount NE WRK.ZERO
     C           WN0103    IFNE WUW0NB                     *IF
     C                     Z-ADDWN0103    P1TPVA           Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0012    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'CIO'     P2WZST           Error Return
     C                     GOTO UOEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail if Market  Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Item Market Overage
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0104 114       Market Overage
     C                     Z-ADD*ZERO     WN0105 114       Price Adjustmen
      *
      * RTV Pricing: IOVMKT   IF
      * RTV Formula Overage    RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0067           Company Number
     C                     Z-ADDP1HGCD    WL0068           Item Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    WN0104           Market Overage
     C                     Z-ADDWL0070    WUBMPR           Standard Overag
     C                     MOVELWUGSTX    P2WZST           Error Return
      * Convert Market Overage to CWT if not Zero
      * CASE: PAR.Market Overage is Not Zeros
     C           WN0104    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0160  30       Company Number
     C                     PARM P1HGCD    WQ0161  70       Item Code
     C                     PARM WN0104    WQ0162 114       Unit Price
     C           WN0105    PARM *ZERO     WQ0163 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Load PAR.Pricing Retrieved Amount from Overage Converted to CWT
      * CASE: PAR.Price Adjustment Amount NE WRK.ZERO
     C           WN0105    IFNE WUW0NB                     *IF
     C                     Z-ADDWN0105    P1TPVA           Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0104    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'IOM'     P2WZST           Error Return
     C                     GOTO UPEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Extended Price Method
      *================================================================
      * RTV Pricing: EXTEND   IF
     C                     MOVELWUGSTX    P2WZST           Error Return
      * CASE: PAR.Quantity Ordered NE WRK.ZERO
     C           P1AVQT    IFNE WUW0NB                     *IF
     C           P3BZPR    DIV  P1AVQT    P1TPVA    H      Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP3BZPR    P1TPVA           Pricing Retriev
     C                     END                             *FI
     C                     MOVELP1AGCD    P6AICD           U/M - Pricing
      * CASE: PAR.Pricing Retrieved Amount EQ WRK.ZERO
     C           P1TPVA    IFEQ WUW0NB                     *IF
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'XPE'     P2WZST           Error Return
     C                     END                             *FI
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'EXT'     P2WZST           Error Return
     C                     GOTO UQEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail if Extended is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Manual Pricing
      *================================================================
      * RTV Pricing: OVRIDE   IF
     C                     Z-ADDP3BZPR    P1TPVA           Pricing Retriev
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'OVR'     P2WZST           Error Return
     C                     GOTO UREXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail if Override Amt is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Retrieve Accruals
      *================================================================
      * ** Accumulate the Accrual amount into the Pricing Retrieved Amoun
      *
     C                     Z-ADD*ZERO     WN0106  30       Item Structure
     C                     Z-ADD*ZERO     WN0107  30       Item Structure
     C                     Z-ADD*ZERO     WN0108  30       Item Structure
     C                     Z-ADD*ZERO     WN0109 114       Price Adjustmen
      *
      * RTV Pricing: ACCRLS   IF
      * ** Routine to Accumulate Accrual Rate
      * CASE: PAR.Event Called From is All Values
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '99'
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
     C                     Z-ADD0         YL0008           Accrual Rate
      * ** This will read all accrual codes that are setup for the
      * ** ShipTo customer and accumulate the Accrual Rates.
      * ** If Actual Shipped Date is zeros, use Requested Ship Date
      * CASE: PAR.Actual Shipped Date is entered
     C           P1GNDT    IFNE 0                          *IF
     C                     Z-ADDP1GNDT    WUFADT           USR Date Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1A5DT    WUFADT           USR Date Shippe
     C                     END                             *FI
      * Rtv Accrual Info      RT - Customer Accrual  * 
     C                     EXSR SORVGN
     C                     END                             *FI
      * ** Convert Price to CWT
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           P1TPVA    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0164  30       Company Number
     C                     PARM P1HGCD    WQ0165  70       Item Code
     C                     PARM P1TPVA    WQ0166 114       Unit Price
     C           WN0109    PARM *ZERO     WQ0167 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWN0109    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Conversion Documentation
     C                     EXSR UTSUBR                     Conversion Docu
      * Error Routine - Exit if Error
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Error Return is All Entered Values
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C           W0RTN     OREQ @CN,002                    *OR
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'RWB'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Retrieved Amount is not equal to 0
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Conversion Documentation
      *================================================================
      * *****
      * ** 05/25/2007 LJB DLY029
      * ** Accumulate rate for all Accrual Codes for this Ship To
      * ** Customer based on the value in the All Products Y/N field
      * **
      * ** If Actual Shipped Date is zeros, use the Requested Ship Date.
      * **
      * ** If YES, then use the rate from the Customer Accrual record.
      * **
      * ** If YES + EXCEPTIONS, then use the rate from either the Custome
      * ** Accrual Structure or Customer Accrual Item file which is based
      * ** on the value in Accrual Detail Search field. If no record in
      * ** either file, then use the rate in the Customer Accrual record.
      * **
      * ** If NO, then only accumulate the rate if there is a record
      * ** in either the Customer Accrual Str or Customer Accrual Item
      * ** file. If no record in either file, just add zeros.
      * **
      * ** Price will be converted to CWT
      * *****
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Company/Customer freight Rate Overage
      *================================================================
      * This Overage is keyed in by Hundred Weight, if Pricing U/M is not
      * Hundred Weight, the it must be converted to the Items Pricing U/M
      *
     C                     Z-ADD*ZERO     WN0113  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0114  70       Item Code
     C                     Z-ADD*ZERO     WN0115 114       Price based on
     C                     Z-ADD*ZERO     WN0116 114       Price based on
     C                     Z-ADD*ZERO     WN0117 114       Price based on
     C                     Z-ADD*ZERO     WN0118 114       Price Adjustmen
      *
      * RTV Pricing: CFRTAB   IF
      * Rtv Shipping Method   RT - Order Header TRG  * 
     C                     EXSR SVRVGN
      * CASE: LCL.Shipping Method is Prepaid
     C           YL0013    IFEQ 'PR'                       *IF
     C           YL0013    OREQ 'PT'
      * R12926 DN 04/24/18-At Order level, get Absorbed Freight Rate from
      * Rtv Absorbed Frt Rate RT - Order Header TRG  * 
     C                     EXSR SWRVGN
      * Customer Absorbed Frieght is entered as Hundred weight, therefore
      * Converting to Hundred weight is not necessary.
     C                     Z-ADDWN0113    P1TPVA           Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     GOTO UUEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail if Freight Absorbed is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Item Freight Overage
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0119 114       Market Overage
     C                     Z-ADD*ZERO     WN0120 114       Price Adjustmen
      *
      * RTV Pricing: IOVFRT   IF
      * RTV Item Freight Over RT - Company Item  * 
     C                     EXSR SXRVGN
     C                     MOVELWUGSTX    P2WZST           Error Return
      * Convert Item Freight Overage to CWT if not Zero
      * CASE: LCL.Item Frt Overage /Prc UM is NE Zero
     C           YL0014    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0168  30       Company Number
     C                     PARM P1HGCD    WQ0169  70       Item Code
     C                     PARM YL0014    WQ0170 114       Unit Price
     C           WN0120    PARM *ZERO     WQ0171 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Load PAR.Pricing Retrieved Amount from Overage Converted to CWT
      * CASE: PAR.Price Adjustment Amount NE WRK.ZERO
     C           WN0120    IFNE WUW0NB                     *IF
     C                     Z-ADDWN0120    P1TPVA           Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0014    P1TPVA           Pricing Retriev
     C                     END                             *FI
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'IOM'     P2WZST           Error Return
     C                     GOTO UVEXIT                     *QUIT
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Customer Item Muscle Value
      *================================================================
      * RTV Pricing: CIMSLV   XF - Price Method Componant  * 
     C                     CALL 'PNQ4XFR'              90  RTV Pricing: CI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0172  30       Company Number
     C                     PARM P1BKC7    WQ0173  70       Ship To Custome
     C                     PARM P1GNDT    WQ0174  70       Actual Shipped
     C                     PARM P1EIDT    WQ0175  70       Requested Deliv
     C                     PARM P1A5DT    WQ0176  70       Requested Ship
     C                     PARM P1HGCD    WQ0177  70       Item Code
     C                     PARM P1D3DT    WQ0178  70       Date of Orig. E
     C                     PARM P1LQCD    WQ0179  3        Commodity Marke
     C                     PARM P1EXDT    WQ0180  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WQ0181  1        Price Status
     C                     PARM P1RDCD    WQ0182  3        Date Method Cod
     C           P1GIDT    PARM P1GIDT    WQ0183  70       Pricing Date Us
     C           P1TPVA    PARM P1TPVA    WQ0184 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0185  2        Event Called Fr
     C                     PARM WN0004    WQ0186  7        Commodity Price
     C                     PARM P3C4NB    WQ0187  70       Order Number
     C                     PARM P3DPNB    WQ0188  30       Order Sequence
     C                     PARM P3UENB    WQ0189  30       Order Secondary
     C                     PARM P1TKDT    WQ0190  70       OD Market Begin
     C                     PARM P1TLDT    WQ0191  70       OD Market Endin
     C           P2WZST    PARM P2WZST    WQ0192  5        Error Return
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQ4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'MSL'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * Customer Item Processing Fee
      *================================================================
      * RTV Pricing: CIPFEE   XF - Price Method Componant  * 
     C                     CALL 'PNQ5XFR'              90  RTV Pricing: CI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0193  30       Company Number
     C                     PARM P1HGCD    WQ0194  70       Item Code
     C                     PARM P1BKC7    WQ0195  70       Ship To Custome
     C           P1TPVA    PARM P1TPVA    WQ0196 114       Pricing Retriev
     C           P2WZST    PARM *BLANK    WQ0197  5        Error Return
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQ5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'FEE'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * Customer Item Freight Overage
      *================================================================
      * RTV Pricing: CIFRTO   XF - Price Method Componant  * 
     C                     CALL 'PNQ3XFR'              90  RTV Pricing: CI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0198  30       Company Number
     C                     PARM P1HGCD    WQ0199  70       Item Code
     C                     PARM P1BKC7    WQ0200  70       Ship To Custome
     C           P1TPVA    PARM P1TPVA    WQ0201 114       Pricing Retriev
     C           P2WZST    PARM *BLANK    WQ0202  5        Error Return
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQ3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'IOM'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * Customer Item Market +/-
      *================================================================
      * RTV Pricing: CITMOV   XF - Price Method Componant  * 
     C                     CALL 'PNQ6XFR'              90  RTV Pricing: CI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0203  30       Company Number
     C                     PARM P1HGCD    WQ0204  70       Item Code
     C                     PARM P1BKC7    WQ0205  70       Ship To Custome
     C           P1TPVA    PARM P1TPVA    WQ0206 114       Pricing Retriev
     C           P2WZST    PARM *BLANK    WQ0207  5        Error Return
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQ6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P2WZST    IFEQ 'CFR'                      *IF
     C           P2WZST    OREQ 'CID'
     C           P2WZST    OREQ 'CIF'
     C           P2WZST    OREQ 'CIO'
     C           P2WZST    OREQ 'QPE'
     C           P2WZST    OREQ 'EXT'
     C           P2WZST    OREQ 'XPE'
     C           P2WZST    OREQ 'FPE'
     C           P2WZST    OREQ 'IOM'
     C           P2WZST    OREQ 'IOV'
     C           P2WZST    OREQ 'MPE'
     C           P2WZST    OREQ 'KPE'
     C           P2WZST    OREQ 'MKT'
     C           P2WZST    OREQ 'MSC'
     C           P2WZST    OREQ 'OVR'
     C           P2WZST    OREQ 'STR'
     C           P2WZST    OREQ 'SUB'
     C           P2WZST    OREQ 'TRC'
     C           P2WZST    OREQ 'WPA'
     C           P2WZST    OREQ 'RWB'
     C           P2WZST    OREQ 'ITERR'
     C           P2WZST    OREQ 'CRD'
     C           P2WZST    OREQ 'MSL'
     C           P2WZST    OREQ 'GAT'
     C                     MOVEL*BLANK    P2WZST           Error Return
     C                     MOVEL'IOM'     P2WZST           Error Return
     C                     END                             *FI
      * Update Pricing Detail if Market Overage is not equal to 0.
      * CASE: PAR.Pricing Retrieved Amount NE WRK.ZERO
     C           P1TPVA    IFNE WUW0NB                     *IF
      * Internal Routine to update either Order detail Pricing file
      * in Library Qtemp if Order has not been updated yet, or
      * Order Detail pricing, if pricing is called
      * from Post(Update) Order, or Ship Pricing Detail if after Shipping
      * UPD Pricing Detail     IF
      * Process if Order Nbr is not zero, if zero then not call from O/E
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * CRT Ship Dtl Price QtmpCR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDP3C4NB    WL0012           Order Number
     C                     Z-ADDP3DPNB    WL0013           Order Sequence
     C                     Z-ADDP3UENB    WL0014           Order Secondary
     C                     MOVELWAQ9CD    WL0015    P      Price Method Co
     C                     Z-ADDWN0010    WL0016           Price Detail Se
     C                     Z-ADDP1TPVA    WL0017           Componant Price
     C                     MOVEL'A'       WL0018    P      PD Status
     C                     MOVELWUGSTX    WL0019    P      EDI Status 1
     C                     MOVELWUGSTX    WL0020    P      EDI Status 2
     C                     MOVELWUGSTX    WL0021    P      EDI Status 3
     C                     EXSR SECRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Pricing
     C           P1SJCD    IFEQ '02'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     ELSE
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0022           Company Number
     C                     Z-ADDP3C4NB    WL0023           Order Number
     C                     Z-ADDP3DPNB    WL0024           Order Sequence
     C                     Z-ADDP3UENB    WL0025           Order Secondary
     C                     MOVELWAQ9CD    WL0026    P      Price Method Co
     C                     Z-ADDWN0010    WL0027           Price Detail Se
     C                     Z-ADDP1TPVA    WL0028           Componant Price
     C                     MOVEL'A'       WL0029    P      PD Status
     C                     MOVELWUGSTX    WL0030    P      EDI Status 1
     C                     MOVELWUGSTX    WL0031    P      EDI Status 2
     C                     MOVELWUGSTX    WL0032    P      EDI Status 3
     C                     EXSR SFCRRC
     C                     ADD  1         WN0010           Price Detail Se
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Final Price
     C                     ADD  P1TPVA    P1AKPR           Unit Price
     C                     END                             *FI
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1LRCD           Commodity Price
     C                     Z-ADD*ZERO     P1CGPR           Starting Produc
     C                     Z-ADD*ZERO     P1BOPR           Sales Yield
     C                     Z-ADD*ZERO     P1CDPR           Market Value
     C                     Z-ADD*ZERO     P1CEPR           Credit Value
     C                     Z-ADD*ZERO     P1LOVA           Price Adjustmen
     C                     Z-ADD*ZERO     P1PDSQ           Price Detail Se
     C                     Z-ADD*ZERO     P4BLPR           Market Overage
     C                     Z-ADD*ZERO     P4BXPR           Formula Differe
     C                     Z-ADD*ZERO     P4BYPR           Formula Process
     C                     MOVEL*BLANK    P5N7CD           USR Return Code
     C                     Z-ADD*ZERO     P6AWPC           Conversion Fact
     C                     MOVEL*BLANK    P6LXST           Operation Facto
     C                     Z-ADD*ZERO     P6AXPC           Conversion Fact
     C                     MOVEL*BLANK    P6LYST           Operation Facto
     C                     Z-ADD*ZERO     P6AIWG           Unit Weight
     C                     MOVEL*BLANK    P6LNCD           Default Commod
     C                     Z-ADD*ZERO     P6BMPR           Standard Overag
     C                     MOVEL*BLANK    P6U9ST           Item Pricing Op
     C                     Z-ADD*ZERO     P6CMCO           Item Pricing Co
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAPMSQ           Price Method Se
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Catch Weight Status
     C                     MOVEL*BLANK    WUAVST  1
      * Define work field Market Overage
     C                     Z-ADD*ZERO     WUBLPR 114
      * Define work field Standard Overage/Underage
     C                     Z-ADD*ZERO     WUBMPR 114
      * Define work field U/M - Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBCPRD           CTL Prior Day
     C                     Z-ADD*ZERO     WBQMNB           CTL Prior Week
     C                     Z-ADD*ZERO     WBCNOT           CTL Number of T
     C                     Z-ADD*ZERO     WBCDOW           CTL Day of Week
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCEQDT           Market Price Da
     C                     Z-ADD*ZERO     WCA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WCB8PR           Projected Marke
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDG2PC           Market Percent
     C                     Z-ADD*ZERO     WDG8PR           Market Prem/Ded
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEPDSQ           Price Detail Se
     C                     Z-ADD*ZERO     WEBNPR           Componant Price
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Clear all neither parameters
      * CRT Ship Price Detail  CR - Order Detail Pricing  * 
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGC9NB           Component Item
     C                     Z-ADD*ZERO     WGBOPR           Sales Yield
     C                     Z-ADD*ZERO     WGBPPR           Production Yiel
     C                     Z-ADD*ZERO     WGHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WGCNSM           Consume Priorit
     C                     Z-ADD*ZERO     WGBMY1           Consume Priorit
     C                     Z-ADD*ZERO     WGBMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WGIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WGIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Pricing Sequence Number
     C                     Z-ADD*ZERO     WUZXNB  30
      * Define work field Pricing Retrieved Amount
     C                     Z-ADD*ZERO     WUTPVA 114
      * Define work field Pricing Date Used
     C                     Z-ADD*ZERO     WUGIDT  70
      * Define work field Sales Yield
     C                     Z-ADD*ZERO     WUBOPR  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHZXNB           Pricing Sequenc
     C                     Z-ADD*ZERO     WHBOPR           Sales Yield
     C                     Z-ADD*ZERO     WHCDPR           Market Value
     C                     Z-ADD*ZERO     WHCEPR           Credit Value
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Clear all neither parameters
      * CRT Ship Dtl Formula   CR - PD Ship Dtl Formula Dtl  * 
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJERDT           Overage Begin D
     C                     Z-ADD*ZERO     WJESDT           Overage End Dat
     C                     Z-ADD*ZERO     WJBWPR           Seasonal Overag
     C                     Z-ADD*ZERO     WJBLPR           Market Overage
     C                     Z-ADD*ZERO     WJBXPR           Formula Differe
     C                     Z-ADD*ZERO     WJBYPR           Formula Process
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Market Value
     C                     Z-ADD*ZERO     WUCDPR 114
      * Define work field Credit Value
     C                     Z-ADD*ZERO     WUCEPR 114
      * Define work field Muscle Yield Price
     C                     Z-ADD*ZERO     WUCHPR 114
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WLAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WLAIWG           Unit Weight
     C                     Z-ADD*ZERO     WLCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WLC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WLURTN           Number Cases On
     C                     Z-ADD*ZERO     WLAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WLRINB           Item Structure
     C                     Z-ADD*ZERO     WLRHNB           Item Structure
     C                     Z-ADD*ZERO     WLRGNB           Item Structure
     C                     Z-ADD*ZERO     WLTFNB           Transportation
     C                     Z-ADD*ZERO     WLTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WLTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WLBLPR           Market Overage
     C                     Z-ADD*ZERO     WLBMPR           Standard Overag
     C                     Z-ADD*ZERO     WLCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WLCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WLSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WLPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WLICN1           Item Category N
     C                     Z-ADD*ZERO     WLICN2           Item Category N
     C                     Z-ADD*ZERO     WLV2NB           Item Category N
     C                     Z-ADD*ZERO     WLITCN           Item Category N
     C                     Z-ADD*ZERO     WLITC5           Item Category N
     C                     Z-ADD*ZERO     WLICN6           Item Category N
     C                     Z-ADD*ZERO     WLICN7           Item Category N
     C                     Z-ADD*ZERO     WLICN8           Item Category N
     C                     Z-ADD*ZERO     WLICN9           Item Category N
     C                     Z-ADD*ZERO     WLICN0           Item Category N
     C                     Z-ADD*ZERO     WLSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WLA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WLSJNB           Production Lead
     C                     Z-ADD*ZERO     WLSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WLSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WLSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WLCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WLCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WLILNB           Packages per ca
     C                     Z-ADD*ZERO     WLCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WLCINB           PM Batch Size
     C                     Z-ADD*ZERO     WLCJNB           Package Level s
     C                     Z-ADD*ZERO     WLCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WLCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WLCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WLCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WLCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WLCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WLCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WLCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WLC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WLB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WLB5NB           PM Line Number
     C                     Z-ADD*ZERO     WLBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WLBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WLF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WLF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WLF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WLBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WLBNNB           Production Qty
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMR5NB           Deliver after t
     C                     Z-ADD*ZERO     WMR6NB           Deliver before
     C                     Z-ADD*ZERO     WMTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WMMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WMW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field USR Date Shipped
     C                     Z-ADD*ZERO     WUFADT  70
      * Define work field Accrual Code
     C                     MOVEL*BLANK    WUOJCD  3
      * Define work field Period Ending Date
     C                     Z-ADD*ZERO     WUA2DT  70
      * Define work field Accrual Rate
     C                     Z-ADD*ZERO     WUBKPR  96
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WOGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WOBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WOA2DT           Period Ending D
     C                     Z-ADD*ZERO     WOBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WOPJDT           CAH Unused Date
     C                     Z-ADD*ZERO     WOPKDT           CAH Unused Date
     C                     Z-ADD*ZERO     WOECVL           Comm Min Amt /P
     C                     Z-ADD*ZERO     WOHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WRHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WSGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WSHGCD           Item Code
     C                     Z-ADD*ZERO     WSBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTC4NB           Order Number
     C                     Z-ADD*ZERO     WTDPNB           Order Sequence
     C                     Z-ADD*ZERO     WTUENB           Order Secondary
     C                     Z-ADD*ZERO     WTHGCD           Item Code
     C                     Z-ADD*ZERO     WTBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WTCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WTMAVA           Billing Detail
     C                     Z-ADD*ZERO     WTKDVA           Billing Detail
     C                     Z-ADD*ZERO     WTL8VA           Billing Detail
     C                     Z-ADD*ZERO     WTL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WTAYVA           Extended Amount
     C                     Z-ADD*ZERO     WTEXDT           Market Pricing
     C                     Z-ADD*ZERO     WTBZPR           Price Overage O
     C                     Z-ADD*ZERO     WTL6NB           Contract Number
     C                     Z-ADD*ZERO     WTGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WTR1NB           Rated Freight
     C                     Z-ADD*ZERO     WTAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WTD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WTCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WTAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WTCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WTATWG           Weight Shipped
     C                     Z-ADD*ZERO     WTAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WTAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WTAKPR           Unit Price
     C                     Z-ADD*ZERO     WTALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WTAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WTAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WTA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WTA5DT           Requested Ship
     C                     Z-ADD*ZERO     WTAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WTGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WTRGNB           Item Structure
     C                     Z-ADD*ZERO     WTRHNB           Item Structure
     C                     Z-ADD*ZERO     WTRINB           Item Structure
     C                     Z-ADD*ZERO     WTCXDT           Date of Origina
     C                     Z-ADD*ZERO     WTDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WTB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WTA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WTNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WTNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WTNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WTNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WTNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WTBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WTBVTM           Price Code
     C                     Z-ADD*ZERO     WTBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WTBXTM           Substitution Li
     C                     Z-ADD*ZERO     WTBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WTH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WTH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WTH7NX           OD Item Target
     C                     Z-ADD*ZERO     WTH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WTH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WTDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WTDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WTDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WTDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WTDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WTGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WTGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WTGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WTPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WTRINY           Item Age Days
     C                     Z-ADD*ZERO     WTTIDT           Production Ovr
     C                     Z-ADD*ZERO     WTTJDT           Production Ovr
     C                     Z-ADD*ZERO     WTTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WTTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WTTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WVGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WVRGNB           Item Structure
     C                     Z-ADD*ZERO     WVRHNB           Item Structure
     C                     Z-ADD*ZERO     WVRINB           Item Structure
     C                     Z-ADD*ZERO     WVBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WVFKPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WVFLPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWC4NB           Order Number
     C                     Z-ADD*ZERO     WWANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WWBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WWB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WWA0DT           Order Date
     C                     Z-ADD*ZERO     WWA5DT           Requested Ship
     C                     Z-ADD*ZERO     WWGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WWACDT           Cancel Date
     C                     Z-ADD*ZERO     WWAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WWCXDT           Date of Origina
     C                     Z-ADD*ZERO     WWJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WWA1WG           Order Weight To
     C                     Z-ADD*ZERO     WWEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WWAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WWRMNB           Load ID
     C                     Z-ADD*ZERO     WWTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WWR1NB           Rated Freight
     C                     Z-ADD*ZERO     WWRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WWATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WWRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WWT3NB           Attach to Order
     C                     Z-ADD*ZERO     WWCONB           Invoice Number
     C                     Z-ADD*ZERO     WWAWDT           Invoice Date
     C                     Z-ADD*ZERO     WWVRVA           A/R order Value
     C                     Z-ADD*ZERO     WWB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WWNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WWNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WWNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WWNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WWNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WWBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WWBQTM           Time of Origina
     C                     Z-ADD*ZERO     WWBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WWBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WWBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WWH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WWH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WWH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WWH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WWH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WWC0C7           Claim Number
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  7
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004 114
     C                     Z-ADD*ZERO     WL0005  70
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008  7
     C                     Z-ADD*ZERO     WL0009  52
     C                     Z-ADD*ZERO     WL0010  94
      * Define local variables for subroutine SECRRC.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  30
     C                     MOVEL*BLANK    WL0015  6
     C                     Z-ADD*ZERO     WL0016  30
     C                     Z-ADD*ZERO     WL0017 114
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
      * Define local variables for subroutine SFCRRC.
     C                     Z-ADD*ZERO     WL0022  30
     C                     Z-ADD*ZERO     WL0023  70
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  30
     C                     MOVEL*BLANK    WL0026  6
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028 114
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
      * Define local variables for subroutine SHCRRC.
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  30
     C                     MOVEL*BLANK    WL0037  6
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  30
     C                     Z-ADD*ZERO     WL0040  52
     C                     Z-ADD*ZERO     WL0041 114
     C                     Z-ADD*ZERO     WL0042 114
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044  1
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  1
      * Define local variables for subroutine SICRRC.
     C                     Z-ADD*ZERO     WL0047  30
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  30
     C                     Z-ADD*ZERO     WL0050  30
     C                     MOVEL*BLANK    WL0051  6
     C                     Z-ADD*ZERO     WL0052  70
     C                     Z-ADD*ZERO     WL0053  30
     C                     Z-ADD*ZERO     WL0054  52
     C                     Z-ADD*ZERO     WL0055 114
     C                     Z-ADD*ZERO     WL0056 114
     C                     MOVEL*BLANK    WL0057  1
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0061  30
     C                     Z-ADD*ZERO     WL0062  70
     C                     Z-ADD*ZERO     WL0063  70
     C                     Z-ADD*ZERO     WL0064 114
     C                     Z-ADD*ZERO     WL0065 114
     C                     Z-ADD*ZERO     WL0066 114
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0067  30
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069 114
     C                     Z-ADD*ZERO     WL0070 114
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0071  70
     C                     MOVEL*BLANK    WL0072  3
     C                     Z-ADD*ZERO     WL0073  50
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  96
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0076  30
     C                     Z-ADD*ZERO     WL0077  70
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079 114
     C                     Z-ADD*ZERO     WL0080  70
     C                     MOVEL*BLANK    WL0081  1
     C                     MOVEL*BLANK    WL0082  2
     C                     Z-ADD*ZERO     WL0083 114
     C                     Z-ADD*ZERO     WL0084 114
     C                     Z-ADD*ZERO     WL0085 114
     C                     Z-ADD*ZERO     WL0086 112
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  1
     C                     MOVEL*BLANK    WL0089  1
     C                     MOVEL*BLANK    WL0090  1
     C                     Z-ADD*ZERO     WL0091  30
     C                     Z-ADD*ZERO     WL0092  30
     C                     Z-ADD*ZERO     WL0093  30
     C                     MOVEL*BLANK    WL0094  1
     C                     MOVEL*BLANK    WL0095  1
     C                     MOVEL*BLANK    WL0096  1
     C                     MOVEL*BLANK    WL0097  2
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0098  70
     C                     MOVEL*BLANK    WL0099  3
     C                     Z-ADD*ZERO     WL0100  50
     C                     Z-ADD*ZERO     WL0101  30
     C                     Z-ADD*ZERO     WL0102  30
     C                     Z-ADD*ZERO     WL0103  30
     C                     Z-ADD*ZERO     WL0104  96
     C                     MOVEL*BLANK    WL0105  2
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Item Code Txt
     C                     MOVEL*BLANK    YL0003  7
      * Define local work field Date Method Code
     C                     MOVEL*BLANK    YL0004  3
      * Define null work field Commodity Price Group
     C                     MOVEL*BLANK    YN0001  7
      * Define local work field Market Percent
     C                     Z-ADD*ZERO     YL0005  52
      * Define null work field Market Prem/Ded
     C                     Z-ADD*ZERO     YN0002  94
      * Define null work field Description Line One
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Description Line Two
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field U/M - Primary
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field Conversion Factor 1
     C                     Z-ADD*ZERO     YN0006  94
      * Define null work field Operation Factor 1
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field U/M - Second
     C                     MOVEL*BLANK    YN0008  2
      * Define null work field Conversion Factor 2
     C                     Z-ADD*ZERO     YN0009  94
      * Define null work field Operation Factor 2
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field U/M - Third
     C                     MOVEL*BLANK    YN0011  2
      * Define local work field U/M - Pricing
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0007 112
      * Define null work field Production Date Control
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0013  1
      * Define null work field Item Structure Class Code
     C                     Z-ADD*ZERO     YN0014  30
      * Define null work field Item Structure Group Code
     C                     Z-ADD*ZERO     YN0015  30
      * Define null work field Item Structure Type Code
     C                     Z-ADD*ZERO     YN0016  30
      * Define null work field Default Commod Mark basis
     C                     MOVEL*BLANK    YN0017  3
      * Define null work field Price Method Default
     C                     MOVEL*BLANK    YN0018  3
      * Define local work field Accrual Rate
     C                     Z-ADD*ZERO     YL0008  96
      * Define null work field All Products (Y/N)
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field Accrual Rate Type
     C                     MOVEL*BLANK    YN0020  2
      * Define null work field Comm Threshold Period
     C                     MOVEL*BLANK    YN0021  2
      * Define null work field CAH Unused Date 1
     C                     Z-ADD*ZERO     YN0022  70
      * Define null work field CAH Unused Date 2
     C                     Z-ADD*ZERO     YN0023  70
      * Define null work field Comm Min Amt /Period
     C                     Z-ADD*ZERO     YN0024 112
      * Define null work field Comm Retroactive Sts
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field Accrual Detail Search
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field Broker Code
     C                     MOVEL*BLANK    YN0027  6
      * Define null work field Max Accrual Amount
     C                     Z-ADD*ZERO     YN0028 112
      * Define null work field Accrual Description
     C                     MOVEL*BLANK    YN0029 30
      * Define null work field Automatic Accrual (Y/N)
     C                     MOVEL*BLANK    YN0030  1
      * Define null work field Print On Invoice (Y/N)
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field Rate Usage
     C                     MOVEL*BLANK    YN0032  1
      * Define local work field Add-on/Allowance
     C                     MOVEL*BLANK    YL0009  1
      * Define null work field Accrual Type
     C                     MOVEL*BLANK    YN0033  2
      * Define null work field Sub Ledger Code
     C                     MOVEL*BLANK    YN0034  2
      * Define null work field Reverse Accrual Code
     C                     MOVEL*BLANK    YN0035  3
      * Define null work field U/M - Primary Dft
     C                     MOVEL*BLANK    YN0036  2
      * Define null work field G/L Code Dr
     C                     MOVEL*BLANK    YN0037  8
      * Define null work field G/L Code Cr
     C                     MOVEL*BLANK    YN0038  8
      * Define null work field G/L Sub Account Code
     C                     MOVEL*BLANK    YN0039  8
      * Define null work field Sales History Exp Bucket
     C                     MOVEL*BLANK    YN0040  8
      * Define null work field Post to G/L (Y/N)
     C                     MOVEL*BLANK    YN0041  1
      * Define null work field All Products (Y/N)
     C                     MOVEL*BLANK    YN0042  1
      * Define null work field Accrual Rate
     C                     Z-ADD*ZERO     YN0043  96
      * Define null work field Accrual Rate Type
     C                     MOVEL*BLANK    YN0044  2
      * Define null work field Accrual Detail Search
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Standard Schedule (Y/N)
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Affect Sales Realz Rpt
     C                     MOVEL*BLANK    YN0047  1
      * Define local work field Affect Invoice Price
     C                     MOVEL*BLANK    YL0010  1
      * Define null work field Invoice Print Type
     C                     MOVEL*BLANK    YN0048  2
      * Define null work field Max Accrual Amount
     C                     Z-ADD*ZERO     YN0049 112
      * Define null work field Max Accrual Amount Type
     C                     MOVEL*BLANK    YN0050  2
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0051  1
      * Define local work field Accrual Rate
     C                     Z-ADD*ZERO     YL0011  96
      * Define null work field Price Overage Override
     C                     Z-ADD*ZERO     YN0052 114
      * Define null work field Contract Number
     C                     Z-ADD*ZERO     YN0053  70
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0054  1
      * Define null work field U/M - Ordered
     C                     MOVEL*BLANK    YN0055  2
      * Define null work field Unit Price
     C                     Z-ADD*ZERO     YN0056 114
      * Define null work field Unit Price - Credit
     C                     Z-ADD*ZERO     YN0057 114
      * Define null work field Unit Price Ordered U/M
     C                     Z-ADD*ZERO     YN0058 114
      * Define null work field Unit Weight Ordered U/M
     C                     Z-ADD*ZERO     YN0059 112
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0060  70
      * Define null work field Affect Inventory Status
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field Affect Sales Doll Status
     C                     MOVEL*BLANK    YN0062  1
      * Define null work field Affect Sales Pnds Status
     C                     MOVEL*BLANK    YN0063  1
      * Define null work field Affect Trade Fund
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Affect Commission
     C                     MOVEL*BLANK    YN0065  1
      * Define null work field Affect Pricing
     C                     MOVEL*BLANK    YN0066  1
      * Define null work field Ord TF Exempt Code
     C                     MOVEL*BLANK    YN0067  2
      * Define null work field U/M - Primary
     C                     MOVEL*BLANK    YN0068  2
      * Define null work field Conversion Factor 1
     C                     Z-ADD*ZERO     YN0069  94
      * Define null work field Operation Factor 1
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field U/M - Second
     C                     MOVEL*BLANK    YN0071  2
      * Define null work field Conversion Factor 2
     C                     Z-ADD*ZERO     YN0072  94
      * Define null work field Operation Factor 2
     C                     MOVEL*BLANK    YN0073  1
      * Define null work field U/M - Third
     C                     MOVEL*BLANK    YN0074  2
      * Define local work field U/M - Pricing
     C                     MOVEL*BLANK    YL0012  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0075 112
      * Define null work field Production Date Control
     C                     MOVEL*BLANK    YN0076  1
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0077  1
      * Define null work field Default Commod Mark basis
     C                     MOVEL*BLANK    YN0078  3
      * Define null work field Commodity Price Group
     C                     MOVEL*BLANK    YN0079  7
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Item Frt Overage /Prc UM
     C                     Z-ADD*ZERO     YL0014  74
      * Define null work field Commodity Price Group
     C                     MOVEL*BLANK    YN0080  7
      * Define null work field Market Percent
     C                     Z-ADD*ZERO     YN0081  52
      * Define local work field Price 11.0 USR
     C                     Z-ADD*ZERO     YL0015 110
      * Define local work field Price 11.1 USR
     C                     Z-ADD*ZERO     YL0016 111
      * Define local work field Price 11.2 USR
     C                     Z-ADD*ZERO     YL0017 112
      * Define local work field Price 11.3 USR
     C                     Z-ADD*ZERO     YL0018 113
      * Define local work field Price 11.4 USR
     C                     Z-ADD*ZERO     YL0019 114
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MKTPRC
00002 Y2U0005
00003 STRITM
00004 CIDIFF
00005 TCRDVY
00006 SUBCRD
00007 MSCYLD
00008 CIFMPF
00009 IOVRFM
00010 CFRTOV
00011 CIOVMK
00012 IOVMKT
00013 EXTEND
00014 OVRIDE
00015 ACCRLS
00016 CFRTAB
00017 IOVFRT
00018 CIMSLV
00019 CIPFEE
00020 CIFRTO
00021 CITMOV
00022 CSFRTO
00023 PSITPR
00024 ITMKTO
00025 MKTOVR
00026 GATADJ
00027 DVFADJ
00028 CCITOV
