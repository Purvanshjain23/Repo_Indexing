     H/TITLE BPS Cnv/Fab/Crd SMP   PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 10/05/20  Time  : 11:52:46
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPDLMCPL1IF  E           K        DISK
      * RTV : PS Prod Dept Schedule     Retrieval index
      *
     FPDI6CPL4IF  E           K        DISK
      * RSQ : PS Std Prod Mix Dist      Co/Dpt/Day/Pty/Itm
      *
     FPDI7CPL2IF  E           K        DISK
      * RSQ : PS Production Capability  Co/Dept/EftDte(d)
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDIORELFIF  E           K        DISK
      * RSQ : Item Bill Of Material     Co/Itm/CPty/CItm Mt
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPDIOREL3IF  E           K        DISK
      * RSQ : Item Bill Of Material     Consumed Items
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FPDIOREL6IF  E           K        DISK
      * RSQ : Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FPOB6CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      *
     FPOB6CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Consmd Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPNFKREL1IF  E           K        DISK
      * RTV : PS Std Prod Mix Dist WIP  Retrieval index
      *
     FPOCWCPL1IF  E           K        DISK
      * RTV : PS Prod Item Inventory    Retrieval index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     FPOB6CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Consmd Update index
      *
     FPDZ9PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: BPS Cnv/Fab/Crd SMP   PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@IOREYG
      * Item Bill Of Material     Consumed Items
      * Renamed input format fields
     I              IOAIC3                          WAAIC3
     I              IOHGCD                          WAHGCD
     I              IOC9NB                          WAC9NB
     I              IOV2ST                          WAV2ST
     I              IOBOPR                          WABOPR
     I              IOBPPR                          WABPPR
     I              IOHGQT                          WAHGQT
     I              IOHHCD                          WAHHCD
     I              IOYAST                          WAYAST
     I              IOCNSM                          WACNSM
     I              IOBMY1                          WABMY1
     I              IOBMY2                          WABMY2
     I              IOIXQT                          WAIXQT
     I              IOIYQT                          WAIYQT
     I              IORSST                          WARSST
     I              IORTST                          WARTST
     I              IOUVST                          WAUVST
     I              IOUWST                          WAUWST
     I              IOUXST                          WAUXST
     I              IOVSST                          WAVSST
     I              IOAATM                          WAAATM
     I              IOAYNA                          WAAYNA
     I              IOA0NA                          WAA0NA
     I              IOAXDT                          WAAXDT
      *
     I@IORETI
      * Item Bill Of Material     Retrieval index
      * Renamed input format fields
     I              IOAIC3                          WBAIC3
     I              IOHGCD                          WBHGCD
     I              IOC9NB                          WBC9NB
     I              IOV2ST                          WBV2ST
     I              IOBOPR                          WBBOPR
     I              IOBPPR                          WBBPPR
     I              IOHGQT                          WBHGQT
     I              IOHHCD                          WBHHCD
     I              IOYAST                          WBYAST
     I              IOCNSM                          WBCNSM
     I              IOBMY1                          WBBMY1
     I              IOBMY2                          WBBMY2
     I              IOIXQT                          WBIXQT
     I              IOIYQT                          WBIYQT
     I              IORSST                          WBRSST
     I              IORTST                          WBRTST
     I              IOUVST                          WBUVST
     I              IOUWST                          WBUWST
     I              IOUXST                          WBUXST
     I              IOVSST                          WBVSST
     I              IOAATM                          WBAATM
     I              IOAYNA                          WBAYNA
     I              IOA0NA                          WBA0NA
     I              IOAXDT                          WBAXDT
      *
     I@IOREGB
      * Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
      * Renamed input format fields
     I              IOAIC3                          WCAIC3
     I              IOHGCD                          WCHGCD
     I              IOC9NB                          WCC9NB
     I              IOV2ST                          WCV2ST
     I              IOBOPR                          WCBOPR
     I              IOBPPR                          WCBPPR
     I              IOHGQT                          WCHGQT
     I              IOHHCD                          WCHHCD
     I              IOYAST                          WCYAST
     I              IOCNSM                          WCCNSM
     I              IOBMY1                          WCBMY1
     I              IOBMY2                          WCBMY2
     I              IOIXQT                          WCIXQT
     I              IOIYQT                          WCIYQT
     I              IORSST                          WCRSST
     I              IORTST                          WCRTST
     I              IOUVST                          WCUVST
     I              IOUWST                          WCUWST
     I              IOUXST                          WCUXST
     I              IOVSST                          WCVSST
     I              IOAATM                          WCAATM
     I              IOAYNA                          WCAYNA
     I              IOA0NA                          WCA0NA
     I              IOAXDT                          WCAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WEAIC3
     I              I8V5ST                          WEV5ST
     I              I8ELDT                          WEELDT
     I              I8HGCD                          WEHGCD
     I              I8AJCD                          WEAJCD
     I              I8GPDT                          WEGPDT
     I              I8WTSP                          WEWTSP
     I              I8QTSP                          WEQTSP
     I              I8DJPC                          WEDJPC
     I              I8F8WG                          WEF8WG
     I              I8WTIN                          WEWTIN
     I              I8D5NB                          WED5NB
     I              I8DXWG                          WEDXWG
     I              I8B2NB                          WEB2NB
     I              I8WTCN                          WEWTCN
     I              I8PSCV                          WEPSCV
     I              I8SAWT                          WESAWT
     I              I8B9NB                          WEB9NB
     I              I8D1WG                          WED1WG
     I              I8CBNB                          WECBNB
     I              I8EZWG                          WEEZWG
     I              I8CCNB                          WECCNB
     I              I8E0WG                          WEE0WG
     I              I8D6NB                          WED6NB
     I              I8OAWT                          WEOAWT
     I              I8CDNB                          WECDNB
     I              I8UNW2                          WEUNW2
     I              I8CENB                          WECENB
     I              I8F9WG                          WEF9WG
     I              I8BPNB                          WEBPNB
     I              I8GAWG                          WEGAWG
     I              I8BQNB                          WEBQNB
     I              I8GBWG                          WEGBWG
     I              I8BRNB                          WEBRNB
     I              I8GCWG                          WEGCWG
     I              I8BSNB                          WEBSNB
     I              I8GDWG                          WEGDWG
     I              I8BWNB                          WEBWNB
     I              I8GEWG                          WEGEWG
     I              I8PS6U                          WEPS6U
     I              I8WCST                          WEWCST
     I              I8WPST                          WEWPST
     I              I8B5ST                          WEB5ST
     I              I8TFST                          WETFST
     I              I8TEST                          WETEST
     I              I8THST                          WETHST
     I              I8UDST                          WEUDST
     I              I8UFST                          WEUFST
     I              I8UGST                          WEUGST
     I              I8UHST                          WEUHST
     I              I8B6ST                          WEB6ST
     I              I8B7ST                          WEB7ST
     I              I8DVWG                          WEDVWG
     I              I8D7NB                          WED7NB
     I              I8FCAD                          WEFCAD
     I              I8D9NB                          WED9NB
     I              I8DWWG                          WEDWWG
     I              I8EANB                          WEEANB
     I              I8SHWT                          WESHWT
     I              I8EBNB                          WEEBNB
     I              I8AVWT                          WEAVWT
     I              I8ECNB                          WEECNB
     I              I8WTON                          WEWTON
     I              I8EDNB                          WEEDNB
     I              I8FNWT                          WEFNWT
     I              I8EENB                          WEEENB
     I              I8QTAS                          WEQTAS
     I              I8EFNB                          WEEFNB
     I              I8WAIO                          WEWAIO
     I              I8EGNB                          WEEGNB
     I              I8R3CD                          WER3CD
     I              I8RGNB                          WERGNB
     I              I8RHNB                          WERHNB
     I              I8RINB                          WERINB
     I              I8XRCD                          WEXRCD
     I              I8UVST                          WEUVST
     I              I8UWST                          WEUWST
     I              I8UXST                          WEUXST
     I              I8VSST                          WEVSST
     I              I8AATM                          WEAATM
     I              I8AYNA                          WEAYNA
     I              I8A0NA                          WEA0NA
     I              I8AXDT                          WEAXDT
      *
     I@B6CPNB
      * Order Detail Sched-Consmd Retrieval index
      * Renamed input format fields
     I              B6AIC3                          WFAIC3
     I              B6C4NB                          WFC4NB
     I              B6DPNB                          WFDPNB
     I              B6UENB                          WFUENB
     I              B6JGDT                          WFJGDT
     I              B6OONY                          WFOONY
     I              B6AODT                          WFAODT
     I              B6AJCD                          WFAJCD
     I              B6NUDT                          WFNUDT
     I              B6HGCD                          WFHGCD
     I              B6IGQT                          WFIGQT
     I              B6FLWG                          WFFLWG
     I              B6NSQT                          WFNSQT
     I              B6JQWG                          WFJQWG
     I              B6NVDT                          WFNVDT
     I              B6BUTM                          WFBUTM
     I              B6UVST                          WFUVST
     I              B6UWST                          WFUWST
     I              B6UXST                          WFUXST
     I              B6VSST                          WFVSST
     I              B6AATM                          WFAATM
     I              B6AYNA                          WFAYNA
     I              B6A0NA                          WFA0NA
     I              B6AXDT                          WFAXDT
      *
     I@B6CPNA
      * Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WGAIC3
     I              B6C4NB                          WGC4NB
     I              B6DPNB                          WGDPNB
     I              B6UENB                          WGUENB
     I              B6JGDT                          WGJGDT
     I              B6OONY                          WGOONY
     I              B6AODT                          WGAODT
     I              B6AJCD                          WGAJCD
     I              B6NUDT                          WGNUDT
     I              B6HGCD                          WGHGCD
     I              B6IGQT                          WGIGQT
     I              B6FLWG                          WGFLWG
     I              B6NSQT                          WGNSQT
     I              B6JQWG                          WGJQWG
     I              B6NVDT                          WGNVDT
     I              B6BUTM                          WGBUTM
     I              B6UVST                          WGUVST
     I              B6UWST                          WGUWST
     I              B6UXST                          WGUXST
     I              B6VSST                          WGVSST
     I              B6AATM                          WGAATM
     I              B6AYNA                          WGAYNA
     I              B6A0NA                          WGA0NA
     I              B6AXDT                          WGAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WHAIC3
     I              AFBCDT                          WHBCDT
     I              AFCQNB                          WHCQNB
     I              AFESNB                          WHESNB
     I              AFETNB                          WHETNB
     I              AFBZNB                          WHBZNB
     I              AFA9ST                          WHA9ST
     I              AFEINB                          WHEINB
     I              AFC5ST                          WHC5ST
     I              AFAQNB                          WHAQNB
     I              AFCMST                          WHCMST
     I              AFV9ST                          WHV9ST
     I              AFWAST                          WHWAST
     I              AFX2ST                          WHX2ST
     I              AFOJDT                          WHOJDT
     I              AFNQNX                          WHNQNX
     I              AFNRNX                          WHNRNX
     I              AFI9SX                          WHI9SX
     I              AFJASX                          WHJASX
     I              AFOKDT                          WHOKDT
     I              AFOLDT                          WHOLDT
     I              AFUVST                          WHUVST
     I              AFUWST                          WHUWST
     I              AFUXST                          WHUXST
     I              AFAATM                          WHAATM
     I              AFAYNA                          WHAYNA
     I              AFA0NA                          WHA0NA
     I              AFAXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WEAIC3
     I              I8V5ST                          WEV5ST
     I              I8ELDT                          WEELDT
     I              I8HGCD                          WEHGCD
     I              I8AJCD                          WEAJCD
     I              I8GPDT                          WEGPDT
     I              I8WTSP                          WEWTSP
     I              I8QTSP                          WEQTSP
     I              I8DJPC                          WEDJPC
     I              I8F8WG                          WEF8WG
     I              I8WTIN                          WEWTIN
     I              I8D5NB                          WED5NB
     I              I8DXWG                          WEDXWG
     I              I8B2NB                          WEB2NB
     I              I8WTCN                          WEWTCN
     I              I8PSCV                          WEPSCV
     I              I8SAWT                          WESAWT
     I              I8B9NB                          WEB9NB
     I              I8D1WG                          WED1WG
     I              I8CBNB                          WECBNB
     I              I8EZWG                          WEEZWG
     I              I8CCNB                          WECCNB
     I              I8E0WG                          WEE0WG
     I              I8D6NB                          WED6NB
     I              I8OAWT                          WEOAWT
     I              I8CDNB                          WECDNB
     I              I8UNW2                          WEUNW2
     I              I8CENB                          WECENB
     I              I8F9WG                          WEF9WG
     I              I8BPNB                          WEBPNB
     I              I8GAWG                          WEGAWG
     I              I8BQNB                          WEBQNB
     I              I8GBWG                          WEGBWG
     I              I8BRNB                          WEBRNB
     I              I8GCWG                          WEGCWG
     I              I8BSNB                          WEBSNB
     I              I8GDWG                          WEGDWG
     I              I8BWNB                          WEBWNB
     I              I8GEWG                          WEGEWG
     I              I8PS6U                          WEPS6U
     I              I8WCST                          WEWCST
     I              I8WPST                          WEWPST
     I              I8B5ST                          WEB5ST
     I              I8TFST                          WETFST
     I              I8TEST                          WETEST
     I              I8THST                          WETHST
     I              I8UDST                          WEUDST
     I              I8UFST                          WEUFST
     I              I8UGST                          WEUGST
     I              I8UHST                          WEUHST
     I              I8B6ST                          WEB6ST
     I              I8B7ST                          WEB7ST
     I              I8DVWG                          WEDVWG
     I              I8D7NB                          WED7NB
     I              I8FCAD                          WEFCAD
     I              I8D9NB                          WED9NB
     I              I8DWWG                          WEDWWG
     I              I8EANB                          WEEANB
     I              I8SHWT                          WESHWT
     I              I8EBNB                          WEEBNB
     I              I8AVWT                          WEAVWT
     I              I8ECNB                          WEECNB
     I              I8WTON                          WEWTON
     I              I8EDNB                          WEEDNB
     I              I8FNWT                          WEFNWT
     I              I8EENB                          WEEENB
     I              I8QTAS                          WEQTAS
     I              I8EFNB                          WEEFNB
     I              I8WAIO                          WEWAIO
     I              I8EGNB                          WEEGNB
     I              I8R3CD                          WER3CD
     I              I8RGNB                          WERGNB
     I              I8RHNB                          WERHNB
     I              I8RINB                          WERINB
     I              I8XRCD                          WEXRCD
     I              I8UVST                          WEUVST
     I              I8UWST                          WEUWST
     I              I8UXST                          WEUXST
     I              I8VSST                          WEVSST
     I              I8AATM                          WEAATM
     I              I8AYNA                          WEAYNA
     I              I8A0NA                          WEA0NA
     I              I8AXDT                          WEAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPOB61    E DSPOB6CPL0
      * UPD : Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WGAIC3
     I              B6C4NB                          WGC4NB
     I              B6DPNB                          WGDPNB
     I              B6UENB                          WGUENB
     I              B6JGDT                          WGJGDT
     I              B6OONY                          WGOONY
     I              B6AODT                          WGAODT
     I              B6AJCD                          WGAJCD
     I              B6NUDT                          WGNUDT
     I              B6HGCD                          WGHGCD
     I              B6IGQT                          WGIGQT
     I              B6FLWG                          WGFLWG
     I              B6NSQT                          WGNSQT
     I              B6JQWG                          WGJQWG
     I              B6NVDT                          WGNVDT
     I              B6BUTM                          WGBUTM
     I              B6UVST                          WGUVST
     I              B6UWST                          WGUWST
     I              B6UXST                          WGUXST
     I              B6VSST                          WGVSST
     I              B6AATM                          WGAATM
     I              B6AYNA                          WGAYNA
     I              B6A0NA                          WGA0NA
     I              B6AXDT                          WGAXDT
      *
     IYBRDCS      DS                             91
     IYCRDCS      DS                            326
      * Outward parameters
     IPARC        DS                            326
      * RCD : PS Prod Item Schedule     Retrieval index
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Production Type
     I                                        3   3 PAV5ST
      * I :  Production Date
     I                                    P   4   70PAELDT
      * I :  Item Code
     I                                    P   8  110PAHGCD
      * I :  Warehouse Code
     I                                       12  14 PAAJCD
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PS Prod Dept Schedule
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Production Type
     I                                        3   3 P1V5ST
      * I : RST Production Date
     I                                    P   4   70P1ELDT
      * I : RST Department Code
     I                                        8  13 P1R3CD
     IP2PARM      DS
      * I :  Std Mix Prod Type USR
     I                                        1   2 P2URST
     IP3PARM      DS
      * N :  Day of Week
     I                                        1   1 P3A9ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PS BOM Not Found'
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1V5ST    PARM           WP0002  1        Production Type
     C           P1ELDT    PARM           WP0003  70       Production Date
     C           P1R3CD    PARM           WP0004  6        Department Code
     C           P2URST    PARM           WP0005  2        Std Mix Prod Ty
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BPS Cnv/Fab/Crd SMP   PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$JENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * BPS Cnv/Fab/Crd SMP   PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN LMAIC3    WQKA01           Company Number
     C           *LIKE     DEFN LMV5ST    WQKA02           Production Type
     C           *LIKE     DEFN LMELDT    WQKA03           Production Date
     C           *LIKE     DEFN LMR3CD    WQKA04           Department Code
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
     C                     KFLD           WQKA02           Production Type
     C                     KFLD           WQKA03           Production Date
     C                     KFLD           WQKA04           Department Code
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
     C                     MOVELP1V5ST    WQKA02           Production Type
     C                     Z-ADDP1ELDT    WQKA03           Production Date
     C                     MOVELP1R3CD    WQKA04           Department Code
      * Establish starting position
     C           KRSA      SETLL@LMCPO1                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Production Type
     C                     MOVEL'Y'       W0AL02  1        Production Date
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDLMAIC3    $CAIC3           Company Number
     C                     MOVELLMV5ST    $CV5ST           Production Type
     C                     Z-ADDLMELDT    $CELDT           Production Date
     C                     MOVELLMR3CD    $CR3CD           Department Code
     C                     MOVELLMTKST    $CTKST           CDS Department
     C                     Z-ADDLMGGWG    $CGGWG           CDS Avg Piece W
     C                     Z-ADDLMRMPA    $CRMPA           CDS RM Pieces A
     C                     Z-ADDLMCLNB    $CCLNB           CDS CV Pieces A
     C                     Z-ADDLMGFWG    $CGFWG           CDS RM Weight A
     C                     Z-ADDLMGHWG    $CGHWG           CDS CV Weight A
      * USER: Process before print of detail format
      * CASE: Credit or Fab
      *  - c1 OR c2
      *   |- c1    : DB1.CDS Department Type is Credit
      *   |- c2    : DB1.CDS Department Type is Fabricating
      *   '-
     C           LMTKST    IFEQ 'C'                        *IF
     C           LMTKST    OREQ 'F'                        *OR
     C                     Z-ADD*ZERO     $CGGWG           CDS Avg Piece W
     C                     Z-ADD*ZERO     $CRMPA           CDS RM Pieces A
     C                     Z-ADD*ZERO     $CCLNB           CDS CV Pieces A
     C                     Z-ADD*ZERO     $CGFWG           CDS RM Weight A
     C                     Z-ADD*ZERO     $CGHWG           CDS CV Weight A
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : BPS Conv Dept SMP     PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN LMAIC3    WZA001           Company Number
     C                     Z-ADDLMAIC3    WZA001
     C           *LIKE     DEFN LMV5ST    WZA002           Production Type
     C                     MOVELLMV5ST    WZA002
     C           *LIKE     DEFN LMELDT    WZA003           Production Date
     C                     Z-ADDLMELDT    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@LMCPO1                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Production Type
     C                     MOVEL*BLANK    W0AL02  1        Production Date
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Production Type
     C                     MOVEL'Y'       W0AL02  1        Production Date
     C                     ELSE
      * Next record - Detect level breaks
     C           LMAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           LMV5ST    IFNE WZA002                     Production Type
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           LMELDT    IFNE WZA003                     Production Date
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * BPS Cnv/Fab/Crd SMP   PO: Mainline
      *================================================================
      * BPS Cnv/Fab/Crd SMP   PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN I6AIC3    WQKB01           Company Number
     C           *LIKE     DEFN I6R3CD    WQKB02           Department Code
     C           *LIKE     DEFN I6T9ST    WQKB03           SM Day of Week
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Department Code
     C                     KFLD           WQKB03           SM Day of Week
      * Setup key
     C                     Z-ADDP1AIC3    WQKB01           Company Number
     C                     MOVELP1R3CD    WQKB02           Department Code
     C                     MOVELP3A9ST    WQKB03           SM Day of Week
      * Establish starting position
     C           KRSB      SETLL@I6CPJ8                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Department Code
     C                     MOVEL'Y'       W0BL02  1        SM Day of Week
     C                     MOVEL'Y'       W0BL03  1        Mix Priority
     C                     MOVEL'Y'       W0BL04  1        Item Code
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDI6AIC3    $DAIC3           Company Number
     C                     MOVELI6R3CD    $DR3CD           Department Code
      * Load related totals format
     C                     Z-ADDI6AIC3    $IAIC3           Company Number
     C                     MOVELI6R3CD    $IR3CD           Department Code
      * USER: Process before print of Department Code format
     C                     Z-ADD$CCLNB    WN0029           SM Pieces Remai
     C                     Z-ADD$CGHWG    WN0030           SM Weight Remai
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDI6AIC3    $EAIC3           Company Number
     C                     MOVELI6R3CD    $ER3CD           Department Code
     C                     Z-ADDI6GJDT    $EGJDT           Effective Produ
     C                     Z-ADDI6MXPR    $EMXPR           Mix Priority
     C                     Z-ADDI6HGCD    $EHGCD           Item Code
     C                     MOVEL*BLANK    $EJUNA           USR Description
     C                     MOVEL*BLANK    $EGENA           Item Descriptio
     C                     Z-ADD*ZERO     $EEMNB           RM Pieces Avail
     C                     Z-ADDI6DHPC    $EDHPC           Mix Percent
     C                     Z-ADD*ZERO     $EEJNB           SM Pieces Need
     C                     MOVEL*BLANK    $ENQNA           Comment 60 USR
     C                     Z-ADD*ZERO     $EENNB           RM Weight Avail
     C                     Z-ADD*ZERO     $EGTWG           SM Weight Need
     C                     Z-ADD*ZERO     $EWLSD           Weight Left for
     C                     Z-ADDI6BMWE    $EBMWE           Export/Domestic
     C                     Z-ADDI6BMXW    $EBMXW           Select Range Ma
     C                     MOVELI6T9ST    $ET9ST           SM Day of Week
     C                     MOVELI6UAST    $EUAST           SM Unused Sts 2
     C                     MOVELI6UBST    $EUBST           SM Unused Sts 3
     C                     Z-ADDI6DENB    $EDENB           Pieces Override
     C                     Z-ADDI6DFNB    $EDFNB           SM Unused Nbr 2
     C                     Z-ADDI6DHNB    $EDHNB           Weight Override
     C                     MOVELI6XRCD    $EXRCD           Primal Group Co
     C                     MOVEL*BLANK    $EQ1CD           Default Warehou
     C                     MOVELI6UVST    $EUVST           EDI Status 1
     C                     MOVELI6UWST    $EUWST           EDI Status 2
     C                     MOVELI6UXST    $EUXST           EDI Status 3
     C                     MOVELI6VSST    $EVSST           Record Status
     C                     Z-ADDI6AATM    $EAATM           Job Time
     C                     MOVELI6AYNA    $EAYNA           User Id
     C                     MOVELI6A0NA    $EA0NA           Job Name
     C                     Z-ADDI6AXDT    $EAXDT           Job Date
      * USER: Process before print of detail format
      * DOC:
     C                     EXSR UBSUBR                     DOC:
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0039 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0001           Company Number
     C                     Z-ADD$EHGCD    WL0002           Item Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    $EJUNA    P      Description Lin
     C                     MOVELWL0004    WN0005    P      U/M - Primary
     C                     Z-ADDWL0005    WN0006           Unit Weight
     C                     Z-ADDWL0006    WN0007           Item Structure
     C                     Z-ADDWL0007    WN0008           Item Structure
     C                     Z-ADDWL0008    WN0009           Item Structure
     C                     MOVELWL0009    WN0010    P      Item Type Code
     C                     MOVELWL0010    $EQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    WN0012           Fresh Chilling
     C                     MOVELWL0012    WN0013    P      Base/Conv/Loss
     C                     MOVELWL0013    WN0014    P      Variety/Rendere
     C                     MOVELWL0014    WN0015    P      Credit Item Sta
     C                     Z-ADDWL0015    WN0016           Std Weight/Head
     C                     Z-ADDWL0016    WN0017           Pieces Per Head
     C                     MOVELWL0017    $ER3CD    P      Department Code
     C                     MOVELWL0018    WN0018    P      Group for Packa
     C                     MOVELWL0019    WN0019    P      Seconds Item
     C                     MOVELWL0020    WN0020    P      Piece Count Ite
     C                     Z-ADDWL0021    WN0021           Pieces Per Bag
     C                     Z-ADDWL0022    WN0022           Bags Per Unit
     C                     MOVELWL0023    WN0023    P      Export/Domestic
     C                     MOVELWL0024    WN0024    P      Print On Schedu
     C                     MOVELWL0025    WN0025    P      Fresh Inv Alloc
     C                     MOVELWL0026    WN0026    P      Fresh Sched As
     C                     MOVELWL0027    WN0027    P      Frozen Inv Allo
     C                     MOVELWL0028    $EXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$EQ1CD    WL0029    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WN0003    P      Warehouse Type
     C                     MOVELWL0031    WN0035    P      Trans Contol AS
     C                     MOVELWL0032    WN0036    P      Warehouse Locat
     C                     MOVELWL0033    WN0037    P      Warehouse Std C
     C                     Z-ADDWL0034    WN0038           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WN0010    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WN0002           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WN0019    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WN0002           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WN0014    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WN0002           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WN0014    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WN0002           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WN0014    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WN0015    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WN0013    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WN0002           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WN0013    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WN0002           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WN0013    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WN0002           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WN0013    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WN0002           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WN0013    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WN0002           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WN0013    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WN0002           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WN0013    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WN0002           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WN0013    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WN0002           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL$EQ1CD    YL0002           Default Warehou
      * If Department Type = Piece Converting
      * CASE: PAR.CDS Department Type is Piece Converting
     C           $CTKST    IFEQ 'P'                        *IF
      * If piece override is not zero, use the override, else calc piece
      * CASE: DB1.Pieces Override is Not Equal to Zeros
     C           I6DENB    IFNE *ZERO                      *IF
     C                     Z-ADDI6DENB    $EEJNB           SM Pieces Need
     C                     ELSE
      * CASE: *OTHERWISE
      * Loin Boning Mix Percent
      * CASE: DB1.Department Code is Loin Boning
     C           I6R3CD    IFEQ 'LOINS'                    *IF
      * CASE: PAR.Export/Domestic is Domestic
     C           WN0023    IFEQ 'D'                        *IF
      * Rtv Consumed Item     RT - Item Bill Of Material  * 
     C                     EXSR SGRVGN
      * BPS Rtv RM Pln Pieces RT - PS Prod Item Schedule  * 
     C                     EXSR SHRVGN
      * 02/11/08 Use Mix Percent from the Standard Mix File.
     C                     Z-ADDI6DHPC    $EDHPC           Mix Percent
     C                     ELSE
      * CASE: PAR.Export/Domestic is Export
     C           WN0023    IFEQ 'E'                        *IF
      * 02/11/08 Use Mix Percent from the Standard Mix File.
     C                     Z-ADDI6DHPC    $EDHPC           Mix Percent
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SM Pieces Need USR
      * CUR.SM Pieces Need USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CDS CV Pieces Avail
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : CUR.Mix Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EDHPC    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $CCLNB    MULT W0WB01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $EEJNB           SM Pieces Need
     C                     END                             *FI
      * Allocate Pieces Remaining
      * CASE: CUR.SM Pieces Need USR GE PAR.SM Pieces Remain USR
     C           $EEJNB    IFGE WN0029                     *IF
     C                     Z-ADDWN0029    $EEJNB           SM Pieces Need
     C                     Z-ADD*ZERO     WN0029           SM Pieces Remai
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0031    WN0029           SM Pieces Remai
     C                     END                             *FI
     C           $EEJNB    MULT $CGGWG    $EGTWG           SM Weight Need
     C                     END                             *FI
      * If Department Type = Weight Converting
      * CASE: PAR.CDS Department Type is Weight Converting
     C           $CTKST    IFEQ 'W'                        *IF
      * If weight override is not zeros, use override, else calc weight n
      * CASE: DB1.Weight Override is Not Equal to Zeros
     C           I6DHNB    IFNE *ZERO                      *IF
     C                     Z-ADDI6DHNB    $EGTWG           SM Weight Need
     C                     ELSE
      * CASE: *OTHERWISE
      * SM Weight Need USR
      * CUR.SM Weight Need USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CDS CV Weight Avail
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Mix Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $EDHPC    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $CGHWG    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $EGTWG           SM Weight Need
     C                     END                             *FI
      * Pieces Override
      * CASE: PAR.Piece Count Item is yes
     C           WN0020    IFEQ 'Y'                        *IF
      * CASE: DB1.Pieces Override is Not Equal to Zeros
     C           I6DENB    IFNE *ZERO                      *IF
     C                     Z-ADDI6DENB    WN0031           SM Pieces Need
     C           WN0031    MULT $CGGWG    WN0032           SM Weight Need
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight Remaining
      * CASE: CUR.SM Weight Need USR GE PAR.SM Weight Remain USR
     C           $EGTWG    IFGE WN0030                     *IF
     C                     Z-ADDWN0030    $EGTWG           SM Weight Need
     C                     Z-ADD*ZERO     WN0030           SM Weight Remai
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0032    WN0030           SM Weight Remai
     C                     END                             *FI
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.CDS Avg Piece Wgt is GT Zero
      *   |- c2    : DB1.Pieces Override is Equal to Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $CGGWG    IFGT *ZERO                      *IF
     C           I6DENB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WN0032    DIV  $CGGWG    WN0031    H      SM Pieces Need
     C                     END                             *FI
     C                     END                             *FI
      * If Department Type = Credit or Fabricating
      * CASE: Credit or Fabricating
      *  - c1 OR c2
      *   |- c1    : PAR.CDS Department Type is Credit
      *   |- c2    : PAR.CDS Department Type is Fabricating
      *   '-
     C           $CTKST    IFEQ 'C'                        *IF
     C           $CTKST    OREQ 'F'                        *OR
      * If Piece & Weight override is not zero use them else calc needs.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Pieces Override is Equal to Zeros
      *   |- c2    : DB1.Weight Override is Equal to Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           I6DENB    IFEQ *ZERO                      *IF
     C           I6DHNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * BPS Rtv/Calc RM Avail RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0035           Company Number
     C                     Z-ADD$EHGCD    WL0036           Item Code
     C                     MOVELP1V5ST    WL0037    P      Production Type
     C                     Z-ADDP1ELDT    WL0038           Production Date
     C                     Z-ADD$EEJNB    WL0039           SM Pieces Need
     C                     Z-ADD$EGTWG    WL0040           SM Weight Need
     C                     Z-ADD$EDHPC    WL0041           Mix Percent
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    $EEJNB           SM Pieces Need
     C                     Z-ADDWL0040    $EGTWG           SM Weight Need
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Pieces Override is Not Equal to Zeros
      *   |- c2    : DB1.Weight Override is Equal to Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           I6DENB    IFNE *ZERO                      *IF
     C           I6DHNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * BPS Rtv/Calc RM Avail RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0035           Company Number
     C                     Z-ADD$EHGCD    WL0036           Item Code
     C                     MOVELP1V5ST    WL0037    P      Production Type
     C                     Z-ADDP1ELDT    WL0038           Production Date
     C                     Z-ADD$EEJNB    WL0039           SM Pieces Need
     C                     Z-ADD$EGTWG    WL0040           SM Weight Need
     C                     Z-ADD$EDHPC    WL0041           Mix Percent
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    $EEJNB           SM Pieces Need
     C                     Z-ADDWL0040    $EGTWG           SM Weight Need
     C                     Z-ADDI6DENB    $EEJNB           SM Pieces Need
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Pieces Override is Equal to Zeros
      *   |- c2    : DB1.Weight Override is Not Equal to Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           I6DENB    IFEQ *ZERO                      *IF
     C           I6DHNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * BPS Rtv/Calc RM Avail RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0035           Company Number
     C                     Z-ADD$EHGCD    WL0036           Item Code
     C                     MOVELP1V5ST    WL0037    P      Production Type
     C                     Z-ADDP1ELDT    WL0038           Production Date
     C                     Z-ADD$EEJNB    WL0039           SM Pieces Need
     C                     Z-ADD$EGTWG    WL0040           SM Weight Need
     C                     Z-ADD$EDHPC    WL0041           Mix Percent
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    $EEJNB           SM Pieces Need
     C                     Z-ADDWL0040    $EGTWG           SM Weight Need
     C                     Z-ADDI6DHNB    $EGTWG           SM Weight Need
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDI6DENB    $EEJNB           SM Pieces Need
     C                     Z-ADDI6DHNB    $EGTWG           SM Weight Need
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * This block of code was moved to the BPS Rtv/Calc Avail RT functio
      * written over the file PS Prod Item Schedule.
      * This function is in the BPS Rtv/Calc Avail  RT over file
      * PD Item Bill Of Material (The function directly above these comme
     C                     END                             *FI
      * Val Item Has BOM       RT - PD Item Bill Of Material  * 
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Retrieve message PS BOM Not Found
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2011' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           $ENQNA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : BPS BOM Consume RMB   PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : BPS Cnv/Fab/Crd SMP   PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN I6AIC3    WZB001           Company Number
     C                     Z-ADDI6AIC3    WZB001
     C           *LIKE     DEFN I6R3CD    WZB002           Department Code
     C                     MOVELI6R3CD    WZB002
     C           *LIKE     DEFN I6T9ST    WZB003           SM Day of Week
     C                     MOVELI6T9ST    WZB003
     C           *LIKE     DEFN I6MXPR    WZB004           Mix Priority
     C                     Z-ADDI6MXPR    WZB004
     C           *LIKE     DEFN I6HGCD    WZB005           Item Code
     C                     Z-ADDI6HGCD    WZB005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@I6CPJ8                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * First Time Processing
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     Z-ADDI6GJDT    WUGJDT           Effective Produ
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Department Code
     C                     MOVEL*BLANK    W0BL02  1        SM Day of Week
     C                     MOVEL*BLANK    W0BL03  1        Mix Priority
     C                     MOVEL*BLANK    W0BL04  1        Item Code
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Department Code
     C                     MOVEL'Y'       W0BL02  1        SM Day of Week
     C                     MOVEL'Y'       W0BL03  1        Mix Priority
     C                     MOVEL'Y'       W0BL04  1        Item Code
     C                     ELSE
      * Next record - Detect level breaks
     C           I6AIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           I6R3CD    IFNE WZB002                     Department Code
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           I6T9ST    IFNE WZB003                     SM Day of Week
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           I6MXPR    IFNE WZB004                     Mix Priority
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           I6HGCD    IFNE WZB005                     Item Code
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$IKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * BPS BOM Consume RM    PO: Mainline
      *================================================================
      * BPS BOM Consume RM    PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQKC01           Company Number
     C           *LIKE     DEFN WCHGCD    WQKC02           Item Code
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Item Code
      * Setup key
     C                     Z-ADD$EAIC3    WQKC01           Company Number
     C                     Z-ADD$EHGCD    WQKC02           Item Code
      * Establish starting position
     C           KRSC      SETLL@IOREGB                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Item Code
     C                     MOVEL'Y'       W0CL02  1        BOM Type
     C                     MOVEL'Y'       W0CL03  1        Consume Priorit
     C                     MOVEL'Y'       W0CL04  1        Component Item
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * USER: Process before print of Component Item Code format
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCAIC3    $FAIC3           Company Number
     C                     Z-ADDWCHGCD    $FHGCD           Item Code
     C                     MOVELWCV2ST    $FV2ST           BOM Type
     C                     MOVEL*BLANK    $FGUTX           Condition Name
     C                     Z-ADDWCC9NB    $FC9NB           Component Item
     C                     MOVEL*BLANK    $FJUNA           USR Description
     C                     MOVEL*BLANK    $FGENA           Item Descriptio
     C                     MOVEL*BLANK    $FR3CD           Department Code
     C                     Z-ADDWCCNSM    $FCNSM           Consume Priorit
     C                     Z-ADDWCBMY1    $FBMY1           Consume Priorit
     C                     Z-ADD*ZERO     $FEKNB           RM Pieces Need
     C                     Z-ADD*ZERO     $FGUWG           RM Weight Need
     C                     Z-ADD*ZERO     $FEMNB           RM Pieces Avail
     C                     Z-ADD*ZERO     $FENNB           RM Weight Avail
     C                     Z-ADDWCBPPR    $FBPPR           Production Yiel
     C                     Z-ADD*ZERO     $FGWWG           Avg Piece Wgt 5
     C                     Z-ADD*ZERO     $FPIAC           Pieces Schedule
     C                     Z-ADD*ZERO     $FAUWG           Weight Schedule
     C                     Z-ADD*ZERO     $FCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     $FF8WG           PS Avg Piece Wg
     C                     Z-ADDWCBOPR    $FBOPR           Sales Yield
     C                     Z-ADDWCHGQT    $FHGQT           Packaging Quant
     C                     MOVELWCHHCD    $FHHCD           U/M - Primary D
     C                     MOVELWCYAST    $FYAST           Upd Standard Pr
     C                     Z-ADDWCBMY2    $FBMY2           BOM Pumped Perc
     C                     Z-ADDWCIXQT    $FIXQT           BOM Meat Cost C
     C                     Z-ADDWCIYQT    $FIYQT           BOM Off Line Yi
     C                     MOVELWCRSST    $FRSST           BOM Multi-RM Op
     C                     MOVELWCRTST    $FRTST           BOM Group Prod
     C                     MOVELWCUVST    $FUVST           EDI Status 1
     C                     MOVELWCUWST    $FUWST           EDI Status 2
     C                     MOVELWCUXST    $FUXST           EDI Status 3
     C                     MOVELWCVSST    $FVSST           Record Status
     C                     Z-ADDWCAATM    $FAATM           Job Time
     C                     MOVELWCAYNA    $FAYNA           User Id
     C                     MOVELWCA0NA    $FA0NA           Job Name
     C                     Z-ADDWCAXDT    $FAXDT           Job Date
      * USER: Process before print of detail format
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0057 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$FAIC3    WL0001           Company Number
     C                     Z-ADD$FC9NB    WL0002           Item Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    $FJUNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    WUAIWG           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WN0043    P      Default Warehou
     C                     Z-ADDWL0011    WUCHTM           Fresh Chilling
     C                     MOVELWL0012    WN0044    P      Base/Conv/Loss
     C                     MOVELWL0013    WN0045    P      Variety/Rendere
     C                     MOVELWL0014    WN0046    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WN0047           Pieces Per Head
     C                     MOVELWL0017    $FR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WN0048    P      Piece Count Ite
     C                     Z-ADDWL0021    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0022    WUBJNB           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export/Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$EQ1CD    WL0029    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WUWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0034    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WN0045    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WN0045    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WN0045    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WN0046    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WN0044    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WN0044    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WN0044    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WN0044    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WN0044    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WN0044    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WN0044    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WN0044    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 08/26/09 PKD S00912 Use Production Warehouse for the Default Whs
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0043    WL0042    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0043    WN0055    P      Production Ware
     C                     Z-ADDWL0044    WN0056           Accounting Comp
      * Consumed Items
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WCV2ST    IFEQ 'C'                        *IF
      * CASE: WRK.Item Type Code is Raw Material
     C           WUN0CD    IFEQ 'RM'                       *IF
      * BPS Rtv RM Avail      RT - PS Prod Item Schedule  * 
     C                     EXSR SNRVGN
      * Average Piece Weight
      * CASE: CUR.RM Weight Avail USR is Greater than zero
     C           $FENNB    IFGT *ZERO                      *IF
     C                     Z-ADD$FF8WG    $FGWWG           Avg Piece Wgt 5
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $FGWWG           Avg Piece Wgt 5
     C                     END                             *FI
      * Process the Consumption based on Pieces Per head greater than 0
      * for the Component Item Code.   Changed by Mark Arensberg  09/02/9
      * Process by Pieces Per Head for the compenent Item. If peices per
      * CASE: PAR.Pieces Per Head is GT Zero
     C           WN0047    IFGT *ZERO                      *IF
      * CASE: PAR.RM Pieces Need USR is GT Zero
     C           WN0049    IFGT *ZERO                      *IF
      * Process by Consume Priority % using Pieces
      * CASE: CUR.Consume Priority % is Equal to 100 Pct
     C           $FBMY1    IFEQ 100                        *IF
     C                     Z-ADDWN0049    $FEKNB           RM Pieces Need
      * RM Weight Need USR
      * CUR.RM Weight Need USR =
      *    *COMPUTE (x1 * x2)
      * x1    : CUR.RM Pieces Need USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PS Avg Piece Wgt
     C           $FEKNB    MULT $FF8WG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $FGUWG           RM Weight Need
      * Pieces/Weight Scheduled
      * CASE: CUR.RM Pieces Need USR GT CUR.RM Pieces Avail USR
     C           $FEKNB    IFGT $FEMNB                     *IF
     C                     Z-ADD$FEMNB    $FPIAC           Pieces Schedule
     C                     Z-ADD$FENNB    $FAUWG           Weight Schedule
     C                     SUB  $FEMNB    WN0049           RM Pieces Need
     C                     SUB  $FENNB    WN0050           RM Weight Need
     C                     SUB  $FEMNB    WN0051           RM Pieces Alloc
     C                     SUB  $FENNB    WN0052           RM Weight Alloc
     C                     ELSE
      * CASE: CUR.RM Pieces Need USR LE CUR.RM Pieces Avail USR
     C           $FEKNB    IFLE $FEMNB                     *IF
     C                     Z-ADD$FEKNB    $FPIAC           Pieces Schedule
     C                     Z-ADD$FGUWG    $FAUWG           Weight Schedule
     C                     SUB  $FEKNB    WN0049           RM Pieces Need
     C                     SUB  $FGUWG    WN0050           RM Weight Need
     C                     SUB  $FEKNB    WN0051           RM Pieces Alloc
     C                     SUB  $FGUWG    WN0052           RM Weight Alloc
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: CUR.Consume Priority % is Not Equal to 100 PCt
     C           $FBMY1    IFNE 100                        *IF
      * RM Pieces Need
      * CUR.RM Pieces Need USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.RM Pieces Alloc USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : CUR.Consume Priority %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $FBMY1    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0051    MULT W0WB01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $FEKNB           RM Pieces Need
      * RM Weight Need USR
      * CUR.RM Weight Need USR =
      *    *COMPUTE (x1 * x2)
      * x1    : CUR.RM Pieces Need USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.PS Avg Piece Wgt
     C           $FEKNB    MULT $FF8WG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $FGUWG           RM Weight Need
      * Pieces/Weight Scheduled
      * CASE: CUR.RM Pieces Need USR GT CUR.RM Pieces Avail USR
     C           $FEKNB    IFGT $FEMNB                     *IF
     C                     Z-ADD$FEMNB    $FPIAC           Pieces Schedule
     C                     Z-ADD$FENNB    $FAUWG           Weight Schedule
     C                     SUB  $FEMNB    WN0049           RM Pieces Need
     C                     SUB  $FENNB    WN0050           RM Weight Need
     C                     ELSE
      * CASE: CUR.RM Pieces Need USR LE CUR.RM Pieces Avail USR
     C           $FEKNB    IFLE $FEMNB                     *IF
     C                     Z-ADD$FEKNB    $FPIAC           Pieces Schedule
     C                     Z-ADD$FGUWG    $FAUWG           Weight Schedule
     C                     SUB  $FEKNB    WN0049           RM Pieces Need
     C                     SUB  $FGUWG    WN0050           RM Weight Need
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.RM Weight Need USR is Greater than zero
     C           WN0050    IFGT *ZERO                      *IF
      * Process by Consume Priority % using Weight
      * CASE: CUR.Consume Priority % is Equal to 100 Pct
     C           $FBMY1    IFEQ 100                        *IF
     C                     Z-ADDWN0050    $FGUWG           RM Weight Need
      * RM Pieces Need
      * CASE: CUR.PS Avg Piece Wgt is GT Zero
     C           $FF8WG    IFGT *ZERO                      *IF
      * RM Pieces Need USR
      * CUR.RM Pieces Need USR =
      *    *COMPUTE (x1 / x2)
      * x1    : CUR.RM Weight Need USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : CUR.PS Avg Piece Wgt
     C           $FGUWG    DIV  $FF8WG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $FEKNB           RM Pieces Need
     C                     END                             *FI
      * Pieces/Weight Scheduled
      * CASE: CUR.RM Weight Need USR GT CUR.RM Weight Avail USR
     C           $FGUWG    IFGT $FENNB                     *IF
     C                     Z-ADD$FEMNB    $FPIAC           Pieces Schedule
     C                     Z-ADD$FENNB    $FAUWG           Weight Schedule
     C                     SUB  $FEMNB    WN0049           RM Pieces Need
     C                     SUB  $FENNB    WN0050           RM Weight Need
     C                     SUB  $FEMNB    WN0051           RM Pieces Alloc
     C                     SUB  $FENNB    WN0052           RM Weight Alloc
     C                     ELSE
      * CASE: CUR.RM Weight Need USR LE CUR.RM Weight Avail USR
     C           $FGUWG    IFLE $FENNB                     *IF
     C                     Z-ADD$FEKNB    $FPIAC           Pieces Schedule
     C                     Z-ADD$FGUWG    $FAUWG           Weight Schedule
     C                     SUB  $FEKNB    WN0049           RM Pieces Need
     C                     SUB  $FGUWG    WN0050           RM Weight Need
     C                     SUB  $FEKNB    WN0051           RM Pieces Alloc
     C                     SUB  $FGUWG    WN0052           RM Weight Alloc
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: CUR.Consume Priority % is Not Equal to 100 PCt
     C           $FBMY1    IFNE 100                        *IF
      * RM weight Need
      * CUR.RM Weight Need USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.RM Weight Alloc USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Consume Priority %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $FBMY1    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0052    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $FGUWG           RM Weight Need
      * RM Pieces Need
      * CASE: CUR.PS Avg Piece Wgt is GT Zero
     C           $FF8WG    IFGT *ZERO                      *IF
      * RM Pieces Need
      * CUR.RM Pieces Need USR =
      *    *COMPUTE (x1 / x2)
      * x1    : CUR.RM Weight Need USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : CUR.PS Avg Piece Wgt
     C           $FGUWG    DIV  $FF8WG    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    $FEKNB           RM Pieces Need
     C                     END                             *FI
      * Pieces/Weight Scheduled
      * CASE: CUR.RM Weight Need USR GT CUR.RM Weight Avail USR
     C           $FGUWG    IFGT $FENNB                     *IF
     C                     Z-ADD$FEMNB    $FPIAC           Pieces Schedule
     C                     Z-ADD$FENNB    $FAUWG           Weight Schedule
     C                     SUB  $FEMNB    WN0049           RM Pieces Need
     C                     SUB  $FENNB    WN0050           RM Weight Need
     C                     ELSE
      * CASE: CUR.RM Weight Need USR LE CUR.RM Weight Avail USR
     C           $FGUWG    IFLE $FENNB                     *IF
     C                     Z-ADD$FEKNB    $FPIAC           Pieces Schedule
     C                     Z-ADD$FGUWG    $FAUWG           Weight Schedule
     C                     SUB  $FEKNB    WN0049           RM Pieces Need
     C                     SUB  $FGUWG    WN0050           RM Weight Need
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  $FPIAC    WN0053           Pieces Schedule
     C                     ADD  $FAUWG    WN0054           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Produced Item
      * CASE: DB1.BOM Type is Produced - Meat
     C           WCV2ST    IFEQ 'P'                        *IF
      * CASE: DB1.Production Yield is not equal to zeros
     C           WCBPPR    IFNE *ZERO                      *IF
      * FP1054 5/14/09 RMC  above CASE changed to NE 0, it was GT 0
      * Weight Scheduled
      * CUR.Weight Scheduled =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.Weight Scheduled
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WCBPPR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0054    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $FAUWG           Weight Schedule
      * The number of Pieces Scheduled for a Produced Item is based
      * on the Piece Count Item sts of the Component Item Code.
      * Pieces Scheduled/Quantity Scheduled
      * CASE: PAR.Piece Count Item is yes
     C           WN0048    IFEQ 'Y'                        *IF
     C                     Z-ADDWN0053    $FPIAC           Pieces Schedule
      * Average Piece Weight
      * CASE: CUR.Pieces Scheduled is NE Zeros
     C           $FPIAC    IFNE *ZERO                      *IF
      * FP1054 RMC 5/14/09 changed above CASE to ne 0, it was gt 0
      * Average Piece Weight
      * CUR.Avg Piece Wgt 5.2 USR =
      *    *COMPUTE (x1 / x2)
      * x1    : CUR.Weight Scheduled
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Pieces Scheduled
     C           $FAUWG    DIV  $FPIAC    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $FGWWG           Avg Piece Wgt 5
     C                     END                             *FI
      * Quantity Scheduled
      * CUR.Quantity Scheduled =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : CUR.Pieces Scheduled
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.Pieces Per Bag
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : WRK.Bags Per Unit
     C           WUBDNB    MULT WUBJNB    W0WA01           *Synon (15,2) w
     C           $FPIAC    DIV  W0WA01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $FCCQT           Quantity Schedu
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $FPIAC           Pieces Schedule
      * CASE: WRK.Unit Weight is Not equal zero
     C           WUAIWG    IFNE *ZERO                      *IF
      * Quantity Scheduled
      * CUR.Quantity Scheduled =
      *    *COMPUTE (x1 / x2)
      * x1    : CUR.Weight Scheduled
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.Unit Weight
     C           $FAUWG    DIV  WUAIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $FCCQT           Quantity Schedu
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $FAUWG           Weight Schedule
     C                     Z-ADD*ZERO     $FPIAC           Pieces Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * 08/26/09 PKD S00912 Use Production Warehouse for the Default Whs
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WCV2ST    IFEQ 'C'                        *IF
      * BPS Upd Pcs/Wgt Conv  RT - PS Prod Item Schedule  * 
     C                     EXSR SORVGN
     C                     ELSE
      * CASE: DB1.BOM Type is Produced - Meat
     C           WCV2ST    IFEQ 'P'                        *IF
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     C                     END                             *FI
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCAIC3    WZC001           Company Number
     C                     Z-ADDWCAIC3    WZC001
     C           *LIKE     DEFN WCHGCD    WZC002           Item Code
     C                     Z-ADDWCHGCD    WZC002
     C           *LIKE     DEFN WCV2ST    WZC003           BOM Type
     C                     MOVELWCV2ST    WZC003
     C           *LIKE     DEFN WCCNSM    WZC004           Consume Priorit
     C                     Z-ADDWCCNSM    WZC004
     C           *LIKE     DEFN WCC9NB    WZC005           Component Item
     C                     Z-ADDWCC9NB    WZC005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@IOREGB                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Item Code
     C                     MOVEL*BLANK    W0CL02  1        BOM Type
     C                     MOVEL*BLANK    W0CL03  1        Consume Priorit
     C                     MOVEL*BLANK    W0CL04  1        Component Item
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Item Code
     C                     MOVEL'Y'       W0CL02  1        BOM Type
     C                     MOVEL'Y'       W0CL03  1        Consume Priorit
     C                     MOVEL'Y'       W0CL04  1        Component Item
     C                     ELSE
      * Next record - Detect level breaks
     C           WCAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WCHGCD    IFNE WZC002                     Item Code
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           WCV2ST    IFNE WZC003                     BOM Type
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           WCCNSM    IFNE WZC004                     Consume Priorit
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           WCC9NB    IFNE WZC005                     Component Item
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$GFINTTL
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * BPS Cnv/Fab/Crd SMP   PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN FKAIC3    WQKD01           Company Number
     C           *LIKE     DEFN FKR3CD    WQKD02           Department Code
     C           *LIKE     DEFN FKT9ST    WQKD03           SM Day of Week
     C           *LIKE     DEFN FKHGCD    WQKD04           Item Code
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Department Code
     C                     KFLD           WQKD03           SM Day of Week
     C                     KFLD           WQKD04           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WQKD01           Company Number
     C                     MOVELP1R3CD    WQKD02           Department Code
     C                     MOVELP3A9ST    WQKD03           SM Day of Week
     C                     Z-ADD$EHGCD    WQKD04           Item Code
      * Establish starting position
     C           KRSD      SETLL@FKREB1                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Department Code
     C                     MOVEL'Y'       W0DL02  1        SM Day of Week
     C                     MOVEL'Y'       W0DL03  1        Item Code
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDFKAIC3    $HAIC3           Company Number
     C                     MOVELFKR3CD    $HR3CD           Department Code
     C                     MOVELFKT9ST    $HT9ST           SM Day of Week
     C                     Z-ADDFKGJDT    $HGJDT           Effective Produ
     C                     Z-ADDFKHGCD    $HHGCD           Item Code
     C                     Z-ADDFKCNNB    $HCNNB           WIP Item Code
     C                     Z-ADD*ZERO     $HPAWG           WIP Weight on H
     C                     Z-ADD*ZERO     $HPUNY           WIP Pieces on H
     C                     MOVELFKVSST    $HVSST           Record Status
     C                     Z-ADDFKMJDT    $HMJDT           Create Date
     C                     Z-ADDFKBETM    $HBETM           Create Time
     C                     MOVELFKCCVN    $HCCVN           Create User
     C                     MOVELFKCDVN    $HCDVN           Create Program
     C                     Z-ADDFKMKDT    $HMKDT           Change Date
     C                     Z-ADDFKBFTM    $HBFTM           Change Time
     C                     MOVELFKCEVN    $HCEVN           Change User
     C                     MOVELFKCFVN    $HCFVN           Change Program
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FKAIC3    WZD001           Company Number
     C                     Z-ADDFKAIC3    WZD001
     C           *LIKE     DEFN FKR3CD    WZD002           Department Code
     C                     MOVELFKR3CD    WZD002
     C           *LIKE     DEFN FKT9ST    WZD003           SM Day of Week
     C                     MOVELFKT9ST    WZD003
     C           *LIKE     DEFN FKHGCD    WZD004           Item Code
     C                     Z-ADDFKHGCD    WZD004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@FKREB1                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        Company Number
     C                     MOVEL*BLANK    W0DL01  1        Department Code
     C                     MOVEL*BLANK    W0DL02  1        SM Day of Week
     C                     MOVEL*BLANK    W0DL03  1        Item Code
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Department Code
     C                     MOVEL'Y'       W0DL02  1        SM Day of Week
     C                     MOVEL'Y'       W0DL03  1        Item Code
     C                     ELSE
      * Next record - Detect level breaks
     C           FKAIC3    IFNE WZD001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           FKR3CD    IFNE WZD002                     Department Code
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           FKT9ST    IFNE WZD003                     SM Day of Week
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           FKHGCD    IFNE WZD004                     Item Code
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of BPS Cnv/Fab/Crd SMP   PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of BPS Cnv/Fab/Crd SMP   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of BPS Cnv/Fab/Crd SMP   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Production Type of BPS Cnv/Fab/Crd SMP   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Production Date of BPS Cnv/Fab/Crd SMP   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of BPS Cnv/Fab/Crd SMP   PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Convert fields to external form
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Department Code of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$DKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print SM Day of Week of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Mix Priority of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Item Code of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Detail line. of BPS Cnv/Fab/Crd SMP   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of BPS BOM Consume RM    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of BPS BOM Consume RM    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Item Code of BPS BOM Consume RM    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print BOM Type of BPS BOM Consume RM    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Consume Priority of BPS BOM Consume RM    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Component Item Code of BPS BOM Consume RM    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print Detail line. of BPS BOM Consume RM    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Component Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $FC9NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$FC9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VFC9NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VFC9NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Company Number of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print Department Code of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print SM Day of Week of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print Item Code of BPS Cnv/Fab/Crd SMP   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print Detail line. of BPS Cnv/Fab/Crd SMP   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * RTV Pces/Bag,Bag/Unit  RT - Company Item  * 
     C                     EXSR TCRVGN
      * Rtv Wgt On-Hand       RT - PS Prod Item Inventory  * 
     C                     EXSR TDRVGN
      * CASE: CUR.WIP Weight on Hand is Greater than zero
     C           $HPAWG    IFGT *ZERO                      *IF
      * BPS Upd Pcs/Wgt Std   XF - PS Std Prod Mix Dist WIP  * 
     C                     CLEARPARC
     C                     Z-ADD$HAIC3    PAAIC3           Company Number
     C                     MOVEL'S'       PAV5ST    P      Production Type
     C                     Z-ADD##JDT     PAELDT           Production Date
     C                     Z-ADD$HHGCD    PAHGCD           Item Code
     C                     MOVELYL0002    PAAJCD    P      Warehouse Code
      *
     C                     CALL 'PNJIXFR'              90  BPS Upd Pcs/Wgt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: PS Prod It
     C                     PARM $HPUNY    WQ0001  70       WIP Pieces on H
     C                     PARM $HPAWG    WQ0002 112       WIP Weight on H
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNJIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert WIP Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $HCNNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$HCNNB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VHCNNB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VHCNNB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of BPS Cnv/Fab/Crd SMP   PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of BPS Cnv/Fab/Crd SMP   PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Production Type of BPS Cnv/Fab/Crd SMP   PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Production Date of BPS Cnv/Fab/Crd SMP   PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of BPS Cnv/Fab/Crd SMP   PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of BPS Cnv/Fab/Crd SMP   PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of BPS Cnv/Fab/Crd SMP   PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Department Code of BPS Cnv/Fab/Crd SMP   PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * SM Day of Week of BPS Cnv/Fab/Crd SMP   PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Mix Priority of BPS Cnv/Fab/Crd SMP   PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of BPS Cnv/Fab/Crd SMP   PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of BPS Cnv/Fab/Crd SMP   PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of BPS BOM Consume RM    PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of BPS BOM Consume RM    PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of BPS BOM Consume RM    PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOM Type of BPS BOM Consume RM    PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Consume Priority of BPS BOM Consume RM    PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Component Item Code of BPS BOM Consume RM    PO
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of BPS BOM Consume RM    PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of BPS Cnv/Fab/Crd SMP   PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of BPS Cnv/Fab/Crd SMP   PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Department Code of BPS Cnv/Fab/Crd SMP   PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * SM Day of Week of BPS Cnv/Fab/Crd SMP   PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of BPS Cnv/Fab/Crd SMP   PO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of BPS Cnv/Fab/Crd SMP   PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD1         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * TOP = PAR By name
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
     C                     MOVELP1V5ST    $BV5ST           Production Type
     C                     Z-ADDP1ELDT    $BELDT           Production Date
     C                     MOVELP2URST    $BURST           Std Mix Prod Ty
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  $BELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBELDT
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'P/S'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Day of Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSC01           Company Number
     C           *LIKE     DEFN AFBCDT    WQSC02           Post to G/L Dat
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Post to G/L Dat
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     Z-ADDP1ELDT    WQSC02           Post to G/L Dat
      * Establish starting position
     C           KRSSC     SETLL@AFREYY                    *
     C           KRSSC     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELAFA9ST    P3A9ST           Day of Week
     C           KRSSC     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Export Pass Rate  RT - PS Production Capability  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN I7AIC3    WQSD01           Company Number
     C           *LIKE     DEFN I7R3CD    WQSD02           Department Code
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Department Code
     C                     KFLD           I7GJDT           Effective Produ
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Department Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSD01           Company Number
     C                     MOVELP1R3CD    WQSD02           Department Code
     C                     Z-ADDP1ELDT    I7GJDT           Effective Produ
      * Establish starting position
     C           KPSSD     SETLL@I7CPBK                    *
     C           KRSSD     READE@I7CPBK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1761' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0001           Export Pass Rat
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDI7EPPC    YL0001           Export Pass Rat
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@I7CPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    BZAIC3           Company Number
     C                     Z-ADDWL0002    BZHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Description Lin
     C                     MOVEL*BLANK    WL0004           U/M - Primary
     C                     Z-ADD*ZERO     WL0005           Unit Weight
     C                     Z-ADD*ZERO     WL0006           Item Structure
     C                     Z-ADD*ZERO     WL0007           Item Structure
     C                     Z-ADD*ZERO     WL0008           Item Structure
     C                     MOVEL*BLANK    WL0009           Item Type Code
     C                     MOVEL*BLANK    WL0010           Default Warehou
     C                     Z-ADD*ZERO     WL0011           Fresh Chilling
     C                     MOVEL*BLANK    WL0012           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0013           Variety/Rendere
     C                     MOVEL*BLANK    WL0014           Credit Item Sta
     C                     Z-ADD*ZERO     WL0015           Std Weight/Head
     C                     Z-ADD*ZERO     WL0016           Pieces Per Head
     C                     MOVEL*BLANK    WL0017           Department Code
     C                     MOVEL*BLANK    WL0018           Group for Packa
     C                     MOVEL*BLANK    WL0019           Seconds Item
     C                     MOVEL*BLANK    WL0020           Piece Count Ite
     C                     Z-ADD*ZERO     WL0021           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0022           Bags Per Unit
     C                     MOVEL*BLANK    WL0023           Export/Domestic
     C                     MOVEL*BLANK    WL0024           Print On Schedu
     C                     MOVEL*BLANK    WL0025           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0026           Fresh Sched As
     C                     MOVEL*BLANK    WL0027           Frozen Inv Allo
     C                     MOVEL*BLANK    WL0028           Primal Group Co
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0003           Description Lin
     C                     MOVELBZADCD    WL0004           U/M - Primary
     C                     Z-ADDBZAIWG    WL0005           Unit Weight
     C                     Z-ADDBZRINB    WL0006           Item Structure
     C                     Z-ADDBZRHNB    WL0007           Item Structure
     C                     Z-ADDBZRGNB    WL0008           Item Structure
     C                     MOVELBZN0CD    WL0009           Item Type Code
     C                     MOVELBZQ1CD    WL0010           Default Warehou
     C                     Z-ADDBZCHTM    WL0011           Fresh Chilling
     C                     MOVELBZQZCD    WL0012           Base/Conv/Loss
     C                     MOVELBZXWST    WL0013           Variety/Rendere
     C                     MOVELBZVMST    WL0014           Credit Item Sta
     C                     Z-ADDBZSWGH    WL0015           Std Weight/Head
     C                     Z-ADDBZPPHE    WL0016           Pieces Per Head
     C                     MOVELBZR3CD    WL0017           Department Code
     C                     MOVELBZSDCD    WL0018           Group for Packa
     C                     MOVELBZX5ST    WL0019           Seconds Item
     C                     MOVELBZPCCT    WL0020           Piece Count Ite
     C                     Z-ADDBZBDNB    WL0021           Pieces Per Bag
     C                     Z-ADDBZBJNB    WL0022           Bags Per Unit
     C                     MOVELBZSUST    WL0023           Export/Domestic
     C                     MOVELBZSVST    WL0024           Print On Schedu
     C                     MOVELBZSYST    WL0025           Fresh Inv Alloc
     C                     MOVELBZSZST    WL0026           Fresh Sched As
     C                     MOVELBZS1ST    WL0027           Frozen Inv Allo
     C                     MOVELBZXRCD    WL0028           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0029    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0030           Warehouse Type
     C                     MOVEL*BLANK    WL0031           Trans Contol AS
     C                     MOVEL*BLANK    WL0032           Warehouse Locat
     C                     MOVEL*BLANK    WL0033           Warehouse Std C
     C                     Z-ADD*ZERO     WL0034           Warehouse Chill
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0030           Warehouse Type
     C                     MOVELADXUST    WL0031           Trans Contol AS
     C                     MOVELADT0ST    WL0032           Warehouse Locat
     C                     MOVELADT1ST    WL0033           Warehouse Std C
     C                     Z-ADDADDBNB    WL0034           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Consumed Item     RT - Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0005           First Time Flag
     C                     MOVEL*BLANK    YL0004           Text 1 Length U
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSG01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSG02           Item Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Item Code
      * Setup key
     C                     Z-ADD$IAIC3    WQSG01           Company Number
     C                     Z-ADD$EHGCD    WQSG02           Item Code
      * Establish starting position
     C           KRSSG     SETLL@IOREI1                    *
     C           KRSSG     READE@IOREI1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Component Item
     C                     MOVEL*BLANK    YL0004           Text 1 Length U
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Time Flag is Yes
     C           YL0005    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDIOC9NB    YL0003           Component Item
     C                     MOVEL'N'       YL0005           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'+'       YL0004           Text 1 Length U
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@IOREI1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * BPS Rtv RM Pln Pieces RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN I8AIC3    WQSH01           Company Number
     C           *LIKE     DEFN I8V5ST    WQSH02           Production Type
     C           *LIKE     DEFN I8ELDT    WQSH03           Production Date
     C           *LIKE     DEFN I8HGCD    WQSH04           Item Code
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Production Type
     C                     KFLD           WQSH03           Production Date
     C                     KFLD           WQSH04           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSH01           Company Number
     C                     MOVELP1V5ST    WQSH02           Production Type
     C                     Z-ADDP1ELDT    WQSH03           Production Date
     C                     Z-ADDYL0003    WQSH04           Item Code
      * Establish starting position
     C           KRSSH     SETLL@I8CPUS                    *
     C           KRSSH     READE@I8CPUS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0006           PS Pieces Plann
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDI8QTSP    YL0006           PS Pieces Plann
     C           KRSSH     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * BPS Rtv/Calc RM Avail RT - Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0039           SM Pieces Need
     C                     Z-ADD*ZERO     WL0040           SM Weight Need
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WAHGCD    WQSI02           Item Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Item Code
      * Setup key
     C                     Z-ADDWL0035    WQSI01           Company Number
     C                     Z-ADDWL0036    WQSI02           Item Code
      * Establish starting position
     C           KRSSI     SETLL@IOREYG                    *
     C           KRSSI     READE@IOREYG                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * BPS Rtv/Calc RM Avail RT - PS Prod Item Schedule  * 
     C                     EXSR SJRVGN
     C           KRSSI     READE@IOREYG                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * BPS Rtv/Calc RM Avail RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0040  70       RM Pieces Avail
     C                     Z-ADD*ZERO     WN0041 112       RM Weight Avail
     C                     Z-ADD*ZERO     WN0042  70       Pieces Per Head
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN I8AIC3    WQSJ01           Company Number
     C           *LIKE     DEFN I8V5ST    WQSJ02           Production Type
     C           *LIKE     DEFN I8ELDT    WQSJ03           Production Date
     C           *LIKE     DEFN I8HGCD    WQSJ04           Item Code
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Production Type
     C                     KFLD           WQSJ03           Production Date
     C                     KFLD           WQSJ04           Item Code
      * Setup key
     C                     Z-ADDWL0035    WQSJ01           Company Number
     C                     MOVELWL0037    WQSJ02           Production Type
     C                     Z-ADDWL0038    WQSJ03           Production Date
     C                     Z-ADDWAC9NB    WQSJ04           Item Code
      * Establish starting position
     C           KRSSJ     SETLL@I8CPUS                    *
     C           KRSSJ     READE@I8CPUS                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Pieces Per Head   RT - Company/Item  * 
     C                     EXSR SKRVGN
      * RM Pieces Avail
      * PAR.RM Pieces Avail USR =
      *    *COMPUTE (x2 + x4 - x3 - x5)
      * x2    : DB1.PS Pieces Planned Prod
      * +     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Standard
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x5    : DB1.PS Pieces Whse Tfr Adj
     C           I8QTSP    ADD  I8B2NB    W0WJ02           *Synon (15,0) w
     C           W0WJ02    SUB  I8PSCV    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  I8BPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0040           RM Pieces Avail
      * RM Weight Avail
      * PAR.RM Weight Avail USR =
      *    *COMPUTE (x2 + x4 - x3 - x5)
      * x2    : DB1.PS Weight Planned Prod
      * +     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Standard
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x5    : DB1.PS Weight Whse Tfr Adj
     C           I8WTSP    ADD  I8DXWG    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  I8WTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  I8GAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0041           RM Weight Avail
      * CASE: PAR.Pieces Per Head is GT Zero
     C           WN0042    IFGT 0                          *IF
      * SM Pieces Need USR
      * PAR.SM Pieces Need USR =
      *    *COMPUTE (x4 + (x1 * (x2 / x3)))
      * x4    : PAR.SM Pieces Need USR
      * +     : PGM.*Synon (17,7) work field
      * x1    : PAR.RM Pieces Avail USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Mix Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WL0041    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WN0040    MULT W0WB02    W0WJ01    H      *Synon (15,0) w
     C           WL0039    ADD  W0WJ01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0039           SM Pieces Need
      * SM Weight Need USR
      * PAR.SM Weight Need USR =
      *    *COMPUTE (x4 + (x1 * x2))
      * x4    : PAR.SM Weight Need USR
      * +     : PGM.*Synon (17,7) work field
      * x1    : PAR.SM Pieces Need USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : DB1.PS Avg Piece Wgt
     C           WL0039    MULT I8F8WG    W0WJ01    H      *Synon (15,0) w
     C           WL0040    ADD  W0WJ01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0040           SM Weight Need
     C                     ELSE
      * CASE: *OTHERWISE
      * SM Weight Need USR
      * PAR.SM Weight Need USR =
      *    *COMPUTE (x4 + (x1 * (x2 / x3)))
      * x4    : PAR.SM Weight Need USR
      * +     : PGM.*Synon (17,7) work field
      * x1    : PAR.RM Weight Avail USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Mix Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WL0041    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WN0041    MULT W0WB02    W0WA01    H      *Synon (15,2) w
     C           WL0040    ADD  W0WA01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0040           SM Weight Need
      * CASE: DB1.PS Avg Piece Wgt is GT Zero
     C           I8F8WG    IFGT 0                          *IF
      * SM Pieces Need USR
      * PAR.SM Pieces Need USR =
      *    *COMPUTE (x4 + (x2 / x3))
      * x4    : PAR.SM Pieces Need USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.SM Weight Need USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : DB1.PS Avg Piece Wgt
     C           WL0040    DIV  I8F8WG    W0WB01    H      *Synon (15,5) w
     C           WL0039    ADD  W0WB01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0039           SM Pieces Need
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Pieces Per Head   RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDI8AIC3    BZAIC3           Company Number
     C                     Z-ADDI8HGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSK     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0042           Pieces Per Head
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZPPHE    WN0042           Pieces Per Head
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Val Item Has BOM       RT - PD Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSL02           Item Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Item Code
      * Setup key
     C                     Z-ADD$EAIC3    WQSL01           Company Number
     C                     Z-ADD$EHGCD    WQSL02           Item Code
      * Establish starting position
     C           KRSSL     SETLL@IORETI                    *
     C           KRSSL     READE@IORETI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@IORETI                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0042    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0043           Production Ware
     C                     Z-ADD*ZERO     WL0044           Accounting Comp
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAOCD    WL0043           Production Ware
     C                     Z-ADDWDBTC3    WL0044           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * BPS Rtv RM Avail      RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADD$FAIC3    I8AIC3           Company Number
     C                     MOVELP1V5ST    I8V5ST           Production Type
     C                     Z-ADDP1ELDT    I8ELDT           Production Date
     C                     Z-ADD$FC9NB    I8HGCD           Item Code
     C                     MOVELWN0055    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDI8F8WG    $FF8WG           PS Avg Piece Wg
     C                     Z-ADDI8QTSP    YL0007           PS Pieces Plann
      * RM Pieces Avail
      * PAR.RM Pieces Avail USR =
      *    *COMPUTE (x1 + (x2 + x4 - x3 - x5))
      * x1    : PAR.RM Pieces Avail USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.PS Pieces Planned Prod
      * +     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Standard
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x5    : DB1.PS Pieces Whse Tfr Adj
     C           I8QTSP    ADD  I8B2NB    W0WD03           *Synon (17,7) w
     C           W0WD03    SUB  I8PSCV    W0WJ02           *Synon (15,0) w
     C           W0WJ02    SUB  I8BPNB    W0WD01           *Synon (17,7) w
     C           $FEMNB    ADD  W0WD01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    $FEMNB           RM Pieces Avail
      * RM Weight Avail
      * PAR.RM Weight Avail USR =
      *    *COMPUTE (x1 + (x2 + x4 - x3 - x5))
      * x1    : PAR.RM Weight Avail USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.PS Weight Planned Prod
      * +     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Standard
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x5    : DB1.PS Weight Whse Tfr Adj
     C           I8WTSP    ADD  I8DXWG    W0WD03           *Synon (17,7) w
     C           W0WD03    SUB  I8WTCN    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  I8GAWG    W0WD01           *Synon (17,7) w
     C           $FENNB    ADD  W0WD01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $FENNB           RM Weight Avail
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * BPS Upd Pcs/Wgt Conv  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0058  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0059  70       PS Pieces Conve
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWN0056    I8AIC3           Company Number
     C                     MOVELP1V5ST    I8V5ST           Production Type
     C                     Z-ADDP1ELDT    I8ELDT           Production Date
     C                     Z-ADD$FC9NB    I8HGCD           Item Code
     C                     MOVELWN0055    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSO     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           I8PSCV    ADD  $FPIAC    WN0059           PS Pieces Conve
     C           I8WTCN    ADD  $FAUWG    WN0058           PS Weight Conve
      * If weight OR pieces converted is LT 0 then make zero
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Converted is LT Zero
      *   |- c2    : PAR.PS Pieces Converted is LT Zeros
      *   '-
     C           WN0058    IFLT 0                          *IF
     C           WN0059    ORLT 0                          *OR
     C                     Z-ADD0         WN0058           PS Weight Conve
     C                     Z-ADD0         WN0059           PS Pieces Conve
     C                     END                             *FI
      * BPS Chg Pcs/Wgt Conv  CH - PS Prod Item Schedule  * 
     C                     EXSR SPCHRC
      * FP1054 create consumed records   -- 10/05/2020 WITH SHIPP CO ON O
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           *ZERO     IFGT 0                          *IF
      * WAS UPD WITH PAR.COMPANY NUMBER WHICH IS THE ACCTNG CO 10-05-2020
      * RTV Company for Ord   RT - Order Header TRG  * 
     C                     EXSR SQRVGN
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
     C                     EXSR SRRVGN
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0009    IFEQ 0                          *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
     C                     EXSR STRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * BPS Chg Pcs/Wgt Conv  CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0060  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0061  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0062  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0063  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0064  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0065  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0066  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0067  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0068  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0069  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0070  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0071  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0072  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0073  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0074  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0075  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0076  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0077  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0078  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0079  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0080  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0081 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0082  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0083 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0084  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0085 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0086  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0087 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0088  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0089 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0090  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0091 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0092  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0093  3        PS Item Id
     C                     MOVEL*BLANK    WN0094  2        Warehouse Type
     C                     MOVEL*BLANK    WN0095  1        PS Lock Status
     C                     MOVEL*BLANK    WN0096  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0097  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0098  1        PS Piece Count
     C                     MOVEL*BLANK    WN0099  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0100  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0101  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0102  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0103  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0104  3        PS Production W
     C                     Z-ADD*ZERO     WN0105  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0106  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0107  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0108  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0109  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0110  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0111  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0112  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0113  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0114  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0115  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0116  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0117  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0118  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0119  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0120  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0121  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0122  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0123  6        Department Code
     C                     Z-ADD*ZERO     WN0124  30       Item Structure
     C                     Z-ADD*ZERO     WN0125  30       Item Structure
     C                     Z-ADD*ZERO     WN0126  30       Item Structure
     C                     MOVEL*BLANK    WN0127  6        Primal Group Co
     C                     MOVEL*BLANK    WN0128  1        EDI Status 1
     C                     MOVEL*BLANK    WN0129  1        EDI Status 2
     C                     MOVEL*BLANK    WN0130  1        EDI Status 3
     C                     MOVEL*BLANK    WN0131  1        Record Status
     C                     Z-ADD*ZERO     WN0132  60       Job Time
     C                     MOVEL*BLANK    WN0133 10        User Id
     C                     MOVEL*BLANK    WN0134 10        Job Name
     C                     Z-ADD*ZERO     WN0135  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDI8AIC3    WEAIC3           Company Number
     C                     MOVELI8V5ST    WEV5ST    P      Production Type
     C                     Z-ADDI8ELDT    WEELDT           Production Date
     C                     Z-ADDI8HGCD    WEHGCD           Item Code
     C                     MOVELI8AJCD    WEAJCD    P      Warehouse Code
      *
     C           KLCHSP    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C           KLCHSP    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0058    WEWTCN           PS Weight Conve
     C                     Z-ADDWN0059    WEPSCV           PS Pieces Conve
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Company for Ord   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEC4NB    WQSQ01           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Order Number
      * Setup key
     C                     Z-ADD*ZERO     WQSQ01           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@BFCPY2                    *
     C           KRSSQ     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEAIC3    YL0008           Company Number
     C           KRSSQ     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0009           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN B6AIC3    WQSR01           Company Number
     C           *LIKE     DEFN B6C4NB    WQSR02           Order Number
     C           *LIKE     DEFN B6DPNB    WQSR03           Order Sequence
     C           *LIKE     DEFN B6UENB    WQSR04           Order Secondary
     C           *LIKE     DEFN B6JGDT    WQSR05           OD Production D
     C           *LIKE     DEFN B6NUDT    WQSR06           Consumed Item C
     C           *LIKE     DEFN B6HGCD    WQSR07           Item Code
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
     C                     KFLD           WQSR03           Order Sequence
     C                     KFLD           WQSR04           Order Secondary
     C                     KFLD           WQSR05           OD Production D
     C                     KFLD           WQSR06           Consumed Item C
     C                     KFLD           WQSR07           Item Code
      * Setup key
     C                     Z-ADDYL0008    WQSR01           Company Number
     C                     Z-ADD*ZERO     WQSR02           Order Number
     C                     Z-ADD*ZERO     WQSR03           Order Sequence
     C                     Z-ADD*ZERO     WQSR04           Order Secondary
     C                     Z-ADDI8ELDT    WQSR05           OD Production D
     C                     Z-ADD$FC9NB    WQSR06           Consumed Item C
     C                     Z-ADD*ZERO     WQSR07           Item Code
      * Establish starting position
     C           KRSSR     SETLL@B6CPAG                    *
     C           KRSSR     READE@B6CPAG                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDB6OONY    YL0009           ODS Sequence Nu
     C           KRSSR     READE@B6CPAG                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0009           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSS02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSS03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSS04           Order Secondary
     C           *LIKE     DEFN WFJGDT    WQSS05           OD Production D
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Order Number
     C                     KFLD           WQSS03           Order Sequence
     C                     KFLD           WQSS04           Order Secondary
     C                     KFLD           WQSS05           OD Production D
      * Setup key
     C                     Z-ADDYL0008    WQSS01           Company Number
     C                     Z-ADD*ZERO     WQSS02           Order Number
     C                     Z-ADD*ZERO     WQSS03           Order Sequence
     C                     Z-ADD*ZERO     WQSS04           Order Secondary
     C                     Z-ADDI8ELDT    WQSS05           OD Production D
      * Establish starting position
     C           KRSSS     SETLL@B6CPNB                    *
     C           KRSSS     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWFOONY    YL0009           ODS Sequence Nu
     C           KRSSS     READE@B6CPNB                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         YL0009           ODS Sequence Nu
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0136  1        EDI Status 1
     C                     MOVEL*BLANK    WN0137  1        EDI Status 2
     C                     MOVEL*BLANK    WN0138  1        EDI Status 3
     C                     MOVEL*BLANK    WN0139  1        Record Status
     C                     Z-ADD*ZERO     WN0140  60       Job Time
     C                     MOVEL*BLANK    WN0141 10        User Id
     C                     MOVEL*BLANK    WN0142 10        Job Name
     C                     Z-ADD*ZERO     WN0143  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
     C                     KFLD           WFOONY           ODS Sequence Nu
      * Setup key
     C                     Z-ADDYL0008    WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADDI8ELDT    WFJGDT           OD Production D
     C                     Z-ADDYL0009    WFOONY           ODS Sequence Nu
      * Establish starting position
     C           KRSST     CHAIN@B6CPNB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3152' W0RTN   7
      * USER: Processing if Data record not found
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.OD Pieces Scheduled is Greater than zero
      *   |- c2    : PAR.OD Weight Scheduled is Greater than zero
      *   '-
     C           $FPIAC    IFGT 0                          *IF
     C           $FAUWG    ORGT 0                          *OR
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
     C                     EXSR SUCRRC
     C                     END                             *FI
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFFLWG    ADD  $FAUWG    YL0010           OD Weight Sched
     C           WFIGQT    ADD  $FPIAC    YL0011           OD Qty/Cnsmd Pi
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.OD Pieces Scheduled is Less than or equal zero
      *   |- c2    : LCL.OD Weight Scheduled is Less than or equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFLE 0                          *IF
     C           YL0010    IFLE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
     C                     EXSR SVDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
     C                     EXSR SWCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPNA
     C                     Z-ADDYL0008    WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADDI8ELDT    WGJGDT           OD Production D
     C                     Z-ADDYL0009    WGOONY           ODS Sequence Nu
     C                     Z-ADD0         WGAODT           Scheduled Ship
     C                     MOVELI8AJCD    WGAJCD           Warehouse Code
     C                     Z-ADD$FC9NB    WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD$FPIAC    WGIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD$FAUWG    WGFLWG           OD Weight Sched
     C                     Z-ADD0         WGNSQT           ODS Quantity Sh
     C                     Z-ADD0         WGJQWG           ODS Weight Shor
     C                     Z-ADD0         WGNVDT           Deadline Depart
     C                     Z-ADD0         WGBUTM           Deadline Depart
     C                     MOVELWN0136    WGUVST           EDI Status 1
     C                     MOVELWN0137    WGUWST           EDI Status 2
     C                     MOVELWN0138    WGUXST           EDI Status 3
     C                     MOVELWN0139    WGVSST           Record Status
     C                     Z-ADDWN0140    WGAATM           Job Time
     C                     MOVELWN0141    WGAYNA           User Id
     C                     MOVELWN0142    WGA0NA           Job Name
     C                     Z-ADDWN0143    WGAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WGVSST           Record Status
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRSU    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
      * Check for duplicate primary key
     C           KLCRSU    SETLL@B6CPNA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3153' W0RTN   7
      * Send message 'Order Detail Sched-Con EX'
     C                     MOVEL'USR3153' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPNA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVDLRC    BEGSR
      *================================================================
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPNA
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
     C                     Z-ADDWFJGDT    WGJGDT           OD Production D
     C                     Z-ADDWFOONY    WGOONY           ODS Sequence Nu
      *
     C           KLDLSV    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
     C           KLDLSV    CHAIN@B6CPNA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPNA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0144  1        EDI Status 1
     C                     MOVEL*BLANK    WN0145  1        EDI Status 2
     C                     MOVEL*BLANK    WN0146  1        EDI Status 3
     C                     MOVEL*BLANK    WN0147  1        Record Status
     C                     Z-ADD*ZERO     WN0148  60       Job Time
     C                     MOVEL*BLANK    WN0149 10        User Id
     C                     MOVEL*BLANK    WN0150 10        Job Name
     C                     Z-ADD*ZERO     WN0151  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B6CPNA
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
     C                     Z-ADDWFJGDT    WGJGDT           OD Production D
     C                     Z-ADDWFOONY    WGOONY           ODS Sequence Nu
      *
     C           KLCHSW    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
     C           KLCHSW    CHAIN@B6CPNA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB61    YBRDCS
      * Move non-key fields to @B6CPNA
     C                     Z-ADD0         WGAODT           Scheduled Ship
     C                     MOVELI8AJCD    WGAJCD    P      Warehouse Code
     C                     Z-ADD$FC9NB    WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADDYL0011    WGIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDYL0010    WGFLWG           OD Weight Sched
     C                     Z-ADDWFNSQT    WGNSQT           ODS Quantity Sh
     C                     Z-ADDWFJQWG    WGJQWG           ODS Weight Shor
     C                     Z-ADD0         WGNVDT           Deadline Depart
     C                     Z-ADD0         WGBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B6CPNA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0152  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0153  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0154  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0155  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0156  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0157  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0158  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0159  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0160  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0161  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0162  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0163  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0164  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0165  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0166  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0167  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0168  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0169  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0170  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0171  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0172  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0173  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0174  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0175 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0176  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0177 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0178  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0179 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0180  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0181 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0182  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0183 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0184  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0185 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0186  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0187  3        PS Item Id
     C                     MOVEL*BLANK    WN0188  2        Warehouse Type
     C                     MOVEL*BLANK    WN0189  1        PS Lock Status
     C                     MOVEL*BLANK    WN0190  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0191  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0192  1        PS Piece Count
     C                     MOVEL*BLANK    WN0193  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0194  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0195  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0196  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0197  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0198  3        PS Production W
     C                     Z-ADD*ZERO     WN0199  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0200  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0201  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0202  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0203  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0204  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0205  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0206  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0207  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0208  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0209  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0210  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0211  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0212  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0213  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0214  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0215  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0216  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0217  6        Department Code
     C                     Z-ADD*ZERO     WN0218  30       Item Structure
     C                     Z-ADD*ZERO     WN0219  30       Item Structure
     C                     Z-ADD*ZERO     WN0220  30       Item Structure
     C                     MOVEL*BLANK    WN0221  6        Primal Group Co
     C                     MOVEL*BLANK    WN0222  1        EDI Status 1
     C                     MOVEL*BLANK    WN0223  1        EDI Status 2
     C                     MOVEL*BLANK    WN0224  1        EDI Status 3
     C                     MOVEL*BLANK    WN0225  1        Record Status
     C                     Z-ADD*ZERO     WN0226  60       Job Time
     C                     MOVEL*BLANK    WN0227 10        User Id
     C                     MOVEL*BLANK    WN0228 10        Job Name
     C                     Z-ADD*ZERO     WN0229  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWN0056    I8AIC3           Company Number
     C                     MOVELP1V5ST    I8V5ST           Production Type
     C                     Z-ADDP1ELDT    I8ELDT           Production Date
     C                     Z-ADD$FC9NB    I8HGCD           Item Code
     C                     MOVELWN0055    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSX     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD$FAUWG    WN0159           PS Weight Stand
     C                     Z-ADD$FPIAC    WN0160           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0160    IFNE 0                          *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0159    DIV  WN0160    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0156           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0156    IFLT 0                          *IF
     C                     MULT -1        WN0156           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Standard is NE Zero
      *   |- c2    : PAR.PS Pieces Standard is NE Zeros
      *   '-
     C           WN0159    IFNE 0                          *IF
     C           WN0160    ORNE 0                          *OR
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
     C                     EXSR SYCRRC
     C                     END                             *FI
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           I8DXWG    ADD  $FAUWG    WN0159           PS Weight Stand
     C           I8B2NB    ADD  $FPIAC    WN0160           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0160    IFNE 0                          *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0159    DIV  WN0160    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0156           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0156    IFLT 0                          *IF
     C                     MULT -1        WN0156           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 RMC 5/14/09 dont do below case - they may be negative now
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
     C                     EXSR TACHRC
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWN0056    WEAIC3           Company Number
     C                     MOVELP1V5ST    WEV5ST           Production Type
     C                     Z-ADDP1ELDT    WEELDT           Production Date
     C                     Z-ADD$FC9NB    WEHGCD           Item Code
     C                     MOVELWN0055    WEAJCD           Warehouse Code
     C                     Z-ADDWN0152    WEGPDT           PS Available Sh
     C                     Z-ADDWN0153    WEWTSP           PS Weight Plann
     C                     Z-ADDWN0154    WEQTSP           PS Pieces Plann
     C                     Z-ADDWN0155    WEDJPC           PS % of Carcass
     C                     Z-ADDWN0156    WEF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0157    WEWTIN           PS Weight Inv O
     C                     Z-ADDWN0158    WED5NB           PS Pieces Inv O
     C                     Z-ADDWN0159    WEDXWG           PS Weight Stand
     C                     Z-ADDWN0160    WEB2NB           PS Pieces Stand
     C                     Z-ADDWN0161    WEWTCN           PS Weight Conve
     C                     Z-ADDWN0162    WEPSCV           PS Pieces Conve
     C                     Z-ADDWN0163    WESAWT           PS Weight Shipp
     C                     Z-ADDWN0164    WEB9NB           PS Pieces Shipp
     C                     Z-ADDWN0165    WED1WG           PS Weight Prod
     C                     Z-ADDWN0166    WECBNB           PS Pieces Prod
     C                     Z-ADDWN0167    WEEZWG           PS Weight Inv A
     C                     Z-ADDWN0168    WECCNB           PS Pieces Inv A
     C                     Z-ADDWN0169    WEE0WG           PS Weight Ship
     C                     Z-ADDWN0170    WED6NB           PS Pieces Ship
     C                     Z-ADDWN0171    WEOAWT           PS Weight Prod
     C                     Z-ADDWN0172    WECDNB           PS Pieces Prod
     C                     Z-ADDWN0173    WEUNW2           PS Weight Inv A
     C                     Z-ADDWN0174    WECENB           PS Pieces Inv A
     C                     Z-ADDWN0175    WEF9WG           PS Unit Weight
     C                     Z-ADDWN0176    WEBPNB           PS Pieces Whse
     C                     Z-ADDWN0177    WEGAWG           PS Weight Whse
     C                     Z-ADDWN0178    WEBQNB           PS Pieces Unuse
     C                     Z-ADDWN0179    WEGBWG           PS Weight Unuse
     C                     Z-ADDWN0180    WEBRNB           PS Pieces Unuse
     C                     Z-ADDWN0181    WEGCWG           PS Weight Unuse
     C                     Z-ADDWN0182    WEBSNB           PS Pieces Unuse
     C                     Z-ADDWN0183    WEGDWG           PS Weight Unuse
     C                     Z-ADDWN0184    WEBWNB           PS Pieces Unuse
     C                     Z-ADDWN0185    WEGEWG           PS Weight Unuse
     C                     Z-ADDWN0186    WEPS6U           PS Pieces Unuse
     C                     MOVELWN0187    WEWCST           PS Item Id
     C                     MOVELWN0188    WEWPST           Warehouse Type
     C                     MOVELWN0189    WEB5ST           PS Lock Status
     C                     MOVELWN0190    WETFST           PS Export/Domes
     C                     MOVELWN0191    WETEST           PS Print On Sch
     C                     MOVELWN0192    WETHST           PS Piece Count
     C                     MOVELWN0193    WEUDST           PS Unused Sts 1
     C                     MOVELWN0194    WEUFST           PS Unused Sts 2
     C                     MOVELWN0195    WEUGST           PS Unused Sts 3
     C                     MOVELWN0196    WEUHST           PS Unused Sts 4
     C                     MOVELWN0197    WEB6ST           PS Item Sched N
     C                     MOVELWN0198    WEB7ST           PS Production W
     C                     Z-ADDWN0199    WEDVWG           PS Weight Order
     C                     Z-ADDWN0200    WED7NB           PS Pieces Order
     C                     Z-ADDWN0201    WEFCAD           PS Weight FC Ad
     C                     Z-ADDWN0202    WED9NB           PS Pieces FC Ad
     C                     Z-ADDWN0203    WEDWWG           PS Weight FX Ad
     C                     Z-ADDWN0204    WEEANB           PS Pieces FX Ad
     C                     Z-ADDWN0205    WESHWT           PS Weight Sched
     C                     Z-ADDWN0206    WEEBNB           PS Pieces Sched
     C                     Z-ADDWN0207    WEAVWT           PS Weight Avail
     C                     Z-ADDWN0208    WEECNB           PS Pieces Avail
     C                     Z-ADDWN0209    WEWTON           PS Weight Produ
     C                     Z-ADDWN0210    WEEDNB           PS Pieces Produ
     C                     Z-ADDWN0211    WEFNWT           PS Weight Fab N
     C                     Z-ADDWN0212    WEEENB           PS Pieces Fab N
     C                     Z-ADDWN0213    WEQTAS           PS Weight Sched
     C                     Z-ADDWN0214    WEEFNB           PS Pieces Sched
     C                     Z-ADDWN0215    WEWAIO           PS Weight Sched
     C                     Z-ADDWN0216    WEEGNB           PS Pieces Sched
     C                     MOVELWN0217    WER3CD           Department Code
     C                     Z-ADDWN0218    WERGNB           Item Structure
     C                     Z-ADDWN0219    WERHNB           Item Structure
     C                     Z-ADDWN0220    WERINB           Item Structure
     C                     MOVELWN0221    WEXRCD           Primal Group Co
     C                     MOVELWN0222    WEUVST           EDI Status 1
     C                     MOVELWN0223    WEUWST           EDI Status 2
     C                     MOVELWN0224    WEUXST           EDI Status 3
     C                     MOVELWN0225    WEVSST           Record Status
     C                     Z-ADDWN0226    WEAATM           Job Time
     C                     MOVELWN0227    WEAYNA           User Id
     C                     MOVELWN0228    WEA0NA           Job Name
     C                     Z-ADDWN0229    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0230 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           Company Number
     C                     Z-ADDWEHGCD    WL0002           Item Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    WUAIWG           Unit Weight
     C                     Z-ADDWL0006    WERINB           Item Structure
     C                     Z-ADDWL0007    WERHNB           Item Structure
     C                     Z-ADDWL0008    WERGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    WUCHTM           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WER3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WETHST    P      Piece Count Ite
     C                     Z-ADDWL0021    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0022    WUBJNB           Bags Per Unit
     C                     MOVELWL0023    WETFST    P      Export/Domestic
     C                     MOVELWL0024    WETEST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WEXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWEAJCD    WL0029    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WEWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0034    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WEWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WEWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWEAJCD    WL0042    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0043    WEB7ST    P      Production Ware
     C                     Z-ADDWL0044    YL0012           Accounting Comp
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0045           Company Number
     C                     Z-ADDP1ELDT    WL0046           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0047           Fresh Chilling
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0048    WEGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0045           Company Number
     C                     Z-ADDP1ELDT    WL0046           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0047           Fresh Chilling
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0048    WEGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WN0154    IFGT 0                          *IF
     C           WN0153    DIV  WN0154    WEF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL'N'       WEB5ST           PS Lock Status
     C           KLCRSY    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSY    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSZ01           Company Number
      * Define keylist
     C           KPSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WHBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
      * Setup key
     C                     Z-ADDWL0045    WQSZ01           Company Number
     C                     Z-ADDWL0046    WHBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSZ     SETLL@AFREBE                    *
     C           KRSSZ     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0047                     *IF
     C                     Z-ADDWHBCDT    WL0048           PS Available Sh
     C                     GOTO SZEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           WHA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSZ     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0231  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0232  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0233  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0234  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0235  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0236  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0237  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0238  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0239  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0240  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0241  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0242  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0243  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0244  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0245  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0246  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0247  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0248  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0249  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0250  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0251 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0252  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0253 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0254  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0255 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0256  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0257 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0258  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0259 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0260  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0261 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0262  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0263  3        PS Item Id
     C                     MOVEL*BLANK    WN0264  2        Warehouse Type
     C                     MOVEL*BLANK    WN0265  1        PS Lock Status
     C                     MOVEL*BLANK    WN0266  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0267  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0268  1        PS Piece Count
     C                     MOVEL*BLANK    WN0269  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0270  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0271  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0272  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0273  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0274  3        PS Production W
     C                     Z-ADD*ZERO     WN0275  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0276  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0277  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0278  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0279  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0280  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0281  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0282  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0283  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0284  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0285  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0286  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0287  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0288  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0289  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0290  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0291  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0292  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0293  6        Department Code
     C                     Z-ADD*ZERO     WN0294  30       Item Structure
     C                     Z-ADD*ZERO     WN0295  30       Item Structure
     C                     Z-ADD*ZERO     WN0296  30       Item Structure
     C                     MOVEL*BLANK    WN0297  6        Primal Group Co
     C                     MOVEL*BLANK    WN0298  1        EDI Status 1
     C                     MOVEL*BLANK    WN0299  1        EDI Status 2
     C                     MOVEL*BLANK    WN0300  1        EDI Status 3
     C                     MOVEL*BLANK    WN0301  1        Record Status
     C                     Z-ADD*ZERO     WN0302  60       Job Time
     C                     MOVEL*BLANK    WN0303 10        User Id
     C                     MOVEL*BLANK    WN0304 10        Job Name
     C                     Z-ADD*ZERO     WN0305  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDI8AIC3    WEAIC3           Company Number
     C                     MOVELI8V5ST    WEV5ST    P      Production Type
     C                     Z-ADDI8ELDT    WEELDT           Production Date
     C                     Z-ADDI8HGCD    WEHGCD           Item Code
     C                     MOVELI8AJCD    WEAJCD    P      Warehouse Code
      *
     C           KLCHTA    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C           KLCHTA    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YCRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0156    WEF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0159    WEDXWG           PS Weight Stand
     C                     Z-ADDWN0160    WEB2NB           PS Pieces Stand
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Val WIPs Exist        RT - PS Std Prod Mix Dist WIP  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FKAIC3    WQTB01           Company Number
     C           *LIKE     DEFN FKR3CD    WQTB02           Department Code
     C           *LIKE     DEFN FKT9ST    WQTB03           SM Day of Week
     C           *LIKE     DEFN FKHGCD    WQTB04           Item Code
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Department Code
     C                     KFLD           WQTB03           SM Day of Week
     C                     KFLD           WQTB04           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WQTB01           Company Number
     C                     MOVELP1R3CD    WQTB02           Department Code
     C                     MOVELP3A9ST    WQTB03           SM Day of Week
     C                     Z-ADD$EHGCD    WQTB04           Item Code
      * Establish starting position
     C           KRSTB     SETLL@FKREB1                    *
     C           KRSTB     READE@FKREB1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4159' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0013           Record Found US
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0013           Record Found US
     C                     GOTO TBEXIT                     *QUIT
     C           KRSTB     READE@FKREB1                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Pces/Bag,Bag/Unit  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$HAIC3    BZAIC3           Company Number
     C                     Z-ADD$HHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSTC     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    YL0014           Description Lin
     C                     Z-ADDBZAIWG    YL0015           Unit Weight
     C                     MOVELBZPCCT    YL0016           Piece Count Ite
     C                     Z-ADDBZBDNB    YL0017           Pieces Per Bag
     C                     Z-ADDBZBJNB    YL0018           Bags Per Unit
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Wgt On-Hand       RT - PS Prod Item Inventory  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $HPAWG           WIP Weight on H
     C                     Z-ADD*ZERO     $HPUNY           WIP Pieces on H
      * Declare restrictor key work fields
     C           *LIKE     DEFN CWAIC3    WQTD01           Company Number
     C           *LIKE     DEFN CWHGCD    WQTD02           Item Code
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WQTD02           Item Code
      * Setup key
     C                     Z-ADD$HAIC3    WQTD01           Company Number
     C                     Z-ADD$HCNNB    WQTD02           Item Code
      * Establish starting position
     C           KRSTD     SETLL@CWCPQW                    *
     C           KRSTD     READE@CWCPQW                  90*
      * Data record not found
     C   90                MOVEL'USR3238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  CWACWG    $HPAWG           WIP Weight on H
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Unit Weight is Greater than zero
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFGT 0                          *IF
     C           YL0017    IFGT 0                          *IF
     C           YL0018    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pieces
      * LCL.Pieces Inv On-Hand =
      *    *COMPUTE ((x1 / x2) * (x3 * x4))
      * x1    : DB1.Quantity on Hand - Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.Unit Weight
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x4    : PAR.Bags Per Unit
     C           CWACWG    DIV  YL0015    W0WB01    H      *Synon (15,5) w
     C           YL0017    MULT YL0018    W0WJ02           *Synon (15,0) w
     C           W0WB01    MULT W0WJ02    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0019           Pieces Inv On-H
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0019           Pieces Inv On-H
     C                     END                             *FI
     C                     ADD  YL0019    $HPUNY           WIP Pieces on H
     C           KRSTD     READE@CWCPQW                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : BPS Conv Dept SMP     PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  92       PS Avg Piece Wg
     C                     MOVEL*BLANK    WN0002  3        PS Item Id
     C                     MOVEL*BLANK    WN0003  2        Warehouse Type
     C                     MOVEL*BLANK    WN0004 30        Description Lin
     C                     MOVEL*BLANK    WN0005  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0006 112       Unit Weight
     C                     Z-ADD*ZERO     WN0007  30       Item Structure
     C                     Z-ADD*ZERO     WN0008  30       Item Structure
     C                     Z-ADD*ZERO     WN0009  30       Item Structure
     C                     MOVEL*BLANK    WN0010  3        Item Type Code
     C                     MOVEL*BLANK    WN0011  3        Default Warehou
     C                     Z-ADD*ZERO     WN0012  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0013  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0014  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0015  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0016 112       Std Weight/Head
     C                     Z-ADD*ZERO     WN0017  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0018  1        Group for Packa
     C                     MOVEL*BLANK    WN0019  1        Seconds Item
     C                     MOVEL*BLANK    WN0020  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0021  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0022  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0023  1        Export/Domestic
     C                     MOVEL*BLANK    WN0024  1        Print On Schedu
     C                     MOVEL*BLANK    WN0025  1        Fresh Inv Alloc
     C                     MOVEL*BLANK    WN0026  1        Fresh Sched As
     C                     MOVEL*BLANK    WN0027  1        Frozen Inv Allo
     C                     MOVEL*BLANK    WN0028  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0029  70       SM Pieces Remai
     C                     Z-ADD*ZERO     WN0030 112       SM Weight Remai
     C                     Z-ADD*ZERO     WN0031  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0032 112       SM Weight Need
     C                     Z-ADD*ZERO     WN0033  70       RM Pieces Avail
     C                     Z-ADD*ZERO     WN0034 112       RM Weight Avail
     C                     MOVEL*BLANK    WN0035  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0036  1        Warehouse Locat
     C                     MOVEL*BLANK    WN0037  1        Warehouse Std C
     C                     Z-ADD*ZERO     WN0038  52       Warehouse Chill
      *
      * BPS Cnv/Fab/Crd SMP   PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:
      *================================================================
      * The process of producing the Standard Mix will be as follows:
      *   Converting Departments:
      *      The Raw Material produced from the Cutout Matrix is
      *      allocated to the Converting departments first.
      *   Fabricating Department:
      *      The remaining Raw Material after converting is allocated
      *      to the Fabricating department.
      *   Credit Department:
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : BPS BOM Consume RMB   PO
      *================================================================
      *
     C                     MOVEL*BLANK    WN0043  3        Default Warehou
     C                     MOVEL*BLANK    WN0044  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0045  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0046  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0047  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0048  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0049  70       RM Pieces Need
     C                     Z-ADD*ZERO     WN0050 112       RM Weight Need
     C                     Z-ADD*ZERO     WN0051  70       RM Pieces Alloc
     C                     Z-ADD*ZERO     WN0052 112       RM Weight Alloc
     C                     Z-ADD*ZERO     WN0053  70       Pieces Schedule
     C                     Z-ADD*ZERO     WN0054 112       Weight Schedule
     C                     MOVEL*BLANK    WN0055  3        Production Ware
     C                     Z-ADD*ZERO     WN0056  30       Accounting Comp
      *
      * BPS BOM Consume RM    PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : BPS Cnv/Fab/Crd SMP   PO
      *================================================================
     C                     GOTO UDEXIT                     *QUIT
      * CASE: PAR.Production Type is Not Schedule
     C           P1V5ST    IFEQ 'P'                        *IF
     C           P1V5ST    OREQ 'X'
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * Val WIPs Exist        RT - PS Std Prod Mix Dist WIP  * 
     C                     EXSR TBRVGN
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0013    IFEQ 'N'                        *IF
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * BPS Cnv/Fab/Crd SMP   PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * BPS Cnv/Fab/Crd SMP   PO: Initialise
      *================================================================
      * USER: Initialize program
      * E0178 RMC 3/18/2010 input rst on day of week, instead of POS on e
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * CASE: PAR.Department Code is Loin Boning
     C           P1R3CD    IFEQ 'LOINS'                    *IF
      * Rtv Export Pass Rate  RT - PS Production Capability  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * BPS BOM Consume RM    PO: Initialise
      *================================================================
      * USER: Initialize program
      * E3031  RMC 3/04/14 Consume RM Items only -- not FG
      * FP1054 RMC 5/14/09 chg 2 CASE stmts that checke for  GT 0 to NE 0
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0043           Default Warehou
     C                     MOVEL*BLANK    WN0044           Base/Conv/Loss
     C                     MOVEL*BLANK    WN0045           Variety/Rendere
     C                     MOVEL*BLANK    WN0046           Credit Item Sta
     C                     Z-ADD*ZERO     WN0047           Pieces Per Head
     C                     MOVEL*BLANK    WN0048           Piece Count Ite
     C                     Z-ADD*ZERO     WN0049           RM Pieces Need
     C                     Z-ADD*ZERO     WN0050           RM Weight Need
     C                     Z-ADD*ZERO     WN0051           RM Pieces Alloc
     C                     Z-ADD*ZERO     WN0052           RM Weight Alloc
     C                     Z-ADD*ZERO     WN0053           Pieces Schedule
     C                     Z-ADD*ZERO     WN0054           Weight Schedule
     C                     MOVEL*BLANK    WN0055           Production Ware
     C                     Z-ADD*ZERO     WN0056           Accounting Comp
     C                     Z-ADD$EEJNB    WN0049           RM Pieces Need
     C                     Z-ADD$EGTWG    WN0050           RM Weight Need
     C                     Z-ADD$EEJNB    WN0051           RM Pieces Alloc
     C                     Z-ADD$EGTWG    WN0052           RM Weight Alloc
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3A9ST           Day of Week
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    LMAIC3           Company Number
     C                     MOVEL*LOVAL    LMV5ST           Production Type
     C                     MOVEL*LOVAL    LMELDT           Production Date
     C                     MOVEL*LOVAL    LMR3CD           Department Code
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    I6AIC3           Company Number
     C                     MOVEL*LOVAL    I6R3CD           Department Code
     C                     MOVEL*LOVAL    I6T9ST           SM Day of Week
     C                     MOVEL*LOVAL    I6MXPR           Mix Priority
     C                     MOVEL*LOVAL    I6HGCD           Item Code
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAC9NB           Component Item
     C                     Z-ADD*ZERO     WABOPR           Sales Yield
     C                     Z-ADD*ZERO     WABPPR           Production Yiel
     C                     Z-ADD*ZERO     WAHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WACNSM           Consume Priorit
     C                     Z-ADD*ZERO     WABMY1           Consume Priorit
     C                     Z-ADD*ZERO     WABMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WAIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WAIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCAIC3           Company Number
     C                     MOVEL*LOVAL    WCHGCD           Item Code
     C                     MOVEL*LOVAL    WCV2ST           BOM Type
     C                     MOVEL*LOVAL    WCCNSM           Consume Priorit
     C                     MOVEL*LOVAL    WCC9NB           Component Item
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define work field PS Item Id
     C                     MOVEL*BLANK    WUWCST  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WEWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WEQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WEDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WEF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WEWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WED5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WEDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WEB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WEWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WEPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WESAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WEB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WED1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WECBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WEEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WECCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WEE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WED6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WEOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WECDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WEUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WECENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WEF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WEBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WEGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WEBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WEGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WEBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WEGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WEBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WEGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WEBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WEGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WEPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WEDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WED7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WEFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WED9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WEDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WEEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WESHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WEEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WEAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WEECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WEWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WEEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WEFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WEEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WEQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WEEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WEWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WEEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFJGDT           OD Production D
     C                     Z-ADD*ZERO     WFOONY           ODS Sequence Nu
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WFFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WFNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     WFJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WHCQNB           Julian Date
     C                     Z-ADD*ZERO     WHESNB           Accounting Year
     C                     Z-ADD*ZERO     WHETNB           Accounting Peri
     C                     Z-ADD*ZERO     WHBZNB           OM Week
     C                     Z-ADD*ZERO     WHEINB           Week Number
     C                     Z-ADD*ZERO     WHAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WHOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WHNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WHNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WHOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WHOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FKAIC3           Company Number
     C                     MOVEL*LOVAL    FKR3CD           Department Code
     C                     MOVEL*LOVAL    FKT9ST           SM Day of Week
     C                     MOVEL*LOVAL    FKHGCD           Item Code
     C                     MOVEL*LOVAL    FKCNNB           WIP Item Code
      * Define work field Effective Production Date
     C                     Z-ADD*ZERO     WUGJDT  70
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  3
     C                     Z-ADD*ZERO     WL0011  52
     C                     MOVEL*BLANK    WL0012  2
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  6
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  6
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  2
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     Z-ADD*ZERO     WL0034  52
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037  1
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040 112
     C                     Z-ADD*ZERO     WL0041  52
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0042  3
     C                     MOVEL*BLANK    WL0043  3
     C                     Z-ADD*ZERO     WL0044  30
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0045  30
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  52
     C                     Z-ADD*ZERO     WL0048  70
      * Define local work field Export Pass Rate
     C                     Z-ADD*ZERO     YL0001  52
      * Define local work field Default Warehouse
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Component Item Code
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Text 1 Length USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field PS Pieces Planned Prod
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field PS Pieces Planned Prod
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0008  30
      * Define local work field ODS Sequence Number
     C                     Z-ADD*ZERO     YL0009  30
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0010 112
      * Define local work field OD Qty/Cnsmd Pieces Sched
     C                     Z-ADD*ZERO     YL0011 112
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0014 30
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0015 112
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Pieces Inv On-Hand
     C                     Z-ADD*ZERO     YL0019  70
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * E0178  RMC 3/18/10 pass day of week to Prtobj instead of eff date
      * FP1054 RMC 5/14/09 chg 2 case stmts in lower Prtobj from GT 0 to
      *  to accomodate a negative production yield
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * RTV Day of Week No.   RT - Calendar  * 
     C                     EXSR SCRVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
