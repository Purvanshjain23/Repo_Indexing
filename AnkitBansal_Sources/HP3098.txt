      *         *****************  RPG PROGRAM HEADING  ************************
      *
      * SYSTEM:      HOG PRODUCTION
      * PROGRAM:     HP3098
      * TITLE:       REPLACE FROM GROUP WITH TO GROUP
      * PROGRAMMER:  LEANNE FEDOR
      * CREATED:     08/29/96
      *
      *  FUNCTION:   THIS BATCH PROGRAM IS CALLED FROM HP493.
      *              IT REPLACES THE SYSTEM-GENERATED HOG GROUP
      *              NUMBER IN EVERY FILE FOR THE 'FROM' GROUP
      *              WITH THE SYSTEM-GENERATED HOG GROUP NUMBER OF
      *              THE 'TO' GROUP.
      *
      *             ONLY I.S. PERSONNEL ARE ALLOWED TO ACCESS THIS
      *             PROGRAM.
      *
      *             THE USER'S SUBMISSION CRITERIA ARE PASSED IN THE
      *             LDA.
      *
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      *
      * 04/13/00  LeAnne Fedor
      *           Recompile only. The 'closed group pounds' field in the
      *           Closed Hog Group file was increased to 11,2.
      *
      * 11/15/00  LeAnne Fedor
      *           Recompile only. 'Phase' and 'group status' were added to
      *           period costs file.
      *
      * 12/28/00  LeAnne Fedor
      *           Recompile only. New fields added to Period Costs file.
      *
      * 01/30/01  LeAnne Fedor
      *           Recompile only.  Production type was removed from feed files.
      *
      * 07/18/01  LeAnne Fedor
      *           Recompile only.
      *           Expense ticket amount expanded from 7,2 to 9,2.
      *
      * 08/03/01  LeAnne Fedor
      *           Recompile only.
      *           New field 'group type' added to Period Costs file.
      *
      * 04/28/03  LeAnne Fedor
      *           Added 6 more files...the Costed Movement files.
      *
      * 12/13/04  LeAnne Fedor
      *           Several of the Costed Movement files above have been renamed as the 'workfiles'
      *           that they truly are. Since they now function as workfiles, they are cleared
      *           at the beginning of the EOP process. So, we removed them from this program.
      *
      * 03/26/20  Danny Nguyen - P405 - Farm Number Increase
      *           Recompile only. Increased Bin Code (@@BNCD) in HSPREF file from 5A to 6A.
      *
      * 05/10/22 Eric L SDN736 Recompiled ticket nbr increase (TKNO & RTNO 7.0 TO 9.0)
      /eject
      ****************************************************************
      * FILE SPECIFICATIONS
      ****************************************************************
     H
      *
     FHSP033    UF   E           K DISK
      *    CLOSED HOG GROUP
      *
      *
     FHSL038E   UF   E           K DISK
      *    FEED TICKET DETAIL
      *
      *
     FHSP039    UF   E           K DISK
      *    CLOSED GROUP EQUIPMENT
      *
      *
     FHSL048B   UF   E           K DISK
      *    EXPENSE TICKETS
      *
      *
     FHSP055    UF   E           K DISK
      *    Period costs for hogs moved out
      *
      *
     FHSL058D   UF   E           K DISK
     F                                     RENAME(MEREC:MERECD)
      *    MOVEMENT EVENT
      *
      *
     FHSL058E   UF   E           K DISK
      *    MOVEMENT EVENT
      *
      *
     FHSL064I   UF   E           K DISK
      *    CHECK DETAIL
      *
      *
     FHSL068D   UF   E           K DISK
      *    DAILY KILLED/DEAD
      *
      *
     FHSL069A   UF   E           K DISK
      *    INVENTORY ADJUSTMENTS
      *
      *
     FHSL075C   UF   E           K DISK
      *    TRANSFER MOVEMENT DETAIL
      *
      *
     FHSL075E   UF   E           K DISK
     F                                     RENAME(MDREC:MDRECE)
      *    TRANSFER MOVEMENT DETAIL
      *
      *
     FHSL085B   UF   E           K DISK
      *    SALES DETAIL
      *
      *
     Fhsp102    UF   E           K DISK
      *    Reported weekly activity
      *
      *
     Fhsl118b   UF   E           K DISK
      *    Costed movements: costed movements
      *
      *
     Fhsl118c   UF   E           K DISK    rename(cmrec:cmrecc)
      *    Costed movements: costed movements
      *
      *
     Fhsl120b   UF   E           K DISK
      *    Costed movements: expense codes
      *
      *
     Fhsl120c   UF   E           K DISK    rename(cxrec:cxrecc)
      *    Costed movements: expense codes
      *
      *
      /EJECT
      ****************************************************************
      * INPUT SPECS
      ****************************************************************
      *
      *
      *---------------------------------------------------------------
      *  LDA
      *---------------------------------------------------------------
      *
     D                UDS
     D  LDFHSN                 1      7  0
     D  LDFHCD                 8     14
     D  LDTHSN                15     21  0
     D  LDTHCD                22     28
      *
      *---------------------------------------------------------------
      * STANDARD PROGRAM STATUS DATA STRUCTURE
      *---------------------------------------------------------------
      *    EXTERNALLY DEFINED AS UTPGFR (RECORD FORMAT: PGMDSR)
     D PGMDS         ESDS                  EXTNAME(UTPGFR)
      *
      *---------------------------------------------------------------
      *  NAMED CONSTANTS
      *---------------------------------------------------------------
      *
     D YES             C                   CONST('Y')
     D NO              C                   CONST('N')
      *
     D                 DS
     D  DUMMYD                 1      1
      *
      *  THE PRECEDING DUMMY DATA STRUCTURE IS ONLY TO KEEP THE I-SPEC
      *  INFO FROM RUNNING OVER INTO THE 'CALC SPECS' ON THE COMPILE
      *  LISTING.  IT SERVES NO OTHER PURPOSE AND CAN BE DELETED
      *  AT ANY TIME!!!
      /EJECT
      ****************************************************************
      * MAIN LINE
      ****************************************************************
      *
      *
      * CLOSED HOG GROUP FILE
      *
     C     LDFHSN        SETLL     HSP033
      *
     C     *IN92         DOUEQ     *ON                                          DO CLOSED
     C     LDFHSN        READE     HSP033                                 92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        CGHGSN
     C                   UPDATE    CGREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO CLOSED
      *
      *
      * FEED TICKET DETAIL FILE
      *
     C     LDFHSN        SETLL     HSL038E
      *
     C     *IN92         DOUEQ     *ON                                          DO FEED
     C     LDFHSN        READE     HSL038E                                92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        FDHGSN
     C                   UPDATE    FDREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO FEED
      *
      *
      * CLOSED HOG GROUP EQUIPMENT FILE
      *
     C     LDFHSN        SETLL     HSP039
      *
     C     *IN92         DOUEQ     *ON                                          DO EQUIP
     C     LDFHSN        READE     HSP039                                 92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        CEHGSN
     C                   UPDATE    CEREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO EQUIP
      *
      *
      * EXPENSE TICKETS
      *
     C     LDFHSN        SETLL     HSL048B
      *
     C     *IN92         DOUEQ     *ON                                          DO EXPENSE
     C     LDFHSN        READE     HSL048B                                92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        XTHGSN
     C                   UPDATE    XTREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO EXPENSE
      *
      *
      * PERIOD COSTS
      *
     C     LDFHSN        SETLL     HSP055
      *
     C     *IN92         DOUEQ     *ON                                          DO PERIOD
     C     LDFHSN        READE     HSP055                                 92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        PCHGSN
     C                   UPDATE    PCREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO PERIOD
      *
      *
      * MOVEMENT EVENT AS ORIGIN GROUP
      *
     C     LDFHSN        SETLL     HSL058D
      *
     C     *IN92         DOUEQ     *ON                                          DO EVENT 1
     C     LDFHSN        READE     HSL058D                                92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        MEHGSN
     C                   UPDATE    MERECD
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO EVENT 1
      *
      *
      *
      * MOVEMENT EVENT AS OPPOSING GROUP
      *
     C     LDFHSN        SETLL     HSL058E
      *
     C     *IN92         DOUEQ     *ON                                          DO EVENT 2
     C     LDFHSN        READE     HSL058E                                92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        MEHSN
     C                   UPDATE    MEREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO EVENT 2
      *
      *
      * CHECK DETAIL
      *
     C     LDFHSN        SETLL     HSL064I
      *
     C     *IN92         DOUEQ     *ON                                          DO CHECK
     C     LDFHSN        READE     HSL064I                                92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        CDHGSN
     C                   UPDATE    CDREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO CHECK
      *
      *
      *
      *
      * DAILY KILLED/DEAD
      *
     C     LDFHSN        SETLL     HSL068D
      *
     C     *IN92         DOUEQ     *ON                                          DO DEAD
     C     LDFHSN        READE     HSL068D                                92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        KDHGSN
     C                   UPDATE    KDREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO DEAD
      *
      *
      * INVENTORY ADJUSTMENTS
      *
     C     LDFHSN        SETLL     HSL069A
      *
     C     *IN92         DOUEQ     *ON                                          DO ADJUST
     C     LDFHSN        READE     HSL069A                                92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        IAHGSN
     C                   UPDATE    IAREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO ADJUST
      *
      *
      *
      * TRANSFER MOVEMENT DETAIL AS ORIGIN GROUP
      *
     C     LDFHSN        SETLL     HSL075C
      *
     C     *IN92         DOUEQ     *ON                                          DO MOVE 1
     C     LDFHSN        READE     HSL075C                                92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        MDORSN
     C                   UPDATE    MDREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO MOVE 1
      *
      *
      *
      * TRANSFER MOVEMENT DETAIL AS DESTINATION GROUP
      *
     C     LDFHSN        SETLL     HSL075E
      *
     C     *IN92         DOUEQ     *ON                                          DO MOVE 2
     C     LDFHSN        READE     HSL075E                                92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        MDDNSN
     C                   UPDATE    MDRECE
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO MOVE 2
      *
      *
      *
      * SALES DETAIL
      *
     C     LDFHSN        SETLL     HSL085B
      *
     C     *IN92         DOUEQ     *ON                                          DO SALES
     C     LDFHSN        READE     HSL085B                                92
     C     *IN92         IFEQ      *OFF                                         IF MORE REC
     C                   Z-ADD     LDTHSN        SGHGSN
     C                   UPDATE    SGREC
     C                   ENDIF                                                  IF MORE REC
     C                   ENDDO                                                  DO SALES
      *
      *
      * Reported weekly activity
      *
     C     LDFHSN        SETLL     HSP102
      *
     C     *IN92         DOUEQ     *ON                                          Do activity
     C     LDFHSN        READE     HSP102                                 92
     C     *IN92         IFEQ      *OFF                                         If more recs
     C                   Z-ADD     LDTHSN        RWHGSN
     C                   UPDATE    RWREC
     C                   ENDIF                                                  If more recs
     C                   ENDDO                                                  Do activity
      *
      *
      *
      * Costed movements: Costed Movements (origin group)
      *
     C     LDFHSN        SETLL     HSL118B
      *
     C     *IN92         DOUEQ     *ON                                          Do origin cost
     C     LDFHSN        READE     HSL118B                                92
     C     *IN92         IFEQ      *OFF                                         If more recs
     C                   Z-ADD     LDTHSN        CMORHGSN
     C                   UPDATE    CMREC
     C                   ENDIF                                                  If more recs
     C                   ENDDO                                                  Do origin cost
      *
      *
      * Costed movements: Costed Movements (destination group)
      *
     C     LDFHSN        SETLL     HSL118C
      *
     C     *IN92         DOUEQ     *ON                                          Do dest cost
     C     LDFHSN        READE     HSL118C                                92
     C     *IN92         IFEQ      *OFF                                         If more recs
     C                   Z-ADD     LDTHSN        CMDNHGSN
     C                   UPDATE    CMRECC
     C                   ENDIF                                                  If more recs
     C                   ENDDO                                                  Do dest cost
      *
      *
      * Costed movements: Expense codes    (origin group)
      *
     C     LDFHSN        SETLL     HSL120B
      *
     C     *IN92         DOUEQ     *ON                                          Do origin exp
     C     LDFHSN        READE     HSL120B                                92
     C     *IN92         IFEQ      *OFF                                         If more recs
     C                   Z-ADD     LDTHSN        CXORHGSN
     C                   UPDATE    CXREC
     C                   ENDIF                                                  If more recs
     C                   ENDDO                                                  Do origin exp
      *
      *
      * Costed movements: Expense codes (destination group)
      *
     C     LDFHSN        SETLL     HSL120C
      *
     C     *IN92         DOUEQ     *ON                                          Do dest exp
     C     LDFHSN        READE     HSL120C                                92
     C     *IN92         IFEQ      *OFF                                         If more recs
     C                   Z-ADD     LDTHSN        CXDNHGSN
     C                   UPDATE    CXRECC
     C                   ENDIF                                                  If more recs
     C                   ENDDO                                                  Do dest exp
      *
      *
      *
      *--------------------------------------------------------------
      * EOF PROCESSING
      *--------------------------------------------------------------
      *
     C                   SETON                                        LR
      *
      /EJECT
