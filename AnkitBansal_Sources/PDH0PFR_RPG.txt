     H/TITLE Prt Cutout Dist       PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : COOL:2E  Version:  1000
     H* Function type : Print file
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 09/06/02  Time  : 09:10:31
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDI0REL1IF  E           K        DISK
      * RTV : PS Cutout Matrix          Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDIZREL1IF  E           K        DISK
      * RTV : PS Cutout Dist Lean %     Retrieval index
      *
     FPDIZREL2IF  E           K        DISK
      * RSQ : PS Cutout Dist Lean %     Co/Mtx/MoDy/Ln%
      *
     FPDI1REL1IF  E           K        DISK
      * RTV : PS Cutout Weight Range    Retrieval index
      *
     FPDH0PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Cutout Dist       PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     I@IZREXQ
      * PS Cutout Dist Lean %     Co/Mtx/MoDy/Ln%
      * Renamed input format fields
     I              IZAIC3                          WAAIC3
     I              IZRXCD                          WARXCD
     I              IZGHDT                          WAGHDT
     I              IZUPNB                          WAUPNB
     I              IZUQNB                          WAUQNB
     I              IZULNB                          WAULNB
     I              IZUNNB                          WAUNNB
     I              IZUONB                          WAUONB
     I              IZDIPC                          WADIPC
     I              IZZ0NB                          WAZ0NB
     I              IZAVLE                          WAAVLE
     I              IZQPNX                          WAQPNX
     I              IZUVST                          WAUVST
     I              IZUWST                          WAUWST
     I              IZUXST                          WAUXST
     I              IZVSST                          WAVSST
     I              IZAATM                          WAAATM
     I              IZAYNA                          WAAYNA
     I              IZA0NA                          WAA0NA
     I              IZAXDT                          WAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PS Cutout Matrix
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Cutout Matrix Code
     I                                        3   8 P1RXCD
      * I : RST Effective Month/Day
     I                                    P   9  110P1GHDT
     IP2PARM      DS
      * I :  Application Code
     I                                        1   6 P2DNCD
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1RXCD    PARM           WP0002  6        Cutout Matrix C
     C           P1GHDT    PARM           WP0003  40       Effective Month
     C           P2DNCD    PARM           WP0004  6        Application Cod
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Cutout Dist       PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$KENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Cutout Dist       PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN I0AIC3    WQKA01           Company Number
     C           *LIKE     DEFN I0RXCD    WQKA02           Cutout Matrix C
     C           *LIKE     DEFN I0GHDT    WQKA03           Effective Month
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
     C                     KFLD           WQKA02           Cutout Matrix C
     C                     KFLD           WQKA03           Effective Month
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
     C                     MOVELP1RXCD    WQKA02           Cutout Matrix C
     C                     Z-ADDP1GHDT    WQKA03           Effective Month
      * Establish starting position
     C           KRSA      SETLL@I0RES3                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Cutout Matrix C
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDI0AIC3    $BAIC3           Company Number
     C                     MOVEL*BLANK    $BADTX           Name
      * USER: Process before print of Accounting Company Number format
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDI0AIC3    $CAIC3           Company Number
     C                     MOVELI0RXCD    $CRXCD           Cutout Matrix C
     C                     MOVELI0MXNA    $CMXNA           Cutout Matrix D
     C                     Z-ADDI0GHDT    $CGHDT           Effective Month
     C                     MOVELI0VTST    $CVTST           Cutout Matrix T
     C                     MOVEL*BLANK    $CGUTX           Condition Name
     C                     MOVELI0VSST    $CVSST           Record Status
     C                     MOVEL*BLANK    $CCDNA           USR Condition D
      * USER: Process before print of Cutout Matrix Code format
      * CUR.Condition Name USR = Condition name of CUR.Cutout Matrix Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255678   Y2LSNO  70       List number
     C                     PARM $CVTST    W0INVL 25        Cutout Matrix T
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CGUTX    PARM           W0CNNM 25        Condition Name
      *
      * CUR.USR Condition Description = Condition name of CUR.Record Stat
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM $CVSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CCDNA    PARM           W0CNNM 25        USR Condition D
      *
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDI0AIC3    $DAIC3           Company Number
     C                     MOVELI0RXCD    $DRXCD           Cutout Matrix C
     C                     Z-ADDI0GHDT    $DGHDT           Effective Month
     C                     MOVELI0MXNA    $DMXNA           Cutout Matrix D
     C                     MOVELI0VTST    $DVTST           Cutout Matrix T
     C                     MOVELI0VUST    $DVUST           Cutout Matrix D
     C                     MOVELI0UVST    $DUVST           EDI Status 1
     C                     MOVELI0UWST    $DUWST           EDI Status 2
     C                     MOVELI0UXST    $DUXST           EDI Status 3
     C                     MOVELI0VSST    $DVSST           Record Status
     C                     Z-ADDI0AATM    $DAATM           Job Time
     C                     MOVELI0AYNA    $DAYNA           User Id
     C                     MOVELI0A0NA    $DA0NA           Job Name
     C                     Z-ADDI0AXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Cutout Matrix     PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN I0AIC3    WZA001           Company Number
     C                     Z-ADDI0AIC3    WZA001
     C           *LIKE     DEFN I0RXCD    WZA002           Cutout Matrix C
     C                     MOVELI0RXCD    WZA002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@I0RES3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Cutout Matrix C
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Cutout Matrix C
     C                     ELSE
      * Next record - Detect level breaks
     C           I0AIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           I0RXCD    IFNE WZA002                     Cutout Matrix C
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Cutout Dist       PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN IZAIC3    WQKB01           Company Number
     C           *LIKE     DEFN IZRXCD    WQKB02           Cutout Matrix C
     C           *LIKE     DEFN IZGHDT    WQKB03           Effective Month
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Cutout Matrix C
     C                     KFLD           WQKB03           Effective Month
      * Setup key
     C                     Z-ADD$DAIC3    WQKB01           Company Number
     C                     MOVEL$DRXCD    WQKB02           Cutout Matrix C
     C                     Z-ADD$DGHDT    WQKB03           Effective Month
      * Establish starting position
     C           KRSB      SETLL@IZRETC                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Cutout Matrix C
     C                     MOVEL'Y'       W0BL02  1        Effective Month
     C                     MOVEL'Y'       W0BL03  1        Min Carcass Wei
     C                     MOVEL'Y'       W0BL04  1        Max Carcass Wei
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDIZAIC3    $FAIC3           Company Number
     C                     MOVELIZRXCD    $FRXCD           Cutout Matrix C
     C                     Z-ADDIZGHDT    $FGHDT           Effective Month
     C                     Z-ADD*ZERO     $FLNP1           Lean Percent 1
     C                     Z-ADD*ZERO     $FLNP2           Lean Percent 2
     C                     Z-ADD*ZERO     $FLNP3           Lean Percent 3
     C                     Z-ADD*ZERO     $FLNP4           Lean Percent 4
     C                     Z-ADD*ZERO     $FLNP5           Lean Percent 5
     C                     Z-ADD*ZERO     $FLNP6           Lean Percent 6
     C                     Z-ADD*ZERO     $FLNP7           Lean Percent 7
     C                     Z-ADD*ZERO     $FLNP8           Lean Percent 8
     C                     Z-ADD*ZERO     $FLNP9           Lean Percent 9
     C                     Z-ADD*ZERO     $FLN10           Lean Percent 10
     C                     Z-ADD*ZERO     $FLN11           Lean Percent 11
     C                     Z-ADD*ZERO     $FLN12           Lean Percent 12
     C                     Z-ADD*ZERO     $FJDNB           Lean Percent 13
     C                     Z-ADD*ZERO     $FLP4U           Lean Percent 14
     C                     Z-ADD*ZERO     $FLP5U           Lean Percent 15
     C                     Z-ADD*ZERO     $FLP6U           Lean Percent 16
     C                     Z-ADD*ZERO     $FLP7U           Lean Percent 17
     C                     Z-ADD*ZERO     $FLP8U           Lean Percent 18
     C                     Z-ADD*ZERO     $FLP9U           Lean Percent 19
     C                     Z-ADD*ZERO     $FLP1U           Lean Percent 20
     C                     Z-ADD*ZERO     $FLP2U           Lean Percent 21
      * Load related totals format
     C                     Z-ADD*ZERO     $JAITU           Average Loin I
     C                     Z-ADD*ZERO     $JAI0T           Average Loin I
     C                     Z-ADD*ZERO     $JAI9T           Average Loin I
     C                     Z-ADD*ZERO     $JAI8T           Average Loin I
     C                     Z-ADD*ZERO     $JAI7T           Average Loin I
     C                     Z-ADD*ZERO     $JAI6T           Average Loin I
     C                     Z-ADD*ZERO     $JAI5T           Average Loin I
     C                     Z-ADD*ZERO     $JAI4T           Average Loin I
     C                     Z-ADD*ZERO     $JAI3T           Average Loin I
     C                     Z-ADD*ZERO     $JAI2T           Average Loin I
     C                     Z-ADD*ZERO     $JAI1T           Average Loin I
     C                     Z-ADD*ZERO     $JAB0U           Average Backft
     C                     Z-ADD*ZERO     $JNJNB           Average Backft
     C                     Z-ADD*ZERO     $JNINB           Average Backft
     C                     Z-ADD*ZERO     $JAB7U           Average Backft
     C                     Z-ADD*ZERO     $JAB6U           Average Backft
     C                     Z-ADD*ZERO     $JAB5U           Average Backft
     C                     Z-ADD*ZERO     $JAB4U           Average Backft
     C                     Z-ADD*ZERO     $JMUNB           Average Backft
     C                     Z-ADD*ZERO     $JAB2U           Average Backft
     C                     Z-ADD*ZERO     $JMKNB           Average Backft
     C                     Z-ADD*ZERO     $JABTU           Average Backfat
     C                     Z-ADD*ZERO     $JDUPC           Average Lean %
     C                     Z-ADD*ZERO     $JDTPC           Average Lean %
     C                     Z-ADD*ZERO     $JDSPC           Average Lean %
     C                     Z-ADD*ZERO     $JDRPC           Average Lean %
     C                     Z-ADD*ZERO     $JDQPC           Average Lean %
     C                     Z-ADD*ZERO     $JDPPC           Average Lean %
     C                     Z-ADD*ZERO     $JDOPC           Average Lean %
     C                     Z-ADD*ZERO     $JDNPC           Average Lean %
     C                     Z-ADD*ZERO     $JDMPC           Average Lean %
     C                     Z-ADD*ZERO     $JDLPC           Average Lean %
     C                     Z-ADD*ZERO     $JDKPC           Average Lean %
     C                     Z-ADDIZAIC3    $JAIC3           Company Number
     C                     MOVELIZRXCD    $JRXCD           Cutout Matrix C
     C                     Z-ADDIZGHDT    $JGHDT           Effective Month
     C                     Z-ADDIZDIPC    $JDIPC           Average Lean Pe
     C                     Z-ADDIZZ0NB    $JZ0NB           Average Backfat
     C                     Z-ADDIZAVLE    $JAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     $JPP1S           Population % 1
     C                     Z-ADD*ZERO     $JPP2S           Population % 2
     C                     Z-ADD*ZERO     $JPP3S           Population % 3
     C                     Z-ADD*ZERO     $JPP4S           Population % 4
     C                     Z-ADD*ZERO     $JPP5S           Population % 5
     C                     Z-ADD*ZERO     $JPP6S           Population % 6
     C                     Z-ADD*ZERO     $JPP7S           Population % 7
     C                     Z-ADD*ZERO     $JPP8S           Population % 8
     C                     Z-ADD*ZERO     $JKUNB           Population % 9
     C                     Z-ADD*ZERO     $JPP0S           Population % 10
     C                     Z-ADD*ZERO     $JPS11           Population % 11
     C                     Z-ADD*ZERO     $JPS12           Population % 12
     C                     Z-ADD*ZERO     $JAL1U           Average Lean %
     C                     Z-ADD*ZERO     $JAL2U           Average Lean %
     C                     Z-ADD*ZERO     $JAL3U           Average Lean %
     C                     Z-ADD*ZERO     $JAL4U           Average Lean %
     C                     Z-ADD*ZERO     $JAL5U           Average Lean %
     C                     Z-ADD*ZERO     $JAL6U           Average Lean %
     C                     Z-ADD*ZERO     $JAL7U           Average Lean %
     C                     Z-ADD*ZERO     $JAL8U           Average Lean %
     C                     Z-ADD*ZERO     $JAL9U           Average Lean %
     C                     Z-ADD*ZERO     $JAL0U           Average Lean %
     C                     Z-ADD*ZERO     $JAL11           Average Lean %
     C                     Z-ADD*ZERO     $JAL12           Average Lean %
     C                     Z-ADD*ZERO     $JAL3Y           Average Lean %
     C                     Z-ADD*ZERO     $JAL4Y           Average Lean %
     C                     Z-ADD*ZERO     $JAL5Y           Average Lean %
     C                     Z-ADD*ZERO     $JAL6Y           Average Lean %
     C                     Z-ADD*ZERO     $JAL7Y           Average Lean %
     C                     Z-ADD*ZERO     $JAL8Y           Average Lean %
     C                     Z-ADD*ZERO     $JAL9Y           Average Lean %
     C                     Z-ADD*ZERO     $JAL1Y           Average Lean %
     C                     Z-ADD*ZERO     $JAL2Y           Average Lean %
     C                     Z-ADD*ZERO     $JAB1U           Average Backfat
     C                     Z-ADD*ZERO     $JAB2X           Average Backfat
     C                     Z-ADD*ZERO     $JN7NB           Average Backfat
     C                     Z-ADD*ZERO     $JN8NB           Average Backfat
     C                     Z-ADD*ZERO     $JAB5X           Average Backfat
     C                     Z-ADD*ZERO     $JAB6X           Average Backfat
     C                     Z-ADD*ZERO     $JAB7X           Average Backfat
     C                     Z-ADD*ZERO     $JAB8X           Average Backfat
     C                     Z-ADD*ZERO     $JOUNB           Average Backfat
     C                     Z-ADD*ZERO     $JOVNB           Average Backfat
     C                     Z-ADD*ZERO     $JAB11           Average Backfat
     C                     Z-ADD*ZERO     $JAB12           Average Backfat
     C                     Z-ADD*ZERO     $JAB3Y           Average Backfat
     C                     Z-ADD*ZERO     $JAB4Y           Average Backfat
     C                     Z-ADD*ZERO     $JAB5Y           Average Backfat
     C                     Z-ADD*ZERO     $JAB6Y           Average Backfat
     C                     Z-ADD*ZERO     $JAB7Y           Average Backfat
     C                     Z-ADD*ZERO     $JAB8Y           Average Backfat
     C                     Z-ADD*ZERO     $JAB9Y           Average Backfat
     C                     Z-ADD*ZERO     $JAB1Y           Average Backfat
     C                     Z-ADD*ZERO     $JAB2Y           Average Backfat
     C                     Z-ADD*ZERO     $JAI1U           Average Loin I
     C                     Z-ADD*ZERO     $JAI2U           Average Loin I
     C                     Z-ADD*ZERO     $JAI3U           Average Loin I
     C                     Z-ADD*ZERO     $JAI4U           Average Loin I
     C                     Z-ADD*ZERO     $JAI5U           Average Loin I
     C                     Z-ADD*ZERO     $JAI6U           Average Loin I
     C                     Z-ADD*ZERO     $JAI7U           Average Loin I
     C                     Z-ADD*ZERO     $JAI8U           Average Loin I
     C                     Z-ADD*ZERO     $JAI9U           Average Loin I
     C                     Z-ADD*ZERO     $JRLNB           Average Loin I
     C                     Z-ADD*ZERO     $JAI11           Average Loin I
     C                     Z-ADD*ZERO     $JAI12           Average Loin I
     C                     Z-ADD*ZERO     $JAL3X           Average Loin I
     C                     Z-ADD*ZERO     $JAL4X           Average Loin I
     C                     Z-ADD*ZERO     $JAL5X           Average Loin I
     C                     Z-ADD*ZERO     $JAL6X           Average Loin I
     C                     Z-ADD*ZERO     $JAL7X           Average Loin I
     C                     Z-ADD*ZERO     $JAL8X           Average Loin I
     C                     Z-ADD*ZERO     $JAL9X           Average Loin I
     C                     Z-ADD*ZERO     $JAL1X           Average Loin I
     C                     Z-ADD*ZERO     $JAL2X           Average Loin I
      * USER: Process before print of Effective Month/Day format
      * Rtv Lean % (Prt Dist) RT - PS Cutout Dist Lean %  * 
     C                     EXSR SDRVGN
      * CUR = PAR By name
     C                     Z-ADD$DAIC3    $FAIC3           Company Number
     C                     MOVEL$DRXCD    $FRXCD           Cutout Matrix C
     C                     Z-ADD$DGHDT    $FGHDT           Effective Month
     C                     Z-ADDWN0001    $FLNP1           Lean Percent 1
     C                     Z-ADDWN0002    $FLNP2           Lean Percent 2
     C                     Z-ADDWN0003    $FLNP3           Lean Percent 3
     C                     Z-ADDWN0004    $FLNP4           Lean Percent 4
     C                     Z-ADDWN0005    $FLNP5           Lean Percent 5
     C                     Z-ADDWN0006    $FLNP6           Lean Percent 6
     C                     Z-ADDWN0007    $FLNP7           Lean Percent 7
     C                     Z-ADDWN0008    $FLNP8           Lean Percent 8
     C                     Z-ADDWN0009    $FLNP9           Lean Percent 9
     C                     Z-ADDWN0010    $FLN10           Lean Percent 10
     C                     Z-ADDWN0011    $FLN11           Lean Percent 11
     C                     Z-ADDWN0012    $FLN12           Lean Percent 12
     C                     Z-ADDWN0013    $FJDNB           Lean Percent 13
     C                     Z-ADDWN0014    $FLP4U           Lean Percent 14
     C                     Z-ADDWN0015    $FLP5U           Lean Percent 15
     C                     Z-ADDWN0016    $FLP6U           Lean Percent 16
     C                     Z-ADDWN0017    $FLP7U           Lean Percent 17
     C                     Z-ADDWN0018    $FLP8U           Lean Percent 18
     C                     Z-ADDWN0019    $FLP9U           Lean Percent 19
     C                     Z-ADDWN0020    $FLP1U           Lean Percent 20
     C                     Z-ADDWN0021    $FLP2U           Lean Percent 21
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDIZAIC3    $GAIC3           Company Number
     C                     MOVELIZRXCD    $GRXCD           Cutout Matrix C
     C                     Z-ADDIZGHDT    $GGHDT           Effective Month
     C                     Z-ADDIZUPNB    $GUPNB           Min Carcass Wei
      * Load related totals format
     C                     Z-ADDIZAIC3    $IAIC3           Company Number
     C                     MOVELIZRXCD    $IRXCD           Cutout Matrix C
     C                     Z-ADDIZGHDT    $IGHDT           Effective Month
     C                     Z-ADDIZUPNB    $IUPNB           Min Carcass Wei
     C                     Z-ADDIZUQNB    $IUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     $IVSNB           Min Live Weight
     C                     Z-ADD*ZERO     $IVVNB           Max Live Weight
     C                     Z-ADD*ZERO     $IV0NB           Std Dressing Yi
     C                     Z-ADDIZDIPC    $IDIPC           Average Lean Pe
     C                     Z-ADDIZZ0NB    $IZ0NB           Average Backfat
     C                     Z-ADDIZAVLE    $IAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     $IPOP1           Population % 1
     C                     Z-ADD*ZERO     $IAW1U           Average Weight
     C                     Z-ADD*ZERO     $IPOP2           Population % 2
     C                     Z-ADD*ZERO     $IAW2U           Average Weight
     C                     Z-ADD*ZERO     $IPOP3           Population % 3
     C                     Z-ADD*ZERO     $IAW3U           Average Weight
     C                     Z-ADD*ZERO     $IPOP4           Population % 4
     C                     Z-ADD*ZERO     $IAW4U           Average Weight
     C                     Z-ADD*ZERO     $IPOP5           Population % 5
     C                     Z-ADD*ZERO     $IAW5U           Average Weight
     C                     Z-ADD*ZERO     $IPOP6           Population % 6
     C                     Z-ADD*ZERO     $IAW6U           Average Weight
     C                     Z-ADD*ZERO     $IPOP7           Population % 7
     C                     Z-ADD*ZERO     $IAW7U           Average Weight
     C                     Z-ADD*ZERO     $IPOP8           Population % 8
     C                     Z-ADD*ZERO     $IAW8U           Average Weight
     C                     Z-ADD*ZERO     $IPOP9           Population % 9
     C                     Z-ADD*ZERO     $IAW9U           Average Weight
     C                     Z-ADD*ZERO     $IPO10           Population % 10
     C                     Z-ADD*ZERO     $IAW10           Average Weight
     C                     Z-ADD*ZERO     $IPP11           Population % 11
     C                     Z-ADD*ZERO     $IAV11           Average Weight
     C                     Z-ADD*ZERO     $IPP12           Population % 12
     C                     Z-ADD*ZERO     $IAV12           Average Weight
     C                     Z-ADD*ZERO     $IPP3U           Population % 13
     C                     Z-ADD*ZERO     $IAW3Y           Average Weight
     C                     Z-ADD*ZERO     $IPP4U           Population % 14
     C                     Z-ADD*ZERO     $IAW4Y           Average Weight
     C                     Z-ADD*ZERO     $IPP5U           Population % 15
     C                     Z-ADD*ZERO     $IAW5Y           Average Weight
     C                     Z-ADD*ZERO     $IPP6U           Population % 16
     C                     Z-ADD*ZERO     $IAW6Y           Average Weight
     C                     Z-ADD*ZERO     $IPP7U           Population % 17
     C                     Z-ADD*ZERO     $IAW7Y           Average Weight
     C                     Z-ADD*ZERO     $IPP8U           Population % 18
     C                     Z-ADD*ZERO     $IAW8Y           Average Weight
     C                     Z-ADD*ZERO     $IPP9U           Population % 19
     C                     Z-ADD*ZERO     $IAW9Y           Average Weight
     C                     Z-ADD*ZERO     $IPP1U           Population % 20
     C                     Z-ADD*ZERO     $IAWY1           Average Weight
     C                     Z-ADD*ZERO     $IPP2U           Population % 21
     C                     Z-ADD*ZERO     $IAW1Y           Average Weight
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDIZAIC3    $HAIC3           Company Number
     C                     MOVELIZRXCD    $HRXCD           Cutout Matrix C
     C                     Z-ADDIZGHDT    $HGHDT           Effective Month
     C                     Z-ADDIZUPNB    $HUPNB           Min Carcass Wei
     C                     Z-ADDIZUQNB    $HUQNB           Max Carcass Wei
     C                     Z-ADDIZULNB    $HULNB           Lean Percent
     C                     Z-ADDIZUNNB    $HUNNB           Average Cold Wg
     C                     Z-ADDIZUONB    $HUONB           Population Perc
     C                     Z-ADDIZDIPC    $HDIPC           Average Lean Pe
     C                     Z-ADDIZZ0NB    $HZ0NB           Average Backfat
     C                     Z-ADDIZAVLE    $HAVLE           Average Loin-Ey
     C                     Z-ADDIZQPNX    $HQPNX           Population Head
     C                     MOVELIZUVST    $HUVST           EDI Status 1
     C                     MOVELIZUWST    $HUWST           EDI Status 2
     C                     MOVELIZUXST    $HUXST           EDI Status 3
     C                     MOVELIZVSST    $HVSST           Record Status
     C                     Z-ADDIZAATM    $HAATM           Job Time
     C                     MOVELIZAYNA    $HAYNA           User Id
     C                     MOVELIZA0NA    $HA0NA           Job Name
     C                     Z-ADDIZAXDT    $HAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN IZAIC3    WZB001           Company Number
     C                     Z-ADDIZAIC3    WZB001
     C           *LIKE     DEFN IZRXCD    WZB002           Cutout Matrix C
     C                     MOVELIZRXCD    WZB002
     C           *LIKE     DEFN IZGHDT    WZB003           Effective Month
     C                     Z-ADDIZGHDT    WZB003
     C           *LIKE     DEFN IZUPNB    WZB004           Min Carcass Wei
     C                     Z-ADDIZUPNB    WZB004
     C           *LIKE     DEFN IZUQNB    WZB005           Max Carcass Wei
     C                     Z-ADDIZUQNB    WZB005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@IZRETC                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Cutout Matrix C
     C                     MOVEL*BLANK    W0BL02  1        Effective Month
     C                     MOVEL*BLANK    W0BL03  1        Min Carcass Wei
     C                     MOVEL*BLANK    W0BL04  1        Max Carcass Wei
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Cutout Matrix C
     C                     MOVEL'Y'       W0BL02  1        Effective Month
     C                     MOVEL'Y'       W0BL03  1        Min Carcass Wei
     C                     MOVEL'Y'       W0BL04  1        Max Carcass Wei
     C                     ELSE
      * Next record - Detect level breaks
     C           IZAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           IZRXCD    IFNE WZB002                     Cutout Matrix C
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           IZGHDT    IFNE WZB003                     Effective Month
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           IZUPNB    IFNE WZB004                     Min Carcass Wei
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           IZUQNB    IFNE WZB005                     Max Carcass Wei
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * USER: Process before print of Min Carcass Weight format
      * Rtv Wgt Rng Info      RT - PS Cutout Weight Range  * 
     C                     EXSR SERVGN
      * Calculate Average Weight Range Lean%, Backfat, & Loin-Eye
      * CASE: PAR.Count WR Cell USR is GT 0
     C           WN0083    IFGT *ZERO                      *IF
     C           WN0080    DIV  WN0083    $IDIPC    H      Average Lean Pe
     C           WN0081    DIV  WN0083    $IZ0NB    H      Average Backfat
     C           WN0082    DIV  WN0083    $IAVLE    H      Average Loin-Ey
     C                     END                             *FI
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$IKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
      * USER: Process after print of Min Carcass Weight format
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
     C                     ADD  $IPOP1    $JPP1S           Population % 1
     C                     ADD  $IPOP2    $JPP2S           Population % 2
     C                     ADD  $IPOP3    $JPP3S           Population % 3
     C                     ADD  $IPOP4    $JPP4S           Population % 4
     C                     ADD  $IPOP5    $JPP5S           Population % 5
     C                     ADD  $IPOP6    $JPP6S           Population % 6
     C                     ADD  $IPOP7    $JPP7S           Population % 7
     C                     ADD  $IPOP8    $JPP8S           Population % 8
     C                     ADD  $IPOP9    $JKUNB           Population % 9
     C                     ADD  $IPO10    $JPP0S           Population % 10
     C                     ADD  $IPP11    $JPS11           Population % 11
     C                     ADD  $IPP12    $JPS12           Population % 12
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * USER: Process before print of Effective Month/Day format
      * Lean % Total:  Average 1
      * CASE: PAR.Lean % Rec Count 1 USR is Greater than zero
     C           WN0022    IFGT *ZERO                      *IF
     C           WN0044    DIV  WN0022    $JAL1U    H      Average Lean %
     C           WN0056    DIV  WN0022    $JAB1U    H      Average Backfat
     C           WN0068    DIV  WN0022    $JAI1U    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 2
      * CASE: PAR.Lean % Rec Count 2 USR is Greater than zero
     C           WN0023    IFGT *ZERO                      *IF
     C           WN0045    DIV  WN0023    $JAL2U    H      Average Lean %
     C           WN0057    DIV  WN0023    $JAB2X    H      Average Backfat
     C           WN0069    DIV  WN0023    $JAI2U    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 3
      * CASE: PAR.Lean % Rec Count 3 USR is Greater than zero
     C           WN0024    IFGT *ZERO                      *IF
     C           WN0046    DIV  WN0024    $JAL3U    H      Average Lean %
     C           WN0058    DIV  WN0024    $JN7NB    H      Average Backfat
     C           WN0070    DIV  WN0024    $JAI3U    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 4
      * CASE: PAR.Lean % Rec Count 4 USR is Greater than zero
     C           WN0025    IFGT *ZERO                      *IF
     C           WN0047    DIV  WN0025    $JAL4U    H      Average Lean %
     C           WN0059    DIV  WN0025    $JN8NB    H      Average Backfat
     C           WN0071    DIV  WN0025    $JAI4U    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 5
      * CASE: PAR.Lean % Rec Count 5 USR is Greater than zero
     C           WN0026    IFGT *ZERO                      *IF
     C           WN0048    DIV  WN0026    $JAL5U    H      Average Lean %
     C           WN0060    DIV  WN0026    $JAB5X    H      Average Backfat
     C           WN0072    DIV  WN0026    $JAI5U    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 6
      * CASE: PAR.Lean % Rec Count 6 USR is Greater than zero
     C           WN0027    IFGT *ZERO                      *IF
     C           WN0049    DIV  WN0027    $JAL6U    H      Average Lean %
     C           WN0061    DIV  WN0027    $JAB6X    H      Average Backfat
     C           WN0073    DIV  WN0027    $JAI6U    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 7
      * CASE: PAR.Lean % Rec Count 7 USR is Greater than zero
     C           WN0028    IFGT *ZERO                      *IF
     C           WN0050    DIV  WN0028    $JAL7U    H      Average Lean %
     C           WN0062    DIV  WN0028    $JAB7X    H      Average Backfat
     C           WN0074    DIV  WN0028    $JAI7U    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 8
      * CASE: PAR.Lean % Rec Count 8 USR is Greater than zero
     C           WN0029    IFGT *ZERO                      *IF
     C           WN0051    DIV  WN0029    $JAL8U    H      Average Lean %
     C           WN0063    DIV  WN0029    $JAB8X    H      Average Backfat
     C           WN0075    DIV  WN0029    $JAI8U    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 9
      * CASE: PAR.Lean % Rec Count 9 USR is Greater than zero
     C           WN0030    IFGT *ZERO                      *IF
     C           WN0052    DIV  WN0030    $JAL9U    H      Average Lean %
     C           WN0064    DIV  WN0030    $JOUNB    H      Average Backfat
     C           WN0076    DIV  WN0030    $JAI9U    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 10
      * CASE: PAR.Lean % Rec Count 10 USR is Greater than zero
     C           WN0031    IFGT *ZERO                      *IF
     C           WN0053    DIV  WN0031    $JAL0U    H      Average Lean %
     C           WN0065    DIV  WN0031    $JOVNB    H      Average Backfat
     C           WN0077    DIV  WN0031    $JRLNB    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 11
      * CASE: PAR.Lean % Rec Count 11 USR is Greater than zero
     C           WN0032    IFGT *ZERO                      *IF
     C           WN0054    DIV  WN0032    $JAL11    H      Average Lean %
     C           WN0066    DIV  WN0032    $JAB11    H      Average Backfat
     C           WN0078    DIV  WN0032    $JAI11    H      Average Loin I
     C                     END                             *FI
      * Lean % Total:  Average 12
      * CASE: PAR.Lean % Rec Count 12 USR is Greater than zero
     C           WN0033    IFGT *ZERO                      *IF
     C           WN0055    DIV  WN0033    $JAL12    H      Average Lean %
     C           WN0067    DIV  WN0033    $JAB12    H      Average Backfat
     C           WN0079    DIV  WN0033    $JAI12    H      Average Loin I
     C                     END                             *FI
      * Matrix Total: Record Count
     C                     EXSR UBSUBR                     Matrix Total: R
      * Matrix Total: Average Lean %
     C                     EXSR UCSUBR                     Matrix Total: A
      * Matrix Total: Average Backfat Inches
     C                     EXSR UDSUBR                     Matrix Total: A
      * Matrix Total: Average Loin-Eye Depth
     C                     EXSR UESUBR                     Matrix Total: A
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Cutout Dist       PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Cutout Dist       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of Prt Cutout Dist       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$BKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Cutout Matrix Code of Prt Cutout Dist       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Convert fields to external form
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Detail line. of Prt Cutout Dist       PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$DDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Cutout Dist       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Print format
     C                     WRITE$E1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of Prt Cutout Dist       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Cutout Matrix Code of Prt Cutout Dist       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Effective Month/Day of Prt Cutout Dist       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
     C                     MOVEL'0'       *IN79
     C           WN0001    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WN0002    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WN0003    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WN0004    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           WN0005    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           WN0006    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           WN0007    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           WN0008    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           WN0009    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           WN0010    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN69
     C           WN0011    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL'0'       *IN68
     C           WN0012    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN68
     C                     END                             *FI
      * Print format
     C                     WRITE$FKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Min Carcass Weight of Prt Cutout Dist       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * USER: On print of Min Carcass Weight format
      * Initialize Weight Range totals
     C                     Z-ADD*ZERO     WN0080           Average Lean% W
     C                     Z-ADD*ZERO     WN0081           Average BackFt
     C                     Z-ADD*ZERO     WN0082           Average Loin-I
     C                     Z-ADD*ZERO     WN0083           Count WR Cell U
      * Mention hidden format
     C   99N99             WRITE$GKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Max Carcass Weight of Prt Cutout Dist       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Detail line. of Prt Cutout Dist       PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * USER: On print of detail format
      * Move Pop% & Avg Wgt. / Sum Avg. Lean%, Backfat, & Loin-Eye
      * CASE: PAR.Lean Percent 1 USR EQ CUR.Lean Percent
     C           WN0001    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPOP1           Population % 1
     C                     Z-ADD$HUNNB    $IAW1U           Average Weight
     C                     ADD  $HDIPC    WN0044           Average Lean %
     C                     ADD  $HZ0NB    WN0056           Average Backft
     C                     ADD  $HAVLE    WN0068           Average Loin I
      * Lean % Rec Count 1
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0022           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 2 USR EQ CUR.Lean Percent
     C           WN0002    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPOP2           Population % 2
     C                     Z-ADD$HUNNB    $IAW2U           Average Weight
     C                     ADD  $HDIPC    WN0045           Average Lean %
     C                     ADD  $HZ0NB    WN0057           Average Backft
     C                     ADD  $HAVLE    WN0069           Average Loin I
      * Lean % Rec Count 1
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0023           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 3 USR EQ CUR.Lean Percent
     C           WN0003    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPOP3           Population % 3
     C                     Z-ADD$HUNNB    $IAW3U           Average Weight
     C                     ADD  $HDIPC    WN0046           Average Lean %
     C                     ADD  $HZ0NB    WN0058           Average Backft
     C                     ADD  $HAVLE    WN0070           Average Loin I
      * Lean % Rec Count 3
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0024           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 4 USR EQ CUR.Lean Percent
     C           WN0004    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPOP4           Population % 4
     C                     Z-ADD$HUNNB    $IAW4U           Average Weight
     C                     ADD  $HDIPC    WN0047           Average Lean %
     C                     ADD  $HZ0NB    WN0059           Average Backft
     C                     ADD  $HAVLE    WN0071           Average Loin I
      * Lean % Rec Count 4
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0025           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 5 USR EQ CUR.Lean Percent
     C           WN0005    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPOP5           Population % 5
     C                     Z-ADD$HUNNB    $IAW5U           Average Weight
     C                     ADD  $HDIPC    WN0048           Average Lean %
     C                     ADD  $HZ0NB    WN0060           Average Backft
     C                     ADD  $HAVLE    WN0072           Average Loin I
      * Lean % Rec Count 5
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0026           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 6 USR EQ CUR.Lean Percent
     C           WN0006    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPOP6           Population % 6
     C                     Z-ADD$HUNNB    $IAW6U           Average Weight
     C                     ADD  $HDIPC    WN0049           Average Lean %
     C                     ADD  $HZ0NB    WN0061           Average Backft
     C                     ADD  $HAVLE    WN0073           Average Loin I
      * Lean % Rec Count 6
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0027           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 7 USR EQ CUR.Lean Percent
     C           WN0007    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPOP7           Population % 7
     C                     Z-ADD$HUNNB    $IAW7U           Average Weight
     C                     ADD  $HDIPC    WN0050           Average Lean %
     C                     ADD  $HZ0NB    WN0062           Average Backft
     C                     ADD  $HAVLE    WN0074           Average Loin I
      * Lean % Rec Count 7
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0028           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 8 USR EQ CUR.Lean Percent
     C           WN0008    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPOP8           Population % 8
     C                     Z-ADD$HUNNB    $IAW8U           Average Weight
     C                     ADD  $HDIPC    WN0051           Average Lean %
     C                     ADD  $HZ0NB    WN0063           Average Backft
     C                     ADD  $HAVLE    WN0075           Average Loin I
      * Lean % Rec Count 8
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0029           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 9 USR EQ CUR.Lean Percent
     C           WN0009    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPOP9           Population % 9
     C                     Z-ADD$HUNNB    $IAW9U           Average Weight
     C                     ADD  $HDIPC    WN0052           Average Lean %
     C                     ADD  $HZ0NB    WN0064           Average Backft
     C                     ADD  $HAVLE    WN0076           Average Loin I
      * Lean % Rec Count 9
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0030           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 10 USR EQ CUR.Lean Percent
     C           WN0010    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPO10           Population % 10
     C                     Z-ADD$HUNNB    $IAW10           Average Weight
     C                     ADD  $HDIPC    WN0053           Average Lean %
     C                     ADD  $HZ0NB    WN0065           Average Backft
     C                     ADD  $HAVLE    WN0077           Average Loin I
      * Lean % Rec Count 10
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0031           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 11 USR EQ CUR.Lean Percent
     C           WN0011    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP11           Population % 11
     C                     Z-ADD$HUNNB    $IAV11           Average Weight
     C                     ADD  $HDIPC    WN0054           Average Lean %
     C                     ADD  $HZ0NB    WN0066           Average Backft
     C                     ADD  $HAVLE    WN0078           Average Loin I
      * Lean % Rec Count 11
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0032           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 12 USR EQ CUR.Lean Percent
     C           WN0012    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP12           Population % 12
     C                     Z-ADD$HUNNB    $IAV12           Average Weight
     C                     ADD  $HDIPC    WN0055           Average Lean %
     C                     ADD  $HZ0NB    WN0067           Average Backft
     C                     ADD  $HAVLE    WN0079           Average Loin I
      * Lean % Rec Count 12
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0033           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 13 USR EQ CUR.Lean Percent
     C           WN0013    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP3U           Population % 13
     C                     Z-ADD$HUNNB    $IAW3Y           Average Weight
      * Lean % Rec Count 13
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0034           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 14 USR EQ CUR.Lean Percent
     C           WN0014    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP4U           Population % 14
     C                     Z-ADD$HUNNB    $IAW4Y           Average Weight
      * Lean % Rec Count 14
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0035           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 15 USR EQ CUR.Lean Percent
     C           WN0015    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP5U           Population % 15
     C                     Z-ADD$HUNNB    $IAW5Y           Average Weight
      * Lean % Rec Count 15
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0036           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 16 USR EQ CUR.Lean Percent
     C           WN0016    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP6U           Population % 16
     C                     Z-ADD$HUNNB    $IAW6Y           Average Weight
      * Lean % Rec Count 16
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0037           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 17 USR EQ CUR.Lean Percent
     C           WN0017    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP7U           Population % 17
     C                     Z-ADD$HUNNB    $IAW7Y           Average Weight
      * Lean % Rec Count 17
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0038           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 18 USR EQ CUR.Lean Percent
     C           WN0018    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP8U           Population % 18
     C                     Z-ADD$HUNNB    $IAW8Y           Average Weight
      * Lean % Rec Count 18
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0039           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 19 USR EQ CUR.Lean Percent
     C           WN0019    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP9U           Population % 19
     C                     Z-ADD$HUNNB    $IAW9Y           Average Weight
      * Lean % Rec Count 19
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0040           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 20 USR EQ CUR.Lean Percent
     C           WN0020    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP1U           Population % 20
     C                     Z-ADD$HUNNB    $IAWY1           Average Weight
      * Lean % Rec Count 20
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0041           Lean % Rec Coun
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Lean Percent 21 USR EQ CUR.Lean Percent
     C           WN0021    IFEQ $HULNB                     *IF
     C                     Z-ADD$HUONB    $IPP2U           Population % 21
     C                     Z-ADD$HUNNB    $IAW1Y           Average Weight
      * Lean % Rec Count 21
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0042           Lean % Rec Coun
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate Weight Range Lean%, Backfat, & Loin-Eye.
     C                     ADD  IZDIPC    WN0080           Average Lean% W
     C                     ADD  IZZ0NB    WN0081           Average BackFt
     C                     ADD  IZAVLE    WN0082           Average Loin-I
      * CASE: DB1.Population Percent is GT Zero
     C           IZUONB    IFGT *ZERO                      *IF
     C                     ADD  1         WN0083           Count WR Cell U
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$HDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Cutout Dist       PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Cutout Dist       PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Cutout Matrix Code of Prt Cutout Dist       PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  4         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Cutout Dist       PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Cutout Dist       PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Cutout Dist       PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Cutout Matrix Code of Prt Cutout Dist       PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Effective Month/Day of Prt Cutout Dist       PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Min Carcass Weight of Prt Cutout Dist       PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Max Carcass Weight of Prt Cutout Dist       PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Cutout Dist       PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVELP2DNCD    WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BADTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Lean % (Prt Dist) RT - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD1         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WARXCD    WQSD02           Cutout Matrix C
     C           *LIKE     DEFN WAGHDT    WQSD03           Effective Month
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Cutout Matrix C
     C                     KFLD           WQSD03           Effective Month
      * Setup key
     C                     Z-ADD$FAIC3    WQSD01           Company Number
     C                     MOVEL$FRXCD    WQSD02           Cutout Matrix C
     C                     Z-ADD$FGHDT    WQSD03           Effective Month
      * Establish starting position
     C           KRSSD     SETLL@IZREXQ                    *
     C           KRSSD     READE@IZREXQ                  90*
      * Data record not found
     C   90                MOVEL'USR1720' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWAULNB    WUULNB           Lean Percent
     C                     Z-ADDWAULNB    WN0001           Lean Percent 1
     C                     ADD  1         WUCNTU           Count USR
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Lean Percent NE DB1.Lean Percent
     C           WUULNB    IFNE WAULNB                     *IF
      * Move DB1 to PAR (2 - 10)
      * CASE: WRK.Count USR is Two
     C           WUCNTU    IFEQ 2                          *IF
     C                     Z-ADDWAULNB    WN0002           Lean Percent 2
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDWAULNB    WN0003           Lean Percent 3
     C                     ELSE
      * CASE: WRK.Count USR is Four
     C           WUCNTU    IFEQ 4                          *IF
     C                     Z-ADDWAULNB    WN0004           Lean Percent 4
     C                     ELSE
      * CASE: WRK.Count USR is Five
     C           WUCNTU    IFEQ 5                          *IF
     C                     Z-ADDWAULNB    WN0005           Lean Percent 5
     C                     ELSE
      * CASE: WRK.Count USR is Six
     C           WUCNTU    IFEQ 6                          *IF
     C                     Z-ADDWAULNB    WN0006           Lean Percent 6
     C                     ELSE
      * CASE: WRK.Count USR is Seven
     C           WUCNTU    IFEQ 7                          *IF
     C                     Z-ADDWAULNB    WN0007           Lean Percent 7
     C                     ELSE
      * CASE: WRK.Count USR is Eight
     C           WUCNTU    IFEQ 8                          *IF
     C                     Z-ADDWAULNB    WN0008           Lean Percent 8
     C                     ELSE
      * CASE: WRK.Count USR is Nine
     C           WUCNTU    IFEQ 9                          *IF
     C                     Z-ADDWAULNB    WN0009           Lean Percent 9
     C                     ELSE
      * CASE: WRK.Count USR is Ten
     C           WUCNTU    IFEQ 10                         *IF
     C                     Z-ADDWAULNB    WN0010           Lean Percent 10
     C                     ELSE
      * CASE: WRK.Count USR is Eleven
     C           WUCNTU    IFEQ 11                         *IF
     C                     Z-ADDWAULNB    WN0011           Lean Percent 11
     C                     ELSE
      * CASE: WRK.Count USR is Twelve
     C           WUCNTU    IFEQ 12                         *IF
     C                     Z-ADDWAULNB    WN0012           Lean Percent 12
     C                     ELSE
      * CASE: WRK.Count USR is Thirteen
     C           WUCNTU    IFEQ 13                         *IF
     C                     Z-ADDWAULNB    WN0013           Lean Percent 13
     C                     ELSE
      * CASE: WRK.Count USR is Fourteen
     C           WUCNTU    IFEQ 14                         *IF
     C                     Z-ADDWAULNB    WN0014           Lean Percent 14
     C                     ELSE
      * CASE: WRK.Count USR is Fifteen
     C           WUCNTU    IFEQ 15                         *IF
     C                     Z-ADDWAULNB    WN0015           Lean Percent 15
     C                     ELSE
      * CASE: WRK.Count USR is Sixteen
     C           WUCNTU    IFEQ 16                         *IF
     C                     Z-ADDWAULNB    WN0016           Lean Percent 16
     C                     ELSE
      * CASE: WRK.Count USR is Seventeen
     C           WUCNTU    IFEQ 17                         *IF
     C                     Z-ADDWAULNB    WN0017           Lean Percent 17
     C                     ELSE
      * CASE: WRK.Count USR is Eighteen
     C           WUCNTU    IFEQ 18                         *IF
     C                     Z-ADDWAULNB    WN0018           Lean Percent 18
     C                     ELSE
      * CASE: WRK.Count USR is Nineteen
     C           WUCNTU    IFEQ 19                         *IF
     C                     Z-ADDWAULNB    WN0019           Lean Percent 19
     C                     ELSE
      * CASE: WRK.Count USR is Twenty
     C           WUCNTU    IFEQ 20                         *IF
     C                     Z-ADDWAULNB    WN0020           Lean Percent 20
     C                     ELSE
      * CASE: WRK.Count USR is Twenty One
     C           WUCNTU    IFEQ 21                         *IF
     C                     Z-ADDWAULNB    WN0021           Lean Percent 21
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWAULNB    WUULNB           Lean Percent
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@IZREXQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Wgt Rng Info      RT - PS Cutout Weight Range  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           I1AIC3           Company Number
     C                     KFLD           I1RXCD           Cutout Matrix C
     C                     KFLD           I1GHDT           Effective Month
     C                     KFLD           I1UPNB           Min Carcass Wei
     C                     KFLD           I1UQNB           Max Carcass Wei
      * Setup key
     C                     Z-ADD$IAIC3    I1AIC3           Company Number
     C                     MOVEL$IRXCD    I1RXCD           Cutout Matrix C
     C                     Z-ADD$IGHDT    I1GHDT           Effective Month
     C                     Z-ADD$IUPNB    I1UPNB           Min Carcass Wei
     C                     Z-ADD$IUQNB    I1UQNB           Max Carcass Wei
      * Establish starting position
     C           KRSSE     CHAIN@I1RES6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1724' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $IVSNB           Min Live Weight
     C                     Z-ADD*ZERO     $IVVNB           Max Live Weight
     C                     Z-ADD*ZERO     WUDGPC           Cooler Shrink P
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDI1VSNB    $IVSNB           Min Live Weight
     C                     Z-ADDI1VVNB    $IVVNB           Max Live Weight
     C                     Z-ADDI1DGPC    WUDGPC           Cooler Shrink P
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Cutout Matrix     PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  31       Lean Percent 1
     C                     Z-ADD*ZERO     WN0002  31       Lean Percent 2
     C                     Z-ADD*ZERO     WN0003  31       Lean Percent 3
     C                     Z-ADD*ZERO     WN0004  31       Lean Percent 4
     C                     Z-ADD*ZERO     WN0005  31       Lean Percent 5
     C                     Z-ADD*ZERO     WN0006  31       Lean Percent 6
     C                     Z-ADD*ZERO     WN0007  31       Lean Percent 7
     C                     Z-ADD*ZERO     WN0008  31       Lean Percent 8
     C                     Z-ADD*ZERO     WN0009  31       Lean Percent 9
     C                     Z-ADD*ZERO     WN0010  31       Lean Percent 10
     C                     Z-ADD*ZERO     WN0011  31       Lean Percent 11
     C                     Z-ADD*ZERO     WN0012  31       Lean Percent 12
     C                     Z-ADD*ZERO     WN0013  31       Lean Percent 13
     C                     Z-ADD*ZERO     WN0014  31       Lean Percent 14
     C                     Z-ADD*ZERO     WN0015  31       Lean Percent 15
     C                     Z-ADD*ZERO     WN0016  31       Lean Percent 16
     C                     Z-ADD*ZERO     WN0017  31       Lean Percent 17
     C                     Z-ADD*ZERO     WN0018  31       Lean Percent 18
     C                     Z-ADD*ZERO     WN0019  31       Lean Percent 19
     C                     Z-ADD*ZERO     WN0020  31       Lean Percent 20
     C                     Z-ADD*ZERO     WN0021  31       Lean Percent 21
     C                     Z-ADD*ZERO     WN0022  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0023  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0024  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0025  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0026  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0027  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0028  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0029  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0030  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0031  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0032  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0033  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0034  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0035  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0036  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0037  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0038  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0039  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0040  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0041  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0042  70       Lean % Rec Coun
     C                     Z-ADD*ZERO     WN0043  50       Count USR
     C                     Z-ADD*ZERO     WN0044  72       Average Lean %
     C                     Z-ADD*ZERO     WN0045  72       Average Lean %
     C                     Z-ADD*ZERO     WN0046  72       Average Lean %
     C                     Z-ADD*ZERO     WN0047  72       Average Lean %
     C                     Z-ADD*ZERO     WN0048  72       Average Lean %
     C                     Z-ADD*ZERO     WN0049  72       Average Lean %
     C                     Z-ADD*ZERO     WN0050  72       Average Lean %
     C                     Z-ADD*ZERO     WN0051  72       Average Lean %
     C                     Z-ADD*ZERO     WN0052  72       Average Lean %
     C                     Z-ADD*ZERO     WN0053  72       Average Lean %
     C                     Z-ADD*ZERO     WN0054  72       Average Lean %
     C                     Z-ADD*ZERO     WN0055  72       Average Lean %
     C                     Z-ADD*ZERO     WN0056  52       Average Backft
     C                     Z-ADD*ZERO     WN0057  52       Average Backft
     C                     Z-ADD*ZERO     WN0058  52       Average Backft
     C                     Z-ADD*ZERO     WN0059  52       Average Backft
     C                     Z-ADD*ZERO     WN0060  52       Average Backft
     C                     Z-ADD*ZERO     WN0061  52       Average Backft
     C                     Z-ADD*ZERO     WN0062  52       Average Backft
     C                     Z-ADD*ZERO     WN0063  52       Average Backft
     C                     Z-ADD*ZERO     WN0064  52       Average Backft
     C                     Z-ADD*ZERO     WN0065  52       Average Backft
     C                     Z-ADD*ZERO     WN0066  52       Average Backft
     C                     Z-ADD*ZERO     WN0067  52       Average Backft
     C                     Z-ADD*ZERO     WN0068  52       Average Loin I
     C                     Z-ADD*ZERO     WN0069  52       Average Loin I
     C                     Z-ADD*ZERO     WN0070  52       Average Loin I
     C                     Z-ADD*ZERO     WN0071  52       Average Loin I
     C                     Z-ADD*ZERO     WN0072  52       Average Loin I
     C                     Z-ADD*ZERO     WN0073  52       Average Loin I
     C                     Z-ADD*ZERO     WN0074  52       Average Loin I
     C                     Z-ADD*ZERO     WN0075  52       Average Loin I
     C                     Z-ADD*ZERO     WN0076  52       Average Loin I
     C                     Z-ADD*ZERO     WN0077  52       Average Loin I
     C                     Z-ADD*ZERO     WN0078  52       Average Loin I
     C                     Z-ADD*ZERO     WN0079  52       Average Loin I
     C                     Z-ADD*ZERO     WN0080 152       Average Lean% W
     C                     Z-ADD*ZERO     WN0081  92       Average BackFt
     C                     Z-ADD*ZERO     WN0082  92       Average Loin-I
     C                     Z-ADD*ZERO     WN0083  50       Count WR Cell U
      *
      * Prt Cutout Dist       PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Matrix Total: Record Count
      *================================================================
     C                     ADD  WN0022    WN0043           Count USR
     C                     ADD  WN0023    WN0043           Count USR
     C                     ADD  WN0024    WN0043           Count USR
     C                     ADD  WN0025    WN0043           Count USR
     C                     ADD  WN0026    WN0043           Count USR
     C                     ADD  WN0027    WN0043           Count USR
     C                     ADD  WN0028    WN0043           Count USR
     C                     ADD  WN0029    WN0043           Count USR
     C                     ADD  WN0030    WN0043           Count USR
     C                     ADD  WN0031    WN0043           Count USR
     C                     ADD  WN0032    WN0043           Count USR
     C                     ADD  WN0033    WN0043           Count USR
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Matrix Total: Average Lean %
      *================================================================
     C                     ADD  WN0044    $JDUPC           Average Lean %
     C                     ADD  WN0045    $JDUPC           Average Lean %
     C                     ADD  WN0046    $JDUPC           Average Lean %
     C                     ADD  WN0047    $JDUPC           Average Lean %
     C                     ADD  WN0048    $JDUPC           Average Lean %
     C                     ADD  WN0049    $JDUPC           Average Lean %
     C                     ADD  WN0050    $JDUPC           Average Lean %
     C                     ADD  WN0051    $JDUPC           Average Lean %
     C                     ADD  WN0052    $JDUPC           Average Lean %
     C                     ADD  WN0053    $JDUPC           Average Lean %
     C                     ADD  WN0054    $JDUPC           Average Lean %
     C                     ADD  WN0055    $JDUPC           Average Lean %
      * CASE: PAR.Count USR is GT 0
     C           WN0043    IFGT *ZERO                      *IF
     C           $JDUPC    DIV  WN0043    $JDIPC    H      Average Lean Pe
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Matrix Total: Average Backfat Inches
      *================================================================
     C                     ADD  WN0056    $JABTU           Average Backfat
     C                     ADD  WN0057    $JABTU           Average Backfat
     C                     ADD  WN0058    $JABTU           Average Backfat
     C                     ADD  WN0059    $JABTU           Average Backfat
     C                     ADD  WN0060    $JABTU           Average Backfat
     C                     ADD  WN0061    $JABTU           Average Backfat
     C                     ADD  WN0062    $JABTU           Average Backfat
     C                     ADD  WN0063    $JABTU           Average Backfat
     C                     ADD  WN0064    $JABTU           Average Backfat
     C                     ADD  WN0065    $JABTU           Average Backfat
     C                     ADD  WN0066    $JABTU           Average Backfat
     C                     ADD  WN0067    $JABTU           Average Backfat
      * CASE: PAR.Count USR is GT 0
     C           WN0043    IFGT *ZERO                      *IF
     C           $JABTU    DIV  WN0043    $JZ0NB    H      Average Backfat
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Matrix Total: Average Loin-Eye Depth
      *================================================================
     C                     ADD  WN0068    $JAITU           Average Loin I
     C                     ADD  WN0069    $JAITU           Average Loin I
     C                     ADD  WN0070    $JAITU           Average Loin I
     C                     ADD  WN0071    $JAITU           Average Loin I
     C                     ADD  WN0072    $JAITU           Average Loin I
     C                     ADD  WN0073    $JAITU           Average Loin I
     C                     ADD  WN0074    $JAITU           Average Loin I
     C                     ADD  WN0075    $JAITU           Average Loin I
     C                     ADD  WN0076    $JAITU           Average Loin I
     C                     ADD  WN0077    $JAITU           Average Loin I
     C                     ADD  WN0078    $JAITU           Average Loin I
     C                     ADD  WN0079    $JAITU           Average Loin I
      * CASE: PAR.Count USR is GT 0
     C           WN0043    IFGT *ZERO                      *IF
     C           $JAITU    DIV  WN0043    $JAVLE    H      Average Loin-Ey
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    I0AIC3           Company Number
     C                     MOVEL*LOVAL    I0RXCD           Cutout Matrix C
     C                     MOVEL*LOVAL    I0GHDT           Effective Month
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    IZAIC3           Company Number
     C                     MOVEL*LOVAL    IZRXCD           Cutout Matrix C
     C                     MOVEL*LOVAL    IZGHDT           Effective Month
     C                     MOVEL*LOVAL    IZUPNB           Min Carcass Wei
     C                     MOVEL*LOVAL    IZUQNB           Max Carcass Wei
     C                     MOVEL*LOVAL    IZULNB           Lean Percent
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAGHDT           Effective Month
     C                     Z-ADD*ZERO     WAUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WAUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WAULNB           Lean Percent
     C                     Z-ADD*ZERO     WAUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     WAUONB           Population Perc
     C                     Z-ADD*ZERO     WADIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WAZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WAAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WAQPNX           Population Head
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Lean Percent
     C                     Z-ADD*ZERO     WUULNB  31
      * Define work field Cooler Shrink Percent
     C                     Z-ADD*ZERO     WUDGPC  52
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * Move Appl Desc to Prt co - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      *================================================================
     CSR         ZZEXIT    ENDSR
