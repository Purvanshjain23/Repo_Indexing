/***************************************************************** */
/*                                                                 */
/*  ENVIRONMENT -----> Pork Division                               */
/*  SYSTEM ----------> Hog Procurement System                      */
/*  PROGRAM NUMBER --> HP8501CL                                    */
/*  PROGRAM NAME ----> RENUMBER FARM 1072 TO 2026 FIX              */
/*  PROGRAMMER ------> ERIC L                                      */
/*  DATE ------------> 11/28/2022                                  */
/*                                                                 */
/*  PROGRAM PURPOSE -> Call HP85005,HP85001,HP85006,HP85007        */
/*                     to update the Farm Site code with a new     */
/*                     number.  All files that contain the Farm    */
/*                     Site, Origin Farm Site, and Destination     */
/*                     Farm Site fields will be updated with the   */
/*                     new number.  Run program HP85006 over both  */
/*                     PRKFLIB and PRKDMFLIB.                      */
/* NOTE: HP85007 WILL BE CALLED I/OF HP85003, HSL099A WON'T BE     */
/*               UPDATED (Sire Line Sources)                       */
/*                                                                 */
/***************************************************************** */

             PGM

             DCL        VAR(&TSTPRDFL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&GRPPRFL)  TYPE(*CHAR) LEN(10)

             PSHLIBL35
             RTVUSRPRF  GRPPRF(&GRPPRFL)

/*----------------------------------------------------------------*/
/* SET LIBRARY LIST                                               */
/*----------------------------------------------------------------*/
             SELECT
             WHEN       COND(&GRPPRFL = 'SBDPGMR ') THEN(SETLIBL +
                          JOBD(TPMTESTJD))
             OTHERWISE  CMD(SETLIBL JOBD(PRKPRDGUY))
             ENDSELECT

/*-----------------------------------------------------------------*/
/*  Call HP85005 to renumber the following files:                  */
/*  HSP028  - Farm Costs                                           */
/*  HSL048F - Expense Tickets                                      */
/*  HSL055D - Period Costs                                         */
/*  HSL082A - BGF Daily Production                                 */
/*  HSL084C - Sales Movement Header                                */
/*  HSL086A - BGF Weekly Wean Projections                          */
/*  HSL092A - BGF Weekly Production                                */
/*  HSL093A - BGF Farrowing and Pregnancy Check Events             */
/*  HSL097C - BGF Target Table/Farm Links                          */
/*  HSL100A - Quarterly Averages                                   */
/*  HSP103  - Reported Daily Activity                              */
/*  HSL352A - Cost Movements: Workfile - Origin Groups             */
/*  HSP259  - Safedata: Download Farm Sites                        */
/*-----------------------------------------------------------------*/
             CALL       PGM(HP85005)

/*-----------------------------------------------------------------*/
/*  Call HP85001 to renumber the following files:                  */
/*  HSL034E - Hog Group by Farm Site                               */
/*  HSL034S - Hog Group by BGF Origin Farm Site                    */
/*  HSL074F - Transfer Movement Header by Destination Farm Site    */
/*  HSL074C - Transfer Movement Header by Origin Farm Site         */
/*  HSL080D - Deleted Movements by Origin Farm Site                */
/*  HSL080C - Deleted Movements by Destination Farm Site           */
/*  HSL118F - Costed Movements by Destination Farm Site            */
/*  HSL118G - Costed Movements by Origin Farm Site                 */
/*  HSL120E - Costed Movements Expense Codes by Destination Farm   */
/*  HSL120D - Costed Movements Expense Codes by Origin Farm Site   */
/*-----------------------------------------------------------------*/

             CALL       PGM(HP85001)

/*-----------------------------------------------------------------*/
/*  Call HP85003 to renumber the following files:                  */
/*  HSL037i - Ticket Header                                        */
/*  HSL038b - Ticket Detail                                        */
/*  HSL059a - Feed Pickup                                          */
/*  HSL068c - Killed/Dead Hogs                                     */
/*  HSL069D - Inventory Adjustment                                 */
/*  HSP112  - Farm Health Status                                   */
/*  HSP131  - Farm Feed Overrides                                  */
/*  HSL131A - Farm Feed Overrides                                  */
/*  HSL187A - Template/Farm Links                                  */
/*  HSL188H - Farm Budget Header                                   */
/*  HSP189  - Farm Budget Detail                                   */
/*  HSL192D - Request Header                                       */
/*  HSL196C - Scheduled Load Planning                              */
/*  HSP260  - Safedata Download                                    */
/*  HSL264B - ERM: Download Weekly Hog                             */
/*  HSL269B - Safedata FIN: Reported Weekly Activity Editing       */
/*  HSP270  - ERM: Download Weekly Hog Inventory                   */
/*  HSL282B - Safedata FIN: Reported Daily Activity Editing        */
/*  HSL8188A - Datamart BUD: Closed Budgets                        */
/*  HSL8189B - Datamart BUD: Budget Quantities                     */
/*  HSP8193  - Datamart BUD: Weekly Orders                         */
/*  HSL9061A - UT: History Receiving file for Uploaded Transfers   */
/*  HSL9061B - UT: History Receiving file for Uploaded Transfers   */
/*  HSL9062A - UT: History Editing file for Uploaded Transfers     */
/*  HSL9062B - UT: History Editing file for Uploaded Transfers     */
/*  HSL9063A - UT: History Receiving for Uploaded Transfers-Iowa   */
/*  HSL9063B - UT: History Receiving for Uploaded Transfers-Iowa   */
/*  HSL9064A - UT: History Edit file for Uploaded Transfers-Iowa   */
/*  HSL9064B - UT: History Edit file for Uploaded Transfers-Iowa   */
/*  HSL9066A - UC: History Receiving file for Uploaded CullSales   */
/*  HSL9067A - UC: History Editing file for Uploaded CullSales     */
/*  HSL9068A - UC: History Receiving for Uploaded CullSales-Iowa   */
/*  HSL9069A - UC: History Edit file for Uploaded CullSales-Iowa   */
/*  HSL9082B - Scheduled Movements Editing History LF              */
/*  HSP9131  - Farm Feed Overrides                                 */
/*  HSL9131A - Farm Feed Overrides                                 */
/*  HSL934A  - Purged Hog Groups                                   */
/*  HSL934B  - Purged Hog Groups                                   */
/*  HSL935A  - UF: Uploaded Feed Tickets--History Receiving File   */
/*  HSP982   - Safedata/WEB BGF: Daily Production History          */
/*  HSP986   - Safedata/WEB BGF: Weekly Wean Projections History   */
/*  HSP992   - Safedata/WEB BGF: Weekly Production History         */
/*-----------------------------------------------------------------*/
             CALL       PGM(HP85007)

/*-----------------------------------------------------------------*/
/*  Call HP85006 to renumber the following files:                  */
/*  HPLB082B - Datamart BGF: Daily Production                      */
/*  HPLB092B - Datamart BGF: Weekly Production                     */
/*  HPLB192A - Datamart BGF: Wean Pig Projections                  */
/*  HPLA034C - Datamart ALL: Group Header Key: Farm Site           */
/*  HPLA034D - Datamart ALL: Group Header Key: Orig BGF Farm Site  */
/*  HPLA174A - Datamart ALL: Farm Production Key: Farm Site        */
/*  HPLB182B - Datamart BGF: Period Production By Farm Site        */
/*  HPLA100  - Datamart ALL: HPS -JDE Expense File                 */
/*-----------------------------------------------------------------*/

             /*  Run over current library list                     */

             /*  PRKFLIB files will be updated by HP85006          */
             /*  ========================================          */

             CALL       PGM(HP85006)

/*-----------------------------------------------------------------*/
/* Add PRKDMFLIB or TSTDMFLIB to the top of the library list.      */
/* We do not expect PRKDMFLIB or TSTDMFLIB to be in the library    */
/* list, but, since we want it at the top of the list, we will     */
/* but, since we want it at the top of the list, we will           */
/* remove/add it.                                                  */
/*-----------------------------------------------------------------*/

             /*  Determine if running in test or production        */
             RTVDTAARA  DTAARA(DATSTPRD (1 1)) RTNVAR(&TSTPRDFL)

             IF         COND(&TSTPRDFL *EQ 'T') THEN(DO)   /* Test */
                RMVLIBLE   LIB(TSTDMFLIB)
                MONMSG     MSGID(CPF0000)
                ADDLIBLE   LIB(TSTDMFLIB)
             ENDDO

             IF         COND(&TSTPRDFL *EQ 'P') THEN(DO)   /* Prod */
                RMVLIBLE   LIB(PRKDMFLIB)
                MONMSG     MSGID(CPF0000)
                ADDLIBLE   LIB(PRKDMFLIB)
             ENDDO

             /*  Run over Data Mart library list                   */
             /*  ========================================          */

             CALL       PGM(HP85006)

             POPLIBL35

 ENDIT:      ENDPGM
