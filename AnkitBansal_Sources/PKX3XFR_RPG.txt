     H/TITLE On Demand Compet Tot XF   Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:08:58
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPLAIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Kill/Tattoo Active
      *
     FPKDGCPL2IF  E           K        DISK
      * RSQ : Competitors Tattoo        Tattoo/Cmp
      *
     FPKDGCPL3IF  E           K        DISK
      * RSQ : Competitors Tattoo       Tattoo/Cmp Requested/Yes
      *
     FPKARREL4IF  E           K        DISK
      * RSQ : Carcass Merit Program     CMP Competitors only
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKDGCPL0UF  E           K        DISK
      * UPD : Competitors Tattoo        Update index
      *
     FPKDFREL0IF  E           K        DISK                      A
      * UPD : Competitors Total         Update index
      *
     I@A1CPL0
      * Tattoo Header             Co/Kill/Tattoo Active
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@DGCPTP
      * Competitors Tattoo        Tattoo/Cmp
      * Renamed input format fields
     I              DGAMCD                          WBAMCD
     I              DGHMNB                          WBHMNB
     I              DGBNNB                          WBBNNB
     I              DGBONB                          WBBONB
     I              DGCVNB                          WBCVNB
     I              DGB0DT                          WBB0DT
     I              DGMHST                          WBMHST
     I              DGF4PC                          WBF4PC
     I              DGG5PR                          WBG5PR
     I              DGJPPR                          WBJPPR
     I              DGG6PR                          WBG6PR
     I              DGJQPR                          WBJQPR
     I              DGG7PR                          WBG7PR
     I              DGJRPR                          WBJRPR
     I              DGJUPR                          WBJUPR
     I              DGJVPR                          WBJVPR
     I              DGG8PR                          WBG8PR
     I              DGJSPR                          WBJSPR
     I              DGG9PR                          WBG9PR
     I              DGJTPR                          WBJTPR
     I              DGAAVN                          WBAAVN
     I              DGAADT                          WBAADT
     I              DGAMTM                          WBAMTM
     I              DGAJST                          WBAJST
     I              DGAHVN                          WBAHVN
     I              DGAGVN                          WBAGVN
     I              DGABVN                          WBABVN
     I              DGABDT                          WBABDT
     I              DGABTM                          WBABTM
      *
     I@DGCPTJ
      * Competitors Tattoo        Update index
      * Renamed input format fields
     I              DGAMCD                          WCAMCD
     I              DGHMNB                          WCHMNB
     I              DGBNNB                          WCBNNB
     I              DGBONB                          WCBONB
     I              DGCVNB                          WCCVNB
     I              DGB0DT                          WCB0DT
     I              DGMHST                          WCMHST
     I              DGF4PC                          WCF4PC
     I              DGG5PR                          WCG5PR
     I              DGJPPR                          WCJPPR
     I              DGG6PR                          WCG6PR
     I              DGJQPR                          WCJQPR
     I              DGG7PR                          WCG7PR
     I              DGJRPR                          WCJRPR
     I              DGJUPR                          WCJUPR
     I              DGJVPR                          WCJVPR
     I              DGG8PR                          WCG8PR
     I              DGJSPR                          WCJSPR
     I              DGG9PR                          WCG9PR
     I              DGJTPR                          WCJTPR
     I              DGAAVN                          WCAAVN
     I              DGAADT                          WCAADT
     I              DGAMTM                          WCAMTM
     I              DGAJST                          WCAJST
     I              DGAHVN                          WCAHVN
     I              DGAGVN                          WCAGVN
     I              DGABVN                          WCABVN
     I              DGABDT                          WCABDT
     I              DGABTM                          WCABTM
      *
     I@DGCPTQ
      * Competitors Tattoo       Tattoo/Cmp Requested/Yes
      * Renamed input format fields
     I              DGAMCD                          WDAMCD
     I              DGHMNB                          WDHMNB
     I              DGBNNB                          WDBNNB
     I              DGBONB                          WDBONB
     I              DGCVNB                          WDCVNB
     I              DGB0DT                          WDB0DT
     I              DGMHST                          WDMHST
     I              DGF4PC                          WDF4PC
     I              DGG5PR                          WDG5PR
     I              DGJPPR                          WDJPPR
     I              DGG6PR                          WDG6PR
     I              DGJQPR                          WDJQPR
     I              DGG7PR                          WDG7PR
     I              DGJRPR                          WDJRPR
     I              DGJUPR                          WDJUPR
     I              DGJVPR                          WDJVPR
     I              DGG8PR                          WDG8PR
     I              DGJSPR                          WDJSPR
     I              DGG9PR                          WDG9PR
     I              DGJTPR                          WDJTPR
     I              DGAAVN                          WDAAVN
     I              DGAADT                          WDAADT
     I              DGAMTM                          WDAMTM
     I              DGAJST                          WDAJST
     I              DGAHVN                          WDAHVN
     I              DGAGVN                          WDAGVN
     I              DGABVN                          WDABVN
     I              DGABDT                          WDABDT
     I              DGABTM                          WDABTM
      *
     I@ARRETN
      * Carcass Merit Program     CMP Competitors only
      * Renamed input format fields
     I              ARAMCD                          WEAMCD
     I              ARA3TX                          WEA3TX
     I              ARDLST                          WEDLST
     I              ARDMST                          WEDMST
     I              ARDOST                          WEDOST
     I              ARDQST                          WEDQST
     I              ARAZPC                          WEAZPC
     I              ARA0PC                          WEA0PC
     I              ARDTST                          WEDTST
     I              ARF5ST                          WEF5ST
     I              ARI1PR                          WEI1PR
     I              ARVEPR                          WEVEPR
     I              ARVFPR                          WEVFPR
     I              ARVHPR                          WEVHPR
     I              ARVIPR                          WEVIPR
     I              ARVJPR                          WEVJPR
     I              ARZ2ST                          WEZ2ST
     I              ARZ3ST                          WEZ3ST
     I              ARZ4ST                          WEZ4ST
     I              ARAAVN                          WEAAVN
     I              ARAADT                          WEAADT
     I              ARAMTM                          WEAMTM
     I              ARAJST                          WEAJST
     I              ARAHVN                          WEAHVN
     I              ARAGVN                          WEAGVN
     I              ARABVN                          WEABVN
     I              ARABDT                          WEABDT
     I              ARABTM                          WEABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WFHMNB
     I              A1BNNB                          WFBNNB
     I              A1BONB                          WFBONB
     I              A1CVNB                          WFCVNB
     I              A1B0DT                          WFB0DT
     I              A1AWDT                          WFAWDT
     I              A1BICD                          WFBICD
     I              A1CPST                          WFCPST
     I              A1ACPR                          WFACPR
     I              A1B9PR                          WFB9PR
     I              A1CAPR                          WFCAPR
     I              A1C4ST                          WFC4ST
     I              A1AIPR                          WFAIPR
     I              A1A6DT                          WFA6DT
     I              A1C2ST                          WFC2ST
     I              A1CXNB                          WFCXNB
     I              A1CWNB                          WFCWNB
     I              A1FCNB                          WFFCNB
     I              A1H9NB                          WFH9NB
     I              A1FDNB                          WFFDNB
     I              A1FENB                          WFFENB
     I              A1HENB                          WFHENB
     I              A1HFNB                          WFHFNB
     I              A1CYNB                          WFCYNB
     I              A1LRNB                          WFLRNB
     I              A1E0NB                          WFE0NB
     I              A1A5PC                          WFA5PC
     I              A1FBNB                          WFFBNB
     I              A1A4PC                          WFA4PC
     I              A1F7NB                          WFF7NB
     I              A1HDNB                          WFHDNB
     I              A1F5NB                          WFF5NB
     I              A1F4NB                          WFF4NB
     I              A1F3NB                          WFF3NB
     I              A1F2NB                          WFF2NB
     I              A1AVPC                          WFAVPC
     I              A1AWPC                          WFAWPC
     I              A1CWPC                          WFCWPC
     I              A1A8PC                          WFA8PC
     I              A1A7PC                          WFA7PC
     I              A1B8PR                          WFB8PR
     I              A1AMPR                          WFAMPR
     I              A1ANPR                          WFANPR
     I              A1AYVA                          WFAYVA
     I              A1AWVA                          WFAWVA
     I              A1AOPR                          WFAOPR
     I              A1AXVA                          WFAXVA
     I              A1APPR                          WFAPPR
     I              A1ASPR                          WFASPR
     I              A1A4VA                          WFA4VA
     I              A1ATPR                          WFATPR
     I              A1A5VA                          WFA5VA
     I              A1CBPR                          WFCBPR
     I              A1CCPR                          WFCCPR
     I              A1LPNB                          WFLPNB
     I              A1CDPR                          WFCDPR
     I              A1A7VA                          WFA7VA
     I              A1A2PR                          WFA2PR
     I              A1JWST                          WFJWST
     I              A1CWST                          WFCWST
     I              A1D7ST                          WFD7ST
     I              A1D8ST                          WFD8ST
     I              A1DWST                          WFDWST
     I              A1D6ST                          WFD6ST
     I              A1GHNB                          WFGHNB
     I              A1BYDT                          WFBYDT
     I              A1E0ST                          WFE0ST
     I              A1E1ST                          WFE1ST
     I              A1E2ST                          WFE2ST
     I              A1BSDT                          WFBSDT
     I              A1BTDT                          WFBTDT
     I              A1BUDT                          WFBUDT
     I              A1HGNB                          WFHGNB
     I              A1HHNB                          WFHHNB
     I              A1HINB                          WFHINB
     I              A1A3PR                          WFA3PR
     I              A1A4PR                          WFA4PR
     I              A1A6PR                          WFA6PR
     I              A1J9NB                          WFJ9NB
     I              A1D6PR                          WFD6PR
     I              A1D7PR                          WFD7PR
     I              A1D8PR                          WFD8PR
     I              A1D9PR                          WFD9PR
     I              A1EAPR                          WFEAPR
     I              A1EBPR                          WFEBPR
     I              A1ECPR                          WFECPR
     I              A1EDPR                          WFEDPR
     I              A1EEPR                          WFEEPR
     I              A1EFPR                          WFEFPR
     I              A1EGPR                          WFEGPR
     I              A1EHPR                          WFEHPR
     I              A1KAST                          WFKAST
     I              A1J7ST                          WFJ7ST
     I              A1J9ST                          WFJ9ST
     I              A1OXNB                          WFOXNB
     I              A1LKST                          WFLKST
     I              A1LLST                          WFLLST
     I              A1J8ST                          WFJ8ST
     I              A1LIST                          WFLIST
     I              A1LJST                          WFLJST
     I              A1NZTX                          WFNZTX
     I              A1HJCD                          WFHJCD
     I              A1R4ST                          WFR4ST
     I              A1R5ST                          WFR5ST
     I              A1R6ST                          WFR6ST
     I              A1R7ST                          WFR7ST
     I              A1THWT                          WFTHWT
     I              A1T2WT                          WFT2WT
     I              A1THHD                          WFTHHD
     I              A1T2HD                          WFT2HD
     I              A1OBPR                          WFOBPR
     I              A1KOER                          WFKOER
     I              A1OPIR                          WFOPIR
     I              A1OPEM                          WFOPEM
     I              A1IORP                          WFIORP
     I              A1OWEO                          WFOWEO
     I              A1OQET                          WFOQET
     I              A1URST                          WFURST
     I              A1USST                          WFUSST
     I              A1HHPC                          WFHHPC
     I              A1S9PR                          WFS9PR
     I              A1TAPR                          WFTAPR
     I              A1TBPR                          WFTBPR
     I              A1JFUR                          WFJFUR
     I              A1KRIF                          WFKRIF
     I              A1KORF                          WFKORF
     I              A1KAPR                          WFKAPR
     I              A1KROT                          WFKROT
     I              A1OTJG                          WFOTJG
     I              A1IRJG                          WFIRJG
     I              A1IMJF                          WFIMJF
     I              A1IRGF                          WFIRGF
     I              A1KRJF                          WFKRJF
     I              A1OJRF                          WFOJRF
     I              A1KFOR                          WFKFOR
     I              A1ORJK                          WFORJK
     I              A1OMVJ                          WFOMVJ
     I              A1MVNF                          WFMVNF
     I              A1MCNF                          WFMCNF
     I              A1NCNF                          WFNCNF
     I              A1NCHF                          WFNCHF
     I              A1IGIR                          WFIGIR
     I              A1KFJR                          WFKFJR
     I              A1EADT                          WFEADT
     I              A1EBDT                          WFEBDT
     I              A1ECDT                          WFECDT
     I              A1EDDT                          WFEDDT
     I              A1EEDT                          WFEEDT
     I              A1U4ST                          WFU4ST
     I              A1U5ST                          WFU5ST
     I              A1U6ST                          WFU6ST
     I              A1U7ST                          WFU7ST
     I              A1U8ST                          WFU8ST
     I              A1U9ST                          WFU9ST
     I              A1VAST                          WFVAST
     I              A1VBST                          WFVBST
     I              A1BDCD                          WFBDCD
     I              A1CSCD                          WFCSCD
     I              A1ABCD                          WFABCD
     I              A1AECD                          WFAECD
     I              A1ACCD                          WFACCD
     I              A1AGCD                          WFAGCD
     I              A1BECD                          WFBECD
     I              A1AAVN                          WFAAVN
     I              A1AADT                          WFAADT
     I              A1AMTM                          WFAMTM
     I              A1AJST                          WFAJST
     I              A1AHVN                          WFAHVN
     I              A1AGVN                          WFAGVN
     I              A1ABVN                          WFABVN
     I              A1ABDT                          WFABDT
     I              A1ABTM                          WFABTM
      *
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WGABCD
     I              AFAECD                          WGAECD
     I              AFA8TX                          WGA8TX
     I              AFGLNB                          WGGLNB
     I              AFATST                          WGATST
     I              AFASNB                          WGASNB
     I              AFAUST                          WGAUST
     I              AFQNST                          WGQNST
     I              AFQOST                          WGQOST
     I              AFQPST                          WGQPST
     I              AFQQST                          WGQQST
     I              AFQRST                          WGQRST
     I              AFN0TX                          WGN0TX
     I              AFQSST                          WGQSST
     I              AFQTST                          WGQTST
     I              AFQUST                          WGQUST
     I              AFQVST                          WGQVST
     I              AFR8ST                          WGR8ST
     I              AFR9ST                          WGR9ST
     I              AFSAST                          WGSAST
     I              AFSBST                          WGSBST
     I              AFSDST                          WGSDST
     I              AFSEST                          WGSEST
     I              AFSFST                          WGSFST
     I              AFHWNB                          WGHWNB
     I              AFFUCD                          WGFUCD
     I              AFAAVN                          WGAAVN
     I              AFAADT                          WGAADT
     I              AFAMTM                          WGAMTM
     I              AFAJST                          WGAJST
     I              AFAHVN                          WGAHVN
     I              AFAGVN                          WGAGVN
     I              AFABVN                          WGABVN
     I              AFABDT                          WGABDT
     I              AFABTM                          WGABTM
      *
     I@DFRETG
      * Competitors Total         Update index
      * Renamed input format fields
     I              DFHMNB                          WHHMNB
     I              DFBNNB                          WHBNNB
     I              DFBONB                          WHBONB
     I              DFCVNB                          WHCVNB
     I              DFB0DT                          WHB0DT
     I              DFKATX                          WHKATX
     I              DFMEST                          WHMEST
     I              DFGEPR                          WHGEPR
     I              DFGKPR                          WHGKPR
     I              DFGQPR                          WHGQPR
     I              DFGWPR                          WHGWPR
     I              DFG2PR                          WHG2PR
     I              DFGBPR                          WHGBPR
     I              DFGHPR                          WHGHPR
     I              DFGNPR                          WHGNPR
     I              DFGTPR                          WHGTPR
     I              DFGZPR                          WHGZPR
     I              DFGCPR                          WHGCPR
     I              DFGIPR                          WHGIPR
     I              DFGOPR                          WHGOPR
     I              DFGUPR                          WHGUPR
     I              DFG0PR                          WHG0PR
     I              DFGDPR                          WHGDPR
     I              DFGJPR                          WHGJPR
     I              DFGPPR                          WHGPPR
     I              DFGVPR                          WHGVPR
     I              DFG1PR                          WHG1PR
     I              DFGFPR                          WHGFPR
     I              DFGLPR                          WHGLPR
     I              DFGRPR                          WHGRPR
     I              DFGXPR                          WHGXPR
     I              DFG3PR                          WHG3PR
     I              DFGGPR                          WHGGPR
     I              DFGMPR                          WHGMPR
     I              DFGSPR                          WHGSPR
     I              DFGYPR                          WHGYPR
     I              DFG4PR                          WHG4PR
     I              DFZ0NB                          WHZ0NB
     I              DFZ1NB                          WHZ1NB
     I              DFZ2NB                          WHZ2NB
     I              DFAACD                          WHAACD
     I              DFABCD                          WHABCD
     I              DFAECD                          WHAECD
     I              DFFUCD                          WHFUCD
     I              DFAAVN                          WHAAVN
     I              DFAADT                          WHAADT
     I              DFAMTM                          WHAMTM
     I              DFAJST                          WHAJST
     I              DFAHVN                          WHAHVN
     I              DFAGVN                          WHAGVN
     I              DFABVN                          WHABVN
     I              DFABDT                          WHABDT
     I              DFABTM                          WHABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKDG1    E DSPKDGCPL0
      * UPD : Competitors Tattoo        Update index
      * Renamed input format fields
     I              DGAMCD                          WCAMCD
     I              DGHMNB                          WCHMNB
     I              DGBNNB                          WCBNNB
     I              DGBONB                          WCBONB
     I              DGCVNB                          WCCVNB
     I              DGB0DT                          WCB0DT
     I              DGMHST                          WCMHST
     I              DGF4PC                          WCF4PC
     I              DGG5PR                          WCG5PR
     I              DGJPPR                          WCJPPR
     I              DGG6PR                          WCG6PR
     I              DGJQPR                          WCJQPR
     I              DGG7PR                          WCG7PR
     I              DGJRPR                          WCJRPR
     I              DGJUPR                          WCJUPR
     I              DGJVPR                          WCJVPR
     I              DGG8PR                          WCG8PR
     I              DGJSPR                          WCJSPR
     I              DGG9PR                          WCG9PR
     I              DGJTPR                          WCJTPR
     I              DGAAVN                          WCAAVN
     I              DGAADT                          WCAADT
     I              DGAMTM                          WCAMTM
     I              DGAJST                          WCAJST
     I              DGAHVN                          WCAHVN
     I              DGAGVN                          WCAGVN
     I              DGABVN                          WCABVN
     I              DGABDT                          WCABDT
     I              DGABTM                          WCABTM
      *
     IYARDCS      DS                            116
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            116
     IYCRDCS      DS                            116
     IYDRDCS      DS                            116
     IQPKDF1    E DSPKDFREL0
      * UPD : Competitors Total         Update index
      * Renamed input format fields
     I              DFHMNB                          WHHMNB
     I              DFBNNB                          WHBNNB
     I              DFBONB                          WHBONB
     I              DFCVNB                          WHCVNB
     I              DFB0DT                          WHB0DT
     I              DFKATX                          WHKATX
     I              DFMEST                          WHMEST
     I              DFGEPR                          WHGEPR
     I              DFGKPR                          WHGKPR
     I              DFGQPR                          WHGQPR
     I              DFGWPR                          WHGWPR
     I              DFG2PR                          WHG2PR
     I              DFGBPR                          WHGBPR
     I              DFGHPR                          WHGHPR
     I              DFGNPR                          WHGNPR
     I              DFGTPR                          WHGTPR
     I              DFGZPR                          WHGZPR
     I              DFGCPR                          WHGCPR
     I              DFGIPR                          WHGIPR
     I              DFGOPR                          WHGOPR
     I              DFGUPR                          WHGUPR
     I              DFG0PR                          WHG0PR
     I              DFGDPR                          WHGDPR
     I              DFGJPR                          WHGJPR
     I              DFGPPR                          WHGPPR
     I              DFGVPR                          WHGVPR
     I              DFG1PR                          WHG1PR
     I              DFGFPR                          WHGFPR
     I              DFGLPR                          WHGLPR
     I              DFGRPR                          WHGRPR
     I              DFGXPR                          WHGXPR
     I              DFG3PR                          WHG3PR
     I              DFGGPR                          WHGGPR
     I              DFGMPR                          WHGMPR
     I              DFGSPR                          WHGSPR
     I              DFGYPR                          WHGYPR
     I              DFG4PR                          WHG4PR
     I              DFZ0NB                          WHZ0NB
     I              DFZ1NB                          WHZ1NB
     I              DFZ2NB                          WHZ2NB
     I              DFAACD                          WHAACD
     I              DFABCD                          WHABCD
     I              DFAECD                          WHAECD
     I              DFFUCD                          WHFUCD
     I              DFAAVN                          WHAAVN
     I              DFAADT                          WHAADT
     I              DFAMTM                          WHAMTM
     I              DFAJST                          WHAJST
     I              DFAHVN                          WHAHVN
     I              DFAGVN                          WHAGVN
     I              DFABVN                          WHABVN
     I              DFABDT                          WHABDT
     I              DFABTM                          WHABTM
      *
     IYERDCS      DS                            116
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Competitors Total
      * I : MAP BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP TH Tattoo Number
     I                                    P   3   50P1CVNB
      * I : MAP TH Kill Date
     I                                    P   6   90P1B0DT
      * I : MAP CT Source Type
     I                                       10  10 P1MEST
      * I : MAP SR Source Code
     I                                       11  13 P1AACD
      * I : MAP PD Producer Code
     I                                       14  19 P1ABCD
      * I : MAP FZ Code
     I                                       20  25 P1FUCD
     IP2PARM      DS
      * I : MAP Kill Date Usr
     I                                    P   1   40P2CGDT
     IP3PARM      DS
      * I :  Price Type USR
     I                                        1   1 P3T4ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1CVNB    PARM           WP0002  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0003  70       TH Kill Date
     C           P1MEST    PARM           WP0004  1        CT Source Type
     C           P1AACD    PARM           WP0005  3        SR Source Code
     C           P1ABCD    PARM           WP0006  6        PD Producer Cod
     C           P1FUCD    PARM           WP0007  6        FZ Code
     C           P2CGDT    PARM           WP0008  70       Kill Date Usr
     C           P3T4ST    PARM           WP0009  1        Price Type USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * On Demand Compet Tot XF
      * MODIFICATIONS
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      * Rtv CM Competitor-Dte Rt - Tattoo Header  * 
     C                     EXSR SARVGN
      * Rtv Selected Compt Tat RT - Competitors Tattoo  * 
     C                     EXSR SDRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv CM Competitor-Dte Rt - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WAB0DT           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           BOH Company Num
     C                     Z-ADDP1B0DT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KPSSA     SETLL@A1CPL0                    *
     C           KRSSA     READE@A1CPL0                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Selection
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Date selection
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TH Kill Date LT PAR.TH Kill Date
      *   |- c2    : DB1.TH Kill Date GT PAR.Kill Date Usr
      *   '-
     C           WAB0DT    IFLT P1B0DT                     *IF
     C           WAB0DT    ORGT P2CGDT                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.TH Kill Date GT PAR.Kill Date Usr
     C           WAB0DT    IFGT P2CGDT                     *IF
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
      * Source Type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.CT Source Type EQ WRK.Blank USR
     C           P1MEST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Type EQ PAR.CT Source Type
     C           WAKAST    IFEQ P1MEST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Source Code
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.SR Source Code EQ WRK.Blank USR
     C           P1AACD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Code EQ PAR.SR Source Code
     C           WALKST    IFEQ P1AACD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Producer
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.PD Producer Code EQ WRK.Blank USR
     C           P1ABCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: PAR.PD Producer Code EQ DB1.PD Producer Code
     C           P1ABCD    IFEQ WAABCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Tattoo number
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.TH Tattoo Number EQ WRK.Zero USR
     C           P1CVNB    IFEQ WUE9NB                     *IF
     C                     ELSE
      * CASE: DB1.TH Tattoo Number EQ PAR.TH Tattoo Number
     C           WACVNB    IFEQ P1CVNB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Chg Flg/Un Compet Tto  Rt - Competitors Tattoo  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@A1CPL0                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Chg Flg/Un Compet Tto  Rt - Competitors Tattoo  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSB02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSB03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSB04           TH Tattoo Numbe
     C           *LIKE     DEFN WBB0DT    WQSB05           TH Kill Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           BOH Buy Order N
     C                     KFLD           WQSB03           BOL Load Number
     C                     KFLD           WQSB04           TH Tattoo Numbe
     C                     KFLD           WQSB05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSB01           BOH Company Num
     C                     Z-ADDWABNNB    WQSB02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSB03           BOL Load Number
     C                     Z-ADDWACVNB    WQSB04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSB05           TH Kill Date
      * Establish starting position
     C           KRSSB     SETLL@DGCPTP                    *
     C           KRSSB     READE@DGCPTP                  90*
      * Data record not found
     C   90                MOVEL'PRK0570' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Flg/Un Compet Tto CH - Competitors Tattoo  * 
     C                     EXSR SCCHRC
     C           KRSSB     READE@DGCPTP                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Flg/Un Compet Tto CH - Competitors Tattoo  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  52       CCT Base /Live
     C                     Z-ADD*ZERO     WN0002  52       CCT Lean Prem /
     C                     Z-ADD*ZERO     WN0003  52       CCT Yield G/L /
     C                     Z-ADD*ZERO     WN0004  52       CCT Sort Dsc /L
     C                     Z-ADD*ZERO     WN0005  52       CCT Gross /Live
     C                     MOVEL*BLANK    WN0006  1        RS Record Statu
     C                     MOVEL*BLANK    WN0007 10        RS User Added
     C                     Z-ADD*ZERO     WN0008  70       RS Date Added
     C                     Z-ADD*ZERO     WN0009  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @DGCPTJ
     C                     MOVELWBAMCD    WCAMCD    P      CMP Program Cod
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAMCD           CMP Program Cod
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHSC    CHAIN@DGCPTJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDGCPL0'MDACP
     C                     MOVEL'@DGCPTJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDG1    YARDCS
      * Move non-key fields to @DGCPTJ
     C                     MOVEL'Y'       WCMHST    P      CCT Request for
     C                     Z-ADDWBF4PC    WCF4PC           CCT Std Yield
     C                     Z-ADDWBJPPR    WCJPPR           CCT Base /Carc
     C                     Z-ADDWBJQPR    WCJQPR           CCT Lean Prem /
     C                     Z-ADDWBJRPR    WCJRPR           CCT Yield G/L /
     C                     Z-ADDWBJUPR    WCJUPR           CCT Carc Val /L
     C                     Z-ADDWBJVPR    WCJVPR           CCT Carc Val /C
     C                     Z-ADDWBJSPR    WCJSPR           CCT Sort Dsc /C
     C                     Z-ADDWBJTPR    WCJTPR           CCT Gross /Carc
     C                     MOVEL##USR     WCAAVN    P      RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN    P      RS Job
     C                     MOVEL##PGM     WCAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@DGCPTJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Selected Compt Tat RT - Competitors Tattoo  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Rtv Cmp Competitors   RT - Carcass Merit Program  * 
     C                     EXSR SERVGN
     C                     Z-ADD*ZERO     WUHDPR           Cmp Base Live
     C                     Z-ADD*ZERO     WUHEPR           Cmp Lean Premiu
     C                     Z-ADD*ZERO     WUHGPR           Cmp Sort Dsc Li
     C                     Z-ADD*ZERO     WUHFPR           Cmp Yield Gain/
     C                     Z-ADD*ZERO     WUHHPR           CMP Gross Live
      * Establish starting position
     C           *LOVAL    SETLL@DGCPTQ                    *
     C                     READ @DGCPTQ                  90*
      * Data record not found
     C   90                MOVEL'PRK0570' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Tattoo/BOL Break
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.TH Tattoo Number NE DB1.TH Tattoo Number
      *   |- c2    : LCL.BOH Buy Order Number NE DB1.BOH Buy Order Number
      *   '-
     C           YL0001    IFNE WDCVNB                     *IF
     C           YL0002    ORNE WDBNNB                     *OR
     C                     Z-ADD*ZERO     WUHDPR           Cmp Base Live
     C                     Z-ADD*ZERO     WUHEPR           Cmp Lean Premiu
     C                     Z-ADD*ZERO     WUHGPR           Cmp Sort Dsc Li
     C                     Z-ADD*ZERO     WUHFPR           Cmp Yield Gain/
     C                     Z-ADD*ZERO     WUHHPR           CMP Gross Live
     C                     Z-ADDWDBNNB    YL0002           BOH Buy Order N
     C                     Z-ADDWDCVNB    YL0001           TH Tattoo Numbe
     C                     END                             *FI
      * CASE: DB1.CMP Program Code EQ WRK.Competitors Code 1 Usr
     C           WDAMCD    IFEQ WUE7CD                     *IF
      * Competitor 1
     C                     EXSR UASUBR                     Competitor 1
     C                     ELSE
      * CASE: DB1.CMP Program Code EQ WRK.Competitors Code 2 Usr
     C           WDAMCD    IFEQ WUE8CD                     *IF
      * Competitor 2
     C                     EXSR UBSUBR                     Competitor 2
     C                     ELSE
      * CASE: DB1.CMP Program Code EQ WRK.Competitors Code 3 Usr
     C           WDAMCD    IFEQ WUE9CD                     *IF
      * Competitor 3
     C                     EXSR UCSUBR                     Competitor 3
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Flg/Un Compet Tto CH - Competitors Tattoo  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @DGCPTQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Cmp Competitors   RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUP0NB           Count USR
     C                     MOVEL*BLANK    WUE7CD           Competitors Cod
     C                     MOVEL*BLANK    WUE8CD           Competitors Cod
     C                     MOVEL*BLANK    WUE9CD           Competitors Cod
      * Establish starting position
     C           *LOVAL    SETLL@ARRETN                    *
     C                     READ @ARRETN                  90*
      * Data record not found
     C   90                MOVEL'PRK0039' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  001       WUP0NB           Count USR
      * CASE: WRK.Count USR is One
     C           WUP0NB    IFEQ 1                          *IF
     C                     MOVELWEAMCD    WUE7CD           Competitors Cod
     C                     ELSE
      * CASE: WRK.Count USR is Two
     C           WUP0NB    IFEQ 2                          *IF
     C                     MOVELWEAMCD    WUE8CD           Competitors Cod
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUP0NB    IFEQ 3                          *IF
     C                     MOVELWEAMCD    WUE9CD           Competitors Cod
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @ARRETN                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg Flg/Un Compet Tto CH - Competitors Tattoo  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0010  52       CCT Base /Live
     C                     Z-ADD*ZERO     WN0011  52       CCT Lean Prem /
     C                     Z-ADD*ZERO     WN0012  52       CCT Yield G/L /
     C                     Z-ADD*ZERO     WN0013  52       CCT Sort Dsc /L
     C                     Z-ADD*ZERO     WN0014  52       CCT Gross /Live
     C                     MOVEL*BLANK    WN0015  1        RS Record Statu
     C                     MOVEL*BLANK    WN0016 10        RS User Added
     C                     Z-ADD*ZERO     WN0017  70       RS Date Added
     C                     Z-ADD*ZERO     WN0018  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @DGCPTJ
     C                     MOVELWDAMCD    WCAMCD    P      CMP Program Cod
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHSF    KLIST
     C                     KFLD           WCAMCD           CMP Program Cod
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHSF    CHAIN@DGCPTJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDGCPL0'MDACP
     C                     MOVEL'@DGCPTJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDG1    YBRDCS
      * Move non-key fields to @DGCPTJ
     C                     MOVEL*BLANK    WCMHST    P      CCT Request for
     C                     Z-ADDWDF4PC    WCF4PC           CCT Std Yield
     C                     Z-ADDWDJPPR    WCJPPR           CCT Base /Carc
     C                     Z-ADDWDJQPR    WCJQPR           CCT Lean Prem /
     C                     Z-ADDWDJRPR    WCJRPR           CCT Yield G/L /
     C                     Z-ADDWDJUPR    WCJUPR           CCT Carc Val /L
     C                     Z-ADDWDJVPR    WCJVPR           CCT Carc Val /C
     C                     Z-ADDWDJSPR    WCJSPR           CCT Sort Dsc /C
     C                     Z-ADDWDJTPR    WCJTPR           CCT Gross /Carc
     C                     MOVEL##USR     WCAAVN    P      RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN    P      RS Job
     C                     MOVEL##PGM     WCAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@DGCPTJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Flg/Un Compet Tto CH - Competitors Tattoo  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0019  52       CCT Base /Live
     C                     Z-ADD*ZERO     WN0020  52       CCT Lean Prem /
     C                     Z-ADD*ZERO     WN0021  52       CCT Yield G/L /
     C                     Z-ADD*ZERO     WN0022  52       CCT Sort Dsc /L
     C                     Z-ADD*ZERO     WN0023  52       CCT Gross /Live
     C                     MOVEL*BLANK    WN0024  1        RS Record Statu
     C                     MOVEL*BLANK    WN0025 10        RS User Added
     C                     Z-ADD*ZERO     WN0026  70       RS Date Added
     C                     Z-ADD*ZERO     WN0027  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @DGCPTJ
     C                     MOVELWDAMCD    WCAMCD    P      CMP Program Cod
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHSG    KLIST
     C                     KFLD           WCAMCD           CMP Program Cod
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHSG    CHAIN@DGCPTJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDGCPL0'MDACP
     C                     MOVEL'@DGCPTJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDG1    YCRDCS
      * Move non-key fields to @DGCPTJ
     C                     MOVEL*BLANK    WCMHST    P      CCT Request for
     C                     Z-ADDWDF4PC    WCF4PC           CCT Std Yield
     C                     Z-ADDWDJPPR    WCJPPR           CCT Base /Carc
     C                     Z-ADDWDJQPR    WCJQPR           CCT Lean Prem /
     C                     Z-ADDWDJRPR    WCJRPR           CCT Yield G/L /
     C                     Z-ADDWDJUPR    WCJUPR           CCT Carc Val /L
     C                     Z-ADDWDJVPR    WCJVPR           CCT Carc Val /C
     C                     Z-ADDWDJSPR    WCJSPR           CCT Sort Dsc /C
     C                     Z-ADDWDJTPR    WCJTPR           CCT Gross /Carc
     C                     MOVEL##USR     WCAAVN    P      RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN    P      RS Job
     C                     MOVEL##PGM     WCAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@DGCPTJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Flg/Un Compet Tto CH - Competitors Tattoo  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0028  52       CCT Base /Live
     C                     Z-ADD*ZERO     WN0029  52       CCT Lean Prem /
     C                     Z-ADD*ZERO     WN0030  52       CCT Yield G/L /
     C                     Z-ADD*ZERO     WN0031  52       CCT Sort Dsc /L
     C                     Z-ADD*ZERO     WN0032  52       CCT Gross /Live
     C                     MOVEL*BLANK    WN0033  1        RS Record Statu
     C                     MOVEL*BLANK    WN0034 10        RS User Added
     C                     Z-ADD*ZERO     WN0035  70       RS Date Added
     C                     Z-ADD*ZERO     WN0036  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @DGCPTJ
     C                     MOVELWDAMCD    WCAMCD    P      CMP Program Cod
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHSH    KLIST
     C                     KFLD           WCAMCD           CMP Program Cod
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHSH    CHAIN@DGCPTJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDGCPL0'MDACP
     C                     MOVEL'@DGCPTJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDG1    YDRDCS
      * Move non-key fields to @DGCPTJ
     C                     MOVEL*BLANK    WCMHST    P      CCT Request for
     C                     Z-ADDWDF4PC    WCF4PC           CCT Std Yield
     C                     Z-ADDWDJPPR    WCJPPR           CCT Base /Carc
     C                     Z-ADDWDJQPR    WCJQPR           CCT Lean Prem /
     C                     Z-ADDWDJRPR    WCJRPR           CCT Yield G/L /
     C                     Z-ADDWDJUPR    WCJUPR           CCT Carc Val /L
     C                     Z-ADDWDJVPR    WCJVPR           CCT Carc Val /C
     C                     Z-ADDWDJSPR    WCJSPR           CCT Sort Dsc /C
     C                     Z-ADDWDJTPR    WCJTPR           CCT Gross /Carc
     C                     MOVEL##USR     WCAAVN    P      RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN    P      RS Job
     C                     MOVEL##PGM     WCAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@DGCPTJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Competitor Actual - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWDHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WFBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WFB0DT           TH Kill Date
      * Establish starting position
     C           KRSSI     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFFENB    WUFENB           TH Head Killed
     C                     Z-ADDWFCYNB    WUCYNB           TH Live Wgt
     C                     Z-ADDWFE0NB    WUE0NB           TH Hot Wgt
     C                     Z-ADDWFD6PR    WUD6PR           TH CM Bse Mkt L
     C                     Z-ADDWFD7PR    WUD7PR           TH CM Bse Mkt C
     C                     Z-ADDWFD8PR    WUD8PR           TH CM Srt Dsc L
     C                     Z-ADDWFD9PR    WUD9PR           TH CM Srt Dsc C
     C                     Z-ADDWFEAPR    WUEAPR           TH CM Yld G/L L
     C                     Z-ADDWFEBPR    WUEBPR           TH CM Yld G/L C
     C                     Z-ADDWFECPR    WUECPR           TH CM Crc Val L
     C                     Z-ADDWFEDPR    WUEDPR           TH CM Crc Val C
     C                     Z-ADDWFEEPR    WUEEPR           TH CM Lean Prem
     C                     Z-ADDWFEFPR    WUEFPR           TH CM Lean Prem
     C                     Z-ADDWFEGPR    WUEGPR           TH CM Gross Liv
     C                     Z-ADDWFEHPR    WUEHPR           TH CM Gross Car
     C                     MOVELWFKAST    WUKAST           TH Source Type
     C                     MOVELWFLKST    WULKST           TH Source Code
     C                     MOVELWFABCD    WUABCD           PD Producer Cod
     C                     MOVELWFAECD    WUAECD           PL Location Cod
      * CASE: DB1.TH Payment Sts is Live anything
     C           WFCWST    IFEQ 'ML'                       *IF
     C           WFCWST    OREQ 'PL'
     C           WFCWST    OREQ 'NL'
     C           WFCWST    OREQ 'SL'
     C           WFCWST    OREQ 'IL'
      * CASE: PAR.Price Type USR is Live Hundred Weight
     C           P3T4ST    IFEQ 'L'                        *IF
      * Per Carl T. in Guymon  -- If paid Live show live
     C                     Z-ADDWFACPR    WUD6PR           TH CM Bse Mkt L
     C                     Z-ADDWFACPR    WUEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WUD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WUEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WUECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WUEEPR           TH CM Lean Prem
     C                     ELSE
      * CASE: PAR.Price Type USR is Carcass Hundred Weight
     C           P3T4ST    IFEQ 'C'                        *IF
      * TH CM Base Mkt Carc /CWT
      * PAR.TH CM Bse Mkt Carc /CWT =
      *    *COMPUTE (x1 / (x2 /x3))
      * x1    : DB1.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WFE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           WFCBPR    DIV  W0WA01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUD7PR           TH CM Bse Mkt C
      * TH CM Gross Carc /CWT
      * PAR.TH CM Gross Carc /CWT =
      *    *COMPUTE (x1 / (x2 /x3))
      * x1    : DB1.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WFE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           WFCBPR    DIV  W0WA01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WUD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WUEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WUEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WUEFPR           TH CM Lean Prem
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Pdctn Loc FrghtZn RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WGABCD           PD Producer Cod
     C                     KFLD           WGAECD           PL Location Cod
      * Setup key
     C                     MOVELWUABCD    WGABCD           PD Producer Cod
     C                     MOVELWUAECD    WGAECD           PL Location Cod
      * Establish starting position
     C           KRSSJ     CHAIN@AFREAR              90    *
      * Data record not found
     C   90                MOVEL'PRK0015' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGFUCD    WUFUCD           FZ Code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Create Competitors Total - Competitors Total  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DFRETG
     C                     Z-ADDWDHMNB    WHHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WHBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WHCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WHB0DT           TH Kill Date
     C                     MOVEL*BLANK    WHKATX           CT Report Break
     C                     MOVELWUKAST    WHMEST           CT Source Type
     C                     Z-ADDWUGEPR    WHGEPR           CT Base Actual
     C                     Z-ADDWUGKPR    WHGKPR           CT Lean Prem Ac
     C                     Z-ADDWUGQPR    WHGQPR           CT Yield Gain/L
     C                     Z-ADDWUGWPR    WHGWPR           CT Sort Dsc Act
     C                     Z-ADDWUG2PR    WHG2PR           CT Total Actual
     C                     Z-ADDWUGBPR    WHGBPR           CT Base 1
     C                     Z-ADDWUGHPR    WHGHPR           CT Lean Prem 1
     C                     Z-ADDWUGNPR    WHGNPR           CT Yield Gain/L
     C                     Z-ADDWUGTPR    WHGTPR           CT Sort Dsc 1
     C                     Z-ADDWUGZPR    WHGZPR           CT Total 1
     C                     Z-ADDWUGCPR    WHGCPR           CT Base 2
     C                     Z-ADDWUGIPR    WHGIPR           CT Lean Prem 2
     C                     Z-ADDWUGOPR    WHGOPR           CT Yield Gain/L
     C                     Z-ADDWUGUPR    WHGUPR           CT Sort Dsc 2
     C                     Z-ADDWUG0PR    WHG0PR           CT Total 2
     C                     Z-ADDWUGDPR    WHGDPR           CT Base 3
     C                     Z-ADDWUGJPR    WHGJPR           CT Lean Prem 3
     C                     Z-ADDWUGPPR    WHGPPR           CT Yield Gain/L
     C                     Z-ADDWUGVPR    WHGVPR           CT Sort Dsc 3
     C                     Z-ADDWUG1PR    WHG1PR           CT Total 3
     C                     Z-ADDWUGFPR    WHGFPR           CT Base Average
     C                     Z-ADDWUGLPR    WHGLPR           CT Lean Prem Av
     C                     Z-ADDWUGRPR    WHGRPR           CT Yield Gain/L
     C                     Z-ADDWUGXPR    WHGXPR           CT Sort Dsc Ave
     C                     Z-ADDWUG3PR    WHG3PR           CT Total Avg
     C                     Z-ADDWUGGPR    WHGGPR           CT Base Varianc
     C                     Z-ADDWUGMPR    WHGMPR           CT Lean Prem Va
     C                     Z-ADDWUGSPR    WHGSPR           CT Yield Gain/L
     C                     Z-ADDWUGYPR    WHGYPR           CT Sort Dsc Var
     C                     Z-ADDWUG4PR    WHG4PR           CT Total Varian
     C                     Z-ADDWUE0NB    WHZ0NB           CT Hot Weight
     C                     Z-ADDWUCYNB    WHZ1NB           CT Live Weight
     C                     Z-ADDWUFENB    WHZ2NB           CT Head Killed
     C                     MOVELWULKST    WHAACD           SR Source Code
     C                     MOVELWUABCD    WHABCD           PD Producer Cod
     C                     MOVELWUAECD    WHAECD           PL Location Cod
     C                     MOVELWUFUCD    WHFUCD           FZ Code
     C                     MOVEL*BLANK    WHAAVN           RS User Changed
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     MOVEL'A'       WHAJST           RS Record Statu
     C                     MOVEL##JOB     WHAHVN           RS Job
     C                     MOVEL##PGM     WHAGVN           RS Program
     C                     MOVEL##USR     WHABVN           RS User Added
     C                     Z-ADD##JDT     WHABDT           RS Date Added
     C                     Z-ADD##JTM     WHABTM           RS Time Added
      *
     C           KLCRSK    KLIST
     C                     KFLD           WHHMNB           BOH Company Num
     C                     KFLD           WHBNNB           BOH Buy Order N
     C                     KFLD           WHBONB           BOL Load Number
     C                     KFLD           WHCVNB           TH Tattoo Numbe
     C                     KFLD           WHB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRSK    SETLL@DFRETG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0569' W0RTN   7
      * Send message 'Competitors Total      EX'
     C                     MOVEL'PRK0569' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@DFRETG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Flg/Un Compet Tto CH - Competitors Tattoo  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0037  52       CCT Base /Live
     C                     Z-ADD*ZERO     WN0038  52       CCT Lean Prem /
     C                     Z-ADD*ZERO     WN0039  52       CCT Yield G/L /
     C                     Z-ADD*ZERO     WN0040  52       CCT Sort Dsc /L
     C                     Z-ADD*ZERO     WN0041  52       CCT Gross /Live
     C                     MOVEL*BLANK    WN0042  1        RS Record Statu
     C                     MOVEL*BLANK    WN0043 10        RS User Added
     C                     Z-ADD*ZERO     WN0044  70       RS Date Added
     C                     Z-ADD*ZERO     WN0045  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @DGCPTJ
     C                     MOVELWDAMCD    WCAMCD    P      CMP Program Cod
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHSL    KLIST
     C                     KFLD           WCAMCD           CMP Program Cod
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHSL    CHAIN@DGCPTJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDGCPL0'MDACP
     C                     MOVEL'@DGCPTJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDG1    YERDCS
      * Move non-key fields to @DGCPTJ
     C                     MOVEL*BLANK    WCMHST    P      CCT Request for
     C                     Z-ADDWDF4PC    WCF4PC           CCT Std Yield
     C                     Z-ADDWDJPPR    WCJPPR           CCT Base /Carc
     C                     Z-ADDWDJQPR    WCJQPR           CCT Lean Prem /
     C                     Z-ADDWDJRPR    WCJRPR           CCT Yield G/L /
     C                     Z-ADDWDJUPR    WCJUPR           CCT Carc Val /L
     C                     Z-ADDWDJVPR    WCJVPR           CCT Carc Val /C
     C                     Z-ADDWDJSPR    WCJSPR           CCT Sort Dsc /C
     C                     Z-ADDWDJTPR    WCJTPR           CCT Gross /Carc
     C                     MOVEL##USR     WCAAVN    P      RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN    P      RS Job
     C                     MOVEL##PGM     WCAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@DGCPTJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Competitor 1
      *================================================================
      * CASE: PAR.Price Type USR is Live Hundred Weight
     C           P3T4ST    IFEQ 'L'                        *IF
     C                     Z-ADDWDG5PR    WUGBPR           CT Base 1
     C                     Z-ADDWDG6PR    WUGHPR           CT Lean Prem 1
     C                     Z-ADDWDG8PR    WUGTPR           CT Sort Dsc 1
     C                     Z-ADDWDG7PR    WUGNPR           CT Yield Gain/L
     C                     Z-ADDWDG9PR    WUGZPR           CT Total 1
     C                     ELSE
      * CASE: PAR.Price Type USR is Carcass Hundred Weight
     C           P3T4ST    IFEQ 'C'                        *IF
     C                     Z-ADDWDJPPR    WUGBPR           CT Base 1
     C                     Z-ADDWDJQPR    WUGHPR           CT Lean Prem 1
     C                     Z-ADDWDJSPR    WUGTPR           CT Sort Dsc 1
     C                     Z-ADDWDJRPR    WUGNPR           CT Yield Gain/L
     C                     Z-ADDWDJTPR    WUGZPR           CT Total 1
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate totals for averages
     C                     ADD  WUGBPR    WUHDPR           Cmp Base Live
     C                     ADD  WUGHPR    WUHEPR           Cmp Lean Premiu
     C                     ADD  WUGTPR    WUHGPR           Cmp Sort Dsc Li
     C                     ADD  WUGZPR    WUHHPR           CMP Gross Live
     C                     ADD  WUGNPR    WUHFPR           Cmp Yield Gain/
      * Chg Flg/Un Compet Tto CH - Competitors Tattoo  * 
     C                     EXSR SFCHRC
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Competitor 2
      *================================================================
      * CASE: PAR.Price Type USR is Live Hundred Weight
     C           P3T4ST    IFEQ 'L'                        *IF
     C                     Z-ADDWDG5PR    WUGCPR           CT Base 2
     C                     Z-ADDWDG6PR    WUGIPR           CT Lean Prem 2
     C                     Z-ADDWDG8PR    WUGUPR           CT Sort Dsc 2
     C                     Z-ADDWDG7PR    WUGOPR           CT Yield Gain/L
     C                     Z-ADDWDG9PR    WUG0PR           CT Total 2
     C                     ELSE
      * CASE: PAR.Price Type USR is Carcass Hundred Weight
     C           P3T4ST    IFEQ 'C'                        *IF
     C                     Z-ADDWDJPPR    WUGCPR           CT Base 2
     C                     Z-ADDWDJQPR    WUGIPR           CT Lean Prem 2
     C                     Z-ADDWDJSPR    WUGUPR           CT Sort Dsc 2
     C                     Z-ADDWDJRPR    WUGOPR           CT Yield Gain/L
     C                     Z-ADDWDJTPR    WUG0PR           CT Total 2
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate totals for averages
     C                     ADD  WUGCPR    WUHDPR           Cmp Base Live
     C                     ADD  WUGIPR    WUHEPR           Cmp Lean Premiu
     C                     ADD  WUGUPR    WUHGPR           Cmp Sort Dsc Li
     C                     ADD  WUG0PR    WUHHPR           CMP Gross Live
     C                     ADD  WUGOPR    WUHFPR           Cmp Yield Gain/
      * Chg Flg/Un Compet Tto CH - Competitors Tattoo  * 
     C                     EXSR SGCHRC
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Competitor 3
      *================================================================
      * CASE: PAR.Price Type USR is Live Hundred Weight
     C           P3T4ST    IFEQ 'L'                        *IF
     C                     Z-ADDWDG5PR    WUGDPR           CT Base 3
     C                     Z-ADDWDG6PR    WUGJPR           CT Lean Prem 3
     C                     Z-ADDWDG8PR    WUGVPR           CT Sort Dsc 3
     C                     Z-ADDWDG7PR    WUGPPR           CT Yield Gain/L
     C                     Z-ADDWDG9PR    WUG1PR           CT Total 3
     C                     ELSE
      * CASE: PAR.Price Type USR is Carcass Hundred Weight
     C           P3T4ST    IFEQ 'C'                        *IF
     C                     Z-ADDWDJPPR    WUGDPR           CT Base 3
     C                     Z-ADDWDJQPR    WUGJPR           CT Lean Prem 3
     C                     Z-ADDWDJSPR    WUGVPR           CT Sort Dsc 3
     C                     Z-ADDWDJRPR    WUGPPR           CT Yield Gain/L
     C                     Z-ADDWDJTPR    WUG1PR           CT Total 3
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate totals for averages
     C                     ADD  WUGDPR    WUHDPR           Cmp Base Live
     C                     ADD  WUGJPR    WUHEPR           Cmp Lean Premiu
     C                     ADD  WUGVPR    WUHGPR           Cmp Sort Dsc Li
     C                     ADD  WUGPPR    WUHFPR           Cmp Yield Gain/
     C                     ADD  WUG1PR    WUHHPR           CMP Gross Live
      * Chg Flg/Un Compet Tto CH - Competitors Tattoo  * 
     C                     EXSR SHCHRC
      * Create competitor totals
     C                     MOVEL'4'       WUMIST           Competitor or T
      * Crt/Ext Competitors Ttl
      * RTV Competitor Actual - Tattoo Header  * 
     C                     EXSR SIRVGN
      * Rtv Pdctn Loc FrghtZn RT - Producer Location  * 
     C                     EXSR SJRVGN
      * Calculate actual
      * Actual
      * CASE: PAR.Price Type USR is Live Hundred Weight
     C           P3T4ST    IFEQ 'L'                        *IF
     C                     Z-ADDWUD6PR    WUGEPR           CT Base Actual
     C                     Z-ADDWUEEPR    WUGKPR           CT Lean Prem Ac
     C                     Z-ADDWUEAPR    WUGQPR           CT Yield Gain/L
     C                     Z-ADDWUD8PR    WUGWPR           CT Sort Dsc Act
     C                     Z-ADDWUEGPR    WUG2PR           CT Total Actual
     C                     ELSE
      * CASE: PAR.Price Type USR is Carcass Hundred Weight
     C           P3T4ST    IFEQ 'C'                        *IF
     C                     Z-ADDWUD7PR    WUGEPR           CT Base Actual
     C                     Z-ADDWUEFPR    WUGKPR           CT Lean Prem Ac
     C                     Z-ADDWUEBPR    WUGQPR           CT Yield Gain/L
     C                     Z-ADDWUD9PR    WUGWPR           CT Sort Dsc Act
     C                     Z-ADDWUEHPR    WUG2PR           CT Total Actual
     C                     END                             *FI
     C                     END                             *FI
      * Calculate average from Count Usr number of competitors found for
     C           WUHDPR    DIV  3         WUGFPR    H      CT Base Average
     C           WUHEPR    DIV  3         WUGLPR    H      CT Lean Prem Av
     C           WUHFPR    DIV  3         WUGRPR    H      CT Yield Gain/L
     C           WUHGPR    DIV  3         WUGXPR    H      CT Sort Dsc Ave
     C           WUGFPR    ADD  WUGLPR    WUG3PR           CT Total Avg
     C                     ADD  WUGRPR    WUG3PR           CT Total Avg
     C                     ADD  WUGXPR    WUG3PR           CT Total Avg
      * Calculate variance
     C           WUGEPR    SUB  WUGFPR    WUGGPR           CT Base Varianc
     C           WUGKPR    SUB  WUGLPR    WUGMPR           CT Lean Prem Va
     C           WUGQPR    SUB  WUGRPR    WUGSPR           CT Yield Gain/L
     C           WUGWPR    SUB  WUGXPR    WUGYPR           CT Sort Dsc Var
     C           WUG2PR    SUB  WUG3PR    WUG4PR           CT Total Varian
      * Create record
      * Create Competitors Total - Competitors Total  * 
     C                     EXSR SKCRRC
     C                     Z-ADD*ZERO     WUHDPR           Cmp Base Live
     C                     Z-ADD*ZERO     WUHEPR           Cmp Lean Premiu
     C                     Z-ADD*ZERO     WUHGPR           Cmp Sort Dsc Li
     C                     Z-ADD*ZERO     WUHFPR           Cmp Yield Gain/
     C                     Z-ADD*ZERO     WUHHPR           CMP Gross Live
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBF4PC           CCT Std Yield
     C                     Z-ADD*ZERO     WBG5PR           CCT Base /Live
     C                     Z-ADD*ZERO     WBJPPR           CCT Base /Carc
     C                     Z-ADD*ZERO     WBG6PR           CCT Lean Prem /
     C                     Z-ADD*ZERO     WBJQPR           CCT Lean Prem /
     C                     Z-ADD*ZERO     WBG7PR           CCT Yield G/L /
     C                     Z-ADD*ZERO     WBJRPR           CCT Yield G/L /
     C                     Z-ADD*ZERO     WBJUPR           CCT Carc Val /L
     C                     Z-ADD*ZERO     WBJVPR           CCT Carc Val /C
     C                     Z-ADD*ZERO     WBG8PR           CCT Sort Dsc /L
     C                     Z-ADD*ZERO     WBJSPR           CCT Sort Dsc /C
     C                     Z-ADD*ZERO     WBG9PR           CCT Gross /Live
     C                     Z-ADD*ZERO     WBJTPR           CCT Gross /Carc
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Competitors Code 1 Usr
     C                     MOVEL*BLANK    WUE7CD  3
      * Define work field Competitors Code 2 Usr
     C                     MOVEL*BLANK    WUE8CD  3
      * Define work field Competitors Code 3 Usr
     C                     MOVEL*BLANK    WUE9CD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WEA0PC           CMP Lean Factor
     C                     Z-ADD*ZERO     WEI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WEVEPR           CMP % of Carcas
     C                     Z-ADD*ZERO     WEVFPR           CMP Fixed Cost
     C                     Z-ADD*ZERO     WEVHPR           CMP Grade Type
     C                     Z-ADD*ZERO     WEVIPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WEVJPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUP0NB  30
      * Define work field Cmp Base Live
     C                     Z-ADD*ZERO     WUHDPR  62
      * Define work field Cmp Lean Premium Live
     C                     Z-ADD*ZERO     WUHEPR  62
      * Define work field Cmp Sort Dsc Live
     C                     Z-ADD*ZERO     WUHGPR  62
      * Define work field Cmp Yield Gain/Loss Live
     C                     Z-ADD*ZERO     WUHFPR  62
      * Define work field CMP Gross Live
     C                     Z-ADD*ZERO     WUHHPR  62
      * Define work field CT Base 1
     C                     Z-ADD*ZERO     WUGBPR  42
      * Define work field CT Lean Prem 1
     C                     Z-ADD*ZERO     WUGHPR  42
      * Define work field CT Sort Dsc 1
     C                     Z-ADD*ZERO     WUGTPR  42
      * Define work field CT Yield Gain/Loss 1
     C                     Z-ADD*ZERO     WUGNPR  42
      * Define work field CT Total 1
     C                     Z-ADD*ZERO     WUGZPR  42
      * Define work field CT Base 2
     C                     Z-ADD*ZERO     WUGCPR  42
      * Define work field CT Lean Prem 2
     C                     Z-ADD*ZERO     WUGIPR  42
      * Define work field CT Sort Dsc 2
     C                     Z-ADD*ZERO     WUGUPR  42
      * Define work field CT Yield Gain/Loss 2
     C                     Z-ADD*ZERO     WUGOPR  42
      * Define work field CT Total 2
     C                     Z-ADD*ZERO     WUG0PR  42
      * Define work field CT Base 3
     C                     Z-ADD*ZERO     WUGDPR  42
      * Define work field CT Lean Prem 3
     C                     Z-ADD*ZERO     WUGJPR  42
      * Define work field CT Sort Dsc 3
     C                     Z-ADD*ZERO     WUGVPR  42
      * Define work field CT Yield Gain/Loss 3
     C                     Z-ADD*ZERO     WUGPPR  42
      * Define work field CT Total 3
     C                     Z-ADD*ZERO     WUG1PR  42
      * Define work field Competitor or Totals Usr
     C                     MOVEL*BLANK    WUMIST  1
      * Define work field TH Head Killed
     C                     Z-ADD*ZERO     WUFENB  50
      * Define work field TH Live Wgt
     C                     Z-ADD*ZERO     WUCYNB  71
      * Define work field TH Hot Wgt
     C                     Z-ADD*ZERO     WUE0NB  71
      * Define work field TH CM Bse Mkt Live /CWT
     C                     Z-ADD*ZERO     WUD6PR  52
      * Define work field TH CM Bse Mkt Carc /CWT
     C                     Z-ADD*ZERO     WUD7PR  52
      * Define work field TH CM Srt Dsc Live /CWT
     C                     Z-ADD*ZERO     WUD8PR  52
      * Define work field TH CM Srt Dsc Carc /CWT
     C                     Z-ADD*ZERO     WUD9PR  52
      * Define work field TH CM Yld G/L Live /CWT
     C                     Z-ADD*ZERO     WUEAPR  52
      * Define work field TH CM Yld G/L Carc /CWT
     C                     Z-ADD*ZERO     WUEBPR  52
      * Define work field TH CM Crc Val Live /CWT
     C                     Z-ADD*ZERO     WUECPR  52
      * Define work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     WUEDPR  52
      * Define work field TH CM Lean Prem Live /CWT
     C                     Z-ADD*ZERO     WUEEPR  52
      * Define work field TH CM Lean Prem Carc /CWT
     C                     Z-ADD*ZERO     WUEFPR  52
      * Define work field TH CM Gross Live /CWT
     C                     Z-ADD*ZERO     WUEGPR  52
      * Define work field TH CM Gross Carc /CWT
     C                     Z-ADD*ZERO     WUEHPR  52
      * Define work field TH Source Type
     C                     MOVEL*BLANK    WUKAST  1
      * Define work field TH Source Code
     C                     MOVEL*BLANK    WULKST  3
      * Define work field PD Producer Code
     C                     MOVEL*BLANK    WUABCD  6
      * Define work field PL Location Code
     C                     MOVEL*BLANK    WUAECD  6
      * Define work field FZ Code
     C                     MOVEL*BLANK    WUFUCD  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WGASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WGHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field CT Base Actual
     C                     Z-ADD*ZERO     WUGEPR  42
      * Define work field CT Lean Prem Actual
     C                     Z-ADD*ZERO     WUGKPR  42
      * Define work field CT Yield Gain/Loss Actual
     C                     Z-ADD*ZERO     WUGQPR  42
      * Define work field CT Sort Dsc Actual
     C                     Z-ADD*ZERO     WUGWPR  42
      * Define work field CT Total Actual
     C                     Z-ADD*ZERO     WUG2PR  42
      * Define work field CT Base Average
     C                     Z-ADD*ZERO     WUGFPR  42
      * Define work field CT Lean Prem Average
     C                     Z-ADD*ZERO     WUGLPR  42
      * Define work field CT Yield Gain/Loss Avg
     C                     Z-ADD*ZERO     WUGRPR  42
      * Define work field CT Sort Dsc Average
     C                     Z-ADD*ZERO     WUGXPR  42
      * Define work field CT Total Avg
     C                     Z-ADD*ZERO     WUG3PR  42
      * Define work field CT Base Variance
     C                     Z-ADD*ZERO     WUGGPR  42
      * Define work field CT Lean Prem Variance
     C                     Z-ADD*ZERO     WUGMPR  42
      * Define work field CT Yield Gain/Loss Var
     C                     Z-ADD*ZERO     WUGSPR  42
      * Define work field CT Sort Dsc Var
     C                     Z-ADD*ZERO     WUGYPR  42
      * Define work field CT Total Variance
     C                     Z-ADD*ZERO     WUG4PR  42
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WHBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WHBONB           BOL Load Number
     C                     Z-ADD*ZERO     WHCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WHB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WHGEPR           CT Base Actual
     C                     Z-ADD*ZERO     WHGKPR           CT Lean Prem Ac
     C                     Z-ADD*ZERO     WHGQPR           CT Yield Gain/L
     C                     Z-ADD*ZERO     WHGWPR           CT Sort Dsc Act
     C                     Z-ADD*ZERO     WHG2PR           CT Total Actual
     C                     Z-ADD*ZERO     WHGBPR           CT Base 1
     C                     Z-ADD*ZERO     WHGHPR           CT Lean Prem 1
     C                     Z-ADD*ZERO     WHGNPR           CT Yield Gain/L
     C                     Z-ADD*ZERO     WHGTPR           CT Sort Dsc 1
     C                     Z-ADD*ZERO     WHGZPR           CT Total 1
     C                     Z-ADD*ZERO     WHGCPR           CT Base 2
     C                     Z-ADD*ZERO     WHGIPR           CT Lean Prem 2
     C                     Z-ADD*ZERO     WHGOPR           CT Yield Gain/L
     C                     Z-ADD*ZERO     WHGUPR           CT Sort Dsc 2
     C                     Z-ADD*ZERO     WHG0PR           CT Total 2
     C                     Z-ADD*ZERO     WHGDPR           CT Base 3
     C                     Z-ADD*ZERO     WHGJPR           CT Lean Prem 3
     C                     Z-ADD*ZERO     WHGPPR           CT Yield Gain/L
     C                     Z-ADD*ZERO     WHGVPR           CT Sort Dsc 3
     C                     Z-ADD*ZERO     WHG1PR           CT Total 3
     C                     Z-ADD*ZERO     WHGFPR           CT Base Average
     C                     Z-ADD*ZERO     WHGLPR           CT Lean Prem Av
     C                     Z-ADD*ZERO     WHGRPR           CT Yield Gain/L
     C                     Z-ADD*ZERO     WHGXPR           CT Sort Dsc Ave
     C                     Z-ADD*ZERO     WHG3PR           CT Total Avg
     C                     Z-ADD*ZERO     WHGGPR           CT Base Varianc
     C                     Z-ADD*ZERO     WHGMPR           CT Lean Prem Va
     C                     Z-ADD*ZERO     WHGSPR           CT Yield Gain/L
     C                     Z-ADD*ZERO     WHGYPR           CT Sort Dsc Var
     C                     Z-ADD*ZERO     WHG4PR           CT Total Varian
     C                     Z-ADD*ZERO     WHZ0NB           CT Hot Weight
     C                     Z-ADD*ZERO     WHZ1NB           CT Live Weight
     C                     Z-ADD*ZERO     WHZ2NB           CT Head Killed
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL'N'       W0PMT   1
      * Define local work field TH Tattoo Number
     C                     Z-ADD*ZERO     YL0001  50
      * Define local work field BOH Buy Order Number
     C                     Z-ADD*ZERO     YL0002  70
      *================================================================
     CSR         ZZEXIT    ENDSR
