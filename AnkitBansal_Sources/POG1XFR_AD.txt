// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for POG1XFR
// ?Date: 14.08.2025 Time: 03:37:14
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Clc MTO Item Costs    RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1605871;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Date_Mon_USR);
PARAMETER(PAR.Date_Sun_USR);
{
 //?USER: Initialize routine

 // LCL.Raw Material Item = CON.*ZERO
 LCL.Seaboard_Equivalent_Item = *ZERO;

 //?USER: Process Data record

 //?100306 slm at this time we are recompile but this function
 //?       is attached to a WW but is not used Alice says to wait
 //?       the function below is creating a per lb and the standard
 //?       cost is in CWT... So this is on Alice's list to wait.
 EXECUTE FUNCTION(Rtv MTO Standard Cost RT) TYPE(RTVOBJ) FILE(POAXCPP)           AC1605873;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(PAR.Date_Mon_USR);
 PARAMETER(PAR.Yield);
 PARAMETER(PAR.Std_Packaging_Cost_CWT);
 PARAMETER(PAR.Std_Other_Cost_CWT);
 PARAMETER(PAR.Std_Inc_Labor_Cost_CWT);
 PARAMETER(PAR.Std_Ingredient_Cost_CWT);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 CASE;

 // IF DB1.Raw Material Item NE LCL.Raw Material Item
 IF DB1.Seaboard_Equivalent_Item <> LCL.Seaboard_Equivalent_Item;

 EXECUTE FUNCTION(Clc RM Avg Sales      RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC1605872;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Seaboard_Equivalent_Item);
 PARAMETER(PAR.Date_Mon_USR);
 PARAMETER(PAR.Date_Sun_USR);
 PARAMETER(PAR.Sale_Amount_USR);
 PARAMETER(PAR.Sale_Weight_USR);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Actual Shipped Date GT PAR.Date Sun USR
  IF DB1.Actual_Shipped_Date > PAR.Date_Sun_USR;

  QUIT;

  ENDIF;

  CASE;

  // IF DB1.Order Type - Sales is Regular Order
  IF DB1.Order_Type_Sales = 'OR';

  // PAR.Sale Amount USR = PAR.Sale Amount USR + DB1.FOB Gross Amount
  PAR.Sale_Amount_USR = PAR.Sale_Amount_USR + DB1.FOB_Gross_Amount;

  // PAR.Sale Weight USR = PAR.Sale Weight USR + DB1.Weight Billed
  PAR.Sale_Weight_USR = PAR.Sale_Weight_USR + DB1.Weight_Billed;

  ENDIF;

 }

 // LCL.Raw Material Item = DB1.Raw Material Item
 LCL.Seaboard_Equivalent_Item = DB1.Seaboard_Equivalent_Item;

 ENDIF;

 //?Raw Material Cost /LB
 CASE;

 // IF PAR.Sale Weight USR is GT Zero
 IF PAR.Sale_Weight_USR > *ZERO;

 // AND PAR.Yield is GT Zero
 AND PAR.Yield > *ZERO;

 // Raw Material Cost /LB
 PAR.Raw_Material_Cost_LB = ( ( PAR.Sale_Amount_USR / PAR.Sale_Weight_USR 'H' )
 - PAR.Std_Other_Cost_CWT ) / PAR.Yield 'H';

 //?Raw Material Cost /LB
 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(Rtv Mkt/Grp/Ovr/HdWgt RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1338204;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Seaboard_Equivalent_Item);
 PARAMETER(WRK.Description_Line_One);
 PARAMETER(LCL.Default_Commod_Mark_basis);
 PARAMETER(LCL.Market_Overage);
 PARAMETER(WRK.Standard_Overage_Underage);
 PARAMETER(LCL.Commodity_Price_Group);
 PARAMETER(WRK.Std_Weight_Head_Var_Ren);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(RTV Market Price       RT) TYPE(RTVOBJ) FILE(OMF0CPP)          AC1199313;
 PARAMETER(LCL.Default_Commod_Mark_basis);
 PARAMETER(LCL.Commodity_Price_Group);
 PARAMETER(PAR.Date_Sun_USR);
 PARAMETER(LCL.Commodity_Market_Price);
 PARAMETER(LCL.USR_Date_Priced);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  // PAR.Commodity Market Price = DB1.Commodity Market Price
  PAR.Commodity_Market_Price = DB1.Commodity_Market_Price;

  // PAR.USR Date Priced = DB1.Market Price Date
  PAR.USR_Date_Priced = DB1.Market_Price_Date;

  QUIT;

 }

 //?Raw Material Cost /LB
 CASE;

 // IF PAR.Yield is GT Zero
 IF PAR.Yield > *ZERO;

 // Raw Material Cost /LB
 PAR.Raw_Material_Cost_LB = ( ( LCL.Commodity_Market_Price + LCL.Market_Overage )
 - PAR.Std_Other_Cost_CWT ) / PAR.Yield 'H';

 //?Raw Material Cost /LB
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Raw Material Cost /LB = CON.*ZERO
 PAR.Raw_Material_Cost_LB = *ZERO;

 ENDIF;

 ENDIF;

 // Unit Cost Per Pound
 PAR.Unit_Cost_Per_Pound = ( PAR.Std_Inc_Labor_Cost_CWT + PAR.Std_Ingredient_Cost_CWT )
 + PAR.Std_Packaging_Cost_CWT;

 EXECUTE FUNCTION(Upd RM/Unit Cost      RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC1605877;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(PAR.Date_Mon_USR);
 PARAMETER(PAR.Date_Sun_USR);
 PARAMETER(PAR.Unit_Cost_Per_Pound);
 PARAMETER(PAR.Raw_Material_Cost_LB);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Actual Shipped Date GT PAR.Date Sun USR
  IF DB1.Actual_Shipped_Date > PAR.Date_Sun_USR;

  QUIT;

  ENDIF;

  CASE;

  // IF DB1.Order Type - Sales is Regular Order
  IF DB1.Order_Type_Sales = 'OR';

  EXECUTE FUNCTION(Chg RM/Unit Cost      CH) TYPE(CHGOBJ) FILE(OMHSTPP)           AC1605878;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(PAR.Unit_Cost_Per_Pound);
  PARAMETER(PAR.Raw_Material_Cost_LB);
  {
   //?USER: Processing after Data read

   // DB1.Data Mart Process Sts = CND.no
   DB1.Data_Mart_Process_Sts = 'N';

  }

  ENDIF;

 }

}


