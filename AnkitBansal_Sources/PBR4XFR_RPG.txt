     H/TITLE Upd Set Snd PFS PdSch XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJHIGH
     H* Date          : 08/04/15  Time  : 09:45:15
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FOMBYREL0UF  E           K        DISK
      * UPD : Item Default              Update index
      *
     I@BYREA1
      * Item Default              Retrieval index
      * Renamed input format fields
     I              BYHGCD                          WAHGCD
     I              BYAVNA                          WAAVNA
     I              BYAWNA                          WAAWNA
     I              BYL7NA                          WAL7NA
     I              BYL8NA                          WAL8NA
     I              BYL6NA                          WAL6NA
     I              BYMFNA                          WAMFNA
     I              BYHHCD                          WAHHCD
     I              BYAWPC                          WAAWPC
     I              BYLXST                          WALXST
     I              BYLGCD                          WALGCD
     I              BYAXPC                          WAAXPC
     I              BYLYST                          WALYST
     I              BYLHCD                          WALHCD
     I              BYLICD                          WALICD
     I              BYAIWG                          WAAIWG
     I              BYHICD                          WAHICD
     I              BYRBCD                          WARBCD
     I              BYFZST                          WAFZST
     I              BYAVST                          WAAVST
     I              BYCZWG                          WACZWG
     I              BYC0WG                          WAC0WG
     I              BYURTN                          WAURTN
     I              BYACC8                          WAACC8
     I              BYRINB                          WARINB
     I              BYRHNB                          WARHNB
     I              BYRGNB                          WARGNB
     I              BYLNCD                          WALNCD
     I              BYTFNB                          WATFNB
     I              BYN0CD                          WAN0CD
     I              BYX4ST                          WAX4ST
     I              BYCHTM                          WACHTM
     I              BYQZCD                          WAQZCD
     I              BYXWST                          WAXWST
     I              BYXXST                          WAXXST
     I              BYVMST                          WAVMST
     I              BYSWGH                          WASWGH
     I              BYPPHE                          WAPPHE
     I              BYLRCD                          WALRCD
     I              BYSFNB                          WASFNB
     I              BYA3WG                          WAA3WG
     I              BYSJNB                          WASJNB
     I              BYLLCD                          WALLCD
     I              BYLMCD                          WALMCD
     I              BYP3ST                          WAP3ST
     I              BYSKNB                          WASKNB
     I              BYSLNB                          WASLNB
     I              BYSMNB                          WASMNB
     I              BYP4ST                          WAP4ST
     I              BYCFNB                          WACFNB
     I              BYCGNB                          WACGNB
     I              BYILNB                          WAILNB
     I              BYCHNB                          WACHNB
     I              BYCINB                          WACINB
     I              BYCJNB                          WACJNB
     I              BYCMNB                          WACMNB
     I              BYCNNB                          WACNNB
     I              BYCRNB                          WACRNB
     I              BYCSNB                          WACSNB
     I              BYCVNB                          WACVNB
     I              BYCWNB                          WACWNB
     I              BYCXNB                          WACXNB
     I              BYCZNB                          WACZNB
     I              BYC0NB                          WAC0NB
     I              BYN1CD                          WAN1CD
     I              BYB4NB                          WAB4NB
     I              BYX5ST                          WAX5ST
     I              BYX6ST                          WAX6ST
     I              BYX7ST                          WAX7ST
     I              BYTMVA                          WATMVA
     I              BYTNVA                          WATNVA
     I              BYBLPR                          WABLPR
     I              BYBMPR                          WABMPR
     I              BYU9ST                          WAU9ST
     I              BYCMCO                          WACMCO
     I              BYQ1CD                          WAQ1CD
     I              BYAIC3                          WAAIC3
     I              BYQ8CD                          WAQ8CD
     I              BYR3CD                          WAR3CD
     I              BYSDCD                          WASDCD
     I              BYICN1                          WAICN1
     I              BYSVCD                          WASVCD
     I              BYICN2                          WAICN2
     I              BYSWCD                          WASWCD
     I              BYV2NB                          WAV2NB
     I              BYSXCD                          WASXCD
     I              BYITCN                          WAITCN
     I              BYSYCD                          WASYCD
     I              BYITC5                          WAITC5
     I              BYSZCD                          WASZCD
     I              BYICN6                          WAICN6
     I              BYS0CD                          WAS0CD
     I              BYICN7                          WAICN7
     I              BYS1CD                          WAS1CD
     I              BYICN8                          WAICN8
     I              BYS2CD                          WAS2CD
     I              BYICN9                          WAICN9
     I              BYS3CD                          WAS3CD
     I              BYICN0                          WAICN0
     I              BYS4CD                          WAS4CD
     I              BYB5NB                          WAB5NB
     I              BYXRCD                          WAXRCD
     I              BYPCCT                          WAPCCT
     I              BYBDNB                          WABDNB
     I              BYBJNB                          WABJNB
     I              BYSUST                          WASUST
     I              BYSVST                          WASVST
     I              BYSYST                          WASYST
     I              BYSZST                          WASZST
     I              BYS1ST                          WAS1ST
     I              BYXTCD                          WAXTCD
     I              BYXUCD                          WAXUCD
     I              BYF5WG                          WAF5WG
     I              BYF6WG                          WAF6WG
     I              BYF7WG                          WAF7WG
     I              BYBLNB                          WABLNB
     I              BYBNNB                          WABNNB
     I              BYS2ST                          WAS2ST
     I              BYS4ST                          WAS4ST
     I              BYS5ST                          WAS5ST
     I              BYS6ST                          WAS6ST
     I              BYS8ST                          WAS8ST
     I              BYS9ST                          WAS9ST
     I              BYTCST                          WATCST
     I              BYTDST                          WATDST
     I              BYUVST                          WAUVST
     I              BYUWST                          WAUWST
     I              BYUXST                          WAUXST
     I              BYVSST                          WAVSST
     I              BYAHTM                          WAAHTM
     I              BYBEVN                          WABEVN
     I              BYBFVN                          WABFVN
     I              BYEKDT                          WAEKDT
      *
     I@BYREA0
      * Item Default              Update index
      * Renamed input format fields
     I              BYHGCD                          WBHGCD
     I              BYAVNA                          WBAVNA
     I              BYAWNA                          WBAWNA
     I              BYL7NA                          WBL7NA
     I              BYL8NA                          WBL8NA
     I              BYL6NA                          WBL6NA
     I              BYMFNA                          WBMFNA
     I              BYHHCD                          WBHHCD
     I              BYAWPC                          WBAWPC
     I              BYLXST                          WBLXST
     I              BYLGCD                          WBLGCD
     I              BYAXPC                          WBAXPC
     I              BYLYST                          WBLYST
     I              BYLHCD                          WBLHCD
     I              BYLICD                          WBLICD
     I              BYAIWG                          WBAIWG
     I              BYHICD                          WBHICD
     I              BYRBCD                          WBRBCD
     I              BYFZST                          WBFZST
     I              BYAVST                          WBAVST
     I              BYCZWG                          WBCZWG
     I              BYC0WG                          WBC0WG
     I              BYURTN                          WBURTN
     I              BYACC8                          WBACC8
     I              BYRINB                          WBRINB
     I              BYRHNB                          WBRHNB
     I              BYRGNB                          WBRGNB
     I              BYLNCD                          WBLNCD
     I              BYTFNB                          WBTFNB
     I              BYN0CD                          WBN0CD
     I              BYX4ST                          WBX4ST
     I              BYCHTM                          WBCHTM
     I              BYQZCD                          WBQZCD
     I              BYXWST                          WBXWST
     I              BYXXST                          WBXXST
     I              BYVMST                          WBVMST
     I              BYSWGH                          WBSWGH
     I              BYPPHE                          WBPPHE
     I              BYLRCD                          WBLRCD
     I              BYSFNB                          WBSFNB
     I              BYA3WG                          WBA3WG
     I              BYSJNB                          WBSJNB
     I              BYLLCD                          WBLLCD
     I              BYLMCD                          WBLMCD
     I              BYP3ST                          WBP3ST
     I              BYSKNB                          WBSKNB
     I              BYSLNB                          WBSLNB
     I              BYSMNB                          WBSMNB
     I              BYP4ST                          WBP4ST
     I              BYCFNB                          WBCFNB
     I              BYCGNB                          WBCGNB
     I              BYILNB                          WBILNB
     I              BYCHNB                          WBCHNB
     I              BYCINB                          WBCINB
     I              BYCJNB                          WBCJNB
     I              BYCMNB                          WBCMNB
     I              BYCNNB                          WBCNNB
     I              BYCRNB                          WBCRNB
     I              BYCSNB                          WBCSNB
     I              BYCVNB                          WBCVNB
     I              BYCWNB                          WBCWNB
     I              BYCXNB                          WBCXNB
     I              BYCZNB                          WBCZNB
     I              BYC0NB                          WBC0NB
     I              BYN1CD                          WBN1CD
     I              BYB4NB                          WBB4NB
     I              BYX5ST                          WBX5ST
     I              BYX6ST                          WBX6ST
     I              BYX7ST                          WBX7ST
     I              BYTMVA                          WBTMVA
     I              BYTNVA                          WBTNVA
     I              BYBLPR                          WBBLPR
     I              BYBMPR                          WBBMPR
     I              BYU9ST                          WBU9ST
     I              BYCMCO                          WBCMCO
     I              BYQ1CD                          WBQ1CD
     I              BYAIC3                          WBAIC3
     I              BYQ8CD                          WBQ8CD
     I              BYR3CD                          WBR3CD
     I              BYSDCD                          WBSDCD
     I              BYICN1                          WBICN1
     I              BYSVCD                          WBSVCD
     I              BYICN2                          WBICN2
     I              BYSWCD                          WBSWCD
     I              BYV2NB                          WBV2NB
     I              BYSXCD                          WBSXCD
     I              BYITCN                          WBITCN
     I              BYSYCD                          WBSYCD
     I              BYITC5                          WBITC5
     I              BYSZCD                          WBSZCD
     I              BYICN6                          WBICN6
     I              BYS0CD                          WBS0CD
     I              BYICN7                          WBICN7
     I              BYS1CD                          WBS1CD
     I              BYICN8                          WBICN8
     I              BYS2CD                          WBS2CD
     I              BYICN9                          WBICN9
     I              BYS3CD                          WBS3CD
     I              BYICN0                          WBICN0
     I              BYS4CD                          WBS4CD
     I              BYB5NB                          WBB5NB
     I              BYXRCD                          WBXRCD
     I              BYPCCT                          WBPCCT
     I              BYBDNB                          WBBDNB
     I              BYBJNB                          WBBJNB
     I              BYSUST                          WBSUST
     I              BYSVST                          WBSVST
     I              BYSYST                          WBSYST
     I              BYSZST                          WBSZST
     I              BYS1ST                          WBS1ST
     I              BYXTCD                          WBXTCD
     I              BYXUCD                          WBXUCD
     I              BYF5WG                          WBF5WG
     I              BYF6WG                          WBF6WG
     I              BYF7WG                          WBF7WG
     I              BYBLNB                          WBBLNB
     I              BYBNNB                          WBBNNB
     I              BYS2ST                          WBS2ST
     I              BYS4ST                          WBS4ST
     I              BYS5ST                          WBS5ST
     I              BYS6ST                          WBS6ST
     I              BYS8ST                          WBS8ST
     I              BYS9ST                          WBS9ST
     I              BYTCST                          WBTCST
     I              BYTDST                          WBTDST
     I              BYUVST                          WBUVST
     I              BYUWST                          WBUWST
     I              BYUXST                          WBUXST
     I              BYVSST                          WBVSST
     I              BYAHTM                          WBAHTM
     I              BYBEVN                          WBBEVN
     I              BYBFVN                          WBBFVN
     I              BYEKDT                          WBEKDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOMBY1    E DSOMBYREL0
      * UPD : Item Default              Update index
      * Renamed input format fields
     I              BYHGCD                          WBHGCD
     I              BYAVNA                          WBAVNA
     I              BYAWNA                          WBAWNA
     I              BYL7NA                          WBL7NA
     I              BYL8NA                          WBL8NA
     I              BYL6NA                          WBL6NA
     I              BYMFNA                          WBMFNA
     I              BYHHCD                          WBHHCD
     I              BYAWPC                          WBAWPC
     I              BYLXST                          WBLXST
     I              BYLGCD                          WBLGCD
     I              BYAXPC                          WBAXPC
     I              BYLYST                          WBLYST
     I              BYLHCD                          WBLHCD
     I              BYLICD                          WBLICD
     I              BYAIWG                          WBAIWG
     I              BYHICD                          WBHICD
     I              BYRBCD                          WBRBCD
     I              BYFZST                          WBFZST
     I              BYAVST                          WBAVST
     I              BYCZWG                          WBCZWG
     I              BYC0WG                          WBC0WG
     I              BYURTN                          WBURTN
     I              BYACC8                          WBACC8
     I              BYRINB                          WBRINB
     I              BYRHNB                          WBRHNB
     I              BYRGNB                          WBRGNB
     I              BYLNCD                          WBLNCD
     I              BYTFNB                          WBTFNB
     I              BYN0CD                          WBN0CD
     I              BYX4ST                          WBX4ST
     I              BYCHTM                          WBCHTM
     I              BYQZCD                          WBQZCD
     I              BYXWST                          WBXWST
     I              BYXXST                          WBXXST
     I              BYVMST                          WBVMST
     I              BYSWGH                          WBSWGH
     I              BYPPHE                          WBPPHE
     I              BYLRCD                          WBLRCD
     I              BYSFNB                          WBSFNB
     I              BYA3WG                          WBA3WG
     I              BYSJNB                          WBSJNB
     I              BYLLCD                          WBLLCD
     I              BYLMCD                          WBLMCD
     I              BYP3ST                          WBP3ST
     I              BYSKNB                          WBSKNB
     I              BYSLNB                          WBSLNB
     I              BYSMNB                          WBSMNB
     I              BYP4ST                          WBP4ST
     I              BYCFNB                          WBCFNB
     I              BYCGNB                          WBCGNB
     I              BYILNB                          WBILNB
     I              BYCHNB                          WBCHNB
     I              BYCINB                          WBCINB
     I              BYCJNB                          WBCJNB
     I              BYCMNB                          WBCMNB
     I              BYCNNB                          WBCNNB
     I              BYCRNB                          WBCRNB
     I              BYCSNB                          WBCSNB
     I              BYCVNB                          WBCVNB
     I              BYCWNB                          WBCWNB
     I              BYCXNB                          WBCXNB
     I              BYCZNB                          WBCZNB
     I              BYC0NB                          WBC0NB
     I              BYN1CD                          WBN1CD
     I              BYB4NB                          WBB4NB
     I              BYX5ST                          WBX5ST
     I              BYX6ST                          WBX6ST
     I              BYX7ST                          WBX7ST
     I              BYTMVA                          WBTMVA
     I              BYTNVA                          WBTNVA
     I              BYBLPR                          WBBLPR
     I              BYBMPR                          WBBMPR
     I              BYU9ST                          WBU9ST
     I              BYCMCO                          WBCMCO
     I              BYQ1CD                          WBQ1CD
     I              BYAIC3                          WBAIC3
     I              BYQ8CD                          WBQ8CD
     I              BYR3CD                          WBR3CD
     I              BYSDCD                          WBSDCD
     I              BYICN1                          WBICN1
     I              BYSVCD                          WBSVCD
     I              BYICN2                          WBICN2
     I              BYSWCD                          WBSWCD
     I              BYV2NB                          WBV2NB
     I              BYSXCD                          WBSXCD
     I              BYITCN                          WBITCN
     I              BYSYCD                          WBSYCD
     I              BYITC5                          WBITC5
     I              BYSZCD                          WBSZCD
     I              BYICN6                          WBICN6
     I              BYS0CD                          WBS0CD
     I              BYICN7                          WBICN7
     I              BYS1CD                          WBS1CD
     I              BYICN8                          WBICN8
     I              BYS2CD                          WBS2CD
     I              BYICN9                          WBICN9
     I              BYS3CD                          WBS3CD
     I              BYICN0                          WBICN0
     I              BYS4CD                          WBS4CD
     I              BYB5NB                          WBB5NB
     I              BYXRCD                          WBXRCD
     I              BYPCCT                          WBPCCT
     I              BYBDNB                          WBBDNB
     I              BYBJNB                          WBBJNB
     I              BYSUST                          WBSUST
     I              BYSVST                          WBSVST
     I              BYSYST                          WBSYST
     I              BYSZST                          WBSZST
     I              BYS1ST                          WBS1ST
     I              BYXTCD                          WBXTCD
     I              BYXUCD                          WBXUCD
     I              BYF5WG                          WBF5WG
     I              BYF6WG                          WBF6WG
     I              BYF7WG                          WBF7WG
     I              BYBLNB                          WBBLNB
     I              BYBNNB                          WBBNNB
     I              BYS2ST                          WBS2ST
     I              BYS4ST                          WBS4ST
     I              BYS5ST                          WBS5ST
     I              BYS6ST                          WBS6ST
     I              BYS8ST                          WBS8ST
     I              BYS9ST                          WBS9ST
     I              BYTCST                          WBTCST
     I              BYTDST                          WBTDST
     I              BYUVST                          WBUVST
     I              BYUWST                          WBUWST
     I              BYUXST                          WBUXST
     I              BYVSST                          WBVSST
     I              BYAHTM                          WBAHTM
     I              BYBEVN                          WBBEVN
     I              BYBFVN                          WBBFVN
     I              BYEKDT                          WBEKDT
      *
     IYARDCS      DS                            605
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Upd Set Snd PFS PdSch XF
      * E3787 JJH 08/04/15 - New PFS Product and PFS Production Schedule
      * This progam is intended to be ran one-time to initially set the
      * Item Prod Sched Send PFS to a "Y" in the Item Default file for
      * all Item Default records.  The user will then be responsible for
      * changing this field to a "N" for selected items.
      * Rtv Set Snd PFS PdSch RT - Item Default  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Set Snd PFS PdSch RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADD*ZERO     WAHGCD           Item Code
      * Establish starting position
     C           KPSSA     SETLL@BYREA1                    *
     C                     READ @BYREA1                  90*
      * Data record not found
     C   90                MOVEL'USR1160' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Set Snd PFS PdSch CH - Item Default  * 
     C                     EXSR SBCHRC
     C                     READ @BYREA1                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Chg Set Snd PFS PdSch CH - Item Default  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 30        Description Lin
     C                     MOVEL*BLANK    WN0002 30        Description Lin
     C                     MOVEL*BLANK    WN0003 32        Item Label Line
     C                     MOVEL*BLANK    WN0004 32        Item Label Line
     C                     MOVEL*BLANK    WN0005 32        Item Label Line
     C                     MOVEL*BLANK    WN0006 32        Item Label Line
     C                     MOVEL*BLANK    WN0007  2        U/M - Primary D
     C                     Z-ADD*ZERO     WN0008  94       Conversion Fact
     C                     MOVEL*BLANK    WN0009  1        Operation Facto
     C                     MOVEL*BLANK    WN0010  2        U/M - Second Df
     C                     Z-ADD*ZERO     WN0011  94       Conversion Fact
     C                     MOVEL*BLANK    WN0012  1        Operation Facto
     C                     MOVEL*BLANK    WN0013  2        U/M - Third Dft
     C                     MOVEL*BLANK    WN0014  2        U/M - Pricing D
     C                     Z-ADD*ZERO     WN0015 112       Unit Weight
     C                     MOVEL*BLANK    WN0016  2        Quality Level
     C                     MOVEL*BLANK    WN0017  2        Item Level
     C                     MOVEL*BLANK    WN0018  1        Production Date
     C                     MOVEL*BLANK    WN0019  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0020 112       Minimum Weight
     C                     Z-ADD*ZERO     WN0021 112       Maximum Weight
     C                     Z-ADD*ZERO     WN0022  50       Number Cases On
     C                     Z-ADD*ZERO     WN0023  80       Vendor item Def
     C                     Z-ADD*ZERO     WN0024  30       Item Structure
     C                     Z-ADD*ZERO     WN0025  30       Item Structure
     C                     Z-ADD*ZERO     WN0026  30       Item Structure
     C                     MOVEL*BLANK    WN0027  3        Default Commod
     C                     Z-ADD*ZERO     WN0028  30       Transportation
     C                     MOVEL*BLANK    WN0029  3        Item Type Code
     C                     MOVEL*BLANK    WN0030  1        Package Type Co
     C                     Z-ADD*ZERO     WN0031  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0032  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0033  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0034  1        Frozen Make to
     C                     MOVEL*BLANK    WN0035  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0036 112       Std Weight/Head
     C                     Z-ADD*ZERO     WN0037  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0038  7        Commodity Price
     C                     Z-ADD*ZERO     WN0039  52       Pallet Tare Wei
     C                     Z-ADD*ZERO     WN0040  52       Misc Tare Weigh
     C                     Z-ADD*ZERO     WN0041  30       Production Lead
     C                     MOVEL*BLANK    WN0042  3        Packaging Code
     C                     MOVEL*BLANK    WN0043  3        Item Market Cod
     C                     MOVEL*BLANK    WN0044  1        TF Co-Ownership
     C                     Z-ADD*ZERO     WN0045  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0046  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0047  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0048  1        PA Base Avail R
     C                     Z-ADD*ZERO     WN0049 114       PM Pounds per H
     C                     Z-ADD*ZERO     WN0050  74       Item Frt Overag
     C                     Z-ADD*ZERO     WN0051  74       Packages per ca
     C                     Z-ADD*ZERO     WN0052  30       Use/Freeze/Sell
     C                     Z-ADD*ZERO     WN0053 114       PM Batch Size
     C                     Z-ADD*ZERO     WN0054 114       Package Level s
     C                     Z-ADD*ZERO     WN0055  70       Partial Item Co
     C                     Z-ADD*ZERO     WN0056  70       WIP Item Code
     C                     Z-ADD*ZERO     WN0057  70       WIP Reject Code
     C                     Z-ADD*ZERO     WN0058  92       Std Costing Uni
     C                     Z-ADD*ZERO     WN0059  92       FP Std Green We
     C                     Z-ADD*ZERO     WN0060 114       PM Standard LBS
     C                     Z-ADD*ZERO     WN0061 114       PM Raw Meat LBS
     C                     Z-ADD*ZERO     WN0062 114       PM Formula LBS/
     C                     Z-ADD*ZERO     WN0063 114       PM Finished LBS
     C                     MOVEL*BLANK    WN0064  3        SH Unused (was
     C                     Z-ADD*ZERO     WN0065  30       PM R/M Type Cod
     C                     MOVEL*BLANK    WN0066  1        Seconds Item
     C                     MOVEL*BLANK    WN0067  2        Print on Realiz
     C                     MOVEL*BLANK    WN0068  3        Unit Weight Cha
     C                     Z-ADD*ZERO     WN0069 112       Maximum Audit V
     C                     Z-ADD*ZERO     WN0070 112       Minimum Audit V
     C                     Z-ADD*ZERO     WN0071 114       Market Overage
     C                     Z-ADD*ZERO     WN0072 114       Standard Overag
     C                     MOVEL*BLANK    WN0073  1        Item Pricing Op
     C                     Z-ADD*ZERO     WN0074 114       Item Pricing Co
     C                     MOVEL*BLANK    WN0075  3        Default Warehou
     C                     Z-ADD*ZERO     WN0076  30       Company Number
     C                     MOVEL*BLANK    WN0077  3        Price Method De
     C                     MOVEL*BLANK    WN0078  6        Department Code
     C                     MOVEL*BLANK    WN0079  1        Group for Packa
     C                     Z-ADD*ZERO     WN0080  20       Item Category N
     C                     MOVEL*BLANK    WN0081  3        MTO Code
     C                     Z-ADD*ZERO     WN0082  20       Item Category N
     C                     MOVEL*BLANK    WN0083  3        Transp Equip Ty
     C                     Z-ADD*ZERO     WN0084  20       Item Category N
     C                     MOVEL*BLANK    WN0085  3        Item Category C
     C                     Z-ADD*ZERO     WN0086  20       Item Category N
     C                     MOVEL*BLANK    WN0087  3        G/L Sub Code
     C                     Z-ADD*ZERO     WN0088  20       Item Category N
     C                     MOVEL*BLANK    WN0089  3        Item Structure
     C                     Z-ADD*ZERO     WN0090  20       Item Category N
     C                     MOVEL*BLANK    WN0091  3        Item Primal Sch
     C                     Z-ADD*ZERO     WN0092  20       Item Category N
     C                     MOVEL*BLANK    WN0093  3        Item Exc Man Pr
     C                     Z-ADD*ZERO     WN0094  20       Item Category N
     C                     Z-ADD*ZERO     WN0095  20       Item Category N
     C                     MOVEL*BLANK    WN0096  3        Item Category C
     C                     Z-ADD*ZERO     WN0097  20       Item Category N
     C                     MOVEL*BLANK    WN0098  3        Item Category C
     C                     Z-ADD*ZERO     WN0099  50       PM Line Number
     C                     MOVEL*BLANK    WN0100  6        Primal Group Co
     C                     MOVEL*BLANK    WN0101  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0102  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0103  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0104  1        Export/Domestic
     C                     MOVEL*BLANK    WN0105  1        Print On Schedu
     C                     MOVEL*BLANK    WN0106  1        Fresh Inv Alloc
     C                     MOVEL*BLANK    WN0107  1        Fresh Sched As
     C                     MOVEL*BLANK    WN0108  1        Frozen Inv Allo
     C                     MOVEL*BLANK    WN0109 12        Item Meat Cost
     C                     MOVEL*BLANK    WN0110 12        UPC Code 2
     C                     Z-ADD*ZERO     WN0111 112       Item Target Pri
     C                     Z-ADD*ZERO     WN0112 112       Minimum Piece W
     C                     Z-ADD*ZERO     WN0113 112       Maximum Piece W
     C                     Z-ADD*ZERO     WN0114  70       Seaboard Equiva
     C                     Z-ADD*ZERO     WN0115  70       Production Qty
     C                     MOVEL*BLANK    WN0116  1        Scheduling Posi
     C                     MOVEL*BLANK    WN0117  1        Sold 100% Froze
     C                     MOVEL*BLANK    WN0118  1        Maximum Shifts
     C                     MOVEL*BLANK    WN0119  1        Value Added Sts
     C                     MOVEL*BLANK    WN0120  2        Label Type
     C                     MOVEL*BLANK    WN0121  2        Item TF Exempt
     C                     MOVEL*BLANK    WN0122  3        Item TF Classif
     C                     MOVEL*BLANK    WN0123  3        Default Workcen
     C                     MOVEL*BLANK    WN0124  1        EDI Status 1
     C                     MOVEL*BLANK    WN0125  1        EDI Status 2
     C                     MOVEL*BLANK    WN0126  1        EDI Status 3
     C                     MOVEL*BLANK    WN0127  1        Record Status
     C                     Z-ADD*ZERO     WN0128  60       Job Time
     C                     MOVEL*BLANK    WN0129 10        User Id
     C                     MOVEL*BLANK    WN0130 10        Job Name
     C                     Z-ADD*ZERO     WN0131  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BYREA0
     C                     Z-ADDWAHGCD    WBHGCD           Item Code
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBHGCD           Item Code
     C           KLCHSB    CHAIN@BYREA0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMBYREL0'MDACP
     C                     MOVEL'@BYREA0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMBY1    YARDCS
      * Move non-key fields to @BYREA0
     C                     MOVEL'Y'       WBS2CD    P      Item Prod Sched
      *
      * Set PGM.*Record Data Changed flag
     C           QOMBY1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BYREA0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMBYREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAACC8           Vendor item Def
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           Packages per ca
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           Package Level s
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAHTM           Job Time
     C                     Z-ADD*ZERO     WAEKDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
