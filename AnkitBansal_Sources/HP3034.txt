      *****************  RPG PROGRAM HEADING  ************************
      * SYSTEM:      HPS Hog Production
      * PROGRAM:     HP3034 - Workfile: Sire Line Download
      * PROGRAMMER:  LeAnne Ramsey
      * CREATED:     12/19/08
      *
      * FUNCTION:    This program builds a workfile of Sire Line data.
      *
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE       PROGRAMMER
      *
      * 10/18/10  LeAnne Ramsey  (E1079)
      *           Recompile only. Sire Line Company is now 2-characters instead
      *           of one in file HSP098-Sire Lines.
      *‚06/12/24  Jagdish Mistry (WI628)
      *‚          Add paramter to get count of records added in work file.
      /eject
      ****************************************************************
      * FILE SPECIFICATIONS
      ****************************************************************
      *
     Fhsl081d   if   e           k disk
      *  Weekly sire line doses  (records selected with open query)
      *
      *
     Fhsp098    if   e           k disk
      *  Sire lines
      *
      *
     Fhsp3034   o    e           k disk
      *  Workfile: Sire line download
      *
      /eject
      ****************************************************************
      * DEFINITION SPECIFICATIONS
      ****************************************************************
      *
      ****************************************************************
      * CONSTANTS
      ****************************************************************
      *
     D yes             c                   'Y'
     D no              c                   'N'
      *
      ****************************************************************
      * ARRAYS AND TABLES
      ****************************************************************
      *
      ****************************************************************
      * STANDALONE FIELDS
      ****************************************************************
      *
      * Control fields
      *
     D count           s              7  0
      *
      *
      * Parms
      *
     ‚* JM-WI628 06/12/2024 - Get Count of new records added in work file
     D*** xxflag          s              1
     D p1CntNewRecds   S              8  0
     D wkCntNewRecds   S              8  0 Inz(*Zeros)
      *
      ****************************************************************
      * DATA STRUCTURES
      ****************************************************************
      *
      *---------------------------------------------------------------
      * Standard program status data structure
      *---------------------------------------------------------------
      *    externally defined as UTPGFR (record format: PGMDSR)
     D pgmds         esds                  extname(utpgfr)
      *
      *
      * The following is a dummy C-spec to keep the D-specs from
      * running over into the C-specs on the compile listing. It
      * serves no other purpose and can be deleted at any time.
      *
     C                   if        sdpgm = *blank
     C                   endif
      /EJECT
      ****************************************************************
      * MAINLINE
      ****************************************************************
      *
      * Process all Weekly Sire Line Doses records selected by the Open Query.
      * Write a workfile record for each one.
      *
     C                   dou       *in90 = *on                                  Main do
     C                   read      hsl081d                                90
     C                   if        *in90 = *off                                 If not EOF
      *
     C                   z-add     swfscd        w1fscd
     C                   z-add     swdono        w1dono
     C                   move      swsscd        w1sscd
     C                   move      swsicd        w1sicd
      *
      * Get 8,0 date into Date Format field (MMDDYY)
      *
     C                   eval      w1wedt = %date(swwedt:*iso)
      *
      * Retrieve Sire Line info
      *
     C     w1sicd        chain     hsp098                             92
     C                   if        *in92 = *off
     C                   move      sisicomp      w1sicomp
     C                   move      siprime       w1prime
     C                   endif
      *
      *‚JM-WI628 06/12/2024-Get Count of new records added in work file
     C                   Eval      wkCntNewRecds += 1
     C                   write     w1rec
     C                   clear                   w1rec
      *‚JM-WI628 06/12/2024-commented
     C***                   add       1             count
      *
     C                   endif                                                  If not EOF
     C                   enddo                                                  Main do
      *
      *
      * We are going to ultimately e-mail this workfile as an Excel Spreadsheet
      * using Sequel. Rose has warned me that the Excel limit is 66,000 records.
      * When/if you exceed this limit, the "view" goes into "la-la" land.
      * So, we have counted each record that we wrote to the workfile. If it
      * exceeds 66,000, we will send a "too many" message from the CL instead
      * of executing the SQL statement. Likewise, if the "count" is zero, we will
      * issue a "no data extracted; change your selections message".
      *
      *‚JM-WI628 06/12/2024 - Commented
     C***                   select
     C***                   when      count = 0
     C***                   move      'Z'           xxflag
      *
     C***                   when      count >= 66000
     C***                   move      'T'           xxflag
     C***                   other
      *
     C***                   move      *blank        xxflag
     C***                   endsl
      *‚JM-WI628 06/12/2024 - Get Count of new records added in work file
     C                   Eval      p1CntNewRecds = wkCntNewRecds
      *
     C                   seton                                        lr
      /eject
      *---------------------------------------------------------------
      * Initialization subroutine
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
     ‚* JM-WI628 06/12/2024 -Comment existing entry point
     C***     *entry        plist
     C***                   parm                    xxflag
     ‚* JM-WI628 06/12/2024 -Get Count of new records added in work file
     C     *ENTRY        PLIST
     C                   PARM                    p1CntNewRecds
      *
     C                   endsr
      /eject
