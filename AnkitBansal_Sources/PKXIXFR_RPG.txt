     H/TITLE PayEdt Create Crc FIX XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 07/25/22  Time  : 16:31:34
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPLBIF  E           K        DISK
      * RSQ : Tattoo Header             Kill/Ttto Only/Active
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKBVCPL7IF  E           K        DISK
      * RSQ : Evl By Ttto/E/B Dec Hot W
      *
     FPKB1CPL1IF  E           K        DISK
      * RTV : Carcass Detail            Retrieval index
      *
     FPKEKCPL1IF  E           K        DISK
      * RTV : Trim Button               Retrieval index
      *
     FPKBSCPL4IF  E           K        DISK
      * RSQ : Loss Trans                RTV Next#
      *
     FPKB1CPL0IF  E           K        DISK                      A
      * UPD : Carcass Detail            Update index
      *
     FPKBSCPL0IF  E           K        DISK                      A
      * UPD : Loss Trans                Update index
      *
     I@A1CPND
      * Tattoo Header             Kill/Ttto Only/Active
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@A8REDA
      * Hog Classification        Retrieval index
      * Renamed input format fields
     I              A8BECD                          WBBECD
     I              A8BDTX                          WBBDTX
     I              A8BXST                          WBBXST
     I              A8BYST                          WBBYST
     I              A8BITX                          WBBITX
     I              A8B0ST                          WBB0ST
     I              A8FBST                          WBFBST
     I              A8AAVN                          WBAAVN
     I              A8AADT                          WBAADT
     I              A8AMTM                          WBAMTM
     I              A8AJST                          WBAJST
     I              A8AHVN                          WBAHVN
     I              A8AGVN                          WBAGVN
     I              A8ABVN                          WBABVN
     I              A8ABDT                          WBABDT
     I              A8ABTM                          WBABTM
      *
     I@BVCPL7
      * Evl By Ttto/E/B Dec Hot W
      * Renamed input format fields
     I              BVHSNB                          WCHSNB
     I              BVA9DT                          WCA9DT
     I              BVFJNB                          WCFJNB
     I              BVHCNB                          WCHCNB
     I              BVGDNB                          WCGDNB
     I              BVFINB                          WCFINB
     I              BVLKNB                          WCLKNB
     I              BVEAST                          WCEAST
     I              BVAMPC                          WCAMPC
     I              BVAIPC                          WCAIPC
     I              BVAJPC                          WCAJPC
     I              BVAKPC                          WCAKPC
     I              BVX8NB                          WCX8NB
     I              BVFVPC                          WCFVPC
     I              BVFWPC                          WCFWPC
     I              BVFXPC                          WCFXPC
     I              BVALPC                          WCALPC
     I              BVDIST                          WCDIST
     I              BVFYST                          WCFYST
     I              BVD2ST                          WCD2ST
     I              BVEHST                          WCEHST
     I              BVG1ST                          WCG1ST
     I              BVH4ST                          WCH4ST
     I              BVJLST                          WCJLST
     I              BVUUST                          WCUUST
     I              BVVHST                          WCVHST
     I              BVVIST                          WCVIST
     I              BVVJST                          WCVJST
     I              BVVKST                          WCVKST
     I              BVVLST                          WCVLST
     I              BVHMNB                          WCHMNB
     I              BVBNNB                          WCBNNB
     I              BVBONB                          WCBONB
     I              BVCVNB                          WCCVNB
     I              BVB0DT                          WCB0DT
     I              BVAAVN                          WCAAVN
     I              BVAADT                          WCAADT
     I              BVAMTM                          WCAMTM
     I              BVAJST                          WCAJST
     I              BVAHVN                          WCAHVN
     I              BVAGVN                          WCAGVN
     I              BVABVN                          WCABVN
     I              BVABDT                          WCABDT
     I              BVABTM                          WCABTM
     I              BVB8DT                          WCB8DT
     I              BVAOTM                          WCAOTM
      *
     I@B1CPG7
      * Carcass Detail            Retrieval index
      * Renamed input format fields
     I              B1HMNB                          WDHMNB
     I              B1BNNB                          WDBNNB
     I              B1BONB                          WDBONB
     I              B1CVNB                          WDCVNB
     I              B1B0DT                          WDB0DT
     I              B1LGNB                          WDLGNB
     I              B1EUNB                          WDEUNB
     I              B1LHNB                          WDLHNB
     I              B1INST                          WDINST
     I              B1BEPR                          WDBEPR
     I              B1ASPC                          WDASPC
     I              B1EWNB                          WDEWNB
     I              B1B4PR                          WDB4PR
     I              B1EYNB                          WDEYNB
     I              B1B1PR                          WDB1PR
     I              B1AVPR                          WDAVPR
     I              B1AUPC                          WDAUPC
     I              B1AWPR                          WDAWPR
     I              B1AXPR                          WDAXPR
     I              B1EZNB                          WDEZNB
     I              B1AYPR                          WDAYPR
     I              B1BBDT                          WDBBDT
     I              B1AKTM                          WDAKTM
     I              B1IQST                          WDIQST
     I              B1EFST                          WDEFST
     I              B1H6NB                          WDH6NB
     I              B1BEPC                          WDBEPC
     I              B1GCST                          WDGCST
     I              B1GDST                          WDGDST
     I              B1GEST                          WDGEST
     I              B1BHPC                          WDBHPC
     I              B1IOST                          WDIOST
     I              B1IPST                          WDIPST
     I              B1LTNB                          WDLTNB
     I              B1JNST                          WDJNST
     I              B1X4NB                          WDX4NB
     I              B1FNPC                          WDFNPC
     I              B1FOPC                          WDFOPC
     I              B1FPPC                          WDFPPC
     I              B1K2ST                          WDK2ST
     I              B1K3ST                          WDK3ST
     I              B1JWPR                          WDJWPR
     I              B1F5PC                          WDF5PC
     I              B1JXPR                          WDJXPR
     I              B1JYPR                          WDJYPR
     I              B1JZPR                          WDJZPR
     I              B1J0PR                          WDJ0PR
     I              B1J1PR                          WDJ1PR
     I              B1J2PR                          WDJ2PR
     I              B1J3PR                          WDJ3PR
     I              B1J4PR                          WDJ4PR
     I              B1UTST                          WDUTST
     I              B1HVCD                          WDHVCD
     I              B1DKJR                          WDDKJR
     I              B1ITJF                          WDITJF
     I              B1IJGR                          WDIJGR
     I              B1ORJE                          WDORJE
     I              B1OTJR                          WDOTJR
     I              B1PEIR                          WDPEIR
     I              B1IEUF                          WDIEUF
     I              B1ORUE                          WDORUE
     I              B1IUTR                          WDIUTR
     I              B1IJRR                          WDIJRR
     I              B1VCST                          WDVCST
     I              B1VDST                          WDVDST
     I              B1VEST                          WDVEST
     I              B1VFST                          WDVFST
     I              B1VGST                          WDVGST
     I              B1ABCD                          WDABCD
     I              B1AACD                          WDAACD
     I              B1AAVN                          WDAAVN
     I              B1AADT                          WDAADT
     I              B1AMTM                          WDAMTM
     I              B1AJST                          WDAJST
     I              B1AHVN                          WDAHVN
     I              B1AGVN                          WDAGVN
     I              B1ABVN                          WDABVN
     I              B1ABDT                          WDABDT
     I              B1ABTM                          WDABTM
      *
     I@B1CPG6
      * Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WEHMNB
     I              B1BNNB                          WEBNNB
     I              B1BONB                          WEBONB
     I              B1CVNB                          WECVNB
     I              B1B0DT                          WEB0DT
     I              B1LGNB                          WELGNB
     I              B1EUNB                          WEEUNB
     I              B1LHNB                          WELHNB
     I              B1INST                          WEINST
     I              B1BEPR                          WEBEPR
     I              B1ASPC                          WEASPC
     I              B1EWNB                          WEEWNB
     I              B1B4PR                          WEB4PR
     I              B1EYNB                          WEEYNB
     I              B1B1PR                          WEB1PR
     I              B1AVPR                          WEAVPR
     I              B1AUPC                          WEAUPC
     I              B1AWPR                          WEAWPR
     I              B1AXPR                          WEAXPR
     I              B1EZNB                          WEEZNB
     I              B1AYPR                          WEAYPR
     I              B1BBDT                          WEBBDT
     I              B1AKTM                          WEAKTM
     I              B1IQST                          WEIQST
     I              B1EFST                          WEEFST
     I              B1H6NB                          WEH6NB
     I              B1BEPC                          WEBEPC
     I              B1GCST                          WEGCST
     I              B1GDST                          WEGDST
     I              B1GEST                          WEGEST
     I              B1BHPC                          WEBHPC
     I              B1IOST                          WEIOST
     I              B1IPST                          WEIPST
     I              B1LTNB                          WELTNB
     I              B1JNST                          WEJNST
     I              B1X4NB                          WEX4NB
     I              B1FNPC                          WEFNPC
     I              B1FOPC                          WEFOPC
     I              B1FPPC                          WEFPPC
     I              B1K2ST                          WEK2ST
     I              B1K3ST                          WEK3ST
     I              B1JWPR                          WEJWPR
     I              B1F5PC                          WEF5PC
     I              B1JXPR                          WEJXPR
     I              B1JYPR                          WEJYPR
     I              B1JZPR                          WEJZPR
     I              B1J0PR                          WEJ0PR
     I              B1J1PR                          WEJ1PR
     I              B1J2PR                          WEJ2PR
     I              B1J3PR                          WEJ3PR
     I              B1J4PR                          WEJ4PR
     I              B1UTST                          WEUTST
     I              B1HVCD                          WEHVCD
     I              B1DKJR                          WEDKJR
     I              B1ITJF                          WEITJF
     I              B1IJGR                          WEIJGR
     I              B1ORJE                          WEORJE
     I              B1OTJR                          WEOTJR
     I              B1PEIR                          WEPEIR
     I              B1IEUF                          WEIEUF
     I              B1ORUE                          WEORUE
     I              B1IUTR                          WEIUTR
     I              B1IJRR                          WEIJRR
     I              B1VCST                          WEVCST
     I              B1VDST                          WEVDST
     I              B1VEST                          WEVEST
     I              B1VFST                          WEVFST
     I              B1VGST                          WEVGST
     I              B1ABCD                          WEABCD
     I              B1AACD                          WEAACD
     I              B1AAVN                          WEAAVN
     I              B1AADT                          WEAADT
     I              B1AMTM                          WEAMTM
     I              B1AJST                          WEAJST
     I              B1AHVN                          WEAHVN
     I              B1AGVN                          WEAGVN
     I              B1ABVN                          WEABVN
     I              B1ABDT                          WEABDT
     I              B1ABTM                          WEABTM
      *
     I@EKCPB4
      * Trim Button               Retrieval index
      * Renamed input format fields
     I              EKHONB                          WFHONB
     I              EKTEST                          WFTEST
     I              EKTFST                          WFTFST
     I              EKTGST                          WFTGST
     I              EKGQPC                          WFGQPC
     I              EKAAVN                          WFAAVN
     I              EKAADT                          WFAADT
     I              EKAMTM                          WFAMTM
     I              EKAJST                          WFAJST
     I              EKAHVN                          WFAHVN
     I              EKAGVN                          WFAGVN
     I              EKABVN                          WFABVN
     I              EKABDT                          WFABDT
     I              EKABTM                          WFABTM
      *
     IZBSCPNG
      * Loss Trans                RTV Next#
      * Renamed input format fields
     I              BSHUNB                          WGHUNB
     I              BSA7DT                          WGA7DT
     I              BSFHNB                          WGFHNB
     I              BSFFNB                          WGFFNB
     I              BSEBST                          WGEBST
     I              BSDSNB                          WGDSNB
     I              BSS3NB                          WGS3NB
     I              BSS4NB                          WGS4NB
     I              BSD1ST                          WGD1ST
     I              BSH5ST                          WGH5ST
     I              BSJMST                          WGJMST
     I              BSSMST                          WGSMST
     I              BSBWCD                          WGBWCD
     I              BSBYCD                          WGBYCD
     I              BSHMNB                          WGHMNB
     I              BSBNNB                          WGBNNB
     I              BSBONB                          WGBONB
     I              BSCVNB                          WGCVNB
     I              BSB0DT                          WGB0DT
     I              BSAAVN                          WGAAVN
     I              BSAADT                          WGAADT
     I              BSAMTM                          WGAMTM
     I              BSAJST                          WGAJST
     I              BSAHVN                          WGAHVN
     I              BSAGVN                          WGAGVN
     I              BSABVN                          WGABVN
     I              BSABDT                          WGABDT
     I              BSABTM                          WGABTM
     I              BSB8DT                          WGB8DT
     I              BSAOTM                          WGAOTM
      *
     I@BSCPFS
      * Loss Trans                Update index
      * Renamed input format fields
     I              BSHUNB                          WHHUNB
     I              BSA7DT                          WHA7DT
     I              BSFHNB                          WHFHNB
     I              BSFFNB                          WHFFNB
     I              BSEBST                          WHEBST
     I              BSDSNB                          WHDSNB
     I              BSS3NB                          WHS3NB
     I              BSS4NB                          WHS4NB
     I              BSD1ST                          WHD1ST
     I              BSH5ST                          WHH5ST
     I              BSJMST                          WHJMST
     I              BSSMST                          WHSMST
     I              BSBWCD                          WHBWCD
     I              BSBYCD                          WHBYCD
     I              BSHMNB                          WHHMNB
     I              BSBNNB                          WHBNNB
     I              BSBONB                          WHBONB
     I              BSCVNB                          WHCVNB
     I              BSB0DT                          WHB0DT
     I              BSAAVN                          WHAAVN
     I              BSAADT                          WHAADT
     I              BSAMTM                          WHAMTM
     I              BSAJST                          WHAJST
     I              BSAHVN                          WHAHVN
     I              BSAGVN                          WHAGVN
     I              BSABVN                          WHABVN
     I              BSABDT                          WHABDT
     I              BSABTM                          WHABTM
     I              BSB8DT                          WHB8DT
     I              BSAOTM                          WHAOTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WEHMNB
     I              B1BNNB                          WEBNNB
     I              B1BONB                          WEBONB
     I              B1CVNB                          WECVNB
     I              B1B0DT                          WEB0DT
     I              B1LGNB                          WELGNB
     I              B1EUNB                          WEEUNB
     I              B1LHNB                          WELHNB
     I              B1INST                          WEINST
     I              B1BEPR                          WEBEPR
     I              B1ASPC                          WEASPC
     I              B1EWNB                          WEEWNB
     I              B1B4PR                          WEB4PR
     I              B1EYNB                          WEEYNB
     I              B1B1PR                          WEB1PR
     I              B1AVPR                          WEAVPR
     I              B1AUPC                          WEAUPC
     I              B1AWPR                          WEAWPR
     I              B1AXPR                          WEAXPR
     I              B1EZNB                          WEEZNB
     I              B1AYPR                          WEAYPR
     I              B1BBDT                          WEBBDT
     I              B1AKTM                          WEAKTM
     I              B1IQST                          WEIQST
     I              B1EFST                          WEEFST
     I              B1H6NB                          WEH6NB
     I              B1BEPC                          WEBEPC
     I              B1GCST                          WEGCST
     I              B1GDST                          WEGDST
     I              B1GEST                          WEGEST
     I              B1BHPC                          WEBHPC
     I              B1IOST                          WEIOST
     I              B1IPST                          WEIPST
     I              B1LTNB                          WELTNB
     I              B1JNST                          WEJNST
     I              B1X4NB                          WEX4NB
     I              B1FNPC                          WEFNPC
     I              B1FOPC                          WEFOPC
     I              B1FPPC                          WEFPPC
     I              B1K2ST                          WEK2ST
     I              B1K3ST                          WEK3ST
     I              B1JWPR                          WEJWPR
     I              B1F5PC                          WEF5PC
     I              B1JXPR                          WEJXPR
     I              B1JYPR                          WEJYPR
     I              B1JZPR                          WEJZPR
     I              B1J0PR                          WEJ0PR
     I              B1J1PR                          WEJ1PR
     I              B1J2PR                          WEJ2PR
     I              B1J3PR                          WEJ3PR
     I              B1J4PR                          WEJ4PR
     I              B1UTST                          WEUTST
     I              B1HVCD                          WEHVCD
     I              B1DKJR                          WEDKJR
     I              B1ITJF                          WEITJF
     I              B1IJGR                          WEIJGR
     I              B1ORJE                          WEORJE
     I              B1OTJR                          WEOTJR
     I              B1PEIR                          WEPEIR
     I              B1IEUF                          WEIEUF
     I              B1ORUE                          WEORUE
     I              B1IUTR                          WEIUTR
     I              B1IJRR                          WEIJRR
     I              B1VCST                          WEVCST
     I              B1VDST                          WEVDST
     I              B1VEST                          WEVEST
     I              B1VFST                          WEVFST
     I              B1VGST                          WEVGST
     I              B1ABCD                          WEABCD
     I              B1AACD                          WEAACD
     I              B1AAVN                          WEAAVN
     I              B1AADT                          WEAADT
     I              B1AMTM                          WEAMTM
     I              B1AJST                          WEAJST
     I              B1AHVN                          WEAHVN
     I              B1AGVN                          WEAGVN
     I              B1ABVN                          WEABVN
     I              B1ABDT                          WEABDT
     I              B1ABTM                          WEABTM
      *
     IQPKBS1    E DSPKBSCPL0
      * UPD : Loss Trans                Update index
      * Renamed input format fields
     I              BSHUNB                          WHHUNB
     I              BSA7DT                          WHA7DT
     I              BSFHNB                          WHFHNB
     I              BSFFNB                          WHFFNB
     I              BSEBST                          WHEBST
     I              BSDSNB                          WHDSNB
     I              BSS3NB                          WHS3NB
     I              BSS4NB                          WHS4NB
     I              BSD1ST                          WHD1ST
     I              BSH5ST                          WHH5ST
     I              BSJMST                          WHJMST
     I              BSSMST                          WHSMST
     I              BSBWCD                          WHBWCD
     I              BSBYCD                          WHBYCD
     I              BSHMNB                          WHHMNB
     I              BSBNNB                          WHBNNB
     I              BSBONB                          WHBONB
     I              BSCVNB                          WHCVNB
     I              BSB0DT                          WHB0DT
     I              BSAAVN                          WHAAVN
     I              BSAADT                          WHAADT
     I              BSAMTM                          WHAMTM
     I              BSAJST                          WHAJST
     I              BSAHVN                          WHAHVN
     I              BSAGVN                          WHAGVN
     I              BSABVN                          WHABVN
     I              BSABDT                          WHABDT
     I              BSABTM                          WHABTM
     I              BSB8DT                          WHB8DT
     I              BSAOTM                          WHAOTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * I :  TH Tattoo Number
     I                                    P   3   50P1CVNB
      * I :  TH Kill Date
     I                                    P   6   90P1B0DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1CVNB    PARM           WP0002  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0003  70       TH Kill Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PayEdt Create Crc FIX XF
      * H16853 ISE 11/05/2020-Recompiled due to change in Buy Order Numbe
      * PayEdt Create Crc FIX RT - Tattoo Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PayEdt Create Crc FIX RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 111       Live wgt total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSA02           TH Kill Date
     C           *LIKE     DEFN WACVNB    WQSA03           TH Tattoo Numbe
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           TH Kill Date
     C                     KFLD           WQSA03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           BOH Company Num
     C                     Z-ADDP1B0DT    WQSA02           TH Kill Date
     C                     Z-ADDP1CVNB    WQSA03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSA     SETLL@A1CPND                    *
     C           KRSSA     READE@A1CPND                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Held Over is *Zeros
     C           WAH9NB    IFEQ 0                          *IF
      * Rtv Hog Class         RT - Hog Classification  * 
     C                     EXSR SBRVGN
     C                     Z-ADD*ZERO     YL0001           CD Carcass Numb
     C                     Z-ADD*ZERO     WN0001           Live wgt total
      * Read the Evaluation trans and create Carcass Detail Records
      * PayEdt Create Crc FIX RT - Eval Trans  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Hog Class         RT - Hog Classification  * 
     C                     EXSR SIRVGN
     C                     Z-ADD*ZERO     YL0001           CD Carcass Numb
     C                     Z-ADD*ZERO     WN0001           Live wgt total
      * Read the Evaluation trans and create Carcass Detail Records
      * PayEdt Create Crc FIX RT - Eval Trans  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
     C           KRSSA     READE@A1CPND                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Hog Class         RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBBECD           HC Class Code
      * Setup key
     C                     MOVELWABECD    WBBECD           HC Class Code
      * Establish starting position
     C           KRSSB     CHAIN@A8REDA              90    *
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBDTX    WUBDTX           HC Description
     C                     MOVELWBBXST    WUBXST           HC Defect Requi
     C                     MOVELWBBYST    WUBYST           HC Price Requir
     C                     MOVELWBBITX    WUBITX           HC Resolution
     C                     MOVELWBB0ST    WUB0ST           HC Qualificatio
     C                     MOVELWBFBST    WUFBST           HC Class Type
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * PayEdt Create Crc FIX RT - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002 112       Live Weight 11.
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSC03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSC04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSC05           TH Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
     C                     KFLD           WQSC04           TH Tattoo Numbe
     C                     KFLD           WQSC05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSC01           BOH Company Num
     C                     Z-ADDWABNNB    WQSC02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSC03           BOL Load Number
     C                     Z-ADDWACVNB    WQSC04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSC05           TH Kill Date
      * Establish starting position
     C           KRSSC     SETLL@BVCPL7                    *
     C           KRSSC     READE@BVCPL7                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
     C                     ADD  1         YL0001           CD Carcass Numb
      * Producer/Farm Site
      * CASE: PAR.TH Source Type is External
     C           WAKAST    IFEQ 'E'                        *IF
     C                     MOVELWAAECD    YL0002           PL Location Cod
     C                     ELSE
      * CASE: PAR.TH Source Type is Internal
     C           WAKAST    IFEQ 'I'                        *IF
     C                     Z-ADDWATHHD    YL0003           Farm Site 6.0 U
     C                     MOVEL*BLANK    YL0002           PL Location Cod
     C                     MOVELYL0003    YL0002           PL Location Cod
     C                     END                             *FI
     C                     END                             *FI
      * Crt Carcass Detail    Rt - Carcass Detail  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C           KRSSC     READE@BVCPL7                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Crt Carcass Detail    Rt - Carcass Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0003  2        TB Trim Locatio
     C                     MOVEL*BLANK    WN0004  2        TB Extent
     C                     Z-ADD*ZERO     WN0005  74       Loss Percent
     C                     Z-ADD*ZERO     WN0006  74       Loss Percent
     C                     Z-ADD*ZERO     WN0007  60       LTN Record Numb
     C                     Z-ADD*ZERO     WN0008  71       LTN Wgt
     C                     MOVEL*BLANK    WN0009  2        LTN Extent
     C                     MOVEL*BLANK    WN0010  2        LTN Trim Locati
     C                     Z-ADD*ZERO     WN0011  71       LTA Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDLGNB           CD Scale Sequen
     C                     KFLD           WDEUNB           CD Carcass Numb
     C                     KFLD           WDLHNB           CD Carcass Numb
      * Setup key
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
     C                     Z-ADDWCFJNB    WDLGNB           CD Scale Sequen
     C                     Z-ADDYL0001    WDEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WDLHNB           CD Carcass Numb
      * Establish starting position
     C           KRSSD     CHAIN@B1CPG7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0138' W0RTN   7
      * USER: Processing if Data record not found
      * 9/20/02  RMC  -- Calc 2 dec. backfat and loin eye
      *   and accum weighted for TH Avg Backf & Loin eye calc
      * CLC MM to Inch -2 dec XF - Eval Trans  * 
     C                     CALL 'PKMMINC2'             90  CLC MM to Inch
     C                     PARM *BLANK    W0RTN   7
     C           YL0018    PARM YL0018    WQ0001  52       CD Backfat Inch
     C           YL0019    PARM YL0019    WQ0002  52       CD Loin Eye Inc
     C                     PARM WCX8NB    WQ0003  31       CD Backfat Thic
     C                     PARM WCFVPC    WQ0004  31       CD Loin-Eye Dep
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKMMINC2'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Accum: Backfat * wgt
      * PAR.Backfat * Wgt USR =
      *    *COMPUTE (x1 * x2 + x3)
      * x1    : LCL.CD Backfat Inch - 2 dec
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.CD Carcass/Hot Weight
      * +     : PGM.*Synon (15,2) work field
      * x3    : PAR.Backfat * Wgt USR
     C           YL0018    MULT WCAMPC    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0017    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           Backfat * Wgt U
      * Accum: Loin eye * wgt
      * PAR.Loin-Eye * Wgt USR =
      *    *COMPUTE (x1 * x2 + x3)
      * x1    : LCL.CD Loin Eye Inch - 2 dec
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.CD Carcass/Hot Weight
      * +     : PGM.*Synon (15,2) work field
      * x3    : PAR.Loin-Eye * Wgt USR
     C           YL0019    MULT WCAMPC    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0016    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           Loin-Eye * Wgt
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SECRRC
      * PK0071 Fat-O-Meter
      * CASE: PAR.CD Trim Area is *Blank
     C           WCDIST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Loss Percent       RT - Trim Button  * 
     C                     EXSR SFRVGN
     C           WN0005    DIV  100       WN0006           Loss Percent
     C           WCAMPC    MULT WN0006    WN0011           LTA Wgt
      * Rtv Loss Trans Next   RT - Loss Trans  * 
     C                     EXSR SGRVGN
      * Crt Loss Transaction  CR - Loss Trans  * 
     C                     EXSR SHCRRC
     C                     END                             *FI
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADDWCHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WEBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWCFJNB    WELGNB           CD Scale Sequen
     C                     Z-ADDYL0001    WEEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WELHNB           CD Carcass Numb
     C                     MOVELWCEHST    WEINST           CD Record Add/D
     C                     Z-ADDYL0004    WEBEPR           CD Sort Loss
     C                     Z-ADDYL0005    WEASPC           CD STD Yield
     C                     Z-ADDWCAMPC    WEEWNB           CD Carcass/Hot
     C                     Z-ADDYL0006    WEB4PR           CD Base Carcass
     C                     Z-ADDYL0007    WEEYNB           CD Crc Value Pe
     C                     Z-ADDYL0008    WEB1PR           CD Base Carc Va
     C                     Z-ADDYL0009    WEAVPR           CD Crc Value $
     C                     Z-ADDWCAKPC    WEAUPC           CD Lean Percent
     C                     Z-ADDYL0010    WEAWPR           CD Lean Premium
     C                     Z-ADDYL0011    WEAXPR           CD Lean Premium
     C                     Z-ADDYL0012    WEEZNB           CD Gross Value
     C                     Z-ADDYL0013    WEAYPR           CD Gross Value
     C                     Z-ADDWCA9DT    WEBBDT           CD Kill Date
     C                     Z-ADDWCAOTM    WEAKTM           CD Kill Time
     C                     MOVELWCEAST    WEIQST           CD Shift
     C                     MOVELYL0014    WEEFST           CD Carcass Acti
     C                     Z-ADDWCAIPC    WEH6NB           CD Backfat Thic
     C                     Z-ADDWCAJPC    WEBEPC           CD Loin-Eye Dep
     C                     Z-ADDWCALPC    WEGCST           CD Light Reflec
     C                     MOVELWCDIST    WEGDST           CD Trim Area
     C                     MOVELWCFYST    WEGEST           CD Carcass Sex
     C                     Z-ADDYL0015    WEBHPC           CD FFLI
     C                     MOVELWCG1ST    WEIOST           CD Record Creat
     C                     MOVELWCH4ST    WEIPST           CD Record Creat
     C                     Z-ADDWCLKNB    WELTNB           CD LOT
     C                     MOVELWCJLST    WEJNST           CD User Error O
     C                     Z-ADDWCX8NB    WEX4NB           CD Backfat Thic
     C                     Z-ADDWCFVPC    WEFNPC           CD Loin-Eye Dep
     C                     Z-ADDWCFWPC    WEFOPC           CD Light Reflec
     C                     Z-ADDWCFXPC    WEFPPC           CD Lean Percent
     C                     MOVELWAKAST    WEK2ST           CD Source Type
     C                     MOVELWAJ9ST    WEK3ST           CD Payment Type
     C                     Z-ADDWUJWPR    WEJWPR           CD CA Sort Loss
     C                     Z-ADDWUF5PC    WEF5PC           CD CA Std Yield
     C                     Z-ADDWUJXPR    WEJXPR           CD CA Base Carc
     C                     Z-ADDWUJYPR    WEJYPR           CD CA Crc Value
     C                     Z-ADDWUJZPR    WEJZPR           CD CA Base Carc
     C                     Z-ADDWUJ0PR    WEJ0PR           CD CA Crc Value
     C                     Z-ADDWUJ1PR    WEJ1PR           CD CA Lean Prem
     C                     Z-ADDWUJ2PR    WEJ2PR           CD CA Lean Prem
     C                     Z-ADDWUJ3PR    WEJ3PR           CD CA Gross Val
     C                     Z-ADDWUJ4PR    WEJ4PR           CD CA Gross Val
     C                     MOVELWCUUST    WEUTST           CD Adjust/Add T
     C                     MOVELYL0002    WEHVCD           CD Producer Loc
     C                     Z-ADDYL0019    WEDKJR           CD Loin Eye Inc
     C                     Z-ADDYL0018    WEITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WEIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WEORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WEOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WEPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WEIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WEORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WEIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WEIJRR           CD Gross Before
     C                     MOVEL'0'       WEVCST           CD Broken Back
     C                     MOVELWUVDST    WEVDST           CD Adjust/Add S
     C                     MOVELWUVEST    WEVEST           CD Unused Sts 3
     C                     MOVELWUVFST    WEVFST           CD Unused Sts 4
     C                     MOVELWUVGST    WEVGST           CD Unused Sts 5
     C                     MOVELWAABCD    WEABCD           PD Producer Cod
     C                     MOVELWALKST    WEAACD           SR Source Code
     C                     MOVELWUAAVN    WEAAVN           RS User Changed
     C                     Z-ADDWUAADT    WEAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WEAMTM           RS Time Changed
     C                     MOVELWUAJST    WEAJST           RS Record Statu
     C                     MOVELWUAHVN    WEAHVN           RS Job
     C                     MOVELWUAGVN    WEAGVN           RS Program
     C                     MOVELWUABVN    WEABVN           RS User Added
     C                     Z-ADDWUABDT    WEABDT           RS Date Added
     C                     Z-ADDWUABTM    WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEABDT    PARM *ZERO     WQ0005  70       *DATE
     C           WEABTM    PARM *ZERO     WQ0006  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WELGNB           CD Scale Sequen
     C                     KFLD           WEEUNB           CD Carcass Numb
     C                     KFLD           WELHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSE    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Loss Percent       RT - Trim Button  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFHONB           CC Company Numb
     C                     KFLD           WFTEST           TB Trim Area
      * Setup key
     C                     Z-ADDWCHMNB    WFHONB           CC Company Numb
     C                     MOVELWCDIST    WFTEST           TB Trim Area
      * Establish starting position
     C           KRSSF     CHAIN@EKCPB4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0870' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0003           TB Trim Locatio
     C                     MOVEL*BLANK    WN0004           TB Extent
     C                     Z-ADD*ZERO     WN0005           Loss Percent
     C                     GOTO SFEXIT                     *QUIT
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFTFST    WN0003           TB Trim Locatio
     C                     MOVELWFTGST    WN0004           TB Extent
     C                     Z-ADDWFGQPC    WN0005           Loss Percent
     C                     GOTO SFEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Loss Trans Next   RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHUNB    WQSG01           LTN Company Num
     C           *LIKE     DEFN WGA7DT    WQSG02           LTN Kill Date
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           LTN Company Num
     C                     KFLD           WQSG02           LTN Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQSG01           LTN Company Num
     C                     Z-ADDWCB0DT    WQSG02           LTN Kill Date
      * Establish starting position
     C           KRSSG     SETLLZBSCPNG                    *
     C           KRSSG     READEZBSCPNG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0115' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0007           LTN Record Numb
     C                     GOTO SGEXIT                     *QUIT
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LTN Record Number is Entry Allowed
     C           WGFHNB    IFGE 000001                     *IF
     C           WGFHNB    ANDLE699999
     C           WGFHNB    ADD  1         WN0007           LTN Record Numb
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READEZBSCPNG                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt Loss Transaction  CR - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BSCPFS
     C                     Z-ADDWCHMNB    WHHUNB           LTN Company Num
     C                     Z-ADDWCB0DT    WHA7DT           LTN Kill Date
     C                     Z-ADDWN0007    WHFHNB           LTN Record Numb
     C                     Z-ADDWCCVNB    WHFFNB           LTN Tattoo Numb
     C                     MOVELWCEAST    WHEBST           LTN Shift
     C                     Z-ADDWN0011    WHDSNB           LTN Wgt
     C                     MOVELWN0004    WHS3NB           LTN Extent
     C                     MOVELWN0003    WHS4NB           LTN Trim Locati
     C                     MOVEL'B'       WHD1ST           LTN Error Sts
     C                     MOVEL'P'       WHH5ST           LTN Record Crea
     C                     MOVEL*BLANK    WHJMST           LTN User Error
     C                     MOVELWAKAST    WHSMST           LTN Source Type
     C                     Z-ADD03        WHBWCD           LT Type Code
     C                     Z-ADD*ZERO     WHBYCD           LR Reason Code
     C                     Z-ADDWCHMNB    WHHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WHBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WHCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WHB0DT           TH Kill Date
     C                     MOVELWUAAVN    WHAAVN           RS User Changed
     C                     Z-ADDWUAADT    WHAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WHAMTM           RS Time Changed
     C                     MOVELWUAJST    WHAJST           RS Record Statu
     C                     MOVELWUAHVN    WHAHVN           RS Job
     C                     MOVELWUAGVN    WHAGVN           RS Program
     C                     MOVELWUABVN    WHABVN           RS User Added
     C                     Z-ADDWUABDT    WHABDT           RS Date Added
     C                     Z-ADDWUABTM    WHABTM           RS Time Added
     C                     Z-ADD##JDT     WHB8DT           RU Date
     C                     Z-ADD##JTM     WHAOTM           RU Time
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WHAJST           RS Record Statu
     C                     MOVEL##USR     WHABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WHABDT    PARM *ZERO     WQ0007  70       *DATE
     C           WHABTM    PARM *ZERO     WQ0008  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WHAGVN           RS Program
     C                     MOVEL##JOB     WHAHVN           RS Job
     C           KLCRSH    KLIST
     C                     KFLD           WHHUNB           LTN Company Num
     C                     KFLD           WHA7DT           LTN Kill Date
     C                     KFLD           WHFHNB           LTN Record Numb
      * Check for duplicate primary key
     C           KLCRSH    SETLL@BSCPFS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0116' W0RTN   7
      * Send message 'Loss Trans             EX'
     C                     MOVEL'PRK0116' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@BSCPFS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Hog Class         RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WBBECD           HC Class Code
      * Setup key
     C                     MOVELWABECD    WBBECD           HC Class Code
      * Establish starting position
     C           KRSSI     CHAIN@A8REDA              90    *
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBDTX    WUBDTX           HC Description
     C                     MOVELWBBXST    WUBXST           HC Defect Requi
     C                     MOVELWBBYST    WUBYST           HC Price Requir
     C                     MOVELWBBITX    WUBITX           HC Resolution
     C                     MOVELWBB0ST    WUB0ST           HC Qualificatio
     C                     MOVELWBFBST    WUFBST           HC Class Type
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * PayEdt Create Crc FIX RT - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0012 112       Live Weight 11.
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSJ03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSJ04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSJ05           TH Kill Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
     C                     KFLD           WQSJ04           TH Tattoo Numbe
     C                     KFLD           WQSJ05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSJ01           BOH Company Num
     C                     Z-ADDWABNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSJ03           BOL Load Number
     C                     Z-ADDWACVNB    WQSJ04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSJ05           TH Kill Date
      * Establish starting position
     C           KRSSJ     SETLL@BVCPL7                    *
     C           KRSSJ     READE@BVCPL7                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
     C                     ADD  1         YL0001           CD Carcass Numb
      * Producer/Farm Site
      * CASE: PAR.TH Source Type is External
     C           WAKAST    IFEQ 'E'                        *IF
     C                     MOVELWAAECD    YL0002           PL Location Cod
     C                     ELSE
      * CASE: PAR.TH Source Type is Internal
     C           WAKAST    IFEQ 'I'                        *IF
     C                     Z-ADDWATHHD    YL0003           Farm Site 6.0 U
     C                     MOVEL*BLANK    YL0002           PL Location Cod
     C                     MOVELYL0003    YL0002           PL Location Cod
     C                     END                             *FI
     C                     END                             *FI
      * Crt Carcass Detail    Rt - Carcass Detail  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     C           KRSSJ     READE@BVCPL7                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Crt Carcass Detail    Rt - Carcass Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0013  2        TB Trim Locatio
     C                     MOVEL*BLANK    WN0014  2        TB Extent
     C                     Z-ADD*ZERO     WN0015  74       Loss Percent
     C                     Z-ADD*ZERO     WN0016  74       Loss Percent
     C                     Z-ADD*ZERO     WN0017  60       LTN Record Numb
     C                     Z-ADD*ZERO     WN0018  71       LTN Wgt
     C                     MOVEL*BLANK    WN0019  2        LTN Extent
     C                     MOVEL*BLANK    WN0020  2        LTN Trim Locati
     C                     Z-ADD*ZERO     WN0021  71       LTA Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDLGNB           CD Scale Sequen
     C                     KFLD           WDEUNB           CD Carcass Numb
     C                     KFLD           WDLHNB           CD Carcass Numb
      * Setup key
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
     C                     Z-ADDWCFJNB    WDLGNB           CD Scale Sequen
     C                     Z-ADDYL0001    WDEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WDLHNB           CD Carcass Numb
      * Establish starting position
     C           KRSSK     CHAIN@B1CPG7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0138' W0RTN   7
      * USER: Processing if Data record not found
      * 9/20/02  RMC  -- Calc 2 dec. backfat and loin eye
      *   and accum weighted for TH Avg Backf & Loin eye calc
      * CLC MM to Inch -2 dec XF - Eval Trans  * 
     C                     CALL 'PKMMINC2'             90  CLC MM to Inch
     C                     PARM *BLANK    W0RTN   7
     C           YL0018    PARM YL0018    WQ0009  52       CD Backfat Inch
     C           YL0019    PARM YL0019    WQ0010  52       CD Loin Eye Inc
     C                     PARM WCX8NB    WQ0011  31       CD Backfat Thic
     C                     PARM WCFVPC    WQ0012  31       CD Loin-Eye Dep
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKMMINC2'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Accum: Backfat * wgt
      * PAR.Backfat * Wgt USR =
      *    *COMPUTE (x1 * x2 + x3)
      * x1    : LCL.CD Backfat Inch - 2 dec
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.CD Carcass/Hot Weight
      * +     : PGM.*Synon (15,2) work field
      * x3    : PAR.Backfat * Wgt USR
     C           YL0018    MULT WCAMPC    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0017    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           Backfat * Wgt U
      * Accum: Loin eye * wgt
      * PAR.Loin-Eye * Wgt USR =
      *    *COMPUTE (x1 * x2 + x3)
      * x1    : LCL.CD Loin Eye Inch - 2 dec
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.CD Carcass/Hot Weight
      * +     : PGM.*Synon (15,2) work field
      * x3    : PAR.Loin-Eye * Wgt USR
     C           YL0019    MULT WCAMPC    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0016    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           Loin-Eye * Wgt
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SLCRRC
      * PK0071 Fat-O-Meter
      * CASE: PAR.CD Trim Area is *Blank
     C           WCDIST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Loss Percent       RT - Trim Button  * 
     C                     EXSR SMRVGN
     C           WN0015    DIV  100       WN0016           Loss Percent
     C           WCAMPC    MULT WN0016    WN0021           LTA Wgt
      * Rtv Loss Trans Next   RT - Loss Trans  * 
     C                     EXSR SNRVGN
      * Crt Loss Transaction  CR - Loss Trans  * 
     C                     EXSR SOCRRC
     C                     END                             *FI
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADDWCHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WEBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWCFJNB    WELGNB           CD Scale Sequen
     C                     Z-ADDYL0001    WEEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WELHNB           CD Carcass Numb
     C                     MOVELWCEHST    WEINST           CD Record Add/D
     C                     Z-ADDYL0004    WEBEPR           CD Sort Loss
     C                     Z-ADDYL0005    WEASPC           CD STD Yield
     C                     Z-ADDWCAMPC    WEEWNB           CD Carcass/Hot
     C                     Z-ADDYL0006    WEB4PR           CD Base Carcass
     C                     Z-ADDYL0007    WEEYNB           CD Crc Value Pe
     C                     Z-ADDYL0008    WEB1PR           CD Base Carc Va
     C                     Z-ADDYL0009    WEAVPR           CD Crc Value $
     C                     Z-ADDWCAKPC    WEAUPC           CD Lean Percent
     C                     Z-ADDYL0010    WEAWPR           CD Lean Premium
     C                     Z-ADDYL0011    WEAXPR           CD Lean Premium
     C                     Z-ADDYL0012    WEEZNB           CD Gross Value
     C                     Z-ADDYL0013    WEAYPR           CD Gross Value
     C                     Z-ADDWCA9DT    WEBBDT           CD Kill Date
     C                     Z-ADDWCAOTM    WEAKTM           CD Kill Time
     C                     MOVELWCEAST    WEIQST           CD Shift
     C                     MOVELYL0014    WEEFST           CD Carcass Acti
     C                     Z-ADDWCAIPC    WEH6NB           CD Backfat Thic
     C                     Z-ADDWCAJPC    WEBEPC           CD Loin-Eye Dep
     C                     Z-ADDWCALPC    WEGCST           CD Light Reflec
     C                     MOVELWCDIST    WEGDST           CD Trim Area
     C                     MOVELWCFYST    WEGEST           CD Carcass Sex
     C                     Z-ADDYL0015    WEBHPC           CD FFLI
     C                     MOVELWCG1ST    WEIOST           CD Record Creat
     C                     MOVELWCH4ST    WEIPST           CD Record Creat
     C                     Z-ADDWCLKNB    WELTNB           CD LOT
     C                     MOVELWCJLST    WEJNST           CD User Error O
     C                     Z-ADDWCX8NB    WEX4NB           CD Backfat Thic
     C                     Z-ADDWCFVPC    WEFNPC           CD Loin-Eye Dep
     C                     Z-ADDWCFWPC    WEFOPC           CD Light Reflec
     C                     Z-ADDWCFXPC    WEFPPC           CD Lean Percent
     C                     MOVELWAKAST    WEK2ST           CD Source Type
     C                     MOVELWAJ9ST    WEK3ST           CD Payment Type
     C                     Z-ADDWUJWPR    WEJWPR           CD CA Sort Loss
     C                     Z-ADDWUF5PC    WEF5PC           CD CA Std Yield
     C                     Z-ADDWUJXPR    WEJXPR           CD CA Base Carc
     C                     Z-ADDWUJYPR    WEJYPR           CD CA Crc Value
     C                     Z-ADDWUJZPR    WEJZPR           CD CA Base Carc
     C                     Z-ADDWUJ0PR    WEJ0PR           CD CA Crc Value
     C                     Z-ADDWUJ1PR    WEJ1PR           CD CA Lean Prem
     C                     Z-ADDWUJ2PR    WEJ2PR           CD CA Lean Prem
     C                     Z-ADDWUJ3PR    WEJ3PR           CD CA Gross Val
     C                     Z-ADDWUJ4PR    WEJ4PR           CD CA Gross Val
     C                     MOVELWCUUST    WEUTST           CD Adjust/Add T
     C                     MOVELYL0002    WEHVCD           CD Producer Loc
     C                     Z-ADDYL0019    WEDKJR           CD Loin Eye Inc
     C                     Z-ADDYL0018    WEITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WEIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WEORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WEOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WEPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WEIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WEORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WEIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WEIJRR           CD Gross Before
     C                     MOVEL'0'       WEVCST           CD Broken Back
     C                     MOVELWUVDST    WEVDST           CD Adjust/Add S
     C                     MOVELWUVEST    WEVEST           CD Unused Sts 3
     C                     MOVELWUVFST    WEVFST           CD Unused Sts 4
     C                     MOVELWUVGST    WEVGST           CD Unused Sts 5
     C                     MOVELWAABCD    WEABCD           PD Producer Cod
     C                     MOVELWALKST    WEAACD           SR Source Code
     C                     MOVELWUAAVN    WEAAVN           RS User Changed
     C                     Z-ADDWUAADT    WEAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WEAMTM           RS Time Changed
     C                     MOVELWUAJST    WEAJST           RS Record Statu
     C                     MOVELWUAHVN    WEAHVN           RS Job
     C                     MOVELWUAGVN    WEAGVN           RS Program
     C                     MOVELWUABVN    WEABVN           RS User Added
     C                     Z-ADDWUABDT    WEABDT           RS Date Added
     C                     Z-ADDWUABTM    WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEABDT    PARM *ZERO     WQ0013  70       *DATE
     C           WEABTM    PARM *ZERO     WQ0014  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSL    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WELGNB           CD Scale Sequen
     C                     KFLD           WEEUNB           CD Carcass Numb
     C                     KFLD           WELHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSL    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Loss Percent       RT - Trim Button  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WFHONB           CC Company Numb
     C                     KFLD           WFTEST           TB Trim Area
      * Setup key
     C                     Z-ADDWCHMNB    WFHONB           CC Company Numb
     C                     MOVELWCDIST    WFTEST           TB Trim Area
      * Establish starting position
     C           KRSSM     CHAIN@EKCPB4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0870' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0013           TB Trim Locatio
     C                     MOVEL*BLANK    WN0014           TB Extent
     C                     Z-ADD*ZERO     WN0015           Loss Percent
     C                     GOTO SMEXIT                     *QUIT
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFTFST    WN0013           TB Trim Locatio
     C                     MOVELWFTGST    WN0014           TB Extent
     C                     Z-ADDWFGQPC    WN0015           Loss Percent
     C                     GOTO SMEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Loss Trans Next   RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHUNB    WQSN01           LTN Company Num
     C           *LIKE     DEFN WGA7DT    WQSN02           LTN Kill Date
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           LTN Company Num
     C                     KFLD           WQSN02           LTN Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQSN01           LTN Company Num
     C                     Z-ADDWCB0DT    WQSN02           LTN Kill Date
      * Establish starting position
     C           KRSSN     SETLLZBSCPNG                    *
     C           KRSSN     READEZBSCPNG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0115' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0017           LTN Record Numb
     C                     GOTO SNEXIT                     *QUIT
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LTN Record Number is Entry Allowed
     C           WGFHNB    IFGE 000001                     *IF
     C           WGFHNB    ANDLE699999
     C           WGFHNB    ADD  1         WN0017           LTN Record Numb
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSN     READEZBSCPNG                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt Loss Transaction  CR - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BSCPFS
     C                     Z-ADDWCHMNB    WHHUNB           LTN Company Num
     C                     Z-ADDWCB0DT    WHA7DT           LTN Kill Date
     C                     Z-ADDWN0017    WHFHNB           LTN Record Numb
     C                     Z-ADDWCCVNB    WHFFNB           LTN Tattoo Numb
     C                     MOVELWCEAST    WHEBST           LTN Shift
     C                     Z-ADDWN0021    WHDSNB           LTN Wgt
     C                     MOVELWN0014    WHS3NB           LTN Extent
     C                     MOVELWN0013    WHS4NB           LTN Trim Locati
     C                     MOVEL'B'       WHD1ST           LTN Error Sts
     C                     MOVEL'P'       WHH5ST           LTN Record Crea
     C                     MOVEL*BLANK    WHJMST           LTN User Error
     C                     MOVELWAKAST    WHSMST           LTN Source Type
     C                     Z-ADD03        WHBWCD           LT Type Code
     C                     Z-ADD*ZERO     WHBYCD           LR Reason Code
     C                     Z-ADDWCHMNB    WHHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WHBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WHCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WHB0DT           TH Kill Date
     C                     MOVELWUAAVN    WHAAVN           RS User Changed
     C                     Z-ADDWUAADT    WHAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WHAMTM           RS Time Changed
     C                     MOVELWUAJST    WHAJST           RS Record Statu
     C                     MOVELWUAHVN    WHAHVN           RS Job
     C                     MOVELWUAGVN    WHAGVN           RS Program
     C                     MOVELWUABVN    WHABVN           RS User Added
     C                     Z-ADDWUABDT    WHABDT           RS Date Added
     C                     Z-ADDWUABTM    WHABTM           RS Time Added
     C                     Z-ADD##JDT     WHB8DT           RU Date
     C                     Z-ADD##JTM     WHAOTM           RU Time
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WHAJST           RS Record Statu
     C                     MOVEL##USR     WHABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WHABDT    PARM *ZERO     WQ0015  70       *DATE
     C           WHABTM    PARM *ZERO     WQ0016  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WHAGVN           RS Program
     C                     MOVEL##JOB     WHAHVN           RS Job
     C           KLCRSO    KLIST
     C                     KFLD           WHHUNB           LTN Company Num
     C                     KFLD           WHA7DT           LTN Kill Date
     C                     KFLD           WHFHNB           LTN Record Numb
      * Check for duplicate primary key
     C           KLCRSO    SETLL@BSCPFS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0116' W0RTN   7
      * Send message 'Loss Trans             EX'
     C                     MOVEL'PRK0116' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@BSCPFS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field HC Description
     C                     MOVEL*BLANK    WUBDTX 25
      * Define work field HC Defect Required
     C                     MOVEL*BLANK    WUBXST  1
      * Define work field HC Price Required
     C                     MOVEL*BLANK    WUBYST  1
      * Define work field HC Resolution
     C                     MOVEL*BLANK    WUBITX 60
      * Define work field HC Qualification
     C                     MOVEL*BLANK    WUB0ST  1
      * Define work field HC Class Type
     C                     MOVEL*BLANK    WUFBST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WCA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WCFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WCHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WCLKNB           ET Lot
     C                     Z-ADD*ZERO     WCAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WCAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WCAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WCAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WCFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WCFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
     C                     Z-ADD*ZERO     WCB8DT           RU Date
     C                     Z-ADD*ZERO     WCAOTM           RU Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDLGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WDEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WDLHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WDBEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WDASPC           CD STD Yield
     C                     Z-ADD*ZERO     WDEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WDB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WDEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WDB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WDAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WDAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WDAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WDAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WDEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WDAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WDBBDT           CD Kill Date
     C                     Z-ADD*ZERO     WDAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WDH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WDBEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WDGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WDBHPC           CD FFLI
     C                     Z-ADD*ZERO     WDLTNB           CD LOT
     C                     Z-ADD*ZERO     WDX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WDFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WDFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WDFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WDJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WDF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WDJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WDJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WDJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WDJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WDJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WDJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WDJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WDJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WDDKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WDITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WDIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WDORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WDOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WDPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WDIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WDORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WDIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WDIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field CD CA Sort Loss
     C                     Z-ADD*ZERO     WUJWPR  72
      * Define work field CD CA Std Yield
     C                     Z-ADD*ZERO     WUF5PC  52
      * Define work field CD CA Base Carcass CWT
     C                     Z-ADD*ZERO     WUJXPR  72
      * Define work field CD CA Crc Value Per CWT
     C                     Z-ADD*ZERO     WUJYPR  52
      * Define work field CD CA Base Carc Value
     C                     Z-ADD*ZERO     WUJZPR  72
      * Define work field CD CA Crc Value $ Per Hd
     C                     Z-ADD*ZERO     WUJ0PR  72
      * Define work field CD CA Lean Premium CWT
     C                     Z-ADD*ZERO     WUJ1PR  72
      * Define work field CD CA Lean Premium $ P Hd
     C                     Z-ADD*ZERO     WUJ2PR  72
      * Define work field CD CA Gross Value Per CWT
     C                     Z-ADD*ZERO     WUJ3PR  52
      * Define work field CD CA Gross Value $ P Hd
     C                     Z-ADD*ZERO     WUJ4PR  72
      * Define work field CD Adjust/Add Source
     C                     MOVEL*BLANK    WUVDST  2
      * Define work field CD Unused Sts 3
     C                     MOVEL*BLANK    WUVEST  3
      * Define work field CD Unused Sts 4
     C                     MOVEL*BLANK    WUVFST  3
      * Define work field CD Unused Sts 5
     C                     MOVEL*BLANK    WUVGST  6
      * Define work field RS User Changed
     C                     MOVEL*BLANK    WUAAVN 10
      * Define work field RS Date Changed
     C                     Z-ADD*ZERO     WUAADT  70
      * Define work field RS Time Changed
     C                     Z-ADD*ZERO     WUAMTM  60
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Define work field RS Job
     C                     MOVEL*BLANK    WUAHVN 10
      * Define work field RS Program
     C                     MOVEL*BLANK    WUAGVN 10
      * Define work field RS User Added
     C                     MOVEL*BLANK    WUABVN 10
      * Define work field RS Date Added
     C                     Z-ADD*ZERO     WUABDT  70
      * Define work field RS Time Added
     C                     Z-ADD*ZERO     WUABTM  60
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHONB           CC Company Numb
     C                     Z-ADD*ZERO     WFGQPC           Loss Percent
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHUNB           LTN Company Num
     C                     Z-ADD*ZERO     WGA7DT           LTN Kill Date
     C                     Z-ADD*ZERO     WGFHNB           LTN Record Numb
     C                     Z-ADD*ZERO     WGFFNB           LTN Tattoo Numb
     C                     Z-ADD*ZERO     WGDSNB           LTN Wgt
     C                     Z-ADD*ZERO     WGBWCD           LT Type Code
     C                     Z-ADD*ZERO     WGBYCD           LR Reason Code
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
     C                     Z-ADD*ZERO     WGB8DT           RU Date
     C                     Z-ADD*ZERO     WGAOTM           RU Time
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL'N'       W0PMT   1
      * Define local work field CD Carcass Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field PL Location Code
     C                     MOVEL*BLANK    YL0002  6
      * Define local work field Farm Site 6.0 USR
     C                     Z-ADD*ZERO     YL0003  60
      * Define local work field CD Sort Loss
     C                     Z-ADD*ZERO     YL0004  72
      * Define local work field CD STD Yield
     C                     Z-ADD*ZERO     YL0005  52
      * Define local work field CD Base Carcass CWT
     C                     Z-ADD*ZERO     YL0006  72
      * Define local work field CD Crc Value Per CWT
     C                     Z-ADD*ZERO     YL0007  52
      * Define local work field CD Base Carc Value
     C                     Z-ADD*ZERO     YL0008  72
      * Define local work field CD Crc Value $ Per Hd
     C                     Z-ADD*ZERO     YL0009  72
      * Define local work field CD Lean Premium CWT
     C                     Z-ADD*ZERO     YL0010  72
      * Define local work field CD Lean Premium $ Per Hd
     C                     Z-ADD*ZERO     YL0011  72
      * Define local work field CD Gross Value Per CWT
     C                     Z-ADD*ZERO     YL0012  52
      * Define local work field CD Gross Value $ Per HD
     C                     Z-ADD*ZERO     YL0013  72
      * Define local work field CD Carcass Activity Sts
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field CD FFLI
     C                     Z-ADD*ZERO     YL0015  31
      * Define local work field Loin-Eye * Wgt USR
     C                     Z-ADD*ZERO     YL0016 152
      * Define local work field Backfat * Wgt USR
     C                     Z-ADD*ZERO     YL0017 152
      * Define local work field CD Backfat Inch - 2 dec
     C                     Z-ADD*ZERO     YL0018  52
      * Define local work field CD Loin Eye Inch - 2 dec
     C                     Z-ADD*ZERO     YL0019  52
      *================================================================
     CSR         ZZEXIT    ENDSR
