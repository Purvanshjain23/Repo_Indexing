     H/TITLE Cnv Upd Spot Buy Flag XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 09/09/21  Time  : 09:49:45
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL1  IF   E           K DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPMAMREL1  IF   E           K DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOPBGWKL1  IF   E           K DISK
      * RTV : Order Detail              Retrieval index
      *
     FPMD0CPL1  IF   E           K DISK
      * RTV : Sales History EXT         Retrieval index
      *
     FPMAMREL0  UF   E           K DISK
      * UPD : Order Header Extension    Update index
      *
     FOPBGWKL0  UF   E           K DISK
      * UPD : Order Detail              Update index
      *
     FPMD0CPL0  UF   E           K DISK
      * UPD : Sales History EXT         Update index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPMAM1        E DS                  EXTNAME(PMAMREL0)
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     D  WCAIC3       E                     EXTFLD(AMAIC3)
     D  WCC4NB       E                     EXTFLD(AMC4NB)
     D  WCRMNB       E                     EXTFLD(AMRMNB)
     D  WCRUNB       E                     EXTFLD(AMRUNB)
     D  WCXACD       E                     EXTFLD(AMXACD)
     D  WCOANA       E                     EXTFLD(AMOANA)
     D  WCHBAA       E                     EXTFLD(AMHBAA)
     D  WCJ0T1       E                     EXTFLD(AMJ0T1)
     D  WCGENY       E                     EXTFLD(AMGENY)
     D  WCJ1T1       E                     EXTFLD(AMJ1T1)
     D  WCHCAA       E                     EXTFLD(AMHCAA)
     D  WCQWDT       E                     EXTFLD(AMQWDT)
     D  WCQXDT       E                     EXTFLD(AMQXDT)
     D  WCQYDT       E                     EXTFLD(AMQYDT)
     D  WCHDAA       E                     EXTFLD(AMHDAA)
     D  WCCCTX       E                     EXTFLD(AMCCTX)
     D  WCJ2T1       E                     EXTFLD(AMJ2T1)
     D  WCRLNA       E                     EXTFLD(AMRLNA)
     D  WCRMNA       E                     EXTFLD(AMRMNA)
     D  WCGINY       E                     EXTFLD(AMGINY)
     D  WCGFNY       E                     EXTFLD(AMGFNY)
     D  WCGGNY       E                     EXTFLD(AMGGNY)
     D  WCGHNY       E                     EXTFLD(AMGHNY)
     D  WCHEVL       E                     EXTFLD(AMHEVL)
     D  WCHFVL       E                     EXTFLD(AMHFVL)
     D  WCHGVL       E                     EXTFLD(AMHGVL)
     D  WCQZDT       E                     EXTFLD(AMQZDT)
     D  WCQ0DT       E                     EXTFLD(AMQ0DT)
     D  WCQ1DT       E                     EXTFLD(AMQ1DT)
     D  WCQ2DT       E                     EXTFLD(AMQ2DT)
     D  WCC2TX       E                     EXTFLD(AMC2TX)
     D  WCC3TX       E                     EXTFLD(AMC3TX)
     D  WCC6TX       E                     EXTFLD(AMC6TX)
     D  WCCHTX       E                     EXTFLD(AMCHTX)
     D  WCCITX       E                     EXTFLD(AMCITX)
     D  WCCLTX       E                     EXTFLD(AMCLTX)
     D  WCB4TX       E                     EXTFLD(AMB4TX)
     D  WCCUTX       E                     EXTFLD(AMCUTX)
     D  WCCVTX       E                     EXTFLD(AMCVTX)
     D  WCB9TX       E                     EXTFLD(AMB9TX)
     D  WCJWSC       E                     EXTFLD(AMJWSC)
     D  WCITNY       E                     EXTFLD(AMITNY)
     D  WCLMT1       E                     EXTFLD(AMLMT1)
     D  WCLWAA       E                     EXTFLD(AMLWAA)
     D  WCFVST       E                     EXTFLD(AMFVST)
     D  WCF0ST       E                     EXTFLD(AMF0ST)
     D  WCF2ST       E                     EXTFLD(AMF2ST)
     D  WCF3ST       E                     EXTFLD(AMF3ST)
     D  WCJUSC       E                     EXTFLD(AMJUSC)
     D  WCJVSC       E                     EXTFLD(AMJVSC)
     D  WCV3T1       E                     EXTFLD(AMV3T1)
     D  WCV4T1       E                     EXTFLD(AMV4T1)
     D  WCV5T1       E                     EXTFLD(AMV5T1)
     D  WCV6T1       E                     EXTFLD(AMV6T1)
     D  WCV7T1       E                     EXTFLD(AMV7T1)
     D  WCV8T1       E                     EXTFLD(AMV8T1)
     D  WCV9T1       E                     EXTFLD(AMV9T1)
     D  WCWAT1       E                     EXTFLD(AMWAT1)
     D  WCWBT1       E                     EXTFLD(AMWBT1)
     D  WCWCT1       E                     EXTFLD(AMWCT1)
     D  WCWDT1       E                     EXTFLD(AMWDT1)
     D  WCQJNY       E                     EXTFLD(AMQJNY)
     D  WCQKNY       E                     EXTFLD(AMQKNY)
     D  WCQLNY       E                     EXTFLD(AMQLNY)
     D  WCP8NY       E                     EXTFLD(AMP8NY)
     D  WCP9NY       E                     EXTFLD(AMP9NY)
     D  WCQANY       E                     EXTFLD(AMQANY)
     D  WCQCNY       E                     EXTFLD(AMQCNY)
     D  WCQDNY       E                     EXTFLD(AMQDNY)
     D  WCQENY       E                     EXTFLD(AMQENY)
     D  WCQFNY       E                     EXTFLD(AMQFNY)
     D  WCQGNY       E                     EXTFLD(AMQGNY)
     D  WCQHNY       E                     EXTFLD(AMQHNY)
     D  WCQINY       E                     EXTFLD(AMQINY)
     D  WCQMNY       E                     EXTFLD(AMQMNY)
     D  WCMYU1       E                     EXTFLD(AMMYU1)
     D  WCJXSC       E                     EXTFLD(AMJXSC)
     D  WCJYSC       E                     EXTFLD(AMJYSC)
     D  WCJZSC       E                     EXTFLD(AMJZSC)
     D  WCJ0SC       E                     EXTFLD(AMJ0SC)
     D  WCMZU1       E                     EXTFLD(AMMZU1)
     D  WCM0U1       E                     EXTFLD(AMM0U1)
     D  WCM1U1       E                     EXTFLD(AMM1U1)
     D  WCM2U1       E                     EXTFLD(AMM2U1)
     D  WCM3U1       E                     EXTFLD(AMM3U1)
     D  WCW5DT       E                     EXTFLD(AMW5DT)
     D  WCW6DT       E                     EXTFLD(AMW6DT)
     D  WCUVST       E                     EXTFLD(AMUVST)
     D  WCUWST       E                     EXTFLD(AMUWST)
     D  WCUXST       E                     EXTFLD(AMUXST)
     D  WCVSST       E                     EXTFLD(AMVSST)
     D  WCAATM       E                     EXTFLD(AMAATM)
     D  WCAYNA       E                     EXTFLD(AMAYNA)
     D  WCA0NA       E                     EXTFLD(AMA0NA)
     D  WCAXDT       E                     EXTFLD(AMAXDT)
      *
     D YARDCS          DS           894
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D QOPBG1        E DS                  EXTNAME(OPBGWKL0)
      * UPD : Order Detail              Update index
      * Renamed input format fields
     D  WEAIC3       E                     EXTFLD(OMAIC3)
     D  WEC4NB       E                     EXTFLD(OMC4NB)
     D  WEDPNB       E                     EXTFLD(OMDPNB)
     D  WEUENB       E                     EXTFLD(OMUENB)
     D  WEHGCD       E                     EXTFLD(OMHGCD)
     D  WEAJCD       E                     EXTFLD(OMAJCD)
     D  WEBKC7       E                     EXTFLD(OMBKC7)
     D  WECFC7       E                     EXTFLD(OMCFC7)
     D  WEGMST       E                     EXTFLD(OMGMST)
     D  WEGNST       E                     EXTFLD(OMGNST)
     D  WEMAVA       E                     EXTFLD(OMMAVA)
     D  WEKDVA       E                     EXTFLD(OMKDVA)
     D  WEL8VA       E                     EXTFLD(OML8VA)
     D  WEL9VA       E                     EXTFLD(OML9VA)
     D  WEGTST       E                     EXTFLD(OMGTST)
     D  WEGVST       E                     EXTFLD(OMGVST)
     D  WEGUST       E                     EXTFLD(OMGUST)
     D  WEQFST       E                     EXTFLD(OMQFST)
     D  WEAYVA       E                     EXTFLD(OMAYVA)
     D  WEEXDT       E                     EXTFLD(OMEXDT)
     D  WELQCD       E                     EXTFLD(OMLQCD)
     D  WERDCD       E                     EXTFLD(OMRDCD)
     D  WEQ7CD       E                     EXTFLD(OMQ7CD)
     D  WEBZPR       E                     EXTFLD(OMBZPR)
     D  WEL6NB       E                     EXTFLD(OML6NB)
     D  WEU1ST       E                     EXTFLD(OMU1ST)
     D  WEGIDT       E                     EXTFLD(OMGIDT)
     D  WECRCD       E                     EXTFLD(OMCRCD)
     D  WEAGCD       E                     EXTFLD(OMAGCD)
     D  WERZST       E                     EXTFLD(OMRZST)
     D  WER0ST       E                     EXTFLD(OMR0ST)
     D  WER1ST       E                     EXTFLD(OMR1ST)
     D  WEG7NA       E                     EXTFLD(OMG7NA)
     D  WEG8NA       E                     EXTFLD(OMG8NA)
     D  WERPCD       E                     EXTFLD(OMRPCD)
     D  WEVEST       E                     EXTFLD(OMVEST)
     D  WEVGST       E                     EXTFLD(OMVGST)
     D  WEAVST       E                     EXTFLD(OMAVST)
     D  WEU0ST       E                     EXTFLD(OMU0ST)
     D  WERFCD       E                     EXTFLD(OMRFCD)
     D  WEFZST       E                     EXTFLD(OMFZST)
     D  WER1NB       E                     EXTFLD(OMR1NB)
     D  WEAVQT       E                     EXTFLD(OMAVQT)
     D  WED0WG       E                     EXTFLD(OMD0WG)
     D  WECCQT       E                     EXTFLD(OMCCQT)
     D  WEAUWG       E                     EXTFLD(OMAUWG)
     D  WECBQT       E                     EXTFLD(OMCBQT)
     D  WEATWG       E                     EXTFLD(OMATWG)
     D  WEAQCS       E                     EXTFLD(OMAQCS)
     D  WEAGCS       E                     EXTFLD(OMAGCS)
     D  WEAKPR       E                     EXTFLD(OMAKPR)
     D  WEALPR       E                     EXTFLD(OMALPR)
     D  WEAUPR       E                     EXTFLD(OMAUPR)
     D  WEAVWG       E                     EXTFLD(OMAVWG)
     D  WEA4WG       E                     EXTFLD(OMA4WG)
     D  WEA5DT       E                     EXTFLD(OMA5DT)
     D  WEAODT       E                     EXTFLD(OMAODT)
     D  WEGNDT       E                     EXTFLD(OMGNDT)
     D  WEAMST       E                     EXTFLD(OMAMST)
     D  WEANST       E                     EXTFLD(OMANST)
     D  WEVAST       E                     EXTFLD(OMVAST)
     D  WERGNB       E                     EXTFLD(OMRGNB)
     D  WERHNB       E                     EXTFLD(OMRHNB)
     D  WERINB       E                     EXTFLD(OMRINB)
     D  WERBCD       E                     EXTFLD(OMRBCD)
     D  WEHICD       E                     EXTFLD(OMHICD)
     D  WERNCD       E                     EXTFLD(OMRNCD)
     D  WEROCD       E                     EXTFLD(OMROCD)
     D  WECXDT       E                     EXTFLD(OMCXDT)
     D  WEAJVN       E                     EXTFLD(OMAJVN)
     D  WEKXCD       E                     EXTFLD(OMKXCD)
     D  WEJPCD       E                     EXTFLD(OMJPCD)
     D  WECQCD       E                     EXTFLD(OMCQCD)
     D  WER4CD       E                     EXTFLD(OMR4CD)
     D  WEZ1ST       E                     EXTFLD(OMZ1ST)
     D  WEZ3ST       E                     EXTFLD(OMZ3ST)
     D  WEZ4ST       E                     EXTFLD(OMZ4ST)
     D  WEDUPR       E                     EXTFLD(OMDUPR)
     D  WEB6VL       E                     EXTFLD(OMB6VL)
     D  WEA1AA       E                     EXTFLD(OMA1AA)
     D  WEFZSX       E                     EXTFLD(OMFZSX)
     D  WEF0SX       E                     EXTFLD(OMF0SX)
     D  WEF1SX       E                     EXTFLD(OMF1SX)
     D  WEF2SX       E                     EXTFLD(OMF2SX)
     D  WEF3SX       E                     EXTFLD(OMF3SX)
     D  WEF4SX       E                     EXTFLD(OMF4SX)
     D  WEF5SX       E                     EXTFLD(OMF5SX)
     D  WEF6SX       E                     EXTFLD(OMF6SX)
     D  WEF7SX       E                     EXTFLD(OMF7SX)
     D  WENTDT       E                     EXTFLD(OMNTDT)
     D  WENUDT       E                     EXTFLD(OMNUDT)
     D  WENVDT       E                     EXTFLD(OMNVDT)
     D  WENWDT       E                     EXTFLD(OMNWDT)
     D  WENXDT       E                     EXTFLD(OMNXDT)
     D  WEBUTM       E                     EXTFLD(OMBUTM)
     D  WEBVTM       E                     EXTFLD(OMBVTM)
     D  WEBWTM       E                     EXTFLD(OMBWTM)
     D  WEBXTM       E                     EXTFLD(OMBXTM)
     D  WEBYTM       E                     EXTFLD(OMBYTM)
     D  WEH5NX       E                     EXTFLD(OMH5NX)
     D  WEH6NX       E                     EXTFLD(OMH6NX)
     D  WEH7NX       E                     EXTFLD(OMH7NX)
     D  WEH8NX       E                     EXTFLD(OMH8NX)
     D  WEH9NX       E                     EXTFLD(OMH9NX)
     D  WEDVPR       E                     EXTFLD(OMDVPR)
     D  WEDWPR       E                     EXTFLD(OMDWPR)
     D  WEDXPR       E                     EXTFLD(OMDXPR)
     D  WEDYPR       E                     EXTFLD(OMDYPR)
     D  WEDZPR       E                     EXTFLD(OMDZPR)
     D  WEGSPR       E                     EXTFLD(OMGSPR)
     D  WEGTPR       E                     EXTFLD(OMGTPR)
     D  WEGUPR       E                     EXTFLD(OMGUPR)
     D  WEHOST       E                     EXTFLD(OMHOST)
     D  WEHPST       E                     EXTFLD(OMHPST)
     D  WEIOST       E                     EXTFLD(OMIOST)
     D  WEPEWG       E                     EXTFLD(OMPEWG)
     D  WERINY       E                     EXTFLD(OMRINY)
     D  WETIDT       E                     EXTFLD(OMTIDT)
     D  WETJDT       E                     EXTFLD(OMTJDT)
     D  WEH2ST       E                     EXTFLD(OMH2ST)
     D  WEH0ST       E                     EXTFLD(OMH0ST)
     D  WEH1ST       E                     EXTFLD(OMH1ST)
     D  WETKDT       E                     EXTFLD(OMTKDT)
     D  WETLDT       E                     EXTFLD(OMTLDT)
     D  WETMDT       E                     EXTFLD(OMTMDT)
     D  WEUVST       E                     EXTFLD(OMUVST)
     D  WEUWST       E                     EXTFLD(OMUWST)
     D  WEUXST       E                     EXTFLD(OMUXST)
     D  WEAATM       E                     EXTFLD(OMAATM)
     D  WEAYNA       E                     EXTFLD(OMAYNA)
     D  WEA0NA       E                     EXTFLD(OMA0NA)
     D  WEAXDT       E                     EXTFLD(OMAXDT)
      *
     D YBRDCS          DS           525
     D QPMD01        E DS                  EXTNAME(PMD0CPL0)
      * UPD : Sales History EXT         Update index
      * Renamed input format fields
     D  WGAIC3       E                     EXTFLD(D0AIC3)
     D  WGC4NB       E                     EXTFLD(D0C4NB)
     D  WGDPNB       E                     EXTFLD(D0DPNB)
     D  WGUENB       E                     EXTFLD(D0UENB)
     D  WGI7VL       E                     EXTFLD(D0I7VL)
     D  WGJXAA       E                     EXTFLD(D0JXAA)
     D  WGSHES       E                     EXTFLD(D0SHES)
     D  WGSHS1       E                     EXTFLD(D0SHS1)
     D  WGSHS2       E                     EXTFLD(D0SHS2)
     D  WGOVTX       E                     EXTFLD(D0OVTX)
     D  WGSADT       E                     EXTFLD(D0SADT)
     D  WGLMT1       E                     EXTFLD(D0LMT1)
     D  WGSBDT       E                     EXTFLD(D0SBDT)
     D  WGI9VL       E                     EXTFLD(D0I9VL)
     D  WGJAVL       E                     EXTFLD(D0JAVL)
     D  WGJBVL       E                     EXTFLD(D0JBVL)
     D  WGGIPR       E                     EXTFLD(D0GIPR)
     D  WGGJPR       E                     EXTFLD(D0GJPR)
     D  WGTCDT       E                     EXTFLD(D0TCDT)
     D  WGTDDT       E                     EXTFLD(D0TDDT)
     D  WGF9ST       E                     EXTFLD(D0F9ST)
     D  WGGAST       E                     EXTFLD(D0GAST)
     D  WGLXAA       E                     EXTFLD(D0LXAA)
     D  WGF5ST       E                     EXTFLD(D0F5ST)
     D  WGWET1       E                     EXTFLD(D0WET1)
     D  WGWFT1       E                     EXTFLD(D0WFT1)
     D  WGWGT1       E                     EXTFLD(D0WGT1)
     D  WGWHT1       E                     EXTFLD(D0WHT1)
     D  WGQRNY       E                     EXTFLD(D0QRNY)
     D  WGQSNY       E                     EXTFLD(D0QSNY)
     D  WGQNNY       E                     EXTFLD(D0QNNY)
     D  WGQONY       E                     EXTFLD(D0QONY)
     D  WGQPNY       E                     EXTFLD(D0QPNY)
     D  WGQQNY       E                     EXTFLD(D0QQNY)
     D  WGQTNY       E                     EXTFLD(D0QTNY)
     D  WGQUNY       E                     EXTFLD(D0QUNY)
     D  WGVSST       E                     EXTFLD(D0VSST)
     D  WGMJDT       E                     EXTFLD(D0MJDT)
     D  WGBETM       E                     EXTFLD(D0BETM)
     D  WGCCVN       E                     EXTFLD(D0CCVN)
     D  WGCDVN       E                     EXTFLD(D0CDVN)
     D  WGMKDT       E                     EXTFLD(D0MKDT)
     D  WGBFTM       E                     EXTFLD(D0BFTM)
     D  WGCEVN       E                     EXTFLD(D0CEVN)
     D  WGCFVN       E                     EXTFLD(D0CFVN)
      *
     D YCRDCS          DS           314
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              4
     D  WN0001         S              7  0
     D  WN0002         S              5  0
     D  WN0003         S              3
     D  WN0004         S             20
     D  WN0005         S             25
     D  WN0006         S             30
     D  WN0007         S             15
     D  WN0008         S             15
     D  WN0009         S             20
     D  WN0010         S              7  0
     D  WN0011         S              7  0
     D  WN0012         S              7  0
     D  WN0013         S              3
     D  WN0014         S              1
     D  WN0015         S             12
     D  WN0016         S             35
     D  WN0017         S             75
     D  WN0018         S             11  0
     D  WN0019         S             11  0
     D  WN0020         S             11  0
     D  WN0021         S             11  0
     D  WN0022         S             11  2
     D  WN0023         S             11  2
     D  WN0024         S             11  2
     D  WN0025         S              7  0
     D  WN0026         S              7  0
     D  WN0027         S              7  0
     D  WN0028         S              7  0
     D  WN0029         S              4
     D  WN0030         S              4
     D  WN0031         S              2
     D  WN0032         S              2
     D  WN0033         S              2
     D  WN0034         S              3
     D  WN0035         S              3
     D  WN0036         S              3
     D  WN0037         S              5
     D  WN0038         S              5
     D  WN0039         S              5  0
     D  WN0040         S             38
     D  WN0041         S              6
     D  WN0042         S              6
     D  WN0043         S              6
     D  WN0044         S              6
     D  WN0045         S              6
     D  WN0046         S              1
     D  WN0047         S              1
     D  WN0048         S             10
     D  WN0049         S             10
     D  WN0050         S             10
     D  WN0051         S             15
     D  WN0052         S             15
     D  WN0053         S             15
     D  WN0054         S             30
     D  WN0055         S             30
     D  WN0056         S             30
     D  WN0057         S             50
     D  WN0058         S             50
     D  WN0059         S              3  0
     D  WN0060         S              3  0
     D  WN0061         S              3  0
     D  WN0062         S              5  2
     D  WN0063         S              5  2
     D  WN0064         S              5  0
     D  WN0065         S              6  0
     D  WN0066         S              6  0
     D  WN0067         S              6  0
     D  WN0068         S              6  0
     D  WN0069         S              9  0
     D  WN0070         S              9  0
     D  WN0071         S              9  0
     D  WN0072         S              9  6
     D  WN0073         S             15
     D  WN0074         S              1
     D  WN0075         S              1
     D  WN0076         S              2
     D  WN0077         S              2
     D  WN0078         S              5
     D  WN0079         S              5
     D  WN0080         S             15
     D  WN0081         S             15
     D  WN0082         S             30
     D  WN0083         S              7  0
     D  WN0084         S              7  0
     D  WN0085         S              1
     D  WN0086         S              1
     D  WN0087         S              1
     D  WN0088         S              1
     D  WN0089         S              6  0
     D  WN0090         S             10
     D  WN0091         S             10
     D  WN0092         S              7  0
     D  YARDC          S              1
     D  WQSD01         S                   LIKE(WDAIC3)
     D  WQSD02         S                   LIKE(WDC4NB)
     D  YL0002         S              1
     D  WN0093         S              7  0
     D  WN0094         S              3
     D  WN0095         S              7  0
     D  WN0096         S              7  0
     D  WN0097         S              1
     D  WN0098         S              1
     D  WN0099         S             11  2
     D  WN0100         S             11  2
     D  WN0101         S             11  2
     D  WN0102         S             11  2
     D  WN0103         S              1
     D  WN0104         S              1
     D  WN0105         S              1
     D  WN0106         S              1
     D  WN0107         S             11  2
     D  WN0108         S              7  0
     D  WN0109         S              3
     D  WN0110         S              3
     D  WN0111         S              3
     D  WN0112         S             11  4
     D  WN0113         S              7  0
     D  WN0114         S              1
     D  WN0115         S              7  0
     D  WN0116         S              2
     D  WN0117         S              2
     D  WN0118         S              1
     D  WN0119         S              1
     D  WN0120         S              1
     D  WN0121         S             30
     D  WN0122         S             30
     D  WN0123         S              1
     D  WN0124         S              1
     D  WN0125         S              1
     D  WN0126         S              1
     D  WN0127         S              1
     D  WN0128         S              3
     D  WN0129         S              1
     D  WN0130         S             11  2
     D  WN0131         S             11  2
     D  WN0132         S             11  2
     D  WN0133         S             11  2
     D  WN0134         S             11  2
     D  WN0135         S             11  2
     D  WN0136         S             11  2
     D  WN0137         S             11  4
     D  WN0138         S             11  4
     D  WN0139         S             11  4
     D  WN0140         S             11  4
     D  WN0141         S             11  4
     D  WN0142         S             11  2
     D  WN0143         S             11  2
     D  WN0144         S              7  0
     D  WN0145         S              7  0
     D  WN0146         S              7  0
     D  WN0147         S              1
     D  WN0148         S              1
     D  WN0149         S              1
     D  WN0150         S              3  0
     D  WN0151         S              3  0
     D  WN0152         S              3  0
     D  WN0153         S              2
     D  WN0154         S              2
     D  WN0155         S              2
     D  WN0156         S              2
     D  WN0157         S              7  0
     D  WN0158         S             10
     D  WN0159         S              6
     D  WN0160         S              2
     D  WN0161         S              3
     D  WN0162         S              3
     D  WN0163         S              1
     D  WN0164         S              1
     D  WN0165         S              1
     D  WN0166         S             11  4
     D  WN0167         S             11  2
     D  WN0168         S              3  0
     D  WN0169         S              1
     D  WN0170         S              1
     D  WN0171         S              1
     D  WN0172         S              1
     D  WN0173         S              1
     D  WN0174         S              2
     D  WN0175         S              2
     D  WN0176         S              3
     D  WN0177         S              3
     D  WN0178         S              7  0
     D  WN0179         S              7  0
     D  WN0180         S              7  0
     D  WN0181         S              7  0
     D  WN0182         S              7  0
     D  WN0183         S              6  0
     D  WN0184         S              6  0
     D  WN0185         S              6  0
     D  WN0186         S              6  0
     D  WN0187         S              6  0
     D  WN0188         S             11  2
     D  WN0189         S             11  2
     D  WN0190         S             11  2
     D  WN0191         S             11  2
     D  WN0192         S             11  2
     D  WN0193         S             11  4
     D  WN0194         S             11  4
     D  WN0195         S             11  4
     D  WN0196         S             11  4
     D  WN0197         S             11  4
     D  WN0198         S             11  4
     D  WN0199         S             11  4
     D  WN0200         S             11  4
     D  WN0201         S              1
     D  WN0202         S              1
     D  WN0203         S              1
     D  WN0204         S             11  2
     D  WN0205         S              4  0
     D  WN0206         S              7  0
     D  WN0207         S              7  0
     D  WN0208         S              2
     D  WN0209         S              3
     D  WN0210         S              7  0
     D  WN0211         S              7  0
     D  WN0212         S              7  0
     D  WN0213         S              1
     D  WN0214         S              1
     D  WN0215         S              1
     D  WN0216         S              6  0
     D  WN0217         S             10
     D  WN0218         S             10
     D  WN0219         S              7  0
     D  YBRDC          S              1
     D  WQSF01         S                   LIKE(WFAIC3)
     D  WQSF02         S                   LIKE(WFC4NB)
     D  YL0003         S              1
     D  WN0220         S             11  2
     D  WN0221         S              3
     D  WN0222         S              1
     D  WN0223         S              1
     D  WN0224         S              2
     D  WN0225         S              7  0
     D  WN0226         S             38
     D  WN0227         S              7  0
     D  WN0228         S             11  2
     D  WN0229         S             11  2
     D  WN0230         S             11  2
     D  WN0231         S             11  4
     D  WN0232         S             11  4
     D  WN0233         S              7  0
     D  WN0234         S              7  0
     D  WN0235         S              2
     D  WN0236         S              2
     D  WN0237         S              6
     D  WN0238         S              6
     D  WN0239         S             10
     D  WN0240         S             15
     D  WN0241         S             30
     D  WN0242         S             50
     D  WN0243         S              3  0
     D  WN0244         S              3  0
     D  WN0245         S              5  0
     D  WN0246         S              5  0
     D  WN0247         S              6  0
     D  WN0248         S              6  0
     D  WN0249         S              9  0
     D  WN0250         S              9  0
     D  WN0251         S              1
     D  WN0252         S              7  0
     D  WN0253         S              6  0
     D  WN0254         S             10
     D  WN0255         S             10
     D  WN0256         S              7  0
     D  WN0257         S              6  0
     D  WN0258         S             10
     D  WN0259         S             10
     D  YCRDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Order Header TRG
      * N : MAP Company Number
     D  P1AIC3                 1      2P 0
      * N : MAP Order Number
     D  P1C4NB                 3      6P 0
     D                 DS
     D  ZAMSDA                 1    132
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                      WAAIC3
     I              BEC4NB                      WAC4NB
     I              BEJNCD                      WAJNCD
     I              BEANC7                      WAANC7
     I              BEBKC7                      WABKC7
     I              BEBRTX                      WABRTX
     I              BEHMNA                      WAHMNA
     I              BEHONA                      WAHONA
     I              BEHPNA                      WAHPNA
     I              BEHNNA                      WAHNNA
     I              BEDBCD                      WADBCD
     I              BECKTX                      WACKTX
     I              BEB0C7                      WAB0C7
     I              BEAETX                      WAAETX
     I              BEB1NA                      WAB1NA
     I              BEB3NA                      WAB3NA
     I              BEB4NA                      WAB4NA
     I              BEB2NA                      WAB2NA
     I              BEBHCD                      WABHCD
     I              BEC8TX                      WAC8TX
     I              BEBCNA                      WABCNA
     I              BEA0DT                      WAA0DT
     I              BEA5DT                      WAA5DT
     I              BEGNDT                      WAGNDT
     I              BEACDT                      WAACDT
     I              BEAQCD                      WAAQCD
     I              BEB6NA                      WAB6NA
     I              BEBYNA                      WABYNA
     I              BEBZNA                      WABZNA
     I              BEGTST                      WAGTST
     I              BEGVST                      WAGVST
     I              BEGUST                      WAGUST
     I              BEQFST                      WAQFST
     I              BECQCD                      WACQCD
     I              BEGJST                      WAGJST
     I              BEGWST                      WAGWST
     I              BEGXST                      WAGXST
     I              BEGYST                      WAGYST
     I              BEAODT                      WAAODT
     I              BEAIVN                      WAAIVN
     I              BECXDT                      WACXDT
     I              BEJZVA                      WAJZVA
     I              BEA1WG                      WAA1WG
     I              BEXIST                      WAXIST
     I              BEXJST                      WAXJST
     I              BEXKST                      WAXKST
     I              BEEIDT                      WAEIDT
     I              BEAFTM                      WAAFTM
     I              BEE8CD                      WAE8CD
     I              BEE9CD                      WAE9CD
     I              BERMNB                      WARMNB
     I              BETBNB                      WATBNB
     I              BER1NB                      WAR1NB
     I              BEPJST                      WAPJST
     I              BEU0ST                      WAU0ST
     I              BEU1ST                      WAU1ST
     I              BEQ2CD                      WAQ2CD
     I              BEU2ST                      WAU2ST
     I              BEVEST                      WAVEST
     I              BEVFST                      WAVFST
     I              BEVGST                      WAVGST
     I              BERPCD                      WARPCD
     I              BERNNB                      WARNNB
     I              BEVDST                      WAVDST
     I              BEATIN                      WAATIN
     I              BEU4ST                      WAU4ST
     I              BEU5ST                      WAU5ST
     I              BERSRN                      WARSRN
     I              BEMHNA                      WAMHNA
     I              BEMINA                      WAMINA
     I              BEWBST                      WAWBST
     I              BER4CD                      WAR4CD
     I              BEBFCD                      WABFCD
     I              BEQ4CD                      WAQ4CD
     I              BET3NB                      WAT3NB
     I              BESICD                      WASICD
     I              BECONB                      WACONB
     I              BECEST                      WACEST
     I              BEAWDT                      WAAWDT
     I              BEJPCD                      WAJPCD
     I              BEXUST                      WAXUST
     I              BEZ1ST                      WAZ1ST
     I              BEVRVA                      WAVRVA
     I              BEOBST                      WAOBST
     I              BEBCST                      WABCST
     I              BEBDST                      WABDST
     I              BEB7VL                      WAB7VL
     I              BEGASX                      WAGASX
     I              BEGBSX                      WAGBSX
     I              BEGCSX                      WAGCSX
     I              BEGDSX                      WAGDSX
     I              BEFNSX                      WAFNSX
     I              BEFOSX                      WAFOSX
     I              BEFPSX                      WAFPSX
     I              BEFQSX                      WAFQSX
     I              BEFRSX                      WAFRSX
     I              BEFSSX                      WAFSSX
     I              BEFTSX                      WAFTSX
     I              BEFUSX                      WAFUSX
     I              BEFVSX                      WAFVSX
     I              BEFWSX                      WAFWSX
     I              BEFXSX                      WAFXSX
     I              BEFYSX                      WAFYSX
     I              BENODT                      WANODT
     I              BENPDT                      WANPDT
     I              BENQDT                      WANQDT
     I              BENRDT                      WANRDT
     I              BENSDT                      WANSDT
     I              BEBPTM                      WABPTM
     I              BEBQTM                      WABQTM
     I              BEBRTM                      WABRTM
     I              BEBSTM                      WABSTM
     I              BEBTTM                      WABTTM
     I              BEH0NX                      WAH0NX
     I              BEH1NX                      WAH1NX
     I              BEH2NX                      WAH2NX
     I              BEH3NX                      WAH3NX
     I              BEH4NX                      WAH4NX
     I              BEC0C7                      WAC0C7
     I              BEUVST                      WAUVST
     I              BEUWST                      WAUWST
     I              BEUXST                      WAUXST
     I              BEAATM                      WAAATM
     I              BEAYNA                      WAAYNA
     I              BEA0NA                      WAA0NA
     I              BEAXDT                      WAAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                      WBAIC3
     I              AMC4NB                      WBC4NB
     I              AMRMNB                      WBRMNB
     I              AMRUNB                      WBRUNB
     I              AMXACD                      WBXACD
     I              AMOANA                      WBOANA
     I              AMHBAA                      WBHBAA
     I              AMJ0T1                      WBJ0T1
     I              AMGENY                      WBGENY
     I              AMJ1T1                      WBJ1T1
     I              AMHCAA                      WBHCAA
     I              AMQWDT                      WBQWDT
     I              AMQXDT                      WBQXDT
     I              AMQYDT                      WBQYDT
     I              AMHDAA                      WBHDAA
     I              AMCCTX                      WBCCTX
     I              AMJ2T1                      WBJ2T1
     I              AMRLNA                      WBRLNA
     I              AMRMNA                      WBRMNA
     I              AMGINY                      WBGINY
     I              AMGFNY                      WBGFNY
     I              AMGGNY                      WBGGNY
     I              AMGHNY                      WBGHNY
     I              AMHEVL                      WBHEVL
     I              AMHFVL                      WBHFVL
     I              AMHGVL                      WBHGVL
     I              AMQZDT                      WBQZDT
     I              AMQ0DT                      WBQ0DT
     I              AMQ1DT                      WBQ1DT
     I              AMQ2DT                      WBQ2DT
     I              AMC2TX                      WBC2TX
     I              AMC3TX                      WBC3TX
     I              AMC6TX                      WBC6TX
     I              AMCHTX                      WBCHTX
     I              AMCITX                      WBCITX
     I              AMCLTX                      WBCLTX
     I              AMB4TX                      WBB4TX
     I              AMCUTX                      WBCUTX
     I              AMCVTX                      WBCVTX
     I              AMB9TX                      WBB9TX
     I              AMJWSC                      WBJWSC
     I              AMITNY                      WBITNY
     I              AMLMT1                      WBLMT1
     I              AMLWAA                      WBLWAA
     I              AMFVST                      WBFVST
     I              AMF0ST                      WBF0ST
     I              AMF2ST                      WBF2ST
     I              AMF3ST                      WBF3ST
     I              AMJUSC                      WBJUSC
     I              AMJVSC                      WBJVSC
     I              AMV3T1                      WBV3T1
     I              AMV4T1                      WBV4T1
     I              AMV5T1                      WBV5T1
     I              AMV6T1                      WBV6T1
     I              AMV7T1                      WBV7T1
     I              AMV8T1                      WBV8T1
     I              AMV9T1                      WBV9T1
     I              AMWAT1                      WBWAT1
     I              AMWBT1                      WBWBT1
     I              AMWCT1                      WBWCT1
     I              AMWDT1                      WBWDT1
     I              AMQJNY                      WBQJNY
     I              AMQKNY                      WBQKNY
     I              AMQLNY                      WBQLNY
     I              AMP8NY                      WBP8NY
     I              AMP9NY                      WBP9NY
     I              AMQANY                      WBQANY
     I              AMQCNY                      WBQCNY
     I              AMQDNY                      WBQDNY
     I              AMQENY                      WBQENY
     I              AMQFNY                      WBQFNY
     I              AMQGNY                      WBQGNY
     I              AMQHNY                      WBQHNY
     I              AMQINY                      WBQINY
     I              AMQMNY                      WBQMNY
     I              AMMYU1                      WBMYU1
     I              AMJXSC                      WBJXSC
     I              AMJYSC                      WBJYSC
     I              AMJZSC                      WBJZSC
     I              AMJ0SC                      WBJ0SC
     I              AMMZU1                      WBMZU1
     I              AMM0U1                      WBM0U1
     I              AMM1U1                      WBM1U1
     I              AMM2U1                      WBM2U1
     I              AMM3U1                      WBM3U1
     I              AMW5DT                      WBW5DT
     I              AMW6DT                      WBW6DT
     I              AMUVST                      WBUVST
     I              AMUWST                      WBUWST
     I              AMUXST                      WBUXST
     I              AMVSST                      WBVSST
     I              AMAATM                      WBAATM
     I              AMAYNA                      WBAYNA
     I              AMA0NA                      WBA0NA
     I              AMAXDT                      WBAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                      WCAIC3
     I              AMC4NB                      WCC4NB
     I              AMRMNB                      WCRMNB
     I              AMRUNB                      WCRUNB
     I              AMXACD                      WCXACD
     I              AMOANA                      WCOANA
     I              AMHBAA                      WCHBAA
     I              AMJ0T1                      WCJ0T1
     I              AMGENY                      WCGENY
     I              AMJ1T1                      WCJ1T1
     I              AMHCAA                      WCHCAA
     I              AMQWDT                      WCQWDT
     I              AMQXDT                      WCQXDT
     I              AMQYDT                      WCQYDT
     I              AMHDAA                      WCHDAA
     I              AMCCTX                      WCCCTX
     I              AMJ2T1                      WCJ2T1
     I              AMRLNA                      WCRLNA
     I              AMRMNA                      WCRMNA
     I              AMGINY                      WCGINY
     I              AMGFNY                      WCGFNY
     I              AMGGNY                      WCGGNY
     I              AMGHNY                      WCGHNY
     I              AMHEVL                      WCHEVL
     I              AMHFVL                      WCHFVL
     I              AMHGVL                      WCHGVL
     I              AMQZDT                      WCQZDT
     I              AMQ0DT                      WCQ0DT
     I              AMQ1DT                      WCQ1DT
     I              AMQ2DT                      WCQ2DT
     I              AMC2TX                      WCC2TX
     I              AMC3TX                      WCC3TX
     I              AMC6TX                      WCC6TX
     I              AMCHTX                      WCCHTX
     I              AMCITX                      WCCITX
     I              AMCLTX                      WCCLTX
     I              AMB4TX                      WCB4TX
     I              AMCUTX                      WCCUTX
     I              AMCVTX                      WCCVTX
     I              AMB9TX                      WCB9TX
     I              AMJWSC                      WCJWSC
     I              AMITNY                      WCITNY
     I              AMLMT1                      WCLMT1
     I              AMLWAA                      WCLWAA
     I              AMFVST                      WCFVST
     I              AMF0ST                      WCF0ST
     I              AMF2ST                      WCF2ST
     I              AMF3ST                      WCF3ST
     I              AMJUSC                      WCJUSC
     I              AMJVSC                      WCJVSC
     I              AMV3T1                      WCV3T1
     I              AMV4T1                      WCV4T1
     I              AMV5T1                      WCV5T1
     I              AMV6T1                      WCV6T1
     I              AMV7T1                      WCV7T1
     I              AMV8T1                      WCV8T1
     I              AMV9T1                      WCV9T1
     I              AMWAT1                      WCWAT1
     I              AMWBT1                      WCWBT1
     I              AMWCT1                      WCWCT1
     I              AMWDT1                      WCWDT1
     I              AMQJNY                      WCQJNY
     I              AMQKNY                      WCQKNY
     I              AMQLNY                      WCQLNY
     I              AMP8NY                      WCP8NY
     I              AMP9NY                      WCP9NY
     I              AMQANY                      WCQANY
     I              AMQCNY                      WCQCNY
     I              AMQDNY                      WCQDNY
     I              AMQENY                      WCQENY
     I              AMQFNY                      WCQFNY
     I              AMQGNY                      WCQGNY
     I              AMQHNY                      WCQHNY
     I              AMQINY                      WCQINY
     I              AMQMNY                      WCQMNY
     I              AMMYU1                      WCMYU1
     I              AMJXSC                      WCJXSC
     I              AMJYSC                      WCJYSC
     I              AMJZSC                      WCJZSC
     I              AMJ0SC                      WCJ0SC
     I              AMMZU1                      WCMZU1
     I              AMM0U1                      WCM0U1
     I              AMM1U1                      WCM1U1
     I              AMM2U1                      WCM2U1
     I              AMM3U1                      WCM3U1
     I              AMW5DT                      WCW5DT
     I              AMW6DT                      WCW6DT
     I              AMUVST                      WCUVST
     I              AMUWST                      WCUWST
     I              AMUXST                      WCUXST
     I              AMVSST                      WCVSST
     I              AMAATM                      WCAATM
     I              AMAYNA                      WCAYNA
     I              AMA0NA                      WCA0NA
     I              AMAXDT                      WCAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                      WDAIC3
     I              OMC4NB                      WDC4NB
     I              OMDPNB                      WDDPNB
     I              OMUENB                      WDUENB
     I              OMHGCD                      WDHGCD
     I              OMAJCD                      WDAJCD
     I              OMBKC7                      WDBKC7
     I              OMCFC7                      WDCFC7
     I              OMGMST                      WDGMST
     I              OMGNST                      WDGNST
     I              OMMAVA                      WDMAVA
     I              OMKDVA                      WDKDVA
     I              OML8VA                      WDL8VA
     I              OML9VA                      WDL9VA
     I              OMGTST                      WDGTST
     I              OMGVST                      WDGVST
     I              OMGUST                      WDGUST
     I              OMQFST                      WDQFST
     I              OMAYVA                      WDAYVA
     I              OMEXDT                      WDEXDT
     I              OMLQCD                      WDLQCD
     I              OMRDCD                      WDRDCD
     I              OMQ7CD                      WDQ7CD
     I              OMBZPR                      WDBZPR
     I              OML6NB                      WDL6NB
     I              OMU1ST                      WDU1ST
     I              OMGIDT                      WDGIDT
     I              OMCRCD                      WDCRCD
     I              OMAGCD                      WDAGCD
     I              OMRZST                      WDRZST
     I              OMR0ST                      WDR0ST
     I              OMR1ST                      WDR1ST
     I              OMG7NA                      WDG7NA
     I              OMG8NA                      WDG8NA
     I              OMRPCD                      WDRPCD
     I              OMVEST                      WDVEST
     I              OMVGST                      WDVGST
     I              OMAVST                      WDAVST
     I              OMU0ST                      WDU0ST
     I              OMRFCD                      WDRFCD
     I              OMFZST                      WDFZST
     I              OMR1NB                      WDR1NB
     I              OMAVQT                      WDAVQT
     I              OMD0WG                      WDD0WG
     I              OMCCQT                      WDCCQT
     I              OMAUWG                      WDAUWG
     I              OMCBQT                      WDCBQT
     I              OMATWG                      WDATWG
     I              OMAQCS                      WDAQCS
     I              OMAGCS                      WDAGCS
     I              OMAKPR                      WDAKPR
     I              OMALPR                      WDALPR
     I              OMAUPR                      WDAUPR
     I              OMAVWG                      WDAVWG
     I              OMA4WG                      WDA4WG
     I              OMA5DT                      WDA5DT
     I              OMAODT                      WDAODT
     I              OMGNDT                      WDGNDT
     I              OMAMST                      WDAMST
     I              OMANST                      WDANST
     I              OMVAST                      WDVAST
     I              OMRGNB                      WDRGNB
     I              OMRHNB                      WDRHNB
     I              OMRINB                      WDRINB
     I              OMRBCD                      WDRBCD
     I              OMHICD                      WDHICD
     I              OMRNCD                      WDRNCD
     I              OMROCD                      WDROCD
     I              OMCXDT                      WDCXDT
     I              OMAJVN                      WDAJVN
     I              OMKXCD                      WDKXCD
     I              OMJPCD                      WDJPCD
     I              OMCQCD                      WDCQCD
     I              OMR4CD                      WDR4CD
     I              OMZ1ST                      WDZ1ST
     I              OMZ3ST                      WDZ3ST
     I              OMZ4ST                      WDZ4ST
     I              OMDUPR                      WDDUPR
     I              OMB6VL                      WDB6VL
     I              OMA1AA                      WDA1AA
     I              OMFZSX                      WDFZSX
     I              OMF0SX                      WDF0SX
     I              OMF1SX                      WDF1SX
     I              OMF2SX                      WDF2SX
     I              OMF3SX                      WDF3SX
     I              OMF4SX                      WDF4SX
     I              OMF5SX                      WDF5SX
     I              OMF6SX                      WDF6SX
     I              OMF7SX                      WDF7SX
     I              OMNTDT                      WDNTDT
     I              OMNUDT                      WDNUDT
     I              OMNVDT                      WDNVDT
     I              OMNWDT                      WDNWDT
     I              OMNXDT                      WDNXDT
     I              OMBUTM                      WDBUTM
     I              OMBVTM                      WDBVTM
     I              OMBWTM                      WDBWTM
     I              OMBXTM                      WDBXTM
     I              OMBYTM                      WDBYTM
     I              OMH5NX                      WDH5NX
     I              OMH6NX                      WDH6NX
     I              OMH7NX                      WDH7NX
     I              OMH8NX                      WDH8NX
     I              OMH9NX                      WDH9NX
     I              OMDVPR                      WDDVPR
     I              OMDWPR                      WDDWPR
     I              OMDXPR                      WDDXPR
     I              OMDYPR                      WDDYPR
     I              OMDZPR                      WDDZPR
     I              OMGSPR                      WDGSPR
     I              OMGTPR                      WDGTPR
     I              OMGUPR                      WDGUPR
     I              OMHOST                      WDHOST
     I              OMHPST                      WDHPST
     I              OMIOST                      WDIOST
     I              OMPEWG                      WDPEWG
     I              OMRINY                      WDRINY
     I              OMTIDT                      WDTIDT
     I              OMTJDT                      WDTJDT
     I              OMH2ST                      WDH2ST
     I              OMH0ST                      WDH0ST
     I              OMH1ST                      WDH1ST
     I              OMTKDT                      WDTKDT
     I              OMTLDT                      WDTLDT
     I              OMTMDT                      WDTMDT
     I              OMUVST                      WDUVST
     I              OMUWST                      WDUWST
     I              OMUXST                      WDUXST
     I              OMAATM                      WDAATM
     I              OMAYNA                      WDAYNA
     I              OMA0NA                      WDA0NA
     I              OMAXDT                      WDAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                      WEAIC3
     I              OMC4NB                      WEC4NB
     I              OMDPNB                      WEDPNB
     I              OMUENB                      WEUENB
     I              OMHGCD                      WEHGCD
     I              OMAJCD                      WEAJCD
     I              OMBKC7                      WEBKC7
     I              OMCFC7                      WECFC7
     I              OMGMST                      WEGMST
     I              OMGNST                      WEGNST
     I              OMMAVA                      WEMAVA
     I              OMKDVA                      WEKDVA
     I              OML8VA                      WEL8VA
     I              OML9VA                      WEL9VA
     I              OMGTST                      WEGTST
     I              OMGVST                      WEGVST
     I              OMGUST                      WEGUST
     I              OMQFST                      WEQFST
     I              OMAYVA                      WEAYVA
     I              OMEXDT                      WEEXDT
     I              OMLQCD                      WELQCD
     I              OMRDCD                      WERDCD
     I              OMQ7CD                      WEQ7CD
     I              OMBZPR                      WEBZPR
     I              OML6NB                      WEL6NB
     I              OMU1ST                      WEU1ST
     I              OMGIDT                      WEGIDT
     I              OMCRCD                      WECRCD
     I              OMAGCD                      WEAGCD
     I              OMRZST                      WERZST
     I              OMR0ST                      WER0ST
     I              OMR1ST                      WER1ST
     I              OMG7NA                      WEG7NA
     I              OMG8NA                      WEG8NA
     I              OMRPCD                      WERPCD
     I              OMVEST                      WEVEST
     I              OMVGST                      WEVGST
     I              OMAVST                      WEAVST
     I              OMU0ST                      WEU0ST
     I              OMRFCD                      WERFCD
     I              OMFZST                      WEFZST
     I              OMR1NB                      WER1NB
     I              OMAVQT                      WEAVQT
     I              OMD0WG                      WED0WG
     I              OMCCQT                      WECCQT
     I              OMAUWG                      WEAUWG
     I              OMCBQT                      WECBQT
     I              OMATWG                      WEATWG
     I              OMAQCS                      WEAQCS
     I              OMAGCS                      WEAGCS
     I              OMAKPR                      WEAKPR
     I              OMALPR                      WEALPR
     I              OMAUPR                      WEAUPR
     I              OMAVWG                      WEAVWG
     I              OMA4WG                      WEA4WG
     I              OMA5DT                      WEA5DT
     I              OMAODT                      WEAODT
     I              OMGNDT                      WEGNDT
     I              OMAMST                      WEAMST
     I              OMANST                      WEANST
     I              OMVAST                      WEVAST
     I              OMRGNB                      WERGNB
     I              OMRHNB                      WERHNB
     I              OMRINB                      WERINB
     I              OMRBCD                      WERBCD
     I              OMHICD                      WEHICD
     I              OMRNCD                      WERNCD
     I              OMROCD                      WEROCD
     I              OMCXDT                      WECXDT
     I              OMAJVN                      WEAJVN
     I              OMKXCD                      WEKXCD
     I              OMJPCD                      WEJPCD
     I              OMCQCD                      WECQCD
     I              OMR4CD                      WER4CD
     I              OMZ1ST                      WEZ1ST
     I              OMZ3ST                      WEZ3ST
     I              OMZ4ST                      WEZ4ST
     I              OMDUPR                      WEDUPR
     I              OMB6VL                      WEB6VL
     I              OMA1AA                      WEA1AA
     I              OMFZSX                      WEFZSX
     I              OMF0SX                      WEF0SX
     I              OMF1SX                      WEF1SX
     I              OMF2SX                      WEF2SX
     I              OMF3SX                      WEF3SX
     I              OMF4SX                      WEF4SX
     I              OMF5SX                      WEF5SX
     I              OMF6SX                      WEF6SX
     I              OMF7SX                      WEF7SX
     I              OMNTDT                      WENTDT
     I              OMNUDT                      WENUDT
     I              OMNVDT                      WENVDT
     I              OMNWDT                      WENWDT
     I              OMNXDT                      WENXDT
     I              OMBUTM                      WEBUTM
     I              OMBVTM                      WEBVTM
     I              OMBWTM                      WEBWTM
     I              OMBXTM                      WEBXTM
     I              OMBYTM                      WEBYTM
     I              OMH5NX                      WEH5NX
     I              OMH6NX                      WEH6NX
     I              OMH7NX                      WEH7NX
     I              OMH8NX                      WEH8NX
     I              OMH9NX                      WEH9NX
     I              OMDVPR                      WEDVPR
     I              OMDWPR                      WEDWPR
     I              OMDXPR                      WEDXPR
     I              OMDYPR                      WEDYPR
     I              OMDZPR                      WEDZPR
     I              OMGSPR                      WEGSPR
     I              OMGTPR                      WEGTPR
     I              OMGUPR                      WEGUPR
     I              OMHOST                      WEHOST
     I              OMHPST                      WEHPST
     I              OMIOST                      WEIOST
     I              OMPEWG                      WEPEWG
     I              OMRINY                      WERINY
     I              OMTIDT                      WETIDT
     I              OMTJDT                      WETJDT
     I              OMH2ST                      WEH2ST
     I              OMH0ST                      WEH0ST
     I              OMH1ST                      WEH1ST
     I              OMTKDT                      WETKDT
     I              OMTLDT                      WETLDT
     I              OMTMDT                      WETMDT
     I              OMUVST                      WEUVST
     I              OMUWST                      WEUWST
     I              OMUXST                      WEUXST
     I              OMAATM                      WEAATM
     I              OMAYNA                      WEAYNA
     I              OMA0NA                      WEA0NA
     I              OMAXDT                      WEAXDT
      *
     I@D0CPTQ
      * Sales History EXT         Retrieval index
      * Renamed input format fields
     I              D0AIC3                      WFAIC3
     I              D0C4NB                      WFC4NB
     I              D0DPNB                      WFDPNB
     I              D0UENB                      WFUENB
     I              D0I7VL                      WFI7VL
     I              D0JXAA                      WFJXAA
     I              D0SHES                      WFSHES
     I              D0SHS1                      WFSHS1
     I              D0SHS2                      WFSHS2
     I              D0OVTX                      WFOVTX
     I              D0SADT                      WFSADT
     I              D0LMT1                      WFLMT1
     I              D0SBDT                      WFSBDT
     I              D0I9VL                      WFI9VL
     I              D0JAVL                      WFJAVL
     I              D0JBVL                      WFJBVL
     I              D0GIPR                      WFGIPR
     I              D0GJPR                      WFGJPR
     I              D0TCDT                      WFTCDT
     I              D0TDDT                      WFTDDT
     I              D0F9ST                      WFF9ST
     I              D0GAST                      WFGAST
     I              D0LXAA                      WFLXAA
     I              D0F5ST                      WFF5ST
     I              D0WET1                      WFWET1
     I              D0WFT1                      WFWFT1
     I              D0WGT1                      WFWGT1
     I              D0WHT1                      WFWHT1
     I              D0QRNY                      WFQRNY
     I              D0QSNY                      WFQSNY
     I              D0QNNY                      WFQNNY
     I              D0QONY                      WFQONY
     I              D0QPNY                      WFQPNY
     I              D0QQNY                      WFQQNY
     I              D0QTNY                      WFQTNY
     I              D0QUNY                      WFQUNY
     I              D0VSST                      WFVSST
     I              D0MJDT                      WFMJDT
     I              D0BETM                      WFBETM
     I              D0CCVN                      WFCCVN
     I              D0CDVN                      WFCDVN
     I              D0MKDT                      WFMKDT
     I              D0BFTM                      WFBFTM
     I              D0CEVN                      WFCEVN
     I              D0CFVN                      WFCFVN
      *
     I@D0CPTP
      * Sales History EXT         Update index
      * Renamed input format fields
     I              D0AIC3                      WGAIC3
     I              D0C4NB                      WGC4NB
     I              D0DPNB                      WGDPNB
     I              D0UENB                      WGUENB
     I              D0I7VL                      WGI7VL
     I              D0JXAA                      WGJXAA
     I              D0SHES                      WGSHES
     I              D0SHS1                      WGSHS1
     I              D0SHS2                      WGSHS2
     I              D0OVTX                      WGOVTX
     I              D0SADT                      WGSADT
     I              D0LMT1                      WGLMT1
     I              D0SBDT                      WGSBDT
     I              D0I9VL                      WGI9VL
     I              D0JAVL                      WGJAVL
     I              D0JBVL                      WGJBVL
     I              D0GIPR                      WGGIPR
     I              D0GJPR                      WGGJPR
     I              D0TCDT                      WGTCDT
     I              D0TDDT                      WGTDDT
     I              D0F9ST                      WGF9ST
     I              D0GAST                      WGGAST
     I              D0LXAA                      WGLXAA
     I              D0F5ST                      WGF5ST
     I              D0WET1                      WGWET1
     I              D0WFT1                      WGWFT1
     I              D0WGT1                      WGWGT1
     I              D0WHT1                      WGWHT1
     I              D0QRNY                      WGQRNY
     I              D0QSNY                      WGQSNY
     I              D0QNNY                      WGQNNY
     I              D0QONY                      WGQONY
     I              D0QPNY                      WGQPNY
     I              D0QQNY                      WGQQNY
     I              D0QTNY                      WGQTNY
     I              D0QUNY                      WGQUNY
     I              D0VSST                      WGVSST
     I              D0MJDT                      WGMJDT
     I              D0BETM                      WGBETM
     I              D0CCVN                      WGCCVN
     I              D0CDVN                      WGCDVN
     I              D0MKDT                      WGMKDT
     I              D0BFTM                      WGBFTM
     I              D0CEVN                      WGCEVN
     I              D0CFVN                      WGCFVN
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Cnv Upd Spot Buy Flag XF
      * ** W77844 DN  06/11/21
      * ** One time conversion to update the Spot Buy flag values.
      * ** Selecting All Orders!
      * ** Convert Spot Buy Flag values for the following files:
      * **   PMAMREP - Order Header Extsn - Field 'OHE Spot Buy'.
      * **     From Value: '*YES' -> 'S'pot  and '*NO' -> 'T'urn.
      * **   OPBGWKP - Order Detail - Field 'OD Spot Buy'.
      * **     From Value: 'Y' -> 'S'pot  and 'N' -> 'T'urn.
      * **   PMD0CPP - Sales History Ext - Field 'SH Spot Buy Sts'.
      * **     From Value: 'Y' -> 'S'pot  and 'N' -> 'T'urn.
      * !!! TESTING ONLY-COMMENT OUT when finish Testing!!!
      * DN-Remove RST after Finish Testing!!!
      * Cnv Upd Spot Buy Flag RT - Order Header TRG  * 
     C                   EXSR      SARVGN
      * !!! TESTING ONLY-COMMENT OUT when finish Testing!!!
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Cnv Upd Spot Buy Flag RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Establish starting position
     C     *LOVAL        SETLL     @BECPFK                                      *
     C                   READ      @BECPFK                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * Update Field 'OHE Spot Buy' values in OHE file.
      * Cnv Upd Spot Buy Flag RT - Order Header Extension  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SBRVGN
      * Update Field 'OD Spot Buy' values in OD file.
      * Cnv Upd Spot Buy Flag RT - Order Detail  * 
     C                   EXSR      SDRVGN
      * Update Field 'SH Spot Buy Sts' values in SHE file.
      * Cnv Upd Spot Buy Flag RT - Sales History EXT  * 
     C                   EXSR      SFRVGN
     C                   READ      @BECPFK                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Cnv Upd Spot Buy Flag RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        WBAIC3                         Company Number
     C                   Z-ADD     WAC4NB        WBC4NB                         Order Number
      * Establish starting position
     C     KRSSB         CHAIN     @AMREJF                            90        *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * CASE: DB1.OHE Spot Buy is *Blank
     C                   IF        NOT *IN90
     C                   IF        WBC3TX = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * Convert Old to New Values:
      * CASE: DB1.OHE Spot Buy is *YES
     C                   IF        WBC3TX = '*YES'
     C                   EVAL      YL0001 = ' '                                 OHE Spot Buy
     C                   MOVEL     'S'           YL0001                         OHE Spot Buy
     C                   ELSE
      * CASE: DB1.OHE Spot Buy is *NO
     C                   IF        WBC3TX = '*NO'
     C                   EVAL      YL0001 = ' '                                 OHE Spot Buy
     C                   MOVEL     'T'           YL0001                         OHE Spot Buy
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Cnv Upd Spot Buy Flag  CH - Order Header Extension  * 
     C                   EXSR      SCCHRC
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCHRC        BEGSR
      *================================================================
      * Cnv Upd Spot Buy Flag  CH - Order Header Extension  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Load ID
     C                   Z-ADD     *ZERO         WN0002                         Stop/Drop Seque
     C                   EVAL      WN0003 = ' '                                 Shipping Line
     C                   EVAL      WN0004 = ' '                                 Port Delv Termi
     C                   EVAL      WN0005 = ' '                                 OHE City
     C                   EVAL      WN0006 = ' '                                 OHE Vessel/Airl
     C                   EVAL      WN0007 = ' '                                 OHE Voyage/Flig
     C                   EVAL      WN0008 = ' '                                 OHE Booking Num
     C                   EVAL      WN0009 = ' '                                 OHE Discharge P
     C                   Z-ADD     *ZERO         WN0010                         OHE Sail/Flight
     C                   Z-ADD     *ZERO         WN0011                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WN0012                         OHE Arrival Dat
     C                   EVAL      WN0013 = ' '                                 OHE Late Delive
     C                   EVAL      WN0014 = ' '                                 OHE Ship Status
     C                   EVAL      WN0015 = ' '                                 OHE Container N
     C                   EVAL      WN0016 = ' '                                 OHE Comment 1
     C                   EVAL      WN0017 = ' '                                 OHE Comment 2
     C                   Z-ADD     *ZERO         WN0018                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0019                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0020                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0021                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0022                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WN0023                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WN0024                         Transload Termi
     C                   Z-ADD     *ZERO         WN0025                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WN0026                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WN0027                         OHE Port/Pier P
     C                   Z-ADD     *ZERO         WN0028                         OHE Actual Ship
     C                   EVAL      WN0029 = ' '                                 OHE Carrier SCA
     C                   EVAL      WN0030 = ' '                                 OHE PO ACK Flag
     C                   EVAL      WN0031 = ' '                                 OHE Override Ty
     C                   EVAL      WN0032 = ' '                                 OHE Backhaul St
     C                   EVAL      WN0033 = ' '                                 OHE Backhaul ET
     C                   EVAL      WN0034 = ' '                                 OHE Load Haul T
     C                   EVAL      WN0035 = ' '                                 OHE Backhaul Ca
     C                   EVAL      WN0036 = ' '                                 OHE Bookings Co
     C                   EVAL      WN0037 = ' '                                 OHE EDI Error R
     C                   EVAL      WN0038 = ' '                                 OHE EDI Error R
     C                   Z-ADD     *ZERO         WN0039                         HPB COA Batch N
     C                   EVAL      WN0040 = ' '                                 Delivery P.O. N
     C                   EVAL      WN0041 = ' '                                 OHE Intended fo
     C                   EVAL      WN0042 = ' '                                 OHE EDI 943 Act
     C                   EVAL      WN0043 = ' '                                 OHE EDI 944 Act
     C                   EVAL      WN0044 = ' '                                 OHE EDI 940 Act
     C                   EVAL      WN0045 = ' '                                 OHE EDI 945 Act
     C                   EVAL      WN0046 = ' '                                 OHE EDI 856 Act
     C                   EVAL      WN0047 = ' '                                 OHE EDI 824 Act
     C                   EVAL      WN0048 = ' '                                 OHE Transload S
     C                   EVAL      WN0049 = ' '                                 OHE Abs Rate Ov
     C                   EVAL      WN0050 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0051 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0052 = ' '                                 OHE Backhaul Ch
     C                   EVAL      WN0053 = ' '                                 OHE Transload C
     C                   EVAL      WN0054 = ' '                                 OHE Pier Pass I
     C                   EVAL      WN0055 = ' '                                 OHE Carrier Nm
     C                   EVAL      WN0056 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0057 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0058 = ' '                                 Letter of Credi
     C                   Z-ADD     *ZERO         WN0059                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WN0060                         LD Stop/Drop
     C                   Z-ADD     *ZERO         WN0061                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0062                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WN0063                         OHE Port Check
     C                   Z-ADD     *ZERO         WN0064                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WN0065                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WN0066                         OHE Load Sched
     C                   Z-ADD     *ZERO         WN0067                         Original Appoin
     C                   Z-ADD     *ZERO         WN0068                         Original Appoin
     C                   Z-ADD     *ZERO         WN0069                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0070                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0071                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WN0072                         OHE Orig ABS Fr
     C                   EVAL      WN0073 = ' '                                 OHE Genset Numb
     C                   EVAL      WN0074 = ' '                                 OHE Email BOL/S
     C                   EVAL      WN0075 = ' '                                 OHE EDI Order A
     C                   EVAL      WN0076 = ' '                                 OHE Unused Stat
     C                   EVAL      WN0077 = ' '                                 OHE Unused Stat
     C                   EVAL      WN0078 = ' '                                 OHE Unused Text
     C                   EVAL      WN0079 = ' '                                 OHE Unused Text
     C                   EVAL      WN0080 = ' '                                 OHE Customer Ve
     C                   EVAL      WN0081 = ' '                                 OHE Unused Text
     C                   EVAL      WN0082 = ' '                                 OHE Unused Text
     C                   Z-ADD     *ZERO         WN0083                         OHE Unused Date
     C                   Z-ADD     *ZERO         WN0084                         OHE Unused Date
     C                   EVAL      WN0085 = ' '                                 EDI Status 1
     C                   EVAL      WN0086 = ' '                                 EDI Status 2
     C                   EVAL      WN0087 = ' '                                 EDI Status 3
     C                   EVAL      WN0088 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0089                         Job Time
     C                   EVAL      WN0090 = ' '                                 User Id
     C                   EVAL      WN0091 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0092                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @AMREJE
     C                   Z-ADD     WBAIC3        WCAIC3                         Company Number
     C                   Z-ADD     WBC4NB        WCC4NB                         Order Number
      *
     C     KLCHSC        KLIST
     C                   KFLD                    WCAIC3                         Company Number
     C                   KFLD                    WCC4NB                         Order Number
     C     KLCHSC        CHAIN     @AMREJE                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PMAMREL0'    MDACP
     C                   MOVEL     '@AMREJE'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPMAM1        YARDCS
      * Move non-key fields to @AMREJE
     C                   MOVEL(P)  YL0001        WCC3TX                         OHE Spot Buy
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @AMREJE                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PMAMREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Cnv Upd Spot Buy Flag RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WQSD01                         Company Number
     C                   KFLD                    WQSD02                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        WQSD01                         Company Number
     C                   Z-ADD     WAC4NB        WQSD02                         Order Number
      * Establish starting position
     C     KRSSD         SETLL     @BGWKL1                                      *
     C     KRSSD         READE     @BGWKL1                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * CASE: DB1.OD Spot Buy is No-blank
     C                   DOW       NOT *IN90
     C                   IF        WDH2ST = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * Convert Old to New Values:
      * CASE: DB1.OD Spot Buy is Yes
     C                   IF        WDH2ST = 'Y'
     C                   MOVEL     'S'           YL0002                         OD Spot Buy
     C                   ELSE
      * CASE: DB1.OD Spot Buy is No
     C                   IF        WDH2ST = 'N'
     C                   MOVEL     'T'           YL0002                         OD Spot Buy
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Cnv Upd OD Spot Buy   CH - Order Detail  * 
     C                   EXSR      SECHRC
     C                   END                                                    *FI
     C     KRSSD         READE     @BGWKL1                                90    *
     C                   ENDDO
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SECHRC        BEGSR
      *================================================================
      * Cnv Upd OD Spot Buy   CH - Order Detail  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0093                         Item Code
     C                   EVAL      WN0094 = ' '                                 Warehouse Code
     C                   Z-ADD     *ZERO         WN0095                         Ship To Custome
     C                   Z-ADD     *ZERO         WN0096                         Order Group Cod
     C                   EVAL      WN0097 = ' '                                 Detail Line Sta
     C                   EVAL      WN0098 = ' '                                 Detail Line Sta
     C                   Z-ADD     *ZERO         WN0099                         Billing Detail
     C                   Z-ADD     *ZERO         WN0100                         Billing Detail
     C                   Z-ADD     *ZERO         WN0101                         Billing Detail
     C                   Z-ADD     *ZERO         WN0102                         Quantity to Sub
     C                   EVAL      WN0103 = ' '                                 Comment Print A
     C                   EVAL      WN0104 = ' '                                 Comment Print I
     C                   EVAL      WN0105 = ' '                                 Comment Print P
     C                   EVAL      WN0106 = ' '                                 Comment Print S
     C                   Z-ADD     *ZERO         WN0107                         Extended Amount
     C                   Z-ADD     *ZERO         WN0108                         Market Pricing
     C                   EVAL      WN0109 = ' '                                 Commodity Marke
     C                   EVAL      WN0110 = ' '                                 Date Method Cod
     C                   EVAL      WN0111 = ' '                                 Price Method Co
     C                   Z-ADD     *ZERO         WN0112                         Price Overage O
     C                   Z-ADD     *ZERO         WN0113                         Contract Number
     C                   EVAL      WN0114 = ' '                                 Price Status
     C                   Z-ADD     *ZERO         WN0115                         Pricing Date Us
     C                   EVAL      WN0116 = ' '                                 U/M - Base Pric
     C                   EVAL      WN0117 = ' '                                 U/M - Ordered
     C                   EVAL      WN0118 = ' '                                 Work Confirm St
     C                   EVAL      WN0119 = ' '                                 Work Over/Short
     C                   EVAL      WN0120 = ' '                                 OD Production P
     C                   EVAL      WN0121 = ' '                                 Order Desc. Lin
     C                   EVAL      WN0122 = ' '                                 Order Desc. Lin
     C                   EVAL      WN0123 = ' '                                 Age Code
     C                   EVAL      WN0124 = ' '                                 Palletize
     C                   EVAL      WN0125 = ' '                                 Slip Sheet
     C                   EVAL      WN0126 = ' '                                 Catch Weight St
     C                   EVAL      WN0127 = ' '                                 Price Audit
     C                   EVAL      WN0128 = ' '                                 Price Audit Rea
     C                   EVAL      WN0129 = ' '                                 Production Date
     C                   Z-ADD     *ZERO         WN0130                         Rated Freight
     C                   Z-ADD     *ZERO         WN0131                         Quantity Ordere
     C                   Z-ADD     *ZERO         WN0132                         Weight Ordered
     C                   Z-ADD     *ZERO         WN0133                         Quantity Schedu
     C                   Z-ADD     *ZERO         WN0134                         Weight Schedule
     C                   Z-ADD     *ZERO         WN0135                         Quantity Shippe
     C                   Z-ADD     *ZERO         WN0136                         Weight Shipped
     C                   Z-ADD     *ZERO         WN0137                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WN0138                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WN0139                         Unit Price
     C                   Z-ADD     *ZERO         WN0140                         Unit Price - Cr
     C                   Z-ADD     *ZERO         WN0141                         Unit Price Orde
     C                   Z-ADD     *ZERO         WN0142                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WN0143                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WN0144                         Requested Ship
     C                   Z-ADD     *ZERO         WN0145                         Scheduled Ship
     C                   Z-ADD     *ZERO         WN0146                         Actual Shipped
     C                   EVAL      WN0147 = ' '                                 Affect Inventor
     C                   EVAL      WN0148 = ' '                                 Affect Sales Do
     C                   EVAL      WN0149 = ' '                                 Affect Sales Pn
     C                   Z-ADD     *ZERO         WN0150                         Item Structure
     C                   Z-ADD     *ZERO         WN0151                         Item Structure
     C                   Z-ADD     *ZERO         WN0152                         Item Structure
     C                   EVAL      WN0153 = ' '                                 Item Level
     C                   EVAL      WN0154 = ' '                                 Quality Level
     C                   EVAL      WN0155 = ' '                                 Pricing Product
     C                   EVAL      WN0156 = ' '                                 Season Product
     C                   Z-ADD     *ZERO         WN0157                         Date of Origina
     C                   EVAL      WN0158 = ' '                                 User Profile Na
     C                   EVAL      WN0159 = ' '                                 Country Code
     C                   EVAL      WN0160 = ' '                                 Event Code
     C                   EVAL      WN0161 = ' '                                 Reason Code
     C                   EVAL      WN0162 = ' '                                 Sales Route Cod
     C                   EVAL      WN0163 = ' '                                 Modified Flag
     C                   EVAL      WN0164 = ' '                                 Substituted Fla
     C                   EVAL      WN0165 = ' '                                 OD Schedule Ove
     C                   Z-ADD     *ZERO         WN0166                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WN0167                         Invoice Extende
     C                   Z-ADD     *ZERO         WN0168                         Ham Group Numbe
     C                   EVAL      WN0169 = ' '                                 OD Adj Type Ove
     C                   EVAL      WN0170 = ' '                                 Affect Trade Fu
     C                   EVAL      WN0171 = ' '                                 Affect Commissi
     C                   EVAL      WN0172 = ' '                                 Affect Pricing
     C                   EVAL      WN0173 = ' '                                 Released by Use
     C                   EVAL      WN0174 = ' '                                 Ord TF Exempt C
     C                   EVAL      WN0175 = ' '                                 OD Pallet Type
     C                   EVAL      WN0176 = ' '                                 Production Ware
     C                   EVAL      WN0177 = ' '                                 OD Price Type
     C                   Z-ADD     *ZERO         WN0178                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0179                         Consumed Item C
     C                   Z-ADD     *ZERO         WN0180                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0181                         OD Price Type R
     C                   Z-ADD     *ZERO         WN0182                         OD Firm Date
     C                   Z-ADD     *ZERO         WN0183                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0184                         Price Code
     C                   Z-ADD     *ZERO         WN0185                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WN0186                         Substitution Li
     C                   Z-ADD     *ZERO         WN0187                         Max Qty to sche
     C                   Z-ADD     *ZERO         WN0188                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0189                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WN0190                         OD Item Target
     C                   Z-ADD     *ZERO         WN0191                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WN0192                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WN0193                         Order Gate/Fina
     C                   Z-ADD     *ZERO         WN0194                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WN0195                         OD Gate/Final P
     C                   Z-ADD     *ZERO         WN0196                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WN0197                         OD Original Ord
     C                   Z-ADD     *ZERO         WN0198                         OD Cancel Date
     C                   Z-ADD     *ZERO         WN0199                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WN0200                         OD Unused Prc 8
     C                   EVAL      WN0201 = ' '                                 OD MPR Sent to
     C                   EVAL      WN0202 = ' '                                 OD MPR Prc Read
     C                   EVAL      WN0203 = ' '                                 OD UnUsed Price
     C                   Z-ADD     *ZERO         WN0204                         Weight Amount E
     C                   Z-ADD     *ZERO         WN0205                         Item Age Days
     C                   Z-ADD     *ZERO         WN0206                         Production Ovr
     C                   Z-ADD     *ZERO         WN0207                         Production Ovr
     C                   EVAL      WN0208 = ' '                                 OD Clm Full Ret
     C                   EVAL      WN0209 = ' '                                 Order Line Erro
     C                   Z-ADD     *ZERO         WN0210                         OD Market Begin
     C                   Z-ADD     *ZERO         WN0211                         OD Market Endin
     C                   Z-ADD     *ZERO         WN0212                         OD Atch to Ord
     C                   EVAL      WN0213 = ' '                                 EDI Status 1
     C                   EVAL      WN0214 = ' '                                 EDI Status 2
     C                   EVAL      WN0215 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0216                         Job Time
     C                   EVAL      WN0217 = ' '                                 User Id
     C                   EVAL      WN0218 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0219                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @BGWKL0
     C                   Z-ADD     WDAIC3        WEAIC3                         Company Number
     C                   Z-ADD     WDC4NB        WEC4NB                         Order Number
     C                   Z-ADD     WDDPNB        WEDPNB                         Order Sequence
     C                   Z-ADD     WDUENB        WEUENB                         Order Secondary
      *
     C     KLCHSE        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEC4NB                         Order Number
     C                   KFLD                    WEDPNB                         Order Sequence
     C                   KFLD                    WEUENB                         Order Secondary
     C     KLCHSE        CHAIN     @BGWKL0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBGWKL0'    MDACP
     C                   MOVEL     '@BGWKL0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBG1        YBRDCS
      * Move non-key fields to @BGWKL0
     C                   MOVEL(P)  YL0002        WEH2ST                         OD Spot Buy
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @BGWKL0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBGWKL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * Cnv Upd Spot Buy Flag RT - Sales History EXT  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    WQSF01                         Company Number
     C                   KFLD                    WQSF02                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        WQSF01                         Company Number
     C                   Z-ADD     WAC4NB        WQSF02                         Order Number
      * Establish starting position
     C     KRSSF         SETLL     @D0CPTQ                                      *
     C     KRSSF         READE     @D0CPTQ                                90    *
      * Data record not found
     C   90              MOVEL     'USR3950'     W0RTN
      * USER: Process Data record
      * CASE: DB1.SH Spot Buy Sts is Blank
     C                   DOW       NOT *IN90
     C                   IF        WFSHS1 = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * Convert Old to New Values:
      * CASE: DB1.SH Spot Buy Sts is Yes
     C                   IF        WFSHS1 = 'Y'
     C                   MOVEL     'S'           YL0003                         SH Spot Buy Sts
     C                   ELSE
      * CASE: DB1.SH Spot Buy Sts is No
     C                   IF        WFSHS1 = 'N'
     C                   MOVEL     'T'           YL0003                         SH Spot Buy Sts
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Cnv Upd Spot Buy Flag CH - Sales History EXT  * 
     C                   EXSR      SGCHRC
     C                   END                                                    *FI
     C     KRSSF         READE     @D0CPTQ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGCHRC        BEGSR
      *================================================================
      * Cnv Upd Spot Buy Flag CH - Sales History EXT  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0220                         SH Fuel Surchar
     C                   EVAL      WN0221 = ' '                                 SH Price Type
     C                   EVAL      WN0222 = ' '                                 SH Slip Sheet
     C                   EVAL      WN0223 = ' '                                 SH Unused Sts 2
     C                   EVAL      WN0224 = ' '                                 SH Order Sales
     C                   Z-ADD     *ZERO         WN0225                         SH Price Type R
     C                   EVAL      WN0226 = ' '                                 Delivery P.O. N
     C                   Z-ADD     *ZERO         WN0227                         SH Firm Date
     C                   Z-ADD     *ZERO         WN0228                         SH Revenue Adju
     C                   Z-ADD     *ZERO         WN0229                         Orig Ord ABS Fr
     C                   Z-ADD     *ZERO         WN0230                         SH Unused Value
     C                   Z-ADD     *ZERO         WN0231                         SH Gate Price
     C                   Z-ADD     *ZERO         WN0232                         SH Gate/Final A
     C                   Z-ADD     *ZERO         WN0233                         SH Unused Date
     C                   Z-ADD     *ZERO         WN0234                         SH Unused Date
     C                   EVAL      WN0235 = ' '                                 SH Unused Statu
     C                   EVAL      WN0236 = ' '                                 Invoiced Abs Ov
     C                   EVAL      WN0237 = ' '                                 SH Intended for
     C                   EVAL      WN0238 = ' '                                 SH Unused Statu
     C                   EVAL      WN0239 = ' '                                 SH Unused Text
     C                   EVAL      WN0240 = ' '                                 SH Booking Numb
     C                   EVAL      WN0241 = ' '                                 SH Genset Numbe
     C                   EVAL      WN0242 = ' '                                 SH Unused Text
     C                   Z-ADD     *ZERO         WN0243                         SH Calendar Wee
     C                   Z-ADD     *ZERO         WN0244                         SH Unused Numer
     C                   Z-ADD     *ZERO         WN0245                         SH Calendar Yea
     C                   Z-ADD     *ZERO         WN0246                         SH Original Ord
     C                   Z-ADD     *ZERO         WN0247                         SH Unused Numer
     C                   Z-ADD     *ZERO         WN0248                         SH Unused Numer
     C                   Z-ADD     *ZERO         WN0249                         SH Unused Numer
     C                   Z-ADD     *ZERO         WN0250                         SH Unused Numer
     C                   EVAL      WN0251 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0252                         Create Date
     C                   Z-ADD     *ZERO         WN0253                         Create Time
     C                   EVAL      WN0254 = ' '                                 Create User
     C                   EVAL      WN0255 = ' '                                 Create Program
     C                   Z-ADD     *ZERO         WN0256                         Change Date
     C                   Z-ADD     *ZERO         WN0257                         Change Time
     C                   EVAL      WN0258 = ' '                                 Change User
     C                   EVAL      WN0259 = ' '                                 Change Program
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YCRDC = ' '
      *
      * Move key fields to @D0CPTP
     C                   Z-ADD     WFAIC3        WGAIC3                         Company Number
     C                   Z-ADD     WFC4NB        WGC4NB                         Order Number
     C                   Z-ADD     WFDPNB        WGDPNB                         Order Sequence
     C                   Z-ADD     WFUENB        WGUENB                         Order Secondary
      *
     C     KLCHSG        KLIST
     C                   KFLD                    WGAIC3                         Company Number
     C                   KFLD                    WGC4NB                         Order Number
     C                   KFLD                    WGDPNB                         Order Sequence
     C                   KFLD                    WGUENB                         Order Secondary
     C     KLCHSG        CHAIN     @D0CPTP                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PMD0CPL0'    MDACP
     C                   MOVEL     '@D0CPTP'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL003.
     C                   MOVEL     'LBL003'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SGEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SGEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPMD01        YCRDCS
      * Move non-key fields to @D0CPTP
     C                   MOVEL(P)  YL0003        WGSHS1                         SH Spot Buy Sts
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMD01 <> YCRDCS AND
     C                             YCRDC <> 'N'
     C                   MOVE      'Y'           YCRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YCRDC = 'Y'
     C                   UPDATE    @D0CPTP                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PMD0CPL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Clear all neither parameters
     C                   Z-ADD     *ZERO         P1AIC3                         Company Number
     C                   Z-ADD     *ZERO         P1C4NB                         Order Number
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WAANC7                         A/R Customer Nu
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WAB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WAA0DT                         Order Date
     C                   Z-ADD     *ZERO         WAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WAGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WAACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WACXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WAJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WAA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WAEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WAAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WATBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WARNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WAATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WARSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WAT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WACONB                         Invoice Number
     C                   Z-ADD     *ZERO         WAAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WAVRVA                         A/R order Value
     C                   Z-ADD     *ZERO         WAB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WANODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WANPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WANQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WANRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WANSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WABPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WABQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WABRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WABSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WABTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WAH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WAH1NX                         Act Non-Ref Frt
     C                   Z-ADD     *ZERO         WAH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WAH3NX                         OH Total Non-Re
     C                   Z-ADD     *ZERO         WAH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WAC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBRMNB                         Load ID
     C                   Z-ADD     *ZERO         WBRUNB                         Stop/Drop Seque
     C                   Z-ADD     *ZERO         WBQWDT                         OHE Sail/Flight
     C                   Z-ADD     *ZERO         WBQXDT                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WBQYDT                         OHE Arrival Dat
     C                   Z-ADD     *ZERO         WBGINY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WBGFNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WBGGNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WBGHNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WBHEVL                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WBHFVL                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WBHGVL                         Transload Termi
     C                   Z-ADD     *ZERO         WBQZDT                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WBQ0DT                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WBQ1DT                         OHE Port/Pier P
     C                   Z-ADD     *ZERO         WBQ2DT                         OHE Actual Ship
     C                   Z-ADD     *ZERO         WBITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WBQJNY                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WBQKNY                         LD Stop/Drop
     C                   Z-ADD     *ZERO         WBQLNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WBP8NY                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WBP9NY                         OHE Port Check
     C                   Z-ADD     *ZERO         WBQANY                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WBQCNY                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WBQDNY                         OHE Load Sched
     C                   Z-ADD     *ZERO         WBQENY                         Original Appoin
     C                   Z-ADD     *ZERO         WBQFNY                         Original Appoin
     C                   Z-ADD     *ZERO         WBQGNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WBQHNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WBQINY                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WBQMNY                         OHE Orig ABS Fr
     C                   Z-ADD     *ZERO         WBW5DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WBW6DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDAIC3                         Company Number
     C                   Z-ADD     *ZERO         WDC4NB                         Order Number
     C                   Z-ADD     *ZERO         WDDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WDUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WDHGCD                         Item Code
     C                   Z-ADD     *ZERO         WDBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WDCFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         WDMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         WDKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         WDL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         WDL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         WDAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WDEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WDBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WDL6NB                         Contract Number
     C                   Z-ADD     *ZERO         WDGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         WDR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WDAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WDD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         WDCCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WDAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         WDCBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         WDATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         WDAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WDAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WDAKPR                         Unit Price
     C                   Z-ADD     *ZERO         WDALPR                         Unit Price - Cr
     C                   Z-ADD     *ZERO         WDAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         WDAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WDA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WDA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WDAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WDGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WDRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WDRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WDRINB                         Item Structure
     C                   Z-ADD     *ZERO         WDCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WDDUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WDB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         WDA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WDNTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         WDNUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         WDNVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WDNWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         WDNXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         WDBUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WDBVTM                         Price Code
     C                   Z-ADD     *ZERO         WDBWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WDBXTM                         Substitution Li
     C                   Z-ADD     *ZERO         WDBYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         WDH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         WDH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WDH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         WDH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WDH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WDDVPR                         Order Gate/Fina
     C                   Z-ADD     *ZERO         WDDWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WDDXPR                         OD Gate/Final P
     C                   Z-ADD     *ZERO         WDDYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WDDZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         WDGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         WDGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WDGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         WDPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         WDRINY                         Item Age Days
     C                   Z-ADD     *ZERO         WDTIDT                         Production Ovr
     C                   Z-ADD     *ZERO         WDTJDT                         Production Ovr
     C                   Z-ADD     *ZERO         WDTKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         WDTLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         WDTMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WFAIC3                         Company Number
     C                   Z-ADD     *ZERO         WFC4NB                         Order Number
     C                   Z-ADD     *ZERO         WFDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WFUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WFI7VL                         SH Fuel Surchar
     C                   Z-ADD     *ZERO         WFSADT                         SH Price Type R
     C                   Z-ADD     *ZERO         WFSBDT                         SH Firm Date
     C                   Z-ADD     *ZERO         WFI9VL                         SH Revenue Adju
     C                   Z-ADD     *ZERO         WFJAVL                         Orig Ord ABS Fr
     C                   Z-ADD     *ZERO         WFJBVL                         SH Unused Value
     C                   Z-ADD     *ZERO         WFGIPR                         SH Gate Price
     C                   Z-ADD     *ZERO         WFGJPR                         SH Gate/Final A
     C                   Z-ADD     *ZERO         WFTCDT                         SH Unused Date
     C                   Z-ADD     *ZERO         WFTDDT                         SH Unused Date
     C                   Z-ADD     *ZERO         WFQRNY                         SH Calendar Wee
     C                   Z-ADD     *ZERO         WFQSNY                         SH Unused Numer
     C                   Z-ADD     *ZERO         WFQNNY                         SH Calendar Yea
     C                   Z-ADD     *ZERO         WFQONY                         SH Original Ord
     C                   Z-ADD     *ZERO         WFQPNY                         SH Unused Numer
     C                   Z-ADD     *ZERO         WFQQNY                         SH Unused Numer
     C                   Z-ADD     *ZERO         WFQTNY                         SH Unused Numer
     C                   Z-ADD     *ZERO         WFQUNY                         SH Unused Numer
     C                   Z-ADD     *ZERO         WFMJDT                         Create Date
     C                   Z-ADD     *ZERO         WFBETM                         Create Time
     C                   Z-ADD     *ZERO         WFMKDT                         Change Date
     C                   Z-ADD     *ZERO         WFBFTM                         Change Time
     C                   MOVEL     'N'           W0PMT
      * Define local work field OHE Spot Buy
     C                   EVAL      YL0001 = ' '
      * Define local work field OD Spot Buy
     C                   EVAL      YL0002 = ' '
      * Define local work field SH Spot Buy Sts
     C                   EVAL      YL0003 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
