/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  HP40511CL                                     */
/*  PROGRAM NAME:    BGF PRODUCTION EDIT LISTINGS PERFORM VALIDATI */
/*  PROGRAMMER:      SUSAN BLAKEY                                  */
/*  CREATE DATE:     04/14/01                                      */
/*                                                                 */
/*  FUNCTION:        THIS CL WILL PERFORM THE VALIDATION ROUTINE   */
/*                   FOR HP4051 TO DISPLAY ERROR ON HP4051         */
/*                   THE MESSSGE WAS CAUSED DUE TO OBJECT LOCKS   */
/*                   SO THIS PROGRAM WAS WRITTEN TO PERFORM THESE  */
/*                   VALIDATIONS BEFORE THE SUBMIT JOB WAS         */
/*                   REQUESTED.  THE HP4051CL WILL THEN BE SELECTED*/
/*                   IF THERE ARE NO OBJ LOCKS.                    */
/*                                                                 */
/*                                                                 */
/* 04/13/21  SUSAN BLAKEY CLONE FROM HP4051CL TO HP40511CL         */
/*           THEN REDESIGN TO ONLY PERFORM THE VALIDATION          */
/*                                                                 */
/*******************************************************************/

             PGM        PARM(&IERR &IMSGNO)

             DCL        VAR(&IERR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&ERR) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&IMSGNO) TYPE(*CHAR) LEN(7)
             DCL        VAR(&ERROR) TYPE(*CHAR) LEN(1) VALUE('N')

             DCL        VAR(&MSG) TYPE(*CHAR) LEN(6) VALUE('      ')

/*------------------------------------*/
/* FARM MASTER                        */
/*------------------------------------*/

/*-  FILE HPPB018                                                         */
 HP018:      WRKOBJLCK  OBJ(HPPB018) OBJTYPE(*FILE) MBR(*ALL) +
                          OUTPUT(*PRINT)
             CPYSPLF    FILE(QPDSPOLK) TOFILE(HSP4051) SPLNBR(*LAST)
             CHGVAR     VAR(&MSG) VALUE('      ')
             CALL       PGM(HP40511) PARM(&MSG)
             IF         COND(&MSG *EQ 'NOTLCK') THEN(GOTO +
                          CMDLBL(HP082))

             GOTO CMDLBL(CHKERR)

/*-  FILE HPPB082                                                    */
 HP082:      WRKOBJLCK  OBJ(HPPB082) OBJTYPE(*FILE) MBR(*ALL) +
                          OUTPUT(*PRINT)
             CPYSPLF    FILE(QPDSPOLK) TOFILE(HSP4051) SPLNBR(*LAST)
             CHGVAR     VAR(&MSG) VALUE('      ')
             CALL       PGM(HP40511) PARM(&MSG)
             IF  COND(&MSG *EQ 'NOTLCK') THEN(GOTO  B092)

             GOTO CMDLBL(CHKERR)

/*-------------------------------------------*/
/* WEEKLY PRODUCTION                         */
/*-------------------------------------------*/

/*-  FILE HPPB092                                                         */
 B092:       WRKOBJLCK  OBJ(HPPB092) OBJTYPE(*FILE) MBR(*ALL) +
                          OUTPUT(*PRINT)
             CPYSPLF    FILE(QPDSPOLK) TOFILE(HSP4051) SPLNBR(*LAST)
             CHGVAR     VAR(&MSG) VALUE('      ')
             CALL       PGM(HP40511) PARM(&MSG)
             IF  COND(&MSG *EQ 'NOTLCK') THEN(GOTO OUTEND)

             GOTO CMDLBL(CHKERR)


 CHKERR:
             CHGVAR     VAR(&IERR) VALUE(&ERR)
             CHGVAR     VAR(&IMSGNO) VALUE('HS09277')

 OUTEND:
/**********  DMPCLPGM                                          *******/
/*-------------------------------------------------------------------*/
/* END PROGRAM                                                       */
/*-------------------------------------------------------------------*/
             ENDPGM

