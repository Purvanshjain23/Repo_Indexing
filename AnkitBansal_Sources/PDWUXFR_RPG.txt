     H/TITLE CRT Copy Order Temlt   XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 01/23/14  Time  : 13:51:10
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL0IF  E           K        DISK                      A
      * UPD : Order Header TRG          Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * N :  Order Type - Sales
     I                                        7   8 P1JNCD
      * N :  A/R Customer Number
     I                                    P   9  120P1ANC7
      * N :  Ship To Customer
     I                                    P  13  160P1BKC7
      * N :  Ship To Name
     I                                       17  46 P1BRTX
      * N :  Ship To Address Line 1
     I                                       47  76 P1HMNA
      * N :  Ship To Address Line 2
     I                                       77 106 P1HONA
      * N :  Ship To Address Line 3
     I                                      107 136 P1HPNA
      * N :  Ship To City
     I                                      137 156 P1HNNA
      * N :  Ship To State Code
     I                                      157 158 P1DBCD
      * N :  Ship To Zip/Postal Code
     I                                      159 169 P1CKTX
      * N :  Bill to Customer
     I                                    P 170 1730P1B0C7
      * N :  Bill to Name
     I                                      174 203 P1AETX
      * N :  Bill to Address Line 1
     I                                      204 233 P1B1NA
      * N :  Bill to Address Line 2
     I                                      234 263 P1B3NA
      * N :  Bill to Address Line 3
     I                                      264 293 P1B4NA
      * N :  Bill to City
     I                                      294 313 P1B2NA
      * N :  Bill to State Code
     I                                      314 315 P1BHCD
      * N :  Bill to Zip/Postal Code
     I                                      316 326 P1C8TX
      * N :  Customer Purchase Order #
     I                                      327 341 P1BCNA
      * N :  Order Date
     I                                    P 342 3450P1A0DT
      * N :  Requested Ship Date
     I                                    P 346 3490P1A5DT
      * N :  Actual Shipped Date
     I                                    P 350 3530P1GNDT
      * N :  Cancel Date
     I                                    P 354 3570P1ACDT
      * N :  Terms Code
     I                                      358 359 P1AQCD
      * N :  Special Instructions
     I                                      360 399 P1B6NA
      * N :  Special Instructions 2
     I                                      400 439 P1BYNA
      * N :  Carrier Code
     I                                      440 442 P1BZNA
      * N :  Comment Print Acknowledge
     I                                      443 443 P1GTST
      * N :  Comment Print Inv/Cr.Memo
     I                                      444 444 P1GVST
      * N :  Comment Print Pick Slip
     I                                      445 445 P1GUST
      * N :  Comment Print Ship Doc
     I                                      446 446 P1QFST
      * N :  Reason Code
     I                                      447 449 P1CQCD
      * N :  Order in Use
     I                                      450 450 P1GJST
      * N :  Header Status
     I                                      451 451 P1GWST
      * N :  Header Status Last
     I                                      452 452 P1GXST
      * N :  Order Type Print Status
     I                                      453 453 P1GYST
      * N :  Scheduled Ship Date
     I                                    P 454 4570P1AODT
      * N :  User Original Entry
     I                                      458 467 P1AIVN
      * N :  Date of Original Entry
     I                                    P 468 4710P1CXDT
      * N :  Order Value Total
     I                                    P 472 4772P1JZVA
      * N :  Order Weight Total
     I                                    P 478 4832P1A1WG
      * N :  Credit Hold
     I                                      484 484 P1XIST
      * N :  Production Hold
     I                                      485 485 P1XJST
      * N :  New Customer Hold
     I                                      486 486 P1XKST
      * N :  Requested Delivery Date
     I                                    P 487 4900P1EIDT
      * N :  Requested Delivery Time
     I                                    P 491 4930P1AFTM
      * N :  Accounts Receiv. Ent 1
     I                                      494 497 P1E8CD
      * N :  Accounts Receiv. Ent 2
     I                                      498 509 P1E9CD
      * N :  Load ID
     I                                    P 510 5130P1RMNB
      * N :  Absorbed Freight Rate CWT
     I                                    P 514 5162P1TBNB
      * N :  Rated Freight
     I                                    P 517 5222P1R1NB
      * N :  LTL Flag
     I                                      523 523 P1PJST
      * N :  Price Audit
     I                                      524 524 P1U0ST
      * N :  Price Status
     I                                      525 525 P1U1ST
      * N :  Shipping Method
     I                                      526 527 P1Q2CD
      * N :  Export Status
     I                                      528 528 P1U2ST
      * N :  Palletize
     I                                      529 529 P1VEST
      * N :  Shrink Wrap
     I                                      530 530 P1VFST
      * N :  Slip Sheet
     I                                      531 531 P1VGST
      * N :  Age Code
     I                                      532 532 P1RPCD
      * N :  Reefer Temperature
     I                                    P 533 5352P1RNNB
      * N :  Load Type
     I                                      536 536 P1VDST
      * N :  Attach to Invoice Number
     I                                    P 537 5400P1ATIN
      * N :  Load Plan Order
     I                                      541 541 P1U4ST
      * N :  Print Pick Slip
     I                                      542 542 P1U5ST
      * N :  Resell Reference Number
     I                                    P 543 5460P1RSRN
      * N :  Special Comment 1
     I                                      547 576 P1MHNA
      * N :  Special Comment 2
     I                                      577 606 P1MINA
      * N :  Affect Auto Accruals
     I                                      607 607 P1WBST
      * N :  Sales Route Code
     I                                      608 610 P1R4CD
      * N :  Manager Level Code
     I                                      611 612 P1BFCD
      * N :  VP Level Code
     I                                      613 615 P1Q4CD
      * N :  Attach to Order Number
     I                                    P 616 6190P1T3NB
      * N :  Reason for Price Audit
     I                                      620 622 P1SICD
      * N :  Invoice Number
     I                                    P 623 6260P1CONB
      * N :  Invoice Suffix
     I                                      627 628 P1CEST
      * N :  Invoice Date
     I                                    P 629 6320P1AWDT
      * N :  Event Code
     I                                      633 634 P1JPCD
      * N :  Trans Contol AS400/Plant
     I                                      635 635 P1XUST
      * N :  Modified Flag
     I                                      636 636 P1Z1ST
      * N :  A/R order Value Total
     I                                    P 637 6422P1VRVA
      * N :  Billing Activity Type
     I                                      643 643 P1OBST
      * N :  Block Order Flag
     I                                      644 644 P1BCST
      * N :  Order Certification Flag
     I                                      645 645 P1BDST
      * N :  Invoice Order Value Tot
     I                                    P 646 6512P1B7VL
      * N :  Process Sts for 3C
     I                                      652 652 P1GASX
      * N :  Order Conf Fax Sts
     I                                      653 653 P1GBSX
      * N :  Manifest Fax Sts
     I                                      654 654 P1GCSX
      * N :  Invoice Fax Sts
     I                                      655 655 P1GDSX
      * N :  Transfer in Storage Ind
     I                                      656 656 P1FNSX
      * N :  Email Cust On Order Ship
     I                                      657 657 P1FOSX
      * N :  Order Emailed
     I                                      658 658 P1FPSX
      * N :  Export Docs Go w/Driver
     I                                      659 659 P1FQSX
      * N :  Shipping Temp Code C/F
     I                                      660 660 P1FRSX
      * N :  Broker Order Status
     I                                      661 661 P1FSSX
      * N :  Air Freight Order
     I                                      662 662 P1FTSX
      * N :  Order Requires Review
     I                                      663 664 P1FUSX
      * N :  TPM Freight Order Sts
     I                                      665 666 P1FVSX
      * N :  Export USDA Approved
     I                                      667 668 P1FWSX
      * N :  HPB Ship to Warehouse
     I                                      669 671 P1FXSX
      * N :  OH TF Exempt Code
     I                                      672 674 P1FYSX
      * N :  OH Appt Confirmation Dt
     I                                    P 675 6780P1NODT
      * N :  JPN Invoice Issuance Date
     I                                    P 679 6820P1NPDT
      * N :  OH Unused Date 3
     I                                    P 683 6860P1NQDT
      * N :  OH Unused Date 4
     I                                    P 687 6900P1NRDT
      * N :  OH Unused Date 5
     I                                    P 691 6940P1NSDT
      * N :  Maximum Gross Weight
     I                                    P 695 6980P1BPTM
      * N :  Time of Original Entry
     I                                    P 699 7020P1BQTM
      * N :  OH Appt Confirmation Tm
     I                                    P 703 7060P1BRTM
      * N :  OH Unused Time 4
     I                                    P 707 7100P1BSTM
      * N :  OH Unused Time 5
     I                                    P 711 7140P1BTTM
      * N :  Act Frt Reference Amount
     I                                    P 715 7202P1H0NX
      * N :  Act Non-Ref Frt Amount
     I                                    P 721 7262P1H1NX
      * N :  OH Fuel Surcharge Amount
     I                                    P 727 7322P1H2NX
      * N :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382P1H3NX
      * N :  OH Total Ref Frt Amt
     I                                    P 739 7442P1H4NX
      * N :  Claim Number
     I                                    P 745 7480P1C0C7
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CRT Copy Order Temlt   XF
      * CRT Order Header       CR - Order Header TRG  * 
     C                     EXSR SACRRC
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SACRRC    BEGSR
      *================================================================
      * CRT Order Header       CR - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0002 12        Accounts Receiv
     C                     MOVEL*BLANK    WN0003  1        EDI Status 1
     C                     MOVEL*BLANK    WN0004  1        EDI Status 2
     C                     MOVEL*BLANK    WN0005  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0006  60       Job Time
     C                     MOVEL*BLANK    WN0007 10        User Id
     C                     MOVEL*BLANK    WN0008 10        Job Name
     C                     Z-ADD*ZERO     WN0009  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BECPFJ
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
     C                     MOVELP1JNCD    WAJNCD           Order Type - Sa
     C                     Z-ADDP1ANC7    WAANC7           A/R Customer Nu
     C                     Z-ADDP1BKC7    WABKC7           Ship To Custome
     C                     MOVELP1BRTX    WABRTX           Ship To Name
     C                     MOVELP1HMNA    WAHMNA           Ship To Address
     C                     MOVELP1HONA    WAHONA           Ship To Address
     C                     MOVELP1HPNA    WAHPNA           Ship To Address
     C                     MOVELP1HNNA    WAHNNA           Ship To City
     C                     MOVELP1DBCD    WADBCD           Ship To State C
     C                     MOVELP1CKTX    WACKTX           Ship To Zip/Pos
     C                     Z-ADDP1B0C7    WAB0C7           Bill to Custome
     C                     MOVELP1AETX    WAAETX           Bill to Name
     C                     MOVELP1B1NA    WAB1NA           Bill to Address
     C                     MOVELP1B3NA    WAB3NA           Bill to Address
     C                     MOVELP1B4NA    WAB4NA           Bill to Address
     C                     MOVELP1B2NA    WAB2NA           Bill to City
     C                     MOVELP1BHCD    WABHCD           Bill to State C
     C                     MOVELP1C8TX    WAC8TX           Bill to Zip/Pos
     C                     MOVELP1BCNA    WABCNA           Customer Purcha
     C                     Z-ADDP1A0DT    WAA0DT           Order Date
     C                     Z-ADDP1A5DT    WAA5DT           Requested Ship
     C                     Z-ADDP1GNDT    WAGNDT           Actual Shipped
     C                     Z-ADDP1ACDT    WAACDT           Cancel Date
     C                     MOVELP1AQCD    WAAQCD           Terms Code
     C                     MOVELP1B6NA    WAB6NA           Special Instruc
     C                     MOVELP1BYNA    WABYNA           Special Instruc
     C                     MOVELP1BZNA    WABZNA           Carrier Code
     C                     MOVELP1GTST    WAGTST           Comment Print A
     C                     MOVELP1GVST    WAGVST           Comment Print I
     C                     MOVELP1GUST    WAGUST           Comment Print P
     C                     MOVELP1QFST    WAQFST           Comment Print S
     C                     MOVELP1CQCD    WACQCD           Reason Code
     C                     MOVELP1GJST    WAGJST           Order in Use
     C                     MOVELP1GWST    WAGWST           Header Status
     C                     MOVELP1GXST    WAGXST           Header Status L
     C                     MOVELP1GYST    WAGYST           Order Type Prin
     C                     Z-ADDP1AODT    WAAODT           Scheduled Ship
     C                     MOVELP1AIVN    WAAIVN           User Original E
     C                     Z-ADDP1CXDT    WACXDT           Date of Origina
     C                     Z-ADDP1JZVA    WAJZVA           Order Value Tot
     C                     Z-ADDP1A1WG    WAA1WG           Order Weight To
     C                     MOVELP1XIST    WAXIST           Credit Hold
     C                     MOVELP1XJST    WAXJST           Production Hold
     C                     MOVELP1XKST    WAXKST           New Customer Ho
     C                     Z-ADDP1EIDT    WAEIDT           Requested Deliv
     C                     Z-ADDP1AFTM    WAAFTM           Requested Deliv
     C                     Z-ADDP1RMNB    WARMNB           Load ID
     C                     Z-ADDP1TBNB    WATBNB           Absorbed Freigh
     C                     Z-ADDP1R1NB    WAR1NB           Rated Freight
     C                     MOVELP1PJST    WAPJST           LTL Flag
     C                     MOVELP1U0ST    WAU0ST           Price Audit
     C                     MOVELP1U1ST    WAU1ST           Price Status
     C                     MOVELP1Q2CD    WAQ2CD           Shipping Method
     C                     MOVELP1U2ST    WAU2ST           Export Status
     C                     MOVELP1VEST    WAVEST           Palletize
     C                     MOVELP1VFST    WAVFST           Shrink Wrap
     C                     MOVELP1VGST    WAVGST           Slip Sheet
     C                     MOVEL*BLANK    WARPCD           Age Code
     C                     Z-ADDP1RNNB    WARNNB           Reefer Temperat
     C                     MOVELP1VDST    WAVDST           Load Type
     C                     Z-ADDP1ATIN    WAATIN           Attach to Invoi
     C                     MOVELP1U4ST    WAU4ST           Load Plan Order
     C                     MOVELP1U5ST    WAU5ST           Print Pick Slip
     C                     Z-ADDP1RSRN    WARSRN           Resell Referenc
     C                     MOVELP1MHNA    WAMHNA           Special Comment
     C                     MOVELP1MINA    WAMINA           Special Comment
     C                     MOVELP1WBST    WAWBST           Affect Auto Acc
     C                     MOVELP1R4CD    WAR4CD           Sales Route Cod
     C                     MOVELP1BFCD    WABFCD           Manager Level C
     C                     MOVELP1Q4CD    WAQ4CD           VP Level Code
     C                     Z-ADDP1T3NB    WAT3NB           Attach to Order
     C                     MOVELP1SICD    WASICD           Reason for Pric
     C                     Z-ADDP1CONB    WACONB           Invoice Number
     C                     MOVELP1CEST    WACEST           Invoice Suffix
     C                     Z-ADDP1AWDT    WAAWDT           Invoice Date
     C                     MOVELP1JPCD    WAJPCD           Event Code
     C                     MOVELP1XUST    WAXUST           Trans Contol AS
     C                     MOVELP1Z1ST    WAZ1ST           Modified Flag
     C                     Z-ADDP1VRVA    WAVRVA           A/R order Value
     C                     MOVELP1OBST    WAOBST           Billing Activit
     C                     MOVELP1BCST    WABCST           Block Order Fla
     C                     MOVELP1BDST    WABDST           Order Certifica
     C                     Z-ADDP1B7VL    WAB7VL           Invoice Order V
     C                     MOVELP1GASX    WAGASX           Process Sts for
     C                     MOVELP1GBSX    WAGBSX           Order Conf Fax
     C                     MOVELP1GCSX    WAGCSX           Manifest Fax St
     C                     MOVELP1GDSX    WAGDSX           Invoice Fax Sts
     C                     MOVELP1FNSX    WAFNSX           Transfer in Sto
     C                     MOVELP1FOSX    WAFOSX           Email Cust On O
     C                     MOVELP1FPSX    WAFPSX           Order Emailed
     C                     MOVELP1FQSX    WAFQSX           Export Docs Go
     C                     MOVELP1FRSX    WAFRSX           Shipping Temp C
     C                     MOVELP1FSSX    WAFSSX           Broker Order St
     C                     MOVELP1FTSX    WAFTSX           Air Freight Ord
     C                     MOVELP1FUSX    WAFUSX           Order Requires
     C                     MOVELP1FVSX    WAFVSX           TPM Freight Ord
     C                     MOVELP1FWSX    WAFWSX           Export USDA App
     C                     MOVELP1FXSX    WAFXSX           HPB Ship to War
     C                     MOVELP1FYSX    WAFYSX           OH TF Exempt Co
     C                     Z-ADDP1NODT    WANODT           OH Appt Confirm
     C                     Z-ADDP1NPDT    WANPDT           JPN Invoice Iss
     C                     Z-ADDP1NQDT    WANQDT           OH Unused Date
     C                     Z-ADDP1NRDT    WANRDT           OH Unused Date
     C                     Z-ADDP1NSDT    WANSDT           OH Unused Date
     C                     Z-ADDP1BPTM    WABPTM           Maximum Gross W
     C                     Z-ADDP1BQTM    WABQTM           Time of Origina
     C                     Z-ADDP1BRTM    WABRTM           OH Appt Confirm
     C                     Z-ADDP1BSTM    WABSTM           OH Unused Time
     C                     Z-ADDP1BTTM    WABTTM           OH Unused Time
     C                     Z-ADDP1H0NX    WAH0NX           Act Frt Referen
     C                     Z-ADDP1H1NX    WAH1NX           Act Non-Ref Frt
     C                     Z-ADDP1H2NX    WAH2NX           OH Fuel Surchar
     C                     Z-ADDP1H3NX    WAH3NX           OH Total Non-Re
     C                     Z-ADDP1H4NX    WAH4NX           OH Total Ref Fr
     C                     Z-ADDP1C0C7    WAC0C7           Claim Number
      *
      * USER: Processing before Data update
     C                     MOVEL*BLANK    WARPCD           Age Code
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##JOB     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WACXDT    PARM *ZERO     WQ0001 155       Current System
     C           WABQTM    PARM *ZERO     WQ0002 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSA    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSA    SETLL@BECPFJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0177' W0RTN   7
      * USER: Processing if Data record already exists
      * ** Set flag so it can be tested on the return    T075 03/28/2006
     C                     MOVEL@CN,001   P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C                     WRITE@BECPFJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     P1ANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     P1BKC7           Ship To Custome
     C                     MOVEL*BLANK    P1BRTX           Ship To Name
     C                     MOVEL*BLANK    P1HMNA           Ship To Address
     C                     MOVEL*BLANK    P1HONA           Ship To Address
     C                     MOVEL*BLANK    P1HPNA           Ship To Address
     C                     MOVEL*BLANK    P1HNNA           Ship To City
     C                     MOVEL*BLANK    P1DBCD           Ship To State C
     C                     MOVEL*BLANK    P1CKTX           Ship To Zip/Pos
     C                     Z-ADD*ZERO     P1B0C7           Bill to Custome
     C                     MOVEL*BLANK    P1AETX           Bill to Name
     C                     MOVEL*BLANK    P1B1NA           Bill to Address
     C                     MOVEL*BLANK    P1B3NA           Bill to Address
     C                     MOVEL*BLANK    P1B4NA           Bill to Address
     C                     MOVEL*BLANK    P1B2NA           Bill to City
     C                     MOVEL*BLANK    P1BHCD           Bill to State C
     C                     MOVEL*BLANK    P1C8TX           Bill to Zip/Pos
     C                     MOVEL*BLANK    P1BCNA           Customer Purcha
     C                     Z-ADD*ZERO     P1A0DT           Order Date
     C                     Z-ADD*ZERO     P1A5DT           Requested Ship
     C                     Z-ADD*ZERO     P1GNDT           Actual Shipped
     C                     Z-ADD*ZERO     P1ACDT           Cancel Date
     C                     MOVEL*BLANK    P1AQCD           Terms Code
     C                     MOVEL*BLANK    P1B6NA           Special Instruc
     C                     MOVEL*BLANK    P1BYNA           Special Instruc
     C                     MOVEL*BLANK    P1BZNA           Carrier Code
     C                     MOVEL*BLANK    P1GTST           Comment Print A
     C                     MOVEL*BLANK    P1GVST           Comment Print I
     C                     MOVEL*BLANK    P1GUST           Comment Print P
     C                     MOVEL*BLANK    P1QFST           Comment Print S
     C                     MOVEL*BLANK    P1CQCD           Reason Code
     C                     MOVEL*BLANK    P1GJST           Order in Use
     C                     MOVEL*BLANK    P1GWST           Header Status
     C                     MOVEL*BLANK    P1GXST           Header Status L
     C                     MOVEL*BLANK    P1GYST           Order Type Prin
     C                     Z-ADD*ZERO     P1AODT           Scheduled Ship
     C                     MOVEL*BLANK    P1AIVN           User Original E
     C                     Z-ADD*ZERO     P1CXDT           Date of Origina
     C                     Z-ADD*ZERO     P1JZVA           Order Value Tot
     C                     Z-ADD*ZERO     P1A1WG           Order Weight To
     C                     MOVEL*BLANK    P1XIST           Credit Hold
     C                     MOVEL*BLANK    P1XJST           Production Hold
     C                     MOVEL*BLANK    P1XKST           New Customer Ho
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     Z-ADD*ZERO     P1AFTM           Requested Deliv
     C                     MOVEL*BLANK    P1E8CD           Accounts Receiv
     C                     MOVEL*BLANK    P1E9CD           Accounts Receiv
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     Z-ADD*ZERO     P1TBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     P1R1NB           Rated Freight
     C                     MOVEL*BLANK    P1PJST           LTL Flag
     C                     MOVEL*BLANK    P1U0ST           Price Audit
     C                     MOVEL*BLANK    P1U1ST           Price Status
     C                     MOVEL*BLANK    P1Q2CD           Shipping Method
     C                     MOVEL*BLANK    P1U2ST           Export Status
     C                     MOVEL*BLANK    P1VEST           Palletize
     C                     MOVEL*BLANK    P1VFST           Shrink Wrap
     C                     MOVEL*BLANK    P1VGST           Slip Sheet
     C                     MOVEL*BLANK    P1RPCD           Age Code
     C                     Z-ADD*ZERO     P1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    P1VDST           Load Type
     C                     Z-ADD*ZERO     P1ATIN           Attach to Invoi
     C                     MOVEL*BLANK    P1U4ST           Load Plan Order
     C                     MOVEL*BLANK    P1U5ST           Print Pick Slip
     C                     Z-ADD*ZERO     P1RSRN           Resell Referenc
     C                     MOVEL*BLANK    P1MHNA           Special Comment
     C                     MOVEL*BLANK    P1MINA           Special Comment
     C                     MOVEL*BLANK    P1WBST           Affect Auto Acc
     C                     MOVEL*BLANK    P1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    P1BFCD           Manager Level C
     C                     MOVEL*BLANK    P1Q4CD           VP Level Code
     C                     Z-ADD*ZERO     P1T3NB           Attach to Order
     C                     MOVEL*BLANK    P1SICD           Reason for Pric
     C                     Z-ADD*ZERO     P1CONB           Invoice Number
     C                     MOVEL*BLANK    P1CEST           Invoice Suffix
     C                     Z-ADD*ZERO     P1AWDT           Invoice Date
     C                     MOVEL*BLANK    P1JPCD           Event Code
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     MOVEL*BLANK    P1Z1ST           Modified Flag
     C                     Z-ADD*ZERO     P1VRVA           A/R order Value
     C                     MOVEL*BLANK    P1OBST           Billing Activit
     C                     MOVEL*BLANK    P1BCST           Block Order Fla
     C                     MOVEL*BLANK    P1BDST           Order Certifica
     C                     Z-ADD*ZERO     P1B7VL           Invoice Order V
     C                     MOVEL*BLANK    P1GASX           Process Sts for
     C                     MOVEL*BLANK    P1GBSX           Order Conf Fax
     C                     MOVEL*BLANK    P1GCSX           Manifest Fax St
     C                     MOVEL*BLANK    P1GDSX           Invoice Fax Sts
     C                     MOVEL*BLANK    P1FNSX           Transfer in Sto
     C                     MOVEL*BLANK    P1FOSX           Email Cust On O
     C                     MOVEL*BLANK    P1FPSX           Order Emailed
     C                     MOVEL*BLANK    P1FQSX           Export Docs Go
     C                     MOVEL*BLANK    P1FRSX           Shipping Temp C
     C                     MOVEL*BLANK    P1FSSX           Broker Order St
     C                     MOVEL*BLANK    P1FTSX           Air Freight Ord
     C                     MOVEL*BLANK    P1FUSX           Order Requires
     C                     MOVEL*BLANK    P1FVSX           TPM Freight Ord
     C                     MOVEL*BLANK    P1FWSX           Export USDA App
     C                     MOVEL*BLANK    P1FXSX           HPB Ship to War
     C                     MOVEL*BLANK    P1FYSX           OH TF Exempt Co
     C                     Z-ADD*ZERO     P1NODT           OH Appt Confirm
     C                     Z-ADD*ZERO     P1NPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     P1NQDT           OH Unused Date
     C                     Z-ADD*ZERO     P1NRDT           OH Unused Date
     C                     Z-ADD*ZERO     P1NSDT           OH Unused Date
     C                     Z-ADD*ZERO     P1BPTM           Maximum Gross W
     C                     Z-ADD*ZERO     P1BQTM           Time of Origina
     C                     Z-ADD*ZERO     P1BRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     P1BSTM           OH Unused Time
     C                     Z-ADD*ZERO     P1BTTM           OH Unused Time
     C                     Z-ADD*ZERO     P1H0NX           Act Frt Referen
     C                     Z-ADD*ZERO     P1H1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     P1H2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     P1H3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     P1H4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     P1C0C7           Claim Number
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           OH Unused Date
     C                     Z-ADD*ZERO     WANRDT           OH Unused Date
     C                     Z-ADD*ZERO     WANSDT           OH Unused Date
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           OH Unused Time
     C                     Z-ADD*ZERO     WABTTM           OH Unused Time
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0003
