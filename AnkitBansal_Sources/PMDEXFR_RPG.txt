     H/TITLE PFS Inventory Adj ORD XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 05/20/10  Time  : 15:32:26
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPBGCPL3IF  E           K        DISK
      * RSQ : PFS Inventory Adjustment  Co/Ord/OrdDtl/Sub# P=0
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCABZRELXIF  E           K        DISK
      * RSQ : Company Item              Active FinishGood/Wp
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOMFNCPL8IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord/Seq/Seq2/Srl#/LDt
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPOB2CPLFIF  E           K        DISK
      * RSQ : Product Trace             Co/Srl#/LDte
      *
     FPPBGCPL9IF  E           K        DISK
      * RSQ : PFS Inventory Adjustment  Co/Item/Serial/TrTyp,sel
      *
     FPPAAREL3IF  E           K        DISK
      * RSQ : Product Trace Line Scale  Co/ScaleID/Dte(d)
      *
     FPPABREL1IF  E           K        DISK
      * RTV : Product Trace Line        Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FOMFNCPL3IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      *
     FPDL8CPL3IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Seq/Seq2/ASeq(d)
      *
     FPDL8CPL8IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Sq/Sq2/Srl#
      *
     FPOB2CPL0UF  E           K        DISK                      A
      * UPD : Product Trace             Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FCAB1REL1IF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FOMFNCPL0UF  E           K        DISK                      A
      * UPD : Manifest Detail           Update index
      *
     FPDL8CPL0UF  E           K        DISK                      A
      * UPD : Order Inv Allocation      Update index
      *
     FPPBGCPL0UF  E           K        DISK
      * UPD : PFS Inventory Adjustment  Update index
      *
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1   9  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BGCPD8
      * PFS Inventory Adjustment  Co/Ord/OrdDtl/Sub# P=0
      * Renamed input format fields
     I              BGY1NX                          WAY1NX
     I              BGC0NY                          WAC0NY
     I              BGAID8                          WAAID8
     I              BGAFTS                          WAAFTS
     I              BGBCNY                          WABCNY
     I              BGVLSX                          WAVLSX
     I              BGVMSX                          WAVMSX
     I              BGY2NX                          WAY2NX
     I              BGU4SX                          WAU4SX
     I              BGADNY                          WAADNY
     I              BGU1SX                          WAU1SX
     I              BGP7DT                          WAP7DT
     I              BGZ4NX                          WAZ4NX
     I              BGACNY                          WAACNY
     I              BGVKSX                          WAVKSX
     I              BGZ2NX                          WAZ2NX
     I              BGZ6NX                          WAZ6NX
     I              BGBDNY                          WABDNY
     I              BGABNY                          WAABNY
     I              BGBENY                          WABENY
     I              BGZ9NX                          WAZ9NX
     I              BGGBAA                          WAGBAA
     I              BGANNY                          WAANNY
     I              BGZPNX                          WAZPNX
     I              BGZXNX                          WAZXNX
     I              BGZYNX                          WAZYNX
     I              BGALNY                          WAALNY
     I              BGAGNY                          WAAGNY
     I              BGUWSX                          WAUWSX
     I              BGUXSX                          WAUXSX
     I              BGV3SX                          WAV3SX
     I              BGAHNY                          WAAHNY
     I              BGAINY                          WAAINY
     I              BGAJNY                          WAAJNY
     I              BGAKNY                          WAAKNY
      *
     I@BUREBI
      * PFS Interface             Retrieval index
      * Renamed input format fields
     I              BUY1NX                          WBY1NX
     I              BUGYAA                          WBGYAA
     I              BURENA                          WBRENA
     I              BUWSSX                          WBWSSX
     I              BUWUSX                          WBWUSX
     I              BUQEDT                          WBQEDT
     I              BUCUTM                          WBCUTM
     I              BUB0NY                          WBB0NY
     I              BUB1NY                          WBB1NY
     I              BUWXSX                          WBWXSX
     I              BUWVSX                          WBWVSX
     I              BUWWSX                          WBWWSX
     I              BUUWSX                          WBUWSX
     I              BUUXSX                          WBUXSX
     I              BUV3SX                          WBV3SX
     I              BUAHNY                          WBAHNY
     I              BUAINY                          WBAINY
     I              BUAJNY                          WBAJNY
     I              BUAKNY                          WBAKNY
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@BZREJR
      * Company Item              Active FinishGood/Wp
      * Renamed input format fields
     I              BZAIC3                          WDAIC3
     I              BZHGCD                          WDHGCD
     I              BZAVNA                          WDAVNA
     I              BZAWNA                          WDAWNA
     I              BZL7NA                          WDL7NA
     I              BZL8NA                          WDL8NA
     I              BZL6NA                          WDL6NA
     I              BZMFNA                          WDMFNA
     I              BZADCD                          WDADCD
     I              BZAWPC                          WDAWPC
     I              BZLXST                          WDLXST
     I              BZAECD                          WDAECD
     I              BZAXPC                          WDAXPC
     I              BZLYST                          WDLYST
     I              BZAFCD                          WDAFCD
     I              BZAICD                          WDAICD
     I              BZAIWG                          WDAIWG
     I              BZHICD                          WDHICD
     I              BZRBCD                          WDRBCD
     I              BZFZST                          WDFZST
     I              BZAVST                          WDAVST
     I              BZCZWG                          WDCZWG
     I              BZC0WG                          WDC0WG
     I              BZURTN                          WDURTN
     I              BZAJC8                          WDAJC8
     I              BZRINB                          WDRINB
     I              BZRHNB                          WDRHNB
     I              BZRGNB                          WDRGNB
     I              BZLNCD                          WDLNCD
     I              BZTFNB                          WDTFNB
     I              BZN0CD                          WDN0CD
     I              BZX4ST                          WDX4ST
     I              BZTMVA                          WDTMVA
     I              BZTNVA                          WDTNVA
     I              BZBLPR                          WDBLPR
     I              BZBMPR                          WDBMPR
     I              BZLRCD                          WDLRCD
     I              BZU9ST                          WDU9ST
     I              BZCMCO                          WDCMCO
     I              BZQ1CD                          WDQ1CD
     I              BZQ8CD                          WDQ8CD
     I              BZCHTM                          WDCHTM
     I              BZQZCD                          WDQZCD
     I              BZXWST                          WDXWST
     I              BZXXST                          WDXXST
     I              BZVMST                          WDVMST
     I              BZSWGH                          WDSWGH
     I              BZPPHE                          WDPPHE
     I              BZR3CD                          WDR3CD
     I              BZSDCD                          WDSDCD
     I              BZICN1                          WDICN1
     I              BZSVCD                          WDSVCD
     I              BZICN2                          WDICN2
     I              BZSWCD                          WDSWCD
     I              BZV2NB                          WDV2NB
     I              BZSXCD                          WDSXCD
     I              BZITCN                          WDITCN
     I              BZSYCD                          WDSYCD
     I              BZITC5                          WDITC5
     I              BZSZCD                          WDSZCD
     I              BZICN6                          WDICN6
     I              BZS0CD                          WDS0CD
     I              BZICN7                          WDICN7
     I              BZS1CD                          WDS1CD
     I              BZICN8                          WDICN8
     I              BZS2CD                          WDS2CD
     I              BZICN9                          WDICN9
     I              BZS3CD                          WDS3CD
     I              BZICN0                          WDICN0
     I              BZS4CD                          WDS4CD
     I              BZSFNB                          WDSFNB
     I              BZA3WG                          WDA3WG
     I              BZSJNB                          WDSJNB
     I              BZLLCD                          WDLLCD
     I              BZLMCD                          WDLMCD
     I              BZP3ST                          WDP3ST
     I              BZSKNB                          WDSKNB
     I              BZSLNB                          WDSLNB
     I              BZSMNB                          WDSMNB
     I              BZP4ST                          WDP4ST
     I              BZCFNB                          WDCFNB
     I              BZCGNB                          WDCGNB
     I              BZILNB                          WDILNB
     I              BZCHNB                          WDCHNB
     I              BZCINB                          WDCINB
     I              BZCJNB                          WDCJNB
     I              BZCMNB                          WDCMNB
     I              BZCNNB                          WDCNNB
     I              BZCRNB                          WDCRNB
     I              BZCSNB                          WDCSNB
     I              BZCVNB                          WDCVNB
     I              BZCWNB                          WDCWNB
     I              BZCXNB                          WDCXNB
     I              BZCZNB                          WDCZNB
     I              BZC0NB                          WDC0NB
     I              BZN1CD                          WDN1CD
     I              BZB4NB                          WDB4NB
     I              BZB5NB                          WDB5NB
     I              BZX5ST                          WDX5ST
     I              BZX6ST                          WDX6ST
     I              BZX7ST                          WDX7ST
     I              BZPCCT                          WDPCCT
     I              BZBDNB                          WDBDNB
     I              BZBJNB                          WDBJNB
     I              BZSUST                          WDSUST
     I              BZSVST                          WDSVST
     I              BZSYST                          WDSYST
     I              BZSZST                          WDSZST
     I              BZS1ST                          WDS1ST
     I              BZXRCD                          WDXRCD
     I              BZXTCD                          WDXTCD
     I              BZXUCD                          WDXUCD
     I              BZF5WG                          WDF5WG
     I              BZF6WG                          WDF6WG
     I              BZF7WG                          WDF7WG
     I              BZBLNB                          WDBLNB
     I              BZBNNB                          WDBNNB
     I              BZS2ST                          WDS2ST
     I              BZS4ST                          WDS4ST
     I              BZS5ST                          WDS5ST
     I              BZS6ST                          WDS6ST
     I              BZS8ST                          WDS8ST
     I              BZS9ST                          WDS9ST
     I              BZTCST                          WDTCST
     I              BZTDST                          WDTDST
     I              BZUVST                          WDUVST
     I              BZUWST                          WDUWST
     I              BZUXST                          WDUXST
     I              BZVSST                          WDVSST
     I              BZAATM                          WDAATM
     I              BZAYNA                          WDAYNA
     I              BZA0NA                          WDA0NA
     I              BZAXDT                          WDAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WEAIC3
     I              B0HGCD                          WEHGCD
     I              B0AJCD                          WEAJCD
     I              B0AGCS                          WEAGCS
     I              B0AECS                          WEAECS
     I              B0BACS                          WEBACS
     I              B0BBCS                          WEBBCS
     I              B0CBPR                          WECBPR
     I              B0GUDT                          WEGUDT
     I              B0XYST                          WEXYST
     I              B0CTPR                          WECTPR
     I              B0G4DT                          WEG4DT
     I              B0BOWG                          WEBOWG
     I              B0DDQT                          WEDDQT
     I              B0DEQT                          WEDEQT
     I              B0DFQT                          WEDFQT
     I              B0HDQT                          WEHDQT
     I              B0HEQT                          WEHEQT
     I              B0AJQT                          WEAJQT
     I              B0AQQT                          WEAQQT
     I              B0AUQT                          WEAUQT
     I              B0EMQT                          WEEMQT
     I              B0DOQT                          WEDOQT
     I              B0ATNA                          WEATNA
     I              B0AKDT                          WEAKDT
     I              B0ANDT                          WEANDT
     I              B0IDVA                          WEIDVA
     I              B0JVST                          WEJVST
     I              B0BZPC                          WEBZPC
     I              B0DGQT                          WEDGQT
     I              B0DIDT                          WEDIDT
     I              B0ALCD                          WEALCD
     I              B0BFDY                          WEBFDY
     I              B0DJDT                          WEDJDT
     I              B0BGDY                          WEBGDY
     I              B0DKDT                          WEDKDT
     I              B0J2ST                          WEJ2ST
     I              B0DJQT                          WEDJQT
     I              B0BNWG                          WEBNWG
     I              B0DLDT                          WEDLDT
     I              B0DPQT                          WEDPQT
     I              B0DQQT                          WEDQQT
     I              B0DMDT                          WEDMDT
     I              B0M0ST                          WEM0ST
     I              B0J9ST                          WEJ9ST
     I              B0KBST                          WEKBST
     I              B0AKC8                          WEAKC8
     I              B0RINB                          WERINB
     I              B0RHNB                          WERHNB
     I              B0RGNB                          WERGNB
     I              B0UVST                          WEUVST
     I              B0UWST                          WEUWST
     I              B0UXST                          WEUXST
     I              B0VSST                          WEVSST
     I              B0AATM                          WEAATM
     I              B0AYNA                          WEAYNA
     I              B0A0NA                          WEA0NA
     I              B0AXDT                          WEAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@FNCPAZ
      * Manifest Detail           Co/Ord/Seq/Seq2/Srl#/LDt
      * Renamed input format fields
     I              FNAIC3                          WHAIC3
     I              FNC4NB                          WHC4NB
     I              FNDPNB                          WHDPNB
     I              FNUENB                          WHUENB
     I              FNRZNB                          WHRZNB
     I              FNFOQT                          WHFOQT
     I              FNR0NB                          WHR0NB
     I              FNPMST                          WHPMST
     I              FNK7DT                          WHK7DT
     I              FNPFNX                          WHPFNX
     I              FNHGCD                          WHHGCD
     I              FNAJCD                          WHAJCD
     I              FNELDT                          WHELDT
     I              FNN5WG                          WHN5WG
     I              FNRZNA                          WHRZNA
     I              FNH5NY                          WHH5NY
     I              FNH6NY                          WHH6NY
     I              FNH7NY                          WHH7NY
     I              FNGBTX                          WHGBTX
     I              FNN6WG                          WHN6WG
     I              FNN7WG                          WHN7WG
     I              FNGCTX                          WHGCTX
     I              FNGDTX                          WHGDTX
     I              FNRBDT                          WHRBDT
     I              FNITNY                          WHITNY
     I              FNIVNY                          WHIVNY
     I              FNIUNY                          WHIUNY
     I              FNIWNY                          WHIWNY
     I              FNIXNY                          WHIXNY
     I              FNIYNY                          WHIYNY
     I              FNUVST                          WHUVST
     I              FNUWST                          WHUWST
     I              FNUXST                          WHUXST
     I              FNVSST                          WHVSST
     I              FNAATM                          WHAATM
     I              FNAYNA                          WHAYNA
     I              FNA0NA                          WHA0NA
     I              FNAXDT                          WHAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WIAIC3
     I              KMV8CD                          WIV8CD
     I              KMAUNA                          WIAUNA
     I              KMI5ST                          WII5ST
     I              KMBXTX                          WIBXTX
     I              KMM8NB                          WIM8NB
     I              KMUVST                          WIUVST
     I              KMUWST                          WIUWST
     I              KMUXST                          WIUXST
     I              KMVSST                          WIVSST
     I              KMAATM                          WIAATM
     I              KMAYNA                          WIAYNA
     I              KMA0NA                          WIA0NA
     I              KMAXDT                          WIAXDT
      *
     I@B2CPT3
      * Product Trace             Co/Srl#/LDte
      * Renamed input format fields
     I              B2AIC3                          WJAIC3
     I              B2PFNX                          WJPFNX
     I              B2AADX                          WJAADX
     I              B2B9TM                          WJB9TM
     I              B2ADDX                          WJADDX
     I              B2ABDX                          WJABDX
     I              B2CATM                          WJCATM
     I              B2MNSX                          WJMNSX
     I              B2JOWG                          WJJOWG
     I              B2JPWG                          WJJPWG
     I              B2MOSX                          WJMOSX
     I              B2DNAA                          WJDNAA
     I              B2PGNX                          WJPGNX
     I              B2BTT1                          WJBTT1
     I              B2D7C7                          WJD7C7
     I              B2PYNA                          WJPYNA
     I              B2PZNA                          WJPZNA
     I              B2MPSX                          WJMPSX
     I              B2CCT1                          WJCCT1
     I              B2PHNX                          WJPHNX
     I              B2MQSX                          WJMQSX
     I              B2DOAA                          WJDOAA
     I              B2BUT1                          WJBUT1
     I              B2DYAA                          WJDYAA
     I              B2BVT1                          WJBVT1
     I              B2DPAA                          WJDPAA
     I              B2DQAA                          WJDQAA
     I              B2BZT1                          WJBZT1
     I              B2BWT1                          WJBWT1
     I              B2DRAA                          WJDRAA
     I              B2B9T1                          WJB9T1
     I              B2DSAA                          WJDSAA
     I              B2B8T1                          WJB8T1
     I              B2D4AA                          WJD4AA
     I              B2EPAA                          WJEPAA
     I              B2EQAA                          WJEQAA
     I              B2ERAA                          WJERAA
     I              B2ESAA                          WJESAA
     I              B2PNSX                          WJPNSX
     I              B2UFNX                          WJUFNX
     I              B2UGNX                          WJUGNX
     I              B2UHNX                          WJUHNX
     I              B2AGDX                          WJAGDX
     I              B2CGTM                          WJCGTM
     I              B2POSX                          WJPOSX
     I              B2PPSX                          WJPPSX
     I              B2UINX                          WJUINX
     I              B2UJNX                          WJUJNX
     I              B2UKNX                          WJUKNX
     I              B2ULNX                          WJULNX
     I              B2PRSX                          WJPRSX
     I              B2PSSX                          WJPSSX
     I              B2AATM                          WJAATM
     I              B2AYNA                          WJAYNA
     I              B2A0NA                          WJA0NA
     I              B2AXDT                          WJAXDT
      *
     I@BGCPF0
      * PFS Inventory Adjustment  Co/Item/Serial/TrTyp,sel
      * Renamed input format fields
     I              BGY1NX                          WKY1NX
     I              BGC0NY                          WKC0NY
     I              BGAID8                          WKAID8
     I              BGAFTS                          WKAFTS
     I              BGBCNY                          WKBCNY
     I              BGVLSX                          WKVLSX
     I              BGVMSX                          WKVMSX
     I              BGY2NX                          WKY2NX
     I              BGU4SX                          WKU4SX
     I              BGADNY                          WKADNY
     I              BGU1SX                          WKU1SX
     I              BGP7DT                          WKP7DT
     I              BGZ4NX                          WKZ4NX
     I              BGACNY                          WKACNY
     I              BGVKSX                          WKVKSX
     I              BGZ2NX                          WKZ2NX
     I              BGZ6NX                          WKZ6NX
     I              BGBDNY                          WKBDNY
     I              BGABNY                          WKABNY
     I              BGBENY                          WKBENY
     I              BGZ9NX                          WKZ9NX
     I              BGGBAA                          WKGBAA
     I              BGANNY                          WKANNY
     I              BGZPNX                          WKZPNX
     I              BGZXNX                          WKZXNX
     I              BGZYNX                          WKZYNX
     I              BGALNY                          WKALNY
     I              BGAGNY                          WKAGNY
     I              BGUWSX                          WKUWSX
     I              BGUXSX                          WKUXSX
     I              BGV3SX                          WKV3SX
     I              BGAHNY                          WKAHNY
     I              BGAINY                          WKAINY
     I              BGAJNY                          WKAJNY
     I              BGAKNY                          WKAKNY
      *
     I@AARETD
      * Product Trace Line Scale  Co/ScaleID/Dte(d)
      * Renamed input format fields
     I              AAAIC3                          WLAIC3
     I              AAFAAA                          WLFAAA
     I              AAPUDT                          WLPUDT
     I              AAUXNX                          WLUXNX
     I              AAUVST                          WLUVST
     I              AAUWST                          WLUWST
     I              AAUXST                          WLUXST
     I              AAVSST                          WLVSST
     I              AAAATM                          WLAATM
     I              AAAYNA                          WLAYNA
     I              AAA0NA                          WLA0NA
     I              AAAXDT                          WLAXDT
      *
     I@ABRETA
      * Product Trace Line        Retrieval index
      * Renamed input format fields
     I              ABAIC3                          WMAIC3
     I              ABFAAA                          WMFAAA
     I              ABQQNA                          WMQQNA
     I              ABPINX                          WMPINX
     I              ABMUSX                          WMMUSX
     I              ABM9SX                          WMM9SX
     I              ABUVST                          WMUVST
     I              ABUWST                          WMUWST
     I              ABUXST                          WMUXST
     I              ABVSST                          WMVSST
     I              ABAATM                          WMAATM
     I              ABAYNA                          WMAYNA
     I              ABA0NA                          WMA0NA
     I              ABAXDT                          WMAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WOAIC3
     I              BZHGCD                          WOHGCD
     I              BZAVNA                          WOAVNA
     I              BZAWNA                          WOAWNA
     I              BZL7NA                          WOL7NA
     I              BZL8NA                          WOL8NA
     I              BZL6NA                          WOL6NA
     I              BZMFNA                          WOMFNA
     I              BZADCD                          WOADCD
     I              BZAWPC                          WOAWPC
     I              BZLXST                          WOLXST
     I              BZAECD                          WOAECD
     I              BZAXPC                          WOAXPC
     I              BZLYST                          WOLYST
     I              BZAFCD                          WOAFCD
     I              BZAICD                          WOAICD
     I              BZAIWG                          WOAIWG
     I              BZHICD                          WOHICD
     I              BZRBCD                          WORBCD
     I              BZFZST                          WOFZST
     I              BZAVST                          WOAVST
     I              BZCZWG                          WOCZWG
     I              BZC0WG                          WOC0WG
     I              BZURTN                          WOURTN
     I              BZAJC8                          WOAJC8
     I              BZRINB                          WORINB
     I              BZRHNB                          WORHNB
     I              BZRGNB                          WORGNB
     I              BZLNCD                          WOLNCD
     I              BZTFNB                          WOTFNB
     I              BZN0CD                          WON0CD
     I              BZX4ST                          WOX4ST
     I              BZTMVA                          WOTMVA
     I              BZTNVA                          WOTNVA
     I              BZBLPR                          WOBLPR
     I              BZBMPR                          WOBMPR
     I              BZLRCD                          WOLRCD
     I              BZU9ST                          WOU9ST
     I              BZCMCO                          WOCMCO
     I              BZQ1CD                          WOQ1CD
     I              BZQ8CD                          WOQ8CD
     I              BZCHTM                          WOCHTM
     I              BZQZCD                          WOQZCD
     I              BZXWST                          WOXWST
     I              BZXXST                          WOXXST
     I              BZVMST                          WOVMST
     I              BZSWGH                          WOSWGH
     I              BZPPHE                          WOPPHE
     I              BZR3CD                          WOR3CD
     I              BZSDCD                          WOSDCD
     I              BZICN1                          WOICN1
     I              BZSVCD                          WOSVCD
     I              BZICN2                          WOICN2
     I              BZSWCD                          WOSWCD
     I              BZV2NB                          WOV2NB
     I              BZSXCD                          WOSXCD
     I              BZITCN                          WOITCN
     I              BZSYCD                          WOSYCD
     I              BZITC5                          WOITC5
     I              BZSZCD                          WOSZCD
     I              BZICN6                          WOICN6
     I              BZS0CD                          WOS0CD
     I              BZICN7                          WOICN7
     I              BZS1CD                          WOS1CD
     I              BZICN8                          WOICN8
     I              BZS2CD                          WOS2CD
     I              BZICN9                          WOICN9
     I              BZS3CD                          WOS3CD
     I              BZICN0                          WOICN0
     I              BZS4CD                          WOS4CD
     I              BZSFNB                          WOSFNB
     I              BZA3WG                          WOA3WG
     I              BZSJNB                          WOSJNB
     I              BZLLCD                          WOLLCD
     I              BZLMCD                          WOLMCD
     I              BZP3ST                          WOP3ST
     I              BZSKNB                          WOSKNB
     I              BZSLNB                          WOSLNB
     I              BZSMNB                          WOSMNB
     I              BZP4ST                          WOP4ST
     I              BZCFNB                          WOCFNB
     I              BZCGNB                          WOCGNB
     I              BZILNB                          WOILNB
     I              BZCHNB                          WOCHNB
     I              BZCINB                          WOCINB
     I              BZCJNB                          WOCJNB
     I              BZCMNB                          WOCMNB
     I              BZCNNB                          WOCNNB
     I              BZCRNB                          WOCRNB
     I              BZCSNB                          WOCSNB
     I              BZCVNB                          WOCVNB
     I              BZCWNB                          WOCWNB
     I              BZCXNB                          WOCXNB
     I              BZCZNB                          WOCZNB
     I              BZC0NB                          WOC0NB
     I              BZN1CD                          WON1CD
     I              BZB4NB                          WOB4NB
     I              BZB5NB                          WOB5NB
     I              BZX5ST                          WOX5ST
     I              BZX6ST                          WOX6ST
     I              BZX7ST                          WOX7ST
     I              BZPCCT                          WOPCCT
     I              BZBDNB                          WOBDNB
     I              BZBJNB                          WOBJNB
     I              BZSUST                          WOSUST
     I              BZSVST                          WOSVST
     I              BZSYST                          WOSYST
     I              BZSZST                          WOSZST
     I              BZS1ST                          WOS1ST
     I              BZXRCD                          WOXRCD
     I              BZXTCD                          WOXTCD
     I              BZXUCD                          WOXUCD
     I              BZF5WG                          WOF5WG
     I              BZF6WG                          WOF6WG
     I              BZF7WG                          WOF7WG
     I              BZBLNB                          WOBLNB
     I              BZBNNB                          WOBNNB
     I              BZS2ST                          WOS2ST
     I              BZS4ST                          WOS4ST
     I              BZS5ST                          WOS5ST
     I              BZS6ST                          WOS6ST
     I              BZS8ST                          WOS8ST
     I              BZS9ST                          WOS9ST
     I              BZTCST                          WOTCST
     I              BZTDST                          WOTDST
     I              BZUVST                          WOUVST
     I              BZUWST                          WOUWST
     I              BZUXST                          WOUXST
     I              BZVSST                          WOVSST
     I              BZAATM                          WOAATM
     I              BZAYNA                          WOAYNA
     I              BZA0NA                          WOA0NA
     I              BZAXDT                          WOAXDT
      *
     I@B2CPMP
      * Product Trace             Update index
      * Renamed input format fields
     I              B2AIC3                          WRAIC3
     I              B2PFNX                          WRPFNX
     I              B2AADX                          WRAADX
     I              B2B9TM                          WRB9TM
     I              B2ADDX                          WRADDX
     I              B2ABDX                          WRABDX
     I              B2CATM                          WRCATM
     I              B2MNSX                          WRMNSX
     I              B2JOWG                          WRJOWG
     I              B2JPWG                          WRJPWG
     I              B2MOSX                          WRMOSX
     I              B2DNAA                          WRDNAA
     I              B2PGNX                          WRPGNX
     I              B2BTT1                          WRBTT1
     I              B2D7C7                          WRD7C7
     I              B2PYNA                          WRPYNA
     I              B2PZNA                          WRPZNA
     I              B2MPSX                          WRMPSX
     I              B2CCT1                          WRCCT1
     I              B2PHNX                          WRPHNX
     I              B2MQSX                          WRMQSX
     I              B2DOAA                          WRDOAA
     I              B2BUT1                          WRBUT1
     I              B2DYAA                          WRDYAA
     I              B2BVT1                          WRBVT1
     I              B2DPAA                          WRDPAA
     I              B2DQAA                          WRDQAA
     I              B2BZT1                          WRBZT1
     I              B2BWT1                          WRBWT1
     I              B2DRAA                          WRDRAA
     I              B2B9T1                          WRB9T1
     I              B2DSAA                          WRDSAA
     I              B2B8T1                          WRB8T1
     I              B2D4AA                          WRD4AA
     I              B2EPAA                          WREPAA
     I              B2EQAA                          WREQAA
     I              B2ERAA                          WRERAA
     I              B2ESAA                          WRESAA
     I              B2PNSX                          WRPNSX
     I              B2UFNX                          WRUFNX
     I              B2UGNX                          WRUGNX
     I              B2UHNX                          WRUHNX
     I              B2AGDX                          WRAGDX
     I              B2CGTM                          WRCGTM
     I              B2POSX                          WRPOSX
     I              B2PPSX                          WRPPSX
     I              B2UINX                          WRUINX
     I              B2UJNX                          WRUJNX
     I              B2UKNX                          WRUKNX
     I              B2ULNX                          WRULNX
     I              B2PRSX                          WRPRSX
     I              B2PSSX                          WRPSSX
     I              B2AATM                          WRAATM
     I              B2AYNA                          WRAYNA
     I              B2A0NA                          WRA0NA
     I              B2AXDT                          WRAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WSAIC3
     I              L5HGCD                          WSHGCD
     I              L5AJCD                          WSAJCD
     I              L5ELDT                          WSELDT
     I              L5LXNM                          WSLXNM
     I              L5YMCD                          WSYMCD
     I              L5YNCD                          WSYNCD
     I              L5J2QT                          WSJ2QT
     I              L5G5WG                          WSG5WG
     I              L5J3QT                          WSJ3QT
     I              L5G6WG                          WSG6WG
     I              L5J4QT                          WSJ4QT
     I              L5G7WG                          WSG7WG
     I              L5LODT                          WSLODT
     I              L5LPDT                          WSLPDT
     I              L5LQDT                          WSLQDT
     I              L5NBR                           WSNBR
     I              L5YTCD                          WSYTCD
     I              L5AMSX                          WSAMSX
     I              L5ASSX                          WSASSX
     I              L5ATSX                          WSATSX
     I              L5AUSX                          WSAUSX
     I              L5YSCD                          WSYSCD
     I              L5UVST                          WSUVST
     I              L5UWST                          WSUWST
     I              L5UXST                          WSUXST
     I              L5VSST                          WSVSST
     I              L5AATM                          WSAATM
     I              L5AYNA                          WSAYNA
     I              L5A0NA                          WSA0NA
     I              L5AXDT                          WSAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WTAJCD
     I              L2YMCD                          WTYMCD
     I              L2YPCD                          WTYPCD
     I              L2LCBY                          WTLCBY
     I              L2LCCT                          WTLCCT
     I              L2WLUS                          WTWLUS
     I              L2WUSD                          WTWUSD
     I              L2WLUN                          WTWLUN
     I              L2AGSX                          WTAGSX
     I              L2UVST                          WTUVST
     I              L2UWST                          WTUWST
     I              L2UXST                          WTUXST
     I              L2VSST                          WTVSST
     I              L2AATM                          WTAATM
     I              L2AYNA                          WTAYNA
     I              L2A0NA                          WTA0NA
     I              L2AXDT                          WTAXDT
      *
     I@L3RET8
      * Warehouse Location Type   Retrieval index
      * Renamed input format fields
     I              MEAGSX                          WVAGSX
     I              MEOPNA                          WVOPNA
     I              MESLTY                          WVSLTY
     I              MEAHSX                          WVAHSX
     I              MEAISX                          WVAISX
     I              MEUVST                          WVUVST
     I              MEUWST                          WVUWST
     I              MEUXST                          WVUXST
     I              MEVSST                          WVVSST
     I              MEAATM                          WVAATM
     I              MEAYNA                          WVAYNA
     I              MEA0NA                          WVA0NA
     I              MEAXDT                          WVAXDT
      *
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          WWAIC3
     I              L5HGCD                          WWHGCD
     I              L5AJCD                          WWAJCD
     I              L5ELDT                          WWELDT
     I              L5LXNM                          WWLXNM
     I              L5YMCD                          WWYMCD
     I              L5YNCD                          WWYNCD
     I              L5J2QT                          WWJ2QT
     I              L5G5WG                          WWG5WG
     I              L5J3QT                          WWJ3QT
     I              L5G6WG                          WWG6WG
     I              L5J4QT                          WWJ4QT
     I              L5G7WG                          WWG7WG
     I              L5LODT                          WWLODT
     I              L5LPDT                          WWLPDT
     I              L5LQDT                          WWLQDT
     I              L5NBR                           WWNBR
     I              L5YTCD                          WWYTCD
     I              L5AMSX                          WWAMSX
     I              L5ASSX                          WWASSX
     I              L5ATSX                          WWATSX
     I              L5AUSX                          WWAUSX
     I              L5YSCD                          WWYSCD
     I              L5UVST                          WWUVST
     I              L5UWST                          WWUWST
     I              L5UXST                          WWUXST
     I              L5VSST                          WWVSST
     I              L5AATM                          WWAATM
     I              L5AYNA                          WWAYNA
     I              L5A0NA                          WWA0NA
     I              L5AXDT                          WWAXDT
      *
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          WXAIC3
     I              L7HGCD                          WXHGCD
     I              L7AJCD                          WXAJCD
     I              L7LTRT                          WXLTRT
     I              L7LRDT                          WXLRDT
     I              L7LLTS                          WXLLTS
     I              L7LSDT                          WXLSDT
     I              L7J5QT                          WXJ5QT
     I              L7G8WG                          WXG8WG
     I              L7LLTN                          WXLLTN
     I              L7YMCD                          WXYMCD
     I              L7LLCL                          WXLLCL
     I              L7BNAA                          WXBNAA
     I              L7LLTR                          WXLLTR
     I              L7Y2CD                          WXY2CD
     I              L7LLTL                          WXLLTL
     I              L7C4NB                          WXC4NB
     I              L7LOST                          WXLOST
     I              L7LLTU                          WXLLTU
     I              L7LLYT                          WXLLYT
     I              L7UVST                          WXUVST
     I              L7UWST                          WXUWST
     I              L7UXST                          WXUXST
     I              L7VSST                          WXVSST
     I              L7AATM                          WXAATM
     I              L7AYNA                          WXAYNA
     I              L7A0NA                          WXA0NA
     I              L7AXDT                          WXAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WYAIC3
     I              L7HGCD                          WYHGCD
     I              L7AJCD                          WYAJCD
     I              L7LTRT                          WYLTRT
     I              L7LRDT                          WYLRDT
     I              L7LLTS                          WYLLTS
     I              L7LSDT                          WYLSDT
     I              L7J5QT                          WYJ5QT
     I              L7G8WG                          WYG8WG
     I              L7LLTN                          WYLLTN
     I              L7YMCD                          WYYMCD
     I              L7LLCL                          WYLLCL
     I              L7BNAA                          WYBNAA
     I              L7LLTR                          WYLLTR
     I              L7Y2CD                          WYY2CD
     I              L7LLTL                          WYLLTL
     I              L7C4NB                          WYC4NB
     I              L7LOST                          WYLOST
     I              L7LLTU                          WYLLTU
     I              L7LLYT                          WYLLYT
     I              L7UVST                          WYUVST
     I              L7UWST                          WYUWST
     I              L7UXST                          WYUXST
     I              L7VSST                          WYVSST
     I              L7AATM                          WYAATM
     I              L7AYNA                          WYAYNA
     I              L7A0NA                          WYA0NA
     I              L7AXDT                          WYAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          TAAIC3
     I              B1HGCD                          TAHGCD
     I              B1AJCD                          TAAJCD
     I              B1ELDT                          TAELDT
     I              B1ABWG                          TAABWG
     I              B1AGQT                          TAAGQT
     I              B1AHQT                          TAAHQT
     I              B1AIQT                          TAAIQT
     I              B1CTST                          TACTST
     I              B1ACWG                          TAACWG
     I              B1ARQT                          TAARQT
     I              B1ASQT                          TAASQT
     I              B1ATQT                          TAATQT
     I              B1HDQT                          TAHDQT
     I              B1HEQT                          TAHEQT
     I              B1F6ST                          TAF6ST
     I              B1BMWG                          TABMWG
     I              B1DSQT                          TADSQT
     I              B1DTQT                          TADTQT
     I              B1DUQT                          TADUQT
     I              B1DHDT                          TADHDT
     I              B1AGCS                          TAAGCS
     I              B1AECS                          TAAECS
     I              B1IDVA                          TAIDVA
     I              B1K7DT                          TAK7DT
     I              B1RINB                          TARINB
     I              B1RHNB                          TARHNB
     I              B1RGNB                          TARGNB
     I              B1UVST                          TAUVST
     I              B1UWST                          TAUWST
     I              B1UXST                          TAUXST
     I              B1VSST                          TAVSST
     I              B1AATM                          TAAATM
     I              B1AYNA                          TAAYNA
     I              B1A0NA                          TAA0NA
     I              B1AXDT                          TAAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          TBAIC3
     I              B1HGCD                          TBHGCD
     I              B1AJCD                          TBAJCD
     I              B1ELDT                          TBELDT
     I              B1ABWG                          TBABWG
     I              B1AGQT                          TBAGQT
     I              B1AHQT                          TBAHQT
     I              B1AIQT                          TBAIQT
     I              B1CTST                          TBCTST
     I              B1ACWG                          TBACWG
     I              B1ARQT                          TBARQT
     I              B1ASQT                          TBASQT
     I              B1ATQT                          TBATQT
     I              B1HDQT                          TBHDQT
     I              B1HEQT                          TBHEQT
     I              B1F6ST                          TBF6ST
     I              B1BMWG                          TBBMWG
     I              B1DSQT                          TBDSQT
     I              B1DTQT                          TBDTQT
     I              B1DUQT                          TBDUQT
     I              B1DHDT                          TBDHDT
     I              B1AGCS                          TBAGCS
     I              B1AECS                          TBAECS
     I              B1IDVA                          TBIDVA
     I              B1K7DT                          TBK7DT
     I              B1RINB                          TBRINB
     I              B1RHNB                          TBRHNB
     I              B1RGNB                          TBRGNB
     I              B1UVST                          TBUVST
     I              B1UWST                          TBUWST
     I              B1UXST                          TBUXST
     I              B1VSST                          TBVSST
     I              B1AATM                          TBAATM
     I              B1AYNA                          TBAYNA
     I              B1A0NA                          TBA0NA
     I              B1AXDT                          TBAXDT
      *
     I@FNCPUW
      * Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      * Renamed input format fields
     I              FNAIC3                          TCAIC3
     I              FNC4NB                          TCC4NB
     I              FNDPNB                          TCDPNB
     I              FNUENB                          TCUENB
     I              FNRZNB                          TCRZNB
     I              FNFOQT                          TCFOQT
     I              FNR0NB                          TCR0NB
     I              FNPMST                          TCPMST
     I              FNK7DT                          TCK7DT
     I              FNPFNX                          TCPFNX
     I              FNHGCD                          TCHGCD
     I              FNAJCD                          TCAJCD
     I              FNELDT                          TCELDT
     I              FNN5WG                          TCN5WG
     I              FNRZNA                          TCRZNA
     I              FNH5NY                          TCH5NY
     I              FNH6NY                          TCH6NY
     I              FNH7NY                          TCH7NY
     I              FNGBTX                          TCGBTX
     I              FNN6WG                          TCN6WG
     I              FNN7WG                          TCN7WG
     I              FNGCTX                          TCGCTX
     I              FNGDTX                          TCGDTX
     I              FNRBDT                          TCRBDT
     I              FNITNY                          TCITNY
     I              FNIVNY                          TCIVNY
     I              FNIUNY                          TCIUNY
     I              FNIWNY                          TCIWNY
     I              FNIXNY                          TCIXNY
     I              FNIYNY                          TCIYNY
     I              FNUVST                          TCUVST
     I              FNUWST                          TCUWST
     I              FNUXST                          TCUXST
     I              FNVSST                          TCVSST
     I              FNAATM                          TCAATM
     I              FNAYNA                          TCAYNA
     I              FNA0NA                          TCA0NA
     I              FNAXDT                          TCAXDT
      *
     I@FNCPCS
      * Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          TDAIC3
     I              FNC4NB                          TDC4NB
     I              FNDPNB                          TDDPNB
     I              FNUENB                          TDUENB
     I              FNRZNB                          TDRZNB
     I              FNFOQT                          TDFOQT
     I              FNR0NB                          TDR0NB
     I              FNPMST                          TDPMST
     I              FNK7DT                          TDK7DT
     I              FNPFNX                          TDPFNX
     I              FNHGCD                          TDHGCD
     I              FNAJCD                          TDAJCD
     I              FNELDT                          TDELDT
     I              FNN5WG                          TDN5WG
     I              FNRZNA                          TDRZNA
     I              FNH5NY                          TDH5NY
     I              FNH6NY                          TDH6NY
     I              FNH7NY                          TDH7NY
     I              FNGBTX                          TDGBTX
     I              FNN6WG                          TDN6WG
     I              FNN7WG                          TDN7WG
     I              FNGCTX                          TDGCTX
     I              FNGDTX                          TDGDTX
     I              FNRBDT                          TDRBDT
     I              FNITNY                          TDITNY
     I              FNIVNY                          TDIVNY
     I              FNIUNY                          TDIUNY
     I              FNIWNY                          TDIWNY
     I              FNIXNY                          TDIXNY
     I              FNIYNY                          TDIYNY
     I              FNUVST                          TDUVST
     I              FNUWST                          TDUWST
     I              FNUXST                          TDUXST
     I              FNVSST                          TDVSST
     I              FNAATM                          TDAATM
     I              FNAYNA                          TDAYNA
     I              FNA0NA                          TDA0NA
     I              FNAXDT                          TDAXDT
      *
     I@L8CPTD
      * Order Inv Allocation      Co/Ord/Seq/Seq2/ASeq(d)
      * Renamed input format fields
     I              L8AIC3                          TEAIC3
     I              L8C4NB                          TEC4NB
     I              L8DPNB                          TEDPNB
     I              L8UENB                          TEUENB
     I              L8ALSW                          TEALSW
     I              L8J6QT                          TEJ6QT
     I              L8G9WG                          TEG9WG
     I              L8J9QT                          TEJ9QT
     I              L8HAWG                          TEHAWG
     I              L8IOSE                          TEIOSE
     I              L8OIMN                          TEOIMN
     I              L8SOAS                          TESOAS
     I              L8ARSX                          TEARSX
     I              L8OTUS                          TEOTUS
     I              L8OTMP                          TEOTMP
     I              L8HGCD                          TEHGCD
     I              L8AJCD                          TEAJCD
     I              L8ELDT                          TEELDT
     I              L8LXNM                          TELXNM
     I              L8YMCD                          TEYMCD
     I              L8YNCD                          TEYNCD
     I              L8UVST                          TEUVST
     I              L8UWST                          TEUWST
     I              L8UXST                          TEUXST
     I              L8VSST                          TEVSST
     I              L8AATM                          TEAATM
     I              L8AYNA                          TEAYNA
     I              L8A0NA                          TEA0NA
     I              L8AXDT                          TEAXDT
      *
     I@L8CPSX
      * Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          TFAIC3
     I              L8C4NB                          TFC4NB
     I              L8DPNB                          TFDPNB
     I              L8UENB                          TFUENB
     I              L8ALSW                          TFALSW
     I              L8J6QT                          TFJ6QT
     I              L8G9WG                          TFG9WG
     I              L8J9QT                          TFJ9QT
     I              L8HAWG                          TFHAWG
     I              L8IOSE                          TFIOSE
     I              L8OIMN                          TFOIMN
     I              L8SOAS                          TFSOAS
     I              L8ARSX                          TFARSX
     I              L8OTUS                          TFOTUS
     I              L8OTMP                          TFOTMP
     I              L8HGCD                          TFHGCD
     I              L8AJCD                          TFAJCD
     I              L8ELDT                          TFELDT
     I              L8LXNM                          TFLXNM
     I              L8YMCD                          TFYMCD
     I              L8YNCD                          TFYNCD
     I              L8UVST                          TFUVST
     I              L8UWST                          TFUWST
     I              L8UXST                          TFUXST
     I              L8VSST                          TFVSST
     I              L8AATM                          TFAATM
     I              L8AYNA                          TFAYNA
     I              L8A0NA                          TFA0NA
     I              L8AXDT                          TFAXDT
      *
     I@L8CPDK
      * Order Inv Allocation      Co/Ord/Sq/Sq2/Srl#
      * Renamed input format fields
     I              L8AIC3                          TGAIC3
     I              L8C4NB                          TGC4NB
     I              L8DPNB                          TGDPNB
     I              L8UENB                          TGUENB
     I              L8ALSW                          TGALSW
     I              L8J6QT                          TGJ6QT
     I              L8G9WG                          TGG9WG
     I              L8J9QT                          TGJ9QT
     I              L8HAWG                          TGHAWG
     I              L8IOSE                          TGIOSE
     I              L8OIMN                          TGOIMN
     I              L8SOAS                          TGSOAS
     I              L8ARSX                          TGARSX
     I              L8OTUS                          TGOTUS
     I              L8OTMP                          TGOTMP
     I              L8HGCD                          TGHGCD
     I              L8AJCD                          TGAJCD
     I              L8ELDT                          TGELDT
     I              L8LXNM                          TGLXNM
     I              L8YMCD                          TGYMCD
     I              L8YNCD                          TGYNCD
     I              L8UVST                          TGUVST
     I              L8UWST                          TGUWST
     I              L8UXST                          TGUXST
     I              L8VSST                          TGVSST
     I              L8AATM                          TGAATM
     I              L8AYNA                          TGAYNA
     I              L8A0NA                          TGA0NA
     I              L8AXDT                          TGAXDT
      *
     I@BGCPZF
      * PFS Inventory Adjustment  Update index
      * Renamed input format fields
     I              BGY1NX                          THY1NX
     I              BGC0NY                          THC0NY
     I              BGAID8                          THAID8
     I              BGAFTS                          THAFTS
     I              BGBCNY                          THBCNY
     I              BGVLSX                          THVLSX
     I              BGVMSX                          THVMSX
     I              BGY2NX                          THY2NX
     I              BGU4SX                          THU4SX
     I              BGADNY                          THADNY
     I              BGU1SX                          THU1SX
     I              BGP7DT                          THP7DT
     I              BGZ4NX                          THZ4NX
     I              BGACNY                          THACNY
     I              BGVKSX                          THVKSX
     I              BGZ2NX                          THZ2NX
     I              BGZ6NX                          THZ6NX
     I              BGBDNY                          THBDNY
     I              BGABNY                          THABNY
     I              BGBENY                          THBENY
     I              BGZ9NX                          THZ9NX
     I              BGGBAA                          THGBAA
     I              BGANNY                          THANNY
     I              BGZPNX                          THZPNX
     I              BGZXNX                          THZXNX
     I              BGZYNX                          THZYNX
     I              BGALNY                          THALNY
     I              BGAGNY                          THAGNY
     I              BGUWSX                          THUWSX
     I              BGUXSX                          THUXSX
     I              BGV3SX                          THV3SX
     I              BGAHNY                          THAHNY
     I              BGAINY                          THAINY
     I              BGAJNY                          THAJNY
     I              BGAKNY                          THAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPOB21    E DSPOB2CPL0
      * UPD : Product Trace             Update index
      * Renamed input format fields
     I              B2AIC3                          WRAIC3
     I              B2PFNX                          WRPFNX
     I              B2AADX                          WRAADX
     I              B2B9TM                          WRB9TM
     I              B2ADDX                          WRADDX
     I              B2ABDX                          WRABDX
     I              B2CATM                          WRCATM
     I              B2MNSX                          WRMNSX
     I              B2JOWG                          WRJOWG
     I              B2JPWG                          WRJPWG
     I              B2MOSX                          WRMOSX
     I              B2DNAA                          WRDNAA
     I              B2PGNX                          WRPGNX
     I              B2BTT1                          WRBTT1
     I              B2D7C7                          WRD7C7
     I              B2PYNA                          WRPYNA
     I              B2PZNA                          WRPZNA
     I              B2MPSX                          WRMPSX
     I              B2CCT1                          WRCCT1
     I              B2PHNX                          WRPHNX
     I              B2MQSX                          WRMQSX
     I              B2DOAA                          WRDOAA
     I              B2BUT1                          WRBUT1
     I              B2DYAA                          WRDYAA
     I              B2BVT1                          WRBVT1
     I              B2DPAA                          WRDPAA
     I              B2DQAA                          WRDQAA
     I              B2BZT1                          WRBZT1
     I              B2BWT1                          WRBWT1
     I              B2DRAA                          WRDRAA
     I              B2B9T1                          WRB9T1
     I              B2DSAA                          WRDSAA
     I              B2B8T1                          WRB8T1
     I              B2D4AA                          WRD4AA
     I              B2EPAA                          WREPAA
     I              B2EQAA                          WREQAA
     I              B2ERAA                          WRERAA
     I              B2ESAA                          WRESAA
     I              B2PNSX                          WRPNSX
     I              B2UFNX                          WRUFNX
     I              B2UGNX                          WRUGNX
     I              B2UHNX                          WRUHNX
     I              B2AGDX                          WRAGDX
     I              B2CGTM                          WRCGTM
     I              B2POSX                          WRPOSX
     I              B2PPSX                          WRPPSX
     I              B2UINX                          WRUINX
     I              B2UJNX                          WRUJNX
     I              B2UKNX                          WRUKNX
     I              B2ULNX                          WRULNX
     I              B2PRSX                          WRPRSX
     I              B2PSSX                          WRPSSX
     I              B2AATM                          WRAATM
     I              B2AYNA                          WRAYNA
     I              B2A0NA                          WRA0NA
     I              B2AXDT                          WRAXDT
      *
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WSAIC3
     I              L5HGCD                          WSHGCD
     I              L5AJCD                          WSAJCD
     I              L5ELDT                          WSELDT
     I              L5LXNM                          WSLXNM
     I              L5YMCD                          WSYMCD
     I              L5YNCD                          WSYNCD
     I              L5J2QT                          WSJ2QT
     I              L5G5WG                          WSG5WG
     I              L5J3QT                          WSJ3QT
     I              L5G6WG                          WSG6WG
     I              L5J4QT                          WSJ4QT
     I              L5G7WG                          WSG7WG
     I              L5LODT                          WSLODT
     I              L5LPDT                          WSLPDT
     I              L5LQDT                          WSLQDT
     I              L5NBR                           WSNBR
     I              L5YTCD                          WSYTCD
     I              L5AMSX                          WSAMSX
     I              L5ASSX                          WSASSX
     I              L5ATSX                          WSATSX
     I              L5AUSX                          WSAUSX
     I              L5YSCD                          WSYSCD
     I              L5UVST                          WSUVST
     I              L5UWST                          WSUWST
     I              L5UXST                          WSUXST
     I              L5VSST                          WSVSST
     I              L5AATM                          WSAATM
     I              L5AYNA                          WSAYNA
     I              L5A0NA                          WSA0NA
     I              L5AXDT                          WSAXDT
      *
     IYARDCS      DS                            111
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WYAIC3
     I              L7HGCD                          WYHGCD
     I              L7AJCD                          WYAJCD
     I              L7LTRT                          WYLTRT
     I              L7LRDT                          WYLRDT
     I              L7LLTS                          WYLLTS
     I              L7LSDT                          WYLSDT
     I              L7J5QT                          WYJ5QT
     I              L7G8WG                          WYG8WG
     I              L7LLTN                          WYLLTN
     I              L7YMCD                          WYYMCD
     I              L7LLCL                          WYLLCL
     I              L7BNAA                          WYBNAA
     I              L7LLTR                          WYLLTR
     I              L7Y2CD                          WYY2CD
     I              L7LLTL                          WYLLTL
     I              L7C4NB                          WYC4NB
     I              L7LOST                          WYLOST
     I              L7LLTU                          WYLLTU
     I              L7LLYT                          WYLLYT
     I              L7UVST                          WYUVST
     I              L7UWST                          WYUWST
     I              L7UXST                          WYUXST
     I              L7VSST                          WYVSST
     I              L7AATM                          WYAATM
     I              L7AYNA                          WYAYNA
     I              L7A0NA                          WYA0NA
     I              L7AXDT                          WYAXDT
      *
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          TBAIC3
     I              B1HGCD                          TBHGCD
     I              B1AJCD                          TBAJCD
     I              B1ELDT                          TBELDT
     I              B1ABWG                          TBABWG
     I              B1AGQT                          TBAGQT
     I              B1AHQT                          TBAHQT
     I              B1AIQT                          TBAIQT
     I              B1CTST                          TBCTST
     I              B1ACWG                          TBACWG
     I              B1ARQT                          TBARQT
     I              B1ASQT                          TBASQT
     I              B1ATQT                          TBATQT
     I              B1HDQT                          TBHDQT
     I              B1HEQT                          TBHEQT
     I              B1F6ST                          TBF6ST
     I              B1BMWG                          TBBMWG
     I              B1DSQT                          TBDSQT
     I              B1DTQT                          TBDTQT
     I              B1DUQT                          TBDUQT
     I              B1DHDT                          TBDHDT
     I              B1AGCS                          TBAGCS
     I              B1AECS                          TBAECS
     I              B1IDVA                          TBIDVA
     I              B1K7DT                          TBK7DT
     I              B1RINB                          TBRINB
     I              B1RHNB                          TBRHNB
     I              B1RGNB                          TBRGNB
     I              B1UVST                          TBUVST
     I              B1UWST                          TBUWST
     I              B1UXST                          TBUXST
     I              B1VSST                          TBVSST
     I              B1AATM                          TBAATM
     I              B1AYNA                          TBAYNA
     I              B1A0NA                          TBA0NA
     I              B1AXDT                          TBAXDT
      *
     IYBRDCS      DS                            434
     IYCRDCS      DS                            111
     IQOMFN1    E DSOMFNCPL0
      * UPD : Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          TDAIC3
     I              FNC4NB                          TDC4NB
     I              FNDPNB                          TDDPNB
     I              FNUENB                          TDUENB
     I              FNRZNB                          TDRZNB
     I              FNFOQT                          TDFOQT
     I              FNR0NB                          TDR0NB
     I              FNPMST                          TDPMST
     I              FNK7DT                          TDK7DT
     I              FNPFNX                          TDPFNX
     I              FNHGCD                          TDHGCD
     I              FNAJCD                          TDAJCD
     I              FNELDT                          TDELDT
     I              FNN5WG                          TDN5WG
     I              FNRZNA                          TDRZNA
     I              FNH5NY                          TDH5NY
     I              FNH6NY                          TDH6NY
     I              FNH7NY                          TDH7NY
     I              FNGBTX                          TDGBTX
     I              FNN6WG                          TDN6WG
     I              FNN7WG                          TDN7WG
     I              FNGCTX                          TDGCTX
     I              FNGDTX                          TDGDTX
     I              FNRBDT                          TDRBDT
     I              FNITNY                          TDITNY
     I              FNIVNY                          TDIVNY
     I              FNIUNY                          TDIUNY
     I              FNIWNY                          TDIWNY
     I              FNIXNY                          TDIXNY
     I              FNIYNY                          TDIYNY
     I              FNUVST                          TDUVST
     I              FNUWST                          TDUWST
     I              FNUXST                          TDUXST
     I              FNVSST                          TDVSST
     I              FNAATM                          TDAATM
     I              FNAYNA                          TDAYNA
     I              FNA0NA                          TDA0NA
     I              FNAXDT                          TDAXDT
      *
     IQPDL81    E DSPDL8CPL0
      * UPD : Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          TFAIC3
     I              L8C4NB                          TFC4NB
     I              L8DPNB                          TFDPNB
     I              L8UENB                          TFUENB
     I              L8ALSW                          TFALSW
     I              L8J6QT                          TFJ6QT
     I              L8G9WG                          TFG9WG
     I              L8J9QT                          TFJ9QT
     I              L8HAWG                          TFHAWG
     I              L8IOSE                          TFIOSE
     I              L8OIMN                          TFOIMN
     I              L8SOAS                          TFSOAS
     I              L8ARSX                          TFARSX
     I              L8OTUS                          TFOTUS
     I              L8OTMP                          TFOTMP
     I              L8HGCD                          TFHGCD
     I              L8AJCD                          TFAJCD
     I              L8ELDT                          TFELDT
     I              L8LXNM                          TFLXNM
     I              L8YMCD                          TFYMCD
     I              L8YNCD                          TFYNCD
     I              L8UVST                          TFUVST
     I              L8UWST                          TFUWST
     I              L8UXST                          TFUXST
     I              L8VSST                          TFVSST
     I              L8AATM                          TFAATM
     I              L8AYNA                          TFAYNA
     I              L8A0NA                          TFA0NA
     I              L8AXDT                          TFAXDT
      *
     IYDRDCS      DS                            434
     IQPPBG1    E DSPPBGCPL0
      * UPD : PFS Inventory Adjustment  Update index
      * Renamed input format fields
     I              BGY1NX                          THY1NX
     I              BGC0NY                          THC0NY
     I              BGAID8                          THAID8
     I              BGAFTS                          THAFTS
     I              BGBCNY                          THBCNY
     I              BGVLSX                          THVLSX
     I              BGVMSX                          THVMSX
     I              BGY2NX                          THY2NX
     I              BGU4SX                          THU4SX
     I              BGADNY                          THADNY
     I              BGU1SX                          THU1SX
     I              BGP7DT                          THP7DT
     I              BGZ4NX                          THZ4NX
     I              BGACNY                          THACNY
     I              BGVKSX                          THVKSX
     I              BGZ2NX                          THZ2NX
     I              BGZ6NX                          THZ6NX
     I              BGBDNY                          THBDNY
     I              BGABNY                          THABNY
     I              BGBENY                          THBENY
     I              BGZ9NX                          THZ9NX
     I              BGGBAA                          THGBAA
     I              BGANNY                          THANNY
     I              BGZPNX                          THZPNX
     I              BGZXNX                          THZXNX
     I              BGZYNX                          THZYNX
     I              BGALNY                          THALNY
     I              BGAGNY                          THAGNY
     I              BGUWSX                          THUWSX
     I              BGUXSX                          THUXSX
     I              BGV3SX                          THV3SX
     I              BGAHNY                          THAHNY
     I              BGAINY                          THAINY
     I              BGAJNY                          THAJNY
     I              BGAKNY                          THAKNY
      *
     IYERDCS      DS                            204
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  PFS Inv Adj Prc Ship USR
     I                                        1   1 P1XASX
     IP2PARM      DS
      * I :  PFS Order Number
     I                                        1   70P2ZPNX
     IP3PARM      DS
      * I :  PFS Company Number
     I                                        1   30P3Y1NX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PFS Dup Case Manifested'
      * Order Number
     I                                        1   7 ZA0001
      * PT Serial Number
     I                                    P   8  120ZA0002
      * Message data for 'PFS Dup Case Manifested'
      * Order Number
     I                                        1   7 ZA0003
      * PT Serial Number
     I                                    P   8  120ZA0004
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1XASX    PARM           WP0001  1        PFS Inv Adj Prc
     C           P2ZPNX    PARM           WP0002  70       PFS Order Numbe
     C           P3Y1NX    PARM           WP0003  30       PFS Company Num
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Inventory Adj ORD XF
      * PFS Inventory Adj ORD RT - PFS Inventory Adjustment  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PFS Inventory Adj ORD RT - PFS Inventory Adjustment  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Production Date
     C                     Z-ADD*ZERO     WN0002  30       Company Number
     C                     MOVEL*BLANK    WN0003  3        Item Type Code
     C                     Z-ADD*ZERO     WN0004  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0005  3        Default Warehou
     C                     MOVEL*BLANK    WN0006  3        MTO Code
     C                     MOVEL*BLANK    WN0007  3        Item Category C
     C                     MOVEL*BLANK    WN0008  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0009  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0010  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0011 114       Unit Cost Per P
     C                     MOVEL*BLANK    WN0012  3        Warehouse Code
     C                     MOVEL*BLANK    WN0013 30        Description
     C                     MOVEL*BLANK    WN0014  2        Inventory Trans
     C                     Z-ADD*ZERO     WN0015 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0016 112       Transaction Wei
     C                     Z-ADD*ZERO     WN0017  70       Transaction Dat
     C                     MOVEL*BLANK    WN0018  3        Reason Code
     C                     Z-ADD*ZERO     WN0019  70       Item Code
     C                     Z-ADD*ZERO     WN0020  70       Production Date
     C                     MOVEL*BLANK    WN0021  1        Inventory Trans
     C                     MOVEL*BLANK    WN0022  1        Shift Number
     C                     Z-ADD*ZERO     WN0023  70       Label Date
     C                     Z-ADD*ZERO     WN0024  70       Partial Item Co
     C                     MOVEL*BLANK    WN0025  2        Yld Inv Balance
     C                     Z-ADD*ZERO     WN0026  80       PT Serial Numbe
     C                     Z-ADD*ZERO     WN0027  80       PT Prod Date YY
     C                     Z-ADD*ZERO     WN0028  60       PT Production T
     C                     MOVEL*BLANK    WN0029  1        PT Inventory St
     C                     Z-ADD*ZERO     WN0030  51       PT Net Weight
     C                     Z-ADD*ZERO     WN0031  51       PT Gross Weight
     C                     Z-ADD*ZERO     WN0032  70       PT Product Code
     C                     MOVEL*BLANK    WN0033  1        PT Shift Number
     C                     MOVEL*BLANK    WN0034  3        PT Warehouse ID
     C                     Z-ADD*ZERO     WN0035  70       PT Order Number
     C                     MOVEL*BLANK    WN0036 10        PT Pallet Numbe
     C                     Z-ADD*ZERO     WN0037  80       PT Offset Prod
     C                     Z-ADD*ZERO     WN0038  60       PT Offset Prod
     C                     MOVEL*BLANK    WN0039 32        PT Item Label L
     C                     MOVEL*BLANK    WN0040 32        PT Item Label L
     C                     MOVEL*BLANK    WN0041  2        PT Fresh/Frozen
     C                     Z-ADD*ZERO     WN0042  80       PT Label Date Y
     C                     MOVEL*BLANK    WN0043  9        PT Item Picture
     C                     MOVEL*BLANK    WN0044  3        PT Item Type Co
     C                     Z-ADD*ZERO     WN0045  30       PT Item Str Cla
     C                     Z-ADD*ZERO     WN0046  30       PT Item Str Gro
     C                     Z-ADD*ZERO     WN0047  30       PT Item Str Typ
     C                     MOVEL*BLANK    WN0048  1        PT Incl in Prod
     C                     MOVEL*BLANK    WN0049  1        Lot Tracking Fl
     C                     Z-ADD*ZERO     WN0050  30       Accounting Comp
     C                     MOVEL*BLANK    WN0051  4        Location Code
     C                     MOVEL*BLANK    WN0052  1        ILL Status
     C                     MOVEL*BLANK    WN0053  3        Inv Hold Reason
     C                     Z-ADD*ZERO     WN0054  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0055 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0056  70       Order Number
     C                     MOVEL*BLANK    WN0057  1        Header Status
     C                     MOVEL*BLANK    WN0058  2        Order Type - Sa
     C                     MOVEL*BLANK    WN0059  1        Billing Activit
     C                     MOVEL*BLANK    WN0060  2        Event Code
     C                     Z-ADD*ZERO     WN0061  70       Ship To Custome
     C                     MOVEL*BLANK    WN0062  1        Trans Contol AS
     C                     Z-ADD*ZERO     WN0063  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0064  30       Order Sequence
     C                     Z-ADD*ZERO     WN0065  30       Order Secondary
     C                     MOVEL*BLANK    WN0066  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0067  2        LLT Trans Type
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAY1NX    WQSA01           PFS Company Num
     C           *LIKE     DEFN WAZPNX    WQSA02           PFS Order Numbe
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           PFS Company Num
     C                     KFLD           WQSA02           PFS Order Numbe
      * Setup key
     C                     Z-ADDP3Y1NX    WQSA01           PFS Company Num
     C                     Z-ADDP2ZPNX    WQSA02           PFS Order Numbe
      * Establish starting position
     C           KRSSA     SETLL@BGCPD8                    *
     C           KRSSA     READE@BGCPD8                  90*
      * Data record not found
     C   90                MOVEL'USR3496' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Production Date
     C                     Z-ADD*ZERO     WN0002           Company Number
     C                     MOVEL*BLANK    WN0003           Item Type Code
     C                     Z-ADD*ZERO     WN0004           Fresh Chilling
     C                     MOVEL*BLANK    WN0005           Default Warehou
     C                     MOVEL*BLANK    WN0006           MTO Code
     C                     MOVEL*BLANK    WN0007           Item Category C
     C                     MOVEL*BLANK    WN0008           Primal Group Co
     C                     Z-ADD*ZERO     WN0009           PFS Process Sta
     C                     MOVEL*BLANK    WN0010           PFS Error Reaso
     C                     Z-ADD*ZERO     WN0011           Unit Cost Per P
     C                     MOVEL*BLANK    WN0012           Warehouse Code
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL*BLANK    WN0014           Inventory Trans
     C                     Z-ADD*ZERO     WN0015           Transaction Qua
     C                     Z-ADD*ZERO     WN0016           Transaction Wei
     C                     Z-ADD*ZERO     WN0017           Transaction Dat
     C                     MOVEL*BLANK    WN0018           Reason Code
     C                     Z-ADD*ZERO     WN0019           Item Code
     C                     Z-ADD*ZERO     WN0020           Production Date
     C                     MOVEL*BLANK    WN0021           Inventory Trans
     C                     MOVEL*BLANK    WN0022           Shift Number
     C                     Z-ADD*ZERO     WN0023           Label Date
     C                     Z-ADD*ZERO     WN0024           Partial Item Co
     C                     MOVEL*BLANK    WN0025           Yld Inv Balance
     C                     Z-ADD*ZERO     WN0026           PT Serial Numbe
     C                     Z-ADD*ZERO     WN0027           PT Prod Date YY
     C                     Z-ADD*ZERO     WN0028           PT Production T
     C                     MOVEL*BLANK    WN0029           PT Inventory St
     C                     Z-ADD*ZERO     WN0030           PT Net Weight
     C                     Z-ADD*ZERO     WN0031           PT Gross Weight
     C                     Z-ADD*ZERO     WN0032           PT Product Code
     C                     MOVEL*BLANK    WN0033           PT Shift Number
     C                     MOVEL*BLANK    WN0034           PT Warehouse ID
     C                     Z-ADD*ZERO     WN0035           PT Order Number
     C                     MOVEL*BLANK    WN0036           PT Pallet Numbe
     C                     Z-ADD*ZERO     WN0037           PT Offset Prod
     C                     Z-ADD*ZERO     WN0038           PT Offset Prod
     C                     MOVEL*BLANK    WN0039           PT Item Label L
     C                     MOVEL*BLANK    WN0040           PT Item Label L
     C                     MOVEL*BLANK    WN0041           PT Fresh/Frozen
     C                     Z-ADD*ZERO     WN0042           PT Label Date Y
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL*BLANK    WN0044           PT Item Type Co
     C                     Z-ADD*ZERO     WN0045           PT Item Str Cla
     C                     Z-ADD*ZERO     WN0046           PT Item Str Gro
     C                     Z-ADD*ZERO     WN0047           PT Item Str Typ
     C                     MOVEL*BLANK    WN0048           PT Incl in Prod
     C                     MOVEL*BLANK    WN0049           Lot Tracking Fl
     C                     Z-ADD*ZERO     WN0050           Accounting Comp
     C                     MOVEL*BLANK    WN0051           Location Code
     C                     MOVEL*BLANK    WN0052           ILL Status
     C                     MOVEL*BLANK    WN0053           Inv Hold Reason
     C                     Z-ADD*ZERO     WN0054           ILL Item Qty On
     C                     Z-ADD*ZERO     WN0055           ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0056           Order Number
     C                     MOVEL*BLANK    WN0057           Header Status
     C                     MOVEL*BLANK    WN0058           Order Type - Sa
     C                     MOVEL*BLANK    WN0059           Billing Activit
     C                     MOVEL*BLANK    WN0060           Event Code
     C                     Z-ADD*ZERO     WN0061           Ship To Custome
     C                     MOVEL*BLANK    WN0062           Trans Contol AS
     C                     Z-ADD*ZERO     WN0063           Scheduled Ship
     C                     Z-ADD*ZERO     WN0064           Order Sequence
     C                     Z-ADD*ZERO     WN0065           Order Secondary
     C                     MOVEL*BLANK    WN0066           Detail Line Sta
     C                     MOVEL*BLANK    WN0067           LLT Trans Type
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     Z-ADD*ZERO     WN0009           PFS Process Sta
     C                     MOVEL*BLANK    WN0010           PFS Error Reaso
      * ***** VALIDATION *****
     C                     EXSR UASUBR                     ***** VALIDATIO
      * ***** PROCESS RECORD *****
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Initialize
     C                     EXSR UCSUBR                     Initialize
      * ***** PRODUCTION & INVENTORY TRANSACTIONS *****
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DB1.PFS Transaction Type is Production Transactions
      *   |- c2    : DB1.PFS Transaction Type is Inventory Transactions
      *   |- c3    : DB1.PFS Transaction Type is Cycle Count Inv Adjust
      *   |- c4    : DB1.PFS Transaction Type is BP: Batch Label Print
      *   |- c5    : DB1.PFS Transaction Type is WT: Warehouse Transfer
      *   '-
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P05'
     C           WAVLSX    OREQ 'I01'                      *OR
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'I03'
     C           WAVLSX    OREQ 'C02'                      *OR
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'C01'
     C           WAVLSX    OREQ 'B01'                      *OR
     C           WAVLSX    OREQ 'W01'                      *OR
      * CASE: DB1.PFS Transaction Type is PM: Production
     C           WAVLSX    IFEQ 'P01'                      *IF
      * PROCESS: Finished Goods, WIP, & Partial Production
      * CASE: Finished Goods or Work In Process
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DB1.PFS Tracking Type is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Export
      *   |- c3    : DB1.PFS Tracking Type is Casings
      *   |- c4    : DB1.PFS Tracking Type is Export 2
      *   |- c5    : DB1.PFS Tracking Type is Work In Process
      *   '-
     C           WAZ6NX    IFEQ 1                          *IF
     C           WAZ6NX    OREQ 2                          *OR
     C           WAZ6NX    OREQ 7                          *OR
     C           WAZ6NX    OREQ 8                          *OR
     C           WAZ6NX    OREQ 3                          *OR
      * CRT: Item Transaction Detail
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL'RR'      WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,02    WN0013           Description
     C                     MOVEL'PRD'     WN0018           Reason Code
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0003  30       Company Number
     C                     PARM WN0019    WQ0004  70       Item Code
     C                     PARM WN0012    WQ0005  3        Warehouse Code
     C                     PARM WN0021    WQ0006  1        Inventory Trans
     C                     PARM WN0014    WQ0007  2        Inventory Trans
     C                     PARM WN0017    WQ0008  70       Transaction Dat
     C                     PARM WN0020    WQ0009  70       Production Date
     C                     PARM WN0013    WQ0010 30        Description
     C                     PARM WN0015    WQ0011 112       Transaction Qua
     C                     PARM WN0016    WQ0012 112       Transaction Wei
     C                     PARM WN0018    WQ0013  3        Reason Code
     C                     PARM WN0022    WQ0014  1        Shift Number
     C                     PARM WN0023    WQ0015  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPD:  Product Trace
      * CASE: PAR.Item Code is Scale Check Item 2222
     C           WN0019    IFEQ 2222                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
     C                     Z-ADDWAP7DT    WN0027           PT Prod Date YY
     C                     Z-ADDWAAFTS    WN0028           PT Production T
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     MOVEL'1'       WN0029           PT Inventory St
     C                     Z-ADDWAABNY    WN0030           PT Net Weight
     C                     Z-ADDWABENY    WN0031           PT Gross Weight
     C                     MOVELWAVKSX    WN0033           PT Shift Number
     C                     MOVELWAU4SX    WN0034           PT Warehouse ID
     C                     MOVELWAAGNY    WN0036           PT Pallet Numbe
     C                     Z-ADDWN0019    WN0032           PT Product Code
      * --- Offset Production Date & Time ---
     C                     MOVELWAZ2NX    YL0010           Text 10A USR
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0010:ZQ YL0011    P  90  Scale ID
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0026           Company Number
     C                     MOVELYL0011    WL0027    P      Scale ID
     C                     Z-ADDWN0023    WL0028           Effective Label
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0012           CS Scale Offset
     C                     MOVELWL0030    WN0048    P      CS Include in P
      * RMC 3/15/06 use par.pt prod date yyyymmdd instead of lcl.pt prod
     C                     Z-ADDWN0027    WN0037           PT Offset Prod
     C                     MULT -1        YL0012           CS Scale Offset
      * PAR.PT Offset Prod Time = PAR.PT Production Time + LCL.CS Scale O
     C                     Z-ADDWN0028    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           60        MULT YL0012    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     WN0038
      * CASE: PAR.PT Offset Prod Time GT PAR.PT Production Time
     C           WN0038    IFGT WN0028                     *IF
      * PAR.PT Offset Prod Date = PAR.PT Offset Prod Date + CON.-1 *DAYS
     C           WN0037    SUB  18000000  XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0037
     C                     ELSE
     C           XDINDT    ADD  18000000  WN0037
     C                     END
     C                     END                             *FI
      * --- Item Picture Key ---
      * RTV Item Labels        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0031           Company Number
     C                     Z-ADDWN0019    WL0032           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUAVNA    P      Description Lin
     C                     MOVELWL0034    WN0039    P      Item Label Line
     C                     MOVELWL0035    WN0040    P      Item Label Line
     C                     Z-ADDWL0036    WN0045           Item Structure
     C                     Z-ADDWL0037    WN0046           Item Structure
     C                     Z-ADDWL0038    WN0047           Item Structure
     C                     MOVELWL0039    WN0044    P      Item Type Code
     C                     MOVELWL0040    WN0006    P      MTO Code
     C                     MOVELWL0041    WN0007    P      Item Category C
     C                     MOVELWL0042    WN0008    P      Primal Group Co
      * Item Picture Key
      * CASE: PAR.Item Category Code 3 is Loint
     C           WN0007    IFEQ 'L61'                      *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOINT'   WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * Item Picture Key
      * CASE: PAR.MTO Code is Entered
     C           WN0006    IFGT *BLANK                     *IF
      * PFN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is PFN
      *   |- c2    : PAR.MTO Code is IWG
      *   '-
     C           WN0006    IFEQ 'PFN'                      *IF
     C           WN0006    OREQ 'IWG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFN'     WN0043           PT Item Picture
     C                     END                             *FI
      * PFT
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is EHP
      *   |- c2    : PAR.MTO Code is KRG
      *   '-
     C           WN0006    IFEQ 'EHP'                      *IF
     C           WN0006    OREQ 'KRG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFT'     WN0043           PT Item Picture
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : PAR.Primal Group Code is BUTT
      *   |- c2    : PAR.Primal Group Code is HAM
      *   |- c3    : PAR.Primal Group Code is LOIN
      *   |- c4    : PAR.Primal Group Code is PICNIC
      *   |- c5    : PAR.Primal Group Code is RIBS
      *   '-
     C           WN0008    IFEQ 'BUTT'                     *IF
     C           WN0008    OREQ 'HAM'                      *OR
     C           WN0008    OREQ 'LOIN'                     *OR
     C           WN0008    OREQ 'PICNIC'                   *OR
     C           WN0008    OREQ 'RIBS'                     *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVELWN0008    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Primal Group Code is HAMC
     C           WN0008    IFEQ 'HAMC'                     *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'HAM'     WN0043           PT Item Picture
     C                     ELSE
      * CASE: PAR.Primal Group Code is LOINC
     C           WN0008    IFEQ 'LOINC'                    *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOIN'    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOGO'    WN0043           PT Item Picture
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0043    P      Warehouse Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WN0041    P      Warehouse Type
      * --- Create Product Trace Record ---
      * Crt Product Trace     CR - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0045           Company Number
     C                     Z-ADDWN0026    WL0046           PT Serial Numbe
     C                     Z-ADDWN0027    WL0047           PT Prod Date YY
     C                     Z-ADDWN0028    WL0048           PT Production T
     C                     Z-ADDWN0042    WL0049           PT Label Date Y
     C                     Z-ADDWN0037    WL0050           PT Offset Prod
     C                     Z-ADDWN0038    WL0051           PT Offset Prod
     C                     MOVELWN0029    WL0052    P      PT Inventory St
     C                     Z-ADDWN0030    WL0053           PT Net Weight
     C                     Z-ADDWN0031    WL0054           PT Gross Weight
     C                     MOVELWN0033    WL0055    P      PT Shift Number
     C                     MOVELWN0034    WL0056    P      PT Warehouse ID
     C                     Z-ADDWN0035    WL0057           PT Order Number
     C                     MOVELWN0036    WL0058    P      PT Pallet Numbe
     C                     Z-ADDWN0032    WL0059           PT Product Code
     C                     MOVELWN0039    WL0060    P      PT Item Label L
     C                     MOVELWN0040    WL0061    P      PT Item Label L
     C                     MOVELWN0041    WL0062    P      PT Fresh/Frozen
     C                     MOVELWN0043    WL0063    P      PT Item Picture
     C                     Z-ADD*ZERO     WL0064           PT Tattoo Numbe
     C                     MOVELWUOTTX    WL0065    P      PT Source Type
     C                     MOVEL*BLANK    WL0066           PT Source Code
     C                     MOVEL*BLANK    WL0067           PT Source Code
     C                     MOVEL*BLANK    WL0068           PT Producer/Cel
     C                     MOVEL*BLANK    WL0069           PT Producer/Cel
     C                     MOVEL*BLANK    WL0070           PT Producer/Far
     C                     MOVEL*BLANK    WL0071           PT Producer Loc
     C                     MOVEL*BLANK    WL0072           PT Producer/Far
     C                     MOVEL*BLANK    WL0073           PT Producer/Far
     C                     MOVELWUOTTX    WL0074    P      PT Producer/Far
     C                     MOVEL*BLANK    WL0075           PT Producer/Far
     C                     MOVEL*BLANK    WL0076           PT Genetic Code
     C                     MOVEL*BLANK    WL0077           PT Genetic Desc
     C                     MOVELWUOTTX    WL0078    P      PT Gender Code
     C                     MOVEL*BLANK    WL0079           PT Producer/Far
     C                     MOVEL*BLANK    WL0080           PT Producer/Far
     C                     MOVEL*BLANK    WL0081           PT Producer/Far
     C                     MOVEL*BLANK    WL0082           PT Producer/Far
     C                     MOVELWN0044    WL0083    P      PT Item Type Co
     C                     Z-ADDWN0045    WL0084           PT Item Str Cla
     C                     Z-ADDWN0046    WL0085           PT Item Str Gro
     C                     Z-ADDWN0047    WL0086           PT Item Str Typ
     C                     Z-ADD*ZERO     WL0087           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WL0088           PT WIP Dump/Pro
     C                     MOVELWUXKTX    WL0089    P      PT WIP Dump/Pro
     C                     MOVELWUOTTX    WL0090    P      PT WIP Used/Not
     C                     Z-ADD*ZERO     WL0091           PT From FG Seri
     C                     Z-ADD*ZERO     WL0092           PT To FG Serial
     C                     Z-ADD*ZERO     WL0093           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WL0094           PT Unused Nbr 4
     C                     MOVELWN0048    WL0095    P      PT Incl in Prod
     C                     MOVELWUOTTX    WL0096    P      PT Unused Sts 4
     C                     Z-ADD*ZERO     WL0097           Job Time
     C                     MOVEL*BLANK    WL0098           User Id
     C                     MOVEL*BLANK    WL0099           Job Name
     C                     Z-ADD*ZERO     WL0100           Job Date
     C                     EXSR SSCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Tracking Type is Partial
     C           WAZ6NX    IFEQ 4                          *IF
      * CRT: Yld Partial Transaction
     C                     MOVEL'PT'      WN0025           Yld Inv Balance
      * Prc Crt Partial Rcpt  XF - Yld Partial Transaction  * 
     C                     CALL 'POVAXFR'              90  Prc Crt Partial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0016  30       Company Number
     C                     PARM WN0017    WQ0017  70       Transaction Dat
     C                     PARM WN0024    WQ0018  70       Partial Item Co
     C                     PARM WN0019    WQ0019  70       Item Code
     C                     PARM WN0020    WQ0020  70       Production Date
     C                     PARM WN0022    WQ0021  1        Production Shif
     C                     PARM WN0015    WQ0022  70       Yld Transaction
     C                     PARM WN0016    WQ0023 112       Yld Transaction
     C                     PARM WN0025    WQ0024  2        Yld Inv Balance
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is PM: Return/Reject
     C           WAVLSX    IFEQ 'P03'                      *IF
      * ------ Reject Production ------
     C                     MOVEL'RJ'      WN0025           Yld Inv Balance
      * Prc Crt Partial Rcpt  XF - Yld Partial Transaction  * 
     C                     CALL 'POVAXFR'              90  Prc Crt Partial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0025  30       Company Number
     C                     PARM WN0017    WQ0026  70       Transaction Dat
     C                     PARM WN0024    WQ0027  70       Partial Item Co
     C                     PARM WN0019    WQ0028  70       Item Code
     C                     PARM WN0020    WQ0029  70       Production Date
     C                     PARM WN0022    WQ0030  1        Production Shif
     C                     PARM WN0015    WQ0031  70       Yld Transaction
     C                     PARM WN0016    WQ0032 112       Yld Transaction
     C                     PARM WN0025    WQ0033  2        Yld Inv Balance
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PM: Issue or PM: Delete or PM: Rework
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.PFS Transaction Type is PM: Issue
      *   |- c2    : DB1.PFS Transaction Type is PM: Delete
      *   |- c3    : DB1.PFS Transaction Type is PM: Rework
      *   '-
     C           WAVLSX    IFEQ 'P02'                      *IF
     C           WAVLSX    OREQ 'P04'                      *OR
     C           WAVLSX    OREQ 'P05'                      *OR
     C           WABDNY    MULT -1        WN0015           Transaction Qua
     C           WAABNY    MULT -1        WN0016           Transaction Wei
      * PROCESS: Finished Goods, WIP, Partial, & Reject Issue
      * CASE: Finished Goods or Work In Process
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DB1.PFS Tracking Type is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Export
      *   |- c3    : DB1.PFS Tracking Type is Casings
      *   |- c4    : DB1.PFS Tracking Type is Export 2
      *   |- c5    : DB1.PFS Tracking Type is Work In Process
      *   '-
     C           WAZ6NX    IFEQ 1                          *IF
     C           WAZ6NX    OREQ 2                          *OR
     C           WAZ6NX    OREQ 7                          *OR
     C           WAZ6NX    OREQ 8                          *OR
     C           WAZ6NX    OREQ 3                          *OR
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL'RR'      WN0014           Inventory Trans
      * Description & Reason
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Transaction Type is PM: Issue
      *   |- c2    : DB1.PFS Transaction Type is PM: Rework
      *   '-
     C           WAVLSX    IFEQ 'P02'                      *IF
     C           WAVLSX    OREQ 'P05'                      *OR
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,03    WN0013           Description
     C                     MOVEL'DLR'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is PM: Delete
     C           WAVLSX    IFEQ 'P04'                      *IF
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,04    WN0013           Description
     C                     MOVEL'DEL'     WN0018           Reason Code
     C                     END                             *FI
     C                     END                             *FI
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0034  30       Company Number
     C                     PARM WN0019    WQ0035  70       Item Code
     C                     PARM WN0012    WQ0036  3        Warehouse Code
     C                     PARM WN0021    WQ0037  1        Inventory Trans
     C                     PARM WN0014    WQ0038  2        Inventory Trans
     C                     PARM WN0017    WQ0039  70       Transaction Dat
     C                     PARM WN0020    WQ0040  70       Production Date
     C                     PARM WN0013    WQ0041 30        Description
     C                     PARM WN0015    WQ0042 112       Transaction Qua
     C                     PARM WN0016    WQ0043 112       Transaction Wei
     C                     PARM WN0018    WQ0044  3        Reason Code
     C                     PARM WN0022    WQ0045  1        Shift Number
     C                     PARM WN0023    WQ0046  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: DB1.PFS Tracking Type is Partial
     C           WAZ6NX    IFEQ 4                          *IF
     C                     MOVEL'PT'      WN0025           Yld Inv Balance
      * Prc Crt Partial Rcpt  XF - Yld Partial Transaction  * 
     C                     CALL 'POVAXFR'              90  Prc Crt Partial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0047  30       Company Number
     C                     PARM WN0017    WQ0048  70       Transaction Dat
     C                     PARM WN0024    WQ0049  70       Partial Item Co
     C                     PARM WN0019    WQ0050  70       Item Code
     C                     PARM WN0020    WQ0051  70       Production Date
     C                     PARM WN0022    WQ0052  1        Production Shif
     C                     PARM WN0015    WQ0053  70       Yld Transaction
     C                     PARM WN0016    WQ0054 112       Yld Transaction
     C                     PARM WN0025    WQ0055  2        Yld Inv Balance
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: DB1.PFS Tracking Type is Reject
     C           WAZ6NX    IFEQ 6                          *IF
     C                     MOVEL'RJ'      WN0025           Yld Inv Balance
      * Prc Crt Partial Rcpt  XF - Yld Partial Transaction  * 
     C                     CALL 'POVAXFR'              90  Prc Crt Partial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0056  30       Company Number
     C                     PARM WN0017    WQ0057  70       Transaction Dat
     C                     PARM WN0024    WQ0058  70       Partial Item Co
     C                     PARM WN0019    WQ0059  70       Item Code
     C                     PARM WN0020    WQ0060  70       Production Date
     C                     PARM WN0022    WQ0061  1        Production Shif
     C                     PARM WN0015    WQ0062  70       Yld Transaction
     C                     PARM WN0016    WQ0063 112       Yld Transaction
     C                     PARM WN0025    WQ0064  2        Yld Inv Balance
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: IM: Delete, IM: UnDelete, CC: Delete, CC: Add, or
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9
      *   |- c1    : DB1.PFS Transaction Type is IM: Delete
      *   |- c2    : DB1.PFS Transaction Type is IM: Undelete
      *   |- c3    : DB1.PFS Transaction Type is CC: Delete
      *   |- c4    : DB1.PFS Transaction Type is CC: Add
      *   |- c5    : DB1.PFS Transaction Type is CC: Add-ProdDate = 0
      *   |- c6    : DB1.PFS Transaction Type is BP: Batch Label Print
      *   |- c7    : DB1.PFS Transaction Type is IM: Adjust @ Shiping
      *   |- c8    : DB1.PFS Transaction Type is IM: Adjust @ Production
      *   |- c9    : DB1.PFS Transaction Type is WT: Warehouse Transfer
      *   '-
     C           WAVLSX    IFEQ 'I01'                      *IF
     C           WAVLSX    OREQ 'I02'                      *OR
     C           WAVLSX    OREQ 'C01'                      *OR
     C           WAVLSX    OREQ 'C02'                      *OR
     C           WAVLSX    OREQ 'C04'                      *OR
     C           WAVLSX    OREQ 'B01'                      *OR
     C           WAVLSX    OREQ 'I03'                      *OR
     C           WAVLSX    OREQ 'I04'                      *OR
     C           WAVLSX    OREQ 'W01'                      *OR
      * ... BP: Batch Printing, WT: Warehouse Transfer
      * Transaction Quantity & Weight
      * CASE: DB1.PFS Transaction Type is Inventory Delete
     C           WAVLSX    IFEQ 'C01'                      *IF
     C           WAVLSX    OREQ 'I01'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'W01'
     C           WABDNY    MULT -1        WN0015           Transaction Qua
     C           WAABNY    MULT -1        WN0016           Transaction Wei
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is Inventory Add
     C           WAVLSX    IFEQ 'C02'                      *IF
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'B01'
     C           WAVLSX    OREQ 'I03'
     C                     Z-ADDWABDNY    WN0015           Transaction Qua
     C                     Z-ADDWAABNY    WN0016           Transaction Wei
     C                     END                             *FI
     C                     END                             *FI
      * Update Prod Trace for Batch labels too .... RMC 5/26/06
      * CASE: DB1.PFS Transaction Type is Batch Printing
     C           WAVLSX    IFEQ 'B01'                      *IF
      * UPD:  Product Trace
      * CASE: PAR.Item Code is Scale Check Item 2222
     C           WN0019    IFEQ 2222                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
     C                     Z-ADDWAP7DT    WN0027           PT Prod Date YY
     C                     Z-ADDWAAFTS    WN0028           PT Production T
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     MOVEL'1'       WN0029           PT Inventory St
     C                     Z-ADDWAABNY    WN0030           PT Net Weight
     C                     Z-ADDWABENY    WN0031           PT Gross Weight
     C                     MOVELWAVKSX    WN0033           PT Shift Number
     C                     MOVELWAU4SX    WN0034           PT Warehouse ID
     C                     MOVELWAAGNY    WN0036           PT Pallet Numbe
     C                     Z-ADDWN0019    WN0032           PT Product Code
      * --- Offset Production Date & Time ---
     C                     MOVELWAZ2NX    YL0010           Text 10A USR
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0010:ZQ YL0011    P  90  Scale ID
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0026           Company Number
     C                     MOVELYL0011    WL0027    P      Scale ID
     C                     Z-ADDWN0023    WL0028           Effective Label
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0012           CS Scale Offset
     C                     MOVELWL0030    WN0048    P      CS Include in P
      * RMC 3/15/06 use par.pt prod date yyyymmdd instead of lcl.pt prod
     C                     Z-ADDWN0027    WN0037           PT Offset Prod
     C                     MULT -1        YL0012           CS Scale Offset
      * PAR.PT Offset Prod Time = PAR.PT Production Time + LCL.CS Scale O
     C                     Z-ADDWN0028    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           60        MULT YL0012    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     WN0038
      * CASE: PAR.PT Offset Prod Time GT PAR.PT Production Time
     C           WN0038    IFGT WN0028                     *IF
      * PAR.PT Offset Prod Date = PAR.PT Offset Prod Date + CON.-1 *DAYS
     C           WN0037    SUB  18000000  XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0037
     C                     ELSE
     C           XDINDT    ADD  18000000  WN0037
     C                     END
     C                     END                             *FI
      * --- Item Picture Key ---
      * RTV Item Labels        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0031           Company Number
     C                     Z-ADDWN0019    WL0032           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUAVNA    P      Description Lin
     C                     MOVELWL0034    WN0039    P      Item Label Line
     C                     MOVELWL0035    WN0040    P      Item Label Line
     C                     Z-ADDWL0036    WN0045           Item Structure
     C                     Z-ADDWL0037    WN0046           Item Structure
     C                     Z-ADDWL0038    WN0047           Item Structure
     C                     MOVELWL0039    WN0044    P      Item Type Code
     C                     MOVELWL0040    WN0006    P      MTO Code
     C                     MOVELWL0041    WN0007    P      Item Category C
     C                     MOVELWL0042    WN0008    P      Primal Group Co
      * Item Picture Key
      * CASE: PAR.Item Category Code 3 is Loint
     C           WN0007    IFEQ 'L61'                      *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOINT'   WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * Item Picture Key
      * CASE: PAR.MTO Code is Entered
     C           WN0006    IFGT *BLANK                     *IF
      * PFN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is PFN
      *   |- c2    : PAR.MTO Code is IWG
      *   '-
     C           WN0006    IFEQ 'PFN'                      *IF
     C           WN0006    OREQ 'IWG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFN'     WN0043           PT Item Picture
     C                     END                             *FI
      * PFT
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is EHP
      *   |- c2    : PAR.MTO Code is KRG
      *   '-
     C           WN0006    IFEQ 'EHP'                      *IF
     C           WN0006    OREQ 'KRG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFT'     WN0043           PT Item Picture
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : PAR.Primal Group Code is BUTT
      *   |- c2    : PAR.Primal Group Code is HAM
      *   |- c3    : PAR.Primal Group Code is LOIN
      *   |- c4    : PAR.Primal Group Code is PICNIC
      *   |- c5    : PAR.Primal Group Code is RIBS
      *   '-
     C           WN0008    IFEQ 'BUTT'                     *IF
     C           WN0008    OREQ 'HAM'                      *OR
     C           WN0008    OREQ 'LOIN'                     *OR
     C           WN0008    OREQ 'PICNIC'                   *OR
     C           WN0008    OREQ 'RIBS'                     *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVELWN0008    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Primal Group Code is HAMC
     C           WN0008    IFEQ 'HAMC'                     *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'HAM'     WN0043           PT Item Picture
     C                     ELSE
      * CASE: PAR.Primal Group Code is LOINC
     C           WN0008    IFEQ 'LOINC'                    *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOIN'    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOGO'    WN0043           PT Item Picture
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0043    P      Warehouse Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WN0041    P      Warehouse Type
      * --- Create Product Trace Record ---
      * Crt Product Trace     CR - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0045           Company Number
     C                     Z-ADDWN0026    WL0046           PT Serial Numbe
     C                     Z-ADDWN0027    WL0047           PT Prod Date YY
     C                     Z-ADDWN0028    WL0048           PT Production T
     C                     Z-ADDWN0042    WL0049           PT Label Date Y
     C                     Z-ADDWN0037    WL0050           PT Offset Prod
     C                     Z-ADDWN0038    WL0051           PT Offset Prod
     C                     MOVELWN0029    WL0052    P      PT Inventory St
     C                     Z-ADDWN0030    WL0053           PT Net Weight
     C                     Z-ADDWN0031    WL0054           PT Gross Weight
     C                     MOVELWN0033    WL0055    P      PT Shift Number
     C                     MOVELWN0034    WL0056    P      PT Warehouse ID
     C                     Z-ADDWN0035    WL0057           PT Order Number
     C                     MOVELWN0036    WL0058    P      PT Pallet Numbe
     C                     Z-ADDWN0032    WL0059           PT Product Code
     C                     MOVELWN0039    WL0060    P      PT Item Label L
     C                     MOVELWN0040    WL0061    P      PT Item Label L
     C                     MOVELWN0041    WL0062    P      PT Fresh/Frozen
     C                     MOVELWN0043    WL0063    P      PT Item Picture
     C                     Z-ADD*ZERO     WL0064           PT Tattoo Numbe
     C                     MOVELWUOTTX    WL0065    P      PT Source Type
     C                     MOVEL*BLANK    WL0066           PT Source Code
     C                     MOVEL*BLANK    WL0067           PT Source Code
     C                     MOVEL*BLANK    WL0068           PT Producer/Cel
     C                     MOVEL*BLANK    WL0069           PT Producer/Cel
     C                     MOVEL*BLANK    WL0070           PT Producer/Far
     C                     MOVEL*BLANK    WL0071           PT Producer Loc
     C                     MOVEL*BLANK    WL0072           PT Producer/Far
     C                     MOVEL*BLANK    WL0073           PT Producer/Far
     C                     MOVELWUOTTX    WL0074    P      PT Producer/Far
     C                     MOVEL*BLANK    WL0075           PT Producer/Far
     C                     MOVEL*BLANK    WL0076           PT Genetic Code
     C                     MOVEL*BLANK    WL0077           PT Genetic Desc
     C                     MOVELWUOTTX    WL0078    P      PT Gender Code
     C                     MOVEL*BLANK    WL0079           PT Producer/Far
     C                     MOVEL*BLANK    WL0080           PT Producer/Far
     C                     MOVEL*BLANK    WL0081           PT Producer/Far
     C                     MOVEL*BLANK    WL0082           PT Producer/Far
     C                     MOVELWN0044    WL0083    P      PT Item Type Co
     C                     Z-ADDWN0045    WL0084           PT Item Str Cla
     C                     Z-ADDWN0046    WL0085           PT Item Str Gro
     C                     Z-ADDWN0047    WL0086           PT Item Str Typ
     C                     Z-ADD*ZERO     WL0087           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WL0088           PT WIP Dump/Pro
     C                     MOVELWUXKTX    WL0089    P      PT WIP Dump/Pro
     C                     MOVELWUOTTX    WL0090    P      PT WIP Used/Not
     C                     Z-ADD*ZERO     WL0091           PT From FG Seri
     C                     Z-ADD*ZERO     WL0092           PT To FG Serial
     C                     Z-ADD*ZERO     WL0093           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WL0094           PT Unused Nbr 4
     C                     MOVELWN0048    WL0095    P      PT Incl in Prod
     C                     MOVELWUOTTX    WL0096    P      PT Unused Sts 4
     C                     Z-ADD*ZERO     WL0097           Job Time
     C                     MOVEL*BLANK    WL0098           User Id
     C                     MOVEL*BLANK    WL0099           Job Name
     C                     Z-ADD*ZERO     WL0100           Job Date
     C                     EXSR SSCRRC
     C                     END                             *FI
     C                     END                             *FI
      * ----- Adjust Item Balance & Item Balance Detail -----
      * PROCESS: Finished Goods & WIP Delete
      * CASE: Finished Goods or Work In Process
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DB1.PFS Tracking Type is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Export
      *   |- c3    : DB1.PFS Tracking Type is Casings
      *   |- c4    : DB1.PFS Tracking Type is Export 2
      *   |- c5    : DB1.PFS Tracking Type is Work In Process
      *   '-
     C           WAZ6NX    IFEQ 1                          *IF
     C           WAZ6NX    OREQ 2                          *OR
     C           WAZ6NX    OREQ 7                          *OR
     C           WAZ6NX    OREQ 8                          *OR
     C           WAZ6NX    OREQ 3                          *OR
      * CRT: Item Transaction Detail
      * Inventory Trans. Type
      * CASE: DB1.PFS Transaction Type is WT: Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
     C                     MOVEL'T'       WN0021           Inventory Trans
     C                     MOVEL'TW'      WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,05    WN0013           Description
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is Rework
     C           WAVMSX    IFEQ '02'                       *IF
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL'RR'      WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL'Rework'  WN0013           Description
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is Recall
     C           WAVMSX    IFEQ '03'                       *IF
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL'RR'      WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,06    WN0013           Description
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'A'       WN0021           Inventory Trans
     C                     MOVEL*BLANK    WN0014           Inventory Trans
     C                     MOVEL'A'       WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,07    WN0013           Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    WN0018           Reason Code
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0065  30       Company Number
     C                     PARM WN0019    WQ0066  70       Item Code
     C                     PARM WN0012    WQ0067  3        Warehouse Code
     C                     PARM WN0021    WQ0068  1        Inventory Trans
     C                     PARM WN0014    WQ0069  2        Inventory Trans
     C                     PARM WN0017    WQ0070  70       Transaction Dat
     C                     PARM WN0020    WQ0071  70       Production Date
     C                     PARM WN0013    WQ0072 30        Description
     C                     PARM WN0015    WQ0073 112       Transaction Qua
     C                     PARM WN0016    WQ0074 112       Transaction Wei
     C                     PARM WN0018    WQ0075  3        Reason Code
     C                     PARM WN0022    WQ0076  1        Shift Number
     C                     PARM WN0023    WQ0077  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * TO Warehouse
      * CASE: DB1.PFS Transaction Type is WT: Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0078  30       Company Number
     C                     PARM WN0019    WQ0079  70       Item Code
     C                     PARM WAGBAA    WQ0080  3        Warehouse Code
     C                     PARM WN0021    WQ0081  1        Inventory Trans
     C                     PARM WN0014    WQ0082  2        Inventory Trans
     C                     PARM WN0017    WQ0083  70       Transaction Dat
     C                     PARM WN0020    WQ0084  70       Production Date
     C                     PARM WN0013    WQ0085 30        Description
     C                     PARM WABDNY    WQ0086 112       Transaction Qua
     C                     PARM WAABNY    WQ0087 112       Transaction Wei
     C                     PARM WN0018    WQ0088  3        Reason Code
     C                     PARM WN0022    WQ0089  1        Shift Number
     C                     PARM WN0023    WQ0090  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * ----- Adjust Located Quantity and Weight -----
      * PROCESS:  Lot Tracking = Y
      * CASE: DB1.PFS Transaction Type is Batch Printing
     C           WAVLSX    IFEQ 'B01'                      *IF
      * Decision made on 10/05/05---will receive a locate transaction for
      * batch label and add to located quantity.
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is WT: Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
      * Warehouse transfers will not adjust located because product
      * shouldn't be located yet.
     C                     ELSE
      * CASE: *OTHERWISE
      * PROCESS: Finished Goods
      * CASE: Finished Goods
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : DB1.PFS Tracking Type is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Export
      *   |- c3    : DB1.PFS Tracking Type is Casings
      *   |- c4    : DB1.PFS Tracking Type is Export 2
      *   '-
     C           WAZ6NX    IFEQ 1                          *IF
     C           WAZ6NX    OREQ 2                          *OR
     C           WAZ6NX    OREQ 7                          *OR
     C           WAZ6NX    OREQ 8                          *OR
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WN0067           LLT Trans Type
     C                     MOVEL'A'       WN0067           LLT Trans Type
     C                     MOVEL'A'       WN0052           ILL Status
     C                     MOVEL*BLANK    WN0053           Inv Hold Reason
     C                     Z-ADDWN0015    WN0054           ILL Item Qty On
     C                     Z-ADDWN0016    WN0055           ILl Item Wgt On
      * PFS Item Loc/Crt Trn  CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0101           Company Number
     C                     Z-ADDWN0019    WL0102           Item Code
     C                     MOVELWN0012    WL0103    P      Warehouse Code
     C                     Z-ADDWN0020    WL0104           Production Date
     C                     Z-ADD*ZERO     WL0105           Lot Number
     C                     MOVELWN0051    WL0106    P      Location Code
     C                     Z-ADD*ZERO     WL0107           Location Level
     C                     Z-ADDWN0054    WL0108           ILL Item Qty On
     C                     Z-ADD*ZERO     WL0109           ILL Unit Weight
     C                     Z-ADD*ZERO     WL0110           ILL Co-Packer L
     C                     Z-ADDWN0055    WL0111           ILl Item Wgt On
     C                     Z-ADD*ZERO     WL0112           ILL Unused Qty
     C                     Z-ADD*ZERO     WL0113           ILL Unused Wgt
     C                     Z-ADD*ZERO     WL0114           ILL Avail Ship
     C                     Z-ADD*ZERO     WL0115           ILL Unused Date
     C                     Z-ADD*ZERO     WL0116           ILL Unused Date
     C                     Z-ADD*ZERO     WL0117           ILL Unused Nbr
     C                     MOVEL*BLANK    WL0118           ILL Customer Co
     C                     MOVELWN0052    WL0119    P      ILL Status
     C                     MOVELWUASSX    WL0120    P      ILL Unused Sts
     C                     MOVELWUATSX    WL0121    P      ILL Unused Sts
     C                     MOVELWUAUSX    WL0122    P      ILL Unused Sts
     C                     MOVELWN0053    WL0123    P      Inv Hold Reason
     C                     MOVELWUUVST    WL0124    P      EDI Status 1
     C                     MOVELWUUWST    WL0125    P      EDI Status 2
     C                     MOVELWUUXST    WL0126    P      EDI Status 3
     C                     MOVELWUVSST    WL0127    P      Record Status
     C                     Z-ADD*ZERO     WL0128           Job Time
     C                     MOVEL*BLANK    WL0129           User Id
     C                     MOVEL*BLANK    WL0130           Job Name
     C                     Z-ADD*ZERO     WL0131           Job Date
     C                     MOVELWN0067    WL0132    P      LLT Trans Type
     C                     EXSR STCRRC
      * CRT:  Create Item Balance Detail record if one does not exist
      * Crt Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0176           Company Number
     C                     Z-ADDWN0019    WL0177           Item Code
     C                     MOVELWN0012    WL0178    P      Warehouse Code
     C                     Z-ADDWN0020    WL0179           Production Date
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** FREEZER TRANSACTIONS    *****
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
      * Process F01, F02, F03, F04, & C04
      * CASE: DB1.PFS Transaction Type is FM: Freezer Putaway
     C           WAVLSX    IFEQ 'F01'                      *IF
      * Add to Location for Receipt
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS Warehouse Code is Entered
      *   |- c2    : DB1.PFS Location Code is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAU4SX    IFNE *BLANK                     *IF
     C           WAADNY    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    WN0067           LLT Trans Type
     C                     MOVEL'R'       WN0067           LLT Trans Type
     C                     Z-ADDWABDNY    WN0054           ILL Item Qty On
     C                     Z-ADDWAABNY    WN0055           ILl Item Wgt On
      * PFS Item Loc/Crt Trn  CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0101           Company Number
     C                     Z-ADDWN0019    WL0102           Item Code
     C                     MOVELWN0012    WL0103    P      Warehouse Code
     C                     Z-ADDWN0020    WL0104           Production Date
     C                     Z-ADD*ZERO     WL0105           Lot Number
     C                     MOVELWN0051    WL0106    P      Location Code
     C                     Z-ADD*ZERO     WL0107           Location Level
     C                     Z-ADDWN0054    WL0108           ILL Item Qty On
     C                     Z-ADD*ZERO     WL0109           ILL Unit Weight
     C                     Z-ADD*ZERO     WL0110           ILL Co-Packer L
     C                     Z-ADDWN0055    WL0111           ILl Item Wgt On
     C                     Z-ADD*ZERO     WL0112           ILL Unused Qty
     C                     Z-ADD*ZERO     WL0113           ILL Unused Wgt
     C                     Z-ADD*ZERO     WL0114           ILL Avail Ship
     C                     Z-ADD*ZERO     WL0115           ILL Unused Date
     C                     Z-ADD*ZERO     WL0116           ILL Unused Date
     C                     Z-ADD*ZERO     WL0117           ILL Unused Nbr
     C                     MOVEL*BLANK    WL0118           ILL Customer Co
     C                     MOVELWN0052    WL0119    P      ILL Status
     C                     MOVELWUASSX    WL0120    P      ILL Unused Sts
     C                     MOVELWUATSX    WL0121    P      ILL Unused Sts
     C                     MOVELWUAUSX    WL0122    P      ILL Unused Sts
     C                     MOVELWN0053    WL0123    P      Inv Hold Reason
     C                     MOVELWUUVST    WL0124    P      EDI Status 1
     C                     MOVELWUUWST    WL0125    P      EDI Status 2
     C                     MOVELWUUXST    WL0126    P      EDI Status 3
     C                     MOVELWUVSST    WL0127    P      Record Status
     C                     Z-ADD*ZERO     WL0128           Job Time
     C                     MOVEL*BLANK    WL0129           User Id
     C                     MOVEL*BLANK    WL0130           Job Name
     C                     Z-ADD*ZERO     WL0131           Job Date
     C                     MOVELWN0067    WL0132    P      LLT Trans Type
     C                     EXSR STCRRC
      * CRT:  Create Item Balance Detail record if one does not exist
      * Crt Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0176           Company Number
     C                     Z-ADDWN0019    WL0177           Item Code
     C                     MOVELWN0012    WL0178    P      Warehouse Code
     C                     Z-ADDWN0020    WL0179           Production Date
     C                     EXSR TCRVGN
      * UPD:  Product Trace Warehouse Code
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
     C                     MOVELWAU4SX    WN0034           PT Warehouse ID
      * PFS Upd Warehouse     RT - Product Trace  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c2 OR c3
      *   |- c2    : DB1.PFS Transaction Type is FM: Freezer ReLocate
      *   |- c3    : DB1.PFS Transaction Type is CC: Move to Current Loc
      *   '-
     C           WAVLSX    IFEQ 'F02'                      *IF
     C           WAVLSX    OREQ 'C03'                      *OR
      * **** check if quantity available in the location. ****
      * ----- Reduce From Location -----
     C                     MOVEL*BLANK    WN0067           LLT Trans Type
     C                     MOVEL'T'       WN0067           LLT Trans Type
     C                     MOVEL'A'       WN0052           ILL Status
     C                     MOVEL*BLANK    WN0053           Inv Hold Reason
     C           WABDNY    MULT -1        YL0018           ILL Item Qty On
     C           WAABNY    MULT -1        YL0019           ILl Item Wgt On
      * PFS Item Loc/Crt Trn  CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0101           Company Number
     C                     Z-ADDWN0019    WL0102           Item Code
     C                     MOVELWN0012    WL0103    P      Warehouse Code
     C                     Z-ADDWN0020    WL0104           Production Date
     C                     Z-ADD*ZERO     WL0105           Lot Number
     C                     MOVELWN0051    WL0106    P      Location Code
     C                     Z-ADD*ZERO     WL0107           Location Level
     C                     Z-ADDYL0018    WL0108           ILL Item Qty On
     C                     Z-ADD*ZERO     WL0109           ILL Unit Weight
     C                     Z-ADD*ZERO     WL0110           ILL Co-Packer L
     C                     Z-ADDYL0019    WL0111           ILl Item Wgt On
     C                     Z-ADD*ZERO     WL0112           ILL Unused Qty
     C                     Z-ADD*ZERO     WL0113           ILL Unused Wgt
     C                     Z-ADD*ZERO     WL0114           ILL Avail Ship
     C                     Z-ADD*ZERO     WL0115           ILL Unused Date
     C                     Z-ADD*ZERO     WL0116           ILL Unused Date
     C                     Z-ADD*ZERO     WL0117           ILL Unused Nbr
     C                     MOVEL*BLANK    WL0118           ILL Customer Co
     C                     MOVELWN0052    WL0119    P      ILL Status
     C                     MOVELWUASSX    WL0120    P      ILL Unused Sts
     C                     MOVELWUATSX    WL0121    P      ILL Unused Sts
     C                     MOVELWUAUSX    WL0122    P      ILL Unused Sts
     C                     MOVELWN0053    WL0123    P      Inv Hold Reason
     C                     MOVELWUUVST    WL0124    P      EDI Status 1
     C                     MOVELWUUWST    WL0125    P      EDI Status 2
     C                     MOVELWUUXST    WL0126    P      EDI Status 3
     C                     MOVELWUVSST    WL0127    P      Record Status
     C                     Z-ADD*ZERO     WL0128           Job Time
     C                     MOVEL*BLANK    WL0129           User Id
     C                     MOVEL*BLANK    WL0130           Job Name
     C                     Z-ADD*ZERO     WL0131           Job Date
     C                     MOVELWN0067    WL0132    P      LLT Trans Type
     C                     EXSR STCRRC
      * --- Create Item Balance Detail record if one does not exist ---
      * Crt Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0176           Company Number
     C                     Z-ADDWN0019    WL0177           Item Code
     C                     MOVELWN0012    WL0178    P      Warehouse Code
     C                     Z-ADDWN0020    WL0179           Production Date
     C                     EXSR TCRVGN
      * -----  Add to Location -----
      * Transfer Transaction
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS To Warehouse Code is Entered
      *   |- c2    : DB1.PFS To Location Code is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAGBAA    IFNE *BLANK                     *IF
     C           WAANNY    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'RT'      WN0067           LLT Trans Type
     C                     MOVELWAGBAA    YL0003           Warehouse Code
     C                     MOVELWAANNY    YL0020           Location Code
     C                     Z-ADDWABDNY    WN0054           ILL Item Qty On
     C                     Z-ADDWAABNY    WN0055           ILl Item Wgt On
      * PFS Item Loc/Crt Trn  CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0101           Company Number
     C                     Z-ADDWN0019    WL0102           Item Code
     C                     MOVELYL0003    WL0103    P      Warehouse Code
     C                     Z-ADDWN0020    WL0104           Production Date
     C                     Z-ADD*ZERO     WL0105           Lot Number
     C                     MOVELYL0020    WL0106    P      Location Code
     C                     Z-ADD*ZERO     WL0107           Location Level
     C                     Z-ADDWN0054    WL0108           ILL Item Qty On
     C                     Z-ADD*ZERO     WL0109           ILL Unit Weight
     C                     Z-ADD*ZERO     WL0110           ILL Co-Packer L
     C                     Z-ADDWN0055    WL0111           ILl Item Wgt On
     C                     Z-ADD*ZERO     WL0112           ILL Unused Qty
     C                     Z-ADD*ZERO     WL0113           ILL Unused Wgt
     C                     Z-ADD*ZERO     WL0114           ILL Avail Ship
     C                     Z-ADD*ZERO     WL0115           ILL Unused Date
     C                     Z-ADD*ZERO     WL0116           ILL Unused Date
     C                     Z-ADD*ZERO     WL0117           ILL Unused Nbr
     C                     MOVEL*BLANK    WL0118           ILL Customer Co
     C                     MOVELWN0052    WL0119    P      ILL Status
     C                     MOVELWUASSX    WL0120    P      ILL Unused Sts
     C                     MOVELWUATSX    WL0121    P      ILL Unused Sts
     C                     MOVELWUAUSX    WL0122    P      ILL Unused Sts
     C                     MOVELWN0053    WL0123    P      Inv Hold Reason
     C                     MOVELWUUVST    WL0124    P      EDI Status 1
     C                     MOVELWUUWST    WL0125    P      EDI Status 2
     C                     MOVELWUUXST    WL0126    P      EDI Status 3
     C                     MOVELWUVSST    WL0127    P      Record Status
     C                     Z-ADD*ZERO     WL0128           Job Time
     C                     MOVEL*BLANK    WL0129           User Id
     C                     MOVEL*BLANK    WL0130           Job Name
     C                     Z-ADD*ZERO     WL0131           Job Date
     C                     MOVELWN0067    WL0132    P      LLT Trans Type
     C                     EXSR STCRRC
      * --- Create Item Balance Detail record if one does not exist ---
      * Crt Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0176           Company Number
     C                     Z-ADDWN0019    WL0177           Item Code
     C                     MOVELYL0003    WL0178    P      Warehouse Code
     C                     Z-ADDWN0020    WL0179           Production Date
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is FM: Freezer Hold
     C           WAVLSX    IFEQ 'F03'                      *IF
     C                     MOVEL'H'       WN0052           ILL Status
     C                     MOVEL*BLANK    WN0053           Inv Hold Reason
     C                     MOVELWAVMSX    WN0053           Inv Hold Reason
      * Upd Location Hold PFS RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0180           Company Number
     C                     Z-ADDWN0019    WL0181           Item Code
     C                     MOVELWN0012    WL0182    P      Warehouse Code
     C                     Z-ADDWN0020    WL0183           Production Date
     C                     Z-ADD*ZERO     WL0184           Lot Number
     C                     MOVELWN0051    WL0185    P      Location Code
     C                     Z-ADD*ZERO     WL0186           Location Level
     C                     MOVELWN0052    WL0187    P      ILL Status
     C                     MOVELWN0053    WL0188    P      Inv Hold Reason
     C                     EXSR THRVGN
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is FM: Freezer Release Hold
     C           WAVLSX    IFEQ 'F04'                      *IF
     C                     MOVEL'A'       WN0052           ILL Status
     C                     MOVEL*BLANK    WN0053           Inv Hold Reason
      * Upd Location Hold PFS RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0180           Company Number
     C                     Z-ADDWN0019    WL0181           Item Code
     C                     MOVELWN0012    WL0182    P      Warehouse Code
     C                     Z-ADDWN0020    WL0183           Production Date
     C                     Z-ADD*ZERO     WL0184           Lot Number
     C                     MOVELWN0051    WL0185    P      Location Code
     C                     Z-ADD*ZERO     WL0186           Location Level
     C                     MOVELWN0052    WL0187    P      ILL Status
     C                     MOVELWN0053    WL0188    P      Inv Hold Reason
     C                     EXSR THRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** SHIPPING TRANSACTIONS   *****
      * CASE: Product Return | Co-Pack Receipt | Inter-Plant Tfr
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : DB1.PFS Transaction Type is SM: Product Return
      *   |- c2    : DB1.PFS Transaction Type is SM: Receive Co-Pack Item
      *   |- c3    : DB1.PFS Transaction Type is SM: Inter-Plant Tranfer
      *   |- c4    : DB1.PFS Transaction Type is SM: Product Return WO/Or
      *   '-
     C           WAVLSX    IFEQ 'S04'                      *IF
     C           WAVLSX    OREQ 'S05'                      *OR
     C           WAVLSX    OREQ 'S06'                      *OR
     C           WAVLSX    OREQ 'S07'                      *OR
      * ----- Increase Item Balance & Item Balance Detail -----
      * PROCESS: Finished Goods
      * CASE: Finished Goods
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : DB1.PFS Tracking Type is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Export
      *   |- c3    : DB1.PFS Tracking Type is Casings
      *   |- c4    : DB1.PFS Tracking Type is Export 2
      *   '-
     C           WAZ6NX    IFEQ 1                          *IF
     C           WAZ6NX    OREQ 2                          *OR
     C           WAZ6NX    OREQ 7                          *OR
     C           WAZ6NX    OREQ 8                          *OR
      * CRT: Item Transaction Detail
      * Inventory Trans ID & Inventory Trans Type
      * CASE: DB1.PFS Transaction Type is SM: Inter-Plant Tranfer
     C           WAVLSX    IFEQ 'S06'                      *IF
     C                     MOVEL'T'       WN0021           Inventory Trans
     C                     MOVEL'TW'      WN0014           Inventory Trans
     C                     MOVELWAZPNX    YL0021           Order Alpha
     C                     Z-ADD1         ZQ      50
     C           @CN,08    CAT  YL0021:ZQ WN0013    P      Description
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL*BLANK    WN0014           Inventory Trans
     C                     MOVEL'R'       WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,09    WN0013           Description
     C                     END                             *FI
     C                     MOVEL*BLANK    WN0018           Reason Code
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0091  30       Company Number
     C                     PARM WN0019    WQ0092  70       Item Code
     C                     PARM WN0012    WQ0093  3        Warehouse Code
     C                     PARM WN0021    WQ0094  1        Inventory Trans
     C                     PARM WN0014    WQ0095  2        Inventory Trans
     C                     PARM WN0017    WQ0096  70       Transaction Dat
     C                     PARM WN0020    WQ0097  70       Production Date
     C                     PARM WN0013    WQ0098 30        Description
     C                     PARM WN0015    WQ0099 112       Transaction Qua
     C                     PARM WN0016    WQ0100 112       Transaction Wei
     C                     PARM WN0018    WQ0101  3        Reason Code
     C                     PARM WN0022    WQ0102  1        Shift Number
     C                     PARM WN0023    WQ0103  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: DB1.PFS Transaction Type is SM: Receive Co-Pack Items
     C           WAVLSX    IFEQ 'S05'                      *IF
      * UPD:  Product Trace
      * CASE: PAR.Item Code is Scale Check Item 2222
     C           WN0019    IFEQ 2222                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
     C                     Z-ADDWAP7DT    WN0027           PT Prod Date YY
     C                     Z-ADDWAAFTS    WN0028           PT Production T
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     MOVEL'1'       WN0029           PT Inventory St
     C                     Z-ADDWAABNY    WN0030           PT Net Weight
     C                     Z-ADDWABENY    WN0031           PT Gross Weight
     C                     MOVELWAVKSX    WN0033           PT Shift Number
     C                     MOVELWAU4SX    WN0034           PT Warehouse ID
     C                     MOVELWAAGNY    WN0036           PT Pallet Numbe
     C                     Z-ADDWAY2NX    WN0032           PT Product Code
      * --- Offset Production Date & Time ---
     C                     MOVELWAZ2NX    YL0022           Text USR 8
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0022:ZQ YL0011    P  90  Scale ID
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0026           Company Number
     C                     MOVELYL0011    WL0027    P      Scale ID
     C                     Z-ADDWN0023    WL0028           Effective Label
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0012           CS Scale Offset
     C                     MOVELWL0030    WN0048    P      CS Include in P
     C                     Z-ADDYL0023    WN0037           PT Offset Prod
     C                     MULT -1        YL0012           CS Scale Offset
      * PAR.PT Offset Prod Time = PAR.PT Production Time + LCL.CS Scale O
     C                     Z-ADDWN0028    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           60        MULT YL0012    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     WN0038
      * CASE: PAR.PT Offset Prod Time GT PAR.PT Production Time
     C           WN0038    IFGT WN0028                     *IF
      * PAR.PT Offset Prod Date = PAR.PT Offset Prod Date + CON.-1 *DAYS
     C           WN0037    SUB  18000000  XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0037
     C                     ELSE
     C           XDINDT    ADD  18000000  WN0037
     C                     END
     C                     END                             *FI
      * --- Item Picture Key ---
      * RTV Item Labels        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0031           Company Number
     C                     Z-ADDWN0019    WL0032           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUAVNA    P      Description Lin
     C                     MOVELWL0034    WN0039    P      Item Label Line
     C                     MOVELWL0035    WN0040    P      Item Label Line
     C                     Z-ADDWL0036    WN0045           Item Structure
     C                     Z-ADDWL0037    WN0046           Item Structure
     C                     Z-ADDWL0038    WN0047           Item Structure
     C                     MOVELWL0039    WN0044    P      Item Type Code
     C                     MOVELWL0040    WN0006    P      MTO Code
     C                     MOVELWL0041    WN0007    P      Item Category C
     C                     MOVELWL0042    WN0008    P      Primal Group Co
      * Item Picture Key
      * CASE: PAR.Item Category Code 3 is Loint
     C           WN0007    IFEQ 'L61'                      *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOINT'   WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * Item Picture Key
      * CASE: PAR.MTO Code is Entered
     C           WN0006    IFGT *BLANK                     *IF
      * PFN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is PFN
      *   |- c2    : PAR.MTO Code is IWG
      *   '-
     C           WN0006    IFEQ 'PFN'                      *IF
     C           WN0006    OREQ 'IWG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFN'     WN0043           PT Item Picture
     C                     END                             *FI
      * PFT
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is EHP
      *   |- c2    : PAR.MTO Code is KRG
      *   '-
     C           WN0006    IFEQ 'EHP'                      *IF
     C           WN0006    OREQ 'KRG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFT'     WN0043           PT Item Picture
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : PAR.Primal Group Code is BUTT
      *   |- c2    : PAR.Primal Group Code is HAM
      *   |- c3    : PAR.Primal Group Code is LOIN
      *   |- c4    : PAR.Primal Group Code is PICNIC
      *   |- c5    : PAR.Primal Group Code is RIBS
      *   '-
     C           WN0008    IFEQ 'BUTT'                     *IF
     C           WN0008    OREQ 'HAM'                      *OR
     C           WN0008    OREQ 'LOIN'                     *OR
     C           WN0008    OREQ 'PICNIC'                   *OR
     C           WN0008    OREQ 'RIBS'                     *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVELWN0008    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Primal Group Code is HAMC
     C           WN0008    IFEQ 'HAMC'                     *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'HAM'     WN0043           PT Item Picture
     C                     ELSE
      * CASE: PAR.Primal Group Code is LOINC
     C           WN0008    IFEQ 'LOINC'                    *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOIN'    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOGO'    WN0043           PT Item Picture
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * --- Create Product Trace Record ---
      * Crt Product Trace     CR - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0045           Company Number
     C                     Z-ADDWN0026    WL0046           PT Serial Numbe
     C                     Z-ADDWN0027    WL0047           PT Prod Date YY
     C                     Z-ADDWN0028    WL0048           PT Production T
     C                     Z-ADDWN0042    WL0049           PT Label Date Y
     C                     Z-ADDWN0037    WL0050           PT Offset Prod
     C                     Z-ADDWN0038    WL0051           PT Offset Prod
     C                     MOVELWN0029    WL0052    P      PT Inventory St
     C                     Z-ADDWN0030    WL0053           PT Net Weight
     C                     Z-ADDWN0031    WL0054           PT Gross Weight
     C                     MOVELWN0033    WL0055    P      PT Shift Number
     C                     MOVELWN0034    WL0056    P      PT Warehouse ID
     C                     Z-ADDWN0035    WL0057           PT Order Number
     C                     MOVELWN0036    WL0058    P      PT Pallet Numbe
     C                     Z-ADDWN0032    WL0059           PT Product Code
     C                     MOVELWN0039    WL0060    P      PT Item Label L
     C                     MOVELWN0040    WL0061    P      PT Item Label L
     C                     MOVELWN0041    WL0062    P      PT Fresh/Frozen
     C                     MOVELWN0043    WL0063    P      PT Item Picture
     C                     Z-ADD*ZERO     WL0064           PT Tattoo Numbe
     C                     MOVELWUOTTX    WL0065    P      PT Source Type
     C                     MOVEL*BLANK    WL0066           PT Source Code
     C                     MOVEL*BLANK    WL0067           PT Source Code
     C                     MOVEL*BLANK    WL0068           PT Producer/Cel
     C                     MOVEL*BLANK    WL0069           PT Producer/Cel
     C                     MOVEL*BLANK    WL0070           PT Producer/Far
     C                     MOVEL*BLANK    WL0071           PT Producer Loc
     C                     MOVEL*BLANK    WL0072           PT Producer/Far
     C                     MOVEL*BLANK    WL0073           PT Producer/Far
     C                     MOVELWUOTTX    WL0074    P      PT Producer/Far
     C                     MOVEL*BLANK    WL0075           PT Producer/Far
     C                     MOVEL*BLANK    WL0076           PT Genetic Code
     C                     MOVEL*BLANK    WL0077           PT Genetic Desc
     C                     MOVELWUOTTX    WL0078    P      PT Gender Code
     C                     MOVEL*BLANK    WL0079           PT Producer/Far
     C                     MOVEL*BLANK    WL0080           PT Producer/Far
     C                     MOVEL*BLANK    WL0081           PT Producer/Far
     C                     MOVEL*BLANK    WL0082           PT Producer/Far
     C                     MOVELWN0044    WL0083    P      PT Item Type Co
     C                     Z-ADDWN0045    WL0084           PT Item Str Cla
     C                     Z-ADDWN0046    WL0085           PT Item Str Gro
     C                     Z-ADDWN0047    WL0086           PT Item Str Typ
     C                     Z-ADD*ZERO     WL0087           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WL0088           PT WIP Dump/Pro
     C                     MOVELWUXKTX    WL0089    P      PT WIP Dump/Pro
     C                     MOVELWUOTTX    WL0090    P      PT WIP Used/Not
     C                     Z-ADD*ZERO     WL0091           PT From FG Seri
     C                     Z-ADD*ZERO     WL0092           PT To FG Serial
     C                     Z-ADD*ZERO     WL0093           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WL0094           PT Unused Nbr 4
     C                     MOVELWN0048    WL0095    P      PT Incl in Prod
     C                     MOVELWUOTTX    WL0096    P      PT Unused Sts 4
     C                     Z-ADD*ZERO     WL0097           Job Time
     C                     MOVEL*BLANK    WL0098           User Id
     C                     MOVEL*BLANK    WL0099           Job Name
     C                     Z-ADD*ZERO     WL0100           Job Date
     C                     EXSR SSCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ----- Increase Located Quantity and Weight -----
      * The Freezer Putaway will increase the Location Inventory
     C                     ELSE
      * CASE: Ship Regular Order & Transfer Order
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Transaction Type is SM: Ship Regular Order
      *   |- c2    : DB1.PFS Transaction Type is SM: Transfer Order
      *   '-
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'                      *OR
      * PROCESS:  Ship
      * CASE: WRK.#Sequence Block is NULL
     C           WUZRST    IFEQ *BLANK                     *IF
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
      * CRT:  Manifest Detail & Order Inv Allocation for Lot Tracking WHS
      *
     C                     Z-ADD*ZERO     WN0231  50       Case Sequence N
     C                     MOVEL*BLANK    WN0232  1        EDI Status 1
     C                     MOVEL*BLANK    WN0233  1        EDI Status 2
     C                     MOVEL*BLANK    WN0234  1        EDI Status 3
     C                     MOVEL*BLANK    WN0235  1        Record Status
     C                     Z-ADD*ZERO     WN0236  60       Job Time
     C                     MOVEL*BLANK    WN0237 10        User Id
     C                     MOVEL*BLANK    WN0238 10        Job Name
     C                     Z-ADD*ZERO     WN0239  70       Job Date
      *
      * PFS Crt Manifest Dtl  IF
      * 05/20/10 Moved the Retrieve for ORD DTL Exist inside the XF
      * PFS Crt Order Detail  XF - Order Detail  * 
     C                     CALL 'PPN7XFR'              90  PFS Crt Order D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0104  30       Company Number
     C                     PARM WN0056    WQ0105  70       Order Number
     C                     PARM WN0064    WQ0106  30       Order Sequence
     C                     PARM WN0065    WQ0107  30       Order Secondary
     C                     PARM WN0019    WQ0108  70       Item Code
     C                     PARM WN0012    WQ0109  3        Warehouse Code
     C                     PARM *BLANK    WQ0110  1        Work Over/Short
     C                     PARM *ZERO     WQ0111 112       Quantity Shippe
     C                     PARM *ZERO     WQ0112 112       Weight Shipped
     C                     PARM *ZERO     WQ0113  70       Actual Shipped
     C                     PARM WAZYNX    WQ0114  60       Substitution Li
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPN7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PFS Val Dup Serial#   RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0013           Company Number
     C                     Z-ADDWN0056    WL0014           Order Number
     C                     Z-ADDWN0064    WL0015           Order Sequence
     C                     Z-ADDWN0065    WL0016           Order Secondary
     C                     Z-ADDWN0026    WL0017           PT Serial Numbe
     C                     Z-ADDWN0023    WL0018           Label Date
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    YL0024    P      Record Found US
      * DUPLICATE CASE FOUND
      * CASE: LCL.Record Found USR is Record Found
     C           YL0024    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WN0056    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWN0056    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADDWN0026    ZA0004           PT Serial Numbe
      * Retrieve message PFS Dup Case Manifested
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3596' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0025    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0020           Company Number
     C                     MOVEL@CN,01    WL0021    P      Company Value C
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    YL0026    P      System Value Al
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM YL0026    WQ0115 10        DL List ID
     C                     PARM YL0025    WQ0116132        Office Message
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
     C                     EXSR TJRVGN
      * Crt Manifest Detail   CR - Manifest Detail  * 
     C                     EXSR TKCRRC
      * ** Create Order Inv Allocation ***
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
      *
     C                     Z-ADD*ZERO     WN0240  50       Allocation Seq
      *
      * Crt Order Inv Alloc   IF
      * Rtv Next Seq Num      RT - Order Inv Allocation  * 
     C                     EXSR TLRVGN
      * Crt Order Inv Alloc   CR - Order Inv Allocation  * 
     C                     EXSR TMCRRC
     C                     END                             *FI
      * UPD:  Inventory Status and Order Number in Product Trace
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     Z-ADDWAZPNX    WN0035           PT Order Number
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
      * Val Prod Trc P01 rcd  RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0023           Company Number
     C                     Z-ADDWN0026    WL0024           PT Serial Numbe
     C                     Z-ADDWAZ4NX    WL0025           PT Label Date Y
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
      * PFS Upd Ord/Inv Sts   RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0050    WL0189           Company Number
     C                     Z-ADDWN0026    WL0190           PT Serial Numbe
     C                     Z-ADDWN0042    WL0191           PT Label Date Y
     C                     MOVEL'3'       WL0192    P      PT Inventory St
     C                     Z-ADDWN0035    WL0193           PT Order Number
     C                     EXSR TNRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD:  Product Trace ** Create with order # if not found 12/15/06
      * CASE: PAR.Item Code is Scale Check Item 2222
     C           WN0019    IFEQ 2222                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
     C                     Z-ADDWAP7DT    WN0027           PT Prod Date YY
     C                     Z-ADDWAAFTS    WN0028           PT Production T
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     MOVEL'3'       WN0029           PT Inventory St
     C                     Z-ADDWAABNY    WN0030           PT Net Weight
     C                     Z-ADDWABENY    WN0031           PT Gross Weight
     C                     MOVELWAVKSX    WN0033           PT Shift Number
     C                     MOVELWAU4SX    WN0034           PT Warehouse ID
     C                     MOVELWAAGNY    WN0036           PT Pallet Numbe
     C                     Z-ADDWN0019    WN0032           PT Product Code
      * --- Offset Production Date & Time ---
     C                     MOVELWAZ2NX    YL0010           Text 10A USR
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0010:ZQ YL0011    P  90  Scale ID
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0026           Company Number
     C                     MOVELYL0011    WL0027    P      Scale ID
     C                     Z-ADDWN0023    WL0028           Effective Label
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0012           CS Scale Offset
     C                     MOVELWL0030    WN0048    P      CS Include in P
      * RMC 3/15/06 use par.pt prod date yyyymmdd instead of lcl.pt prod
     C                     Z-ADDWN0027    WN0037           PT Offset Prod
     C                     MULT -1        YL0012           CS Scale Offset
      * PAR.PT Offset Prod Time = PAR.PT Production Time + LCL.CS Scale O
     C                     Z-ADDWN0028    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           60        MULT YL0012    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     WN0038
      * CASE: PAR.PT Offset Prod Time GT PAR.PT Production Time
     C           WN0038    IFGT WN0028                     *IF
      * PAR.PT Offset Prod Date = PAR.PT Offset Prod Date + CON.-1 *DAYS
     C           WN0037    SUB  18000000  XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0037
     C                     ELSE
     C           XDINDT    ADD  18000000  WN0037
     C                     END
     C                     END                             *FI
      * --- Item Picture Key ---
      * RTV Item Labels        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0031           Company Number
     C                     Z-ADDWN0019    WL0032           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUAVNA    P      Description Lin
     C                     MOVELWL0034    WN0039    P      Item Label Line
     C                     MOVELWL0035    WN0040    P      Item Label Line
     C                     Z-ADDWL0036    WN0045           Item Structure
     C                     Z-ADDWL0037    WN0046           Item Structure
     C                     Z-ADDWL0038    WN0047           Item Structure
     C                     MOVELWL0039    WN0044    P      Item Type Code
     C                     MOVELWL0040    WN0006    P      MTO Code
     C                     MOVELWL0041    WN0007    P      Item Category C
     C                     MOVELWL0042    WN0008    P      Primal Group Co
      * Item Picture Key
      * CASE: PAR.Item Category Code 3 is Loint
     C           WN0007    IFEQ 'L61'                      *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOINT'   WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * Item Picture Key
      * CASE: PAR.MTO Code is Entered
     C           WN0006    IFGT *BLANK                     *IF
      * PFN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is PFN
      *   |- c2    : PAR.MTO Code is IWG
      *   '-
     C           WN0006    IFEQ 'PFN'                      *IF
     C           WN0006    OREQ 'IWG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFN'     WN0043           PT Item Picture
     C                     END                             *FI
      * PFT
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is EHP
      *   |- c2    : PAR.MTO Code is KRG
      *   '-
     C           WN0006    IFEQ 'EHP'                      *IF
     C           WN0006    OREQ 'KRG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFT'     WN0043           PT Item Picture
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : PAR.Primal Group Code is BUTT
      *   |- c2    : PAR.Primal Group Code is HAM
      *   |- c3    : PAR.Primal Group Code is LOIN
      *   |- c4    : PAR.Primal Group Code is PICNIC
      *   |- c5    : PAR.Primal Group Code is RIBS
      *   '-
     C           WN0008    IFEQ 'BUTT'                     *IF
     C           WN0008    OREQ 'HAM'                      *OR
     C           WN0008    OREQ 'LOIN'                     *OR
     C           WN0008    OREQ 'PICNIC'                   *OR
     C           WN0008    OREQ 'RIBS'                     *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVELWN0008    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Primal Group Code is HAMC
     C           WN0008    IFEQ 'HAMC'                     *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'HAM'     WN0043           PT Item Picture
     C                     ELSE
      * CASE: PAR.Primal Group Code is LOINC
     C           WN0008    IFEQ 'LOINC'                    *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOIN'    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOGO'    WN0043           PT Item Picture
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0043    P      Warehouse Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WN0041    P      Warehouse Type
      * --- Create Product Trace Record ---
      * Crt Product Trace     CR - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0045           Company Number
     C                     Z-ADDWN0026    WL0046           PT Serial Numbe
     C                     Z-ADDWN0027    WL0047           PT Prod Date YY
     C                     Z-ADDWN0028    WL0048           PT Production T
     C                     Z-ADDWN0042    WL0049           PT Label Date Y
     C                     Z-ADDWN0037    WL0050           PT Offset Prod
     C                     Z-ADDWN0038    WL0051           PT Offset Prod
     C                     MOVELWN0029    WL0052    P      PT Inventory St
     C                     Z-ADDWN0030    WL0053           PT Net Weight
     C                     Z-ADDWN0031    WL0054           PT Gross Weight
     C                     MOVELWN0033    WL0055    P      PT Shift Number
     C                     MOVELWN0034    WL0056    P      PT Warehouse ID
     C                     Z-ADDWN0035    WL0057           PT Order Number
     C                     MOVELWN0036    WL0058    P      PT Pallet Numbe
     C                     Z-ADDWN0032    WL0059           PT Product Code
     C                     MOVELWN0039    WL0060    P      PT Item Label L
     C                     MOVELWN0040    WL0061    P      PT Item Label L
     C                     MOVELWN0041    WL0062    P      PT Fresh/Frozen
     C                     MOVELWN0043    WL0063    P      PT Item Picture
     C                     Z-ADD*ZERO     WL0064           PT Tattoo Numbe
     C                     MOVELWUOTTX    WL0065    P      PT Source Type
     C                     MOVEL*BLANK    WL0066           PT Source Code
     C                     MOVEL*BLANK    WL0067           PT Source Code
     C                     MOVEL*BLANK    WL0068           PT Producer/Cel
     C                     MOVEL*BLANK    WL0069           PT Producer/Cel
     C                     MOVEL*BLANK    WL0070           PT Producer/Far
     C                     MOVEL*BLANK    WL0071           PT Producer Loc
     C                     MOVEL*BLANK    WL0072           PT Producer/Far
     C                     MOVEL*BLANK    WL0073           PT Producer/Far
     C                     MOVELWUOTTX    WL0074    P      PT Producer/Far
     C                     MOVEL*BLANK    WL0075           PT Producer/Far
     C                     MOVEL*BLANK    WL0076           PT Genetic Code
     C                     MOVEL*BLANK    WL0077           PT Genetic Desc
     C                     MOVELWUOTTX    WL0078    P      PT Gender Code
     C                     MOVEL*BLANK    WL0079           PT Producer/Far
     C                     MOVEL*BLANK    WL0080           PT Producer/Far
     C                     MOVEL*BLANK    WL0081           PT Producer/Far
     C                     MOVEL*BLANK    WL0082           PT Producer/Far
     C                     MOVELWN0044    WL0083    P      PT Item Type Co
     C                     Z-ADDWN0045    WL0084           PT Item Str Cla
     C                     Z-ADDWN0046    WL0085           PT Item Str Gro
     C                     Z-ADDWN0047    WL0086           PT Item Str Typ
     C                     Z-ADD*ZERO     WL0087           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WL0088           PT WIP Dump/Pro
     C                     MOVELWUXKTX    WL0089    P      PT WIP Dump/Pro
     C                     MOVELWUOTTX    WL0090    P      PT WIP Used/Not
     C                     Z-ADD*ZERO     WL0091           PT From FG Seri
     C                     Z-ADD*ZERO     WL0092           PT To FG Serial
     C                     Z-ADD*ZERO     WL0093           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WL0094           PT Unused Nbr 4
     C                     MOVELWN0048    WL0095    P      PT Incl in Prod
     C                     MOVELWUOTTX    WL0096    P      PT Unused Sts 4
     C                     Z-ADD*ZERO     WL0097           Job Time
     C                     MOVEL*BLANK    WL0098           User Id
     C                     MOVEL*BLANK    WL0099           Job Name
     C                     Z-ADD*ZERO     WL0100           Job Date
     C                     EXSR SSCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is SM: UnShip Reg/Tfr Ord
     C           WAVLSX    IFEQ 'S03'                      *IF
      * PROCESS:  Unship
      * CASE: WRK.#Sequence Block is NULL
     C           WUZRST    IFEQ *BLANK                     *IF
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
      * DEL:  Manifest Detail
      * PFS Del Manifest Dtl  RT - Manifest Detail  * 
     C                     EXSR TPRVGN
      * UPD:  Inventory Status and Order Number in Product Trace
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
      * PFS Upd Ord/Inv Sts   RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0050    WL0189           Company Number
     C                     Z-ADDWN0026    WL0190           PT Serial Numbe
     C                     Z-ADDWN0042    WL0191           PT Label Date Y
     C                     MOVEL'1'       WL0192    P      PT Inventory St
     C                     Z-ADD*ZERO     WL0193           PT Order Number
     C                     EXSR TNRVGN
      * ----- Create Inv Trans Dtl & Update Inv Balance & Detail
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD1         WN0009           PFS Process Sta
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * CASE: PAR.PFS Error Reason is Inactive Transaction
     C           WN0010    IFEQ 'INACTV'                   *IF
     C                     Z-ADD1         WN0009           PFS Process Sta
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC0NY' defaulted for 'PFS Inv Adj Seq Nbr'.
      * Chg PrcSts/ErrRsn     CH - PFS Inventory Adjustment  * 
     C                     EXSR TTCHRC
     C           KRSSA     READE@BGCPD8                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBY1NX           PFS Company Num
     C                     KFLD           WBGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0001    WBY1NX           PFS Company Num
     C                     MOVELWL0002    WBGYAA           PFS Interface C
      * Establish starting position
     C           KRSSB     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0004           PFS Carlisle Ac
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBWSSX    WL0003           PFS AccuSort Ac
     C                     MOVELWBWUSX    WL0004           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Val WHS/Rtv ActCo PFS RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0012    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCVHST    WN0049           Lot Tracking Fl
     C                     Z-ADDWCBTC3    WN0050           Accounting Comp
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Val Itm/Whs,FG/WP PFS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDHGCD    WQSD02           Item Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
      * Setup key
     C                     Z-ADDWL0005    WQSD01           Company Number
     C                     Z-ADDWL0006    WQSD02           Item Code
      * Establish starting position
     C           KRSSD     SETLL@BZREJR                    *
     C           KRSSD     READE@BZREJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Production Date
     C                     Z-ADD*ZERO     WL0008           Item Structure
     C                     MOVEL*BLANK    WL0009           Item Type Code
     C                     MOVEL*BLANK    WL0010           Default Warehou
     C                     Z-ADD*ZERO     WL0011           Fresh Chilling
     C                     MOVEL*BLANK    WL0012           Primal Group Co
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDFZST    WL0007           Production Date
     C                     Z-ADDWDRGNB    WL0008           Item Structure
     C                     MOVELWDN0CD    WL0009           Item Type Code
     C                     MOVELWDQ1CD    WL0010           Default Warehou
     C                     Z-ADDWDCHTM    WL0011           Fresh Chilling
     C                     MOVELWDXRCD    WL0012           Primal Group Co
     C           KRSSD     READE@BZREJR                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Unit Cost Active   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWAY1NX    WEAIC3           Company Number
     C                     Z-ADDWAY2NX    WEHGCD           Item Code
     C                     MOVELWAU4SX    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0011           Unit Cost Per P
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAGCS    WN0011           Unit Cost Per P
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Order Info PFS    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0002    WFAIC3           Company Number
     C                     Z-ADDWN0056    WFC4NB           Order Number
      * Establish starting position
     C           KRSSF     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFJNCD    WN0058           Order Type - Sa
     C                     Z-ADDWFBKC7    WN0061           Ship To Custome
     C                     MOVELWFGWST    WN0057           Header Status
     C                     Z-ADDWFAODT    WN0063           Scheduled Ship
     C                     MOVELWFJPCD    WN0060           Event Code
     C                     MOVELWFXUST    WN0062           Trans Contol AS
     C                     MOVELWFOBST    WN0059           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSG02           Order Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADDWN0002    WQSG01           Company Number
     C                     Z-ADDWN0056    WQSG02           Order Number
     C                     Z-ADDWN0064    WGDPNB           Order Sequence
     C                     Z-ADDWN0065    WGUENB           Order Secondary
      * Establish starting position
     C           KPSSG     SETLL@BGWKAE                    *
     C           KRSSG     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Warehouse Code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SHRVGN
      * PAR = DB1 By name
     C                     MOVELWGAJCD    YL0003           Warehouse Code
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWGAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * PFS Val Dup Serial#   RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0019           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSI02           Order Number
     C           *LIKE     DEFN WHDPNB    WQSI03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQSI04           Order Secondary
     C           *LIKE     DEFN WHPFNX    WQSI05           PT Serial Numbe
     C           *LIKE     DEFN WHK7DT    WQSI06           Label Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           Order Sequence
     C                     KFLD           WQSI04           Order Secondary
     C                     KFLD           WQSI05           PT Serial Numbe
     C                     KFLD           WQSI06           Label Date
      * Setup key
     C                     Z-ADDWL0013    WQSI01           Company Number
     C                     Z-ADDWL0014    WQSI02           Order Number
     C                     Z-ADDWL0015    WQSI03           Order Sequence
     C                     Z-ADDWL0016    WQSI04           Order Secondary
     C                     Z-ADDWL0017    WQSI05           PT Serial Numbe
     C                     Z-ADDWL0018    WQSI06           Label Date
      * Establish starting position
     C           KRSSI     SETLL@FNCPAZ                    *
     C           KRSSI     READE@FNCPAZ                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0019           Record Found US
     C           KRSSI     READE@FNCPAZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0020    WIAIC3           Company Number
     C                     MOVELWL0021    WIV8CD           Company Value C
      * Establish starting position
     C           KRSSJ     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIBXTX    WL0022           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val Warehouse PFS     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWAGBAA    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCVHST    YL0007           Lot Tracking Fl
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Val Prod Trc P01 rcd  RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WJPFNX    WQSL02           PT Serial Numbe
     C           *LIKE     DEFN WJADDX    WQSL03           PT Label Date Y
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           PT Serial Numbe
     C                     KFLD           WQSL03           PT Label Date Y
      * Setup key
     C                     Z-ADDWL0023    WQSL01           Company Number
     C                     Z-ADDWL0024    WQSL02           PT Serial Numbe
     C                     Z-ADDWL0025    WQSL03           PT Label Date Y
      * Establish starting position
     C           KRSSL     SETLL@B2CPT3                    *
     C           KRSSL     READE@B2CPT3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3144' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSL     READE@B2CPT3                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Val DupCase for Issue RT - PFS Inventory Adjustment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKY1NX    WQSM01           PFS Company Num
     C           *LIKE     DEFN WKY2NX    WQSM02           PFS Item Code
     C           *LIKE     DEFN WKZ2NX    WQSM03           PFS Serial Numb
     C           *LIKE     DEFN WKZ4NX    WQSM04           PFS Label Date
     C           *LIKE     DEFN WKVLSX    WQSM05           PFS Transaction
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           PFS Company Num
     C                     KFLD           WQSM02           PFS Item Code
     C                     KFLD           WQSM03           PFS Serial Numb
     C                     KFLD           WQSM04           PFS Label Date
     C                     KFLD           WQSM05           PFS Transaction
      * Setup key
     C                     Z-ADDWAY1NX    WQSM01           PFS Company Num
     C                     Z-ADDWAY2NX    WQSM02           PFS Item Code
     C                     Z-ADDWAZ2NX    WQSM03           PFS Serial Numb
     C                     Z-ADDWAZ4NX    WQSM04           PFS Label Date
     C                     MOVEL'P02'     WQSM05           PFS Transaction
      * Establish starting position
     C           KRSSM     SETLL@BGCPF0                    *
     C           KRSSM     READE@BGCPF0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3496' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@BGCPF0                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0012    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           WHS Live w/Carl
     C                     MOVEL*BLANK    YL0009           WHS PFS Interfa
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCRRSX    YL0008           WHS Live w/Carl
     C                     MOVELWCRSSX    YL0009           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WLUXNX    WQSO02           Scale ID
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Scale ID
     C                     KFLD           WLPUDT           Effective Label
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Scale ID
      * Setup key
     C                     Z-ADDWL0026    WQSO01           Company Number
     C                     MOVELWL0027    WQSO02           Scale ID
     C                     Z-ADDWL0028    WLPUDT           Effective Label
      * Establish starting position
     C           KPSSO     SETLL@AARETD                    *
     C           KRSSO     READE@AARETD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3311' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WL0029           CS Scale Offset
     C                     MOVEL'N'       WL0030           CS Include in P
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Prod Trace Offset RT - Product Trace Line  * 
     C                     EXSR SPRVGN
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@AARETD                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Prod Trace Offset RT - Product Trace Line  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMFAAA           Line Code
      * Setup key
     C                     Z-ADDWLAIC3    WMAIC3           Company Number
     C                     MOVELWLFAAA    WMFAAA           Line Code
      * Establish starting position
     C           KRSSP     CHAIN@ABRETA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3314' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0029           CS Scale Offset
     C                     MOVEL*BLANK    WL0030           CS Include in P
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMPINX    WL0029           CS Scale Offset
     C                     MOVELWMMUSX    WL0030           CS Include in P
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Item Labels        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0031    WOAIC3           Company Number
     C                     Z-ADDWL0032    WOHGCD           Item Code
      * Establish starting position
     C           KRSSQ     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0033           Description Lin
     C                     MOVEL*BLANK    WL0034           Item Label Line
     C                     MOVEL*BLANK    WL0035           Item Label Line
     C                     Z-ADD*ZERO     WL0036           Item Structure
     C                     Z-ADD*ZERO     WL0037           Item Structure
     C                     Z-ADD*ZERO     WL0038           Item Structure
     C                     MOVEL*BLANK    WL0039           Item Type Code
     C                     MOVEL*BLANK    WL0040           MTO Code
     C                     MOVEL*BLANK    WL0041           Item Category C
     C                     MOVEL*BLANK    WL0042           Primal Group Co
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOAVNA    WL0033           Description Lin
     C                     MOVELWOL7NA    WL0034           Item Label Line
     C                     MOVELWOL8NA    WL0035           Item Label Line
     C                     Z-ADDWORINB    WL0036           Item Structure
     C                     Z-ADDWORHNB    WL0037           Item Structure
     C                     Z-ADDWORGNB    WL0038           Item Structure
     C                     MOVELWON0CD    WL0039           Item Type Code
     C                     MOVELWOSVCD    WL0040           MTO Code
     C                     MOVELWOSXCD    WL0041           Item Category C
     C                     MOVELWOXRCD    WL0042           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0043    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSR     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0044           Warehouse Type
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WL0044           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt Product Trace     CR - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B2CPMP
     C                     Z-ADDWL0045    WRAIC3           Company Number
     C                     Z-ADDWL0046    WRPFNX           PT Serial Numbe
     C                     Z-ADDWL0047    WRAADX           PT Prod Date YY
     C                     Z-ADDWL0048    WRB9TM           PT Production T
     C                     Z-ADDWL0049    WRADDX           PT Label Date Y
     C                     Z-ADDWL0050    WRABDX           PT Offset Prod
     C                     Z-ADDWL0051    WRCATM           PT Offset Prod
     C                     MOVELWL0052    WRMNSX           PT Inventory St
     C                     Z-ADDWL0053    WRJOWG           PT Net Weight
     C                     Z-ADDWL0054    WRJPWG           PT Gross Weight
     C                     MOVELWL0055    WRMOSX           PT Shift Number
     C                     MOVELWL0056    WRDNAA           PT Warehouse ID
     C                     Z-ADDWL0057    WRPGNX           PT Order Number
     C                     MOVELWL0058    WRBTT1           PT Pallet Numbe
     C                     Z-ADDWL0059    WRD7C7           PT Product Code
     C                     MOVELWL0060    WRPYNA           PT Item Label L
     C                     MOVELWL0061    WRPZNA           PT Item Label L
     C                     MOVELWL0062    WRMPSX           PT Fresh/Frozen
     C                     MOVELWL0063    WRCCT1           PT Item Picture
     C                     Z-ADDWL0064    WRPHNX           PT Tattoo Numbe
     C                     MOVELWL0065    WRMQSX           PT Source Type
     C                     MOVELWL0066    WRDOAA           PT Source Code
     C                     MOVELWL0067    WRBUT1           PT Source Code
     C                     MOVELWL0068    WRDYAA           PT Producer/Cel
     C                     MOVELWL0069    WRBVT1           PT Producer/Cel
     C                     MOVELWL0070    WRDPAA           PT Producer/Far
     C                     MOVELWL0071    WRDQAA           PT Producer Loc
     C                     MOVELWL0072    WRBZT1           PT Producer/Far
     C                     MOVELWL0073    WRBWT1           PT Producer/Far
     C                     MOVELWL0074    WRDRAA           PT Producer/Far
     C                     MOVELWL0075    WRB9T1           PT Producer/Far
     C                     MOVELWL0076    WRDSAA           PT Genetic Code
     C                     MOVELWL0077    WRB8T1           PT Genetic Desc
     C                     MOVELWL0078    WRD4AA           PT Gender Code
     C                     MOVELWL0079    WREPAA           PT Producer/Far
     C                     MOVELWL0080    WREQAA           PT Producer/Far
     C                     MOVELWL0081    WRERAA           PT Producer/Far
     C                     MOVELWL0082    WRESAA           PT Producer/Far
     C                     MOVELWL0083    WRPNSX           PT Item Type Co
     C                     Z-ADDWL0084    WRUFNX           PT Item Str Cla
     C                     Z-ADDWL0085    WRUGNX           PT Item Str Gro
     C                     Z-ADDWL0086    WRUHNX           PT Item Str Typ
     C                     Z-ADDWL0087    WRAGDX           PT WIP Dump/Pro
     C                     Z-ADDWL0088    WRCGTM           PT WIP Dump/Pro
     C                     MOVELWL0089    WRPOSX           PT WIP Dump/Pro
     C                     MOVELWL0090    WRPPSX           PT WIP Used/Not
     C                     Z-ADDWL0091    WRUINX           PT From FG Seri
     C                     Z-ADDWL0092    WRUJNX           PT To FG Serial
     C                     Z-ADDWL0093    WRUKNX           PT Unused Nbr 3
     C                     Z-ADDWL0094    WRULNX           PT Unused Nbr 4
     C                     MOVELWL0095    WRPRSX           PT Incl in Prod
     C                     MOVELWL0096    WRPSSX           PT Unused Sts 4
     C                     Z-ADDWL0097    WRAATM           Job Time
     C                     MOVELWL0098    WRAYNA           User Id
     C                     MOVELWL0099    WRA0NA           Job Name
     C                     Z-ADDWL0100    WRAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
     C           KLCRSS    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRPFNX           PT Serial Numbe
     C                     KFLD           WRAADX           PT Prod Date YY
     C                     KFLD           WRB9TM           PT Production T
      * Check for duplicate primary key
     C           KLCRSS    SETLL@B2CPMP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3145' W0RTN   7
      * Send message 'Product Trace          EX'
     C                     MOVEL'USR3145' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@B2CPMP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * PFS Item Loc/Crt Trn  CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0101    WSAIC3           Company Number
     C                     Z-ADDWL0102    WSHGCD           Item Code
     C                     MOVELWL0103    WSAJCD           Warehouse Code
     C                     Z-ADDWL0104    WSELDT           Production Date
     C                     Z-ADDWL0105    WSLXNM           Lot Number
     C                     MOVELWL0106    WSYMCD           Location Code
     C                     Z-ADDWL0107    WSYNCD           Location Level
     C                     Z-ADDWL0108    WSJ2QT           ILL Item Qty On
     C                     Z-ADDWL0109    WSG5WG           ILL Unit Weight
     C                     Z-ADDWL0110    WSJ3QT           ILL Co-Packer L
     C                     Z-ADDWL0111    WSG6WG           ILl Item Wgt On
     C                     Z-ADDWL0112    WSJ4QT           ILL Unused Qty
     C                     Z-ADDWL0113    WSG7WG           ILL Unused Wgt
     C                     Z-ADDWL0114    WSLODT           ILL Avail Ship
     C                     Z-ADDWL0115    WSLPDT           ILL Unused Date
     C                     Z-ADDWL0116    WSLQDT           ILL Unused Date
     C                     Z-ADDWL0117    WSNBR            ILL Unused Nbr
     C                     MOVELWL0118    WSYTCD           ILL Customer Co
     C                     MOVELWL0119    WSAMSX           ILL Status
     C                     MOVELWL0120    WSASSX           ILL Unused Sts
     C                     MOVELWL0121    WSATSX           ILL Unused Sts
     C                     MOVELWL0122    WSAUSX           ILL Unused Sts
     C                     MOVELWL0123    WSYSCD           Inv Hold Reason
     C                     MOVELWL0124    WSUVST           EDI Status 1
     C                     MOVELWL0125    WSUWST           EDI Status 2
     C                     MOVELWL0126    WSUXST           EDI Status 3
     C                     MOVELWL0127    WSVSST           Record Status
     C                     Z-ADDWL0128    WSAATM           Job Time
     C                     MOVELWL0129    WSAYNA           User Id
     C                     MOVELWL0130    WSA0NA           Job Name
     C                     Z-ADDWL0131    WSAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WSVSST           Record Status
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
     C                     MOVEL'A'       WSAMSX           ILL Status
      * CASE: DB1.ILL Avail Ship Date is Not Entered
     C           WSLODT    IFEQ *ZERO                      *IF
      *
     C                     MOVEL*BLANK    WN0086  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0087  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0103    WL0133    P      Warehouse Code
     C                     MOVELWL0106    WL0134    P      Location Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0135    WN0086    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0086    WL0136    P      WLT Type Code
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0137    WN0087           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WL0104    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0087    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WSLODT
     C                     ELSE
     C           XDINDT    SUB  1000000   WSLODT
     C                     END
      * CASE: DB1.ILL Avail Ship Date GT JOB.*Job date
     C           WSLODT    IFGT ##JDT                      *IF
     C                     MOVEL'H'       WSAMSX           ILL Status
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.ILL Unit Weight is Equal to zero
     C           WSG5WG    IFEQ *ZERO                      *IF
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0138           Company Number
     C                     Z-ADDWL0102    WL0139           Item Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0140    WSG5WG           Unit Weight
     C                     MOVELWL0141    YL0013    P      Quality Level
     C                     END                             *FI
     C           KLCRST    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSLXNM           Lot Number
     C                     KFLD           WSYMCD           Location Code
     C                     KFLD           WSYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRST    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * USER: Processing if Data record already exists
      * PFS Upd Qty On-Hand   RT - Item Lot Location  * 
     C                     EXSR SXRVGN
      *
     C                     Z-ADD*ZERO     WN0136  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0137  1        EDI Status 1
     C                     MOVEL*BLANK    WN0138  1        EDI Status 2
     C                     MOVEL*BLANK    WN0139  1        EDI Status 3
     C                     MOVEL*BLANK    WN0140  1        Record Status
     C                     Z-ADD*ZERO     WN0141  60       Job Time
     C                     MOVEL*BLANK    WN0142 10        User Id
     C                     MOVEL*BLANK    WN0143 10        Job Name
     C                     Z-ADD*ZERO     WN0144  70       Job Date
      *
      * PFS Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0142           Company Number
     C                     Z-ADDWL0102    WL0143           Item Code
     C                     MOVELWL0103    WL0144    P      Warehouse Code
     C                     MOVELWL0132    WL0145    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0146           LLT Trans Date
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0147    WN0136           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0148           Company Number
     C                     Z-ADDWL0102    WL0149           Item Code
     C                     MOVELWL0103    WL0150    P      Warehouse Code
     C                     MOVELWL0132    WL0151    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0152           LLT Trans Date
     C                     Z-ADDWN0136    WL0153           LLT Sequence #
     C                     Z-ADDWL0104    WL0154           LLT Production
     C                     Z-ADDWL0108    WL0155           LLT Trans Qty
     C                     Z-ADDWL0111    WL0156           LLT Trans Wgt
     C                     Z-ADDWL0105    WL0157           LLT Lot Number
     C                     MOVELWL0106    WL0158    P      Location Code
     C                     Z-ADDWL0107    WL0159           LLT Location Le
     C                     MOVEL*BLANK    WL0160           Transfer Wareho
     C                     Z-ADD*ZERO     WL0161           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0162           Transfer Locati
     C                     Z-ADD*ZERO     WL0163           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0164           Order Number
     C                     MOVEL'P'       WL0165    P      LLT Status
     C                     MOVELWULLTU    WL0166    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0167    P      LTT Unused Sts
     C                     MOVELWN0137    WL0168    P      EDI Status 1
     C                     MOVELWN0138    WL0169    P      EDI Status 2
     C                     MOVELWN0139    WL0170    P      EDI Status 3
     C                     MOVELWN0140    WL0171    P      Record Status
     C                     Z-ADDWN0141    WL0172           Job Time
     C                     MOVELWN0142    WL0173    P      User Id
     C                     MOVELWN0143    WL0174    P      Job Name
     C                     Z-ADDWN0144    WL0175           Job Date
     C                     EXSR TBCRRC
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      *
     C                     Z-ADD*ZERO     WN0145  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0146  1        EDI Status 1
     C                     MOVEL*BLANK    WN0147  1        EDI Status 2
     C                     MOVEL*BLANK    WN0148  1        EDI Status 3
     C                     MOVEL*BLANK    WN0149  1        Record Status
     C                     Z-ADD*ZERO     WN0150  60       Job Time
     C                     MOVEL*BLANK    WN0151 10        User Id
     C                     MOVEL*BLANK    WN0152 10        Job Name
     C                     Z-ADD*ZERO     WN0153  70       Job Date
      *
      * PFS Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0142           Company Number
     C                     Z-ADDWL0102    WL0143           Item Code
     C                     MOVELWL0103    WL0144    P      Warehouse Code
     C                     MOVELWL0132    WL0145    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0146           LLT Trans Date
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0147    WN0145           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0148           Company Number
     C                     Z-ADDWL0102    WL0149           Item Code
     C                     MOVELWL0103    WL0150    P      Warehouse Code
     C                     MOVELWL0132    WL0151    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0152           LLT Trans Date
     C                     Z-ADDWN0145    WL0153           LLT Sequence #
     C                     Z-ADDWL0104    WL0154           LLT Production
     C                     Z-ADDWL0108    WL0155           LLT Trans Qty
     C                     Z-ADDWL0111    WL0156           LLT Trans Wgt
     C                     Z-ADDWL0105    WL0157           LLT Lot Number
     C                     MOVELWL0106    WL0158    P      Location Code
     C                     Z-ADDWL0107    WL0159           LLT Location Le
     C                     MOVEL*BLANK    WL0160           Transfer Wareho
     C                     Z-ADD*ZERO     WL0161           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0162           Transfer Locati
     C                     Z-ADD*ZERO     WL0163           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0164           Order Number
     C                     MOVEL'P'       WL0165    P      LLT Status
     C                     MOVELWULLTU    WL0166    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0167    P      LTT Unused Sts
     C                     MOVELWN0146    WL0168    P      EDI Status 1
     C                     MOVELWN0147    WL0169    P      EDI Status 2
     C                     MOVELWN0148    WL0170    P      EDI Status 3
     C                     MOVELWN0149    WL0171    P      Record Status
     C                     Z-ADDWN0150    WL0172           Job Time
     C                     MOVELWN0151    WL0173    P      User Id
     C                     MOVELWN0152    WL0174    P      Job Name
     C                     Z-ADDWN0153    WL0175           Job Date
     C                     EXSR TBCRRC
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WTAJCD           Warehouse Code
     C                     KFLD           WTYMCD           Location Code
      * Setup key
     C                     MOVELWL0133    WTAJCD           Warehouse Code
     C                     MOVELWL0134    WTYMCD           Location Code
      * Establish starting position
     C           KRSSU     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0135           WLT Type Code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTAGSX    WL0135           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WVAGSX           WLT Type Code
      * Setup key
     C                     MOVELWL0136    WVAGSX           WLT Type Code
      * Establish starting position
     C           KRSSV     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0137           WLT Type Chill
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWVSLTY    WL0137           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0138    WOAIC3           Company Number
     C                     Z-ADDWL0139    WOHGCD           Item Code
      * Establish starting position
     C           KRSSW     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0140           Unit Weight
     C                     MOVEL*BLANK    WL0141           Quality Level
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOAIWG    WL0140           Unit Weight
     C                     MOVELWOHICD    WL0141           Quality Level
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * PFS Upd Qty On-Hand   RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0088  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0089 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0090  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0091 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0092  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0093 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0094  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0095  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0096  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0097  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0098  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0099  1        ILL Status
     C                     MOVEL*BLANK    WN0100  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0101  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0102  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0103  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0104  1        EDI Status 1
     C                     MOVEL*BLANK    WN0105  1        EDI Status 2
     C                     MOVEL*BLANK    WN0106  1        EDI Status 3
     C                     MOVEL*BLANK    WN0107  1        Record Status
     C                     Z-ADD*ZERO     WN0108  60       Job Time
     C                     MOVEL*BLANK    WN0109 10        User Id
     C                     MOVEL*BLANK    WN0110 10        Job Name
     C                     Z-ADD*ZERO     WN0111  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWHGCD           Item Code
     C                     KFLD           WWAJCD           Warehouse Code
     C                     KFLD           WWELDT           Production Date
     C                     KFLD           WWLXNM           Lot Number
     C                     KFLD           WWYMCD           Location Code
     C                     KFLD           WWYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0101    WWAIC3           Company Number
     C                     Z-ADDWL0102    WWHGCD           Item Code
     C                     MOVELWL0103    WWAJCD           Warehouse Code
     C                     Z-ADDWL0104    WWELDT           Production Date
     C                     Z-ADDWL0105    WWLXNM           Lot Number
     C                     MOVELWL0106    WWYMCD           Location Code
     C                     Z-ADDWL0107    WWYNCD           Location Level
      * Establish starting position
     C           KRSSX     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      *
     C                     MOVEL*BLANK    WN0112  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0113  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0103    WL0133    P      Warehouse Code
     C                     MOVELWL0106    WL0134    P      Location Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0135    WN0112    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0112    WL0136    P      WLT Type Code
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0137    WN0113           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WL0104    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0113    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0094
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0094
     C                     END
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0138           Company Number
     C                     Z-ADDWL0102    WL0139           Item Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0140    WN0089           Unit Weight
     C                     MOVELWL0141    YL0014    P      Quality Level
      * Crt Item Loc          CR - Item Lot Location  * 
     C                     EXSR SYCRRC
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WWJ2QT    ADD  WL0108    WN0088           ILL Item Qty On
     C           WWG6WG    ADD  WL0111    WN0091           ILl Item Wgt On
      * CASE: PAR.ILL Item Qty On-Hand is NE Zero
     C           WN0088    IFNE *ZERO                      *IF
      * PFS Chg Qty/Wgt OnHnd CH - Item Lot Location  * 
     C                     EXSR SZCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0101    WSAIC3           Company Number
     C                     Z-ADDWL0102    WSHGCD           Item Code
     C                     MOVELWL0103    WSAJCD           Warehouse Code
     C                     Z-ADDWL0104    WSELDT           Production Date
     C                     Z-ADDWL0105    WSLXNM           Lot Number
     C                     MOVELWL0106    WSYMCD           Location Code
     C                     Z-ADDWL0107    WSYNCD           Location Level
     C                     Z-ADDWL0108    WSJ2QT           ILL Item Qty On
     C                     Z-ADDWN0089    WSG5WG           ILL Unit Weight
     C                     Z-ADDWN0090    WSJ3QT           ILL Co-Packer L
     C                     Z-ADDWN0091    WSG6WG           ILl Item Wgt On
     C                     Z-ADDWN0092    WSJ4QT           ILL Unused Qty
     C                     Z-ADDWN0093    WSG7WG           ILL Unused Wgt
     C                     Z-ADDWN0094    WSLODT           ILL Avail Ship
     C                     Z-ADDWN0095    WSLPDT           ILL Unused Date
     C                     Z-ADDWN0096    WSLQDT           ILL Unused Date
     C                     Z-ADDWN0097    WSNBR            ILL Unused Nbr
     C                     MOVELWN0098    WSYTCD           ILL Customer Co
     C                     MOVEL'A'       WSAMSX           ILL Status
     C                     MOVELWN0100    WSASSX           ILL Unused Sts
     C                     MOVELWN0101    WSATSX           ILL Unused Sts
     C                     MOVELWN0102    WSAUSX           ILL Unused Sts
     C                     MOVELWN0103    WSYSCD           Inv Hold Reason
     C                     MOVELWN0104    WSUVST           EDI Status 1
     C                     MOVELWN0105    WSUWST           EDI Status 2
     C                     MOVELWN0106    WSUXST           EDI Status 3
     C                     MOVELWN0107    WSVSST           Record Status
     C                     Z-ADDWN0108    WSAATM           Job Time
     C                     MOVELWN0109    WSAYNA           User Id
     C                     MOVELWN0110    WSA0NA           Job Name
     C                     Z-ADDWN0111    WSAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WSVSST           Record Status
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
     C           KLCRSY    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSLXNM           Lot Number
     C                     KFLD           WSYMCD           Location Code
     C                     KFLD           WSYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRSY    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * PFS Chg Qty/Wgt OnHnd CH - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0114 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0115  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0116  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0117 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0118  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0119  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0120  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0121  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0122  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0123  1        ILL Status
     C                     MOVEL*BLANK    WN0124  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0125  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0126  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0127  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0128  1        EDI Status 1
     C                     MOVEL*BLANK    WN0129  1        EDI Status 2
     C                     MOVEL*BLANK    WN0130  1        EDI Status 3
     C                     MOVEL*BLANK    WN0131  1        Record Status
     C                     Z-ADD*ZERO     WN0132  60       Job Time
     C                     MOVEL*BLANK    WN0133 10        User Id
     C                     MOVEL*BLANK    WN0134 10        Job Name
     C                     Z-ADD*ZERO     WN0135  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWWAIC3    WSAIC3           Company Number
     C                     Z-ADDWWHGCD    WSHGCD           Item Code
     C                     MOVELWWAJCD    WSAJCD    P      Warehouse Code
     C                     Z-ADDWWELDT    WSELDT           Production Date
     C                     Z-ADDWWLXNM    WSLXNM           Lot Number
     C                     MOVELWWYMCD    WSYMCD    P      Location Code
     C                     Z-ADDWWYNCD    WSYNCD           Location Level
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSLXNM           Lot Number
     C                     KFLD           WSYMCD           Location Code
     C                     KFLD           WSYNCD           Location Level
     C           KLCHSZ    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YARDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWN0088    WSJ2QT           ILL Item Qty On
     C                     Z-ADDWN0091    WSG6WG           ILl Item Wgt On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQTA01           Company Number
     C           *LIKE     DEFN WXHGCD    WQTA02           Item Code
     C           *LIKE     DEFN WXAJCD    WQTA03           Warehouse Code
     C           *LIKE     DEFN WXLTRT    WQTA04           LLT Trans Type
     C           *LIKE     DEFN WXLRDT    WQTA05           LLT Trans Date
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Item Code
     C                     KFLD           WQTA03           Warehouse Code
     C                     KFLD           WQTA04           LLT Trans Type
     C                     KFLD           WQTA05           LLT Trans Date
      * Setup key
     C                     Z-ADDWL0142    WQTA01           Company Number
     C                     Z-ADDWL0143    WQTA02           Item Code
     C                     MOVELWL0144    WQTA03           Warehouse Code
     C                     MOVELWL0145    WQTA04           LLT Trans Type
     C                     Z-ADDWL0146    WQTA05           LLT Trans Date
      * Establish starting position
     C           KRSTA     SETLL@L7CPUK                    *
     C           KRSTA     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0147           LLT Sequence #
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WXLLTS    ADD  1         WL0147           LLT Sequence #
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0148    WYAIC3           Company Number
     C                     Z-ADDWL0149    WYHGCD           Item Code
     C                     MOVELWL0150    WYAJCD           Warehouse Code
     C                     MOVELWL0151    WYLTRT           LLT Trans Type
     C                     Z-ADDWL0152    WYLRDT           LLT Trans Date
     C                     Z-ADDWL0153    WYLLTS           LLT Sequence #
     C                     Z-ADDWL0154    WYLSDT           LLT Production
     C                     Z-ADDWL0155    WYJ5QT           LLT Trans Qty
     C                     Z-ADDWL0156    WYG8WG           LLT Trans Wgt
     C                     Z-ADDWL0157    WYLLTN           LLT Lot Number
     C                     MOVELWL0158    WYYMCD           Location Code
     C                     Z-ADDWL0159    WYLLCL           LLT Location Le
     C                     MOVELWL0160    WYBNAA           Transfer Wareho
     C                     Z-ADDWL0161    WYLLTR           LLT Transfer Lo
     C                     MOVELWL0162    WYY2CD           Transfer Locati
     C                     Z-ADDWL0163    WYLLTL           LLT Transfer Lo
     C                     Z-ADDWL0164    WYC4NB           Order Number
     C                     MOVELWL0165    WYLOST           LLT Status
     C                     MOVELWL0166    WYLLTU           LTT Unused Sts
     C                     MOVELWL0167    WYLLYT           LTT Unused Sts
     C                     MOVELWL0168    WYUVST           EDI Status 1
     C                     MOVELWL0169    WYUWST           EDI Status 2
     C                     MOVELWL0170    WYUXST           EDI Status 3
     C                     MOVELWL0171    WYVSST           Record Status
     C                     Z-ADDWL0172    WYAATM           Job Time
     C                     MOVELWL0173    WYAYNA           User Id
     C                     MOVELWL0174    WYA0NA           Job Name
     C                     Z-ADDWL0175    WYAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WYVSST           Record Status
     C                     Z-ADD##JTM     WYAATM           Job Time
     C                     MOVEL##USR     WYAYNA           User Id
     C                     MOVEL##JOB     WYA0NA           Job Name
     C                     Z-ADD##JDT     WYAXDT           Job Date
     C           KLCRTB    KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYHGCD           Item Code
     C                     KFLD           WYAJCD           Warehouse Code
     C                     KFLD           WYLTRT           LLT Trans Type
     C                     KFLD           WYLRDT           LLT Trans Date
     C                     KFLD           WYLLTS           LLT Sequence #
      * Check for duplicate primary key
     C           KLCRTB    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Crt Item Balance Dtl  RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAHGCD           Item Code
     C                     KFLD           TAAJCD           Warehouse Code
     C                     KFLD           TAELDT           Production Date
      * Setup key
     C                     Z-ADDWL0176    TAAIC3           Company Number
     C                     Z-ADDWL0177    TAHGCD           Item Code
     C                     MOVELWL0178    TAAJCD           Warehouse Code
     C                     Z-ADDWL0179    TAELDT           Production Date
      * Establish starting position
     C           KRSTC     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
     C                     EXSR TDRVGN
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     EXSR TECRRC
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0176    WOAIC3           Company Number
     C                     Z-ADDWL0177    WOHGCD           Item Code
      * Establish starting position
     C           KRSTD     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWORINB    YL0015           Item Structure
     C                     Z-ADDWORHNB    YL0016           Item Structure
     C                     Z-ADDWORGNB    YL0017           Item Structure
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0154  60       Job Time
     C                     MOVEL*BLANK    WN0155 10        User Id
     C                     MOVEL*BLANK    WN0156 10        Job Name
     C                     Z-ADD*ZERO     WN0157  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0176    TBAIC3           Company Number
     C                     Z-ADDWL0177    TBHGCD           Item Code
     C                     MOVELWL0178    TBAJCD           Warehouse Code
     C                     Z-ADDWL0179    TBELDT           Production Date
     C                     Z-ADD*ZERO     TBABWG           Physical Count
     C                     Z-ADD*ZERO     TBAGQT           Physical Count
     C                     Z-ADD*ZERO     TBAHQT           Physical Count
     C                     Z-ADD*ZERO     TBAIQT           Physical Count
     C                     MOVEL*BLANK    TBCTST           Physical Count
     C                     Z-ADD*ZERO     TBACWG           Quantity on Han
     C                     Z-ADD*ZERO     TBARQT           Quantity on Han
     C                     Z-ADD*ZERO     TBASQT           Quantity on Han
     C                     Z-ADD*ZERO     TBATQT           Quantity on Han
     C                     Z-ADD*ZERO     TBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     TBHEQT           Weight In Chill
     C                     MOVELWUF6ST    TBF6ST           Update Exceptio
     C                     Z-ADD*ZERO     TBBMWG           Physical Start
     C                     Z-ADD*ZERO     TBDSQT           Physical Start
     C                     Z-ADD*ZERO     TBDTQT           Physical Start
     C                     Z-ADD*ZERO     TBDUQT           Physical Start
     C                     Z-ADD*ZERO     TBDHDT           Physical Start
     C                     Z-ADD*ZERO     TBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     TBAECS           Last Cost
     C                     Z-ADD*ZERO     TBIDVA           Value of On Han
     C                     Z-ADD*ZERO     TBK7DT           Label Date
     C                     Z-ADDYL0015    TBRINB           Item Structure
     C                     Z-ADDYL0016    TBRHNB           Item Structure
     C                     Z-ADDYL0017    TBRGNB           Item Structure
     C                     MOVELWUUVST    TBUVST           EDI Status 1
     C                     MOVELWUUWST    TBUWST           EDI Status 2
     C                     MOVELWUUXST    TBUXST           EDI Status 3
     C                     MOVEL'A'       TBVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TBAATM           Job Time
     C                     MOVEL##USR     TBAYNA           User Id
     C                     MOVEL##JOB     TBA0NA           Job Name
     C                     Z-ADD##JDT     TBAXDT           Job Date
     C           KLCRTE    KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBHGCD           Item Code
     C                     KFLD           TBAJCD           Warehouse Code
     C                     KFLD           TBELDT           Production Date
      * Check for duplicate primary key
     C           KLCRTE    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * PFS Upd Warehouse     RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQTF01           Company Number
     C           *LIKE     DEFN WJPFNX    WQTF02           PT Serial Numbe
     C           *LIKE     DEFN WJADDX    WQTF03           PT Label Date Y
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Company Number
     C                     KFLD           WQTF02           PT Serial Numbe
     C                     KFLD           WQTF03           PT Label Date Y
      * Setup key
     C                     Z-ADDWN0002    WQTF01           Company Number
     C                     Z-ADDWN0026    WQTF02           PT Serial Numbe
     C                     Z-ADDWN0042    WQTF03           PT Label Date Y
      * Establish starting position
     C           KRSTF     SETLL@B2CPT3                    *
     C           KRSTF     READE@B2CPT3                  90*
      * Data record not found
     C   90                MOVEL'USR3144' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.PT Warehouse ID Code NE DB1.PT Warehouse ID Code
     C           WN0034    IFNE WJDNAA                     *IF
      * Chg Warehouse Code    CH - Product Trace  * 
     C                     EXSR TGCHRC
     C                     END                             *FI
     C           KRSTF     READE@B2CPT3                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * Chg Warehouse Code    CH - Product Trace  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0158  80       PT Label Date Y
     C                     Z-ADD*ZERO     WN0159  80       PT Offset Prod
     C                     Z-ADD*ZERO     WN0160  60       PT Offset Prod
     C                     MOVEL*BLANK    WN0161  1        PT Inventory St
     C                     Z-ADD*ZERO     WN0162  51       PT Net Weight
     C                     Z-ADD*ZERO     WN0163  51       PT Gross Weight
     C                     MOVEL*BLANK    WN0164  1        PT Shift Number
     C                     Z-ADD*ZERO     WN0165  70       PT Order Number
     C                     MOVEL*BLANK    WN0166 10        PT Pallet Numbe
     C                     Z-ADD*ZERO     WN0167  70       PT Product Code
     C                     MOVEL*BLANK    WN0168 32        PT Item Label L
     C                     MOVEL*BLANK    WN0169 32        PT Item Label L
     C                     MOVEL*BLANK    WN0170  2        PT Fresh/Frozen
     C                     MOVEL*BLANK    WN0171  9        PT Item Picture
     C                     Z-ADD*ZERO     WN0172  50       PT Tattoo Numbe
     C                     MOVEL*BLANK    WN0173  1        PT Source Type
     C                     MOVEL*BLANK    WN0174  3        PT Source Code
     C                     MOVEL*BLANK    WN0175 25        PT Source Code
     C                     MOVEL*BLANK    WN0176  5        PT Producer/Cel
     C                     MOVEL*BLANK    WN0177 25        PT Producer/Cel
     C                     MOVEL*BLANK    WN0178  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0179  6        PT Producer Loc
     C                     MOVEL*BLANK    WN0180 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0181 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0182  2        PT Producer/Far
     C                     MOVEL*BLANK    WN0183 20        PT Producer/Far
     C                     MOVEL*BLANK    WN0184  5        PT Genetic Code
     C                     MOVEL*BLANK    WN0185 25        PT Genetic Desc
     C                     MOVEL*BLANK    WN0186  1        PT Gender Code
     C                     MOVEL*BLANK    WN0187  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0188  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0189  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0190  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0191  3        PT Item Type Co
     C                     Z-ADD*ZERO     WN0192  30       PT Item Str Cla
     C                     Z-ADD*ZERO     WN0193  30       PT Item Str Gro
     C                     Z-ADD*ZERO     WN0194  30       PT Item Str Typ
     C                     Z-ADD*ZERO     WN0195  80       PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WN0196  60       PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0197  1        PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0198  1        PT WIP Used/Not
     C                     Z-ADD*ZERO     WN0199  80       PT From FG Seri
     C                     Z-ADD*ZERO     WN0200  80       PT To FG Serial
     C                     Z-ADD*ZERO     WN0201  80       PT Unused Nbr 3
     C                     Z-ADD*ZERO     WN0202  70       PT Unused Nbr 4
     C                     MOVEL*BLANK    WN0203  1        PT Incl in Prod
     C                     MOVEL*BLANK    WN0204  1        PT Unused Sts 4
     C                     Z-ADD*ZERO     WN0205  60       Job Time
     C                     MOVEL*BLANK    WN0206 10        User Id
     C                     MOVEL*BLANK    WN0207 10        Job Name
     C                     Z-ADD*ZERO     WN0208  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B2CPMP
     C                     Z-ADDWJAIC3    WRAIC3           Company Number
     C                     Z-ADDWJPFNX    WRPFNX           PT Serial Numbe
     C                     Z-ADDWJAADX    WRAADX           PT Prod Date YY
     C                     Z-ADDWJB9TM    WRB9TM           PT Production T
      *
     C           KLCHTG    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRPFNX           PT Serial Numbe
     C                     KFLD           WRAADX           PT Prod Date YY
     C                     KFLD           WRB9TM           PT Production T
     C           KLCHTG    CHAIN@B2CPMP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB2CPL0'MDACP
     C                     MOVEL'@B2CPMP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB21    YBRDCS
      * Move non-key fields to @B2CPMP
     C                     MOVELWN0034    WRDNAA    P      PT Warehouse ID
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB21    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B2CPMP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Upd Location Hold PFS RT - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWHGCD           Item Code
     C                     KFLD           WWAJCD           Warehouse Code
     C                     KFLD           WWELDT           Production Date
     C                     KFLD           WWLXNM           Lot Number
     C                     KFLD           WWYMCD           Location Code
     C                     KFLD           WWYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0180    WWAIC3           Company Number
     C                     Z-ADDWL0181    WWHGCD           Item Code
     C                     MOVELWL0182    WWAJCD           Warehouse Code
     C                     Z-ADDWL0183    WWELDT           Production Date
     C                     Z-ADDWL0184    WWLXNM           Lot Number
     C                     MOVELWL0185    WWYMCD           Location Code
     C                     Z-ADDWL0186    WWYNCD           Location Level
      * Establish starting position
     C           KRSTH     CHAIN@L5CPSV              90    *
      * Data record not found
     C   90                MOVEL'USR2634' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Location Hold PFS CH - Item Lot Location  * 
     C                     EXSR TICHRC
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg Location Hold PFS CH - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0209  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0210 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0211  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0212 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0213  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0214 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0215  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0216  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0217  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0218  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0219  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0220  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0221  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0222  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0223  1        EDI Status 1
     C                     MOVEL*BLANK    WN0224  1        EDI Status 2
     C                     MOVEL*BLANK    WN0225  1        EDI Status 3
     C                     MOVEL*BLANK    WN0226  1        Record Status
     C                     Z-ADD*ZERO     WN0227  60       Job Time
     C                     MOVEL*BLANK    WN0228 10        User Id
     C                     MOVEL*BLANK    WN0229 10        Job Name
     C                     Z-ADD*ZERO     WN0230  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWWAIC3    WSAIC3           Company Number
     C                     Z-ADDWWHGCD    WSHGCD           Item Code
     C                     MOVELWWAJCD    WSAJCD    P      Warehouse Code
     C                     Z-ADDWWELDT    WSELDT           Production Date
     C                     Z-ADDWWLXNM    WSLXNM           Lot Number
     C                     MOVELWWYMCD    WSYMCD    P      Location Code
     C                     Z-ADDWWYNCD    WSYNCD           Location Level
      *
     C           KLCHTI    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSLXNM           Lot Number
     C                     KFLD           WSYMCD           Location Code
     C                     KFLD           WSYNCD           Location Level
     C           KLCHTI    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YCRDCS
      * Move non-key fields to @L5CPSL
     C                     MOVELWL0187    WSAMSX    P      ILL Status
     C                     MOVELWL0188    WSYSCD    P      Inv Hold Reason
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TCAIC3    WQTJ01           Company Number
     C           *LIKE     DEFN TCC4NB    WQTJ02           Order Number
     C           *LIKE     DEFN TCDPNB    WQTJ03           Order Sequence
     C           *LIKE     DEFN TCUENB    WQTJ04           Order Secondary
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WQTJ02           Order Number
     C                     KFLD           WQTJ03           Order Sequence
     C                     KFLD           WQTJ04           Order Secondary
      * Setup key
     C                     Z-ADDWN0002    WQTJ01           Company Number
     C                     Z-ADDWN0056    WQTJ02           Order Number
     C                     Z-ADDWN0064    WQTJ03           Order Sequence
     C                     Z-ADDWN0065    WQTJ04           Order Secondary
      * Establish starting position
     C           KRSTJ     SETLL@FNCPUW                    *
     C           KRSTJ     READE@FNCPUW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0231           Case Sequence N
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           TCRZNB    ADD  1         WN0231           Case Sequence N
     C                     GOTO TJEXIT                     *QUIT
     C           KRSTJ     READE@FNCPUW                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt Manifest Detail   CR - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FNCPCS
     C                     Z-ADDWN0002    TDAIC3           Company Number
     C                     Z-ADDWN0056    TDC4NB           Order Number
     C                     Z-ADDWN0064    TDDPNB           Order Sequence
     C                     Z-ADDWN0065    TDUENB           Order Secondary
     C                     Z-ADDWN0231    TDRZNB           Case Sequence N
     C                     Z-ADDWABDNY    TDFOQT           Case Quantity
     C                     Z-ADDWAABNY    TDR0NB           Case Weight
     C                     MOVEL*BLANK    TDPMST           Inventory Updat
     C                     Z-ADDWN0023    TDK7DT           Label Date
     C                     Z-ADDWN0026    TDPFNX           PT Serial Numbe
     C                     Z-ADDWN0019    TDHGCD           Item Code
     C                     MOVELWN0012    TDAJCD           Warehouse Code
     C                     Z-ADDWN0020    TDELDT           Production Date
     C                     Z-ADDWABENY    TDN5WG           Manifest Gross
     C                     MOVEL*BLANK    TDRZNA           Manifest Lot ID
     C                     Z-ADDWAZ9NX    TDH5NY           Manifest Total
     C                     Z-ADDWAALNY    TDH6NY           Manifest Co-Par
     C                     Z-ADDWAAGNY    TDH7NY           Manifest Pallet
     C                     MOVELWAVKSX    TDGBTX           Manifest Shift
     C                     Z-ADD*ZERO     TDN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     TDN7WG           Manifest Unused
     C                     MOVELWUGCTX    TDGCTX           Manifest Unused
     C                     MOVELWUGDTX    TDGDTX           Manifest Unused
     C                     Z-ADD*ZERO     TDRBDT           Manifest Unused
     C                     Z-ADD*ZERO     TDITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     TDIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     TDIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     TDIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     TDIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     TDIYNY           HPB Density Ref
     C                     MOVELWN0232    TDUVST           EDI Status 1
     C                     MOVELWN0233    TDUWST           EDI Status 2
     C                     MOVELWN0234    TDUXST           EDI Status 3
     C                     MOVELWN0235    TDVSST           Record Status
     C                     Z-ADDWN0236    TDAATM           Job Time
     C                     MOVELWN0237    TDAYNA           User Id
     C                     MOVELWN0238    TDA0NA           Job Name
     C                     Z-ADDWN0239    TDAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TDVSST           Record Status
     C                     Z-ADD##JTM     TDAATM           Job Time
     C                     MOVEL##USR     TDAYNA           User Id
     C                     MOVEL##JOB     TDA0NA           Job Name
     C                     Z-ADD##JDT     TDAXDT           Job Date
     C           KLCRTK    KLIST
     C                     KFLD           TDAIC3           Company Number
     C                     KFLD           TDC4NB           Order Number
     C                     KFLD           TDDPNB           Order Sequence
     C                     KFLD           TDUENB           Order Secondary
     C                     KFLD           TDRZNB           Case Sequence N
      * Check for duplicate primary key
     C           KLCRTK    SETLL@FNCPCS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1197' W0RTN   7
      * Send message 'Manifest Detail        EX'
     C                     MOVEL'USR1197' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@FNCPCS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv Next Seq Num      RT - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEAIC3    WQTL01           Company Number
     C           *LIKE     DEFN TEC4NB    WQTL02           Order Number
     C           *LIKE     DEFN TEDPNB    WQTL03           Order Sequence
     C           *LIKE     DEFN TEUENB    WQTL04           Order Secondary
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WQTL02           Order Number
     C                     KFLD           WQTL03           Order Sequence
     C                     KFLD           WQTL04           Order Secondary
      * Setup key
     C                     Z-ADDWN0002    WQTL01           Company Number
     C                     Z-ADDWN0056    WQTL02           Order Number
     C                     Z-ADDWN0064    WQTL03           Order Sequence
     C                     Z-ADDWN0065    WQTL04           Order Secondary
      * Establish starting position
     C           KRSTL     SETLL@L8CPTD                    *
     C           KRSTL     READE@L8CPTD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2640' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0240           Allocation Seq
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           TEALSW    ADD  1         WN0240           Allocation Seq
     C                     GOTO TLEXIT                     *QUIT
     C           KRSTL     READE@L8CPTD                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * Crt Order Inv Alloc   CR - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L8CPSX
     C                     Z-ADDWN0002    TFAIC3           Company Number
     C                     Z-ADDWN0056    TFC4NB           Order Number
     C                     Z-ADDWN0064    TFDPNB           Order Sequence
     C                     Z-ADDWN0065    TFUENB           Order Secondary
     C                     Z-ADDWN0240    TFALSW           Allocation Seq
     C                     Z-ADDWABDNY    TFJ6QT           OIA Alloc/Shipp
     C                     Z-ADDWAABNY    TFG9WG           OIA Alloc/Shipp
     C                     Z-ADD*ZERO     TFJ9QT           OIA Co-Packer L
     C                     Z-ADDWN0026    TFHAWG           OIA Serial Numb
     C                     MOVEL'A'       TFIOSE           OIA Create Sts
     C                     MOVEL*BLANK    TFOIMN           OIA Modified St
     C                     MOVEL'A'       TFSOAS           OIA Allocation
     C                     MOVEL*BLANK    TFARSX           OIA Loc Pick St
     C                     MOVELWUOTUS    TFOTUS           OIA Unused Sts
     C                     MOVELWUOTMP    TFOTMP           OIA Unused Sts
     C                     Z-ADDWN0019    TFHGCD           Item Code
     C                     MOVELWN0012    TFAJCD           Warehouse Code
     C                     Z-ADDWN0020    TFELDT           Production Date
     C                     Z-ADD*ZERO     TFLXNM           Lot Number
     C                     MOVELWN0051    TFYMCD           Location Code
     C                     Z-ADD*ZERO     TFYNCD           Location Level
     C                     MOVELWN0232    TFUVST           EDI Status 1
     C                     MOVELWN0233    TFUWST           EDI Status 2
     C                     MOVELWN0234    TFUXST           EDI Status 3
     C                     MOVELWN0235    TFVSST           Record Status
     C                     Z-ADDWN0236    TFAATM           Job Time
     C                     MOVELWN0237    TFAYNA           User Id
     C                     MOVELWN0238    TFA0NA           Job Name
     C                     Z-ADDWN0239    TFAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TFVSST           Record Status
     C                     Z-ADD##JTM     TFAATM           Job Time
     C                     MOVEL##USR     TFAYNA           User Id
     C                     MOVEL##JOB     TFA0NA           Job Name
     C                     Z-ADD##JDT     TFAXDT           Job Date
     C           KLCRTM    KLIST
     C                     KFLD           TFAIC3           Company Number
     C                     KFLD           TFC4NB           Order Number
     C                     KFLD           TFDPNB           Order Sequence
     C                     KFLD           TFUENB           Order Secondary
     C                     KFLD           TFALSW           Allocation Seq
      * Check for duplicate primary key
     C           KLCRTM    SETLL@L8CPSX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2641' W0RTN   7
      * Send message 'Order Inv Allocation   EX'
     C                     MOVEL'USR2641' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@L8CPSX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * PFS Upd Ord/Inv Sts   RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQTN01           Company Number
     C           *LIKE     DEFN WJPFNX    WQTN02           PT Serial Numbe
     C           *LIKE     DEFN WJADDX    WQTN03           PT Label Date Y
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Company Number
     C                     KFLD           WQTN02           PT Serial Numbe
     C                     KFLD           WQTN03           PT Label Date Y
      * Setup key
     C                     Z-ADDWL0189    WQTN01           Company Number
     C                     Z-ADDWL0190    WQTN02           PT Serial Numbe
     C                     Z-ADDWL0191    WQTN03           PT Label Date Y
      * Establish starting position
     C           KRSTN     SETLL@B2CPT3                    *
     C           KRSTN     READE@B2CPT3                  90*
      * Data record not found
     C   90                MOVEL'USR3144' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Order Number      CH - Product Trace  * 
     C                     EXSR TOCHRC
     C           KRSTN     READE@B2CPT3                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCHRC    BEGSR
      *================================================================
      * Chg Order Number      CH - Product Trace  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0241  80       PT Label Date Y
     C                     Z-ADD*ZERO     WN0242  80       PT Offset Prod
     C                     Z-ADD*ZERO     WN0243  60       PT Offset Prod
     C                     Z-ADD*ZERO     WN0244  51       PT Net Weight
     C                     Z-ADD*ZERO     WN0245  51       PT Gross Weight
     C                     MOVEL*BLANK    WN0246  1        PT Shift Number
     C                     MOVEL*BLANK    WN0247  3        PT Warehouse ID
     C                     MOVEL*BLANK    WN0248 10        PT Pallet Numbe
     C                     Z-ADD*ZERO     WN0249  70       PT Product Code
     C                     MOVEL*BLANK    WN0250 32        PT Item Label L
     C                     MOVEL*BLANK    WN0251 32        PT Item Label L
     C                     MOVEL*BLANK    WN0252  2        PT Fresh/Frozen
     C                     MOVEL*BLANK    WN0253  9        PT Item Picture
     C                     Z-ADD*ZERO     WN0254  50       PT Tattoo Numbe
     C                     MOVEL*BLANK    WN0255  1        PT Source Type
     C                     MOVEL*BLANK    WN0256  3        PT Source Code
     C                     MOVEL*BLANK    WN0257 25        PT Source Code
     C                     MOVEL*BLANK    WN0258  5        PT Producer/Cel
     C                     MOVEL*BLANK    WN0259 25        PT Producer/Cel
     C                     MOVEL*BLANK    WN0260  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0261  6        PT Producer Loc
     C                     MOVEL*BLANK    WN0262 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0263 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0264  2        PT Producer/Far
     C                     MOVEL*BLANK    WN0265 20        PT Producer/Far
     C                     MOVEL*BLANK    WN0266  5        PT Genetic Code
     C                     MOVEL*BLANK    WN0267 25        PT Genetic Desc
     C                     MOVEL*BLANK    WN0268  1        PT Gender Code
     C                     MOVEL*BLANK    WN0269  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0270  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0271  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0272  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0273  3        PT Item Type Co
     C                     Z-ADD*ZERO     WN0274  30       PT Item Str Cla
     C                     Z-ADD*ZERO     WN0275  30       PT Item Str Gro
     C                     Z-ADD*ZERO     WN0276  30       PT Item Str Typ
     C                     Z-ADD*ZERO     WN0277  80       PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WN0278  60       PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0279  1        PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0280  1        PT WIP Used/Not
     C                     Z-ADD*ZERO     WN0281  80       PT From FG Seri
     C                     Z-ADD*ZERO     WN0282  80       PT To FG Serial
     C                     Z-ADD*ZERO     WN0283  80       PT Unused Nbr 3
     C                     Z-ADD*ZERO     WN0284  70       PT Unused Nbr 4
     C                     MOVEL*BLANK    WN0285  1        PT Incl in Prod
     C                     MOVEL*BLANK    WN0286  1        PT Unused Sts 4
     C                     Z-ADD*ZERO     WN0287  60       Job Time
     C                     MOVEL*BLANK    WN0288 10        User Id
     C                     MOVEL*BLANK    WN0289 10        Job Name
     C                     Z-ADD*ZERO     WN0290  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @B2CPMP
     C                     Z-ADDWJAIC3    WRAIC3           Company Number
     C                     Z-ADDWJPFNX    WRPFNX           PT Serial Numbe
     C                     Z-ADDWJAADX    WRAADX           PT Prod Date YY
     C                     Z-ADDWJB9TM    WRB9TM           PT Production T
      *
     C           KLCHTO    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRPFNX           PT Serial Numbe
     C                     KFLD           WRAADX           PT Prod Date YY
     C                     KFLD           WRB9TM           PT Production T
     C           KLCHTO    CHAIN@B2CPMP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB2CPL0'MDACP
     C                     MOVEL'@B2CPMP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB21    YDRDCS
      * Move non-key fields to @B2CPMP
     C                     MOVELWL0192    WRMNSX    P      PT Inventory St
     C                     Z-ADDWL0193    WRPGNX           PT Order Number
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB21    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@B2CPMP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * PFS Del Manifest Dtl  RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQTP01           Company Number
     C           *LIKE     DEFN WHC4NB    WQTP02           Order Number
     C           *LIKE     DEFN WHDPNB    WQTP03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQTP04           Order Secondary
     C           *LIKE     DEFN WHPFNX    WQTP05           PT Serial Numbe
     C           *LIKE     DEFN WHK7DT    WQTP06           Label Date
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Company Number
     C                     KFLD           WQTP02           Order Number
     C                     KFLD           WQTP03           Order Sequence
     C                     KFLD           WQTP04           Order Secondary
     C                     KFLD           WQTP05           PT Serial Numbe
     C                     KFLD           WQTP06           Label Date
      * Setup key
     C                     Z-ADDWN0002    WQTP01           Company Number
     C                     Z-ADDWN0056    WQTP02           Order Number
     C                     Z-ADDWN0064    WQTP03           Order Sequence
     C                     Z-ADDWN0065    WQTP04           Order Secondary
     C                     Z-ADDWN0026    WQTP05           PT Serial Numbe
     C                     Z-ADDWN0023    WQTP06           Label Date
      * Establish starting position
     C           KRSTP     SETLL@FNCPAZ                    *
     C           KRSTP     READE@FNCPAZ                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT OM Manifest Detail DL - Manifest Detail  * 
     C                     EXSR TQDLRC
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
      * PFS Del Order Inv Alc RT - Order Inv Allocation  * 
     C                     EXSR TRRVGN
     C                     END                             *FI
     C           KRSTP     READE@FNCPAZ                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQDLRC    BEGSR
      *================================================================
      * DLT OM Manifest Detail DL - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FNCPCS
     C                     Z-ADDWHAIC3    TDAIC3           Company Number
     C                     Z-ADDWHC4NB    TDC4NB           Order Number
     C                     Z-ADDWHDPNB    TDDPNB           Order Sequence
     C                     Z-ADDWHUENB    TDUENB           Order Secondary
     C                     Z-ADDWHRZNB    TDRZNB           Case Sequence N
      *
     C           KLDLTQ    KLIST
     C                     KFLD           TDAIC3           Company Number
     C                     KFLD           TDC4NB           Order Number
     C                     KFLD           TDDPNB           Order Sequence
     C                     KFLD           TDUENB           Order Secondary
     C                     KFLD           TDRZNB           Case Sequence N
     C           KLDLTQ    CHAIN@FNCPCS              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FNCPCS                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * PFS Del Order Inv Alc RT - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TGAIC3    WQTR01           Company Number
     C           *LIKE     DEFN TGC4NB    WQTR02           Order Number
     C           *LIKE     DEFN TGDPNB    WQTR03           Order Sequence
     C           *LIKE     DEFN TGUENB    WQTR04           Order Secondary
     C           *LIKE     DEFN TGHAWG    WQTR05           OIA Serial Numb
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Company Number
     C                     KFLD           WQTR02           Order Number
     C                     KFLD           WQTR03           Order Sequence
     C                     KFLD           WQTR04           Order Secondary
     C                     KFLD           WQTR05           OIA Serial Numb
      * Setup key
     C                     Z-ADDWHAIC3    WQTR01           Company Number
     C                     Z-ADDWHC4NB    WQTR02           Order Number
     C                     Z-ADDWHDPNB    WQTR03           Order Sequence
     C                     Z-ADDWHUENB    WQTR04           Order Secondary
     C                     Z-ADDWN0026    WQTR05           OIA Serial Numb
      * Establish starting position
     C           KRSTR     SETLL@L8CPDK                    *
     C           KRSTR     READE@L8CPDK                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
     C                     EXSR TSDLRC
     C           KRSTR     READE@L8CPDK                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSDLRC    BEGSR
      *================================================================
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L8CPSX
     C                     Z-ADDTGAIC3    TFAIC3           Company Number
     C                     Z-ADDTGC4NB    TFC4NB           Order Number
     C                     Z-ADDTGDPNB    TFDPNB           Order Sequence
     C                     Z-ADDTGUENB    TFUENB           Order Secondary
     C                     Z-ADDTGALSW    TFALSW           Allocation Seq
      *
     C           KLDLTS    KLIST
     C                     KFLD           TFAIC3           Company Number
     C                     KFLD           TFC4NB           Order Number
     C                     KFLD           TFDPNB           Order Sequence
     C                     KFLD           TFUENB           Order Secondary
     C                     KFLD           TFALSW           Allocation Seq
     C           KLDLTS    CHAIN@L8CPSX              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L8CPSX                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTCHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Inventory Adjustment  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0291  3        PFS Transaction
     C                     MOVEL*BLANK    WN0292  2        PFS Inv Adj Rea
     C                     Z-ADD*ZERO     WN0293  70       PFS Item Code
     C                     MOVEL*BLANK    WN0294  3        PFS Warehouse C
     C                     Z-ADD*ZERO     WN0295  40       PFS Location Co
     C                     MOVEL*BLANK    WN0296 13        PFS Department
     C                     Z-ADD*ZERO     WN0297  80       PFS Production
     C                     Z-ADD*ZERO     WN0298  80       PFS Label Date
     C                     Z-ADD*ZERO     WN0299  80       PFS Receive/Loc
     C                     MOVEL*BLANK    WN0300  1        PFS Shift
     C                     Z-ADD*ZERO     WN0301 100       PFS Serial Numb
     C                     Z-ADD*ZERO     WN0302  10       PFS Tracking Ty
     C                     Z-ADD*ZERO     WN0303  50       PFS Transaction
     C                     Z-ADD*ZERO     WN0304  82       PFS Transaction
     C                     Z-ADD*ZERO     WN0305  82       PFS Transaction
     C                     Z-ADD*ZERO     WN0306  82       PFS Total Tare
     C                     MOVEL*BLANK    WN0307  3        PFS To Warehous
     C                     Z-ADD*ZERO     WN0308  40       PFS To Location
     C                     Z-ADD*ZERO     WN0309  70       PFS Order Numbe
     C                     Z-ADD*ZERO     WN0310  30       PFS Order Line
     C                     Z-ADD*ZERO     WN0311  30       PFS Substitutio
     C                     Z-ADD*ZERO     WN0312  50       PFS Co-Pack Lot
     C                     Z-ADD*ZERO     WN0313  90       PFS Pallet Numb
     C                     MOVEL*BLANK    WN0314  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0315  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0316  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0317  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0318  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BGCPZF
     C                     Z-ADDWAY1NX    THY1NX           PFS Company Num
     C                     Z-ADDWAC0NY    THC0NY           PFS Inv Adj Seq
     C                     Z-ADDWAAID8    THAID8           PFS Transaction
     C                     Z-ADDWAAFTS    THAFTS           PFS Transaction
     C                     Z-ADDWABCNY    THBCNY           PFS Transaction
      *
     C           KLCHTT    KLIST
     C                     KFLD           THY1NX           PFS Company Num
     C                     KFLD           THC0NY           PFS Inv Adj Seq
     C                     KFLD           THAID8           PFS Transaction
     C                     KFLD           THAFTS           PFS Transaction
     C                     KFLD           THBCNY           PFS Transaction
     C           KLCHTT    CHAIN@BGCPZF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBGCPL0'MDACP
     C                     MOVEL'@BGCPZF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBG1    YERDCS
      * Move non-key fields to @BGCPZF
     C                     Z-ADDWN0009    THUXSX           PFS Process Sta
     C                     MOVELWN0010    THV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     THAJNY           PFS Change Date
     C                     Z-ADD##JTM     THAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BGCPZF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** VALIDATION *****
      *================================================================
     C                     Z-ADDWAY1NX    WN0002           Company Number
     C                     Z-ADDWAY2NX    WN0019           Item Code
     C                     MOVELWAU4SX    WN0012           Warehouse Code
      * VAL:  Transaction Type
      * CASE: DB1.PFS Transaction Type is *ALL values
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'S01'
     C           WAVLSX    OREQ 'S03'
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S04'
     C           WAVLSX    OREQ 'S05'
     C           WAVLSX    OREQ 'I01'
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'F01'
     C           WAVLSX    OREQ 'F02'
     C           WAVLSX    OREQ 'F03'
     C           WAVLSX    OREQ 'F04'
     C           WAVLSX    OREQ 'C01'
     C           WAVLSX    OREQ 'C02'
     C           WAVLSX    OREQ 'C03'
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'B01'
     C           WAVLSX    OREQ 'R01'
     C           WAVLSX    OREQ 'I03'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'W01'
     C           WAVLSX    OREQ 'P05'
     C           WAVLSX    OREQ 'S06'
     C           WAVLSX    OREQ 'S07'
      * UPL: Freezer Transactions
      * CASE: DB1.PFS Transaction Type is Freezer Transactions
     C           WAVLSX    IFEQ 'F03'                      *IF
     C           WAVLSX    OREQ 'F01'
     C           WAVLSX    OREQ 'F04'
     C           WAVLSX    OREQ 'F02'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'FRZTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Inventory Transactions (Insight)
      * CASE: DB1.PFS Transaction Type is Inventory Transactions
     C           WAVLSX    IFEQ 'I01'                      *IF
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'I03'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'INVTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Production Transactions (Informer)
      * CASE: DB1.PFS Transaction Type is Production Transactions
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P05'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'PRDTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Shipping Transactions
      * CASE: DB1.PFS Transaction Type is Shipping Transactions
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S03'
     C           WAVLSX    OREQ 'S05'
     C           WAVLSX    OREQ 'S04'
     C           WAVLSX    OREQ 'S07'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'SHPTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Batch Label Printing
      * CASE: DB1.PFS Transaction Type is Batch Printing
     C           WAVLSX    IFEQ 'B01'                      *IF
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'BTCPRT'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Cycle Count
      * CASE: DB1.PFS Transaction Type is Cycle Count Transactions
     C           WAVLSX    IFEQ 'C02'                      *IF
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'C01'
     C           WAVLSX    OREQ 'C03'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'CYCTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Warehouse Transfer
      * CASE: DB1.PFS Transaction Type is WT: Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'WHSTFR'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'TRNTYP'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Production Transaction Tracking Type
      * CASE: DB1.PFS Transaction Type is Production Transactions
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P05'
      * CASE: DB1.PFS Tracking Type is Entered
     C           WAZ6NX    IFNE *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'TRKTYP'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * Test Label
      * CASE: DB1.PFS Tracking Type is Test Label
     C           WAZ6NX    IFEQ 5                          *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'TSTLBL'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * Val WHS/Rtv ActCo PFS RT - Warehouse  * 
     C                     EXSR SCRVGN
      * Warehouse Not Found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'WHSCDE'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * Location Code & Receive/Located Date
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
      * CASE: DB1.PFS Transaction Type is BP: Batch Label Print
     C           WAVLSX    IFEQ 'B01'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      * Val Itm/Whs,FG/WP PFS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0005           Company Number
     C                     Z-ADDWN0019    WL0006           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0001    P      Production Date
     C                     Z-ADDWL0008    YN0001           Item Structure
     C                     MOVELWL0009    WN0003    P      Item Type Code
     C                     MOVELWL0010    WN0005    P      Default Warehou
     C                     Z-ADDWL0011    WN0004           Fresh Chilling
     C                     MOVELWL0012    WN0008    P      Primal Group Co
      * Item Code Not Found
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PGM.*Return code is *Record does not exist
      *   |- c2    : PAR.Primal Group Code is Scale Check
      *   '-
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C           WN0008    OREQ 'SCALE'                    *OR
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'ITMCDE'  WN0010           PFS Error Reaso
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL:  WIP Item Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Work In Process
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0003    IFEQ 'FG'                       *IF
     C           WAZ6NX    IFEQ 3                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WAY2NX    ADD  9000000   WN0019           Item Code
      * Val Itm/Whs,FG/WP PFS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0005           Company Number
     C                     Z-ADDWN0019    WL0006           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0001    P      Production Date
     C                     Z-ADDWL0008    YN0001           Item Structure
     C                     MOVELWL0009    WN0003    P      Item Type Code
     C                     MOVELWL0010    WN0005    P      Default Warehou
     C                     Z-ADDWL0011    WN0004           Fresh Chilling
     C                     MOVELWL0012    WN0008    P      Primal Group Co
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'WIPCDE'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Unit Cost Active   RT - Item Balance  * 
     C                     EXSR SERVGN
      * Record not found instead of unit cost check  5.4.6 RMC PFS011
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'ITMBAL'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * Shift Not Entered
      * CASE: DB1.PFS Shift is Not Entered
     C           WAVKSX    IFEQ *BLANK                     *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL*BLANK    WN0010           PFS Error Reaso
     C                     MOVEL'SHIFT'   WN0010           PFS Error Reaso
     C                     END                             *FI
      * 09/08/09 PKD E00475 Use Label Date for Production Date.
      * Label Date Not Entered
      * CASE: PAR.Production Date Control is yes
     C           WN0001    IFEQ 'Y'                        *IF
      * CASE: DB1.PFS Transaction Type is Freezer Transactions
     C           WAVLSX    IFEQ 'F03'                      *IF
     C           WAVLSX    OREQ 'F01'
     C           WAVLSX    OREQ 'F04'
     C           WAVLSX    OREQ 'F02'
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.PFS Label Date is Not Entered
     C           WAZ4NX    IFEQ *ZERO                      *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'LBLDTE'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 09/08/09 PKD E00475 Use Label Date for Production Date.
      * Production & Label Date
      * CASE: PAR.Production Date Control is yes
     C           WN0001    IFEQ 'Y'                        *IF
      * --- Production Date ---
      * Convert Production Date
      * CASE: DB1.PFS Production Date is Entered
     C           WAP7DT    IFNE *ZERO                      *IF
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0068  40       Year Code
     C                     Z-ADD*ZERO     WN0069  20       Month
     C                     Z-ADD*ZERO     WN0070  20       Day of Month US
     C                     MOVEL*BLANK    WN0071  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0072  2        Month (Char) US
     C                     MOVEL*BLANK    WN0073  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0074  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0075  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0076  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WAP7DT    DIV  10000     WN0068           Year Code
     C                     Z-ADDWN0068    WN0074           Year  NBR USR
     C                     MOVELWN0074    WN0075           Year  (Char) US
      * ** MONTH **
     C           WAP7DT    DIV  100       WN0069           Month
     C                     MOVELWN0069    WN0072           Month (Char) US
      * ** DAY **
     C                     Z-ADDWAP7DT    WN0070           Day of Month US
     C                     MOVELWN0070    WN0073           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0068    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0075:ZQ WN0076    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0075:ZQ WN0076    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0076    CAT  WN0072:ZQ WN0076    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0076    CAT  WN0073:ZQ WN0076    P      Date (Alpha) US
     C                     MOVE WN0076    WN0020           Date
     C                     END                             *FI
      * --- Label Date ---
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0077  40       Year Code
     C                     Z-ADD*ZERO     WN0078  20       Month
     C                     Z-ADD*ZERO     WN0079  20       Day of Month US
     C                     MOVEL*BLANK    WN0080  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0081  2        Month (Char) US
     C                     MOVEL*BLANK    WN0082  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0083  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0084  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0085  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WAZ4NX    DIV  10000     WN0077           Year Code
     C                     Z-ADDWN0077    WN0083           Year  NBR USR
     C                     MOVELWN0083    WN0084           Year  (Char) US
      * ** MONTH **
     C           WAZ4NX    DIV  100       WN0078           Month
     C                     MOVELWN0078    WN0081           Month (Char) US
      * ** DAY **
     C                     Z-ADDWAZ4NX    WN0079           Day of Month US
     C                     MOVELWN0079    WN0082           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0077    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0084:ZQ WN0085    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0084:ZQ WN0085    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0085    CAT  WN0081:ZQ WN0085    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0085    CAT  WN0082:ZQ WN0085    P      Date (Alpha) US
     C                     MOVE WN0085    WN0023           Date
      * INIT: Production Date Not Entered
      * CASE: DB1.PFS Production Date is Not Entered
     C           WAP7DT    IFEQ *ZERO                      *IF
     C                     Z-ADDWN0023    WN0020           Production Date
     C                     END                             *FI
      * INIT: Label Date Not Entered
      * CASE: DB1.PFS Label Date is Not Entered
     C           WAZ4NX    IFEQ *ZERO                      *IF
     C                     Z-ADDWN0020    WN0023           Label Date
     C                     END                             *FI
      * 09/08/09 PKD E00475 Use Label Date for Production Date.
     C                     Z-ADDWN0023    WN0020           Production Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0020           Production Date
     C                     Z-ADD*ZERO     WN0023           Label Date
     C                     END                             *FI
      * VAL:  SM: Ship Regular Order, Ship Transfer Order, Unship
      * CASE: Order Shipping
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.PFS Transaction Type is SM: Ship Regular Order
      *   |- c2    : DB1.PFS Transaction Type is SM: Transfer Order
      *   |- c3    : DB1.PFS Transaction Type is SM: UnShip Reg/Tfr Ord
      *   '-
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'                      *OR
     C           WAVLSX    OREQ 'S03'                      *OR
     C                     Z-ADDWAZPNX    WN0056           Order Number
      * RTV Order Info PFS    RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * VAL:  Order Number
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'ORDNUM'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * ***  Performing no validation of Order Status at this time.
      *      The Shipping Upload will confirm the total are the same
      *      between Manifest Detail and PFS Ship Order Detail.
      * Get 1st not cancelled line item's whse    3/30/06 RMC
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SGRVGN
      * VAL:  Warehouse
      * CASE: LCL.Warehouse Code NE DB1.PFS Warehouse Code
     C           YL0003    IFNE WAU4SX                     *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'ORDWHS'  WN0010           PFS Error Reaso
      * CASE: PAR.Warehouse Code is Warehouse Code Blank
     C           WN0012    IFEQ *BLANK                     *IF
      * PFS Val Dup Serial#   RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0013           Company Number
     C                     Z-ADDWN0056    WL0014           Order Number
     C                     Z-ADDWN0064    WL0015           Order Sequence
     C                     Z-ADDWN0065    WL0016           Order Secondary
     C                     Z-ADDWAZ2NX    WL0017           PT Serial Numbe
     C                     Z-ADDWN0023    WL0018           Label Date
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    YL0004    P      Record Found US
      * DUPLICATE CASE FOUND
      * CASE: LCL.Record Found USR is Record Found
     C           YL0004    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WN0056    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWN0056    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADDWAZ2NX    ZA0002           PFS Serial Numb
      * Retrieve message PFS Dup Case Manifested
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3596' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0005    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0020           Company Number
     C                     MOVEL@CN,01    WL0021    P      Company Value C
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    YL0006    P      System Value Al
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM YL0006    WQ0001 10        DL List ID
     C                     PARM YL0005    WQ0002132        Office Message
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * If not duplicate, then move Order's Warehouse for processing
     C                     MOVELYL0003    WN0012           Warehouse Code
     C                     Z-ADD*ZERO     WN0009           PFS Process Sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  SM: Transfer Order - Transfer To Warehouse
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Transaction Type is SM: Transfer Order
      *   |- c2    : PAR.Order Type - Sales is Transfer Order
      *   '-
     C           WAVLSX    IFEQ 'S02'                      *IF
     C           WN0058    OREQ 'TR'                       *OR
      * CASE: DB1.PFS To Warehouse Code is Not Entered
     C           WAGBAA    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse PFS     RT - Warehouse  * 
     C                     EXSR SKRVGN
      * Warehouse Not Found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'TFRWHS'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * Location Code
      * CASE: LCL.Lot Tracking Flag is yes
     C           YL0007    IFEQ 'Y'                        *IF
      * Location Code
      * CASE: DB1.PFS To Location Code is Not Entered
     C           WAANNY    IFEQ *ZERO                      *IF
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Warehouse Transfer To Warehouse
      * CASE: DB1.PFS Transaction Type is WT: Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
      * CASE: DB1.PFS To Warehouse Code is Not Entered
     C           WAGBAA    IFEQ *BLANK                     *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'TFRWHS'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Production - duplicate case
      * CASE: DB1.PFS Transaction Type is PM: Production
     C           WAVLSX    IFEQ 'P01'                      *IF
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
      * Val Prod Trc P01 rcd  RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0023           Company Number
     C                     Z-ADDWN0026    WL0024           PT Serial Numbe
     C                     Z-ADDWAZ4NX    WL0025           PT Label Date Y
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'DUPCSE'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Production P02 Issue- duplicate case   new RMC 4/13/06
      * CASE: DB1.PFS Transaction Type is PM: Issue
     C           WAVLSX    IFEQ 'P02'                      *IF
      * Val DupCase for Issue RT - PFS Inventory Adjustment  * 
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'DUPCSE'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  ACTIVE TRANSACTION TYPES
     C                     EXSR UBSUBR                     VAL:  ACTIVE TR
      * 10/20/06 PKD Changed to use WHS PFS Interface
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
     C                     EXSR SNRVGN
      * VAL:  ACTIVE WAREHOUSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : PAR.Warehouse Code is Warehouse Code not Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFEQ 'Y'                        *IF
     C           WN0012    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 10/20/06 PKD added the following condition
      * CASE: LCL.WHS PFS Interface is Upload/Both
     C           YL0009    IFEQ 'U'                        *IF
     C           YL0009    OREQ 'B'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * ERROR:  DO NOT SELECT RECORD
      * CASE: PAR.PFS Process Status is Error
     C           WN0009    IFEQ 2                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * Non Ship Transactions
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.PFS Inv Adj Prc Ship USR is Process Not Ship Tra
      *   |- c2    : DB1.PFS Transaction Type is Shipping Non Return Tran
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1XASX    IFEQ *BLANK                     *IF
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Ship Transactions
      * CASE: PAR.PFS Inv Adj Prc Ship USR is Process Ship Trans
     C           P1XASX    IFEQ 'S'                        *IF
      * CASE: DB1.PFS Transaction Type is Not Shipping Trans
     C           WAVLSX    IFEQ 'B01'                      *IF
     C           WAVLSX    OREQ 'C02'
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'C01'
     C           WAVLSX    OREQ 'C03'
     C           WAVLSX    OREQ 'F03'
     C           WAVLSX    OREQ 'F01'
     C           WAVLSX    OREQ 'F04'
     C           WAVLSX    OREQ 'F02'
     C           WAVLSX    OREQ 'I01'
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'R01'
     C           WAVLSX    OREQ 'P04'
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'I03'
     C           WAVLSX    OREQ 'P05'
     C           WAVLSX    OREQ 'S04'
     C           WAVLSX    OREQ 'S07'
     C           WAVLSX    OREQ 'S05'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.PFS Order Number NE PAR.PFS Order Number
     C           WAZPNX    IFNE P2ZPNX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * VAL:  ACTIVE TRANSACTION TYPES
      *================================================================
      * UPL: Freezer Transactions
      * CASE: DB1.PFS Transaction Type is Freezer Transactions
     C           WAVLSX    IFEQ 'F03'                      *IF
     C           WAVLSX    OREQ 'F01'
     C           WAVLSX    OREQ 'F04'
     C           WAVLSX    OREQ 'F02'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'FRZTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Inventory Transactions (Insight)
      * CASE: DB1.PFS Transaction Type is Inventory Transactions
     C           WAVLSX    IFEQ 'I01'                      *IF
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'I03'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'INVTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Production Transactions (Informer)
      * CASE: DB1.PFS Transaction Type is Production Transactions
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P05'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'PRDTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Shipping Transactions
      * CASE: DB1.PFS Transaction Type is Shipping Transactions
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S03'
     C           WAVLSX    OREQ 'S05'
     C           WAVLSX    OREQ 'S04'
     C           WAVLSX    OREQ 'S07'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'SHPTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Batch Label Printing
      * CASE: DB1.PFS Transaction Type is Batch Printing
     C           WAVLSX    IFEQ 'B01'                      *IF
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'BTCPRT'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Cycle Count
      * CASE: DB1.PFS Transaction Type is Cycle Count Transactions
     C           WAVLSX    IFEQ 'C02'                      *IF
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'C01'
     C           WAVLSX    OREQ 'C03'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'CYCTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Initialize
      *================================================================
     C                     Z-ADDWN0019    WN0024           Partial Item Co
      * --- Transaction Date ---
     C                     Z-ADD##JDT     WN0017           Transaction Dat
      * ------------------------
      * 02/17/09 PKD Moved to the Validate Section
     C                     MOVELWAVKSX    WN0022           Shift Number
     C                     Z-ADDWABDNY    WN0015           Transaction Qua
     C                     Z-ADDWAABNY    WN0016           Transaction Wei
      * LOT TRACKING WAREHOUES
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
      * 12/16/08 PKD A decision was made to use Production Date instead
      *              of Receive/Locate Date.  This Date is not valid in
      *              Carlisle sometimes.
      * ----- Receive/Located Date -----
      * ----- Location Code -----
     C                     MOVELWAADNY    WN0051           Location Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANKS   WN0051           Location Code
     C                     END                             *FI
      * Ship/Unship Order
      * CASE: DB1.PFS Transaction Type is Ship/Unship Order
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S03'
     C                     Z-ADDWAZPNX    WN0056           Order Number
     C                     Z-ADDWAZXNX    WN0064           Order Sequence
     C                     Z-ADD1         WN0065           Order Secondary
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XTAD1     BEGSR
      *================================================================
      * Add TME to absolute time (seconds)
      *================================================================
     C           XTHH      MULT 3600      XDWK1   80
     C                     ADD  XDWK1     XASC
     C           XTNN      MULT 60        XDWK1
     C                     ADD  XDWK1     XASC
     C                     ADD  XTSS      XASC
      *================================================================
     CSR         XTAD1E    ENDSR
      /EJECT
     CSR         XTCT1     BEGSR
      *================================================================
      * Convert absolute time (seconds) to TME
      *================================================================
     C                     EXSR XTFCT
     C           XASC      DIV  60        XASC
     C                     MVR            XTSS
     C           XASC      DIV  60        XASC
     C                     MVR            XTNN
     C                     Z-ADDXASC      XTHH
      *================================================================
     CSR         XTCT1E    ENDSR
      /EJECT
     CSR         XTFCT     BEGSR
      *================================================================
      * Factorize absolute date (seconds) by 24 hours
      *================================================================
     C           XASC      IFGE 86400
     C                     DIV  86400     XASC    80
     C                     MVR            XASC
     C                     ELSE
     C           XASC      IFLE *ZERO
     C                     DIV  86400     XASC
     C                     MVR            XASC
     C           XASC      IFNE *ZERO
     C                     ADD  86400     XASC
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         XTFCTE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAC0NY           PFS Inv Adj Seq
     C                     Z-ADD*ZERO     WAAID8           PFS Transaction
     C                     Z-ADD*ZERO     WAAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WABCNY           PFS Transaction
     C                     Z-ADD*ZERO     WAY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WAADNY           PFS Location Co
     C                     Z-ADD*ZERO     WAP7DT           PFS Production
     C                     Z-ADD*ZERO     WAZ4NX           PFS Label Date
     C                     Z-ADD*ZERO     WAACNY           PFS Receive/Loc
     C                     Z-ADD*ZERO     WAZ2NX           PFS Serial Numb
     C                     Z-ADD*ZERO     WAZ6NX           PFS Tracking Ty
     C                     Z-ADD*ZERO     WABDNY           PFS Transaction
     C                     Z-ADD*ZERO     WAABNY           PFS Transaction
     C                     Z-ADD*ZERO     WABENY           PFS Transaction
     C                     Z-ADD*ZERO     WAZ9NX           PFS Total Tare
     C                     Z-ADD*ZERO     WAANNY           PFS To Location
     C                     Z-ADD*ZERO     WAZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WAZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WAZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     WAALNY           PFS Co-Pack Lot
     C                     Z-ADD*ZERO     WAAGNY           PFS Pallet Numb
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WBQEDT           PFS Last Update
     C                     Z-ADD*ZERO     WBCUTM           PFS Last Update
     C                     Z-ADD*ZERO     WBB0NY           PFS Hours Betwe
     C                     Z-ADD*ZERO     WBB1NY           PFS Minutes Btw
     C                     Z-ADD*ZERO     WBUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WBAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WBAINY           PFS Create Time
     C                     Z-ADD*ZERO     WBAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WBAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAIWG           Unit Weight
     C                     Z-ADD*ZERO     WDCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WDC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WDURTN           Number Cases On
     C                     Z-ADD*ZERO     WDAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDTFNB           Transportation
     C                     Z-ADD*ZERO     WDTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WDTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WDBLPR           Market Overage
     C                     Z-ADD*ZERO     WDBMPR           Standard Overag
     C                     Z-ADD*ZERO     WDCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WDCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WDSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WDPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WDICN1           Item Category N
     C                     Z-ADD*ZERO     WDICN2           Item Category N
     C                     Z-ADD*ZERO     WDV2NB           Item Category N
     C                     Z-ADD*ZERO     WDITCN           Item Category N
     C                     Z-ADD*ZERO     WDITC5           Item Category N
     C                     Z-ADD*ZERO     WDICN6           Item Category N
     C                     Z-ADD*ZERO     WDICN7           Item Category N
     C                     Z-ADD*ZERO     WDICN8           Item Category N
     C                     Z-ADD*ZERO     WDICN9           Item Category N
     C                     Z-ADD*ZERO     WDICN0           Item Category N
     C                     Z-ADD*ZERO     WDSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WDA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WDSJNB           Production Lead
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WDCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WDILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WDCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WDCINB           PM Batch Size
     C                     Z-ADD*ZERO     WDCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WDCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WDCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WDCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WDCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WDCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WDCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WDCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WDCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WDC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WDB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WDBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WDF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WDF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WDF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WDBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WDBNNB           Production Qty
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAECS           Last Cost
     C                     Z-ADD*ZERO     WEBACS           Cost per Primar
     C                     Z-ADD*ZERO     WEBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WECBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WEGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WECTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WEG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WEBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WEDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WEDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WEDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WEHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WEHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WEAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WEAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WEEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WEDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WEAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WEANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WEIDVA           Value of On Han
     C                     Z-ADD*ZERO     WEBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WEDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WEDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WEBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WEDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WEBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WEDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WEDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WEBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WEDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WEDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WEDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WEDMDT           Last Physical C
     C                     Z-ADD*ZERO     WEAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WFA0DT           Order Date
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFACDT           Cancel Date
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WFA1WG           Order Weight To
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WFRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WFT3NB           Attach to Order
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFAWDT           Invoice Date
     C                     Z-ADD*ZERO     WFVRVA           A/R order Value
     C                     Z-ADD*ZERO     WFB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WFNODT           OH Unused Date
     C                     Z-ADD*ZERO     WFNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WFNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WFNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WFNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WFBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WFBQTM           Time of Origina
     C                     Z-ADD*ZERO     WFBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WFBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WFBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WFH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WFH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WFH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WFH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WFH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WFC0C7           Claim Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WGMAVA           Billing Detail
     C                     Z-ADD*ZERO     WGKDVA           Billing Detail
     C                     Z-ADD*ZERO     WGL8VA           Billing Detail
     C                     Z-ADD*ZERO     WGL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGEXDT           Market Pricing
     C                     Z-ADD*ZERO     WGBZPR           Price Overage O
     C                     Z-ADD*ZERO     WGL6NB           Contract Number
     C                     Z-ADD*ZERO     WGGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WGD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WGCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WGAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WGCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WGATWG           Weight Shipped
     C                     Z-ADD*ZERO     WGAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WGAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WGAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WGA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WGB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WGA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WGNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WGNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WGBXTM           Substitution Li
     C                     Z-ADD*ZERO     WGBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WGH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WGH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WGH7NX           OD Item Target
     C                     Z-ADD*ZERO     WGH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WGH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WGDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WGDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WGDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WGDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WGDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WGGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WGGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WGGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WGPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WGRINY           Item Age Days
     C                     Z-ADD*ZERO     WGTIDT           Production Ovr
     C                     Z-ADD*ZERO     WGTJDT           Production Ovr
     C                     Z-ADD*ZERO     WGTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WGTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WGTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WHFOQT           Case Quantity
     C                     Z-ADD*ZERO     WHR0NB           Case Weight
     C                     Z-ADD*ZERO     WHK7DT           Label Date
     C                     Z-ADD*ZERO     WHPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WHH5NY           Manifest Total
     C                     Z-ADD*ZERO     WHH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WHH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WHN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WHN7WG           Manifest Unused
     C                     Z-ADD*ZERO     WHRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WHITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WHIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WHIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WHIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WHIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WHIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIM8NB           System Value Nu
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WJAADX           PT Prod Date YY
     C                     Z-ADD*ZERO     WJB9TM           PT Production T
     C                     Z-ADD*ZERO     WJADDX           PT Label Date Y
     C                     Z-ADD*ZERO     WJABDX           PT Offset Prod
     C                     Z-ADD*ZERO     WJCATM           PT Offset Prod
     C                     Z-ADD*ZERO     WJJOWG           PT Net Weight
     C                     Z-ADD*ZERO     WJJPWG           PT Gross Weight
     C                     Z-ADD*ZERO     WJPGNX           PT Order Number
     C                     Z-ADD*ZERO     WJD7C7           PT Product Code
     C                     Z-ADD*ZERO     WJPHNX           PT Tattoo Numbe
     C                     Z-ADD*ZERO     WJUFNX           PT Item Str Cla
     C                     Z-ADD*ZERO     WJUGNX           PT Item Str Gro
     C                     Z-ADD*ZERO     WJUHNX           PT Item Str Typ
     C                     Z-ADD*ZERO     WJAGDX           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WJCGTM           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WJUINX           PT From FG Seri
     C                     Z-ADD*ZERO     WJUJNX           PT To FG Serial
     C                     Z-ADD*ZERO     WJUKNX           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WJULNX           PT Unused Nbr 4
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLPUDT           Effective Label
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMPINX           CS Scale Offset
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Blank 6 USR
     C                     MOVEL*BLANK    WUXKTX  6
      * Define work field ILL Unused Sts 1
     C                     MOVEL*BLANK    WUASSX  1
      * Define work field ILL Unused Sts 2
     C                     MOVEL*BLANK    WUATSX  1
      * Define work field ILL Unused Sts 3
     C                     MOVEL*BLANK    WUAUSX  2
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSHGCD           Item Code
     C                     Z-ADD*ZERO     WSELDT           Production Date
     C                     Z-ADD*ZERO     WSLXNM           Lot Number
     C                     Z-ADD*ZERO     WSYNCD           Location Level
     C                     Z-ADD*ZERO     WSJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WSG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WSJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WSG6WG           ILl Item Wgt On
     C                     Z-ADD*ZERO     WSJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WSG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WSLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WSLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WSLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WSNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTLCBY           Location Bay
     C                     Z-ADD*ZERO     WTLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVSLTY           WLT Type Chill
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXHGCD           Item Code
     C                     Z-ADD*ZERO     WXLRDT           LLT Trans Date
     C                     Z-ADD*ZERO     WXLLTS           LLT Sequence #
     C                     Z-ADD*ZERO     WXLSDT           LLT Production
     C                     Z-ADD*ZERO     WXJ5QT           LLT Trans Qty
     C                     Z-ADD*ZERO     WXG8WG           LLT Trans Wgt
     C                     Z-ADD*ZERO     WXLLTN           LLT Lot Number
     C                     Z-ADD*ZERO     WXLLCL           LLT Location Le
     C                     Z-ADD*ZERO     WXLLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     WXLLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     WXC4NB           Order Number
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TAAIC3           Company Number
     C                     Z-ADD*ZERO     TAHGCD           Item Code
     C                     Z-ADD*ZERO     TAELDT           Production Date
     C                     Z-ADD*ZERO     TAABWG           Physical Count
     C                     Z-ADD*ZERO     TAAGQT           Physical Count
     C                     Z-ADD*ZERO     TAAHQT           Physical Count
     C                     Z-ADD*ZERO     TAAIQT           Physical Count
     C                     Z-ADD*ZERO     TAACWG           Quantity on Han
     C                     Z-ADD*ZERO     TAARQT           Quantity on Han
     C                     Z-ADD*ZERO     TAASQT           Quantity on Han
     C                     Z-ADD*ZERO     TAATQT           Quantity on Han
     C                     Z-ADD*ZERO     TAHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     TAHEQT           Weight In Chill
     C                     Z-ADD*ZERO     TABMWG           Physical Start
     C                     Z-ADD*ZERO     TADSQT           Physical Start
     C                     Z-ADD*ZERO     TADTQT           Physical Start
     C                     Z-ADD*ZERO     TADUQT           Physical Start
     C                     Z-ADD*ZERO     TADHDT           Physical Start
     C                     Z-ADD*ZERO     TAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     TAAECS           Last Cost
     C                     Z-ADD*ZERO     TAIDVA           Value of On Han
     C                     Z-ADD*ZERO     TAK7DT           Label Date
     C                     Z-ADD*ZERO     TARINB           Item Structure
     C                     Z-ADD*ZERO     TARHNB           Item Structure
     C                     Z-ADD*ZERO     TARGNB           Item Structure
     C                     Z-ADD*ZERO     TAAATM           Job Time
     C                     Z-ADD*ZERO     TAAXDT           Job Date
      * Define work field Update Exception Status
     C                     MOVEL*BLANK    WUF6ST  1
      * Clear all neither parameters
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUZRST  1
      * Define work field Manifest Unused Status 1A
     C                     MOVEL*BLANK    WUGCTX  1
      * Define work field Manifest Unused Status 2A
     C                     MOVEL*BLANK    WUGDTX  1
      * Define work field OIA Unused Sts 1
     C                     MOVEL*BLANK    WUOTUS  1
      * Define work field OIA Unused Sts 2
     C                     MOVEL*BLANK    WUOTMP  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TEAIC3           Company Number
     C                     Z-ADD*ZERO     TEC4NB           Order Number
     C                     Z-ADD*ZERO     TEDPNB           Order Sequence
     C                     Z-ADD*ZERO     TEUENB           Order Secondary
     C                     Z-ADD*ZERO     TEALSW           Allocation Seq
     C                     Z-ADD*ZERO     TEJ6QT           OIA Alloc/Shipp
     C                     Z-ADD*ZERO     TEG9WG           OIA Alloc/Shipp
     C                     Z-ADD*ZERO     TEJ9QT           OIA Co-Packer L
     C                     Z-ADD*ZERO     TEHAWG           OIA Serial Numb
     C                     Z-ADD*ZERO     TEHGCD           Item Code
     C                     Z-ADD*ZERO     TEELDT           Production Date
     C                     Z-ADD*ZERO     TELXNM           Lot Number
     C                     Z-ADD*ZERO     TEYNCD           Location Level
     C                     Z-ADD*ZERO     TEAATM           Job Time
     C                     Z-ADD*ZERO     TEAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  6
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  1
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  3
     C                     Z-ADD*ZERO     WL0011  52
     C                     MOVEL*BLANK    WL0012  6
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  30
     C                     Z-ADD*ZERO     WL0017  80
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0020  30
     C                     MOVEL*BLANK    WL0021 10
     C                     MOVEL*BLANK    WL0022 40
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  80
     C                     Z-ADD*ZERO     WL0025  80
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0026  30
     C                     MOVEL*BLANK    WL0027  2
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  30
     C                     MOVEL*BLANK    WL0030  1
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0031  30
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033 30
     C                     MOVEL*BLANK    WL0034 32
     C                     MOVEL*BLANK    WL0035 32
     C                     Z-ADD*ZERO     WL0036  30
     C                     Z-ADD*ZERO     WL0037  30
     C                     Z-ADD*ZERO     WL0038  30
     C                     MOVEL*BLANK    WL0039  3
     C                     MOVEL*BLANK    WL0040  3
     C                     MOVEL*BLANK    WL0041  3
     C                     MOVEL*BLANK    WL0042  6
      * Define local variables for subroutine SRRVGN.
     C                     MOVEL*BLANK    WL0043  3
     C                     MOVEL*BLANK    WL0044  2
      * Define local variables for subroutine SSCRRC.
     C                     Z-ADD*ZERO     WL0045  30
     C                     Z-ADD*ZERO     WL0046  80
     C                     Z-ADD*ZERO     WL0047  80
     C                     Z-ADD*ZERO     WL0048  60
     C                     Z-ADD*ZERO     WL0049  80
     C                     Z-ADD*ZERO     WL0050  80
     C                     Z-ADD*ZERO     WL0051  60
     C                     MOVEL*BLANK    WL0052  1
     C                     Z-ADD*ZERO     WL0053  51
     C                     Z-ADD*ZERO     WL0054  51
     C                     MOVEL*BLANK    WL0055  1
     C                     MOVEL*BLANK    WL0056  3
     C                     Z-ADD*ZERO     WL0057  70
     C                     MOVEL*BLANK    WL0058 10
     C                     Z-ADD*ZERO     WL0059  70
     C                     MOVEL*BLANK    WL0060 32
     C                     MOVEL*BLANK    WL0061 32
     C                     MOVEL*BLANK    WL0062  2
     C                     MOVEL*BLANK    WL0063  9
     C                     Z-ADD*ZERO     WL0064  50
     C                     MOVEL*BLANK    WL0065  1
     C                     MOVEL*BLANK    WL0066  3
     C                     MOVEL*BLANK    WL0067 25
     C                     MOVEL*BLANK    WL0068  5
     C                     MOVEL*BLANK    WL0069 25
     C                     MOVEL*BLANK    WL0070  6
     C                     MOVEL*BLANK    WL0071  6
     C                     MOVEL*BLANK    WL0072 40
     C                     MOVEL*BLANK    WL0073 40
     C                     MOVEL*BLANK    WL0074  2
     C                     MOVEL*BLANK    WL0075 20
     C                     MOVEL*BLANK    WL0076  5
     C                     MOVEL*BLANK    WL0077 25
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079  6
     C                     MOVEL*BLANK    WL0080  6
     C                     MOVEL*BLANK    WL0081  6
     C                     MOVEL*BLANK    WL0082  6
     C                     MOVEL*BLANK    WL0083  3
     C                     Z-ADD*ZERO     WL0084  30
     C                     Z-ADD*ZERO     WL0085  30
     C                     Z-ADD*ZERO     WL0086  30
     C                     Z-ADD*ZERO     WL0087  80
     C                     Z-ADD*ZERO     WL0088  60
     C                     MOVEL*BLANK    WL0089  1
     C                     MOVEL*BLANK    WL0090  1
     C                     Z-ADD*ZERO     WL0091  80
     C                     Z-ADD*ZERO     WL0092  80
     C                     Z-ADD*ZERO     WL0093  80
     C                     Z-ADD*ZERO     WL0094  70
     C                     MOVEL*BLANK    WL0095  1
     C                     MOVEL*BLANK    WL0096  1
     C                     Z-ADD*ZERO     WL0097  60
     C                     MOVEL*BLANK    WL0098 10
     C                     MOVEL*BLANK    WL0099 10
     C                     Z-ADD*ZERO     WL0100  70
      * Define local variables for subroutine STCRRC.
     C                     Z-ADD*ZERO     WL0101  30
     C                     Z-ADD*ZERO     WL0102  70
     C                     MOVEL*BLANK    WL0103  3
     C                     Z-ADD*ZERO     WL0104  70
     C                     Z-ADD*ZERO     WL0105  50
     C                     MOVEL*BLANK    WL0106  4
     C                     Z-ADD*ZERO     WL0107  20
     C                     Z-ADD*ZERO     WL0108  50
     C                     Z-ADD*ZERO     WL0109 112
     C                     Z-ADD*ZERO     WL0110  50
     C                     Z-ADD*ZERO     WL0111 112
     C                     Z-ADD*ZERO     WL0112  50
     C                     Z-ADD*ZERO     WL0113 112
     C                     Z-ADD*ZERO     WL0114  70
     C                     Z-ADD*ZERO     WL0115  70
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117  72
     C                     MOVEL*BLANK    WL0118  6
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  1
     C                     MOVEL*BLANK    WL0121  1
     C                     MOVEL*BLANK    WL0122  2
     C                     MOVEL*BLANK    WL0123  3
     C                     MOVEL*BLANK    WL0124  1
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  1
     C                     MOVEL*BLANK    WL0127  1
     C                     Z-ADD*ZERO     WL0128  60
     C                     MOVEL*BLANK    WL0129 10
     C                     MOVEL*BLANK    WL0130 10
     C                     Z-ADD*ZERO     WL0131  70
     C                     MOVEL*BLANK    WL0132  2
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0133  3
     C                     MOVEL*BLANK    WL0134  4
     C                     MOVEL*BLANK    WL0135  1
      * Define local variables for subroutine SVRVGN.
     C                     MOVEL*BLANK    WL0136  1
     C                     Z-ADD*ZERO     WL0137  52
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0138  30
     C                     Z-ADD*ZERO     WL0139  70
     C                     Z-ADD*ZERO     WL0140 112
     C                     MOVEL*BLANK    WL0141  2
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0142  30
     C                     Z-ADD*ZERO     WL0143  70
     C                     MOVEL*BLANK    WL0144  3
     C                     MOVEL*BLANK    WL0145  2
     C                     Z-ADD*ZERO     WL0146  70
     C                     Z-ADD*ZERO     WL0147  30
      * Define local variables for subroutine TBCRRC.
     C                     Z-ADD*ZERO     WL0148  30
     C                     Z-ADD*ZERO     WL0149  70
     C                     MOVEL*BLANK    WL0150  3
     C                     MOVEL*BLANK    WL0151  2
     C                     Z-ADD*ZERO     WL0152  70
     C                     Z-ADD*ZERO     WL0153  30
     C                     Z-ADD*ZERO     WL0154  70
     C                     Z-ADD*ZERO     WL0155  50
     C                     Z-ADD*ZERO     WL0156 112
     C                     Z-ADD*ZERO     WL0157  50
     C                     MOVEL*BLANK    WL0158  4
     C                     Z-ADD*ZERO     WL0159  20
     C                     MOVEL*BLANK    WL0160  3
     C                     Z-ADD*ZERO     WL0161  50
     C                     MOVEL*BLANK    WL0162  4
     C                     Z-ADD*ZERO     WL0163  20
     C                     Z-ADD*ZERO     WL0164  70
     C                     MOVEL*BLANK    WL0165  1
     C                     MOVEL*BLANK    WL0166  1
     C                     MOVEL*BLANK    WL0167  1
     C                     MOVEL*BLANK    WL0168  1
     C                     MOVEL*BLANK    WL0169  1
     C                     MOVEL*BLANK    WL0170  1
     C                     MOVEL*BLANK    WL0171  1
     C                     Z-ADD*ZERO     WL0172  60
     C                     MOVEL*BLANK    WL0173 10
     C                     MOVEL*BLANK    WL0174 10
     C                     Z-ADD*ZERO     WL0175  70
      * Define local variables for subroutine TCRVGN.
     C                     Z-ADD*ZERO     WL0176  30
     C                     Z-ADD*ZERO     WL0177  70
     C                     MOVEL*BLANK    WL0178  3
     C                     Z-ADD*ZERO     WL0179  70
      * Define local variables for subroutine THRVGN.
     C                     Z-ADD*ZERO     WL0180  30
     C                     Z-ADD*ZERO     WL0181  70
     C                     MOVEL*BLANK    WL0182  3
     C                     Z-ADD*ZERO     WL0183  70
     C                     Z-ADD*ZERO     WL0184  50
     C                     MOVEL*BLANK    WL0185  4
     C                     Z-ADD*ZERO     WL0186  20
     C                     MOVEL*BLANK    WL0187  1
     C                     MOVEL*BLANK    WL0188  3
      * Define local variables for subroutine TNRVGN.
     C                     Z-ADD*ZERO     WL0189  30
     C                     Z-ADD*ZERO     WL0190  80
     C                     Z-ADD*ZERO     WL0191  80
     C                     MOVEL*BLANK    WL0192  1
     C                     Z-ADD*ZERO     WL0193  70
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Item Structure Type Code
     C                     Z-ADD*ZERO     YN0001  30
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0003  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0003  3
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0005132
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0006 40
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Text 10A USR
     C                     MOVEL*BLANK    YL0010 10
      * Define local work field Scale ID
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field CS Scale Offset Minutes
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0014  2
      * Define local work field Item Structure Class Code
     C                     Z-ADD*ZERO     YL0015  30
      * Define local work field Item Structure Group Code
     C                     Z-ADD*ZERO     YL0016  30
      * Define local work field Item Structure Type Code
     C                     Z-ADD*ZERO     YL0017  30
      * Define local work field ILL Item Qty On-Hand
     C                     Z-ADD*ZERO     YL0018  50
      * Define local work field ILl Item Wgt On-Hand
     C                     Z-ADD*ZERO     YL0019 112
      * Define local work field Location Code
     C                     MOVEL*BLANK    YL0020  4
      * Define local work field Order Alpha
     C                     MOVEL*BLANK    YL0021  7
      * Define local work field Text USR 8
     C                     MOVEL*BLANK    YL0022  8
      * Define local work field PT Prod Date YYYYMMDD
     C                     Z-ADD*ZERO     YL0023  80
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0025132
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0026 40
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PRKDUPCSE
00002 Plant Floor Production
00003 Delete for Rework
00004 Delete from Inventory
00005 Warehouse Transfer
00006 Recall Rework
00007 Adjustment to Inventory
00008 Inter-Plant Tfr
00009 PFS: Misc Receipt
