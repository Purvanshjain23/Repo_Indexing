     H/TITLE Cvt i5 Loc to CT Loc  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 12/17/13  Time  : 16:39:49
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FPPBWREL1IF  E           K        DISK
      * RTV : Warehouse Location CT REF Retrieval index
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FCAB7CPL1IF  E           K        DISK
      * RTV : Item Transaction Detail   Retrieval index       NV
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FPDL2REL1IF  E           K        DISK                      A
      * UPD : Warehouse Location        Update index
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB0REL0UF  E           K        DISK                      A
      * UPD : Item Balance              Update index
      *
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          WAAIC3
     I              L5HGCD                          WAHGCD
     I              L5AJCD                          WAAJCD
     I              L5ELDT                          WAELDT
     I              L5LXNM                          WALXNM
     I              L5YMCD                          WAYMCD
     I              L5YNCD                          WAYNCD
     I              L5J2QT                          WAJ2QT
     I              L5G5WG                          WAG5WG
     I              L5J3QT                          WAJ3QT
     I              L5G6WG                          WAG6WG
     I              L5J4QT                          WAJ4QT
     I              L5G7WG                          WAG7WG
     I              L5LODT                          WALODT
     I              L5LPDT                          WALPDT
     I              L5LQDT                          WALQDT
     I              L5NBR                           WANBR
     I              L5YTCD                          WAYTCD
     I              L5AMSX                          WAAMSX
     I              L5ASSX                          WAASSX
     I              L5ATSX                          WAATSX
     I              L5AUSX                          WAAUSX
     I              L5YSCD                          WAYSCD
     I              L5UVST                          WAUVST
     I              L5UWST                          WAUWST
     I              L5UXST                          WAUXST
     I              L5VSST                          WAVSST
     I              L5AATM                          WAAATM
     I              L5AYNA                          WAAYNA
     I              L5A0NA                          WAA0NA
     I              L5AXDT                          WAAXDT
      *
     I@BWREDP
      * Warehouse Location CT REF Retrieval index
      * Renamed input format fields
     I              BWAJCD                          WBAJCD
     I              BWYMCD                          WBYMCD
     I              BWYNCD                          WBYNCD
     I              BWCNNY                          WBCNNY
      *
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          WCAIC3
     I              L7HGCD                          WCHGCD
     I              L7AJCD                          WCAJCD
     I              L7LTRT                          WCLTRT
     I              L7LRDT                          WCLRDT
     I              L7LLTS                          WCLLTS
     I              L7LSDT                          WCLSDT
     I              L7J5QT                          WCJ5QT
     I              L7G8WG                          WCG8WG
     I              L7LLTN                          WCLLTN
     I              L7YMCD                          WCYMCD
     I              L7LLCL                          WCLLCL
     I              L7BNAA                          WCBNAA
     I              L7LLTR                          WCLLTR
     I              L7Y2CD                          WCY2CD
     I              L7LLTL                          WCLLTL
     I              L7C4NB                          WCC4NB
     I              L7LOST                          WCLOST
     I              L7LLTU                          WCLLTU
     I              L7LLYT                          WCLLYT
     I              L7UVST                          WCUVST
     I              L7UWST                          WCUWST
     I              L7UXST                          WCUXST
     I              L7VSST                          WCVSST
     I              L7AATM                          WCAATM
     I              L7AYNA                          WCAYNA
     I              L7A0NA                          WCA0NA
     I              L7AXDT                          WCAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WDAIC3
     I              L7HGCD                          WDHGCD
     I              L7AJCD                          WDAJCD
     I              L7LTRT                          WDLTRT
     I              L7LRDT                          WDLRDT
     I              L7LLTS                          WDLLTS
     I              L7LSDT                          WDLSDT
     I              L7J5QT                          WDJ5QT
     I              L7G8WG                          WDG8WG
     I              L7LLTN                          WDLLTN
     I              L7YMCD                          WDYMCD
     I              L7LLCL                          WDLLCL
     I              L7BNAA                          WDBNAA
     I              L7LLTR                          WDLLTR
     I              L7Y2CD                          WDY2CD
     I              L7LLTL                          WDLLTL
     I              L7C4NB                          WDC4NB
     I              L7LOST                          WDLOST
     I              L7LLTU                          WDLLTU
     I              L7LLYT                          WDLLYT
     I              L7UVST                          WDUVST
     I              L7UWST                          WDUWST
     I              L7UXST                          WDUXST
     I              L7VSST                          WDVSST
     I              L7AATM                          WDAATM
     I              L7AYNA                          WDAYNA
     I              L7A0NA                          WDA0NA
     I              L7AXDT                          WDAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WEAIC3
     I              L5HGCD                          WEHGCD
     I              L5AJCD                          WEAJCD
     I              L5ELDT                          WEELDT
     I              L5LXNM                          WELXNM
     I              L5YMCD                          WEYMCD
     I              L5YNCD                          WEYNCD
     I              L5J2QT                          WEJ2QT
     I              L5G5WG                          WEG5WG
     I              L5J3QT                          WEJ3QT
     I              L5G6WG                          WEG6WG
     I              L5J4QT                          WEJ4QT
     I              L5G7WG                          WEG7WG
     I              L5LODT                          WELODT
     I              L5LPDT                          WELPDT
     I              L5LQDT                          WELQDT
     I              L5NBR                           WENBR
     I              L5YTCD                          WEYTCD
     I              L5AMSX                          WEAMSX
     I              L5ASSX                          WEASSX
     I              L5ATSX                          WEATSX
     I              L5AUSX                          WEAUSX
     I              L5YSCD                          WEYSCD
     I              L5UVST                          WEUVST
     I              L5UWST                          WEUWST
     I              L5UXST                          WEUXST
     I              L5VSST                          WEVSST
     I              L5AATM                          WEAATM
     I              L5AYNA                          WEAYNA
     I              L5A0NA                          WEA0NA
     I              L5AXDT                          WEAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WFAIC3
     I              B1HGCD                          WFHGCD
     I              B1AJCD                          WFAJCD
     I              B1ELDT                          WFELDT
     I              B1ABWG                          WFABWG
     I              B1AGQT                          WFAGQT
     I              B1AHQT                          WFAHQT
     I              B1AIQT                          WFAIQT
     I              B1CTST                          WFCTST
     I              B1ACWG                          WFACWG
     I              B1ARQT                          WFARQT
     I              B1ASQT                          WFASQT
     I              B1ATQT                          WFATQT
     I              B1HDQT                          WFHDQT
     I              B1HEQT                          WFHEQT
     I              B1F6ST                          WFF6ST
     I              B1BMWG                          WFBMWG
     I              B1DSQT                          WFDSQT
     I              B1DTQT                          WFDTQT
     I              B1DUQT                          WFDUQT
     I              B1DHDT                          WFDHDT
     I              B1AGCS                          WFAGCS
     I              B1AECS                          WFAECS
     I              B1IDVA                          WFIDVA
     I              B1K7DT                          WFK7DT
     I              B1RINB                          WFRINB
     I              B1RHNB                          WFRHNB
     I              B1RGNB                          WFRGNB
     I              B1UVST                          WFUVST
     I              B1UWST                          WFUWST
     I              B1UXST                          WFUXST
     I              B1VSST                          WFVSST
     I              B1AATM                          WFAATM
     I              B1AYNA                          WFAYNA
     I              B1A0NA                          WFA0NA
     I              B1AXDT                          WFAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WHAJCD
     I              L2YMCD                          WHYMCD
     I              L2YPCD                          WHYPCD
     I              L2LCBY                          WHLCBY
     I              L2LCCT                          WHLCCT
     I              L2WLUS                          WHWLUS
     I              L2WUSD                          WHWUSD
     I              L2WLUN                          WHWLUN
     I              L2AGSX                          WHAGSX
     I              L2UVST                          WHUVST
     I              L2UWST                          WHUWST
     I              L2UXST                          WHUXST
     I              L2VSST                          WHVSST
     I              L2AATM                          WHAATM
     I              L2AYNA                          WHAYNA
     I              L2A0NA                          WHA0NA
     I              L2AXDT                          WHAXDT
      *
     I@L2RESN
      * Warehouse Location        Update index
      * Renamed input format fields
     I              L2AJCD                          WIAJCD
     I              L2YMCD                          WIYMCD
     I              L2YPCD                          WIYPCD
     I              L2LCBY                          WILCBY
     I              L2LCCT                          WILCCT
     I              L2WLUS                          WIWLUS
     I              L2WUSD                          WIWUSD
     I              L2WLUN                          WIWLUN
     I              L2AGSX                          WIAGSX
     I              L2UVST                          WIUVST
     I              L2UWST                          WIUWST
     I              L2UXST                          WIUXST
     I              L2VSST                          WIVSST
     I              L2AATM                          WIAATM
     I              L2AYNA                          WIAYNA
     I              L2A0NA                          WIA0NA
     I              L2AXDT                          WIAXDT
      *
     I@L3RET8
      * Warehouse Location Type   Retrieval index
      * Renamed input format fields
     I              MEAGSX                          WJAGSX
     I              MEOPNA                          WJOPNA
     I              MESLTY                          WJSLTY
     I              MEAHSX                          WJAHSX
     I              MEAISX                          WJAISX
     I              MEUVST                          WJUVST
     I              MEUWST                          WJUWST
     I              MEUXST                          WJUXST
     I              MEVSST                          WJVSST
     I              MEAATM                          WJAATM
     I              MEAYNA                          WJAYNA
     I              MEA0NA                          WJA0NA
     I              MEAXDT                          WJAXDT
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WKAIC3
     I              ASAXNB                          WKAXNB
     I              ASNGNB                          WKNGNB
     I              ASBZNB                          WKBZNB
     I              ASC5NB                          WKC5NB
     I              ASC3NB                          WKC3NB
     I              ASCYNB                          WKCYNB
     I              ASIONB                          WKIONB
     I              ASI6NB                          WKI6NB
     I              ASDCNB                          WKDCNB
     I              ASC7NB                          WKC7NB
     I              ASC2NB                          WKC2NB
     I              ASC1NB                          WKC1NB
     I              ASL8NB                          WKL8NB
     I              ASBANB                          WKBANB
     I              ASCHST                          WKCHST
     I              ASCKST                          WKCKST
     I              ASCIST                          WKCIST
     I              ASCGST                          WKCGST
     I              ASAIPC                          WKAIPC
     I              ASASPC                          WKASPC
     I              ASA2VA                          WKA2VA
     I              ASC2ST                          WKC2ST
     I              ASD8ST                          WKD8ST
     I              ASD7ST                          WKD7ST
     I              ASA8NA                          WKA8NA
     I              ASA9NA                          WKA9NA
     I              ASBANA                          WKBANA
     I              ASBBNA                          WKBBNA
     I              ASEUST                          WKEUST
     I              ASAADY                          WKAADY
     I              ASABDY                          WKABDY
     I              ASACDY                          WKACDY
     I              ASADDY                          WKADDY
     I              ASAEDY                          WKAEDY
     I              ASAFDY                          WKAFDY
     I              ASAGDY                          WKAGDY
     I              ASAHDY                          WKAHDY
     I              ASAENB                          WKAENB
     I              ASALNB                          WKALNB
     I              ASEVNB                          WKEVNB
     I              ASRPOP                          WKRPOP
     I              ASDWNB                          WKDWNB
     I              ASR3NB                          WKR3NB
     I              ASPNST                          WKPNST
     I              ASR4NB                          WKR4NB
     I              ASPOST                          WKPOST
     I              ASSCNB                          WKSCNB
     I              ASVIST                          WKVIST
     I              ASVJST                          WKVJST
     I              ASBVVN                          WKBVVN
     I              ASUVST                          WKUVST
     I              ASUWST                          WKUWST
     I              ASUXST                          WKUXST
     I              ASVSST                          WKVSST
     I              ASAATM                          WKAATM
     I              ASAYNA                          WKAYNA
     I              ASA0NA                          WKA0NA
     I              ASAXDT                          WKAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WLAIC3
     I              BZHGCD                          WLHGCD
     I              BZAVNA                          WLAVNA
     I              BZAWNA                          WLAWNA
     I              BZL7NA                          WLL7NA
     I              BZL8NA                          WLL8NA
     I              BZL6NA                          WLL6NA
     I              BZMFNA                          WLMFNA
     I              BZADCD                          WLADCD
     I              BZAWPC                          WLAWPC
     I              BZLXST                          WLLXST
     I              BZAECD                          WLAECD
     I              BZAXPC                          WLAXPC
     I              BZLYST                          WLLYST
     I              BZAFCD                          WLAFCD
     I              BZAICD                          WLAICD
     I              BZAIWG                          WLAIWG
     I              BZHICD                          WLHICD
     I              BZRBCD                          WLRBCD
     I              BZFZST                          WLFZST
     I              BZAVST                          WLAVST
     I              BZCZWG                          WLCZWG
     I              BZC0WG                          WLC0WG
     I              BZURTN                          WLURTN
     I              BZAJC8                          WLAJC8
     I              BZRINB                          WLRINB
     I              BZRHNB                          WLRHNB
     I              BZRGNB                          WLRGNB
     I              BZLNCD                          WLLNCD
     I              BZTFNB                          WLTFNB
     I              BZN0CD                          WLN0CD
     I              BZX4ST                          WLX4ST
     I              BZTMVA                          WLTMVA
     I              BZTNVA                          WLTNVA
     I              BZBLPR                          WLBLPR
     I              BZBMPR                          WLBMPR
     I              BZLRCD                          WLLRCD
     I              BZU9ST                          WLU9ST
     I              BZCMCO                          WLCMCO
     I              BZQ1CD                          WLQ1CD
     I              BZQ8CD                          WLQ8CD
     I              BZCHTM                          WLCHTM
     I              BZQZCD                          WLQZCD
     I              BZXWST                          WLXWST
     I              BZXXST                          WLXXST
     I              BZVMST                          WLVMST
     I              BZSWGH                          WLSWGH
     I              BZPPHE                          WLPPHE
     I              BZR3CD                          WLR3CD
     I              BZSDCD                          WLSDCD
     I              BZICN1                          WLICN1
     I              BZSVCD                          WLSVCD
     I              BZICN2                          WLICN2
     I              BZSWCD                          WLSWCD
     I              BZV2NB                          WLV2NB
     I              BZSXCD                          WLSXCD
     I              BZITCN                          WLITCN
     I              BZSYCD                          WLSYCD
     I              BZITC5                          WLITC5
     I              BZSZCD                          WLSZCD
     I              BZICN6                          WLICN6
     I              BZS0CD                          WLS0CD
     I              BZICN7                          WLICN7
     I              BZS1CD                          WLS1CD
     I              BZICN8                          WLICN8
     I              BZS2CD                          WLS2CD
     I              BZICN9                          WLICN9
     I              BZS3CD                          WLS3CD
     I              BZICN0                          WLICN0
     I              BZS4CD                          WLS4CD
     I              BZSFNB                          WLSFNB
     I              BZA3WG                          WLA3WG
     I              BZSJNB                          WLSJNB
     I              BZLLCD                          WLLLCD
     I              BZLMCD                          WLLMCD
     I              BZP3ST                          WLP3ST
     I              BZSKNB                          WLSKNB
     I              BZSLNB                          WLSLNB
     I              BZSMNB                          WLSMNB
     I              BZP4ST                          WLP4ST
     I              BZCFNB                          WLCFNB
     I              BZCGNB                          WLCGNB
     I              BZILNB                          WLILNB
     I              BZCHNB                          WLCHNB
     I              BZCINB                          WLCINB
     I              BZCJNB                          WLCJNB
     I              BZCMNB                          WLCMNB
     I              BZCNNB                          WLCNNB
     I              BZCRNB                          WLCRNB
     I              BZCSNB                          WLCSNB
     I              BZCVNB                          WLCVNB
     I              BZCWNB                          WLCWNB
     I              BZCXNB                          WLCXNB
     I              BZCZNB                          WLCZNB
     I              BZC0NB                          WLC0NB
     I              BZN1CD                          WLN1CD
     I              BZB4NB                          WLB4NB
     I              BZB5NB                          WLB5NB
     I              BZX5ST                          WLX5ST
     I              BZX6ST                          WLX6ST
     I              BZX7ST                          WLX7ST
     I              BZPCCT                          WLPCCT
     I              BZBDNB                          WLBDNB
     I              BZBJNB                          WLBJNB
     I              BZSUST                          WLSUST
     I              BZSVST                          WLSVST
     I              BZSYST                          WLSYST
     I              BZSZST                          WLSZST
     I              BZS1ST                          WLS1ST
     I              BZXRCD                          WLXRCD
     I              BZXTCD                          WLXTCD
     I              BZXUCD                          WLXUCD
     I              BZF5WG                          WLF5WG
     I              BZF6WG                          WLF6WG
     I              BZF7WG                          WLF7WG
     I              BZBLNB                          WLBLNB
     I              BZBNNB                          WLBNNB
     I              BZS2ST                          WLS2ST
     I              BZS4ST                          WLS4ST
     I              BZS5ST                          WLS5ST
     I              BZS6ST                          WLS6ST
     I              BZS8ST                          WLS8ST
     I              BZS9ST                          WLS9ST
     I              BZTCST                          WLTCST
     I              BZTDST                          WLTDST
     I              BZUVST                          WLUVST
     I              BZUWST                          WLUWST
     I              BZUXST                          WLUXST
     I              BZVSST                          WLVSST
     I              BZAATM                          WLAATM
     I              BZAYNA                          WLAYNA
     I              BZA0NA                          WLA0NA
     I              BZAXDT                          WLAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WMAIC3
     I              B0HGCD                          WMHGCD
     I              B0AJCD                          WMAJCD
     I              B0AGCS                          WMAGCS
     I              B0AECS                          WMAECS
     I              B0BACS                          WMBACS
     I              B0BBCS                          WMBBCS
     I              B0CBPR                          WMCBPR
     I              B0GUDT                          WMGUDT
     I              B0XYST                          WMXYST
     I              B0CTPR                          WMCTPR
     I              B0G4DT                          WMG4DT
     I              B0BOWG                          WMBOWG
     I              B0DDQT                          WMDDQT
     I              B0DEQT                          WMDEQT
     I              B0DFQT                          WMDFQT
     I              B0HDQT                          WMHDQT
     I              B0HEQT                          WMHEQT
     I              B0AJQT                          WMAJQT
     I              B0AQQT                          WMAQQT
     I              B0AUQT                          WMAUQT
     I              B0EMQT                          WMEMQT
     I              B0DOQT                          WMDOQT
     I              B0ATNA                          WMATNA
     I              B0AKDT                          WMAKDT
     I              B0ANDT                          WMANDT
     I              B0IDVA                          WMIDVA
     I              B0JVST                          WMJVST
     I              B0BZPC                          WMBZPC
     I              B0DGQT                          WMDGQT
     I              B0DIDT                          WMDIDT
     I              B0ALCD                          WMALCD
     I              B0BFDY                          WMBFDY
     I              B0DJDT                          WMDJDT
     I              B0BGDY                          WMBGDY
     I              B0DKDT                          WMDKDT
     I              B0J2ST                          WMJ2ST
     I              B0DJQT                          WMDJQT
     I              B0BNWG                          WMBNWG
     I              B0DLDT                          WMDLDT
     I              B0DPQT                          WMDPQT
     I              B0DQQT                          WMDQQT
     I              B0DMDT                          WMDMDT
     I              B0M0ST                          WMM0ST
     I              B0J9ST                          WMJ9ST
     I              B0KBST                          WMKBST
     I              B0AKC8                          WMAKC8
     I              B0RINB                          WMRINB
     I              B0RHNB                          WMRHNB
     I              B0RGNB                          WMRGNB
     I              B0UVST                          WMUVST
     I              B0UWST                          WMUWST
     I              B0UXST                          WMUXST
     I              B0VSST                          WMVSST
     I              B0AATM                          WMAATM
     I              B0AYNA                          WMAYNA
     I              B0A0NA                          WMA0NA
     I              B0AXDT                          WMAXDT
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WOAIC3
     I              B7HGCD                          WOHGCD
     I              B7AJCD                          WOAJCD
     I              B7W9ST                          WOW9ST
     I              B7BSST                          WOBSST
     I              B7B4DT                          WOB4DT
     I              B7C4NY                          WOC4NY
     I              B7DXNB                          WODXNB
     I              B7ELDT                          WOELDT
     I              B7HVCD                          WOHVCD
     I              B7F1ST                          WOF1ST
     I              B7AUNA                          WOAUNA
     I              B7A5QT                          WOA5QT
     I              B7AHWG                          WOAHWG
     I              B7AKCS                          WOAKCS
     I              B7CGCD                          WOCGCD
     I              B7AYVA                          WOAYVA
     I              B7BJNA                          WOBJNA
     I              B7CKNB                          WOCKNB
     I              B7BMST                          WOBMST
     I              B7CQCD                          WOCQCD
     I              B7DTCD                          WODTCD
     I              B7MGNA                          WOMGNA
     I              B7TRBN                          WOTRBN
     I              B7TRBS                          WOTRBS
     I              B7C4NB                          WOC4NB
     I              B7RINB                          WORINB
     I              B7RHNB                          WORHNB
     I              B7RGNB                          WORGNB
     I              B7M3NA                          WOM3NA
     I              B7AWTM                          WOAWTM
     I              B7XLCD                          WOXLCD
     I              B7K7DT                          WOK7DT
     I              B7UVST                          WOUVST
     I              B7UWST                          WOUWST
     I              B7UXST                          WOUXST
     I              B7VSST                          WOVSST
     I              B7AATM                          WOAATM
     I              B7AYNA                          WOAYNA
     I              B7A0NA                          WOA0NA
     I              B7AXDT                          WOAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WRAIC3
     I              B7HGCD                          WRHGCD
     I              B7AJCD                          WRAJCD
     I              B7W9ST                          WRW9ST
     I              B7BSST                          WRBSST
     I              B7B4DT                          WRB4DT
     I              B7C4NY                          WRC4NY
     I              B7DXNB                          WRDXNB
     I              B7ELDT                          WRELDT
     I              B7HVCD                          WRHVCD
     I              B7F1ST                          WRF1ST
     I              B7AUNA                          WRAUNA
     I              B7A5QT                          WRA5QT
     I              B7AHWG                          WRAHWG
     I              B7AKCS                          WRAKCS
     I              B7CGCD                          WRCGCD
     I              B7AYVA                          WRAYVA
     I              B7BJNA                          WRBJNA
     I              B7CKNB                          WRCKNB
     I              B7BMST                          WRBMST
     I              B7CQCD                          WRCQCD
     I              B7DTCD                          WRDTCD
     I              B7MGNA                          WRMGNA
     I              B7TRBN                          WRTRBN
     I              B7TRBS                          WRTRBS
     I              B7C4NB                          WRC4NB
     I              B7RINB                          WRRINB
     I              B7RHNB                          WRRHNB
     I              B7RGNB                          WRRGNB
     I              B7M3NA                          WRM3NA
     I              B7AWTM                          WRAWTM
     I              B7XLCD                          WRXLCD
     I              B7K7DT                          WRK7DT
     I              B7UVST                          WRUVST
     I              B7UWST                          WRUWST
     I              B7UXST                          WRUXST
     I              B7VSST                          WRVSST
     I              B7AATM                          WRAATM
     I              B7AYNA                          WRAYNA
     I              B7A0NA                          WRA0NA
     I              B7AXDT                          WRAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WSAJCD
     I              ADF8NA                          WSF8NA
     I              ADACNA                          WSACNA
     I              ADADNA                          WSADNA
     I              ADAENA                          WSAENA
     I              ADAJNA                          WSAJNA
     I              ADBTTX                          WSBTTX
     I              ADAOCD                          WSAOCD
     I              ADBGCD                          WSBGCD
     I              ADVHST                          WSVHST
     I              ADMPNA                          WSMPNA
     I              ADWPST                          WSWPST
     I              ADXUST                          WSXUST
     I              ADT0ST                          WST0ST
     I              ADT1ST                          WST1ST
     I              ADDBNB                          WSDBNB
     I              ADT2ST                          WST2ST
     I              ADT3ST                          WST3ST
     I              ADT4ST                          WST4ST
     I              ADT6ST                          WST6ST
     I              ADBWC3                          WSBWC3
     I              ADBTC3                          WSBTC3
     I              ADBUC3                          WSBUC3
     I              ADBVC3                          WSBVC3
     I              ADFCAA                          WSFCAA
     I              ADRQSX                          WSRQSX
     I              ADRRSX                          WSRRSX
     I              ADRSSX                          WSRSSX
     I              ADRTSX                          WSRTSX
     I              ADT7ST                          WST7ST
     I              ADT8ST                          WST8ST
     I              ADRNSX                          WSRNSX
     I              ADROSX                          WSROSX
     I              ADRPSX                          WSRPSX
     I              ADUVST                          WSUVST
     I              ADUWST                          WSUWST
     I              ADUXST                          WSUXST
     I              ADVSST                          WSVSST
     I              ADAATM                          WSAATM
     I              ADAYNA                          WSAYNA
     I              ADA0NA                          WSA0NA
     I              ADAXDT                          WSAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WTAIC3
     I              B1HGCD                          WTHGCD
     I              B1AJCD                          WTAJCD
     I              B1ELDT                          WTELDT
     I              B1ABWG                          WTABWG
     I              B1AGQT                          WTAGQT
     I              B1AHQT                          WTAHQT
     I              B1AIQT                          WTAIQT
     I              B1CTST                          WTCTST
     I              B1ACWG                          WTACWG
     I              B1ARQT                          WTARQT
     I              B1ASQT                          WTASQT
     I              B1ATQT                          WTATQT
     I              B1HDQT                          WTHDQT
     I              B1HEQT                          WTHEQT
     I              B1F6ST                          WTF6ST
     I              B1BMWG                          WTBMWG
     I              B1DSQT                          WTDSQT
     I              B1DTQT                          WTDTQT
     I              B1DUQT                          WTDUQT
     I              B1DHDT                          WTDHDT
     I              B1AGCS                          WTAGCS
     I              B1AECS                          WTAECS
     I              B1IDVA                          WTIDVA
     I              B1K7DT                          WTK7DT
     I              B1RINB                          WTRINB
     I              B1RHNB                          WTRHNB
     I              B1RGNB                          WTRGNB
     I              B1UVST                          WTUVST
     I              B1UWST                          WTUWST
     I              B1UXST                          WTUXST
     I              B1VSST                          WTVSST
     I              B1AATM                          WTAATM
     I              B1AYNA                          WTAYNA
     I              B1A0NA                          WTA0NA
     I              B1AXDT                          WTAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WVAIC3
     I              B0HGCD                          WVHGCD
     I              B0AJCD                          WVAJCD
     I              B0AGCS                          WVAGCS
     I              B0AECS                          WVAECS
     I              B0BACS                          WVBACS
     I              B0BBCS                          WVBBCS
     I              B0CBPR                          WVCBPR
     I              B0GUDT                          WVGUDT
     I              B0XYST                          WVXYST
     I              B0CTPR                          WVCTPR
     I              B0G4DT                          WVG4DT
     I              B0BOWG                          WVBOWG
     I              B0DDQT                          WVDDQT
     I              B0DEQT                          WVDEQT
     I              B0DFQT                          WVDFQT
     I              B0HDQT                          WVHDQT
     I              B0HEQT                          WVHEQT
     I              B0AJQT                          WVAJQT
     I              B0AQQT                          WVAQQT
     I              B0AUQT                          WVAUQT
     I              B0EMQT                          WVEMQT
     I              B0DOQT                          WVDOQT
     I              B0ATNA                          WVATNA
     I              B0AKDT                          WVAKDT
     I              B0ANDT                          WVANDT
     I              B0IDVA                          WVIDVA
     I              B0JVST                          WVJVST
     I              B0BZPC                          WVBZPC
     I              B0DGQT                          WVDGQT
     I              B0DIDT                          WVDIDT
     I              B0ALCD                          WVALCD
     I              B0BFDY                          WVBFDY
     I              B0DJDT                          WVDJDT
     I              B0BGDY                          WVBGDY
     I              B0DKDT                          WVDKDT
     I              B0J2ST                          WVJ2ST
     I              B0DJQT                          WVDJQT
     I              B0BNWG                          WVBNWG
     I              B0DLDT                          WVDLDT
     I              B0DPQT                          WVDPQT
     I              B0DQQT                          WVDQQT
     I              B0DMDT                          WVDMDT
     I              B0M0ST                          WVM0ST
     I              B0J9ST                          WVJ9ST
     I              B0KBST                          WVKBST
     I              B0AKC8                          WVAKC8
     I              B0RINB                          WVRINB
     I              B0RHNB                          WVRHNB
     I              B0RGNB                          WVRGNB
     I              B0UVST                          WVUVST
     I              B0UWST                          WVUWST
     I              B0UXST                          WVUXST
     I              B0VSST                          WVVSST
     I              B0AATM                          WVAATM
     I              B0AYNA                          WVAYNA
     I              B0A0NA                          WVA0NA
     I              B0AXDT                          WVAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WWAIC3
     I              B0HGCD                          WWHGCD
     I              B0AJCD                          WWAJCD
     I              B0AGCS                          WWAGCS
     I              B0AECS                          WWAECS
     I              B0BACS                          WWBACS
     I              B0BBCS                          WWBBCS
     I              B0CBPR                          WWCBPR
     I              B0GUDT                          WWGUDT
     I              B0XYST                          WWXYST
     I              B0CTPR                          WWCTPR
     I              B0G4DT                          WWG4DT
     I              B0BOWG                          WWBOWG
     I              B0DDQT                          WWDDQT
     I              B0DEQT                          WWDEQT
     I              B0DFQT                          WWDFQT
     I              B0HDQT                          WWHDQT
     I              B0HEQT                          WWHEQT
     I              B0AJQT                          WWAJQT
     I              B0AQQT                          WWAQQT
     I              B0AUQT                          WWAUQT
     I              B0EMQT                          WWEMQT
     I              B0DOQT                          WWDOQT
     I              B0ATNA                          WWATNA
     I              B0AKDT                          WWAKDT
     I              B0ANDT                          WWANDT
     I              B0IDVA                          WWIDVA
     I              B0JVST                          WWJVST
     I              B0BZPC                          WWBZPC
     I              B0DGQT                          WWDGQT
     I              B0DIDT                          WWDIDT
     I              B0ALCD                          WWALCD
     I              B0BFDY                          WWBFDY
     I              B0DJDT                          WWDJDT
     I              B0BGDY                          WWBGDY
     I              B0DKDT                          WWDKDT
     I              B0J2ST                          WWJ2ST
     I              B0DJQT                          WWDJQT
     I              B0BNWG                          WWBNWG
     I              B0DLDT                          WWDLDT
     I              B0DPQT                          WWDPQT
     I              B0DQQT                          WWDQQT
     I              B0DMDT                          WWDMDT
     I              B0M0ST                          WWM0ST
     I              B0J9ST                          WWJ9ST
     I              B0KBST                          WWKBST
     I              B0AKC8                          WWAKC8
     I              B0RINB                          WWRINB
     I              B0RHNB                          WWRHNB
     I              B0RGNB                          WWRGNB
     I              B0UVST                          WWUVST
     I              B0UWST                          WWUWST
     I              B0UXST                          WWUXST
     I              B0VSST                          WWVSST
     I              B0AATM                          WWAATM
     I              B0AYNA                          WWAYNA
     I              B0A0NA                          WWA0NA
     I              B0AXDT                          WWAXDT
      *
     IRB7CPJ3
      * Item Transaction Detail   Retrieval index       NV
      * Renamed input format fields
     I              B7AIC3                          WXAIC3
     I              B7HGCD                          WXHGCD
     I              B7AJCD                          WXAJCD
     I              B7W9ST                          WXW9ST
     I              B7BSST                          WXBSST
     I              B7B4DT                          WXB4DT
     I              B7C4NY                          WXC4NY
     I              B7DXNB                          WXDXNB
     I              B7ELDT                          WXELDT
     I              B7HVCD                          WXHVCD
     I              B7F1ST                          WXF1ST
     I              B7AUNA                          WXAUNA
     I              B7A5QT                          WXA5QT
     I              B7AHWG                          WXAHWG
     I              B7AKCS                          WXAKCS
     I              B7CGCD                          WXCGCD
     I              B7AYVA                          WXAYVA
     I              B7BJNA                          WXBJNA
     I              B7CKNB                          WXCKNB
     I              B7BMST                          WXBMST
     I              B7CQCD                          WXCQCD
     I              B7DTCD                          WXDTCD
     I              B7MGNA                          WXMGNA
     I              B7TRBN                          WXTRBN
     I              B7TRBS                          WXTRBS
     I              B7C4NB                          WXC4NB
     I              B7RINB                          WXRINB
     I              B7RHNB                          WXRHNB
     I              B7RGNB                          WXRGNB
     I              B7M3NA                          WXM3NA
     I              B7AWTM                          WXAWTM
     I              B7XLCD                          WXXLCD
     I              B7K7DT                          WXK7DT
     I              B7UVST                          WXUVST
     I              B7UWST                          WXUWST
     I              B7UXST                          WXUXST
     I              B7VSST                          WXVSST
     I              B7AATM                          WXAATM
     I              B7AYNA                          WXAYNA
     I              B7A0NA                          WXA0NA
     I              B7AXDT                          WXAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WDAIC3
     I              L7HGCD                          WDHGCD
     I              L7AJCD                          WDAJCD
     I              L7LTRT                          WDLTRT
     I              L7LRDT                          WDLRDT
     I              L7LLTS                          WDLLTS
     I              L7LSDT                          WDLSDT
     I              L7J5QT                          WDJ5QT
     I              L7G8WG                          WDG8WG
     I              L7LLTN                          WDLLTN
     I              L7YMCD                          WDYMCD
     I              L7LLCL                          WDLLCL
     I              L7BNAA                          WDBNAA
     I              L7LLTR                          WDLLTR
     I              L7Y2CD                          WDY2CD
     I              L7LLTL                          WDLLTL
     I              L7C4NB                          WDC4NB
     I              L7LOST                          WDLOST
     I              L7LLTU                          WDLLTU
     I              L7LLYT                          WDLLYT
     I              L7UVST                          WDUVST
     I              L7UWST                          WDUWST
     I              L7UXST                          WDUXST
     I              L7VSST                          WDVSST
     I              L7AATM                          WDAATM
     I              L7AYNA                          WDAYNA
     I              L7A0NA                          WDA0NA
     I              L7AXDT                          WDAXDT
      *
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WEAIC3
     I              L5HGCD                          WEHGCD
     I              L5AJCD                          WEAJCD
     I              L5ELDT                          WEELDT
     I              L5LXNM                          WELXNM
     I              L5YMCD                          WEYMCD
     I              L5YNCD                          WEYNCD
     I              L5J2QT                          WEJ2QT
     I              L5G5WG                          WEG5WG
     I              L5J3QT                          WEJ3QT
     I              L5G6WG                          WEG6WG
     I              L5J4QT                          WEJ4QT
     I              L5G7WG                          WEG7WG
     I              L5LODT                          WELODT
     I              L5LPDT                          WELPDT
     I              L5LQDT                          WELQDT
     I              L5NBR                           WENBR
     I              L5YTCD                          WEYTCD
     I              L5AMSX                          WEAMSX
     I              L5ASSX                          WEASSX
     I              L5ATSX                          WEATSX
     I              L5AUSX                          WEAUSX
     I              L5YSCD                          WEYSCD
     I              L5UVST                          WEUVST
     I              L5UWST                          WEUWST
     I              L5UXST                          WEUXST
     I              L5VSST                          WEVSST
     I              L5AATM                          WEAATM
     I              L5AYNA                          WEAYNA
     I              L5A0NA                          WEA0NA
     I              L5AXDT                          WEAXDT
      *
     IYARDCS      DS                            111
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     IQPDL21    E DSPDL2REL1
      * UPD : Warehouse Location        Update index
      * Renamed input format fields
     I              L2AJCD                          WIAJCD
     I              L2YMCD                          WIYMCD
     I              L2YPCD                          WIYPCD
     I              L2LCBY                          WILCBY
     I              L2LCCT                          WILCCT
     I              L2WLUS                          WIWLUS
     I              L2WUSD                          WIWUSD
     I              L2WLUN                          WIWLUN
     I              L2AGSX                          WIAGSX
     I              L2UVST                          WIUVST
     I              L2UWST                          WIUWST
     I              L2UXST                          WIUXST
     I              L2VSST                          WIVSST
     I              L2AATM                          WIAATM
     I              L2AYNA                          WIAYNA
     I              L2A0NA                          WIA0NA
     I              L2AXDT                          WIAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WKAIC3
     I              ASAXNB                          WKAXNB
     I              ASNGNB                          WKNGNB
     I              ASBZNB                          WKBZNB
     I              ASC5NB                          WKC5NB
     I              ASC3NB                          WKC3NB
     I              ASCYNB                          WKCYNB
     I              ASIONB                          WKIONB
     I              ASI6NB                          WKI6NB
     I              ASDCNB                          WKDCNB
     I              ASC7NB                          WKC7NB
     I              ASC2NB                          WKC2NB
     I              ASC1NB                          WKC1NB
     I              ASL8NB                          WKL8NB
     I              ASBANB                          WKBANB
     I              ASCHST                          WKCHST
     I              ASCKST                          WKCKST
     I              ASCIST                          WKCIST
     I              ASCGST                          WKCGST
     I              ASAIPC                          WKAIPC
     I              ASASPC                          WKASPC
     I              ASA2VA                          WKA2VA
     I              ASC2ST                          WKC2ST
     I              ASD8ST                          WKD8ST
     I              ASD7ST                          WKD7ST
     I              ASA8NA                          WKA8NA
     I              ASA9NA                          WKA9NA
     I              ASBANA                          WKBANA
     I              ASBBNA                          WKBBNA
     I              ASEUST                          WKEUST
     I              ASAADY                          WKAADY
     I              ASABDY                          WKABDY
     I              ASACDY                          WKACDY
     I              ASADDY                          WKADDY
     I              ASAEDY                          WKAEDY
     I              ASAFDY                          WKAFDY
     I              ASAGDY                          WKAGDY
     I              ASAHDY                          WKAHDY
     I              ASAENB                          WKAENB
     I              ASALNB                          WKALNB
     I              ASEVNB                          WKEVNB
     I              ASRPOP                          WKRPOP
     I              ASDWNB                          WKDWNB
     I              ASR3NB                          WKR3NB
     I              ASPNST                          WKPNST
     I              ASR4NB                          WKR4NB
     I              ASPOST                          WKPOST
     I              ASSCNB                          WKSCNB
     I              ASVIST                          WKVIST
     I              ASVJST                          WKVJST
     I              ASBVVN                          WKBVVN
     I              ASUVST                          WKUVST
     I              ASUWST                          WKUWST
     I              ASUXST                          WKUXST
     I              ASVSST                          WKVSST
     I              ASAATM                          WKAATM
     I              ASAYNA                          WKAYNA
     I              ASA0NA                          WKA0NA
     I              ASAXDT                          WKAXDT
      *
     IYBRDCS      DS                            278
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WRAIC3
     I              B7HGCD                          WRHGCD
     I              B7AJCD                          WRAJCD
     I              B7W9ST                          WRW9ST
     I              B7BSST                          WRBSST
     I              B7B4DT                          WRB4DT
     I              B7C4NY                          WRC4NY
     I              B7DXNB                          WRDXNB
     I              B7ELDT                          WRELDT
     I              B7HVCD                          WRHVCD
     I              B7F1ST                          WRF1ST
     I              B7AUNA                          WRAUNA
     I              B7A5QT                          WRA5QT
     I              B7AHWG                          WRAHWG
     I              B7AKCS                          WRAKCS
     I              B7CGCD                          WRCGCD
     I              B7AYVA                          WRAYVA
     I              B7BJNA                          WRBJNA
     I              B7CKNB                          WRCKNB
     I              B7BMST                          WRBMST
     I              B7CQCD                          WRCQCD
     I              B7DTCD                          WRDTCD
     I              B7MGNA                          WRMGNA
     I              B7TRBN                          WRTRBN
     I              B7TRBS                          WRTRBS
     I              B7C4NB                          WRC4NB
     I              B7RINB                          WRRINB
     I              B7RHNB                          WRRHNB
     I              B7RGNB                          WRRGNB
     I              B7M3NA                          WRM3NA
     I              B7AWTM                          WRAWTM
     I              B7XLCD                          WRXLCD
     I              B7K7DT                          WRK7DT
     I              B7UVST                          WRUVST
     I              B7UWST                          WRUWST
     I              B7UXST                          WRUXST
     I              B7VSST                          WRVSST
     I              B7AATM                          WRAATM
     I              B7AYNA                          WRAYNA
     I              B7A0NA                          WRA0NA
     I              B7AXDT                          WRAXDT
      *
     IYCRDCS      DS                            163
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WVAIC3
     I              B0HGCD                          WVHGCD
     I              B0AJCD                          WVAJCD
     I              B0AGCS                          WVAGCS
     I              B0AECS                          WVAECS
     I              B0BACS                          WVBACS
     I              B0BBCS                          WVBBCS
     I              B0CBPR                          WVCBPR
     I              B0GUDT                          WVGUDT
     I              B0XYST                          WVXYST
     I              B0CTPR                          WVCTPR
     I              B0G4DT                          WVG4DT
     I              B0BOWG                          WVBOWG
     I              B0DDQT                          WVDDQT
     I              B0DEQT                          WVDEQT
     I              B0DFQT                          WVDFQT
     I              B0HDQT                          WVHDQT
     I              B0HEQT                          WVHEQT
     I              B0AJQT                          WVAJQT
     I              B0AQQT                          WVAQQT
     I              B0AUQT                          WVAUQT
     I              B0EMQT                          WVEMQT
     I              B0DOQT                          WVDOQT
     I              B0ATNA                          WVATNA
     I              B0AKDT                          WVAKDT
     I              B0ANDT                          WVANDT
     I              B0IDVA                          WVIDVA
     I              B0JVST                          WVJVST
     I              B0BZPC                          WVBZPC
     I              B0DGQT                          WVDGQT
     I              B0DIDT                          WVDIDT
     I              B0ALCD                          WVALCD
     I              B0BFDY                          WVBFDY
     I              B0DJDT                          WVDJDT
     I              B0BGDY                          WVBGDY
     I              B0DKDT                          WVDKDT
     I              B0J2ST                          WVJ2ST
     I              B0DJQT                          WVDJQT
     I              B0BNWG                          WVBNWG
     I              B0DLDT                          WVDLDT
     I              B0DPQT                          WVDPQT
     I              B0DQQT                          WVDQQT
     I              B0DMDT                          WVDMDT
     I              B0M0ST                          WVM0ST
     I              B0J9ST                          WVJ9ST
     I              B0KBST                          WVKBST
     I              B0AKC8                          WVAKC8
     I              B0RINB                          WVRINB
     I              B0RHNB                          WVRHNB
     I              B0RGNB                          WVRGNB
     I              B0UVST                          WVUVST
     I              B0UWST                          WVUWST
     I              B0UXST                          WVUXST
     I              B0VSST                          WVVSST
     I              B0AATM                          WVAATM
     I              B0AYNA                          WVAYNA
     I              B0A0NA                          WVA0NA
     I              B0AXDT                          WVAXDT
      *
     IYDRDCS      DS                            245
     IYERDCS      DS                            245
     IYFRDCS      DS                            163
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Cvt i5 Loc to CT Loc  XF
      * Cvt i5 Loc to CT Loc  RT - Item Lot Location  * 
     C                     EXSR SARVGN
      * ** Recompile, change to Relocate IF function    FP1127
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Cvt i5 Loc to CT Loc  RT - Item Lot Location  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  4        Location Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@L5CPSV                    *
     C                     READ @L5CPSV                  90*
      * Data record not found
     C   90                MOVEL'USR2634' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Location Number   RT - Warehouse Location CT REF  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0001    P      Warehouse Code
     C                     MOVELWAYMCD    WL0002    P      Location Code
     C                     Z-ADDWAYNCD    WL0003           Location Level
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    YL0001           WLR Location Nu
     C                     MOVELWL0005    YL0002    P      Record Found US
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0002    IFEQ 'N'                        *IF
      * Rtv Location Number   RT - Warehouse Location CT REF  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0001    P      Warehouse Code
     C                     MOVELWAYMCD    WL0002    P      Location Code
     C                     Z-ADD1         WL0003           Location Level
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    YL0001           WLR Location Nu
     C                     MOVELWL0005    YL0002    P      Record Found US
     C                     END                             *FI
      * CASE: LCL.Record Found USR is Record Found
     C           YL0002    IFEQ 'Y'                        *IF
     C                     Z-ADDWALODT    YL0003           ILL Avail Ship
     C                     MOVEL*BLANK    WN0001           Location Code
     C                     MOVELYL0001    WN0001           Location Code
      *
     C                     Z-ADD*ZERO     WN0002  70       Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0003  70       Avail Ship Date
      *
      * Relocate Item         IF
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Update From Lot/Location
     C           WAJ2QT    MULT -1        WN0002           Quantity Loc Tr
      *
     C                     Z-ADD*ZERO     WN0004  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0005  1        EDI Status 1
     C                     MOVEL*BLANK    WN0006  1        EDI Status 2
     C                     MOVEL*BLANK    WN0007  1        EDI Status 3
     C                     MOVEL*BLANK    WN0008  1        Record Status
     C                     Z-ADD*ZERO     WN0009  60       Job Time
     C                     MOVEL*BLANK    WN0010 10        User Id
     C                     MOVEL*BLANK    WN0011 10        Job Name
     C                     Z-ADD*ZERO     WN0012  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0006           Company Number
     C                     Z-ADDWAHGCD    WL0007           Item Code
     C                     MOVELWAAJCD    WL0008    P      Warehouse Code
     C                     MOVEL'T'       WL0009    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0010           LLT Trans Date
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    WN0004           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0012           Company Number
     C                     Z-ADDWAHGCD    WL0013           Item Code
     C                     MOVELWAAJCD    WL0014    P      Warehouse Code
     C                     MOVEL'T'       WL0015    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0016           LLT Trans Date
     C                     Z-ADDWN0004    WL0017           LLT Sequence #
     C                     Z-ADDWAELDT    WL0018           LLT Production
     C                     Z-ADDWN0002    WL0019           LLT Trans Qty
     C                     Z-ADD*ZERO     WL0020           LLT Trans Wgt
     C                     Z-ADDWALXNM    WL0021           LLT Lot Number
     C                     MOVELWAYMCD    WL0022    P      Location Code
     C                     Z-ADDWAYNCD    WL0023           LLT Location Le
     C                     MOVELWAAJCD    WL0024    P      Transfer Wareho
     C                     Z-ADDWALXNM    WL0025           LLT Transfer Lo
     C                     MOVELWN0001    WL0026    P      Transfer Locati
     C                     Z-ADD*ZERO     WL0027           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0028           Order Number
     C                     MOVEL'P'       WL0029    P      LLT Status
     C                     MOVELWULLTU    WL0030    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0031    P      LTT Unused Sts
     C                     MOVELWN0005    WL0032    P      EDI Status 1
     C                     MOVELWN0006    WL0033    P      EDI Status 2
     C                     MOVELWN0007    WL0034    P      EDI Status 3
     C                     MOVELWN0008    WL0035    P      Record Status
     C                     Z-ADDWN0009    WL0036           Job Time
     C                     MOVELWN0010    WL0037    P      User Id
     C                     MOVELWN0011    WL0038    P      Job Name
     C                     Z-ADDWN0012    WL0039           Job Date
     C                     EXSR SDCRRC
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0040           Company Number
     C                     Z-ADDWAHGCD    WL0041           Item Code
     C                     MOVELWAAJCD    WL0042    P      Warehouse Code
     C                     Z-ADDWAELDT    WL0043           Production Date
     C                     Z-ADDWALXNM    WL0044           Lot Number
     C                     MOVELWAYMCD    WL0045    P      Location Code
     C                     Z-ADDWAYNCD    WL0046           Location Level
     C                     Z-ADDWAG5WG    WL0047           ILL Unit Weight
     C                     Z-ADDYL0003    WL0048           ILL Avail Ship
     C                     Z-ADDWALPDT    WL0049           ILL Unused Date
     C                     MOVELWAAMSX    WL0050    P      ILL Status
     C                     MOVELWAYSCD    WL0051    P      Inv Hold Reason
     C                     Z-ADDWN0002    WL0052           Quantity Loc Tr
     C                     EXSR SERVGN
      * Create To Lot/Location
      * Val Location Exists   RT - Warehouse Location  * 
     C                     EXSR SKRVGN
      * Create Warehouse Location if one does not exist.
      * CASE: LCL.Record Found -PS CD USR is Record Not Found
     C           YL0004    IFEQ 'N'                        *IF
     C                     Z-ADD1         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0001:ZQ YL0005    P  90  Location Aisle
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0001:ZQ YL0006    P  90  Location Bay Al
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0006    YL0007           Location Bay
      * Crt Whs Location      CR - Warehouse Location  * 
     C                     EXSR SLCRRC
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0056  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0057  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
     C                     EXSR SMRVGN
      * Rtv Chill Time        RT - Warehouse Location Type  * 
     C                     EXSR SNRVGN
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WAELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0057    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL@CN,001   XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0003
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0003
     C                     END
      * To Location Available Ship Date
      * CASE: PAR.Avail Ship Date USR LT PAR.ILL Avail Ship Date
     C           WN0003    IFLT YL0003                     *IF
     C                     Z-ADDWN0003    YL0003           ILL Avail Ship
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0058  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0059  1        EDI Status 1
     C                     MOVEL*BLANK    WN0060  1        EDI Status 2
     C                     MOVEL*BLANK    WN0061  1        EDI Status 3
     C                     MOVEL*BLANK    WN0062  1        Record Status
     C                     Z-ADD*ZERO     WN0063  60       Job Time
     C                     MOVEL*BLANK    WN0064 10        User Id
     C                     MOVEL*BLANK    WN0065 10        Job Name
     C                     Z-ADD*ZERO     WN0066  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0006           Company Number
     C                     Z-ADDWAHGCD    WL0007           Item Code
     C                     MOVELWAAJCD    WL0008    P      Warehouse Code
     C                     MOVEL'RT'      WL0009    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0010           LLT Trans Date
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    WN0058           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0012           Company Number
     C                     Z-ADDWAHGCD    WL0013           Item Code
     C                     MOVELWAAJCD    WL0014    P      Warehouse Code
     C                     MOVEL'RT'      WL0015    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0016           LLT Trans Date
     C                     Z-ADDWN0058    WL0017           LLT Sequence #
     C                     Z-ADDWAELDT    WL0018           LLT Production
     C                     Z-ADDWAJ2QT    WL0019           LLT Trans Qty
     C                     Z-ADD*ZERO     WL0020           LLT Trans Wgt
     C                     Z-ADDWALXNM    WL0021           LLT Lot Number
     C                     MOVELWN0001    WL0022    P      Location Code
     C                     Z-ADD*ZERO     WL0023           LLT Location Le
     C                     MOVELWAAJCD    WL0024    P      Transfer Wareho
     C                     Z-ADDWALXNM    WL0025           LLT Transfer Lo
     C                     MOVELWAYMCD    WL0026    P      Transfer Locati
     C                     Z-ADDWAYNCD    WL0027           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0028           Order Number
     C                     MOVEL'P'       WL0029    P      LLT Status
     C                     MOVELWULLTU    WL0030    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0031    P      LTT Unused Sts
     C                     MOVELWN0059    WL0032    P      EDI Status 1
     C                     MOVELWN0060    WL0033    P      EDI Status 2
     C                     MOVELWN0061    WL0034    P      EDI Status 3
     C                     MOVELWN0062    WL0035    P      Record Status
     C                     Z-ADDWN0063    WL0036           Job Time
     C                     MOVELWN0064    WL0037    P      User Id
     C                     MOVELWN0065    WL0038    P      Job Name
     C                     Z-ADDWN0066    WL0039           Job Date
     C                     EXSR SDCRRC
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0040           Company Number
     C                     Z-ADDWAHGCD    WL0041           Item Code
     C                     MOVELWAAJCD    WL0042    P      Warehouse Code
     C                     Z-ADDWAELDT    WL0043           Production Date
     C                     Z-ADDWALXNM    WL0044           Lot Number
     C                     MOVELWN0001    WL0045    P      Location Code
     C                     Z-ADD*ZERO     WL0046           Location Level
     C                     Z-ADDWAG5WG    WL0047           ILL Unit Weight
     C                     Z-ADDYL0003    WL0048           ILL Avail Ship
     C                     Z-ADDWALPDT    WL0049           ILL Unused Date
     C                     MOVELWAAMSX    WL0050    P      ILL Status
     C                     MOVELWAYSCD    WL0051    P      Inv Hold Reason
     C                     Z-ADDWAJ2QT    WL0052           Quantity Loc Tr
     C                     EXSR SERVGN
      * ** Process Auto-Locate Whse inventory added       FP1127
      * Transfer Item Balance/Item Balance Detail.
      * CASE: PAR.Reloc/Trans STS USR is Transfer
     C           'R'       IFEQ 'T'                        *IF
      * RTV Next Tran Batch #  CH - Company Control  * 
     C                     EXSR SOCHRC
     C                     Z-ADDWAJ2QT    YL0009           Transaction Qua
      * RTV Label Date         RT - Item Balance Detail  * 
     C                     EXSR SPRVGN
      * Rtv Base Values        RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0072           Company Number
     C                     Z-ADDWAHGCD    WL0073           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0074    YL0011    P      Description Lin
     C                     MOVELWL0075    YL0012    P      Description Lin
     C                     MOVELWL0076    YL0013    P      U/M - Primary
     C                     Z-ADDWL0077    YL0014           Conversion Fact
     C                     MOVELWL0078    YL0015    P      Operation Facto
     C                     MOVELWL0079    YL0016    P      U/M - Second
     C                     Z-ADDWL0080    YL0017           Conversion Fact
     C                     MOVELWL0081    YL0018    P      Operation Facto
     C                     MOVELWL0082    YL0019    P      U/M - Third
     C                     MOVELWL0083    YL0020    P      U/M - Pricing
     C                     Z-ADDWL0084    YL0021           Unit Weight
     C                     MOVELWL0085    YL0022    P      Production Date
     C                     MOVELWL0086    YL0023    P      Catch Weight St
     C                     Z-ADDWL0087    YL0024           Fresh Chilling
      * Clc Convert Weight     XF
     C                     Z-ADD*ZERO     YL0026           USR Weight base
     C                     Z-ADD*ZERO     YL0027           USR Weight base
     C                     Z-ADD*ZERO     YL0028           USR Weight base
     C                     Z-ADDYL0021    YL0026           USR Weight base
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           YL0016    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0014    IFNE *ZERO                      *IF
     C           YL0021    DIV  YL0014    WUASWG    H      USR Weight
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0015    IFEQ 'D'                        *IF
     C           YL0021    MULT YL0014    WUASWG    H      USR Weight
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUASWG    YL0027           USR Weight base
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           YL0019    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0018    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0017    IFNE *ZERO                      *IF
     C           WUASWG    DIV  YL0017    YL0028    H      USR Weight base
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0018    IFEQ 'D'                        *IF
     C           WUASWG    MULT YL0017    YL0028    H      USR Weight base
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0009    MULT YL0026    YL0029    H      Transaction Wei
      * Rtv Status/Default     RT - Item Balance  * From Warehouse
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0088           Company Number
     C                     Z-ADDWAHGCD    WL0089           Item Code
     C                     MOVELWAAJCD    WL0090    P      Warehouse Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0091    YL0030           Unit Cost Per P
     C                     MOVELWL0092    YL0031    P      Cost Update Pen
     C                     MOVELWL0093    YL0032    P      Post G/L Status
     C                     Z-ADDWL0094    YL0033           Vendor - Item/W
     C                     MOVELWL0095    YL0034    P      Record Status
      * Rtv Status/Default     RT - Item Balance  * To Warehouse
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0088           Company Number
     C                     Z-ADDWAHGCD    WL0089           Item Code
     C                     MOVELWAAJCD    WL0090    P      Warehouse Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0091    YL0035           Unit Cost Per P
     C                     MOVELWL0092    WUG0TX    P      Cost Update Pen
     C                     MOVELWL0093    WUG0TX    P      Post G/L Status
     C                     Z-ADDWL0094    WUNFNN           Vendor - Item/W
     C                     MOVELWL0095    YL0034    P      Record Status
      * ** Add: Process Auto-Locate Whse inventory             FP1127
      *
     C                     Z-ADD*ZERO     WN0125  30       Item Structure
     C                     Z-ADD*ZERO     WN0126  30       Item Structure
     C                     Z-ADD*ZERO     WN0127  30       Item Structure
     C                     Z-ADD*ZERO     WN0128  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0129  30       Sequence Number
     C                     Z-ADD*ZERO     WN0130 114       USR Transaction
     C                     Z-ADD*ZERO     WN0131 112       Extended Amount
     C                     Z-ADD*ZERO     WN0132 112       Quantity based
     C                     Z-ADD*ZERO     WN0133 112       Quantity based
     C                     Z-ADD*ZERO     WN0134 112       Quantity based
     C                     Z-ADD*ZERO     WN0135 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0136 112       On Hand U/M1 Su
     C                     Z-ADD*ZERO     WN0137 112       Value of On Han
     C                     Z-ADD*ZERO     WN0138  70       Production Date
     C                     Z-ADD*ZERO     WN0139  70       Label Date  USR
     C                     MOVEL*BLANK    WN0140  3        USR Reason Code
      *
      * UPD Balances Transfer  IF
      * The following block of code will update Item Balance,
      * Item Balance Detail and Transaction Detail for the FROM ITEM
     C                     EXSR UASUBR
      * *****************************************************************
     C                     MOVEL'TRF'     WN0140           USR Reason Code
      * Error if FROM unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           YL0030    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0140           USR Reason Code
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0141 112       Quantity based
     C                     Z-ADD*ZERO     WN0142 112       Quantity based
     C                     Z-ADD*ZERO     WN0143 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0132           USR Qty based o
     C                     Z-ADD*ZERO     WN0133           USR Qty based o
     C                     Z-ADD*ZERO     WN0134           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           YL0013    IFEQ YL0013                     *IF
     C                     Z-ADDYL0009    WN0132           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           YL0016    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
     C           YL0009    MULT YL0014    WN0142    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0015    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0014    IFNE *ZERO                      *IF
     C           YL0009    DIV  YL0014    WN0142    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0142    WN0133           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           YL0019    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0018    IFEQ 'M'                        *IF
     C           WN0142    MULT YL0017    WN0143    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0018    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0017    IFNE *ZERO                      *IF
     C           WN0142    DIV  YL0017    WN0143    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0143    WN0134           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           YL0016    IFEQ YL0013                     *IF
     C                     Z-ADDYL0009    WN0133           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0014    IFNE *ZERO                      *IF
     C           YL0009    DIV  YL0014    WN0132    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0015    IFEQ 'D'                        *IF
     C           YL0009    MULT YL0014    WN0132    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           YL0019    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0018    IFEQ 'M'                        *IF
     C           YL0009    MULT YL0017    WN0143    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0018    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0017    IFNE *ZERO                      *IF
     C           YL0009    DIV  YL0017    WN0143    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0143    WN0134           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           YL0019    IFEQ YL0013                     *IF
     C                     Z-ADDYL0009    WN0134           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           YL0018    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           YL0017    IFNE *ZERO                      *IF
     C           YL0009    DIV  YL0017    WN0142    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           YL0018    IFEQ 'D'                        *IF
     C           YL0009    MULT YL0017    WN0142    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0142    WN0133           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           YL0015    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           YL0014    IFNE *ZERO                      *IF
     C           WN0142    DIV  YL0014    WN0132    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           YL0015    IFEQ 'D'                        *IF
     C           WN0142    MULT YL0014    WN0132    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0030    MULT YL0029    WN0131    H      Extended Amount
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0096           Company Number
     C                     Z-ADDWAHGCD    WL0097           Item Code
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0098    WN0125           Item Structure
     C                     Z-ADDWL0099    WN0126           Item Structure
     C                     Z-ADDWL0100    WN0127           Item Structure
      * Adjust sign of transaction based on transaction type
      * CASE: PAR.Inventory Trans. Type is Transfer Warehouse
     C           'TW'      IFEQ 'TW'                       *IF
     C                     ADD  1         YL0036           Transfer Batch
     C                     Z-ADDYL0029    WUAHWG           Transaction Wei
     C                     Z-ADDYL0009    WUA5QT           Transaction Qua
      * CASE: PAR.USR Unship Flag is yes
     C           'N'       IFEQ 'Y'                        *IF
      * if this is an Unship, reverse the TO whse qty/wgt (neg rct)
     C           *ZERO     SUB  WUA5QT    WUA5QT           Transaction Qua
     C           *ZERO     SUB  WUAHWG    WUAHWG           Transaction Wei
     C                     ELSE
      * CASE: *OTHERWISE
      * if this is NOT an Unship, reverse the FROM whse qty, wgt (reverse
     C           *ZERO     SUB  YL0009    YL0009           Transaction Qua
     C           *ZERO     SUB  WN0132    WN0132           Quantity based
     C           *ZERO     SUB  YL0029    YL0029           Transaction Wei
     C           *ZERO     SUB  WN0131    WN0131           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0101           Company Number
     C                     Z-ADDWAHGCD    WL0102           Item Code
     C                     MOVELWAAJCD    WL0103    P      Warehouse Code
     C                     MOVEL'T'       WL0104    P      Inventory Trans
     C                     MOVEL'TW'      WL0105    P      Inventory Trans
     C                     Z-ADD##JDT     WL0106           Transaction Dat
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0107    WN0128           ITD Sequence Nu
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
     C                     EXSR SUCRRC
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
     C                     EXSR SVCHRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0146           Company Number
     C                     Z-ADDWAHGCD    WL0147           Item Code
     C                     MOVELWAAJCD    WL0148    P      Warehouse Code
     C                     Z-ADDWN0135    WL0149           Quantity on Han
     C                     Z-ADDWN0136    WL0150           Quantity on Han
     C                     Z-ADDWUNFNN    WL0151           Quantity on Han
     C                     Z-ADDWUNFNN    WL0152           Quantity on Han
     C                     Z-ADDWN0137    WL0153           Value of On Han
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0149    WN0135           Quantity on Han
     C                     Z-ADDWL0150    WN0136           Quantity on Han
     C                     Z-ADDWL0151    WUNFNN           Quantity on Han
     C                     Z-ADDWL0152    WUNFNN           Quantity on Han
     C                     Z-ADDWL0153    WN0137           Value of On Han
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
     C                     EXSR TACHRC
      * ** FP1127:
      * ** Update location quantity on hand for External warehouse that
      * ** is lot controlled and not Carlisle controlled
      * ** Optional Lot number is passed in from the calling program
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0154    P      Warehouse Code
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0155    YN0001    P      Warehouse Descr
     C                     MOVELWL0156    YN0002    P      Address Line 1
     C                     MOVELWL0157    YN0003    P      Address Line 2
     C                     MOVELWL0158    YN0004    P      Address Line 3
     C                     MOVELWL0159    YN0005    P      City
     C                     MOVELWL0160    YN0006    P      Zip/Postal Code
     C                     MOVELWL0161    YN0007    P      Production Ware
     C                     MOVELWL0162    YN0008    P      State Code
     C                     MOVELWL0163    YL0037    P      Lot Tracking Fl
     C                     MOVELWL0164    YN0009    P      Default Printer
     C                     MOVELWL0165    YN0010    P      Warehouse Type
     C                     MOVELWL0166    YN0011    P      Trans Contol AS
     C                     MOVELWL0167    YL0038    P      Warehouse Locat
     C                     MOVELWL0168    YN0012    P      Warehouse Std C
     C                     Z-ADDWL0169    YN0013           Warehouse Chill
     C                     MOVELWL0170    YN0014    P      Include in Auto
     C                     MOVELWL0171    YN0015    P      Default Manifes
     C                     MOVELWL0172    YN0016    P      Default Load Se
     C                     MOVELWL0173    YN0017    P      WHS Slotting Li
     C                     Z-ADDWL0174    YN0018           Shipping Compan
     C                     Z-ADDWL0175    YN0019           Accounting Comp
     C                     Z-ADDWL0176    YN0020           WHS Sched Prod
     C                     Z-ADDWL0177    YN0021           WHS Inventory C
     C                     MOVELWL0178    YN0022    P      Parent Warehous
     C                     MOVELWL0179    YN0023    P      Default Shippin
     C                     MOVELWL0180    YL0039    P      WHS Live w/Carl
     C                     MOVELWL0181    YN0024    P      WHS PFS Interfa
     C                     MOVELWL0182    YN0025    P      WHS Req Meter R
     C                     MOVELWL0183    YN0026    P      WHS Default Loa
     C                     MOVELWL0184    YN0027    P      WHS Unused Sts
     C                     MOVELWL0185    YN0028    P      Default Carrier
     C                     MOVELWL0186    YN0029    P      WHS TPM Locatio
     C                     MOVELWL0187    YN0030    P      WHS Unused Sts
     C                     MOVELWL0188    YN0031    P      EDI Status 1
     C                     MOVELWL0189    YN0032    P      EDI Status 2
     C                     MOVELWL0190    YN0033    P      EDI Status 3
     C                     MOVELWL0191    YN0034    P      Record Status
     C                     Z-ADDWL0192    YN0035           Job Time
     C                     MOVELWL0193    YN0036    P      User Id
     C                     MOVELWL0194    YN0037    P      Job Name
     C                     Z-ADDWL0195    YN0038           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0038    IFEQ 'E'                        *IF
     C           YL0039    IFEQ *BLANK                     *IF
     C           YL0039    OREQ 'N'
     C           YL0037    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0196    P      Warehouse Code
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0197    WUYMCD    P      Location Code
     C                     MOVELWL0198    YL0040    P      Location Aisle
     C                     Z-ADDWL0199    YL0041           Location Bay
     C                     Z-ADDWL0200    YL0042           Loc Unused Chil
      * ** Lot # will be the "from warehouse" lot# or zeros    FP1127
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0056  30       Company Number
     C                     PARM WAHGCD    WQ0057  70       Item Code
     C                     PARM WAAJCD    WQ0058  3        Warehouse Code
     C                     PARM WAELDT    WQ0059  70       Production Date
     C                     PARM WALXNM    WQ0060  50       Lot Number
     C                     PARM WUYMCD    WQ0061  4        Location Code
     C                     PARM WUYNCD    WQ0062  20       Location Level
     C                     PARM YL0009    WQ0063  70       Quantity Loc Tr
     C                     PARM *ZERO     WQ0064  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *****************************************************************
      * The following block of code will update Item Balance,
      * Item Balance Detail and Transaction Detail for the TO ITEM
      * *****************************************************************
      * ** 12/05/2008 LJB FP1127 Update Auto-Locate Whse inventory
      * ** Only process auto-locate if not a Carlisle Controlled warehous
      * ** and lot tracking has been turned on.
      * 12/04/06 PKD PK0040 Only add inventory to the To Warehouse
      *              if the Inter-Plant Transfer is No.  If the Inter-Pla
      *              Transfer is Yes, then the receiving plant's receivin
      *              process will add the inventory to the To Warehouse.
      * RTV Shipping Co        RT - Warehouse  * 
     C                     EXSR TDRVGN
      * CASE: PAR.Inter-Plant Transfer USR is No
     C           'N'       IFEQ 'N'                        *IF
      * Validate that Item Balance for TO Whse exists; if not, create it
      * Val Item Balance       RT - Item Balance  * 
     C                     EXSR TERVGN
      * Create item balance if none exists
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Balance       CR - Item Balance  * 
     C                     EXSR TFCRRC
     C                     END                             *FI
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost - Detail EQ WRK.ZERO
     C           YL0035    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0140           USR Reason Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'TRF'     WN0140           USR Reason Code
     C                     END                             *FI
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0043    WL0096           Company Number
     C                     Z-ADDWAHGCD    WL0097           Item Code
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0098    WN0125           Item Structure
     C                     Z-ADDWL0099    WN0126           Item Structure
     C                     Z-ADDWL0100    WN0127           Item Structure
     C           YL0035    MULT WUAHWG    WN0131    H      Extended Amount
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0043    WL0101           Company Number
     C                     Z-ADDWAHGCD    WL0102           Item Code
     C                     MOVELWAAJCD    WL0103    P      Warehouse Code
     C                     MOVEL'T'       WL0104    P      Inventory Trans
     C                     MOVEL'TW'      WL0105    P      Inventory Trans
     C                     Z-ADD##JDT     WL0106           Transaction Dat
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0107    WN0128           ITD Sequence Nu
      * Reset Production/Label Date if Lot Tracking warehouse.
     C                     EXSR UBSUBR                     Reset Productio
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0043    WL0201           Company Number
     C                     Z-ADDWAHGCD    WL0202           Item Code
     C                     MOVELWAAJCD    WL0203    P      Warehouse Code
     C                     MOVEL'T'       WL0204    P      Inventory Trans
     C                     MOVEL'TW'      WL0205    P      Inventory Trans
     C                     Z-ADD##JDT     WL0206           Transaction Dat
     C                     Z-ADDWN0128    WL0207           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0208           Sequence Number
     C                     Z-ADDWN0138    WL0209           Production Date
     C                     MOVELYL0013    WL0210    P      U/M - Transacti
     C                     MOVEL'IC'      WL0211    P      Item Transactio
     C                     MOVEL@CN,003   WL0212    P      Description
     C                     Z-ADDWUA5QT    WL0213           Transaction Qua
     C                     Z-ADDWUAHWG    WL0214           Transaction Wei
     C                     Z-ADD*ZERO     WL0215           USR Transaction
     C                     MOVEL'LB'      WL0216    P      U/M - Cost
     C                     Z-ADDWN0131    WL0217           Extended Amount
     C                     MOVEL*BLANK    WL0218           Ticket Number
     C                     Z-ADD*ZERO     WL0219           G/L Document Nu
     C                     MOVEL*BLANK    WL0220           G/L Update Stat
     C                     MOVELWN0140    WL0221    P      Reason Code
     C                     MOVEL*BLANK    WL0222           Reference Numbe
     C                     MOVEL*BLANK    WL0223           Lot ID
     C                     Z-ADDYL0008    WL0224           Transfer Batch
     C                     Z-ADDYL0036    WL0225           Transfer Batch
     C                     Z-ADD*ZERO     WL0226           Order Number
     C                     Z-ADDWN0125    WL0227           Item Structure
     C                     Z-ADDWN0126    WL0228           Item Structure
     C                     Z-ADDWN0127    WL0229           Item Structure
     C                     MOVEL*BLANK    WL0230           Employee Badge
     C                     Z-ADD*ZERO     WL0231           Production Time
     C                     MOVEL'1'       WL0232    P      Shift Number
     C                     Z-ADDWN0139    WL0233           Label Date
     C                     MOVEL*BLANK    WL0234           EDI Status 1
     C                     MOVEL*BLANK    WL0235           EDI Status 2
     C                     MOVEL*BLANK    WL0236           EDI Status 3
     C                     MOVEL'A'       WL0237    P      Record Status
     C                     EXSR TGCRRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * * Post transaction to Item Balance & Item Balance Detail
      * Prc Create Dtl Receipt IF
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
     C                     EXSR THRVGN
      * ** Process Auto-Locate Whse inventory             FP1127
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0154    P      Warehouse Code
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0155    YN0001    P      Warehouse Descr
     C                     MOVELWL0156    YN0002    P      Address Line 1
     C                     MOVELWL0157    YN0003    P      Address Line 2
     C                     MOVELWL0158    YN0004    P      Address Line 3
     C                     MOVELWL0159    YN0005    P      City
     C                     MOVELWL0160    YN0006    P      Zip/Postal Code
     C                     MOVELWL0161    YN0007    P      Production Ware
     C                     MOVELWL0162    YN0008    P      State Code
     C                     MOVELWL0163    YL0037    P      Lot Tracking Fl
     C                     MOVELWL0164    YN0009    P      Default Printer
     C                     MOVELWL0165    YN0010    P      Warehouse Type
     C                     MOVELWL0166    YN0011    P      Trans Contol AS
     C                     MOVELWL0167    YL0038    P      Warehouse Locat
     C                     MOVELWL0168    YN0012    P      Warehouse Std C
     C                     Z-ADDWL0169    YN0013           Warehouse Chill
     C                     MOVELWL0170    YN0014    P      Include in Auto
     C                     MOVELWL0171    YN0015    P      Default Manifes
     C                     MOVELWL0172    YN0016    P      Default Load Se
     C                     MOVELWL0173    YN0017    P      WHS Slotting Li
     C                     Z-ADDWL0174    YN0018           Shipping Compan
     C                     Z-ADDWL0175    YN0019           Accounting Comp
     C                     Z-ADDWL0176    YN0020           WHS Sched Prod
     C                     Z-ADDWL0177    YN0021           WHS Inventory C
     C                     MOVELWL0178    YN0022    P      Parent Warehous
     C                     MOVELWL0179    YN0023    P      Default Shippin
     C                     MOVELWL0180    YL0039    P      WHS Live w/Carl
     C                     MOVELWL0181    YN0024    P      WHS PFS Interfa
     C                     MOVELWL0182    YN0025    P      WHS Req Meter R
     C                     MOVELWL0183    YN0026    P      WHS Default Loa
     C                     MOVELWL0184    YN0027    P      WHS Unused Sts
     C                     MOVELWL0185    YN0028    P      Default Carrier
     C                     MOVELWL0186    YN0029    P      WHS TPM Locatio
     C                     MOVELWL0187    YN0030    P      WHS Unused Sts
     C                     MOVELWL0188    YN0031    P      EDI Status 1
     C                     MOVELWL0189    YN0032    P      EDI Status 2
     C                     MOVELWL0190    YN0033    P      EDI Status 3
     C                     MOVELWL0191    YN0034    P      Record Status
     C                     Z-ADDWL0192    YN0035           Job Time
     C                     MOVELWL0193    YN0036    P      User Id
     C                     MOVELWL0194    YN0037    P      Job Name
     C                     Z-ADDWL0195    YN0038           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0038    IFEQ 'E'                        *IF
     C           YL0039    IFEQ *BLANK                     *IF
     C           YL0039    OREQ 'N'
     C           YL0037    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Lot Number is passed in and is optional
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0196    P      Warehouse Code
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0197    WUYMCD    P      Location Code
     C                     MOVELWL0198    YL0040    P      Location Aisle
     C                     Z-ADDWL0199    YL0041           Location Bay
     C                     Z-ADDWL0200    YL0042           Loc Unused Chil
      * ** Lot# will be the "to warehouse" lot# or zeros    FP1127
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0114  30       Company Number
     C                     PARM WAHGCD    WQ0115  70       Item Code
     C                     PARM WAAJCD    WQ0116  3        Warehouse Code
     C                     PARM ##JDT     WQ0117  70       Production Date
     C                     PARM *ZERO     WQ0118  50       Lot Number
     C                     PARM WUYMCD    WQ0119  4        Location Code
     C                     PARM WUYNCD    WQ0120  20       Location Level
     C                     PARM WUA5QT    WQ0121  70       Quantity Loc Tr
     C                     PARM *ZERO     WQ0122  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @L5CPSV                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Location Number   RT - Warehouse Location CT REF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJCD           Warehouse Code
     C                     KFLD           WBYMCD           Location Code
     C                     KFLD           WBYNCD           Location Level
      * Setup key
     C                     MOVELWL0001    WBAJCD           Warehouse Code
     C                     MOVELWL0002    WBYMCD           Location Code
     C                     Z-ADDWL0003    WBYNCD           Location Level
      * Establish starting position
     C           KRSSB     CHAIN@BWREDP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3563' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WL0004           WLR Location Nu
     C                     MOVEL'N'       WL0005           Record Found US
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWBCNNY    WL0004           WLR Location Nu
     C                     MOVEL'Y'       WL0005           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCHGCD    WQSC02           Item Code
     C           *LIKE     DEFN WCAJCD    WQSC03           Warehouse Code
     C           *LIKE     DEFN WCLTRT    WQSC04           LLT Trans Type
     C           *LIKE     DEFN WCLRDT    WQSC05           LLT Trans Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Item Code
     C                     KFLD           WQSC03           Warehouse Code
     C                     KFLD           WQSC04           LLT Trans Type
     C                     KFLD           WQSC05           LLT Trans Date
      * Setup key
     C                     Z-ADDWL0006    WQSC01           Company Number
     C                     Z-ADDWL0007    WQSC02           Item Code
     C                     MOVELWL0008    WQSC03           Warehouse Code
     C                     MOVELWL0009    WQSC04           LLT Trans Type
     C                     Z-ADDWL0010    WQSC05           LLT Trans Date
      * Establish starting position
     C           KRSSC     SETLL@L7CPUK                    *
     C           KRSSC     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0011           LLT Sequence #
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WCLLTS    ADD  1         WL0011           LLT Sequence #
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0012    WDAIC3           Company Number
     C                     Z-ADDWL0013    WDHGCD           Item Code
     C                     MOVELWL0014    WDAJCD           Warehouse Code
     C                     MOVELWL0015    WDLTRT           LLT Trans Type
     C                     Z-ADDWL0016    WDLRDT           LLT Trans Date
     C                     Z-ADDWL0017    WDLLTS           LLT Sequence #
     C                     Z-ADDWL0018    WDLSDT           LLT Production
     C                     Z-ADDWL0019    WDJ5QT           LLT Trans Qty
     C                     Z-ADDWL0020    WDG8WG           LLT Trans Wgt
     C                     Z-ADDWL0021    WDLLTN           LLT Lot Number
     C                     MOVELWL0022    WDYMCD           Location Code
     C                     Z-ADDWL0023    WDLLCL           LLT Location Le
     C                     MOVELWL0024    WDBNAA           Transfer Wareho
     C                     Z-ADDWL0025    WDLLTR           LLT Transfer Lo
     C                     MOVELWL0026    WDY2CD           Transfer Locati
     C                     Z-ADDWL0027    WDLLTL           LLT Transfer Lo
     C                     Z-ADDWL0028    WDC4NB           Order Number
     C                     MOVELWL0029    WDLOST           LLT Status
     C                     MOVELWL0030    WDLLTU           LTT Unused Sts
     C                     MOVELWL0031    WDLLYT           LTT Unused Sts
     C                     MOVELWL0032    WDUVST           EDI Status 1
     C                     MOVELWL0033    WDUWST           EDI Status 2
     C                     MOVELWL0034    WDUXST           EDI Status 3
     C                     MOVELWL0035    WDVSST           Record Status
     C                     Z-ADDWL0036    WDAATM           Job Time
     C                     MOVELWL0037    WDAYNA           User Id
     C                     MOVELWL0038    WDA0NA           Job Name
     C                     Z-ADDWL0039    WDAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C           KLCRSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDLTRT           LLT Trans Type
     C                     KFLD           WDLRDT           LLT Trans Date
     C                     KFLD           WDLLTS           LLT Sequence #
      * Check for duplicate primary key
     C           KLCRSD    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0013  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0014  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0015 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0016  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0017 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0018  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0019  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0020  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0021  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0022  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0023  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0024  1        EDI Status 1
     C                     MOVEL*BLANK    WN0025  1        EDI Status 2
     C                     MOVEL*BLANK    WN0026  1        EDI Status 3
     C                     MOVEL*BLANK    WN0027  1        Record Status
     C                     Z-ADD*ZERO     WN0028  60       Job Time
     C                     MOVEL*BLANK    WN0029 10        User Id
     C                     MOVEL*BLANK    WN0030 10        Job Name
     C                     Z-ADD*ZERO     WN0031  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
     C                     KFLD           WAAJCD           Warehouse Code
     C                     KFLD           WAELDT           Production Date
     C                     KFLD           WALXNM           Lot Number
     C                     KFLD           WAYMCD           Location Code
     C                     KFLD           WAYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0040    WAAIC3           Company Number
     C                     Z-ADDWL0041    WAHGCD           Item Code
     C                     MOVELWL0042    WAAJCD           Warehouse Code
     C                     Z-ADDWL0043    WAELDT           Production Date
     C                     Z-ADDWL0044    WALXNM           Lot Number
     C                     MOVELWL0045    WAYMCD           Location Code
     C                     Z-ADDWL0046    WAYNCD           Location Level
      * Establish starting position
     C           KRSSE     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Loc          CR - Item Lot Location  * 
     C                     EXSR SFCRRC
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WAJ2QT    ADD  WL0052    WN0013           ILL Item Qty On
      * CASE: PAR.ILL Item Qty On-Hand is GT Zero
     C           WN0013    IFGT *ZERO                      *IF
      * Chg Quantity On-Hand  CH - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0053           Company Number
     C                     Z-ADDWAHGCD    WL0054           Item Code
     C                     MOVELWAAJCD    WL0055    P      Warehouse Code
     C                     Z-ADDWAELDT    WL0056           Production Date
     C                     Z-ADDWALXNM    WL0057           Lot Number
     C                     MOVELWAYMCD    WL0058    P      Location Code
     C                     Z-ADDWAYNCD    WL0059           Location Level
     C                     Z-ADDWN0013    WL0060           ILL Item Qty On
     C                     EXSR SGCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Item Location     DL - IC Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0061           Company Number
     C                     Z-ADDWAHGCD    WL0062           Item Code
     C                     MOVELWAAJCD    WL0063    P      Warehouse Code
     C                     Z-ADDWAELDT    WL0064           Production Date
     C                     Z-ADDWALXNM    WL0065           Lot Number
     C                     MOVELWAYMCD    WL0066    P      Location Code
     C                     Z-ADDWAYNCD    WL0067           Location Level
     C                     EXSR SHDLRC
      * Del Item Balance Dtl  RT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0068           Company Number
     C                     Z-ADDWAHGCD    WL0069           Item Code
     C                     MOVELWAAJCD    WL0070    P      Warehouse Code
     C                     Z-ADDWAELDT    WL0071           Production Date
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0040    WEAIC3           Company Number
     C                     Z-ADDWL0041    WEHGCD           Item Code
     C                     MOVELWL0042    WEAJCD           Warehouse Code
     C                     Z-ADDWL0043    WEELDT           Production Date
     C                     Z-ADDWL0044    WELXNM           Lot Number
     C                     MOVELWL0045    WEYMCD           Location Code
     C                     Z-ADDWL0046    WEYNCD           Location Level
     C                     Z-ADDWL0052    WEJ2QT           ILL Item Qty On
     C                     Z-ADDWL0047    WEG5WG           ILL Unit Weight
     C                     Z-ADDWN0014    WEJ3QT           ILL Co-Packer L
     C                     Z-ADDWN0015    WEG6WG           ILl Item Wgt On
     C                     Z-ADDWN0016    WEJ4QT           ILL Unused Qty
     C                     Z-ADDWN0017    WEG7WG           ILL Unused Wgt
     C                     Z-ADDWL0048    WELODT           ILL Avail Ship
     C                     Z-ADDWL0049    WELPDT           ILL Unused Date
     C                     Z-ADDWN0018    WELQDT           ILL Unused Date
     C                     Z-ADDWN0019    WENBR            ILL Unused Nbr
     C                     MOVELWN0020    WEYTCD           ILL Customer Co
     C                     MOVELWL0050    WEAMSX           ILL Status
     C                     MOVELWN0021    WEASSX           ILL Unused Sts
     C                     MOVELWN0022    WEATSX           ILL Unused Sts
     C                     MOVELWN0023    WEAUSX           ILL Unused Sts
     C                     MOVELWL0051    WEYSCD           Inv Hold Reason
     C                     MOVELWN0024    WEUVST           EDI Status 1
     C                     MOVELWN0025    WEUWST           EDI Status 2
     C                     MOVELWN0026    WEUXST           EDI Status 3
     C                     MOVELWN0027    WEVSST           Record Status
     C                     Z-ADDWN0028    WEAATM           Job Time
     C                     MOVELWN0029    WEAYNA           User Id
     C                     MOVELWN0030    WEA0NA           Job Name
     C                     Z-ADDWN0031    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WELXNM           Lot Number
     C                     KFLD           WEYMCD           Location Code
     C                     KFLD           WEYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRSF    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Quantity On-Hand  CH - Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0032 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0033  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0034 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0035  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0036 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0037  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0038  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0039  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0040  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0041  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0042  1        ILL Status
     C                     MOVEL*BLANK    WN0043  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0044  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0045  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0046  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0047  1        EDI Status 1
     C                     MOVEL*BLANK    WN0048  1        EDI Status 2
     C                     MOVEL*BLANK    WN0049  1        EDI Status 3
     C                     MOVEL*BLANK    WN0050  1        Record Status
     C                     Z-ADD*ZERO     WN0051  60       Job Time
     C                     MOVEL*BLANK    WN0052 10        User Id
     C                     MOVEL*BLANK    WN0053 10        Job Name
     C                     Z-ADD*ZERO     WN0054  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0053    WEAIC3           Company Number
     C                     Z-ADDWL0054    WEHGCD           Item Code
     C                     MOVELWL0055    WEAJCD    P      Warehouse Code
     C                     Z-ADDWL0056    WEELDT           Production Date
     C                     Z-ADDWL0057    WELXNM           Lot Number
     C                     MOVELWL0058    WEYMCD    P      Location Code
     C                     Z-ADDWL0059    WEYNCD           Location Level
      *
     C           KLCHSG    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WELXNM           Lot Number
     C                     KFLD           WEYMCD           Location Code
     C                     KFLD           WEYNCD           Location Level
     C           KLCHSG    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YARDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWL0060    WEJ2QT           ILL Item Qty On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Del Item Location     DL - IC Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0055  50       ILL Item Qty On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0061    WEAIC3           Company Number
     C                     Z-ADDWL0062    WEHGCD           Item Code
     C                     MOVELWL0063    WEAJCD           Warehouse Code
     C                     Z-ADDWL0064    WEELDT           Production Date
     C                     Z-ADDWL0065    WELXNM           Lot Number
     C                     MOVELWL0066    WEYMCD           Location Code
     C                     Z-ADDWL0067    WEYNCD           Location Level
      *
     C           KLDLSH    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WELXNM           Lot Number
     C                     KFLD           WEYMCD           Location Code
     C                     KFLD           WEYNCD           Location Level
     C           KLDLSH    CHAIN@L5CPSL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L5CPSL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Del Item Balance Dtl  RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
      * Setup key
     C                     Z-ADDWL0068    WFAIC3           Company Number
     C                     Z-ADDWL0069    WFHGCD           Item Code
     C                     MOVELWL0070    WFAJCD           Warehouse Code
     C                     Z-ADDWL0071    WFELDT           Production Date
      * Establish starting position
     C           KRSSI     CHAIN@B1REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Quantity on Hand - U/M1 is Equal to zero
     C           WFARQT    IFEQ *ZERO                      *IF
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
     C                     EXSR SJDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
     C                     MOVELWFAJCD    WGAJCD           Warehouse Code
     C                     Z-ADDWFELDT    WGELDT           Production Date
      *
     C           KLDLSJ    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLDLSJ    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val Location Exists   RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHYMCD           Location Code
      * Setup key
     C                     MOVELWAAJCD    WHAJCD           Warehouse Code
     C                     MOVELWN0001    WHYMCD           Location Code
      * Establish starting position
     C           KRSSK     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0004           Record Found -P
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0004           Record Found -P
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Crt Whs Location      CR - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L2RESN
     C                     MOVELWAAJCD    WIAJCD           Warehouse Code
     C                     MOVELWN0001    WIYMCD           Location Code
     C                     MOVELYL0005    WIYPCD           Location Aisle
     C                     Z-ADDYL0007    WILCBY           Location Bay
     C                     Z-ADD*ZERO     WILCCT           Loc Unused Chil
     C                     MOVELWUWLUS    WIWLUS           WL Unused Sts 1
     C                     MOVELWUWUSD    WIWUSD           WL Unused Sts 2
     C                     MOVELWUWLUN    WIWLUN           WL PFS Zone
     C                     MOVEL'F'       WIAGSX           WLT Type Code
     C                     MOVELWUUVST    WIUVST           EDI Status 1
     C                     MOVELWUUWST    WIUWST           EDI Status 2
     C                     MOVELWUUXST    WIUXST           EDI Status 3
     C                     MOVELWUVSST    WIVSST           Record Status
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     MOVEL*BLANK    WIAYNA           User Id
     C                     MOVEL*BLANK    WIA0NA           Job Name
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WIVSST           Record Status
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRSL    KLIST
     C                     KFLD           WIAJCD           Warehouse Code
     C                     KFLD           WIYMCD           Location Code
      * Check for duplicate primary key
     C           KLCRSL    SETLL@L2RESN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2629' W0RTN   7
      * Send message 'Warehouse Location     EX'
     C                     MOVEL'USR2629' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@L2RESN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHYMCD           Location Code
      * Setup key
     C                     MOVELWAAJCD    WHAJCD           Warehouse Code
     C                     MOVELWN0001    WHYMCD           Location Code
      * Establish starting position
     C           KRSSM     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0056           WLT Type Code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHAGSX    WN0056           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WJAGSX           WLT Type Code
      * Setup key
     C                     MOVELWN0056    WJAGSX           WLT Type Code
      * Establish starting position
     C           KRSSN     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0057           WLT Type Chill
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJSLTY    WN0057           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * RTV Next Tran Batch #  CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0067  40       Current Account
     C                     Z-ADD*ZERO     WN0068  20       Current Account
     C                     Z-ADD*ZERO     WN0069  30       OM Week
     C                     Z-ADD*ZERO     WN0070  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0071  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0072  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0073  70       Next Late Charg
     C                     Z-ADD*ZERO     WN0074  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0075  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0076  70       Next Customer #
     C                     Z-ADD*ZERO     WN0077  70       Next Inventory
     C                     Z-ADD*ZERO     WN0078  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0079  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0080  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0081  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0082  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0083  1        Auto Customers
     C                     MOVEL*BLANK    WN0084  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0085  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0086  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0087 112       Late Charge Min
     C                     MOVEL*BLANK    WN0088  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0089  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0090  1        Allocate Credit
     C                     MOVEL*BLANK    WN0091 30        Message Line 1
     C                     MOVEL*BLANK    WN0092 30        Message Line 2
     C                     MOVEL*BLANK    WN0093 30        Message Line 3
     C                     MOVEL*BLANK    WN0094 30        Message Line 4
     C                     MOVEL*BLANK    WN0095  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0096  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0097  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0098  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0099  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0100  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0101  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0102  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0103  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0104  30       Retention Perio
     C                     Z-ADD*ZERO     WN0105  30       Retention Perio
     C                     Z-ADD*ZERO     WN0106  30       Retention Perio
     C                     Z-ADD*ZERO     WN0107  30       Retention Perio
     C                     Z-ADD*ZERO     WN0108  30       Retention Perio
     C                     Z-ADD*ZERO     WN0109  70       Next Load ID
     C                     MOVEL*BLANK    WN0110  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0111  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0112  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0113  30       Production Numb
     C                     MOVEL*BLANK    WN0114  1        Freight by Poun
     C                     MOVEL*BLANK    WN0115  1        Price Audit Act
     C                     MOVEL*BLANK    WN0116 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     MOVEL*BLANK    WN0120  1        Record Status
     C                     Z-ADD*ZERO     WN0121  60       Job Time
     C                     MOVEL*BLANK    WN0122 10        User Id
     C                     MOVEL*BLANK    WN0123 10        Job Name
     C                     Z-ADD*ZERO     WN0124  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADDWAAIC3    WKAIC3           Company Number
      *
     C           KLCHSO    KLIST
     C                     KFLD           WKAIC3           Company Number
     C           KLCHSO    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YBRDCS
      * USER: Processing after Data read
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADDWKBANB    YL0008           Transfer Batch
     C                     ADD  1         WKBANB           Next HPB Batch
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Label Date         RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
      * Setup key
     C                     Z-ADDWAAIC3    WFAIC3           Company Number
     C                     Z-ADDWAHGCD    WFHGCD           Item Code
     C                     MOVELWAAJCD    WFAJCD           Warehouse Code
     C                     Z-ADDWAELDT    WFELDT           Production Date
      * Establish starting position
     C           KRSSP     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFK7DT    YL0010           Label Date
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0072    WLAIC3           Company Number
     C                     Z-ADDWL0073    WLHGCD           Item Code
      * Establish starting position
     C           KRSSQ     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0074           Description Lin
     C                     MOVEL*BLANK    WL0075           Description Lin
     C                     MOVEL*BLANK    WL0076           U/M - Primary
     C                     Z-ADD*ZERO     WL0077           Conversion Fact
     C                     MOVEL*BLANK    WL0078           Operation Facto
     C                     MOVEL*BLANK    WL0079           U/M - Second
     C                     Z-ADD*ZERO     WL0080           Conversion Fact
     C                     MOVEL*BLANK    WL0081           Operation Facto
     C                     MOVEL*BLANK    WL0082           U/M - Third
     C                     MOVEL*BLANK    WL0083           U/M - Pricing
     C                     Z-ADD*ZERO     WL0084           Unit Weight
     C                     MOVEL*BLANK    WL0085           Production Date
     C                     MOVEL*BLANK    WL0086           Catch Weight St
     C                     Z-ADD*ZERO     WL0087           Fresh Chilling
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLAVNA    WL0074           Description Lin
     C                     MOVELWLAWNA    WL0075           Description Lin
     C                     MOVELWLADCD    WL0076           U/M - Primary
     C                     Z-ADDWLAWPC    WL0077           Conversion Fact
     C                     MOVELWLLXST    WL0078           Operation Facto
     C                     MOVELWLAECD    WL0079           U/M - Second
     C                     Z-ADDWLAXPC    WL0080           Conversion Fact
     C                     MOVELWLLYST    WL0081           Operation Facto
     C                     MOVELWLAFCD    WL0082           U/M - Third
     C                     MOVELWLAICD    WL0083           U/M - Pricing
     C                     Z-ADDWLAIWG    WL0084           Unit Weight
     C                     MOVELWLFZST    WL0085           Production Date
     C                     MOVELWLAVST    WL0086           Catch Weight St
     C                     Z-ADDWLCHTM    WL0087           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Status/Default     RT - Item Balance  * From Warehouse
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0088    WMAIC3           Company Number
     C                     Z-ADDWL0089    WMHGCD           Item Code
     C                     MOVELWL0090    WMAJCD           Warehouse Code
      * Establish starting position
     C           KRSSR     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0091           Unit Cost Per P
     C                     MOVEL*BLANK    WL0092           Cost Update Pen
     C                     MOVEL*BLANK    WL0093           Post G/L Status
     C                     Z-ADD*ZERO     WL0094           Vendor - Item/W
     C                     MOVEL*BLANK    WL0095           Record Status
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMAGCS    WL0091           Unit Cost Per P
     C                     MOVELWMJ9ST    WL0092           Cost Update Pen
     C                     MOVELWMKBST    WL0093           Post G/L Status
     C                     Z-ADDWMAKC8    WL0094           Vendor - Item/W
     C                     MOVELWMVSST    WL0095           Record Status
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0096    WLAIC3           Company Number
     C                     Z-ADDWL0097    WLHGCD           Item Code
      * Establish starting position
     C           KRSSS     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLRINB    WL0098           Item Structure
     C                     Z-ADDWLRHNB    WL0099           Item Structure
     C                     Z-ADDWLRGNB    WL0100           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQST01           Company Number
     C           *LIKE     DEFN WOHGCD    WQST02           Item Code
     C           *LIKE     DEFN WOAJCD    WQST03           Warehouse Code
     C           *LIKE     DEFN WOW9ST    WQST04           Inventory Trans
     C           *LIKE     DEFN WOBSST    WQST05           Inventory Trans
     C           *LIKE     DEFN WOB4DT    WQST06           Transaction Dat
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Item Code
     C                     KFLD           WQST03           Warehouse Code
     C                     KFLD           WQST04           Inventory Trans
     C                     KFLD           WQST05           Inventory Trans
     C                     KFLD           WQST06           Transaction Dat
      * Setup key
     C                     Z-ADDWL0101    WQST01           Company Number
     C                     Z-ADDWL0102    WQST02           Item Code
     C                     MOVELWL0103    WQST03           Warehouse Code
     C                     MOVELWL0104    WQST04           Inventory Trans
     C                     MOVELWL0105    WQST05           Inventory Trans
     C                     Z-ADDWL0106    WQST06           Transaction Dat
      * Establish starting position
     C           KRSST     SETLL@B7CPZA                    *
     C           KRSST     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0107           ITD Sequence Nu
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WOC4NY    ADD  1         WL0107           ITD Sequence Nu
     C                     GOTO STEXIT                     *QUIT
     C           KRSST     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0144  60       Job Time
     C                     MOVEL*BLANK    WN0145 10        User Id
     C                     MOVEL*BLANK    WN0146 10        Job Name
     C                     Z-ADD*ZERO     WN0147  70       Job Date
     C                     Z-ADD*ZERO     WN0148  20       Production Hour
     C                     Z-ADD*ZERO     WN0149 112       Production Weig
     C                     Z-ADD*ZERO     WN0150  50       Production Quan
     C                     Z-ADD*ZERO     WN0151  70       Production Piec
     C                     MOVEL*BLANK    WN0152  1        Export/Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWAAIC3    WRAIC3           Company Number
     C                     Z-ADDWAHGCD    WRHGCD           Item Code
     C                     MOVELWAAJCD    WRAJCD           Warehouse Code
     C                     MOVEL'T'       WRW9ST           Inventory Trans
     C                     MOVEL'TW'      WRBSST           Inventory Trans
     C                     Z-ADD##JDT     WRB4DT           Transaction Dat
     C                     Z-ADDWN0128    WRC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WRDXNB           Sequence Number
     C                     Z-ADDWAELDT    WRELDT           Production Date
     C                     MOVELYL0013    WRHVCD           U/M - Transacti
     C                     MOVEL'IC'      WRF1ST           Item Transactio
     C                     MOVEL@CN,003   WRAUNA           Description
     C                     Z-ADDYL0009    WRA5QT           Transaction Qua
     C                     Z-ADDYL0029    WRAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WRAKCS           USR Transaction
     C                     MOVEL'LB'      WRCGCD           U/M - Cost
     C                     Z-ADDWN0131    WRAYVA           Extended Amount
     C                     MOVEL*BLANK    WRBJNA           Ticket Number
     C                     Z-ADD*ZERO     WRCKNB           G/L Document Nu
     C                     MOVEL'N'       WRBMST           G/L Update Stat
     C                     MOVELWN0140    WRCQCD           Reason Code
     C                     MOVEL*BLANK    WRDTCD           Reference Numbe
     C                     MOVEL*BLANK    WRMGNA           Lot ID
     C                     Z-ADDYL0008    WRTRBN           Transfer Batch
     C                     Z-ADDYL0036    WRTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WRC4NB           Order Number
     C                     Z-ADDWN0125    WRRINB           Item Structure
     C                     Z-ADDWN0126    WRRHNB           Item Structure
     C                     Z-ADDWN0127    WRRGNB           Item Structure
     C                     MOVEL*BLANK    WRM3NA           Employee Badge
     C                     Z-ADD*ZERO     WRAWTM           Production Time
     C                     MOVEL'1'       WRXLCD           Shift Number
     C                     Z-ADDYL0010    WRK7DT           Label Date
     C                     MOVEL*BLANK    WRUVST           EDI Status 1
     C                     MOVEL*BLANK    WRUWST           EDI Status 2
     C                     MOVEL*BLANK    WRUXST           EDI Status 3
     C                     MOVEL'A'       WRVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WRAXDT    PARM *ZERO     WQ0001 155       Current System
     C           WRAATM    PARM *ZERO     WQ0002 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSU    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRHGCD           Item Code
     C                     KFLD           WRAJCD           Warehouse Code
     C                     KFLD           WRW9ST           Inventory Trans
     C                     KFLD           WRBSST           Inventory Trans
     C                     KFLD           WRB4DT           Transaction Dat
     C                     KFLD           WRC4NY           ITD Sequence Nu
     C                     KFLD           WRDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSU    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WRAIC3    WQ0003  30       Company Number
     C                     PARM WRHGCD    WQ0004  70       Item Code
     C                     PARM WRAJCD    WQ0005  3        Warehouse Code
     C                     PARM WRW9ST    WQ0006  1        Inventory Trans
     C                     PARM WRBSST    WQ0007  2        Inventory Trans
     C                     PARM WRB4DT    WQ0008  70       Transaction Dat
     C                     PARM WRDXNB    WQ0009  30       Sequence Number
     C                     PARM WRELDT    WQ0010  70       Production Date
     C                     PARM WRHVCD    WQ0011  2        U/M - Transacti
     C                     PARM WRF1ST    WQ0012  2        Item Transactio
     C                     PARM WRAUNA    WQ0013 30        Description
     C                     PARM WRA5QT    WQ0014 112       Transaction Qua
     C                     PARM WRAHWG    WQ0015 112       Transaction Wei
     C                     PARM WRAKCS    WQ0016 114       USR Transaction
     C                     PARM WRCGCD    WQ0017  2        U/M - Cost
     C                     PARM WRAYVA    WQ0018 112       Extended Amount
     C                     PARM WRBJNA    WQ0019  6        Ticket Number
     C                     PARM WRCKNB    WQ0020  80       G/L Document Nu
     C                     PARM WRBMST    WQ0021  1        G/L Update Stat
     C                     PARM WRCQCD    WQ0022  3        Reason Code
     C                     PARM WRDTCD    WQ0023 15        Reference Numbe
     C                     PARM WRMGNA    WQ0024 10        Lot ID
     C                     PARM WRTRBN    WQ0025  70       Transfer Batch
     C                     PARM WRTRBS    WQ0026  30       Transfer Batch
     C                     PARM WRC4NB    WQ0027  70       Order Number
     C                     PARM WRRINB    WQ0028  30       Item Structure
     C                     PARM WRRHNB    WQ0029  30       Item Structure
     C                     PARM WRRGNB    WQ0030  30       Item Structure
     C                     PARM WRM3NA    WQ0031 10        Employee Badge
     C                     PARM WRAWTM    WQ0032  60       Production Time
     C                     PARM WRXLCD    WQ0033  1        Shift Number
     C                     PARM WRK7DT    WQ0034  70       Label Date
     C                     PARM WRVSST    WQ0035  1        Record Status
     C                     PARM WRAATM    WQ0036  60       Job Time
     C                     PARM WRAXDT    WQ0037  70       Job Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0153 112       Physical Count
     C                     Z-ADD*ZERO     WN0154 112       Physical Count
     C                     Z-ADD*ZERO     WN0155 112       Physical Count
     C                     Z-ADD*ZERO     WN0156 112       Physical Count
     C                     MOVEL*BLANK    WN0157  1        Physical Count
     C                     Z-ADD*ZERO     WN0158 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0159 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0160 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0161 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0162 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0163 112       Weight In Chill
     C                     MOVEL*BLANK    WN0164  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0165 112       Physical Start
     C                     Z-ADD*ZERO     WN0166 112       Physical Start
     C                     Z-ADD*ZERO     WN0167 112       Physical Start
     C                     Z-ADD*ZERO     WN0168 112       Physical Start
     C                     Z-ADD*ZERO     WN0169  70       Physical Start
     C                     Z-ADD*ZERO     WN0170 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0171 114       Last Cost
     C                     Z-ADD*ZERO     WN0172 112       Value of On Han
     C                     Z-ADD*ZERO     WN0173  70       Label Date
     C                     MOVEL*BLANK    WN0174  1        EDI Status 1
     C                     MOVEL*BLANK    WN0175  1        EDI Status 2
     C                     MOVEL*BLANK    WN0176  1        EDI Status 3
     C                     MOVEL*BLANK    WN0177  1        Record Status
     C                     Z-ADD*ZERO     WN0178  60       Job Time
     C                     MOVEL*BLANK    WN0179 10        User Id
     C                     MOVEL*BLANK    WN0180 10        Job Name
     C                     Z-ADD*ZERO     WN0181  70       Job Date
     C                     MOVEL*BLANK    WN0182  1        Shift Number
     C                     MOVEL*BLANK    WN0183  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL'1'       WN0182           Shift Number
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWAAIC3    WGAIC3           Company Number
     C                     Z-ADDWAHGCD    WGHGCD           Item Code
     C                     MOVELWAAJCD    WGAJCD    P      Warehouse Code
     C                     Z-ADDWAELDT    WGELDT           Production Date
      *
     C           KLCHSV    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLCHSV    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0108           Company Number
     C                     Z-ADDWAHGCD    WL0109           Item Code
     C                     MOVELWAAJCD    WL0110    P      Warehouse Code
     C                     Z-ADDWAELDT    WL0111           Production Date
     C                     Z-ADD*ZERO     WL0112           Physical Count
     C                     Z-ADD*ZERO     WL0113           Physical Count
     C                     Z-ADD*ZERO     WL0114           Physical Count
     C                     Z-ADD*ZERO     WL0115           Physical Count
     C                     MOVEL*BLANK    WL0116           Physical Count
     C                     Z-ADDYL0029    WL0117           Quantity on Han
     C                     Z-ADDWN0132    WL0118           Quantity on Han
     C                     Z-ADD*ZERO     WL0119           Quantity on Han
     C                     Z-ADD*ZERO     WL0120           Quantity on Han
     C                     Z-ADD*ZERO     WL0121           Quantity In Chi
     C                     Z-ADD*ZERO     WL0122           Weight In Chill
     C                     MOVEL'N'       WL0123    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0124           Physical Start
     C                     Z-ADD*ZERO     WL0125           Physical Start
     C                     Z-ADD*ZERO     WL0126           Physical Start
     C                     Z-ADD*ZERO     WL0127           Physical Start
     C                     Z-ADD*ZERO     WL0128           Physical Start
     C                     Z-ADD*ZERO     WL0129           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0130           Last Cost
     C                     Z-ADDWN0131    WL0131           Value of On Han
     C                     Z-ADDYL0010    WL0132           Label Date
     C                     Z-ADDWN0125    WL0133           Item Structure
     C                     Z-ADDWN0126    WL0134           Item Structure
     C                     Z-ADDWN0127    WL0135           Item Structure
     C                     MOVEL*BLANK    WL0136           EDI Status 1
     C                     MOVEL*BLANK    WL0137           EDI Status 2
     C                     MOVEL*BLANK    WL0138           EDI Status 3
     C                     MOVEL'A'       WL0139    P      Record Status
     C                     EXSR SWCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YCRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWN0125    WGRINB           Item Structure
     C                     Z-ADDWN0126    WGRHNB           Item Structure
     C                     Z-ADDWN0127    WGRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YCRDC            *Record Data Ch
     C                     ADD  WN0132    WGARQT           Quantity on Han
     C                     ADD  YL0029    WGACWG           Quantity on Han
     C                     ADD  WN0131    WGIDVA           Value of On Han
      * If quantity is zero, so are weight, value of inventory
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WGARQT    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - Item Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0040  30       Company Number
     C                     PARM WGHGCD    WQ0041  70       Item Code
     C                     PARM WGAJCD    WQ0042  3        Warehouse Code
     C                     PARM ##JDT     WQ0043  70       Transaction Dat
     C                     PARM WGELDT    WQ0044  70       Production Date
     C                     PARM YL0013    WQ0045  2        U/M - Transacti
     C                     PARM WGACWG    WQ0046 112       Transaction Wei
     C                     PARM *ZERO     WQ0047 114       USR Transaction
     C                     PARM 'LB'      WQ0048  2        U/M - Cost
     C                     PARM WGRINB    WQ0049  30       Item Structure
     C                     PARM WGRHNB    WQ0050  30       Item Structure
     C                     PARM WGRGNB    WQ0051  30       Item Structure
     C                     PARM WN0182    WQ0052  1        Shift Number
     C                     PARM WGK7DT    WQ0053  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WGAXDT    PARM *ZERO     WQ0054 155       Current System
     C           WGAATM    PARM *ZERO     WQ0055 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WGARQT    IFEQ WUW0NB                     *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWGAJCD    WL0140    P      Warehouse Code
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0141    WN0183    P      Lot Tracking Fl
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0183    IFEQ *BLANK                     *IF
     C           WN0183    OREQ 'N'
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0142           Company Number
     C                     Z-ADDWGHGCD    WL0143           Item Code
     C                     MOVELWGAJCD    WL0144    P      Warehouse Code
     C                     Z-ADDWGELDT    WL0145           Production Date
     C                     EXSR SYDLRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0184  60       Job Time
     C                     MOVEL*BLANK    WN0185 10        User Id
     C                     MOVEL*BLANK    WN0186 10        Job Name
     C                     Z-ADD*ZERO     WN0187  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0108    WGAIC3           Company Number
     C                     Z-ADDWL0109    WGHGCD           Item Code
     C                     MOVELWL0110    WGAJCD           Warehouse Code
     C                     Z-ADDWL0111    WGELDT           Production Date
     C                     Z-ADDWL0112    WGABWG           Physical Count
     C                     Z-ADDWL0113    WGAGQT           Physical Count
     C                     Z-ADDWL0114    WGAHQT           Physical Count
     C                     Z-ADDWL0115    WGAIQT           Physical Count
     C                     MOVELWL0116    WGCTST           Physical Count
     C                     Z-ADDWL0117    WGACWG           Quantity on Han
     C                     Z-ADDWL0118    WGARQT           Quantity on Han
     C                     Z-ADDWL0119    WGASQT           Quantity on Han
     C                     Z-ADDWL0120    WGATQT           Quantity on Han
     C                     Z-ADDWL0121    WGHDQT           Quantity In Chi
     C                     Z-ADDWL0122    WGHEQT           Weight In Chill
     C                     MOVELWL0123    WGF6ST           Update Exceptio
     C                     Z-ADDWL0124    WGBMWG           Physical Start
     C                     Z-ADDWL0125    WGDSQT           Physical Start
     C                     Z-ADDWL0126    WGDTQT           Physical Start
     C                     Z-ADDWL0127    WGDUQT           Physical Start
     C                     Z-ADDWL0128    WGDHDT           Physical Start
     C                     Z-ADDWL0129    WGAGCS           Unit Cost Per P
     C                     Z-ADDWL0130    WGAECS           Last Cost
     C                     Z-ADDWL0131    WGIDVA           Value of On Han
     C                     Z-ADDWL0132    WGK7DT           Label Date
     C                     Z-ADDWL0133    WGRINB           Item Structure
     C                     Z-ADDWL0134    WGRHNB           Item Structure
     C                     Z-ADDWL0135    WGRGNB           Item Structure
     C                     MOVELWL0136    WGUVST           EDI Status 1
     C                     MOVELWL0137    WGUWST           EDI Status 2
     C                     MOVELWL0138    WGUXST           EDI Status 3
     C                     MOVELWL0139    WGVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WGAXDT    PARM *ZERO     WQ0038 155       Current System
     C           WGAATM    PARM *ZERO     WQ0039 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSW    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSW    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0140    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSSX     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0141           Lot Tracking Fl
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSVHST    WL0141           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYDLRC    BEGSR
      *================================================================
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0142    WGAIC3           Company Number
     C                     Z-ADDWL0143    WGHGCD           Item Code
     C                     MOVELWL0144    WGAJCD           Warehouse Code
     C                     Z-ADDWL0145    WGELDT           Production Date
      *
     C           KLDLSY    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLDLSY    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0149           Quantity on Han
     C                     Z-ADD*ZERO     WL0150           Quantity on Han
     C                     Z-ADD*ZERO     WL0151           Quantity on Han
     C                     Z-ADD*ZERO     WL0152           Quantity on Han
     C                     Z-ADD*ZERO     WL0153           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN WTHGCD    WQSZ02           Item Code
     C           *LIKE     DEFN WTAJCD    WQSZ03           Warehouse Code
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Item Code
     C                     KFLD           WQSZ03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0146    WQSZ01           Company Number
     C                     Z-ADDWL0147    WQSZ02           Item Code
     C                     MOVELWL0148    WQSZ03           Warehouse Code
      * Establish starting position
     C           KRSSZ     SETLLCAB1RL4                    *
     C           KRSSZ     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WTACWG    WL0149           Quantity on Han
     C                     ADD  WTARQT    WL0150           Quantity on Han
     C                     ADD  WTASQT    WL0151           Quantity on Han
     C                     ADD  WTATQT    WL0152           Quantity on Han
     C                     ADD  WTIDVA    WL0153           Value of On Han
     C           KRSSZ     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0188 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0189 114       Last Cost
     C                     Z-ADD*ZERO     WN0190 114       Cost per Primar
     C                     Z-ADD*ZERO     WN0191 114       Cost per Pricin
     C                     Z-ADD*ZERO     WN0192 114       Revaluation Cos
     C                     Z-ADD*ZERO     WN0193  70       Revaluation Eff
     C                     MOVEL*BLANK    WN0194  1        Revaluation Cos
     C                     Z-ADD*ZERO     WN0195 114       Last Revaluatio
     C                     Z-ADD*ZERO     WN0196  70       Last Revaluatio
     C                     Z-ADD*ZERO     WN0197 112       On Hand U/M2 Su
     C                     Z-ADD*ZERO     WN0198 112       On Hand U/M3 Su
     C                     Z-ADD*ZERO     WN0199 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0200 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0201 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0202 112       Quantity on Sal
     C                     Z-ADD*ZERO     WN0203 112       Quantity on Pur
     C                     Z-ADD*ZERO     WN0204 112       Quantity on Tra
     C                     Z-ADD*ZERO     WN0205 112       Quantity Avail.
     C                     MOVEL*BLANK    WN0206  3        Cycle Count Cod
     C                     Z-ADD*ZERO     WN0207  70       Date of Last Or
     C                     Z-ADD*ZERO     WN0208  70       Date of Last Sh
     C                     MOVEL*BLANK    WN0209  1        Inventory Plann
     C                     Z-ADD*ZERO     WN0210  52       Safety Allowanc
     C                     Z-ADD*ZERO     WN0211 112       Safety Allowanc
     C                     Z-ADD*ZERO     WN0212  70       Stock Out Date
     C                     MOVEL*BLANK    WN0213  3        Buyer Code
     C                     Z-ADD*ZERO     WN0214  30       Lead Time - Las
     C                     Z-ADD*ZERO     WN0215  70       Lead Time - Dat
     C                     Z-ADD*ZERO     WN0216  30       Lead Time - Nex
     C                     Z-ADD*ZERO     WN0217  70       Lead Time - Dat
     C                     MOVEL*BLANK    WN0218  1        Lead Time - Exc
     C                     Z-ADD*ZERO     WN0219 112       Usage Qty per C
     C                     Z-ADD*ZERO     WN0220 112       Usage Weight pe
     C                     Z-ADD*ZERO     WN0221  70       Inventory Manag
     C                     Z-ADD*ZERO     WN0222 112       Minimum Quantit
     C                     Z-ADD*ZERO     WN0223 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0224  70       Last Physical C
     C                     MOVEL*BLANK    WN0225  1        Requisition Mod
     C                     MOVEL*BLANK    WN0226  1        Cost Update Pen
     C                     MOVEL*BLANK    WN0227  1        Post G/L Status
     C                     Z-ADD*ZERO     WN0228  80       Vendor - Item/W
     C                     Z-ADD*ZERO     WN0229  30       Item Structure
     C                     Z-ADD*ZERO     WN0230  30       Item Structure
     C                     Z-ADD*ZERO     WN0231  30       Item Structure
     C                     MOVEL*BLANK    WN0232  1        EDI Status 1
     C                     MOVEL*BLANK    WN0233  1        EDI Status 2
     C                     MOVEL*BLANK    WN0234  1        EDI Status 3
     C                     MOVEL*BLANK    WN0235  1        Record Status
     C                     Z-ADD*ZERO     WN0236  60       Job Time
     C                     MOVEL*BLANK    WN0237 10        User Id
     C                     MOVEL*BLANK    WN0238 10        Job Name
     C                     Z-ADD*ZERO     WN0239  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWAAIC3    WVAIC3           Company Number
     C                     Z-ADDWAHGCD    WVHGCD           Item Code
     C                     MOVELWAAJCD    WVAJCD    P      Warehouse Code
      *
     C           KLCHTA    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVHGCD           Item Code
     C                     KFLD           WVAJCD           Warehouse Code
     C           KLCHTA    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YDRDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWN0135    WVBOWG           On Hand Weight
     C                     Z-ADDWN0136    WVDDQT           On Hand U/M1 Su
     C                     Z-ADDWN0137    WVIDVA           Value of On Han
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YDRDC            *Record Data Ch
      * Refresh the available to sell quantity
     C                     Z-ADDWVDDQT    WVDOQT           Quantity Avail.
     C                     SUB  WVAQQT    WVDOQT           Quantity Avail.
     C                     SUB  WVAUQT    WVDOQT           Quantity Avail.
     C                     SUB  WVEMQT    WVDOQT           Quantity Avail.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Warehouse Info     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0154    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTB     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0155           Warehouse Descr
     C                     MOVEL*BLANK    WL0156           Address Line 1
     C                     MOVEL*BLANK    WL0157           Address Line 2
     C                     MOVEL*BLANK    WL0158           Address Line 3
     C                     MOVEL*BLANK    WL0159           City
     C                     MOVEL*BLANK    WL0160           Zip/Postal Code
     C                     MOVEL*BLANK    WL0161           Production Ware
     C                     MOVEL*BLANK    WL0162           State Code
     C                     MOVEL*BLANK    WL0163           Lot Tracking Fl
     C                     MOVEL*BLANK    WL0164           Default Printer
     C                     MOVEL*BLANK    WL0165           Warehouse Type
     C                     MOVEL*BLANK    WL0166           Trans Contol AS
     C                     MOVEL*BLANK    WL0167           Warehouse Locat
     C                     MOVEL*BLANK    WL0168           Warehouse Std C
     C                     Z-ADD*ZERO     WL0169           Warehouse Chill
     C                     MOVEL*BLANK    WL0170           Include in Auto
     C                     MOVEL*BLANK    WL0171           Default Manifes
     C                     MOVEL*BLANK    WL0172           Default Load Se
     C                     MOVEL*BLANK    WL0173           WHS Slotting Li
     C                     Z-ADD*ZERO     WL0174           Shipping Compan
     C                     Z-ADD*ZERO     WL0175           Accounting Comp
     C                     Z-ADD*ZERO     WL0176           WHS Sched Prod
     C                     Z-ADD*ZERO     WL0177           WHS Inventory C
     C                     MOVEL*BLANK    WL0178           Parent Warehous
     C                     MOVEL*BLANK    WL0179           Default Shippin
     C                     MOVEL*BLANK    WL0180           WHS Live w/Carl
     C                     MOVEL*BLANK    WL0181           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0182           WHS Req Meter R
     C                     MOVEL*BLANK    WL0183           WHS Default Loa
     C                     MOVEL*BLANK    WL0184           WHS Unused Sts
     C                     MOVEL*BLANK    WL0185           Default Carrier
     C                     MOVEL*BLANK    WL0186           WHS TPM Locatio
     C                     MOVEL*BLANK    WL0187           WHS Unused Sts
     C                     MOVEL*BLANK    WL0188           EDI Status 1
     C                     MOVEL*BLANK    WL0189           EDI Status 2
     C                     MOVEL*BLANK    WL0190           EDI Status 3
     C                     MOVEL*BLANK    WL0191           Record Status
     C                     Z-ADD*ZERO     WL0192           Job Time
     C                     MOVEL*BLANK    WL0193           User Id
     C                     MOVEL*BLANK    WL0194           Job Name
     C                     Z-ADD*ZERO     WL0195           Job Date
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSF8NA    WL0155           Warehouse Descr
     C                     MOVELWSACNA    WL0156           Address Line 1
     C                     MOVELWSADNA    WL0157           Address Line 2
     C                     MOVELWSAENA    WL0158           Address Line 3
     C                     MOVELWSAJNA    WL0159           City
     C                     MOVELWSBTTX    WL0160           Zip/Postal Code
     C                     MOVELWSAOCD    WL0161           Production Ware
     C                     MOVELWSBGCD    WL0162           State Code
     C                     MOVELWSVHST    WL0163           Lot Tracking Fl
     C                     MOVELWSMPNA    WL0164           Default Printer
     C                     MOVELWSWPST    WL0165           Warehouse Type
     C                     MOVELWSXUST    WL0166           Trans Contol AS
     C                     MOVELWST0ST    WL0167           Warehouse Locat
     C                     MOVELWST1ST    WL0168           Warehouse Std C
     C                     Z-ADDWSDBNB    WL0169           Warehouse Chill
     C                     MOVELWST2ST    WL0170           Include in Auto
     C                     MOVELWST3ST    WL0171           Default Manifes
     C                     MOVELWST4ST    WL0172           Default Load Se
     C                     MOVELWST6ST    WL0173           WHS Slotting Li
     C                     Z-ADDWSBWC3    WL0174           Shipping Compan
     C                     Z-ADDWSBTC3    WL0175           Accounting Comp
     C                     Z-ADDWSBUC3    WL0176           WHS Sched Prod
     C                     Z-ADDWSBVC3    WL0177           WHS Inventory C
     C                     MOVELWSFCAA    WL0178           Parent Warehous
     C                     MOVELWSRQSX    WL0179           Default Shippin
     C                     MOVELWSRRSX    WL0180           WHS Live w/Carl
     C                     MOVELWSRSSX    WL0181           WHS PFS Interfa
     C                     MOVELWSRTSX    WL0182           WHS Req Meter R
     C                     MOVELWST7ST    WL0183           WHS Default Loa
     C                     MOVELWST8ST    WL0184           WHS Unused Sts
     C                     MOVELWSRNSX    WL0185           Default Carrier
     C                     MOVELWSROSX    WL0186           WHS TPM Locatio
     C                     MOVELWSRPSX    WL0187           WHS Unused Sts
     C                     MOVELWSUVST    WL0188           EDI Status 1
     C                     MOVELWSUWST    WL0189           EDI Status 2
     C                     MOVELWSUXST    WL0190           EDI Status 3
     C                     MOVELWSVSST    WL0191           Record Status
     C                     Z-ADDWSAATM    WL0192           Job Time
     C                     MOVELWSAYNA    WL0193           User Id
     C                     MOVELWSA0NA    WL0194           Job Name
     C                     Z-ADDWSAXDT    WL0195           Job Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Whse Location Info RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAJCD    WQTC01           Warehouse Code
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Warehouse Code
      * Setup key
     C                     MOVELWL0196    WQTC01           Warehouse Code
      * Establish starting position
     C           KRSTC     SETLL@L2RESM                    *
     C           KRSTC     READE@L2RESM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0197           Location Code
     C                     MOVEL*BLANK    WL0198           Location Aisle
     C                     Z-ADD*ZERO     WL0199           Location Bay
     C                     Z-ADD*ZERO     WL0200           Loc Unused Chil
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHYMCD    WL0197           Location Code
     C                     MOVELWHYPCD    WL0198           Location Aisle
     C                     Z-ADDWHLCBY    WL0199           Location Bay
     C                     Z-ADDWHLCCT    WL0200           Loc Unused Chil
     C                     GOTO TCEXIT                     *QUIT
     C           KRSTC     READE@L2RESM                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     MOVELWAAJCD    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0043           Shipping Compan
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWSBWC3    YL0043           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Val Item Balance       RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWHGCD           Item Code
     C                     KFLD           WWAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDYL0043    WWAIC3           Company Number
     C                     Z-ADDWAHGCD    WWHGCD           Item Code
     C                     MOVELWAAJCD    WWAJCD           Warehouse Code
      * Establish starting position
     C           KRSTE     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * Crt Item Balance       CR - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0240  60       Job Time
     C                     MOVEL*BLANK    WN0241 10        User Id
     C                     MOVEL*BLANK    WN0242 10        Job Name
     C                     Z-ADD*ZERO     WN0243  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REJT
     C                     Z-ADDYL0043    WVAIC3           Company Number
     C                     Z-ADDWAHGCD    WVHGCD           Item Code
     C                     MOVELWAAJCD    WVAJCD           Warehouse Code
     C                     Z-ADDYL0035    WVAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WVAECS           Last Cost
     C                     Z-ADD*ZERO     WVBACS           Cost per Primar
     C                     Z-ADD*ZERO     WVBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WVCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WVGUDT           Revaluation Eff
     C                     MOVELWUGSTX    WVXYST           Revaluation Cos
     C                     Z-ADD*ZERO     WVCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WVG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WVBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WVDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WVDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WVDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WVHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WVHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WVAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WVAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WVAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WVEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WVDOQT           Quantity Avail.
     C                     MOVEL*BLANK    WVATNA           Cycle Count Cod
     C                     Z-ADD*ZERO     WVAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WVANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WVIDVA           Value of On Han
     C                     MOVELWUGSTX    WVJVST           Inventory Plann
     C                     Z-ADD*ZERO     WVBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WVDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WVDIDT           Stock Out Date
     C                     MOVEL*BLANK    WVALCD           Buyer Code
     C                     Z-ADD*ZERO     WVBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WVDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WVBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WVDKDT           Lead Time - Dat
     C                     MOVEL'N'       WVJ2ST           Lead Time - Exc
     C                     Z-ADD*ZERO     WVDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WVBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WVDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WVDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WVDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WVDMDT           Last Physical C
     C                     MOVELWUGSTX    WVM0ST           Requisition Mod
     C                     MOVELWUGSTX    WVJ9ST           Cost Update Pen
     C                     MOVELWUGSTX    WVKBST           Post G/L Status
     C                     Z-ADD*ZERO     WVAKC8           Vendor - Item/W
     C                     Z-ADDWN0125    WVRINB           Item Structure
     C                     Z-ADDWN0126    WVRHNB           Item Structure
     C                     Z-ADDWN0127    WVRGNB           Item Structure
     C                     MOVELWUUVST    WVUVST           EDI Status 1
     C                     MOVELWUUWST    WVUWST           EDI Status 2
     C                     MOVELWUUXST    WVUXST           EDI Status 3
     C                     MOVEL'A'       WVVSST           Record Status
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WVAATM' defaulted for 'Job Time'.
      * Field '(DB1) WVAYNA' defaulted for 'User Id'.
      * Field '(DB1) WVA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WVAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
     C           KLCRTF    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVHGCD           Item Code
     C                     KFLD           WVAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRTF    SETLL@B0REJT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0329' W0RTN   7
      * Send message 'Item Balance           EX'
     C                     MOVEL'USR0329' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C                     WRITE@B0REJT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCRRC    BEGSR
      *================================================================
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0244  60       Job Time
     C                     MOVEL*BLANK    WN0245 10        User Id
     C                     MOVEL*BLANK    WN0246 10        Job Name
     C                     Z-ADD*ZERO     WN0247  70       Job Date
     C                     Z-ADD*ZERO     WN0248  20       Production Hour
     C                     Z-ADD*ZERO     WN0249 112       Production Weig
     C                     Z-ADD*ZERO     WN0250  50       Production Quan
     C                     Z-ADD*ZERO     WN0251  70       Production Piec
     C                     MOVEL*BLANK    WN0252  1        Export/Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWL0201    WRAIC3           Company Number
     C                     Z-ADDWL0202    WRHGCD           Item Code
     C                     MOVELWL0203    WRAJCD           Warehouse Code
     C                     MOVELWL0204    WRW9ST           Inventory Trans
     C                     MOVELWL0205    WRBSST           Inventory Trans
     C                     Z-ADDWL0206    WRB4DT           Transaction Dat
     C                     Z-ADDWL0207    WRC4NY           ITD Sequence Nu
     C                     Z-ADDWL0208    WRDXNB           Sequence Number
     C                     Z-ADDWL0209    WRELDT           Production Date
     C                     MOVELWL0210    WRHVCD           U/M - Transacti
     C                     MOVELWL0211    WRF1ST           Item Transactio
     C                     MOVELWL0212    WRAUNA           Description
     C                     Z-ADDWL0213    WRA5QT           Transaction Qua
     C                     Z-ADDWL0214    WRAHWG           Transaction Wei
     C                     Z-ADDWL0215    WRAKCS           USR Transaction
     C                     MOVELWL0216    WRCGCD           U/M - Cost
     C                     Z-ADDWL0217    WRAYVA           Extended Amount
     C                     MOVELWL0218    WRBJNA           Ticket Number
     C                     Z-ADDWL0219    WRCKNB           G/L Document Nu
     C                     MOVELWL0220    WRBMST           G/L Update Stat
     C                     MOVELWL0221    WRCQCD           Reason Code
     C                     MOVELWL0222    WRDTCD           Reference Numbe
     C                     MOVELWL0223    WRMGNA           Lot ID
     C                     Z-ADDWL0224    WRTRBN           Transfer Batch
     C                     Z-ADDWL0225    WRTRBS           Transfer Batch
     C                     Z-ADDWL0226    WRC4NB           Order Number
     C                     Z-ADDWL0227    WRRINB           Item Structure
     C                     Z-ADDWL0228    WRRHNB           Item Structure
     C                     Z-ADDWL0229    WRRGNB           Item Structure
     C                     MOVELWL0230    WRM3NA           Employee Badge
     C                     Z-ADDWL0231    WRAWTM           Production Time
     C                     MOVELWL0232    WRXLCD           Shift Number
     C                     Z-ADDWL0233    WRK7DT           Label Date
     C                     MOVELWL0234    WRUVST           EDI Status 1
     C                     MOVELWL0235    WRUWST           EDI Status 2
     C                     MOVELWL0236    WRUXST           EDI Status 3
     C                     MOVELWL0237    WRVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
     C           KLCRTG    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRHGCD           Item Code
     C                     KFLD           WRAJCD           Warehouse Code
     C                     KFLD           WRW9ST           Inventory Trans
     C                     KFLD           WRBSST           Inventory Trans
     C                     KFLD           WRB4DT           Transaction Dat
     C                     KFLD           WRC4NY           ITD Sequence Nu
     C                     KFLD           WRDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRTG    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WRAIC3    WQ0065  30       Company Number
     C                     PARM WRHGCD    WQ0066  70       Item Code
     C                     PARM WRAJCD    WQ0067  3        Warehouse Code
     C                     PARM WRW9ST    WQ0068  1        Inventory Trans
     C                     PARM WRBSST    WQ0069  2        Inventory Trans
     C                     PARM WRB4DT    WQ0070  70       Transaction Dat
     C                     PARM WRDXNB    WQ0071  30       Sequence Number
     C                     PARM WRELDT    WQ0072  70       Production Date
     C                     PARM WRHVCD    WQ0073  2        U/M - Transacti
     C                     PARM WRF1ST    WQ0074  2        Item Transactio
     C                     PARM WRAUNA    WQ0075 30        Description
     C                     PARM WRA5QT    WQ0076 112       Transaction Qua
     C                     PARM WRAHWG    WQ0077 112       Transaction Wei
     C                     PARM WRAKCS    WQ0078 114       USR Transaction
     C                     PARM WRCGCD    WQ0079  2        U/M - Cost
     C                     PARM WRAYVA    WQ0080 112       Extended Amount
     C                     PARM WRBJNA    WQ0081  6        Ticket Number
     C                     PARM WRCKNB    WQ0082  80       G/L Document Nu
     C                     PARM WRBMST    WQ0083  1        G/L Update Stat
     C                     PARM WRCQCD    WQ0084  3        Reason Code
     C                     PARM WRDTCD    WQ0085 15        Reference Numbe
     C                     PARM WRMGNA    WQ0086 10        Lot ID
     C                     PARM WRTRBN    WQ0087  70       Transfer Batch
     C                     PARM WRTRBS    WQ0088  30       Transfer Batch
     C                     PARM WRC4NB    WQ0089  70       Order Number
     C                     PARM WRRINB    WQ0090  30       Item Structure
     C                     PARM WRRHNB    WQ0091  30       Item Structure
     C                     PARM WRRGNB    WQ0092  30       Item Structure
     C                     PARM WRM3NA    WQ0093 10        Employee Badge
     C                     PARM WRAWTM    WQ0094  60       Production Time
     C                     PARM WRXLCD    WQ0095  1        Shift Number
     C                     PARM WRK7DT    WQ0096  70       Label Date
     C                     PARM WRVSST    WQ0097  1        Record Status
     C                     PARM WRAATM    WQ0098  60       Job Time
     C                     PARM WRAXDT    WQ0099  70       Job Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0253  2        U/M - Cost
     C                     Z-ADD*ZERO     WN0254 112       Extended Amount
     C                     MOVEL*BLANK    WN0255  1        G/L Update Stat
     C                     MOVEL*BLANK    WN0256 30        Description Lin
     C                     MOVEL*BLANK    WN0257  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0258  94       Conversion Fact
     C                     MOVEL*BLANK    WN0259  1        Operation Facto
     C                     MOVEL*BLANK    WN0260  2        U/M - Second
     C                     Z-ADD*ZERO     WN0261  94       Conversion Fact
     C                     MOVEL*BLANK    WN0262  1        Operation Facto
     C                     MOVEL*BLANK    WN0263  2        U/M - Third
     C                     MOVEL*BLANK    WN0264  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0265 112       Unit Weight
     C                     MOVEL*BLANK    WN0266  1        Production Date
     C                     MOVEL*BLANK    WN0267  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0268  30       Item Structure
     C                     Z-ADD*ZERO     WN0269  30       Item Structure
     C                     Z-ADD*ZERO     WN0270  30       Item Structure
     C                     Z-ADD*ZERO     WN0271 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0272 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0273 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0274 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0275 114       Unit Cost Per P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXHGCD           Item Code
     C                     KFLD           WXAJCD           Warehouse Code
     C                     KFLD           WXW9ST           Inventory Trans
     C                     KFLD           WXBSST           Inventory Trans
     C                     KFLD           WXB4DT           Transaction Dat
     C                     KFLD           WXC4NY           ITD Sequence Nu
     C                     KFLD           WXDXNB           Sequence Number
      * Setup key
     C                     Z-ADDYL0043    WXAIC3           Company Number
     C                     Z-ADDWAHGCD    WXHGCD           Item Code
     C                     MOVELWAAJCD    WXAJCD           Warehouse Code
     C                     MOVEL'T'       WXW9ST           Inventory Trans
     C                     MOVEL'TW'      WXBSST           Inventory Trans
     C                     Z-ADD##JDT     WXB4DT           Transaction Dat
     C                     Z-ADDWN0128    WXC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WXDXNB           Sequence Number
      * Establish starting position
     C           KRSTH     CHAINRB7CPJ3              90    *
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Base Values        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0072           Company Number
     C                     Z-ADDWXHGCD    WL0073           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0074    WN0256    P      Description Lin
     C                     MOVELWL0075    WUAWNA    P      Description Lin
     C                     MOVELWL0076    WN0257    P      U/M - Primary
     C                     Z-ADDWL0077    WN0258           Conversion Fact
     C                     MOVELWL0078    WN0259    P      Operation Facto
     C                     MOVELWL0079    WN0260    P      U/M - Second
     C                     Z-ADDWL0080    WN0261           Conversion Fact
     C                     MOVELWL0081    WN0262    P      Operation Facto
     C                     MOVELWL0082    WN0263    P      U/M - Third
     C                     MOVELWL0083    WUAICD    P      U/M - Pricing
     C                     Z-ADDWL0084    WN0265           Unit Weight
     C                     MOVELWL0085    WN0266    P      Production Date
     C                     MOVELWL0086    WN0267    P      Catch Weight St
     C                     Z-ADDWL0087    WUCHTM           Fresh Chilling
      * Rtv Quantity/Dollars   RT - Item Balance  * 
     C                     EXSR TIRVGN
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
     C                     EXSR TJCHRC
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Quantity/Dollars   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWXAIC3    WMAIC3           Company Number
     C                     Z-ADDWXHGCD    WMHGCD           Item Code
     C                     MOVELWXAJCD    WMAJCD           Warehouse Code
      * Establish starting position
     C           KRSTI     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0275           Unit Cost Per P
     C                     Z-ADD*ZERO     WN0271           On Hand Weight
     C                     Z-ADD*ZERO     WN0272           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WN0273           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WN0274           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WUIDVA           Value of On Han
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMAGCS    WN0275           Unit Cost Per P
     C                     Z-ADDWMBOWG    WN0271           On Hand Weight
     C                     Z-ADDWMDDQT    WN0272           On Hand U/M1 Su
     C                     Z-ADDWMDEQT    WN0273           On Hand U/M2 Su
     C                     Z-ADDWMDFQT    WN0274           On Hand U/M3 Su
     C                     Z-ADDWMIDVA    WUIDVA           Value of On Han
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCHRC    BEGSR
      *================================================================
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0276 112       Quantity based
     C                     Z-ADD*ZERO     WN0277 112       Quantity based
     C                     Z-ADD*ZERO     WN0278 112       Quantity based
     C                     Z-ADD*ZERO     WN0279 114       Cost based on U
     C                     Z-ADD*ZERO     WN0280 114       Cost based on U
     C                     Z-ADD*ZERO     WN0281 114       Cost based on U
     C                     Z-ADD*ZERO     WN0282 112       Quantity Total
     C                     Z-ADD*ZERO     WN0283 112       Quantity Total
     C                     Z-ADD*ZERO     WN0284 112       Cost Replace Do
     C                     Z-ADD*ZERO     WN0285 112       USR Allocated P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      *
     C                     Z-ADD*ZERO     WN0286 114       Cost based on U
     C                     Z-ADD*ZERO     WN0287 114       Cost based on U
     C                     Z-ADD*ZERO     WN0288 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0279           Cost based on U
     C                     Z-ADD*ZERO     WN0280           Cost based on U
     C                     Z-ADD*ZERO     WN0281           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           WN0257    IFEQ WXCGCD                     *IF
     C                     Z-ADDWN0275    WN0279           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           WN0260    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0259    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0258    IFNE *ZERO                      *IF
     C           WN0275    DIV  WN0258    WN0287    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0259    IFEQ 'D'                        *IF
     C           WN0275    MULT WN0258    WN0287    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0287    WN0280           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0263    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0262    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0261    IFNE *ZERO                      *IF
     C           WN0287    DIV  WN0261    WN0281    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0262    IFEQ 'D'                        *IF
     C           WN0287    MULT WN0261    WN0281    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           WN0260    IFEQ WXCGCD                     *IF
     C                     Z-ADDWN0275    WN0280           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0259    IFEQ 'M'                        *IF
     C           WN0275    MULT WN0258    WN0279    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0259    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0258    IFNE *ZERO                      *IF
     C           WN0275    DIV  WN0258    WN0279    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0263    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0262    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0261    IFNE *ZERO                      *IF
     C           WN0275    DIV  WN0261    WN0281    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0262    IFEQ 'D'                        *IF
     C           WN0275    MULT WN0261    WN0281    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           WN0263    IFEQ WXCGCD                     *IF
     C                     Z-ADDWN0275    WN0281           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0262    IFEQ 'M'                        *IF
     C           WN0275    MULT WN0261    WN0287    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0262    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0261    IFNE *ZERO                      *IF
     C           WN0275    DIV  WN0261    WN0287    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0287    WN0280           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0259    IFEQ 'M'                        *IF
     C           WN0287    MULT WN0258    WN0279    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0259    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0258    IFNE *ZERO                      *IF
     C           WN0287    DIV  WN0258    WN0279    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0289 112       Quantity based
     C                     Z-ADD*ZERO     WN0290 112       Quantity based
     C                     Z-ADD*ZERO     WN0291 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0276           USR Qty based o
     C                     Z-ADD*ZERO     WN0277           USR Qty based o
     C                     Z-ADD*ZERO     WN0278           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           WN0257    IFEQ WXHVCD                     *IF
     C                     Z-ADDWXA5QT    WN0276           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           WN0260    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0259    IFEQ 'M'                        *IF
     C           WXA5QT    MULT WN0258    WN0290    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0259    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0258    IFNE *ZERO                      *IF
     C           WXA5QT    DIV  WN0258    WN0290    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0290    WN0277           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0263    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0262    IFEQ 'M'                        *IF
     C           WN0290    MULT WN0261    WN0291    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0262    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0261    IFNE *ZERO                      *IF
     C           WN0290    DIV  WN0261    WN0291    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0291    WN0278           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           WN0260    IFEQ WXHVCD                     *IF
     C                     Z-ADDWXA5QT    WN0277           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0259    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0258    IFNE *ZERO                      *IF
     C           WXA5QT    DIV  WN0258    WN0276    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0259    IFEQ 'D'                        *IF
     C           WXA5QT    MULT WN0258    WN0276    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0263    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0262    IFEQ 'M'                        *IF
     C           WXA5QT    MULT WN0261    WN0291    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0262    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0261    IFNE *ZERO                      *IF
     C           WXA5QT    DIV  WN0261    WN0291    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0291    WN0278           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           WN0263    IFEQ WXHVCD                     *IF
     C                     Z-ADDWXA5QT    WN0278           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0262    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0261    IFNE *ZERO                      *IF
     C           WXA5QT    DIV  WN0261    WN0290    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0262    IFEQ 'D'                        *IF
     C           WXA5QT    MULT WN0261    WN0290    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0290    WN0277           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0259    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0258    IFNE *ZERO                      *IF
     C           WN0290    DIV  WN0258    WN0276    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0259    IFEQ 'D'                        *IF
     C           WN0290    MULT WN0258    WN0276    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWXAIC3    WVAIC3           Company Number
     C                     Z-ADDWXHGCD    WVHGCD           Item Code
     C                     MOVELWXAJCD    WVAJCD    P      Warehouse Code
      *
     C           KLCHTJ    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVHGCD           Item Code
     C                     KFLD           WVAJCD           Warehouse Code
     C           KLCHTJ    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YERDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YERDC            *Record Data Ch
      * (Creates IB if not found or updates if it exists)
      * Update IC Item Balance Detail
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
     C                     EXSR TKRVGN
      * Update the quantity/weight on hand in the item balance file
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0146           Company Number
     C                     Z-ADDWVHGCD    WL0147           Item Code
     C                     MOVELWVAJCD    WL0148    P      Warehouse Code
     C                     Z-ADDWVBOWG    WL0149           Quantity on Han
     C                     Z-ADDWVDDQT    WL0150           Quantity on Han
     C                     Z-ADDWUNFNN    WL0151           Quantity on Han
     C                     Z-ADDWUNFNN    WL0152           Quantity on Han
     C                     Z-ADDWVIDVA    WL0153           Value of On Han
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0149    WVBOWG           Quantity on Han
     C                     Z-ADDWL0150    WVDDQT           Quantity on Han
     C                     Z-ADDWL0151    WUNFNN           Quantity on Han
     C                     Z-ADDWL0152    WUNFNN           Quantity on Han
     C                     Z-ADDWL0153    WVIDVA           Value of On Han
     C                     Z-ADD*ZERO     WVDOQT           Available Prima
      * Available Primary U/M
     C           WVDDQT    SUB  WVAJQT    WVDOQT           Available Prima
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WVAATM' defaulted for 'Job Time'.
      * Field '(DB1) WVAYNA' defaulted for 'User Id'.
      * Field '(DB1) WVA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WVAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0292 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0293 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0294 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0295 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0296 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0297 114       Last Cost
     C                     Z-ADD*ZERO     WN0298 112       Value of On Han
     C                     MOVEL*BLANK    WN0299  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
      * Setup key
     C                     Z-ADDWVAIC3    WFAIC3           Company Number
     C                     Z-ADDWVHGCD    WFHGCD           Item Code
     C                     MOVELWVAJCD    WFAJCD           Warehouse Code
     C                     Z-ADDWXELDT    WFELDT           Production Date
      * Establish starting position
     C           KRSTK     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Quantity based on U/M1 S EQ WRK.ZERO
     C           WN0276    IFEQ WUW0NB                     *IF
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0108           Company Number
     C                     Z-ADDWVHGCD    WL0109           Item Code
     C                     MOVELWVAJCD    WL0110    P      Warehouse Code
     C                     Z-ADDWXELDT    WL0111           Production Date
     C                     Z-ADD*ZERO     WL0112           Physical Count
     C                     Z-ADD*ZERO     WL0113           Physical Count
     C                     Z-ADD*ZERO     WL0114           Physical Count
     C                     Z-ADD*ZERO     WL0115           Physical Count
     C                     MOVEL*BLANK    WL0116           Physical Count
     C                     Z-ADD*ZERO     WL0117           Quantity on Han
     C                     Z-ADDWN0276    WL0118           Quantity on Han
     C                     Z-ADD*ZERO     WL0119           Quantity on Han
     C                     Z-ADD*ZERO     WL0120           Quantity on Han
     C                     Z-ADD*ZERO     WL0121           Quantity In Chi
     C                     Z-ADD*ZERO     WL0122           Weight In Chill
     C                     MOVEL'N'       WL0123    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0124           Physical Start
     C                     Z-ADD*ZERO     WL0125           Physical Start
     C                     Z-ADD*ZERO     WL0126           Physical Start
     C                     Z-ADD*ZERO     WL0127           Physical Start
     C                     Z-ADD*ZERO     WL0128           Physical Start
     C                     Z-ADD*ZERO     WL0129           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0130           Last Cost
     C                     Z-ADD*ZERO     WL0131           Value of On Han
     C                     Z-ADDWXK7DT    WL0132           Label Date
     C                     Z-ADDWVRINB    WL0133           Item Structure
     C                     Z-ADDWVRHNB    WL0134           Item Structure
     C                     Z-ADDWVRGNB    WL0135           Item Structure
     C                     MOVEL*BLANK    WL0136           EDI Status 1
     C                     MOVEL*BLANK    WL0137           EDI Status 2
     C                     MOVEL*BLANK    WL0138           EDI Status 3
     C                     MOVEL'A'       WL0139    P      Record Status
     C                     EXSR SWCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0108           Company Number
     C                     Z-ADDWVHGCD    WL0109           Item Code
     C                     MOVELWVAJCD    WL0110    P      Warehouse Code
     C                     Z-ADDWXELDT    WL0111           Production Date
     C                     Z-ADD*ZERO     WL0112           Physical Count
     C                     Z-ADD*ZERO     WL0113           Physical Count
     C                     Z-ADD*ZERO     WL0114           Physical Count
     C                     Z-ADD*ZERO     WL0115           Physical Count
     C                     MOVEL*BLANK    WL0116           Physical Count
     C                     Z-ADDWXAHWG    WL0117           Quantity on Han
     C                     Z-ADDWN0276    WL0118           Quantity on Han
     C                     Z-ADD*ZERO     WL0119           Quantity on Han
     C                     Z-ADD*ZERO     WL0120           Quantity on Han
     C                     Z-ADD*ZERO     WL0121           Quantity In Chi
     C                     Z-ADD*ZERO     WL0122           Weight In Chill
     C                     MOVEL'N'       WL0123    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0124           Physical Start
     C                     Z-ADD*ZERO     WL0125           Physical Start
     C                     Z-ADD*ZERO     WL0126           Physical Start
     C                     Z-ADD*ZERO     WL0127           Physical Start
     C                     Z-ADD*ZERO     WL0128           Physical Start
     C                     Z-ADD*ZERO     WL0129           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0130           Last Cost
     C                     Z-ADDWXAYVA    WL0131           Value of On Han
     C                     Z-ADDWXK7DT    WL0132           Label Date
     C                     Z-ADDWVRINB    WL0133           Item Structure
     C                     Z-ADDWVRHNB    WL0134           Item Structure
     C                     Z-ADDWVRGNB    WL0135           Item Structure
     C                     MOVEL*BLANK    WL0136           EDI Status 1
     C                     MOVEL*BLANK    WL0137           EDI Status 2
     C                     MOVEL*BLANK    WL0138           EDI Status 3
     C                     MOVEL'A'       WL0139    P      Record Status
     C                     EXSR SWCRRC
     C                     END                             *FI
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Calculate new On Hand Value
      * CASE: PAR.Inventory Trans. Type is Adjustment Cycle Count
     C           WXBSST    IFEQ 'AC'                       *IF
     C           WFIDVA    ADD  WXAYVA    WN0298           Value of On Han
     C                     ELSE
      * CASE: PAR.Inventory Trans. Type is Quantity based Avg. Cost
     C           WXBSST    IFEQ 'R'                        *IF
     C           WXBSST    OREQ 'RP'
     C           WXBSST    OREQ 'S'
     C           WXBSST    OREQ 'TW'
     C           WXBSST    OREQ 'RW'
     C           WXBSST    OREQ 'RR'
     C           WFIDVA    ADD  WXAYVA    WN0298           Value of On Han
     C                     END                             *FI
     C                     END                             *FI
     C           WXAHWG    ADD  WFACWG    WN0292           Quantity on Han
     C           WFARQT    ADD  WN0276    WN0293           Quantity on Han
      * If quantity goes TO exactly 0, wgt and value to go 0
      * CASE: PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WN0293    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - IC Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WFAIC3    WQ0100  30       Company Number
     C                     PARM WFHGCD    WQ0101  70       Item Code
     C                     PARM WFAJCD    WQ0102  3        Warehouse Code
     C                     PARM WXB4DT    WQ0103  70       Transaction Dat
     C                     PARM WFELDT    WQ0104  70       Production Date
     C                     PARM WXHVCD    WQ0105  2        U/M - Transacti
     C                     PARM WN0292    WQ0106 112       Transaction Wei
     C                     PARM WN0296    WQ0107 114       USR Transaction
     C                     PARM WXCGCD    WQ0108  2        U/M - Cost
     C                     PARM WFRINB    WQ0109  30       Item Structure
     C                     PARM WFRHNB    WQ0110  30       Item Structure
     C                     PARM WFRGNB    WQ0111  30       Item Structure
     C                     PARM '1'       WQ0112  1        Shift Number
     C                     PARM WFK7DT    WQ0113  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0292           Quantity on Han
     C                     Z-ADD*ZERO     WN0298           Value of On Han
     C                     END                             *FI
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWFAJCD    WL0140    P      Warehouse Code
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0141    WN0299    P      Lot Tracking Fl
      * CASE: Qty = 0 & production date <> 0 & Lot Trk=N
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
      *   |- c2    : DB1.Production Date NE WRK.ZERO
      *   |- c3    : PAR.Lot Tracking Flag is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0293    IFEQ WUW0NB                     *IF
     C           WFELDT    IFNE WUW0NB                     *IF
     C           WN0299    IFEQ *BLANK                     *IF
     C           WN0299    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0142           Company Number
     C                     Z-ADDWFHGCD    WL0143           Item Code
     C                     MOVELWFAJCD    WL0144    P      Warehouse Code
     C                     Z-ADDWFELDT    WL0145           Production Date
     C                     EXSR SYDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
     C                     EXSR TLCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0300  70       Label Date
     C                     MOVEL*BLANK    WN0301  1        EDI Status 1
     C                     MOVEL*BLANK    WN0302  1        EDI Status 2
     C                     MOVEL*BLANK    WN0303  1        EDI Status 3
     C                     MOVEL*BLANK    WN0304  1        Record Status
     C                     Z-ADD*ZERO     WN0305  60       Job Time
     C                     MOVEL*BLANK    WN0306 10        User Id
     C                     MOVEL*BLANK    WN0307 10        Job Name
     C                     Z-ADD*ZERO     WN0308  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
     C                     MOVELWFAJCD    WGAJCD    P      Warehouse Code
     C                     Z-ADDWFELDT    WGELDT           Production Date
      *
     C           KLCHTL    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLCHTL    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YFRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWFABWG    WGABWG           Physical Count
     C                     Z-ADDWFAGQT    WGAGQT           Physical Count
     C                     Z-ADDWFAHQT    WGAHQT           Physical Count
     C                     Z-ADDWFAIQT    WGAIQT           Physical Count
     C                     MOVELWFCTST    WGCTST    P      Physical Count
     C                     Z-ADDWN0292    WGACWG           Quantity on Han
     C                     Z-ADDWN0293    WGARQT           Quantity on Han
     C                     Z-ADDWFASQT    WGASQT           Quantity on Han
     C                     Z-ADDWFATQT    WGATQT           Quantity on Han
     C                     Z-ADDWFHDQT    WGHDQT           Quantity In Chi
     C                     Z-ADDWFHEQT    WGHEQT           Weight In Chill
     C                     MOVELWFF6ST    WGF6ST    P      Update Exceptio
     C                     Z-ADDWFBMWG    WGBMWG           Physical Start
     C                     Z-ADDWFDSQT    WGDSQT           Physical Start
     C                     Z-ADDWFDTQT    WGDTQT           Physical Start
     C                     Z-ADDWFDUQT    WGDUQT           Physical Start
     C                     Z-ADDWFDHDT    WGDHDT           Physical Start
     C                     Z-ADDWFAGCS    WGAGCS           Unit Cost Per P
     C                     Z-ADDWFAECS    WGAECS           Last Cost
     C                     Z-ADDWN0298    WGIDVA           Value of On Han
     C                     Z-ADDWFRINB    WGRINB           Item Structure
     C                     Z-ADDWFRHNB    WGRHNB           Item Structure
     C                     Z-ADDWFRGNB    WGRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C                     MOVEL##PGM     WGA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      *
      *================================================================
      * ** 08/25/09 PKD E00475 Do not adjust On-Hand for Internal
      * ** To Whs
      * **
      * ** 12/05/2008 LJB FP1127 Update located on-hand Whse inventory
      * ** Only process loc quantity if not a Carlisle Controlled warehou
      * ** and lot tracking has been turned on.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Reset Production/Label Date if Lot Tracking warehouse.
      *================================================================
     C                     Z-ADDWAELDT    WN0138           Production Date
     C                     Z-ADDYL0010    WN0139           Label Date  USR
      * Determine the Lot Tracking Flag for From Warehouse.
      * If the From Warehouse Lot Tracking Flag is "N", then perform the
      * following "Clc" to determine if the To Warehouse Lot Tracking
      * Flag is "Y" and replace the Production Date with Job Date if it
      * is "Y".
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WALXNM           Lot Number
     C                     Z-ADD*ZERO     WAYNCD           Location Level
     C                     Z-ADD*ZERO     WAJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WAG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WAJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WAG6WG           ILl Item Wgt On
     C                     Z-ADD*ZERO     WAJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WAG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WALODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WALPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WALQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WANBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBYNCD           Location Level
     C                     Z-ADD*ZERO     WBCNNY           WLR Location Nu
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCLRDT           LLT Trans Date
     C                     Z-ADD*ZERO     WCLLTS           LLT Sequence #
     C                     Z-ADD*ZERO     WCLSDT           LLT Production
     C                     Z-ADD*ZERO     WCJ5QT           LLT Trans Qty
     C                     Z-ADD*ZERO     WCG8WG           LLT Trans Wgt
     C                     Z-ADD*ZERO     WCLLTN           LLT Lot Number
     C                     Z-ADD*ZERO     WCLLCL           LLT Location Le
     C                     Z-ADD*ZERO     WCLLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     WCLLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFELDT           Production Date
     C                     Z-ADD*ZERO     WFABWG           Physical Count
     C                     Z-ADD*ZERO     WFAGQT           Physical Count
     C                     Z-ADD*ZERO     WFAHQT           Physical Count
     C                     Z-ADD*ZERO     WFAIQT           Physical Count
     C                     Z-ADD*ZERO     WFACWG           Quantity on Han
     C                     Z-ADD*ZERO     WFARQT           Quantity on Han
     C                     Z-ADD*ZERO     WFASQT           Quantity on Han
     C                     Z-ADD*ZERO     WFATQT           Quantity on Han
     C                     Z-ADD*ZERO     WFHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WFHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WFBMWG           Physical Start
     C                     Z-ADD*ZERO     WFDSQT           Physical Start
     C                     Z-ADD*ZERO     WFDTQT           Physical Start
     C                     Z-ADD*ZERO     WFDUQT           Physical Start
     C                     Z-ADD*ZERO     WFDHDT           Physical Start
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAECS           Last Cost
     C                     Z-ADD*ZERO     WFIDVA           Value of On Han
     C                     Z-ADD*ZERO     WFK7DT           Label Date
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHLCBY           Location Bay
     C                     Z-ADD*ZERO     WHLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field WL Unused Sts 1
     C                     MOVEL*BLANK    WUWLUS  1
      * Define work field WL Unused Sts 2
     C                     MOVEL*BLANK    WUWUSD  1
      * Define work field WL PFS Zone
     C                     MOVEL*BLANK    WUWLUN  2
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJSLTY           WLT Type Chill
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAXNB           Current Account
     C                     Z-ADD*ZERO     WKNGNB           Current Account
     C                     Z-ADD*ZERO     WKBZNB           OM Week
     C                     Z-ADD*ZERO     WKC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WKC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WKCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WKIONB           Next Late Charg
     C                     Z-ADD*ZERO     WKI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WKDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WKC7NB           Next Customer #
     C                     Z-ADD*ZERO     WKC2NB           Next Inventory
     C                     Z-ADD*ZERO     WKC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WKL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WKBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WKAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WKASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WKA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WKAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WKABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WKACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WKADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WKAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WKAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WKAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WKAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WKAENB           Retention Perio
     C                     Z-ADD*ZERO     WKALNB           Retention Perio
     C                     Z-ADD*ZERO     WKEVNB           Retention Perio
     C                     Z-ADD*ZERO     WKRPOP           Retention Perio
     C                     Z-ADD*ZERO     WKDWNB           Retention Perio
     C                     Z-ADD*ZERO     WKR3NB           Next Load ID
     C                     Z-ADD*ZERO     WKR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WKSCNB           Production Numb
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WLAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WLAIWG           Unit Weight
     C                     Z-ADD*ZERO     WLCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WLC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WLURTN           Number Cases On
     C                     Z-ADD*ZERO     WLAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WLRINB           Item Structure
     C                     Z-ADD*ZERO     WLRHNB           Item Structure
     C                     Z-ADD*ZERO     WLRGNB           Item Structure
     C                     Z-ADD*ZERO     WLTFNB           Transportation
     C                     Z-ADD*ZERO     WLTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WLTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WLBLPR           Market Overage
     C                     Z-ADD*ZERO     WLBMPR           Standard Overag
     C                     Z-ADD*ZERO     WLCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WLCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WLSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WLPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WLICN1           Item Category N
     C                     Z-ADD*ZERO     WLICN2           Item Category N
     C                     Z-ADD*ZERO     WLV2NB           Item Category N
     C                     Z-ADD*ZERO     WLITCN           Item Category N
     C                     Z-ADD*ZERO     WLITC5           Item Category N
     C                     Z-ADD*ZERO     WLICN6           Item Category N
     C                     Z-ADD*ZERO     WLICN7           Item Category N
     C                     Z-ADD*ZERO     WLICN8           Item Category N
     C                     Z-ADD*ZERO     WLICN9           Item Category N
     C                     Z-ADD*ZERO     WLICN0           Item Category N
     C                     Z-ADD*ZERO     WLSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WLA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WLSJNB           Production Lead
     C                     Z-ADD*ZERO     WLSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WLSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WLSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WLCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WLCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WLILNB           Packages per ca
     C                     Z-ADD*ZERO     WLCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WLCINB           PM Batch Size
     C                     Z-ADD*ZERO     WLCJNB           Package Level s
     C                     Z-ADD*ZERO     WLCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WLCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WLCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WLCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WLCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WLCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WLCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WLCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WLC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WLB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WLB5NB           PM Line Number
     C                     Z-ADD*ZERO     WLBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WLBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WLF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WLF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WLF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WLBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WLBNNB           Production Qty
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field USR Weight
     C                     Z-ADD*ZERO     WUASWG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WMAECS           Last Cost
     C                     Z-ADD*ZERO     WMBACS           Cost per Primar
     C                     Z-ADD*ZERO     WMBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WMCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WMGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WMCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WMG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WMBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WMDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WMDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WMDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WMHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WMHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WMAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WMAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WMAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WMEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WMDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WMAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WMANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WMIDVA           Value of On Han
     C                     Z-ADD*ZERO     WMBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WMDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WMDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WMBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WMDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WMBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WMDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WMDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WMBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WMDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WMDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WMDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WMDMDT           Last Physical C
     C                     Z-ADD*ZERO     WMAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMRGNB           Item Structure
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Transaction Weight
     C                     Z-ADD*ZERO     WUAHWG 112
      * Define work field Transaction Quantity
     C                     Z-ADD*ZERO     WUA5QT 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOHGCD           Item Code
     C                     Z-ADD*ZERO     WOB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WOC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WODXNB           Sequence Number
     C                     Z-ADD*ZERO     WOELDT           Production Date
     C                     Z-ADD*ZERO     WOA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WOAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WOAKCS           USR Transaction
     C                     Z-ADD*ZERO     WOAYVA           Extended Amount
     C                     Z-ADD*ZERO     WOCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WOTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WOTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WOC4NB           Order Number
     C                     Z-ADD*ZERO     WORINB           Item Structure
     C                     Z-ADD*ZERO     WORHNB           Item Structure
     C                     Z-ADD*ZERO     WORGNB           Item Structure
     C                     Z-ADD*ZERO     WOAWTM           Production Time
     C                     Z-ADD*ZERO     WOK7DT           Label Date
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Clear all neither parameters
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WSBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WSBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WSBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WSBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field Location Code
     C                     MOVEL*BLANK    WUYMCD  4
      * Define work field Location Level
     C                     Z-ADD*ZERO     WUYNCD  20
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Clear all neither parameters
      * Crt Item Balance       CR - Item Balance  * 
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field U/M - Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Value of On Hand Inventor
     C                     Z-ADD*ZERO     WUIDVA 112
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  4
     C                     Z-ADD*ZERO     WL0003  20
     C                     Z-ADD*ZERO     WL0004  40
     C                     MOVEL*BLANK    WL0005  1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009  2
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  30
      * Define local variables for subroutine SDCRRC.
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014  3
     C                     MOVEL*BLANK    WL0015  2
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  50
     C                     Z-ADD*ZERO     WL0020 112
     C                     Z-ADD*ZERO     WL0021  50
     C                     MOVEL*BLANK    WL0022  4
     C                     Z-ADD*ZERO     WL0023  20
     C                     MOVEL*BLANK    WL0024  3
     C                     Z-ADD*ZERO     WL0025  50
     C                     MOVEL*BLANK    WL0026  4
     C                     Z-ADD*ZERO     WL0027  20
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     Z-ADD*ZERO     WL0036  60
     C                     MOVEL*BLANK    WL0037 10
     C                     MOVEL*BLANK    WL0038 10
     C                     Z-ADD*ZERO     WL0039  70
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  3
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044  50
     C                     MOVEL*BLANK    WL0045  4
     C                     Z-ADD*ZERO     WL0046  20
     C                     Z-ADD*ZERO     WL0047 112
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  70
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  3
     C                     Z-ADD*ZERO     WL0052  70
      * Define local variables for subroutine SGCHRC.
     C                     Z-ADD*ZERO     WL0053  30
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055  3
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057  50
     C                     MOVEL*BLANK    WL0058  4
     C                     Z-ADD*ZERO     WL0059  20
     C                     Z-ADD*ZERO     WL0060  50
      * Define local variables for subroutine SHDLRC.
     C                     Z-ADD*ZERO     WL0061  30
     C                     Z-ADD*ZERO     WL0062  70
     C                     MOVEL*BLANK    WL0063  3
     C                     Z-ADD*ZERO     WL0064  70
     C                     Z-ADD*ZERO     WL0065  50
     C                     MOVEL*BLANK    WL0066  4
     C                     Z-ADD*ZERO     WL0067  20
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0068  30
     C                     Z-ADD*ZERO     WL0069  70
     C                     MOVEL*BLANK    WL0070  3
     C                     Z-ADD*ZERO     WL0071  70
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0072  30
     C                     Z-ADD*ZERO     WL0073  70
     C                     MOVEL*BLANK    WL0074 30
     C                     MOVEL*BLANK    WL0075 30
     C                     MOVEL*BLANK    WL0076  2
     C                     Z-ADD*ZERO     WL0077  94
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079  2
     C                     Z-ADD*ZERO     WL0080  94
     C                     MOVEL*BLANK    WL0081  1
     C                     MOVEL*BLANK    WL0082  2
     C                     MOVEL*BLANK    WL0083  2
     C                     Z-ADD*ZERO     WL0084 112
     C                     MOVEL*BLANK    WL0085  1
     C                     MOVEL*BLANK    WL0086  1
     C                     Z-ADD*ZERO     WL0087  52
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0088  30
     C                     Z-ADD*ZERO     WL0089  70
     C                     MOVEL*BLANK    WL0090  3
     C                     Z-ADD*ZERO     WL0091 114
     C                     MOVEL*BLANK    WL0092  1
     C                     MOVEL*BLANK    WL0093  1
     C                     Z-ADD*ZERO     WL0094  80
     C                     MOVEL*BLANK    WL0095  1
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0096  30
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098  30
     C                     Z-ADD*ZERO     WL0099  30
     C                     Z-ADD*ZERO     WL0100  30
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0101  30
     C                     Z-ADD*ZERO     WL0102  70
     C                     MOVEL*BLANK    WL0103  3
     C                     MOVEL*BLANK    WL0104  1
     C                     MOVEL*BLANK    WL0105  2
     C                     Z-ADD*ZERO     WL0106  70
     C                     Z-ADD*ZERO     WL0107  50
      * Define local variables for subroutine SWCRRC.
     C                     Z-ADD*ZERO     WL0108  30
     C                     Z-ADD*ZERO     WL0109  70
     C                     MOVEL*BLANK    WL0110  3
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112 112
     C                     Z-ADD*ZERO     WL0113 112
     C                     Z-ADD*ZERO     WL0114 112
     C                     Z-ADD*ZERO     WL0115 112
     C                     MOVEL*BLANK    WL0116  1
     C                     Z-ADD*ZERO     WL0117 112
     C                     Z-ADD*ZERO     WL0118 112
     C                     Z-ADD*ZERO     WL0119 112
     C                     Z-ADD*ZERO     WL0120 112
     C                     Z-ADD*ZERO     WL0121 112
     C                     Z-ADD*ZERO     WL0122 112
     C                     MOVEL*BLANK    WL0123  1
     C                     Z-ADD*ZERO     WL0124 112
     C                     Z-ADD*ZERO     WL0125 112
     C                     Z-ADD*ZERO     WL0126 112
     C                     Z-ADD*ZERO     WL0127 112
     C                     Z-ADD*ZERO     WL0128  70
     C                     Z-ADD*ZERO     WL0129 114
     C                     Z-ADD*ZERO     WL0130 114
     C                     Z-ADD*ZERO     WL0131 112
     C                     Z-ADD*ZERO     WL0132  70
     C                     Z-ADD*ZERO     WL0133  30
     C                     Z-ADD*ZERO     WL0134  30
     C                     Z-ADD*ZERO     WL0135  30
     C                     MOVEL*BLANK    WL0136  1
     C                     MOVEL*BLANK    WL0137  1
     C                     MOVEL*BLANK    WL0138  1
     C                     MOVEL*BLANK    WL0139  1
      * Define local variables for subroutine SXRVGN.
     C                     MOVEL*BLANK    WL0140  3
     C                     MOVEL*BLANK    WL0141  1
      * Define local variables for subroutine SYDLRC.
     C                     Z-ADD*ZERO     WL0142  30
     C                     Z-ADD*ZERO     WL0143  70
     C                     MOVEL*BLANK    WL0144  3
     C                     Z-ADD*ZERO     WL0145  70
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0146  30
     C                     Z-ADD*ZERO     WL0147  70
     C                     MOVEL*BLANK    WL0148  3
     C                     Z-ADD*ZERO     WL0149 112
     C                     Z-ADD*ZERO     WL0150 112
     C                     Z-ADD*ZERO     WL0151 112
     C                     Z-ADD*ZERO     WL0152 112
     C                     Z-ADD*ZERO     WL0153 112
      * Define local variables for subroutine TBRVGN.
     C                     MOVEL*BLANK    WL0154  3
     C                     MOVEL*BLANK    WL0155 30
     C                     MOVEL*BLANK    WL0156 30
     C                     MOVEL*BLANK    WL0157 30
     C                     MOVEL*BLANK    WL0158 30
     C                     MOVEL*BLANK    WL0159 20
     C                     MOVEL*BLANK    WL0160 11
     C                     MOVEL*BLANK    WL0161  3
     C                     MOVEL*BLANK    WL0162  2
     C                     MOVEL*BLANK    WL0163  1
     C                     MOVEL*BLANK    WL0164 10
     C                     MOVEL*BLANK    WL0165  2
     C                     MOVEL*BLANK    WL0166  1
     C                     MOVEL*BLANK    WL0167  1
     C                     MOVEL*BLANK    WL0168  1
     C                     Z-ADD*ZERO     WL0169  52
     C                     MOVEL*BLANK    WL0170  1
     C                     MOVEL*BLANK    WL0171  1
     C                     MOVEL*BLANK    WL0172  1
     C                     MOVEL*BLANK    WL0173  1
     C                     Z-ADD*ZERO     WL0174  30
     C                     Z-ADD*ZERO     WL0175  30
     C                     Z-ADD*ZERO     WL0176  30
     C                     Z-ADD*ZERO     WL0177  30
     C                     MOVEL*BLANK    WL0178  3
     C                     MOVEL*BLANK    WL0179  1
     C                     MOVEL*BLANK    WL0180  1
     C                     MOVEL*BLANK    WL0181  1
     C                     MOVEL*BLANK    WL0182  1
     C                     MOVEL*BLANK    WL0183  2
     C                     MOVEL*BLANK    WL0184  2
     C                     MOVEL*BLANK    WL0185  3
     C                     MOVEL*BLANK    WL0186  3
     C                     MOVEL*BLANK    WL0187  3
     C                     MOVEL*BLANK    WL0188  1
     C                     MOVEL*BLANK    WL0189  1
     C                     MOVEL*BLANK    WL0190  1
     C                     MOVEL*BLANK    WL0191  1
     C                     Z-ADD*ZERO     WL0192  60
     C                     MOVEL*BLANK    WL0193 10
     C                     MOVEL*BLANK    WL0194 10
     C                     Z-ADD*ZERO     WL0195  70
      * Define local variables for subroutine TCRVGN.
     C                     MOVEL*BLANK    WL0196  3
     C                     MOVEL*BLANK    WL0197  4
     C                     MOVEL*BLANK    WL0198  2
     C                     Z-ADD*ZERO     WL0199  20
     C                     Z-ADD*ZERO     WL0200  52
      * Define local variables for subroutine TGCRRC.
     C                     Z-ADD*ZERO     WL0201  30
     C                     Z-ADD*ZERO     WL0202  70
     C                     MOVEL*BLANK    WL0203  3
     C                     MOVEL*BLANK    WL0204  1
     C                     MOVEL*BLANK    WL0205  2
     C                     Z-ADD*ZERO     WL0206  70
     C                     Z-ADD*ZERO     WL0207  50
     C                     Z-ADD*ZERO     WL0208  30
     C                     Z-ADD*ZERO     WL0209  70
     C                     MOVEL*BLANK    WL0210  2
     C                     MOVEL*BLANK    WL0211  2
     C                     MOVEL*BLANK    WL0212 30
     C                     Z-ADD*ZERO     WL0213 112
     C                     Z-ADD*ZERO     WL0214 112
     C                     Z-ADD*ZERO     WL0215 114
     C                     MOVEL*BLANK    WL0216  2
     C                     Z-ADD*ZERO     WL0217 112
     C                     MOVEL*BLANK    WL0218  6
     C                     Z-ADD*ZERO     WL0219  80
     C                     MOVEL*BLANK    WL0220  1
     C                     MOVEL*BLANK    WL0221  3
     C                     MOVEL*BLANK    WL0222 15
     C                     MOVEL*BLANK    WL0223 10
     C                     Z-ADD*ZERO     WL0224  70
     C                     Z-ADD*ZERO     WL0225  30
     C                     Z-ADD*ZERO     WL0226  70
     C                     Z-ADD*ZERO     WL0227  30
     C                     Z-ADD*ZERO     WL0228  30
     C                     Z-ADD*ZERO     WL0229  30
     C                     MOVEL*BLANK    WL0230 10
     C                     Z-ADD*ZERO     WL0231  60
     C                     MOVEL*BLANK    WL0232  1
     C                     Z-ADD*ZERO     WL0233  70
     C                     MOVEL*BLANK    WL0234  1
     C                     MOVEL*BLANK    WL0235  1
     C                     MOVEL*BLANK    WL0236  1
     C                     MOVEL*BLANK    WL0237  1
      * Define local work field WLR Location Number
     C                     Z-ADD*ZERO     YL0001  40
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field ILL Avail Ship Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Record Found -PS CD USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Location Bay Alpha
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0007  20
      * Define local work field Transfer Batch Number
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Transaction Quantity
     C                     Z-ADD*ZERO     YL0009 112
      * Define local work field Label Date
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0011 30
      * Define local work field Description Line Two
     C                     MOVEL*BLANK    YL0012 30
      * Define local work field U/M - Primary
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Conversion Factor 1
     C                     Z-ADD*ZERO     YL0014  94
      * Define local work field Operation Factor 1
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field U/M - Second
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field Conversion Factor 2
     C                     Z-ADD*ZERO     YL0017  94
      * Define local work field Operation Factor 2
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field U/M - Third
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field U/M - Pricing
     C                     MOVEL*BLANK    YL0020  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0021 112
      * Define local work field Production Date Control
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Catch Weight Status
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0024  52
      * Define local work field U/M - Transaction
     C                     MOVEL*BLANK    YL0025  2
      * Define local work field USR Weight based on U/M1
     C                     Z-ADD*ZERO     YL0026 112
      * Define local work field USR Weight based on U/M2
     C                     Z-ADD*ZERO     YL0027 112
      * Define local work field USR Weight based on U/M3
     C                     Z-ADD*ZERO     YL0028 112
      * Define local work field Transaction Weight
     C                     Z-ADD*ZERO     YL0029 112
      * Define local work field Unit Cost Per Pound
     C                     Z-ADD*ZERO     YL0030 114
      * Define local work field Cost Update Pending
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Post G/L Status
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field Vendor - Item/Whse Deflt.
     C                     Z-ADD*ZERO     YL0033  80
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field Unit Cost - Detail
     C                     Z-ADD*ZERO     YL0035 114
      * Define local work field Transfer Batch Sequence
     C                     Z-ADD*ZERO     YL0036  30
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0005 20
      * Define null work field Zip/Postal Code
     C                     MOVEL*BLANK    YN0006 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0008  2
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0037  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0009 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0011  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0038  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0013  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0018  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0019  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0020  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0021  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0023  1
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0039  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0026  2
      * Define null work field WHS Unused Sts 6
     C                     MOVEL*BLANK    YN0027  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0028  3
      * Define null work field WHS TPM Location Code
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field WHS Unused Sts 9
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0035  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0036 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0037 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0038  70
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0040  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0041  20
      * Define local work field Loc Unused Chill Time
     C                     Z-ADD*ZERO     YL0042  52
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0043  30
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 1111111
00002 Y2U0005
00003 Warehouse Transfer
