     H/TITLE RTV Hog Pop Tattoo Hdr XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:54:35
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKDACPL1IF  E           K        DISK
      * RTV : Hog Population Rpt Hdr    Retrieval index
      *
     FPKA1CPLWIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Prd/Kill Date
      *
     FPKA1CP12IF  E           K        DISK
      * RSQ : Tattoo Header             Co/Prd/Loc/Kill Date
      *
     FPKA1CPL2IF  E           K        DISK
      * RSQ : Tattoo Header          Co/Src Cde/Kill
      *
     FPKA1CPLXIF  E           K        DISK
      * RSQ : Tattoo Header       Co/Src Typ/Kill Date
      *
     FPKA1CPLYIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Pay Typ/Kill Date
      *
     FPKA1CPLAIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Kill/Tattoo Active
      *
     FPKB1CPLFIF  E           K        DISK
      * RSQ : Carcass Detail            Co/Shift/Kdte
      *
     FPKDACPL0UF  E           K        DISK
      * UPD : Hog Population Rpt Hdr    Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@DACPQW
      * Hog Population Rpt Hdr    Retrieval index
      * Renamed input format fields
     I              DAK1ST                          WAK1ST
     I              DAJCTX                          WAJCTX
     I              DAQYNB                          WAQYNB
     I              DAKZST                          WAKZST
     I              DAK0ST                          WAK0ST
     I              DAR6NB                          WAR6NB
     I              DACMDT                          WACMDT
     I              DACODT                          WACODT
     I              DAENNB                          WAENNB
     I              DATNST                          WATNST
     I              DARKNB                          WARKNB
     I              DARLNB                          WARLNB
     I              DARMNB                          WARMNB
     I              DARNNB                          WARNNB
     I              DARONB                          WARONB
     I              DARPNB                          WARPNB
     I              DARQNB                          WARQNB
     I              DARRNB                          WARRNB
     I              DARSNB                          WARSNB
     I              DARTNB                          WARTNB
     I              DARUNB                          WARUNB
     I              DARVNB                          WARVNB
     I              DARWNB                          WARWNB
     I              DARXNB                          WARXNB
     I              DARYNB                          WARYNB
     I              DARZNB                          WARZNB
     I              DAR0NB                          WAR0NB
     I              DAR1NB                          WAR1NB
     I              DAR2NB                          WAR2NB
     I              DAR3NB                          WAR3NB
     I              DAR7NB                          WAR7NB
     I              DAEONB                          WAEONB
     I              DAEWPC                          WAEWPC
     I              DAEXPC                          WAEXPC
     I              DAR4NB                          WAR4NB
     I              DAEYPC                          WAEYPC
     I              DAE0PC                          WAE0PC
     I              DAAACD                          WAAACD
     I              DAABCD                          WAABCD
     I              DAHTCD                          WAHTCD
     I              DAAAVN                          WAAAVN
     I              DAAADT                          WAAADT
     I              DAAMTM                          WAAMTM
     I              DAAJST                          WAAJST
     I              DAAHVN                          WAAHVN
     I              DAAGVN                          WAAGVN
     I              DAABVN                          WAABVN
     I              DAABDT                          WAABDT
     I              DAABTM                          WAABTM
      *
     I@A1CPQ1
      * Tattoo Header             Co/Prd/Kill Date
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@DACPQV
      * Hog Population Rpt Hdr    Update index
      * Renamed input format fields
     I              DAK1ST                          WCK1ST
     I              DAJCTX                          WCJCTX
     I              DAQYNB                          WCQYNB
     I              DAKZST                          WCKZST
     I              DAK0ST                          WCK0ST
     I              DAR6NB                          WCR6NB
     I              DACMDT                          WCCMDT
     I              DACODT                          WCCODT
     I              DAENNB                          WCENNB
     I              DATNST                          WCTNST
     I              DARKNB                          WCRKNB
     I              DARLNB                          WCRLNB
     I              DARMNB                          WCRMNB
     I              DARNNB                          WCRNNB
     I              DARONB                          WCRONB
     I              DARPNB                          WCRPNB
     I              DARQNB                          WCRQNB
     I              DARRNB                          WCRRNB
     I              DARSNB                          WCRSNB
     I              DARTNB                          WCRTNB
     I              DARUNB                          WCRUNB
     I              DARVNB                          WCRVNB
     I              DARWNB                          WCRWNB
     I              DARXNB                          WCRXNB
     I              DARYNB                          WCRYNB
     I              DARZNB                          WCRZNB
     I              DAR0NB                          WCR0NB
     I              DAR1NB                          WCR1NB
     I              DAR2NB                          WCR2NB
     I              DAR3NB                          WCR3NB
     I              DAR7NB                          WCR7NB
     I              DAEONB                          WCEONB
     I              DAEWPC                          WCEWPC
     I              DAEXPC                          WCEXPC
     I              DAR4NB                          WCR4NB
     I              DAEYPC                          WCEYPC
     I              DAE0PC                          WCE0PC
     I              DAAACD                          WCAACD
     I              DAABCD                          WCABCD
     I              DAHTCD                          WCHTCD
     I              DAAAVN                          WCAAVN
     I              DAAADT                          WCAADT
     I              DAAMTM                          WCAMTM
     I              DAAJST                          WCAJST
     I              DAAHVN                          WCAHVN
     I              DAAGVN                          WCAGVN
     I              DAABVN                          WCABVN
     I              DAABDT                          WCABDT
     I              DAABTM                          WCABTM
      *
     I@A1CPD6
      * Tattoo Header             Co/Prd/Loc/Kill Date
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@A1CPRM
      * Tattoo Header          Co/Src Cde/Kill
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     I@A1CPQ2
      * Tattoo Header       Co/Src Typ/Kill Date
      * Renamed input format fields
     I              A1HMNB                          WFHMNB
     I              A1BNNB                          WFBNNB
     I              A1BONB                          WFBONB
     I              A1CVNB                          WFCVNB
     I              A1B0DT                          WFB0DT
     I              A1AWDT                          WFAWDT
     I              A1BICD                          WFBICD
     I              A1CPST                          WFCPST
     I              A1ACPR                          WFACPR
     I              A1B9PR                          WFB9PR
     I              A1CAPR                          WFCAPR
     I              A1C4ST                          WFC4ST
     I              A1AIPR                          WFAIPR
     I              A1A6DT                          WFA6DT
     I              A1C2ST                          WFC2ST
     I              A1CXNB                          WFCXNB
     I              A1CWNB                          WFCWNB
     I              A1FCNB                          WFFCNB
     I              A1H9NB                          WFH9NB
     I              A1FDNB                          WFFDNB
     I              A1FENB                          WFFENB
     I              A1HENB                          WFHENB
     I              A1HFNB                          WFHFNB
     I              A1CYNB                          WFCYNB
     I              A1LRNB                          WFLRNB
     I              A1E0NB                          WFE0NB
     I              A1A5PC                          WFA5PC
     I              A1FBNB                          WFFBNB
     I              A1A4PC                          WFA4PC
     I              A1F7NB                          WFF7NB
     I              A1HDNB                          WFHDNB
     I              A1F5NB                          WFF5NB
     I              A1F4NB                          WFF4NB
     I              A1F3NB                          WFF3NB
     I              A1F2NB                          WFF2NB
     I              A1AVPC                          WFAVPC
     I              A1AWPC                          WFAWPC
     I              A1CWPC                          WFCWPC
     I              A1A8PC                          WFA8PC
     I              A1A7PC                          WFA7PC
     I              A1B8PR                          WFB8PR
     I              A1AMPR                          WFAMPR
     I              A1ANPR                          WFANPR
     I              A1AYVA                          WFAYVA
     I              A1AWVA                          WFAWVA
     I              A1AOPR                          WFAOPR
     I              A1AXVA                          WFAXVA
     I              A1APPR                          WFAPPR
     I              A1ASPR                          WFASPR
     I              A1A4VA                          WFA4VA
     I              A1ATPR                          WFATPR
     I              A1A5VA                          WFA5VA
     I              A1CBPR                          WFCBPR
     I              A1CCPR                          WFCCPR
     I              A1LPNB                          WFLPNB
     I              A1CDPR                          WFCDPR
     I              A1A7VA                          WFA7VA
     I              A1A2PR                          WFA2PR
     I              A1JWST                          WFJWST
     I              A1CWST                          WFCWST
     I              A1D7ST                          WFD7ST
     I              A1D8ST                          WFD8ST
     I              A1DWST                          WFDWST
     I              A1D6ST                          WFD6ST
     I              A1GHNB                          WFGHNB
     I              A1BYDT                          WFBYDT
     I              A1E0ST                          WFE0ST
     I              A1E1ST                          WFE1ST
     I              A1E2ST                          WFE2ST
     I              A1BSDT                          WFBSDT
     I              A1BTDT                          WFBTDT
     I              A1BUDT                          WFBUDT
     I              A1HGNB                          WFHGNB
     I              A1HHNB                          WFHHNB
     I              A1HINB                          WFHINB
     I              A1A3PR                          WFA3PR
     I              A1A4PR                          WFA4PR
     I              A1A6PR                          WFA6PR
     I              A1J9NB                          WFJ9NB
     I              A1D6PR                          WFD6PR
     I              A1D7PR                          WFD7PR
     I              A1D8PR                          WFD8PR
     I              A1D9PR                          WFD9PR
     I              A1EAPR                          WFEAPR
     I              A1EBPR                          WFEBPR
     I              A1ECPR                          WFECPR
     I              A1EDPR                          WFEDPR
     I              A1EEPR                          WFEEPR
     I              A1EFPR                          WFEFPR
     I              A1EGPR                          WFEGPR
     I              A1EHPR                          WFEHPR
     I              A1KAST                          WFKAST
     I              A1J7ST                          WFJ7ST
     I              A1J9ST                          WFJ9ST
     I              A1OXNB                          WFOXNB
     I              A1LKST                          WFLKST
     I              A1LLST                          WFLLST
     I              A1J8ST                          WFJ8ST
     I              A1LIST                          WFLIST
     I              A1LJST                          WFLJST
     I              A1NZTX                          WFNZTX
     I              A1HJCD                          WFHJCD
     I              A1R4ST                          WFR4ST
     I              A1R5ST                          WFR5ST
     I              A1R6ST                          WFR6ST
     I              A1R7ST                          WFR7ST
     I              A1THWT                          WFTHWT
     I              A1T2WT                          WFT2WT
     I              A1THHD                          WFTHHD
     I              A1T2HD                          WFT2HD
     I              A1OBPR                          WFOBPR
     I              A1KOER                          WFKOER
     I              A1OPIR                          WFOPIR
     I              A1OPEM                          WFOPEM
     I              A1IORP                          WFIORP
     I              A1OWEO                          WFOWEO
     I              A1OQET                          WFOQET
     I              A1URST                          WFURST
     I              A1USST                          WFUSST
     I              A1HHPC                          WFHHPC
     I              A1S9PR                          WFS9PR
     I              A1TAPR                          WFTAPR
     I              A1TBPR                          WFTBPR
     I              A1JFUR                          WFJFUR
     I              A1KRIF                          WFKRIF
     I              A1KORF                          WFKORF
     I              A1KAPR                          WFKAPR
     I              A1KROT                          WFKROT
     I              A1OTJG                          WFOTJG
     I              A1IRJG                          WFIRJG
     I              A1IMJF                          WFIMJF
     I              A1IRGF                          WFIRGF
     I              A1KRJF                          WFKRJF
     I              A1OJRF                          WFOJRF
     I              A1KFOR                          WFKFOR
     I              A1ORJK                          WFORJK
     I              A1OMVJ                          WFOMVJ
     I              A1MVNF                          WFMVNF
     I              A1MCNF                          WFMCNF
     I              A1NCNF                          WFNCNF
     I              A1NCHF                          WFNCHF
     I              A1IGIR                          WFIGIR
     I              A1KFJR                          WFKFJR
     I              A1EADT                          WFEADT
     I              A1EBDT                          WFEBDT
     I              A1ECDT                          WFECDT
     I              A1EDDT                          WFEDDT
     I              A1EEDT                          WFEEDT
     I              A1U4ST                          WFU4ST
     I              A1U5ST                          WFU5ST
     I              A1U6ST                          WFU6ST
     I              A1U7ST                          WFU7ST
     I              A1U8ST                          WFU8ST
     I              A1U9ST                          WFU9ST
     I              A1VAST                          WFVAST
     I              A1VBST                          WFVBST
     I              A1BDCD                          WFBDCD
     I              A1CSCD                          WFCSCD
     I              A1ABCD                          WFABCD
     I              A1AECD                          WFAECD
     I              A1ACCD                          WFACCD
     I              A1AGCD                          WFAGCD
     I              A1BECD                          WFBECD
     I              A1AAVN                          WFAAVN
     I              A1AADT                          WFAADT
     I              A1AMTM                          WFAMTM
     I              A1AJST                          WFAJST
     I              A1AHVN                          WFAHVN
     I              A1AGVN                          WFAGVN
     I              A1ABVN                          WFABVN
     I              A1ABDT                          WFABDT
     I              A1ABTM                          WFABTM
      *
     I@A1CPQ3
      * Tattoo Header             Co/Pay Typ/Kill Date
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     I@A1CPL0
      * Tattoo Header             Co/Kill/Tattoo Active
      * Renamed input format fields
     I              A1HMNB                          WHHMNB
     I              A1BNNB                          WHBNNB
     I              A1BONB                          WHBONB
     I              A1CVNB                          WHCVNB
     I              A1B0DT                          WHB0DT
     I              A1AWDT                          WHAWDT
     I              A1BICD                          WHBICD
     I              A1CPST                          WHCPST
     I              A1ACPR                          WHACPR
     I              A1B9PR                          WHB9PR
     I              A1CAPR                          WHCAPR
     I              A1C4ST                          WHC4ST
     I              A1AIPR                          WHAIPR
     I              A1A6DT                          WHA6DT
     I              A1C2ST                          WHC2ST
     I              A1CXNB                          WHCXNB
     I              A1CWNB                          WHCWNB
     I              A1FCNB                          WHFCNB
     I              A1H9NB                          WHH9NB
     I              A1FDNB                          WHFDNB
     I              A1FENB                          WHFENB
     I              A1HENB                          WHHENB
     I              A1HFNB                          WHHFNB
     I              A1CYNB                          WHCYNB
     I              A1LRNB                          WHLRNB
     I              A1E0NB                          WHE0NB
     I              A1A5PC                          WHA5PC
     I              A1FBNB                          WHFBNB
     I              A1A4PC                          WHA4PC
     I              A1F7NB                          WHF7NB
     I              A1HDNB                          WHHDNB
     I              A1F5NB                          WHF5NB
     I              A1F4NB                          WHF4NB
     I              A1F3NB                          WHF3NB
     I              A1F2NB                          WHF2NB
     I              A1AVPC                          WHAVPC
     I              A1AWPC                          WHAWPC
     I              A1CWPC                          WHCWPC
     I              A1A8PC                          WHA8PC
     I              A1A7PC                          WHA7PC
     I              A1B8PR                          WHB8PR
     I              A1AMPR                          WHAMPR
     I              A1ANPR                          WHANPR
     I              A1AYVA                          WHAYVA
     I              A1AWVA                          WHAWVA
     I              A1AOPR                          WHAOPR
     I              A1AXVA                          WHAXVA
     I              A1APPR                          WHAPPR
     I              A1ASPR                          WHASPR
     I              A1A4VA                          WHA4VA
     I              A1ATPR                          WHATPR
     I              A1A5VA                          WHA5VA
     I              A1CBPR                          WHCBPR
     I              A1CCPR                          WHCCPR
     I              A1LPNB                          WHLPNB
     I              A1CDPR                          WHCDPR
     I              A1A7VA                          WHA7VA
     I              A1A2PR                          WHA2PR
     I              A1JWST                          WHJWST
     I              A1CWST                          WHCWST
     I              A1D7ST                          WHD7ST
     I              A1D8ST                          WHD8ST
     I              A1DWST                          WHDWST
     I              A1D6ST                          WHD6ST
     I              A1GHNB                          WHGHNB
     I              A1BYDT                          WHBYDT
     I              A1E0ST                          WHE0ST
     I              A1E1ST                          WHE1ST
     I              A1E2ST                          WHE2ST
     I              A1BSDT                          WHBSDT
     I              A1BTDT                          WHBTDT
     I              A1BUDT                          WHBUDT
     I              A1HGNB                          WHHGNB
     I              A1HHNB                          WHHHNB
     I              A1HINB                          WHHINB
     I              A1A3PR                          WHA3PR
     I              A1A4PR                          WHA4PR
     I              A1A6PR                          WHA6PR
     I              A1J9NB                          WHJ9NB
     I              A1D6PR                          WHD6PR
     I              A1D7PR                          WHD7PR
     I              A1D8PR                          WHD8PR
     I              A1D9PR                          WHD9PR
     I              A1EAPR                          WHEAPR
     I              A1EBPR                          WHEBPR
     I              A1ECPR                          WHECPR
     I              A1EDPR                          WHEDPR
     I              A1EEPR                          WHEEPR
     I              A1EFPR                          WHEFPR
     I              A1EGPR                          WHEGPR
     I              A1EHPR                          WHEHPR
     I              A1KAST                          WHKAST
     I              A1J7ST                          WHJ7ST
     I              A1J9ST                          WHJ9ST
     I              A1OXNB                          WHOXNB
     I              A1LKST                          WHLKST
     I              A1LLST                          WHLLST
     I              A1J8ST                          WHJ8ST
     I              A1LIST                          WHLIST
     I              A1LJST                          WHLJST
     I              A1NZTX                          WHNZTX
     I              A1HJCD                          WHHJCD
     I              A1R4ST                          WHR4ST
     I              A1R5ST                          WHR5ST
     I              A1R6ST                          WHR6ST
     I              A1R7ST                          WHR7ST
     I              A1THWT                          WHTHWT
     I              A1T2WT                          WHT2WT
     I              A1THHD                          WHTHHD
     I              A1T2HD                          WHT2HD
     I              A1OBPR                          WHOBPR
     I              A1KOER                          WHKOER
     I              A1OPIR                          WHOPIR
     I              A1OPEM                          WHOPEM
     I              A1IORP                          WHIORP
     I              A1OWEO                          WHOWEO
     I              A1OQET                          WHOQET
     I              A1URST                          WHURST
     I              A1USST                          WHUSST
     I              A1HHPC                          WHHHPC
     I              A1S9PR                          WHS9PR
     I              A1TAPR                          WHTAPR
     I              A1TBPR                          WHTBPR
     I              A1JFUR                          WHJFUR
     I              A1KRIF                          WHKRIF
     I              A1KORF                          WHKORF
     I              A1KAPR                          WHKAPR
     I              A1KROT                          WHKROT
     I              A1OTJG                          WHOTJG
     I              A1IRJG                          WHIRJG
     I              A1IMJF                          WHIMJF
     I              A1IRGF                          WHIRGF
     I              A1KRJF                          WHKRJF
     I              A1OJRF                          WHOJRF
     I              A1KFOR                          WHKFOR
     I              A1ORJK                          WHORJK
     I              A1OMVJ                          WHOMVJ
     I              A1MVNF                          WHMVNF
     I              A1MCNF                          WHMCNF
     I              A1NCNF                          WHNCNF
     I              A1NCHF                          WHNCHF
     I              A1IGIR                          WHIGIR
     I              A1KFJR                          WHKFJR
     I              A1EADT                          WHEADT
     I              A1EBDT                          WHEBDT
     I              A1ECDT                          WHECDT
     I              A1EDDT                          WHEDDT
     I              A1EEDT                          WHEEDT
     I              A1U4ST                          WHU4ST
     I              A1U5ST                          WHU5ST
     I              A1U6ST                          WHU6ST
     I              A1U7ST                          WHU7ST
     I              A1U8ST                          WHU8ST
     I              A1U9ST                          WHU9ST
     I              A1VAST                          WHVAST
     I              A1VBST                          WHVBST
     I              A1BDCD                          WHBDCD
     I              A1CSCD                          WHCSCD
     I              A1ABCD                          WHABCD
     I              A1AECD                          WHAECD
     I              A1ACCD                          WHACCD
     I              A1AGCD                          WHAGCD
     I              A1BECD                          WHBECD
     I              A1AAVN                          WHAAVN
     I              A1AADT                          WHAADT
     I              A1AMTM                          WHAMTM
     I              A1AJST                          WHAJST
     I              A1AHVN                          WHAHVN
     I              A1AGVN                          WHAGVN
     I              A1ABVN                          WHABVN
     I              A1ABDT                          WHABDT
     I              A1ABTM                          WHABTM
      *
     I@B1CPCE
      * Carcass Detail            Co/Shift/Kdte
      * Renamed input format fields
     I              B1HMNB                          WIHMNB
     I              B1BNNB                          WIBNNB
     I              B1BONB                          WIBONB
     I              B1CVNB                          WICVNB
     I              B1B0DT                          WIB0DT
     I              B1LGNB                          WILGNB
     I              B1EUNB                          WIEUNB
     I              B1LHNB                          WILHNB
     I              B1INST                          WIINST
     I              B1BEPR                          WIBEPR
     I              B1ASPC                          WIASPC
     I              B1EWNB                          WIEWNB
     I              B1B4PR                          WIB4PR
     I              B1EYNB                          WIEYNB
     I              B1B1PR                          WIB1PR
     I              B1AVPR                          WIAVPR
     I              B1AUPC                          WIAUPC
     I              B1AWPR                          WIAWPR
     I              B1AXPR                          WIAXPR
     I              B1EZNB                          WIEZNB
     I              B1AYPR                          WIAYPR
     I              B1BBDT                          WIBBDT
     I              B1AKTM                          WIAKTM
     I              B1IQST                          WIIQST
     I              B1EFST                          WIEFST
     I              B1H6NB                          WIH6NB
     I              B1BEPC                          WIBEPC
     I              B1GCST                          WIGCST
     I              B1GDST                          WIGDST
     I              B1GEST                          WIGEST
     I              B1BHPC                          WIBHPC
     I              B1IOST                          WIIOST
     I              B1IPST                          WIIPST
     I              B1LTNB                          WILTNB
     I              B1JNST                          WIJNST
     I              B1X4NB                          WIX4NB
     I              B1FNPC                          WIFNPC
     I              B1FOPC                          WIFOPC
     I              B1FPPC                          WIFPPC
     I              B1K2ST                          WIK2ST
     I              B1K3ST                          WIK3ST
     I              B1JWPR                          WIJWPR
     I              B1F5PC                          WIF5PC
     I              B1JXPR                          WIJXPR
     I              B1JYPR                          WIJYPR
     I              B1JZPR                          WIJZPR
     I              B1J0PR                          WIJ0PR
     I              B1J1PR                          WIJ1PR
     I              B1J2PR                          WIJ2PR
     I              B1J3PR                          WIJ3PR
     I              B1J4PR                          WIJ4PR
     I              B1UTST                          WIUTST
     I              B1HVCD                          WIHVCD
     I              B1DKJR                          WIDKJR
     I              B1ITJF                          WIITJF
     I              B1IJGR                          WIIJGR
     I              B1ORJE                          WIORJE
     I              B1OTJR                          WIOTJR
     I              B1PEIR                          WIPEIR
     I              B1IEUF                          WIIEUF
     I              B1ORUE                          WIORUE
     I              B1IUTR                          WIIUTR
     I              B1IJRR                          WIIJRR
     I              B1VCST                          WIVCST
     I              B1VDST                          WIVDST
     I              B1VEST                          WIVEST
     I              B1VFST                          WIVFST
     I              B1VGST                          WIVGST
     I              B1ABCD                          WIABCD
     I              B1AACD                          WIAACD
     I              B1AAVN                          WIAAVN
     I              B1AADT                          WIAADT
     I              B1AMTM                          WIAMTM
     I              B1AJST                          WIAJST
     I              B1AHVN                          WIAHVN
     I              B1AGVN                          WIAGVN
     I              B1ABVN                          WIABVN
     I              B1ABDT                          WIABDT
     I              B1ABTM                          WIABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKDA1    E DSPKDACPL0
      * UPD : Hog Population Rpt Hdr    Update index
      * Renamed input format fields
     I              DAK1ST                          WCK1ST
     I              DAJCTX                          WCJCTX
     I              DAQYNB                          WCQYNB
     I              DAKZST                          WCKZST
     I              DAK0ST                          WCK0ST
     I              DAR6NB                          WCR6NB
     I              DACMDT                          WCCMDT
     I              DACODT                          WCCODT
     I              DAENNB                          WCENNB
     I              DATNST                          WCTNST
     I              DARKNB                          WCRKNB
     I              DARLNB                          WCRLNB
     I              DARMNB                          WCRMNB
     I              DARNNB                          WCRNNB
     I              DARONB                          WCRONB
     I              DARPNB                          WCRPNB
     I              DARQNB                          WCRQNB
     I              DARRNB                          WCRRNB
     I              DARSNB                          WCRSNB
     I              DARTNB                          WCRTNB
     I              DARUNB                          WCRUNB
     I              DARVNB                          WCRVNB
     I              DARWNB                          WCRWNB
     I              DARXNB                          WCRXNB
     I              DARYNB                          WCRYNB
     I              DARZNB                          WCRZNB
     I              DAR0NB                          WCR0NB
     I              DAR1NB                          WCR1NB
     I              DAR2NB                          WCR2NB
     I              DAR3NB                          WCR3NB
     I              DAR7NB                          WCR7NB
     I              DAEONB                          WCEONB
     I              DAEWPC                          WCEWPC
     I              DAEXPC                          WCEXPC
     I              DAR4NB                          WCR4NB
     I              DAEYPC                          WCEYPC
     I              DAE0PC                          WCE0PC
     I              DAAACD                          WCAACD
     I              DAABCD                          WCABCD
     I              DAHTCD                          WCHTCD
     I              DAAAVN                          WCAAVN
     I              DAAADT                          WCAADT
     I              DAAMTM                          WCAMTM
     I              DAAJST                          WCAJST
     I              DAAHVN                          WCAHVN
     I              DAAGVN                          WCAGVN
     I              DAABVN                          WCABVN
     I              DAABDT                          WCABDT
     I              DAABTM                          WCABTM
      *
     IYARDCS      DS                            176
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            176
     IYCRDCS      DS                            176
     IYDRDCS      DS                            176
     IYERDCS      DS                            176
     IYFRDCS      DS                            176
     IYGRDCS      DS                            176
     IYHRDCS      DS                            176
     IYIRDCS      DS                            176
     IYJRDCS      DS                            176
     IYKRDCS      DS                            176
     IYLRDCS      DS                            176
     IYMRDCS      DS                            176
     IYNRDCS      DS                            176
     IYORDCS      DS                            176
     IYPRDCS      DS                            176
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Hog Population Rpt Hdr
      * I :  HRH Type Of Distribution
     I                                        1   1 P1K1ST
      * I :  HRH Report Break
     I                                        2  26 P1JCTX
     IP2PARM      DS
      * I :  Report Type Usr
     I                                        1   1 P2K9ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1K1ST    PARM           WP0001  1        HRH Type Of Dis
     C           P1JCTX    PARM           WP0002 25        HRH Report Brea
     C           P2K9ST    PARM           WP0003  1        Report Type Usr
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * RTV Hog Pop Tattoo Hdr XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * HPE085
      * Hog Pop by farm site
      * Rtv Hog Popltn Rpt    RT - Hog Population Rpt Hdr  * 
     C                     EXSR SARVGN
      * Tattoo by Producer,source type, payment type, tattoo number, all
      * CASE: PAR.Report Type Usr is Producer
     C           P2K9ST    IFEQ 'P'                        *IF
      * Rtv Hog Pop Rpt-Prd   RT - Tattoo Header  * 
     C                     EXSR SBRVGN
     C                     ELSE
      * CASE: PAR.Report Type Usr is Producer/Location
     C           P2K9ST    IFEQ 'L'                        *IF
      * Rtv Hog Pop Rpt-Pr/Lc RT - Tattoo Header  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: PAR.Report Type Usr is Source Code
     C           P2K9ST    IFEQ 'S'                        *IF
      * Rtv Hog Pop Rpt-SrCde RT - Tattoo Header  * 
     C                     EXSR SHRVGN
     C                     ELSE
      * CASE: PAR.Report Type Usr is Source Type
     C           P2K9ST    IFEQ 'A'                        *IF
      * Rtv Hog Pop Rpt-SrTy  RT - Tattoo Header  * 
     C                     EXSR SKRVGN
     C                     ELSE
      * CASE: PAR.Report Type Usr is Payment Type
     C           P2K9ST    IFEQ 'B'                        *IF
      * Rtv Hog Pop Rpt-PyT   RT - Tattoo Header  * 
     C                     EXSR SNRVGN
     C                     ELSE
      * CASE: PAR.Report Type Usr is Tattoo
     C           P2K9ST    IFEQ 'T'                        *IF
      * Rtv Hog Pop Rpt-Tatto Rt - Tattoo Header  * 
     C                     EXSR SQRVGN
     C                     ELSE
      * CASE: PAR.Report Type Usr is Shift
     C           P2K9ST    IFEQ 'H'                        *IF
      * Rtv Hog Pop Rpt-Shift RT - Carcass Detail  * 
     C                     EXSR STRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * This will include farm site    HPE085
      * Rtv Hog Pop Rpt-Dte   Rt - Tattoo Header  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Hog Popltn Rpt    RT - Hog Population Rpt Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAK1ST           HRH Type Of Dis
     C                     KFLD           WAJCTX           HRH Report Brea
      * Setup key
     C                     MOVELP1K1ST    WAK1ST           HRH Type Of Dis
     C                     MOVELP1JCTX    WAJCTX           HRH Report Brea
      * Establish starting position
     C           KRSSA     CHAIN@DACPQW              90    *
      * Data record not found
     C   90                MOVEL'PRK0478' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAQYNB    WUQYNB           HRH Company Num
     C                     MOVELWAKZST    WUKZST           HRH Source Type
     C                     MOVELWAK0ST    WUK0ST           HRH Payment Typ
     C                     Z-ADDWAR6NB    WUR6NB           HRH Tattoo Numb
     C                     Z-ADDWACMDT    WUCMDT           HRH From Kill D
     C                     Z-ADDWACODT    WUCODT           HRH To Kill Dat
     C                     Z-ADDWAENNB    WUENNB           HRH Farm Site
     C                     MOVELWATNST    WUTNST           HRH Kill Shift
     C                     Z-ADDWARKNB    WURKNB           HRH Carcass Hdr
     C                     Z-ADDWARLNB    WURLNB           HRH Carcass Hdr
     C                     Z-ADDWARMNB    WURMNB           HRH Carcass Hdr
     C                     Z-ADDWARNNB    WURNNB           HRH Carcass Hdr
     C                     Z-ADDWARONB    WURONB           HRH Carcass Hdr
     C                     Z-ADDWARPNB    WURPNB           HRH Carcass Hdr
     C                     Z-ADDWARQNB    WURQNB           HRH Carcass Hdr
     C                     Z-ADDWARRNB    WURRNB           HRH Carcass Hdr
     C                     Z-ADDWARSNB    WURSNB           HRH Carcass Hdr
     C                     Z-ADDWARTNB    WURTNB           HRH Carcass Hdr
     C                     Z-ADDWARUNB    WURUNB           HRH Carcass Hdr
     C                     Z-ADDWARVNB    WURVNB           HRH Carcass Hdr
     C                     Z-ADDWARWNB    WURWNB           HRH Carcass Hdr
     C                     Z-ADDWARXNB    WURXNB           HRH Carcass Hdr
     C                     Z-ADDWARYNB    WURYNB           HRH Carcass Hdr
     C                     Z-ADDWARZNB    WURZNB           HRH Carcass Hdr
     C                     Z-ADDWAR0NB    WUR0NB           HRH Carcass Hdr
     C                     Z-ADDWAR1NB    WUR1NB           HRH Carcass Hdr
     C                     Z-ADDWAR2NB    WUR2NB           HRH Carcass Hdr
     C                     Z-ADDWAR3NB    WUR3NB           HRH Head Killed
     C                     Z-ADDWAR7NB    WUR7NB           HRH AVG Hot Wei
     C                     Z-ADDWAEONB    WUEONB           HRH Avg Live Wg
     C                     Z-ADDWAEWPC    WUEWPC           HRH Avg Light R
     C                     Z-ADDWAEXPC    WUEXPC           HRH Avg Loin Ey
     C                     Z-ADDWAR4NB    WUR4NB           HRH Avg Back Fa
     C                     Z-ADDWAEYPC    WUEYPC           HRH Avg Lean %
     C                     Z-ADDWAE0PC    WUE0PC           HRH % Adjusted
     C                     MOVELWAAACD    WUAACD           SR Source Code
     C                     MOVELWAABCD    WUABCD           PD Producer Cod
     C                     MOVELWAHTCD    WUHTCD           HRH Prdcr Locat
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Hog Pop Rpt-Prd   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UBSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBABCD    WQSB02           PD Producer Cod
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           PD Producer Cod
     C                     KFLD           WBB0DT           TH Kill Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           PD Producer Cod
      * Setup key
     C                     Z-ADDWUQYNB    WQSB01           BOH Company Num
     C                     MOVELWUABCD    WQSB02           PD Producer Cod
     C                     Z-ADDWUCMDT    WBB0DT           TH Kill Date
      * Establish starting position
     C           KPSSB     SETLL@A1CPQ1                    *
     C           KRSSB     READE@A1CPQ1                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Selection
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: DB1.TH Hog Class Type is Resale
     C           WBLLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.TH Payment Sts is Paid Producer
     C           WBCWST    IFEQ 'PL'                       *IF
     C           WBCWST    OREQ 'PC'
     C           WBCWST    OREQ 'NC'
     C           WBCWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Date selection
      * CASE: DB1.TH Kill Date LT PAR.HRH From Kill Date
     C           WBB0DT    IFLT WUCMDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: DB1.TH Kill Date GT PAR.HRH To Kill Date
     C           WBB0DT    IFGT WUCODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SCCHRC
     C                     END                             *FI
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * producer location
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Prdcr Location Code EQ WRK.Blank USR
     C           WUHTCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.PL Location Code EQ PAR.HRH Prdcr Location Code
     C           WBAECD    IFEQ WUHTCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shift
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Kill Shift EQ WRK.Blank USR
     C           WUTNST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Schedule Kill Shift EQ PAR.HRH Kill Shift
     C           WBLIST    IFEQ WUTNST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Source Type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Source Type EQ WRK.Blank USR
     C           WUKZST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Type EQ PAR.HRH Source Type
     C           WBKAST    IFEQ WUKZST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Source Code
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.SR Source Code EQ WRK.Blank USR
     C           WUAACD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Code EQ PAR.SR Source Code
     C           WBLKST    IFEQ WUAACD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Payment type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Payment Type EQ WRK.Blank USR
     C           WUK0ST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Payment Type EQ PAR.HRH Payment Type
     C           WBJ9ST    IFEQ WUK0ST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Farm Site
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Farm Site NE WRK.Zero USR
     C           WUENNB    IFNE WUE9NB                     *IF
      * CASE: DB1.TH Source Type is External
     C           WBKAST    IFEQ 'E'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0001    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0004  7        *Return code
     C                     PARM WBOXNB    WQ0005  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0006 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0007  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0008  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0009  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVELWBTHHD    WUJWCD           Farm Site State
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Tattoo number
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Tattoo Number EQ WRK.Zero USR
     C           WUR6NB    IFEQ WUE9NB                     *IF
     C                     ELSE
      * CASE: DB1.TH Tattoo Number EQ PAR.HRH Tattoo Number
     C           WBCVNB    IFEQ WUR6NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUH7ST           Record Found US
     C           WBF2NB    MULT WBE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNONB           Backfat * Wgt U
     C           WBF3NB    MULT WBE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNPNB           Loin-Eye * Wgt
     C           WBF4NB    MULT WBE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNNNB           Lean % * Wgt US
     C           WBF5NB    MULT WBE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUSZNB           Light Refl * Wg
     C                     ADD  WBE0NB    WUKGNB           Hot Weight Tot
     C                     ADD  WBFENB    WUS0NB           Head Killed Tot
     C                     ADD  WBHENB    WUQBNB           Head Adds
     C                     ADD  WBCYNB    WUZ7NB           Live wgt total
     C                     ADD  WBCWNB    WUB5NB           Head Total USR
     C                     END                             *FI
     C           KRSSB     READE@A1CPQ1                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SDCHRC
     C                     END                             *FI
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       HRH Company Num
     C                     MOVEL*BLANK    WN0002  1        HRH Source Type
     C                     MOVEL*BLANK    WN0003  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0004  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0005  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0006  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0007  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0008  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0009  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0010  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0011  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0012  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0013  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0014  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0015  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0016  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0017  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0018  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0019  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0020  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0021  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0022  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0023  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0024  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0025  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0026  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0027  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0028  3        SR Source Code
     C                     MOVEL*BLANK    WN0029  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0030  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0031 10        RS User Changed
     C                     Z-ADD*ZERO     WN0032  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0033  60       RS Time Changed
     C                     MOVEL*BLANK    WN0034  1        RS Record Statu
     C                     MOVEL*BLANK    WN0035 10        RS Job
     C                     MOVEL*BLANK    WN0036 10        RS Program
     C                     MOVEL*BLANK    WN0037 10        RS User Added
     C                     Z-ADD*ZERO     WN0038  70       RS Date Added
     C                     Z-ADD*ZERO     WN0039  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSC    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YARDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0040  30       HRH Company Num
     C                     MOVEL*BLANK    WN0041  1        HRH Source Type
     C                     MOVEL*BLANK    WN0042  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0043  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0044  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0045  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0046  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0047  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0048  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0049  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0050  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0051  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0052  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0053  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0054  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0055  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0056  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0057  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0058  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0059  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0060  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0061  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0062  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0063  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0064  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0065  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0066  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0067  3        SR Source Code
     C                     MOVEL*BLANK    WN0068  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0069  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0070 10        RS User Changed
     C                     Z-ADD*ZERO     WN0071  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0072  60       RS Time Changed
     C                     MOVEL*BLANK    WN0073  1        RS Record Statu
     C                     MOVEL*BLANK    WN0074 10        RS Job
     C                     MOVEL*BLANK    WN0075 10        RS Program
     C                     MOVEL*BLANK    WN0076 10        RS User Added
     C                     Z-ADD*ZERO     WN0077  70       RS Date Added
     C                     Z-ADD*ZERO     WN0078  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSD    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSD    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YBRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Hog Pop Rpt-Pr/Lc RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UCSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSE01           BOH Company Num
     C           *LIKE     DEFN WDABCD    WQSE02           PD Producer Cod
     C           *LIKE     DEFN WDAECD    WQSE03           PL Location Cod
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           PD Producer Cod
     C                     KFLD           WQSE03           PL Location Cod
     C                     KFLD           WDB0DT           TH Kill Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           PD Producer Cod
     C                     KFLD           WQSE03           PL Location Cod
      * Setup key
     C                     Z-ADDWUQYNB    WQSE01           BOH Company Num
     C                     MOVELWUABCD    WQSE02           PD Producer Cod
     C                     MOVELWUHTCD    WQSE03           PL Location Cod
     C                     Z-ADDWUCMDT    WDB0DT           TH Kill Date
      * Establish starting position
     C           KPSSE     SETLL@A1CPD6                    *
     C           KRSSE     READE@A1CPD6                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Selection
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: DB1.TH Hog Class Type is Resale
     C           WDLLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.TH Payment Sts is Paid Producer
     C           WDCWST    IFEQ 'PL'                       *IF
     C           WDCWST    OREQ 'PC'
     C           WDCWST    OREQ 'NC'
     C           WDCWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Date selection
      * CASE: DB1.TH Kill Date LT PAR.HRH From Kill Date
     C           WDB0DT    IFLT WUCMDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: DB1.TH Kill Date GT PAR.HRH To Kill Date
     C           WDB0DT    IFGT WUCODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SFCHRC
     C                     END                             *FI
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Shift
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Kill Shift EQ WRK.Blank USR
     C           WUTNST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Schedule Kill Shift EQ PAR.HRH Kill Shift
     C           WDLIST    IFEQ WUTNST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Source Type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Source Type EQ WRK.Blank USR
     C           WUKZST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Type EQ PAR.HRH Source Type
     C           WDKAST    IFEQ WUKZST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Source Code
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.SR Source Code EQ WRK.Blank USR
     C           WUAACD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Code EQ PAR.SR Source Code
     C           WDLKST    IFEQ WUAACD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Payment type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Payment Type EQ WRK.Blank USR
     C           WUK0ST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Payment Type EQ PAR.HRH Payment Type
     C           WDJ9ST    IFEQ WUK0ST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Farm Site
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Farm Site NE WRK.Zero USR
     C           WUENNB    IFNE WUE9NB                     *IF
      * CASE: DB1.TH Source Type is External
     C           WDKAST    IFEQ 'E'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0002    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0013  7        *Return code
     C                     PARM WDOXNB    WQ0014  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0015 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0016  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0017  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0018  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0002    IFEQ 'Y'                        *IF
     C                     Z-ADDWDTHHD    WUETNB           Farm Site USR
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Tattoo number
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Tattoo Number EQ WRK.Zero USR
     C           WUR6NB    IFEQ WUE9NB                     *IF
     C                     ELSE
      * CASE: DB1.TH Tattoo Number EQ PAR.HRH Tattoo Number
     C           WDCVNB    IFEQ WUR6NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUH7ST           Record Found US
     C           WDF2NB    MULT WDE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNONB           Backfat * Wgt U
     C           WDF3NB    MULT WDE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNPNB           Loin-Eye * Wgt
     C           WDF4NB    MULT WDE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNNNB           Lean % * Wgt US
     C           WDF5NB    MULT WDE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUSZNB           Light Refl * Wg
     C                     ADD  WDE0NB    WUKGNB           Hot Weight Tot
     C                     ADD  WDFENB    WUS0NB           Head Killed Tot
     C                     ADD  WDHENB    WUQBNB           Head Adds
     C                     ADD  WDCYNB    WUZ7NB           Live wgt total
     C                     ADD  WDCWNB    WUB5NB           Head Total USR
     C                     END                             *FI
     C           KRSSE     READE@A1CPD6                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SGCHRC
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0079  30       HRH Company Num
     C                     MOVEL*BLANK    WN0080  1        HRH Source Type
     C                     MOVEL*BLANK    WN0081  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0082  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0083  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0084  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0085  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0086  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0087  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0088  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0089  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0090  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0091  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0092  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0093  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0094  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0095  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0096  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0097  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0098  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0099  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0100  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0101  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0102  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0103  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0104  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0105  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0106  3        SR Source Code
     C                     MOVEL*BLANK    WN0107  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0108  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0109 10        RS User Changed
     C                     Z-ADD*ZERO     WN0110  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0111  60       RS Time Changed
     C                     MOVEL*BLANK    WN0112  1        RS Record Statu
     C                     MOVEL*BLANK    WN0113 10        RS Job
     C                     MOVEL*BLANK    WN0114 10        RS Program
     C                     MOVEL*BLANK    WN0115 10        RS User Added
     C                     Z-ADD*ZERO     WN0116  70       RS Date Added
     C                     Z-ADD*ZERO     WN0117  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSF    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSF    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YCRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0118  30       HRH Company Num
     C                     MOVEL*BLANK    WN0119  1        HRH Source Type
     C                     MOVEL*BLANK    WN0120  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0121  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0122  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0123  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0124  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0125  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0126  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0127  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0128  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0129  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0130  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0131  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0132  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0133  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0134  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0135  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0136  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0137  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0138  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0139  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0140  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0141  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0142  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0143  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0144  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0145  3        SR Source Code
     C                     MOVEL*BLANK    WN0146  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0147  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0148 10        RS User Changed
     C                     Z-ADD*ZERO     WN0149  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0150  60       RS Time Changed
     C                     MOVEL*BLANK    WN0151  1        RS Record Statu
     C                     MOVEL*BLANK    WN0152 10        RS Job
     C                     MOVEL*BLANK    WN0153 10        RS Program
     C                     MOVEL*BLANK    WN0154 10        RS User Added
     C                     Z-ADD*ZERO     WN0155  70       RS Date Added
     C                     Z-ADD*ZERO     WN0156  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSG    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSG    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YDRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Hog Pop Rpt-SrCde RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UDSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN WELKST    WQSH02           TH Source Code
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           TH Source Code
     C                     KFLD           WEB0DT           TH Kill Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           TH Source Code
      * Setup key
     C                     Z-ADDWUQYNB    WQSH01           BOH Company Num
     C                     MOVELWUAACD    WQSH02           TH Source Code
     C                     Z-ADDWUCMDT    WEB0DT           TH Kill Date
      * Establish starting position
     C           KPSSH     SETLL@A1CPRM                    *
     C           KRSSH     READE@A1CPRM                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Selection
     C                     MOVELWEHMNB    WUC3CD           Company Number
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: DB1.TH Hog Class Type is Resale
     C           WELLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.TH Payment Sts is Paid Producer
     C           WECWST    IFEQ 'PL'                       *IF
     C           WECWST    OREQ 'PC'
     C           WECWST    OREQ 'NC'
     C           WECWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Date selection
      * CASE: DB1.TH Kill Date LT PAR.HRH From Kill Date
     C           WEB0DT    IFLT WUCMDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: DB1.TH Kill Date GT PAR.HRH To Kill Date
     C           WEB0DT    IFGT WUCODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SICHRC
     C                     END                             *FI
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Source Type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Source Type EQ WRK.Blank USR
     C           WUKZST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Type EQ PAR.HRH Source Type
     C           WEKAST    IFEQ WUKZST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Payment type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Payment Type EQ WRK.Blank USR
     C           WUK0ST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Payment Type EQ PAR.HRH Payment Type
     C           WEJ9ST    IFEQ WUK0ST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Producer / location
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.PD Producer Code EQ WRK.Blank USR
     C           WUABCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: PAR.PD Producer Code EQ DB1.PD Producer Code
     C           WUABCD    IFEQ WEABCD                     *IF
      * Location
      * CASE: DB1.PD Producer Code EQ PAR.PD Producer Code
     C           WEABCD    IFEQ WUABCD                     *IF
      * CASE: PAR.HRH Prdcr Location Code EQ WRK.Blank USR
     C           WUHTCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.PL Location Code EQ PAR.HRH Prdcr Location Code
     C           WEAECD    IFEQ WUHTCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shift
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Kill Shift EQ WRK.Blank USR
     C           WUTNST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Schedule Kill Shift EQ PAR.HRH Kill Shift
     C           WELIST    IFEQ WUTNST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Tattoo number
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Tattoo Number EQ WRK.Zero USR
     C           WUR6NB    IFEQ WUE9NB                     *IF
     C                     ELSE
      * CASE: DB1.TH Tattoo Number EQ PAR.HRH Tattoo Number
     C           WECVNB    IFEQ WUR6NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Farm Site
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Farm Site NE WRK.Zero USR
     C           WUENNB    IFNE WUE9NB                     *IF
      * CASE: DB1.TH Source Type is External
     C           WEKAST    IFEQ 'E'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0022  7        *Return code
     C                     PARM WEOXNB    WQ0023  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0024 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0025  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0026  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0027  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0003    IFEQ 'Y'                        *IF
     C                     Z-ADDWETHHD    WUETNB           Farm Site USR
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUH7ST           Record Found US
     C           WEF2NB    MULT WEE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNONB           Backfat * Wgt U
     C           WEF3NB    MULT WEE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNPNB           Loin-Eye * Wgt
     C           WEF4NB    MULT WEE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNNNB           Lean % * Wgt US
     C           WEF5NB    MULT WEE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUSZNB           Light Refl * Wg
     C                     ADD  WEE0NB    WUKGNB           Hot Weight Tot
     C                     ADD  WEFENB    WUS0NB           Head Killed Tot
     C                     ADD  WEHENB    WUQBNB           Head Adds
     C                     ADD  WECYNB    WUZ7NB           Live wgt total
     C                     ADD  WECWNB    WUB5NB           Head Total USR
     C                     END                             *FI
     C           KRSSH     READE@A1CPRM                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SJCHRC
     C                     END                             *FI
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0157  30       HRH Company Num
     C                     MOVEL*BLANK    WN0158  1        HRH Source Type
     C                     MOVEL*BLANK    WN0159  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0160  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0161  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0162  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0163  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0164  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0165  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0166  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0167  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0168  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0169  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0170  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0171  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0172  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0173  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0174  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0175  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0176  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0177  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0178  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0179  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0180  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0181  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0182  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0183  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0184  3        SR Source Code
     C                     MOVEL*BLANK    WN0185  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0186  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0187 10        RS User Changed
     C                     Z-ADD*ZERO     WN0188  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0189  60       RS Time Changed
     C                     MOVEL*BLANK    WN0190  1        RS Record Statu
     C                     MOVEL*BLANK    WN0191 10        RS Job
     C                     MOVEL*BLANK    WN0192 10        RS Program
     C                     MOVEL*BLANK    WN0193 10        RS User Added
     C                     Z-ADD*ZERO     WN0194  70       RS Date Added
     C                     Z-ADD*ZERO     WN0195  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSI    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSI    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YERDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0196  30       HRH Company Num
     C                     MOVEL*BLANK    WN0197  1        HRH Source Type
     C                     MOVEL*BLANK    WN0198  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0199  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0200  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0201  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0202  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0203  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0204  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0205  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0206  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0207  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0208  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0209  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0210  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0211  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0212  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0213  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0214  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0215  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0216  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0217  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0218  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0219  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0220  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0221  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0222  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0223  3        SR Source Code
     C                     MOVEL*BLANK    WN0224  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0225  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0226 10        RS User Changed
     C                     Z-ADD*ZERO     WN0227  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0228  60       RS Time Changed
     C                     MOVEL*BLANK    WN0229  1        RS Record Statu
     C                     MOVEL*BLANK    WN0230 10        RS Job
     C                     MOVEL*BLANK    WN0231 10        RS Program
     C                     MOVEL*BLANK    WN0232 10        RS User Added
     C                     Z-ADD*ZERO     WN0233  70       RS Date Added
     C                     Z-ADD*ZERO     WN0234  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSJ    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YFRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Hog Pop Rpt-SrTy  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UESUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN WFKAST    WQSK02           TH Source Type
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           TH Source Type
     C                     KFLD           WFB0DT           TH Kill Date
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           TH Source Type
      * Setup key
     C                     Z-ADDWUQYNB    WQSK01           BOH Company Num
     C                     MOVELWUKZST    WQSK02           TH Source Type
     C                     Z-ADDWUCMDT    WFB0DT           TH Kill Date
      * Establish starting position
     C           KPSSK     SETLL@A1CPQ2                    *
     C           KRSSK     READE@A1CPQ2                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Selection
     C                     MOVELWFHMNB    WUC3CD           Company Number
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: DB1.TH Hog Class Type is Resale
     C           WFLLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.TH Payment Sts is Paid Producer
     C           WFCWST    IFEQ 'PL'                       *IF
     C           WFCWST    OREQ 'PC'
     C           WFCWST    OREQ 'NC'
     C           WFCWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Date selection
      * CASE: DB1.TH Kill Date LT PAR.HRH From Kill Date
     C           WFB0DT    IFLT WUCMDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: DB1.TH Kill Date GT PAR.HRH To Kill Date
     C           WFB0DT    IFGT WUCODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Source Code
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.SR Source Code EQ WRK.Blank USR
     C           WUAACD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Code EQ PAR.SR Source Code
     C           WFLKST    IFEQ WUAACD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Payment type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Payment Type EQ WRK.Blank USR
     C           WUK0ST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Payment Type EQ PAR.HRH Payment Type
     C           WFJ9ST    IFEQ WUK0ST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Producer / location
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.PD Producer Code EQ WRK.Blank USR
     C           WUABCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: PAR.PD Producer Code EQ DB1.PD Producer Code
     C           WUABCD    IFEQ WFABCD                     *IF
      * Location
      * CASE: DB1.PD Producer Code EQ PAR.PD Producer Code
     C           WFABCD    IFEQ WUABCD                     *IF
      * CASE: PAR.HRH Prdcr Location Code EQ WRK.Blank USR
     C           WUHTCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.PL Location Code EQ PAR.HRH Prdcr Location Code
     C           WFAECD    IFEQ WUHTCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shift
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Kill Shift EQ WRK.Blank USR
     C           WUTNST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Schedule Kill Shift EQ PAR.HRH Kill Shift
     C           WFLIST    IFEQ WUTNST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Tattoo number
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Tattoo Number EQ WRK.Zero USR
     C           WUR6NB    IFEQ WUE9NB                     *IF
     C                     ELSE
      * CASE: DB1.TH Tattoo Number EQ PAR.HRH Tattoo Number
     C           WFCVNB    IFEQ WUR6NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Farm Site
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Farm Site NE WRK.Zero USR
     C           WUENNB    IFNE WUE9NB                     *IF
      * CASE: DB1.TH Source Type is External
     C           WFKAST    IFEQ 'E'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0004    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0031  7        *Return code
     C                     PARM WFOXNB    WQ0032  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0033 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0034  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0035  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0036  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWFTHHD    WUETNB           Farm Site USR
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0004    IFEQ 'Y'                        *IF
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUH7ST           Record Found US
     C           WFF2NB    MULT WFE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNONB           Backfat * Wgt U
     C           WFF3NB    MULT WFE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNPNB           Loin-Eye * Wgt
     C           WFF4NB    MULT WFE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNNNB           Lean % * Wgt US
     C           WFF5NB    MULT WFE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUSZNB           Light Refl * Wg
     C                     ADD  WFE0NB    WUKGNB           Hot Weight Tot
     C                     ADD  WFFENB    WUS0NB           Head Killed Tot
     C                     ADD  WFHENB    WUQBNB           Head Adds
     C                     ADD  WFCYNB    WUZ7NB           Live wgt total
     C                     ADD  WFCWNB    WUB5NB           Head Total USR
     C                     END                             *FI
     C           KRSSK     READE@A1CPQ2                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SMCHRC
     C                     END                             *FI
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0235  30       HRH Company Num
     C                     MOVEL*BLANK    WN0236  1        HRH Source Type
     C                     MOVEL*BLANK    WN0237  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0238  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0239  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0240  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0241  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0242  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0243  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0244  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0245  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0246  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0247  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0248  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0249  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0250  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0251  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0252  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0253  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0254  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0255  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0256  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0257  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0258  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0259  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0260  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0261  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0262  3        SR Source Code
     C                     MOVEL*BLANK    WN0263  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0264  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0265 10        RS User Changed
     C                     Z-ADD*ZERO     WN0266  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0267  60       RS Time Changed
     C                     MOVEL*BLANK    WN0268  1        RS Record Statu
     C                     MOVEL*BLANK    WN0269 10        RS Job
     C                     MOVEL*BLANK    WN0270 10        RS Program
     C                     MOVEL*BLANK    WN0271 10        RS User Added
     C                     Z-ADD*ZERO     WN0272  70       RS Date Added
     C                     Z-ADD*ZERO     WN0273  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSL    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSL    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YGRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0274  30       HRH Company Num
     C                     MOVEL*BLANK    WN0275  1        HRH Source Type
     C                     MOVEL*BLANK    WN0276  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0277  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0278  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0279  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0280  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0281  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0282  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0283  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0284  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0285  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0286  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0287  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0288  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0289  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0290  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0291  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0292  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0293  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0294  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0295  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0296  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0297  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0298  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0299  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0300  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0301  3        SR Source Code
     C                     MOVEL*BLANK    WN0302  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0303  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0304 10        RS User Changed
     C                     Z-ADD*ZERO     WN0305  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0306  60       RS Time Changed
     C                     MOVEL*BLANK    WN0307  1        RS Record Statu
     C                     MOVEL*BLANK    WN0308 10        RS Job
     C                     MOVEL*BLANK    WN0309 10        RS Program
     C                     MOVEL*BLANK    WN0310 10        RS User Added
     C                     Z-ADD*ZERO     WN0311  70       RS Date Added
     C                     Z-ADD*ZERO     WN0312  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSM    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSM    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YHRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Hog Pop Rpt-PyT   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UFSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN WGJ9ST    WQSN02           TH Payment Type
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           TH Payment Type
     C                     KFLD           WGB0DT           TH Kill Date
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           TH Payment Type
      * Setup key
     C                     Z-ADDWUQYNB    WQSN01           BOH Company Num
     C                     MOVELWUK0ST    WQSN02           TH Payment Type
     C                     Z-ADDWUCMDT    WGB0DT           TH Kill Date
      * Establish starting position
     C           KPSSN     SETLL@A1CPQ3                    *
     C           KRSSN     READE@A1CPQ3                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Selection
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: DB1.TH Hog Class Type is Resale
     C           WGLLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.TH Payment Sts is Paid Producer
     C           WGCWST    IFEQ 'PL'                       *IF
     C           WGCWST    OREQ 'PC'
     C           WGCWST    OREQ 'NC'
     C           WGCWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Date selection
      * CASE: DB1.TH Kill Date LT PAR.HRH From Kill Date
     C           WGB0DT    IFLT WUCMDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: DB1.TH Kill Date GT PAR.HRH To Kill Date
     C           WGB0DT    IFGT WUCODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SOCHRC
     C                     END                             *FI
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Source Type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Source Type EQ WRK.Blank USR
     C           WUKZST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Type EQ PAR.HRH Source Type
     C           WGKAST    IFEQ WUKZST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Source Code
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.SR Source Code EQ WRK.Blank USR
     C           WUAACD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Code EQ PAR.SR Source Code
     C           WGLKST    IFEQ WUAACD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Producer / location
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.PD Producer Code EQ WRK.Blank USR
     C           WUABCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: PAR.PD Producer Code EQ DB1.PD Producer Code
     C           WUABCD    IFEQ WGABCD                     *IF
      * Location
      * CASE: DB1.PD Producer Code EQ PAR.PD Producer Code
     C           WGABCD    IFEQ WUABCD                     *IF
      * CASE: PAR.HRH Prdcr Location Code EQ WRK.Blank USR
     C           WUHTCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.PL Location Code EQ PAR.HRH Prdcr Location Code
     C           WGAECD    IFEQ WUHTCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shift
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Kill Shift EQ WRK.Blank USR
     C           WUTNST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Schedule Kill Shift EQ PAR.HRH Kill Shift
     C           WGLIST    IFEQ WUTNST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Tattoo number
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Tattoo Number EQ WRK.Zero USR
     C           WUR6NB    IFEQ WUE9NB                     *IF
     C                     ELSE
      * CASE: DB1.TH Tattoo Number EQ PAR.HRH Tattoo Number
     C           WGCVNB    IFEQ WUR6NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Farm Site
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Farm Site NE WRK.Zero USR
     C           WUENNB    IFNE WUE9NB                     *IF
      * CASE: DB1.TH Source Type is External
     C           WGKAST    IFEQ 'E'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0005    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0040  7        *Return code
     C                     PARM WGOXNB    WQ0041  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0042 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0043  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0044  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0045  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0005    IFEQ 'Y'                        *IF
     C                     Z-ADDWGTHHD    WUETNB           Farm Site USR
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUH7ST           Record Found US
     C           WGF2NB    MULT WGE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNONB           Backfat * Wgt U
     C           WGF3NB    MULT WGE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNPNB           Loin-Eye * Wgt
     C           WGF4NB    MULT WGE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNNNB           Lean % * Wgt US
     C           WGF5NB    MULT WGE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUSZNB           Light Refl * Wg
     C                     ADD  WGE0NB    WUKGNB           Hot Weight Tot
     C                     ADD  WGFENB    WUS0NB           Head Killed Tot
     C                     ADD  WGHENB    WUQBNB           Head Adds
     C                     ADD  WGCYNB    WUZ7NB           Live wgt total
     C                     ADD  WGCWNB    WUB5NB           Head Total USR
     C                     END                             *FI
     C           KRSSN     READE@A1CPQ3                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SPCHRC
     C                     END                             *FI
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0313  30       HRH Company Num
     C                     MOVEL*BLANK    WN0314  1        HRH Source Type
     C                     MOVEL*BLANK    WN0315  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0316  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0317  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0318  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0319  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0320  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0321  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0322  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0323  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0324  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0325  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0326  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0327  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0328  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0329  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0330  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0331  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0332  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0333  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0334  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0335  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0336  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0337  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0338  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0339  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0340  3        SR Source Code
     C                     MOVEL*BLANK    WN0341  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0342  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0343 10        RS User Changed
     C                     Z-ADD*ZERO     WN0344  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0345  60       RS Time Changed
     C                     MOVEL*BLANK    WN0346  1        RS Record Statu
     C                     MOVEL*BLANK    WN0347 10        RS Job
     C                     MOVEL*BLANK    WN0348 10        RS Program
     C                     MOVEL*BLANK    WN0349 10        RS User Added
     C                     Z-ADD*ZERO     WN0350  70       RS Date Added
     C                     Z-ADD*ZERO     WN0351  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSO    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSO    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YIRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0352  30       HRH Company Num
     C                     MOVEL*BLANK    WN0353  1        HRH Source Type
     C                     MOVEL*BLANK    WN0354  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0355  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0356  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0357  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0358  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0359  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0360  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0361  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0362  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0363  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0364  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0365  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0366  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0367  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0368  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0369  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0370  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0371  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0372  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0373  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0374  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0375  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0376  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0377  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0378  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0379  3        SR Source Code
     C                     MOVEL*BLANK    WN0380  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0381  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0382 10        RS User Changed
     C                     Z-ADD*ZERO     WN0383  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0384  60       RS Time Changed
     C                     MOVEL*BLANK    WN0385  1        RS Record Statu
     C                     MOVEL*BLANK    WN0386 10        RS Job
     C                     MOVEL*BLANK    WN0387 10        RS Program
     C                     MOVEL*BLANK    WN0388 10        RS User Added
     C                     Z-ADD*ZERO     WN0389  70       RS Date Added
     C                     Z-ADD*ZERO     WN0390  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSP    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSP    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YJRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Hog Pop Rpt-Tatto Rt - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UGSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN WHB0DT    WQSQ02           TH Kill Date
     C           *LIKE     DEFN WHCVNB    WQSQ03           TH Tattoo Numbe
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           TH Kill Date
     C                     KFLD           WQSQ03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWUQYNB    WQSQ01           BOH Company Num
     C                     Z-ADDWUCMDT    WQSQ02           TH Kill Date
     C                     Z-ADDWUR6NB    WQSQ03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSQ     SETLL@A1CPL0                    *
     C           KRSSQ     READE@A1CPL0                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Selection
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: DB1.TH Hog Class Type is Resale
     C           WHLLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.TH Payment Sts is Paid Producer
     C           WHCWST    IFEQ 'PL'                       *IF
     C           WHCWST    OREQ 'PC'
     C           WHCWST    OREQ 'NC'
     C           WHCWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Date selection
      * CASE: DB1.TH Kill Date LT PAR.HRH From Kill Date
     C           WHB0DT    IFLT WUCMDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: DB1.TH Kill Date GT PAR.HRH To Kill Date
     C           WHB0DT    IFGT WUCODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SRCHRC
     C                     END                             *FI
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Source Type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Source Type EQ WRK.Blank USR
     C           WUKZST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Type EQ PAR.HRH Source Type
     C           WHKAST    IFEQ WUKZST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Source Code
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.SR Source Code EQ WRK.Blank USR
     C           WUAACD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Code EQ PAR.SR Source Code
     C           WHLKST    IFEQ WUAACD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Payment type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Payment Type EQ WRK.Blank USR
     C           WUK0ST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Payment Type EQ PAR.HRH Payment Type
     C           WHJ9ST    IFEQ WUK0ST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Producer / location
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.PD Producer Code EQ WRK.Blank USR
     C           WUABCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: PAR.PD Producer Code EQ DB1.PD Producer Code
     C           WUABCD    IFEQ WHABCD                     *IF
      * Location
      * CASE: DB1.PD Producer Code EQ PAR.PD Producer Code
     C           WHABCD    IFEQ WUABCD                     *IF
      * CASE: PAR.HRH Prdcr Location Code EQ WRK.Blank USR
     C           WUHTCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.PL Location Code EQ PAR.HRH Prdcr Location Code
     C           WHAECD    IFEQ WUHTCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shift
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Kill Shift EQ WRK.Blank USR
     C           WUTNST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Schedule Kill Shift EQ PAR.HRH Kill Shift
     C           WHLIST    IFEQ WUTNST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Farm Site
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Farm Site NE WRK.Zero USR
     C           WUENNB    IFNE WUE9NB                     *IF
      * CASE: DB1.TH Source Type is External
     C           WHKAST    IFEQ 'E'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0006    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0049  7        *Return code
     C                     PARM WHOXNB    WQ0050  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0051 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0052  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0053  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0054  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0006    IFEQ 'Y'                        *IF
     C                     Z-ADDWHTHHD    WUETNB           Farm Site USR
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUH7ST           Record Found US
     C           WHF2NB    MULT WHE0NB    WUNONB           Backfat * Wgt U
     C           WHF3NB    MULT WHE0NB    WUNPNB           Loin-Eye * Wgt
     C           WHF4NB    MULT WHE0NB    WUNNNB           Lean % * Wgt US
     C           WHF5NB    MULT WHE0NB    WUSZNB           Light Refl * Wg
     C                     ADD  WHE0NB    WUKGNB           Hot Weight Tot
     C                     ADD  WHFENB    WUS0NB           Head Killed Tot
     C                     ADD  WHHENB    WUQBNB           Head Adds
     C                     ADD  WHCYNB    WUZ7NB           Live wgt total
     C                     ADD  WHCWNB    WUB5NB           Head Total USR
     C                     END                             *FI
     C           KRSSQ     READE@A1CPL0                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SSCHRC
     C                     END                             *FI
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0391  30       HRH Company Num
     C                     MOVEL*BLANK    WN0392  1        HRH Source Type
     C                     MOVEL*BLANK    WN0393  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0394  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0395  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0396  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0397  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0398  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0399  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0400  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0401  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0402  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0403  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0404  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0405  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0406  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0407  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0408  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0409  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0410  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0411  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0412  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0413  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0414  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0415  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0416  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0417  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0418  3        SR Source Code
     C                     MOVEL*BLANK    WN0419  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0420  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0421 10        RS User Changed
     C                     Z-ADD*ZERO     WN0422  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0423  60       RS Time Changed
     C                     MOVEL*BLANK    WN0424  1        RS Record Statu
     C                     MOVEL*BLANK    WN0425 10        RS Job
     C                     MOVEL*BLANK    WN0426 10        RS Program
     C                     MOVEL*BLANK    WN0427 10        RS User Added
     C                     Z-ADD*ZERO     WN0428  70       RS Date Added
     C                     Z-ADD*ZERO     WN0429  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSR    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSR    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YKRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0430  30       HRH Company Num
     C                     MOVEL*BLANK    WN0431  1        HRH Source Type
     C                     MOVEL*BLANK    WN0432  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0433  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0434  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0435  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0436  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0437  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0438  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0439  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0440  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0441  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0442  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0443  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0444  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0445  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0446  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0447  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0448  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0449  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0450  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0451  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0452  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0453  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0454  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0455  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0456  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0457  3        SR Source Code
     C                     MOVEL*BLANK    WN0458  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0459  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0460 10        RS User Changed
     C                     Z-ADD*ZERO     WN0461  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0462  60       RS Time Changed
     C                     MOVEL*BLANK    WN0463  1        RS Record Statu
     C                     MOVEL*BLANK    WN0464 10        RS Job
     C                     MOVEL*BLANK    WN0465 10        RS Program
     C                     MOVEL*BLANK    WN0466 10        RS User Added
     C                     Z-ADD*ZERO     WN0467  70       RS Date Added
     C                     Z-ADD*ZERO     WN0468  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSS    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSS    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YLRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Hog Pop Rpt-Shift RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUKGNB           Hot Weight Tot
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQST01           BOH Company Num
     C           *LIKE     DEFN WIIQST    WQST02           CD Shift
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           CD Shift
     C                     KFLD           WIB0DT           TH Kill Date
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           CD Shift
      * Setup key
     C                     Z-ADDWUQYNB    WQST01           BOH Company Num
     C                     MOVELWUTNST    WQST02           CD Shift
     C                     Z-ADDWUCMDT    WIB0DT           TH Kill Date
      * Establish starting position
     C           KPSST     SETLL@B1CPCE                    *
     C           KRSST     READE@B1CPCE                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Date selection
      * CASE: DB1.TH Kill Date LT PAR.HRH From Kill Date
     C           WIB0DT    IFLT WUCMDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: DB1.TH Kill Date GT PAR.HRH To Kill Date
     C           WIB0DT    IFGT WUCODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SUCHRC
     C                     END                             *FI
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Valid records for total.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.CD Record Add/Del Sts is Valid Records for Total
      *   |- c2    : DB1.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WIINST    IFEQ 'A'                        *IF
     C           WIINST    OREQ *BLANK
     C           WIAJST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Source Type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Source Type EQ WRK.Blank USR
     C           WUKZST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.CD Source Type EQ PAR.HRH Source Type
     C           WIK2ST    IFEQ WUKZST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Source Code
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.SR Source Code EQ WRK.Blank USR
     C           WUAACD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.SR Source Code EQ PAR.SR Source Code
     C           WIAACD    IFEQ WUAACD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Payment type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Payment Type EQ WRK.Blank USR
     C           WUK0ST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.CD Payment Type EQ PAR.HRH Payment Type
     C           WIK3ST    IFEQ WUK0ST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Producer / location
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.PD Producer Code EQ WRK.Blank USR
     C           WUABCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: PAR.PD Producer Code EQ DB1.PD Producer Code
     C           WUABCD    IFEQ WIABCD                     *IF
      * Location
      * CASE: DB1.PD Producer Code EQ PAR.PD Producer Code
     C           WIABCD    IFEQ WUABCD                     *IF
      * CASE: PAR.HRH Prdcr Location Code EQ WRK.Blank USR
     C           WUHTCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.CD Producer Loc/Farm EQ PAR.HRH Prdcr Location Code
     C           WIHVCD    IFEQ WUHTCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Tattoo
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Tattoo Number EQ WRK.Zero USR
     C           WUR6NB    IFEQ WUE9NB                     *IF
     C                     ELSE
      * CASE: DB1.TH Tattoo Number EQ PAR.HRH Tattoo Number
     C           WICVNB    IFEQ WUR6NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUH7ST           Record Found US
     C           WIH6NB    MULT WIEWNB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNONB           Backfat * Wgt U
     C           WIBEPC    MULT WIEWNB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNPNB           Loin-Eye * Wgt
     C           WIAUPC    MULT WIEWNB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNNNB           Lean % * Wgt US
     C           WIGCST    MULT WIEWNB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUSZNB           Light Refl * Wg
     C                     ADD  WIEWNB    WUKGNB           Hot Weight Tot
     C                     ADD  1         WUS0NB           Head Killed Tot
     C                     Z-ADD*ZERO     WUQBNB           Head Adds
     C                     Z-ADD*ZERO     WUZ7NB           Live wgt total
     C                     Z-ADDWUS0NB    WUB5NB           Head Total USR
     C                     END                             *FI
     C           KRSST     READE@B1CPCE                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SVCHRC
     C                     END                             *FI
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0469  30       HRH Company Num
     C                     MOVEL*BLANK    WN0470  1        HRH Source Type
     C                     MOVEL*BLANK    WN0471  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0472  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0473  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0474  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0475  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0476  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0477  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0478  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0479  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0480  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0481  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0482  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0483  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0484  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0485  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0486  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0487  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0488  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0489  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0490  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0491  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0492  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0493  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0494  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0495  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0496  3        SR Source Code
     C                     MOVEL*BLANK    WN0497  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0498  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0499 10        RS User Changed
     C                     Z-ADD*ZERO     WN0500  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0501  60       RS Time Changed
     C                     MOVEL*BLANK    WN0502  1        RS Record Statu
     C                     MOVEL*BLANK    WN0503 10        RS Job
     C                     MOVEL*BLANK    WN0504 10        RS Program
     C                     MOVEL*BLANK    WN0505 10        RS User Added
     C                     Z-ADD*ZERO     WN0506  70       RS Date Added
     C                     Z-ADD*ZERO     WN0507  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSU    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSU    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YMRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0508  30       HRH Company Num
     C                     MOVEL*BLANK    WN0509  1        HRH Source Type
     C                     MOVEL*BLANK    WN0510  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0511  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0512  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0513  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0514  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0515  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0516  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0517  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0518  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0519  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0520  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0521  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0522  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0523  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0524  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0525  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0526  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0527  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0528  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0529  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0530  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0531  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0532  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0533  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0534  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0535  3        SR Source Code
     C                     MOVEL*BLANK    WN0536  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0537  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0538 10        RS User Changed
     C                     Z-ADD*ZERO     WN0539  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0540  60       RS Time Changed
     C                     MOVEL*BLANK    WN0541  1        RS Record Statu
     C                     MOVEL*BLANK    WN0542 10        RS Job
     C                     MOVEL*BLANK    WN0543 10        RS Program
     C                     MOVEL*BLANK    WN0544 10        RS User Added
     C                     Z-ADD*ZERO     WN0545  70       RS Date Added
     C                     Z-ADD*ZERO     WN0546  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSV    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSV    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YNRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Hog Pop Rpt-Dte   Rt - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UHSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSW01           BOH Company Num
      * Define keylist
     C           KPSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WHB0DT           TH Kill Date
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
      * Setup key
     C                     Z-ADDWUQYNB    WQSW01           BOH Company Num
     C                     Z-ADDWUCMDT    WHB0DT           TH Kill Date
      * Establish starting position
     C           KPSSW     SETLL@A1CPL0                    *
     C           KRSSW     READE@A1CPL0                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Selection
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Farm Site
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Farm Site NE WRK.Zero USR
     C           WUENNB    IFNE WUE9NB                     *IF
      * CASE: DB1.TH Source Type is External
     C           WHKAST    IFEQ 'E'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0007    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0058  7        *Return code
     C                     PARM WHOXNB    WQ0059  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0060 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0061  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0062  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0063  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0007    IFEQ 'Y'                        *IF
     C                     Z-ADDWHTHHD    WUETNB           Farm Site USR
      * CASE: WRK.Farm Site USR NE PAR.HRH Farm Site
     C           WUETNB    IFNE WUENNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.TH Hog Class Type is Resale
     C           WHLLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.TH Payment Sts is Paid Producer
     C           WHCWST    IFEQ 'PL'                       *IF
     C           WHCWST    OREQ 'PC'
     C           WHCWST    OREQ 'NC'
     C           WHCWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Date selection
      * CASE: DB1.TH Kill Date LT PAR.HRH From Kill Date
     C           WHB0DT    IFLT WUCMDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: DB1.TH Kill Date GT PAR.HRH To Kill Date
     C           WHB0DT    IFGT WUCODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SXCHRC
     C                     END                             *FI
     C                     GOTO SWEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Source Type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Source Type EQ WRK.Blank USR
     C           WUKZST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Type EQ PAR.HRH Source Type
     C           WHKAST    IFEQ WUKZST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Source Code
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.SR Source Code EQ WRK.Blank USR
     C           WUAACD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Source Code EQ PAR.SR Source Code
     C           WHLKST    IFEQ WUAACD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Payment type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Payment Type EQ WRK.Blank USR
     C           WUK0ST    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.TH Payment Type EQ PAR.HRH Payment Type
     C           WHJ9ST    IFEQ WUK0ST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Producer / location
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.PD Producer Code EQ WRK.Blank USR
     C           WUABCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: PAR.PD Producer Code EQ DB1.PD Producer Code
     C           WUABCD    IFEQ WHABCD                     *IF
      * Location
      * CASE: DB1.PD Producer Code EQ PAR.PD Producer Code
     C           WHABCD    IFEQ WUABCD                     *IF
      * CASE: PAR.HRH Prdcr Location Code EQ WRK.Blank USR
     C           WUHTCD    IFEQ WUCRTX                     *IF
     C                     ELSE
      * CASE: DB1.PL Location Code EQ PAR.HRH Prdcr Location Code
     C           WHAECD    IFEQ WUHTCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Tattoo number
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.HRH Tattoo Number EQ WRK.Zero USR
     C           WUR6NB    IFEQ WUE9NB                     *IF
     C                     ELSE
      * CASE: DB1.TH Tattoo Number EQ PAR.HRH Tattoo Number
     C           WHCVNB    IFEQ WUR6NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUH7ST           Record Found US
     C           WHF2NB    MULT WHE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNONB           Backfat * Wgt U
     C           WHF3NB    MULT WHE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNPNB           Loin-Eye * Wgt
     C           WHF4NB    MULT WHE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUNNNB           Lean % * Wgt US
     C           WHF5NB    MULT WHE0NB    WUS1NB           Weighted Avg Su
     C                     ADD  WUS1NB    WUSZNB           Light Refl * Wg
     C                     ADD  WHE0NB    WUKGNB           Hot Weight Tot
     C                     ADD  WHFENB    WUS0NB           Head Killed Tot
     C                     ADD  WHHENB    WUQBNB           Head Adds
     C                     ADD  WHCYNB    WUZ7NB           Live wgt total
     C                     ADD  WHCWNB    WUB5NB           Head Total USR
     C                     END                             *FI
     C           KRSSW     READE@A1CPL0                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Upd Hog Popltn Rpt    IF
      * CASE: PAR.HRH Head Killed NE WRK.Zero USR
     C           WUS0NB    IFNE WUE9NB                     *IF
     C           WUKGNB    DIV  WUS0NB    WUR7NB           HRH AVG Hot Wei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR7NB           HRH AVG Hot Wei
     C                     END                             *FI
      * CASE: PAR.Head Total USR NE WRK.Zero USR
     C           WUB5NB    IFNE WUE9NB                     *IF
     C           WUZ7NB    DIV  WUB5NB    WUEONB           HRH Avg Live Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUEONB           HRH Avg Live Wg
     C                     END                             *FI
      * CASE: PAR.Hot Weight Tot USR NE WRK.Zero USR
     C           WUKGNB    IFNE WUE9NB                     *IF
     C           WUNONB    DIV  WUKGNB    WUR4NB           HRH Avg Back Fa
     C           WUNPNB    DIV  WUKGNB    WUEXPC           HRH Avg Loin Ey
     C           WUNNNB    DIV  WUKGNB    WUEYPC           HRH Avg Lean %
     C           WUSZNB    DIV  WUKGNB    WUEWPC           HRH Avg Light R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WUEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WUEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEWPC           HRH Avg Light R
     C                     END                             *FI
      * Percent Adjusted
      * CASE: PAR.HRH Head Killed is Greater then Zero
     C           WUS0NB    IFGT 0                          *IF
      * Percent Adjusted
      * WRK.HRH % Adjusted =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Head Adds             SUM
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HRH Head Killed
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUQBNB    DIV  WUS0NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUE0PC           HRH % Adjusted
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUE0PC           HRH % Adjusted
     C                     END                             *FI
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
     C                     EXSR SYCHRC
     C                     END                             *FI
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0547  30       HRH Company Num
     C                     MOVEL*BLANK    WN0548  1        HRH Source Type
     C                     MOVEL*BLANK    WN0549  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0550  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0551  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0552  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0553  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0554  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0555  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0556  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0557  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0558  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0559  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0560  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0561  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0562  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0563  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0564  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0565  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0566  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0567  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0568  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0569  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0570  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0571  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0572  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0573  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0574  3        SR Source Code
     C                     MOVEL*BLANK    WN0575  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0576  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0577 10        RS User Changed
     C                     Z-ADD*ZERO     WN0578  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0579  60       RS Time Changed
     C                     MOVEL*BLANK    WN0580  1        RS Record Statu
     C                     MOVEL*BLANK    WN0581 10        RS Job
     C                     MOVEL*BLANK    WN0582 10        RS Program
     C                     MOVEL*BLANK    WN0583 10        RS User Added
     C                     Z-ADD*ZERO     WN0584  70       RS Date Added
     C                     Z-ADD*ZERO     WN0585  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSX    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSX    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YORDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg Hog Ppltn Rpt-Tat  CH - Hog Population Rpt Hdr  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0586  30       HRH Company Num
     C                     MOVEL*BLANK    WN0587  1        HRH Source Type
     C                     MOVEL*BLANK    WN0588  1        HRH Payment Typ
     C                     Z-ADD*ZERO     WN0589  50       HRH Tattoo Numb
     C                     Z-ADD*ZERO     WN0590  70       HRH From Kill D
     C                     Z-ADD*ZERO     WN0591  70       HRH To Kill Dat
     C                     Z-ADD*ZERO     WN0592  50       HRH Farm Site
     C                     MOVEL*BLANK    WN0593  1        HRH Kill Shift
     C                     Z-ADD*ZERO     WN0594  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0595  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0596  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0597  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0598  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0599  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0600  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0601  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0602  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0603  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0604  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0605  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0606  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0607  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0608  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0609  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0610  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0611  31       HRH Carcass Hdr
     C                     Z-ADD*ZERO     WN0612  31       HRH Carcass Hdr
     C                     MOVEL*BLANK    WN0613  3        SR Source Code
     C                     MOVEL*BLANK    WN0614  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0615  6        HRH Prdcr Locat
     C                     MOVEL*BLANK    WN0616 10        RS User Changed
     C                     Z-ADD*ZERO     WN0617  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0618  60       RS Time Changed
     C                     MOVEL*BLANK    WN0619  1        RS Record Statu
     C                     MOVEL*BLANK    WN0620 10        RS Job
     C                     MOVEL*BLANK    WN0621 10        RS Program
     C                     MOVEL*BLANK    WN0622 10        RS User Added
     C                     Z-ADD*ZERO     WN0623  70       RS Date Added
     C                     Z-ADD*ZERO     WN0624  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @DACPQV
     C                     MOVELP1K1ST    WCK1ST    P      HRH Type Of Dis
     C                     MOVELP1JCTX    WCJCTX    P      HRH Report Brea
      *
     C           KLCHSY    KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCJCTX           HRH Report Brea
     C           KLCHSY    CHAIN@DACPQV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDACPL0'MDACP
     C                     MOVEL'@DACPQV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDA1    YPRDCS
      * Move non-key fields to @DACPQV
     C                     Z-ADDWUS0NB    WCR3NB           HRH Head Killed
     C                     Z-ADDWUR7NB    WCR7NB           HRH AVG Hot Wei
     C                     Z-ADDWUEONB    WCEONB           HRH Avg Live Wg
     C                     Z-ADDWUEWPC    WCEWPC           HRH Avg Light R
     C                     Z-ADDWUEXPC    WCEXPC           HRH Avg Loin Ey
     C                     Z-ADDWUR4NB    WCR4NB           HRH Avg Back Fa
     C                     Z-ADDWUEYPC    WCEYPC           HRH Avg Lean %
     C                     Z-ADDWUE0PC    WCE0PC           HRH % Adjusted
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDA1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@DACPQV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUQYNB    WQ0001  30       BOH Company Num
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0001           MTech Live Yes
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUQYNB    WQ0010  30       BOH Company Num
     C                     PARM @CN,001   WQ0011 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0012 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0002           MTech Live Yes
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUQYNB    WQ0019  30       BOH Company Num
     C                     PARM @CN,001   WQ0020 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0021 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0003           MTech Live Yes
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUQYNB    WQ0028  30       BOH Company Num
     C                     PARM @CN,001   WQ0029 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0030 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0004           MTech Live Yes
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUQYNB    WQ0037  30       BOH Company Num
     C                     PARM @CN,001   WQ0038 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0039 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0005           MTech Live Yes
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUQYNB    WQ0046  30       BOH Company Num
     C                     PARM @CN,001   WQ0047 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0048 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0006           MTech Live Yes
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUQYNB    WQ0055  30       BOH Company Num
     C                     PARM @CN,001   WQ0056 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0057 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0007           MTech Live Yes
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field HRH Company Number
     C                     Z-ADD*ZERO     WUQYNB  30
      * Define work field HRH Source Type
     C                     MOVEL*BLANK    WUKZST  1
      * Define work field HRH Payment Type
     C                     MOVEL*BLANK    WUK0ST  1
      * Define work field HRH Tattoo Number
     C                     Z-ADD*ZERO     WUR6NB  50
      * Define work field HRH From Kill Date
     C                     Z-ADD*ZERO     WUCMDT  70
      * Define work field HRH To Kill Date
     C                     Z-ADD*ZERO     WUCODT  70
      * Define work field HRH Farm Site
     C                     Z-ADD*ZERO     WUENNB  50
      * Define work field HRH Kill Shift
     C                     MOVEL*BLANK    WUTNST  1
      * Define work field HRH Carcass Hdr 01
     C                     Z-ADD*ZERO     WURKNB  31
      * Define work field HRH Carcass Hdr 02
     C                     Z-ADD*ZERO     WURLNB  31
      * Define work field HRH Carcass Hdr 03
     C                     Z-ADD*ZERO     WURMNB  31
      * Define work field HRH Carcass Hdr 04
     C                     Z-ADD*ZERO     WURNNB  31
      * Define work field HRH Carcass Hdr 05
     C                     Z-ADD*ZERO     WURONB  31
      * Define work field HRH Carcass Hdr 06
     C                     Z-ADD*ZERO     WURPNB  31
      * Define work field HRH Carcass Hdr 07
     C                     Z-ADD*ZERO     WURQNB  31
      * Define work field HRH Carcass Hdr 08
     C                     Z-ADD*ZERO     WURRNB  31
      * Define work field HRH Carcass Hdr 09
     C                     Z-ADD*ZERO     WURSNB  31
      * Define work field HRH Carcass Hdr 10
     C                     Z-ADD*ZERO     WURTNB  31
      * Define work field HRH Carcass Hdr 11
     C                     Z-ADD*ZERO     WURUNB  31
      * Define work field HRH Carcass Hdr 12
     C                     Z-ADD*ZERO     WURVNB  31
      * Define work field HRH Carcass Hdr 13
     C                     Z-ADD*ZERO     WURWNB  31
      * Define work field HRH Carcass Hdr 14
     C                     Z-ADD*ZERO     WURXNB  31
      * Define work field HRH Carcass Hdr 15
     C                     Z-ADD*ZERO     WURYNB  31
      * Define work field HRH Carcass Hdr 16
     C                     Z-ADD*ZERO     WURZNB  31
      * Define work field HRH Carcass Hdr 17
     C                     Z-ADD*ZERO     WUR0NB  31
      * Define work field HRH Carcass Hdr 18
     C                     Z-ADD*ZERO     WUR1NB  31
      * Define work field HRH Carcass Hdr 19
     C                     Z-ADD*ZERO     WUR2NB  31
      * Define work field HRH Head Killed
     C                     Z-ADD*ZERO     WUR3NB  70
      * Define work field HRH AVG Hot Weight
     C                     Z-ADD*ZERO     WUR7NB  51
      * Define work field HRH Avg Live Wgt
     C                     Z-ADD*ZERO     WUEONB  51
      * Define work field HRH Avg Light Rfl
     C                     Z-ADD*ZERO     WUEWPC  31
      * Define work field HRH Avg Loin Eye
     C                     Z-ADD*ZERO     WUEXPC  31
      * Define work field HRH Avg Back Fat
     C                     Z-ADD*ZERO     WUR4NB  31
      * Define work field HRH Avg Lean %
     C                     Z-ADD*ZERO     WUEYPC  31
      * Define work field HRH % Adjusted
     C                     Z-ADD*ZERO     WUE0PC  52
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Define work field PD Producer Code
     C                     MOVEL*BLANK    WUABCD  6
      * Define work field HRH Prdcr Location Code
     C                     MOVEL*BLANK    WUHTCD  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAQYNB           HRH Company Num
     C                     Z-ADD*ZERO     WAR6NB           HRH Tattoo Numb
     C                     Z-ADD*ZERO     WACMDT           HRH From Kill D
     C                     Z-ADD*ZERO     WACODT           HRH To Kill Dat
     C                     Z-ADD*ZERO     WAENNB           HRH Farm Site
     C                     Z-ADD*ZERO     WARKNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARLNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARMNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARNNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARONB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARPNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARQNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARRNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARSNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARTNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARUNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARVNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARWNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARXNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARYNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARZNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WAR0NB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WAR1NB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WAR2NB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WAR3NB           HRH Head Killed
     C                     Z-ADD*ZERO     WAR7NB           HRH AVG Hot Wei
     C                     Z-ADD*ZERO     WAEONB           HRH Avg Live Wg
     C                     Z-ADD*ZERO     WAEWPC           HRH Avg Light R
     C                     Z-ADD*ZERO     WAEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WAR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WAEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WAE0PC           HRH % Adjusted
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUH7ST  1
      * Define work field Head Killed Total Usr
     C                     Z-ADD*ZERO     WUS0NB  70
      * Define work field Hot Weight Tot USR
     C                     Z-ADD*ZERO     WUKGNB 111
      * Define work field Backfat * Wgt USR
     C                     Z-ADD*ZERO     WUNONB 152
      * Define work field Loin-Eye * Wgt USR
     C                     Z-ADD*ZERO     WUNPNB 152
      * Define work field Light Refl * Wgt Usr
     C                     Z-ADD*ZERO     WUSZNB 152
      * Define work field Lean % * Wgt USR
     C                     Z-ADD*ZERO     WUNNNB 152
      * Define work field Head Adds             SUM
     C                     Z-ADD*ZERO     WUQBNB  70
      * Define work field Live wgt total 11.1   USR
     C                     Z-ADD*ZERO     WUZ7NB 111
      * Define work field Head Total USR
     C                     Z-ADD*ZERO     WUB5NB  70
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field Farm Site USR
     C                     Z-ADD*ZERO     WUETNB  50
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Define work field Farm Site State USR
     C                     MOVEL*BLANK    WUJWCD  3
      * Define work field Weighted Avg Sum
     C                     Z-ADD*ZERO     WUS1NB 152
      * Define work field Company Number Alpha Usr
     C                     MOVEL*BLANK    WUC3CD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WIBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WIBONB           BOL Load Number
     C                     Z-ADD*ZERO     WICVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WIB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WILGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WIEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WILHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WIBEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WIASPC           CD STD Yield
     C                     Z-ADD*ZERO     WIEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WIB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WIEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WIB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WIAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WIAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WIAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WIAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WIEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WIAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WIBBDT           CD Kill Date
     C                     Z-ADD*ZERO     WIAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WIH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WIBEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WIGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WIBHPC           CD FFLI
     C                     Z-ADD*ZERO     WILTNB           CD LOT
     C                     Z-ADD*ZERO     WIX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WIFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WIFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WIFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WIJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WIF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WIJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WIJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WIJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WIJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WIJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WIJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WIJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WIJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WIDKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WIITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WIIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WIORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WIOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WIPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WIIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WIORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WIIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WIIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0007  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MTECHLIVE
