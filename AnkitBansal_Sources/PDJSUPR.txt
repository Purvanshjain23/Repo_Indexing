/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  SOURCE IS WRONG THIS IS PDJSUPR               */
/*  PROGRAM NUMBER:  PDLQUPR                                       */
/*  PROGRAM NAME:    Print Production Schedule/Plan                */
/*  PROGRAMMER:      Purva Patel                                   */
/*  CREATE DATE:     03/07/96                                      */
/*                                                                 */
/*  FUNCTION:        This CLP is submitted with an Execute Message */
/*                   from Display 1st Level Production.            */
/*                                                                 */
/*                   USER OPTIONS ARE PASSED THROUGH THE PARMS.    */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*  R CENTONZE  04/28/97 ADDED PARM REPORT TYPE   (PPS043)         */
/*  L BUSER     01/23/08 FP1235 CREATED A NEW MAKE SHEET REPORT.   */
/*              DON'T PASS THE WAREHOUSE CODE INTO THE MAKE SHEET. */
/*  L BUSER     04/14/08 FP1235 ADD PARM TO EMAIL THE MAKE SHEET   */
/*              TO "MAKESHEET" DISTRIBUTION LIST. VALID ONLY IF    */
/*              REPORT TYPE = "M".                                 */
/*  S MASON     10/28/08 E00243 Pass in Report typ = T or B        */
/*              T= Trim Schedule & B= Belly Schedule               */
/*  S MASON     11/17/08 CREATE THE FILES IN QTEMP FOR ALL         */
/*  S MASON     11/20/08 REMOVE WORK FILE FROM QTEMP DUE           */
/*              THIS BEING RUN BACK TO BACK AND FILE COULD         */
/*              STILL EXISTS IN THE NIGHTLY RUNS                   */
/*              ON DEMAND SELECTION IS OK.                         */
/*  S MASON     11/25/08 ADD DISTRIBUTION LIST FOR NEW             */
/*              BELLY & TRIM REPORTS                               */
/*  S MASON     12/03/08 ON BELLY & RIM REPORTS THAT               */
/*              IF EMAILED CHANGE THE "FROM ADDRESS"               */
/*              TO BE FROM STEVEN BURKE@SEABOARDFOODS.COM          */
/*  S MASON     12/08/08 PASS IN SELECTION TO PRINT HOLD OVERS     */
/*  S MASON     12/10/08 PASS BACK THE NEXT PRODUCTION DATE        */
/*              FROM THE BUILD OF THE WORK FILE                    */
/*  R CENTONZE  11/29/11 PASS IN SELECTION TO PRINT SUMMARY BOX    */
/*                       FOR "T"RIM RPT WHICH IS NEW PBA3PFR PGM  */
/*  S MASON     02/27/12 Pass in selection for the Production      */
/*              spread sheet, send using a distribution            */
/*              list, work file.                                   */
/*              The work file and the send of the spread sheet     */
/*              will only occur during the morning which is run    */
/*              from the invnight jobs.  The other process that    */
/*              use this function will pass in this parm as        */
/*              blanks so the work file and send out the work      */
/*              file will not occur.                               */
/*  S MASON     08/08/12 REMOVE THE BELLY AND TRIM PROCESS         */
/*              the Primal Schedules will no longer be performed   */
/*              in this cl                                         */
/*                                                                */
/*              Program PBD6XFR will now read the Item Category   */
/*              for Item Catefory 06 record and then veify each   */
/*              Primal Grp Rpt to see if this should be run       */
/*              and if so then the PBD5UPC will be executed       */
/*              in a user message USR4528                         */
/*                                                                */
/*              Program PBD6XFR will be processed in the following*/
/*                                                                */
/*              Program PMB2UPC which runs in the INVNIGHT JOBS   */
/*                                                                */
/*              Program PMBUPVR is the selection on demand        */
/*                                                                */
/*              Job Schd  PPSBELLTRM  will kick this off          */
/*              in the afternoon.                                 */
/*  S MASON     09/06/12 Remove the selection of the production    */
/*              spread sheet - all work on this will be done       */
/*              now in the Generic Primal Group Reports            */
/*              Remove Parm and file PBAHCPP be processed          */
/*              Remove Parm PRDSPS                                 */
/*              Remove File PBAHCPP                                */
/***************************************************************** */
             PGM        PARM(&RTN &PDEV &HOLD &SAVE &XCOPIES &PGM +
                          &PGMPRTF &APP &XCOMP &PRDTYP &XDATE +
                          &CMTSTS &RTYPE &WHSE &EMAIL &HOLDOV +
                          &SUMBOX)

/*-----------------------------------------------------------------*/
/*                      PARAMETER                                  */
/*-----------------------------------------------------------------*/
/* Print Options                                                   */
             DCL        VAR(&RTN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PDEV) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&XCOPIES) TYPE(*CHAR) LEN(15)
             DCL        VAR(&PGM) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PGMPRTF) TYPE(*CHAR) LEN(10)
             DCL        VAR(&APP) TYPE(*CHAR) LEN(6)
/* Email distribution list.                                        */
/* Company value code name.                                        */
             DCL        VAR(&VALDIST) TYPE(*CHAR) LEN(10)
/* Name of the distriubtion list that will be used                 */
             DCL        VAR(&DISTLST) TYPE(*CHAR) LEN(40)
             DCL        VAR(&DISTNME) TYPE(*CHAR) LEN(60)
/* Name of the distriubtion list for the Report type D             */
             DCL        VAR(&DIST) TYPE(*CHAR) LEN(10) /* DIST LIST*/
             DCL        VAR(&VALDISTPL) TYPE(*CHAR) LEN(10) +
                          VALUE(PRDSPSHEET) /*COMP VALU*/
/* Setup to email the Production Schedule via Spread Sheet        */
             DCL        VAR(&TEXT) TYPE(*CHAR) LEN(50) /* +
                          DESCRIPTION        */

/* Function Specific                                               */
             DCL        VAR(&XCOMP) TYPE(*CHAR) LEN(15)
             DCL        VAR(&PRDTYP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&XDATE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MDATE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&CMTSTS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&RTYPE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&WHSE) TYPE(*CHAR) LEN(3)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&HOLDOV) TYPE(*CHAR) LEN(1)
             DCL        VAR(&SUMBOX) TYPE(*CHAR) LEN(1)

             DCL        VAR(&DATA) TYPE(*CHAR) LEN(10) /* DATA +
                          FILES      */
             DCL        VAR(&DATAH) TYPE(*CHAR) LEN(10) /* HIST +
                          FILES      */

/*-----------------------------------------------------------------*/
/*                    PROGRAM VARIABLES                            */
/*-----------------------------------------------------------------*/
             DCL        VAR(&COPIES) TYPE(*DEC) LEN(2 0)

             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&COMPA) TYPE(*CHAR) LEN(3)
             DCL        VAR(&DATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&NDATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&NDATE2) TYPE(*DEC) LEN(7 0)

             DCL        VAR(&DESC) TYPE(*CHAR) LEN(50)

             DCL        VAR(&USER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&USRCLS) TYPE(*CHAR) LEN(10)

/*                                                                   */
             RTVJOBA    USER(&USER)
             RTVUSRPRF  USRPRF(&USER) USRCLS(&USRCLS)
/*-----------------------------------------------------------------*/
/*                     INITIALIZATION                              */
/*-----------------------------------------------------------------*/
             CHGVAR     VAR(&COPIES) VALUE(&XCOPIES)
             CHGVAR     VAR(&COMP) VALUE(&XCOMP)
             CHGVAR     VAR(&COMPA) VALUE(&COMP)
             CHGVAR     VAR(&DATE) VALUE(&XDATE)
             CVTDAT     DATE(&XDATE) TOVAR(&MDATE) FROMFMT(*CYMD) +
                          TOFMT(*MDYY) TOSEP(/)
             CHGVAR     VAR(&DESC) VALUE('Make Sheet for Company' +
                          *BCAT &COMPA *BCAT 'for' *BCAT &MDATE)

/*-----------------------------------------------------------------*/
/*                           MAIN                                  */
/*-----------------------------------------------------------------*/

             OVRPRTF    FILE(&PGMPRTF) OUTQ(&PDEV) COPIES(&COPIES) +
                          HOLD(&HOLD) SAVE(&SAVE)

/*-----------------------------------------------------------------*/
/* Moved here to allow the &DATA to be populated earlier for the   */
/* Day or the Variance Report                                      */
             CALL      PGM(CAQXXFR) PARM(' ' &DATA &DATAH)

 BG1:        IF         COND(&RTYPE *EQ 'D') THEN(DO)
/********************************************************************/

/* PMFAPFR is either the Day or the Variance Reports                */
             CALL       PGM(&PGM) PARM(' ' &COMP &PRDTYP &DATE &WHSE +
                          &APP &CMTSTS &RTYPE)

                          GOTO ENDPGM

 EN1:        ENDDO


/* PMFAPFR is either the Day or the Variance Reports                */
             IF         COND(&RTYPE *EQ 'V') Then(DO)
             CALL       PGM(&PGM) PARM(' ' &COMP &PRDTYP &DATE &WHSE +
                          &APP &CMTSTS &RTYPE)
                          GOTO ENDPGM
             ENDDO

/* FOR "MAKE SHEET" REPORT, DO NOT PASS THE WAREHOUSE CODE          */
/* IF EMAIL FLAG = "E" THEN EMAIL THE REPORT TO THE MAKESHEET       */
/* DISTRIBUTION LIST (SENDS TO EXCHANGE SERVER DIST LIST).          */
             IF         COND(&RTYPE *EQ 'M') THEN(DO)
             CALL       PGM(&PGM) PARM(' ' &COMP &PRDTYP &DATE &APP +
                          &CMTSTS &RTYPE)

                IF        COND(&EMAIL *EQ 'E') THEN(DO)
                ESEND/ESNDMAIL RECIPIENT(MAKESHEET) SUBJECT(&DESC) +
                          ATTLIST((* *PDF *N &PGMPRTF))

                          GOTO ENDPGM
                ENDDO
             ENDDO

MSGTRAP:
             SNDMSG     MSG('Request Failed. Please contact IT.') +
                          TOUSR(*REQUESTER)
/*-----------------------------------------------------------------*/
/*                      PROGRAM END                                */
/*-----------------------------------------------------------------*/
 ENDPGM:
             DLTOVR     FILE(*ALL)
             ENDPGM
