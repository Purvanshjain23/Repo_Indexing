     H/TITLE Upd WIM Bal Ord f/API  XF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 05/16/23  Time  : 08:52:42
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMBYREL1  IF   E           K DISK
      * RTV : Item Default              Retrieval index
      *
     FCABZREL1  IF   E           K DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPUCICPL2  IF   E           K DISK
      * RSQ : WIM Item Trans Detail     ITD Sequence Nbr (D)
      *
     FPUCHCPL1  IF   E           K DISK
      * RTV : WIM Item Balance Detail   Retrieval index
      *
     FPUCGCPL1  IF   E           K DISK
      * RTV : WIM Item Balance          Retrieval index
      *
     FPUCICPL0  IF A E           K DISK
      * UPD : WIM Item Trans Detail     Update index
      *
     FPUCHCPL0  UF A E           K DISK
      * UPD : WIM Item Balance Detail   Update index
      *
     FPUCGCPL0  UF   E           K DISK
      * UPD : WIM Item Balance          Update index
      *
      * Long constants
     D @CN#            S              6    DIM(03)CTDATA PERRCD(1)
     D @CN             S             25    DIM(03) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPUCI1        E DS                  EXTNAME(PUCICPL0)
      * UPD : WIM Item Trans Detail     Update index
      * Renamed input format fields
     D  WDAIC3       E                     EXTFLD(CIAIC3)
     D  WDHGCD       E                     EXTFLD(CIHGCD)
     D  WDAJCD       E                     EXTFLD(CIAJCD)
     D  WDNDSC       E                     EXTFLD(CINDSC)
     D  WDNOSC       E                     EXTFLD(CINOSC)
     D  WDNPSC       E                     EXTFLD(CINPSC)
     D  WDA9DT       E                     EXTFLD(CIA9DT)
     D  WDC4NY       E                     EXTFLD(CIC4NY)
     D  WDELDT       E                     EXTFLD(CIELDT)
     D  WDBKTS       E                     EXTFLD(CIBKTS)
     D  WDBLTS       E                     EXTFLD(CIBLTS)
     D  WDAZAB       E                     EXTFLD(CIAZAB)
     D  WDF1ST       E                     EXTFLD(CIF1ST)
     D  WDVQNA       E                     EXTFLD(CIVQNA)
     D  WDA5QT       E                     EXTFLD(CIA5QT)
     D  WDAHWG       E                     EXTFLD(CIAHWG)
     D  WDA0AB       E                     EXTFLD(CIA0AB)
     D  WDA1AB       E                     EXTFLD(CIA1AB)
     D  WDXLCD       E                     EXTFLD(CIXLCD)
     D  WDC4NB       E                     EXTFLD(CIC4NB)
     D  WDRINB       E                     EXTFLD(CIRINB)
     D  WDRHNB       E                     EXTFLD(CIRHNB)
     D  WDRGNB       E                     EXTFLD(CIRGNB)
     D  WDVSST       E                     EXTFLD(CIVSST)
     D  WDBGTS       E                     EXTFLD(CIBGTS)
     D  WDRUU1       E                     EXTFLD(CIRUU1)
     D  WDRVU1       E                     EXTFLD(CIRVU1)
      *
      /EJECT
     D XDINT           DS
      * Internal date
     D  XDINDT                 1      7  0
     D  XDINYY                 1      3  0
     D  XDINMM                 4      5  0
     D  XDINDD                 6      7  0
      /EJECT
     D XDI2T           DS
      * Internal date
     D  XDI2DT                 1     10
     D  XDI2CY                 1      4  0
     D  XDI2CC                 1      1  0
     D  XDI2YY                 2      4  0
     D  XDI2MM                 6      7  0
     D  XDI2DD                 9     10  0
     D QPUCH1        E DS                  EXTNAME(PUCHCPL0)
      * UPD : WIM Item Balance Detail   Update index
      * Renamed input format fields
     D  WFAIC3       E                     EXTFLD(CHAIC3)
     D  WFHGCD       E                     EXTFLD(CHHGCD)
     D  WFAJCD       E                     EXTFLD(CHAJCD)
     D  WFNDSC       E                     EXTFLD(CHNDSC)
     D  WFELDT       E                     EXTFLD(CHELDT)
     D  WFABWG       E                     EXTFLD(CHABWG)
     D  WFAGQT       E                     EXTFLD(CHAGQT)
     D  WFCTST       E                     EXTFLD(CHCTST)
     D  WFQWWG       E                     EXTFLD(CHQWWG)
     D  WFTBQT       E                     EXTFLD(CHTBQT)
     D  WFQXWG       E                     EXTFLD(CHQXWG)
     D  WFTCQT       E                     EXTFLD(CHTCQT)
     D  WFQ0WG       E                     EXTFLD(CHQ0WG)
     D  WFTFQT       E                     EXTFLD(CHTFQT)
     D  WFQ1WG       E                     EXTFLD(CHQ1WG)
     D  WFTGQT       E                     EXTFLD(CHTGQT)
     D  WFBMWG       E                     EXTFLD(CHBMWG)
     D  WFDSQT       E                     EXTFLD(CHDSQT)
     D  WFDHDT       E                     EXTFLD(CHDHDT)
     D  WFBITS       E                     EXTFLD(CHBITS)
     D  WFBGD8       E                     EXTFLD(CHBGD8)
     D  WFRINB       E                     EXTFLD(CHRINB)
     D  WFRHNB       E                     EXTFLD(CHRHNB)
     D  WFRGNB       E                     EXTFLD(CHRGNB)
     D  WFVSST       E                     EXTFLD(CHVSST)
     D  WFBGTS       E                     EXTFLD(CHBGTS)
     D  WFRUU1       E                     EXTFLD(CHRUU1)
     D  WFRVU1       E                     EXTFLD(CHRVU1)
     D  WFBHTS       E                     EXTFLD(CHBHTS)
     D  WFRWU1       E                     EXTFLD(CHRWU1)
     D  WFRXU1       E                     EXTFLD(CHRXU1)
      *
     D YARDCS          DS           317
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D QPUCG1        E DS                  EXTNAME(PUCGCPL0)
      * UPD : WIM Item Balance          Update index
      * Renamed input format fields
     D  WHAIC3       E                     EXTFLD(CGAIC3)
     D  WHHGCD       E                     EXTFLD(CGHGCD)
     D  WHAJCD       E                     EXTFLD(CGAJCD)
     D  WHNDSC       E                     EXTFLD(CGNDSC)
     D  WHBOWG       E                     EXTFLD(CGBOWG)
     D  WHDDQT       E                     EXTFLD(CGDDQT)
     D  WHQVWG       E                     EXTFLD(CGQVWG)
     D  WHS9QT       E                     EXTFLD(CGS9QT)
     D  WHTAQT       E                     EXTFLD(CGTAQT)
     D  WHQYWG       E                     EXTFLD(CGQYWG)
     D  WHTDQT       E                     EXTFLD(CGTDQT)
     D  WHQZWG       E                     EXTFLD(CGQZWG)
     D  WHTEQT       E                     EXTFLD(CGTEQT)
     D  WHRINB       E                     EXTFLD(CGRINB)
     D  WHRHNB       E                     EXTFLD(CGRHNB)
     D  WHRGNB       E                     EXTFLD(CGRGNB)
     D  WHVSST       E                     EXTFLD(CGVSST)
     D  WHBGTS       E                     EXTFLD(CGBGTS)
     D  WHRUU1       E                     EXTFLD(CGRUU1)
     D  WHRVU1       E                     EXTFLD(CGRVU1)
     D  WHBHTS       E                     EXTFLD(CGBHTS)
     D  WHRWU1       E                     EXTFLD(CGRWU1)
     D  WHRXU1       E                     EXTFLD(CGRXU1)
      *
     D YBRDCS          DS           254
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              3  0
     D  WP0002         S              7  0
     D  WP0003         S              3
     D  WP0004         S              3
     D  WP0005         S              3
     D  WP0006         S              7  0
     D  WP0007         S              7  0
     D  WP0008         S              2
     D  WP0009         S             30
     D  WP0010         S              3
     D  WP0011         S              7  0
     D  WP0012         S              1
     D  WP0013         S             11  2
     D  WP0014         S             11  2
     D  WP0015         S              1
     D  WP0016         S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S             10
     D  WN0001         S              4  0
     D  WN0002         S              2  0
     D  WN0003         S              2  0
     D  WN0004         S              4
     D  WN0005         S              2
     D  WN0006         S              2
     D  WN0007         S              2  0
     D  WN0008         S              2
     D  WN0009         S              7
     D  ZQ             S              5  0
     D  YL0002         S              4
     D  YL0003         S              5
     D  YL0004         S              3
     D  YL0005         S              5
     D  YL0006         S             26
     D  XDTSDL         S             26
     D  YL0007         S             26
     D  WN0010         S              4  0
     D  WN0011         S              2  0
     D  WN0012         S              2  0
     D  WN0013         S              4
     D  WN0014         S              2
     D  WN0015         S              2
     D  WN0016         S              2  0
     D  WN0017         S              2
     D  WN0018         S              7
     D  YL0008         S             26
     D  YN0001         S             30
     D  YN0002         S             30
     D  YN0003         S              2
     D  YN0004         S              9  4
     D  YN0005         S              1
     D  YN0006         S              2
     D  YN0007         S              9  4
     D  YN0008         S              1
     D  YN0009         S              2
     D  YN0010         S              2
     D  YN0011         S             11  2
     D  YN0012         S              1
     D  YL0009         S              3  0
     D  YL0010         S              3  0
     D  YL0011         S              3  0
     D  YN0013         S              3
     D  YN0014         S              1
     D  YN0015         S              2
     D  YN0016         S              1
     D  YN0017         S              1
     D  YN0018         S              1
     D  YN0019         S              1
     D  YL0012         S              2
     D  Y0CX01         S              1
     D  YL0013         S              5  0
     D  WQSC01         S                   LIKE(WCAIC3)
     D  WQSC02         S                   LIKE(WCHGCD)
     D  WQSC03         S                   LIKE(WCAJCD)
     D  WQSC04         S                   LIKE(WCNDSC)
     D  WQSC05         S                   LIKE(WCNOSC)
     D  WQSC06         S                   LIKE(WCNPSC)
     D  WQSC07         S                   LIKE(WCA9DT)
     D  WN0019         S             26
     D  WN0020         S             50
     D  WN0021         S             15
     D  ##TMS          S             26
     D  ZADFMF         S             10
     D  YL0014         S             11  2
     D  YL0015         S             11  2
     D  YL0016         S             10
     D  WN0022         S             26
     D  WN0023         S             50
     D  WN0024         S             15
     D  WN0025         S             50
     D  WN0026         S             15
     D  WN0027         S             26
     D  WN0028         S             50
     D  WN0029         S             15
     D  WN0030         S             26
     D  WN0031         S             50
     D  WN0032         S             15
     D  YARDC          S              1
     D  YL0017         S             11  2
     D  YL0018         S             11  2
     D  WQSH01         S                   LIKE(WEAIC3)
     D  WQSH02         S                   LIKE(WEHGCD)
     D  WQSH03         S                   LIKE(WEAJCD)
     D  WQSH04         S                   LIKE(WENDSC)
     D  WN0033         S             26
     D  WN0034         S             50
     D  WN0035         S             15
     D  WN0036         S             26
     D  WN0037         S             50
     D  WN0038         S             15
     D  YBRDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  YRSW00         S              5  0
     D  YRSW01         S              5  0
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: WIM Item Trans Detail
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Item Code
     D  P1HGCD                 3      6P 0
      * I :  Warehouse Code
     D  P1AJCD                 7      9
      * I :  WIM Inventory Trans ID
     D  P1NOSC                10     12
      * I :  WIM Inventory Trans Type
     D  P1NPSC                13     15
      * I :  Transaction Date
     D  P1A9DT                16     19P 0
      * I :  Production Date
     D  P1ELDT                20     23P 0
      * I :  Item Transaction Source
     D  P1F1ST                24     25
      * I :  Transaction Description
     D  P1VQNA                26     55
      * I :  Transaction Reason Code
     D  P1A1AB                56     58
      * I :  Order Number
     D  P1C4NB                59     62P 0
     D P2PARM          DS
      * I :  Shift Number
     D  P2XLCD                 1      1
     D P3PARM          DS
      * B :  Transaction Weight
     D  P3AHWG                 1      6P 2
     D P4PARM          DS
      * B :  Transaction Quantity
     D  P4A5QT                 1      6P 2
     D P5PARM          DS
      * I :  USR Unship Flag
     D  P5USST                 1      1
     D P6PARM          DS
      * B :  *API Return status
     D  P6ARS                  1      7
     D                 DS
     D  ZAMSDA                 1    132
     I@BYREA1
      * Item Default              Retrieval index
      * Renamed input format fields
     I              BYHGCD                      WAHGCD
     I              BYAVNA                      WAAVNA
     I              BYAWNA                      WAAWNA
     I              BYL7NA                      WAL7NA
     I              BYL8NA                      WAL8NA
     I              BYL6NA                      WAL6NA
     I              BYMFNA                      WAMFNA
     I              BYHHCD                      WAHHCD
     I              BYAWPC                      WAAWPC
     I              BYLXST                      WALXST
     I              BYLGCD                      WALGCD
     I              BYAXPC                      WAAXPC
     I              BYLYST                      WALYST
     I              BYLHCD                      WALHCD
     I              BYLICD                      WALICD
     I              BYAIWG                      WAAIWG
     I              BYHICD                      WAHICD
     I              BYRBCD                      WARBCD
     I              BYFZST                      WAFZST
     I              BYAVST                      WAAVST
     I              BYCZWG                      WACZWG
     I              BYC0WG                      WAC0WG
     I              BYURTN                      WAURTN
     I              BYACC8                      WAACC8
     I              BYRINB                      WARINB
     I              BYRHNB                      WARHNB
     I              BYRGNB                      WARGNB
     I              BYLNCD                      WALNCD
     I              BYTFNB                      WATFNB
     I              BYN0CD                      WAN0CD
     I              BYX4ST                      WAX4ST
     I              BYCHTM                      WACHTM
     I              BYQZCD                      WAQZCD
     I              BYXWST                      WAXWST
     I              BYXXST                      WAXXST
     I              BYVMST                      WAVMST
     I              BYSWGH                      WASWGH
     I              BYPPHE                      WAPPHE
     I              BYLRCD                      WALRCD
     I              BYSFNB                      WASFNB
     I              BYA3WG                      WAA3WG
     I              BYSJNB                      WASJNB
     I              BYLLCD                      WALLCD
     I              BYLMCD                      WALMCD
     I              BYP3ST                      WAP3ST
     I              BYSKNB                      WASKNB
     I              BYSLNB                      WASLNB
     I              BYSMNB                      WASMNB
     I              BYP4ST                      WAP4ST
     I              BYCFNB                      WACFNB
     I              BYCGNB                      WACGNB
     I              BYILNB                      WAILNB
     I              BYCHNB                      WACHNB
     I              BYCINB                      WACINB
     I              BYCJNB                      WACJNB
     I              BYCMNB                      WACMNB
     I              BYCNNB                      WACNNB
     I              BYCRNB                      WACRNB
     I              BYCSNB                      WACSNB
     I              BYCVNB                      WACVNB
     I              BYCWNB                      WACWNB
     I              BYCXNB                      WACXNB
     I              BYCZNB                      WACZNB
     I              BYC0NB                      WAC0NB
     I              BYN1CD                      WAN1CD
     I              BYB4NB                      WAB4NB
     I              BYX5ST                      WAX5ST
     I              BYX6ST                      WAX6ST
     I              BYX7ST                      WAX7ST
     I              BYTMVA                      WATMVA
     I              BYTNVA                      WATNVA
     I              BYBLPR                      WABLPR
     I              BYBMPR                      WABMPR
     I              BYU9ST                      WAU9ST
     I              BYCMCO                      WACMCO
     I              BYQ1CD                      WAQ1CD
     I              BYAIC3                      WAAIC3
     I              BYQ8CD                      WAQ8CD
     I              BYR3CD                      WAR3CD
     I              BYSDCD                      WASDCD
     I              BYICN1                      WAICN1
     I              BYSVCD                      WASVCD
     I              BYICN2                      WAICN2
     I              BYSWCD                      WASWCD
     I              BYV2NB                      WAV2NB
     I              BYSXCD                      WASXCD
     I              BYITCN                      WAITCN
     I              BYSYCD                      WASYCD
     I              BYITC5                      WAITC5
     I              BYSZCD                      WASZCD
     I              BYICN6                      WAICN6
     I              BYS0CD                      WAS0CD
     I              BYICN7                      WAICN7
     I              BYS1CD                      WAS1CD
     I              BYICN8                      WAICN8
     I              BYS2CD                      WAS2CD
     I              BYICN9                      WAICN9
     I              BYS3CD                      WAS3CD
     I              BYICN0                      WAICN0
     I              BYS4CD                      WAS4CD
     I              BYB5NB                      WAB5NB
     I              BYXRCD                      WAXRCD
     I              BYPCCT                      WAPCCT
     I              BYBDNB                      WABDNB
     I              BYBJNB                      WABJNB
     I              BYSUST                      WASUST
     I              BYSVST                      WASVST
     I              BYSYST                      WASYST
     I              BYSZST                      WASZST
     I              BYS1ST                      WAS1ST
     I              BYXTCD                      WAXTCD
     I              BYXUCD                      WAXUCD
     I              BYF5WG                      WAF5WG
     I              BYF6WG                      WAF6WG
     I              BYF7WG                      WAF7WG
     I              BYBLNB                      WABLNB
     I              BYBNNB                      WABNNB
     I              BYS2ST                      WAS2ST
     I              BYS4ST                      WAS4ST
     I              BYS5ST                      WAS5ST
     I              BYS6ST                      WAS6ST
     I              BYS8ST                      WAS8ST
     I              BYS9ST                      WAS9ST
     I              BYTCST                      WATCST
     I              BYTDST                      WATDST
     I              BYUVST                      WAUVST
     I              BYUWST                      WAUWST
     I              BYUXST                      WAUXST
     I              BYVSST                      WAVSST
     I              BYAHTM                      WAAHTM
     I              BYBEVN                      WABEVN
     I              BYBFVN                      WABFVN
     I              BYEKDT                      WAEKDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                      WBAIC3
     I              BZHGCD                      WBHGCD
     I              BZAVNA                      WBAVNA
     I              BZAWNA                      WBAWNA
     I              BZL7NA                      WBL7NA
     I              BZL8NA                      WBL8NA
     I              BZL6NA                      WBL6NA
     I              BZMFNA                      WBMFNA
     I              BZADCD                      WBADCD
     I              BZAWPC                      WBAWPC
     I              BZLXST                      WBLXST
     I              BZAECD                      WBAECD
     I              BZAXPC                      WBAXPC
     I              BZLYST                      WBLYST
     I              BZAFCD                      WBAFCD
     I              BZAICD                      WBAICD
     I              BZAIWG                      WBAIWG
     I              BZHICD                      WBHICD
     I              BZRBCD                      WBRBCD
     I              BZFZST                      WBFZST
     I              BZAVST                      WBAVST
     I              BZCZWG                      WBCZWG
     I              BZC0WG                      WBC0WG
     I              BZURTN                      WBURTN
     I              BZAJC8                      WBAJC8
     I              BZRINB                      WBRINB
     I              BZRHNB                      WBRHNB
     I              BZRGNB                      WBRGNB
     I              BZLNCD                      WBLNCD
     I              BZTFNB                      WBTFNB
     I              BZN0CD                      WBN0CD
     I              BZX4ST                      WBX4ST
     I              BZTMVA                      WBTMVA
     I              BZTNVA                      WBTNVA
     I              BZBLPR                      WBBLPR
     I              BZBMPR                      WBBMPR
     I              BZLRCD                      WBLRCD
     I              BZU9ST                      WBU9ST
     I              BZCMCO                      WBCMCO
     I              BZQ1CD                      WBQ1CD
     I              BZQ8CD                      WBQ8CD
     I              BZCHTM                      WBCHTM
     I              BZQZCD                      WBQZCD
     I              BZXWST                      WBXWST
     I              BZXXST                      WBXXST
     I              BZVMST                      WBVMST
     I              BZSWGH                      WBSWGH
     I              BZPPHE                      WBPPHE
     I              BZR3CD                      WBR3CD
     I              BZSDCD                      WBSDCD
     I              BZICN1                      WBICN1
     I              BZSVCD                      WBSVCD
     I              BZICN2                      WBICN2
     I              BZSWCD                      WBSWCD
     I              BZV2NB                      WBV2NB
     I              BZSXCD                      WBSXCD
     I              BZITCN                      WBITCN
     I              BZSYCD                      WBSYCD
     I              BZITC5                      WBITC5
     I              BZSZCD                      WBSZCD
     I              BZICN6                      WBICN6
     I              BZS0CD                      WBS0CD
     I              BZICN7                      WBICN7
     I              BZS1CD                      WBS1CD
     I              BZICN8                      WBICN8
     I              BZS2CD                      WBS2CD
     I              BZICN9                      WBICN9
     I              BZS3CD                      WBS3CD
     I              BZICN0                      WBICN0
     I              BZS4CD                      WBS4CD
     I              BZSFNB                      WBSFNB
     I              BZA3WG                      WBA3WG
     I              BZSJNB                      WBSJNB
     I              BZLLCD                      WBLLCD
     I              BZLMCD                      WBLMCD
     I              BZP3ST                      WBP3ST
     I              BZSKNB                      WBSKNB
     I              BZSLNB                      WBSLNB
     I              BZSMNB                      WBSMNB
     I              BZP4ST                      WBP4ST
     I              BZCFNB                      WBCFNB
     I              BZCGNB                      WBCGNB
     I              BZILNB                      WBILNB
     I              BZCHNB                      WBCHNB
     I              BZCINB                      WBCINB
     I              BZCJNB                      WBCJNB
     I              BZCMNB                      WBCMNB
     I              BZCNNB                      WBCNNB
     I              BZCRNB                      WBCRNB
     I              BZCSNB                      WBCSNB
     I              BZCVNB                      WBCVNB
     I              BZCWNB                      WBCWNB
     I              BZCXNB                      WBCXNB
     I              BZCZNB                      WBCZNB
     I              BZC0NB                      WBC0NB
     I              BZN1CD                      WBN1CD
     I              BZB4NB                      WBB4NB
     I              BZB5NB                      WBB5NB
     I              BZX5ST                      WBX5ST
     I              BZX6ST                      WBX6ST
     I              BZX7ST                      WBX7ST
     I              BZPCCT                      WBPCCT
     I              BZBDNB                      WBBDNB
     I              BZBJNB                      WBBJNB
     I              BZSUST                      WBSUST
     I              BZSVST                      WBSVST
     I              BZSYST                      WBSYST
     I              BZSZST                      WBSZST
     I              BZS1ST                      WBS1ST
     I              BZXRCD                      WBXRCD
     I              BZXTCD                      WBXTCD
     I              BZXUCD                      WBXUCD
     I              BZF5WG                      WBF5WG
     I              BZF6WG                      WBF6WG
     I              BZF7WG                      WBF7WG
     I              BZBLNB                      WBBLNB
     I              BZBNNB                      WBBNNB
     I              BZS2ST                      WBS2ST
     I              BZS4ST                      WBS4ST
     I              BZS5ST                      WBS5ST
     I              BZS6ST                      WBS6ST
     I              BZS8ST                      WBS8ST
     I              BZS9ST                      WBS9ST
     I              BZTCST                      WBTCST
     I              BZTDST                      WBTDST
     I              BZUVST                      WBUVST
     I              BZUWST                      WBUWST
     I              BZUXST                      WBUXST
     I              BZVSST                      WBVSST
     I              BZAATM                      WBAATM
     I              BZAYNA                      WBAYNA
     I              BZA0NA                      WBA0NA
     I              BZAXDT                      WBAXDT
      *
     I@CICPM1
      * WIM Item Trans Detail     ITD Sequence Nbr (D)
      * Renamed input format fields
     I              CIAIC3                      WCAIC3
     I              CIHGCD                      WCHGCD
     I              CIAJCD                      WCAJCD
     I              CINDSC                      WCNDSC
     I              CINOSC                      WCNOSC
     I              CINPSC                      WCNPSC
     I              CIA9DT                      WCA9DT
     I              CIC4NY                      WCC4NY
     I              CIELDT                      WCELDT
     I              CIBKTS                      WCBKTS
     I              CIBLTS                      WCBLTS
     I              CIAZAB                      WCAZAB
     I              CIF1ST                      WCF1ST
     I              CIVQNA                      WCVQNA
     I              CIA5QT                      WCA5QT
     I              CIAHWG                      WCAHWG
     I              CIA0AB                      WCA0AB
     I              CIA1AB                      WCA1AB
     I              CIXLCD                      WCXLCD
     I              CIC4NB                      WCC4NB
     I              CIRINB                      WCRINB
     I              CIRHNB                      WCRHNB
     I              CIRGNB                      WCRGNB
     I              CIVSST                      WCVSST
     I              CIBGTS                      WCBGTS
     I              CIRUU1                      WCRUU1
     I              CIRVU1                      WCRVU1
      *
     I@CICPKD
      * WIM Item Trans Detail     Update index
      * Renamed input format fields
     I              CIAIC3                      WDAIC3
     I              CIHGCD                      WDHGCD
     I              CIAJCD                      WDAJCD
     I              CINDSC                      WDNDSC
     I              CINOSC                      WDNOSC
     I              CINPSC                      WDNPSC
     I              CIA9DT                      WDA9DT
     I              CIC4NY                      WDC4NY
     I              CIELDT                      WDELDT
     I              CIBKTS                      WDBKTS
     I              CIBLTS                      WDBLTS
     I              CIAZAB                      WDAZAB
     I              CIF1ST                      WDF1ST
     I              CIVQNA                      WDVQNA
     I              CIA5QT                      WDA5QT
     I              CIAHWG                      WDAHWG
     I              CIA0AB                      WDA0AB
     I              CIA1AB                      WDA1AB
     I              CIXLCD                      WDXLCD
     I              CIC4NB                      WDC4NB
     I              CIRINB                      WDRINB
     I              CIRHNB                      WDRHNB
     I              CIRGNB                      WDRGNB
     I              CIVSST                      WDVSST
     I              CIBGTS                      WDBGTS
     I              CIRUU1                      WDRUU1
     I              CIRVU1                      WDRVU1
      *
     I@CHCPKB
      * WIM Item Balance Detail   Retrieval index
      * Renamed input format fields
     I              CHAIC3                      WEAIC3
     I              CHHGCD                      WEHGCD
     I              CHAJCD                      WEAJCD
     I              CHNDSC                      WENDSC
     I              CHELDT                      WEELDT
     I              CHABWG                      WEABWG
     I              CHAGQT                      WEAGQT
     I              CHCTST                      WECTST
     I              CHQWWG                      WEQWWG
     I              CHTBQT                      WETBQT
     I              CHQXWG                      WEQXWG
     I              CHTCQT                      WETCQT
     I              CHQ0WG                      WEQ0WG
     I              CHTFQT                      WETFQT
     I              CHQ1WG                      WEQ1WG
     I              CHTGQT                      WETGQT
     I              CHBMWG                      WEBMWG
     I              CHDSQT                      WEDSQT
     I              CHDHDT                      WEDHDT
     I              CHBITS                      WEBITS
     I              CHBGD8                      WEBGD8
     I              CHRINB                      WERINB
     I              CHRHNB                      WERHNB
     I              CHRGNB                      WERGNB
     I              CHVSST                      WEVSST
     I              CHBGTS                      WEBGTS
     I              CHRUU1                      WERUU1
     I              CHRVU1                      WERVU1
     I              CHBHTS                      WEBHTS
     I              CHRWU1                      WERWU1
     I              CHRXU1                      WERXU1
      *
     I@CHCPKA
      * WIM Item Balance Detail   Update index
      * Renamed input format fields
     I              CHAIC3                      WFAIC3
     I              CHHGCD                      WFHGCD
     I              CHAJCD                      WFAJCD
     I              CHNDSC                      WFNDSC
     I              CHELDT                      WFELDT
     I              CHABWG                      WFABWG
     I              CHAGQT                      WFAGQT
     I              CHCTST                      WFCTST
     I              CHQWWG                      WFQWWG
     I              CHTBQT                      WFTBQT
     I              CHQXWG                      WFQXWG
     I              CHTCQT                      WFTCQT
     I              CHQ0WG                      WFQ0WG
     I              CHTFQT                      WFTFQT
     I              CHQ1WG                      WFQ1WG
     I              CHTGQT                      WFTGQT
     I              CHBMWG                      WFBMWG
     I              CHDSQT                      WFDSQT
     I              CHDHDT                      WFDHDT
     I              CHBITS                      WFBITS
     I              CHBGD8                      WFBGD8
     I              CHRINB                      WFRINB
     I              CHRHNB                      WFRHNB
     I              CHRGNB                      WFRGNB
     I              CHVSST                      WFVSST
     I              CHBGTS                      WFBGTS
     I              CHRUU1                      WFRUU1
     I              CHRVU1                      WFRVU1
     I              CHBHTS                      WFBHTS
     I              CHRWU1                      WFRWU1
     I              CHRXU1                      WFRXU1
      *
     I@CGCPJ8
      * WIM Item Balance          Retrieval index
      * Renamed input format fields
     I              CGAIC3                      WGAIC3
     I              CGHGCD                      WGHGCD
     I              CGAJCD                      WGAJCD
     I              CGNDSC                      WGNDSC
     I              CGBOWG                      WGBOWG
     I              CGDDQT                      WGDDQT
     I              CGQVWG                      WGQVWG
     I              CGS9QT                      WGS9QT
     I              CGTAQT                      WGTAQT
     I              CGQYWG                      WGQYWG
     I              CGTDQT                      WGTDQT
     I              CGQZWG                      WGQZWG
     I              CGTEQT                      WGTEQT
     I              CGRINB                      WGRINB
     I              CGRHNB                      WGRHNB
     I              CGRGNB                      WGRGNB
     I              CGVSST                      WGVSST
     I              CGBGTS                      WGBGTS
     I              CGRUU1                      WGRUU1
     I              CGRVU1                      WGRVU1
     I              CGBHTS                      WGBHTS
     I              CGRWU1                      WGRWU1
     I              CGRXU1                      WGRXU1
      *
     I@CGCPJ7
      * WIM Item Balance          Update index
      * Renamed input format fields
     I              CGAIC3                      WHAIC3
     I              CGHGCD                      WHHGCD
     I              CGAJCD                      WHAJCD
     I              CGNDSC                      WHNDSC
     I              CGBOWG                      WHBOWG
     I              CGDDQT                      WHDDQT
     I              CGQVWG                      WHQVWG
     I              CGS9QT                      WHS9QT
     I              CGTAQT                      WHTAQT
     I              CGQYWG                      WHQYWG
     I              CGTDQT                      WHTDQT
     I              CGQZWG                      WHQZWG
     I              CGTEQT                      WHTEQT
     I              CGRINB                      WHRINB
     I              CGRHNB                      WHRHNB
     I              CGRGNB                      WHRGNB
     I              CGVSST                      WHVSST
     I              CGBGTS                      WHBGTS
     I              CGRUU1                      WHRUU1
     I              CGRVU1                      WHRVU1
     I              CGBHTS                      WHBHTS
     I              CGRWU1                      WHRWU1
     I              CGRXU1                      WHRXU1
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1AIC3        PARM                    WP0001                         Company Number
     C     P1HGCD        PARM                    WP0002                         Item Code
     C     P1AJCD        PARM                    WP0003                         Warehouse Code
     C     P1NOSC        PARM                    WP0004                         WIM Inventory T
     C     P1NPSC        PARM                    WP0005                         WIM Inventory T
     C     P1A9DT        PARM                    WP0006                         Transaction Dat
     C     P1ELDT        PARM                    WP0007                         Production Date
     C     P1F1ST        PARM                    WP0008                         Item Transactio
     C     P1VQNA        PARM                    WP0009                         Transaction Des
     C     P1A1AB        PARM                    WP0010                         Transaction Rea
     C     P1C4NB        PARM                    WP0011                         Order Number
     C     P2XLCD        PARM                    WP0012                         Shift Number
     C     P3AHWG        PARM      P3AHWG        WP0013                         Transaction Wei
     C     P4A5QT        PARM      P4A5QT        WP0014                         Transaction Qua
     C     P5USST        PARM                    WP0015                         USR Unship Flag
     C     P6ARS         PARM      P6ARS         WP0016                         *API Return sta
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Upd WIM Bal Ord f/API  XF
      * NOTE: Processing for Regular Sales Order, Billing Activity = 1
      *       (Invoice)
      * Action Items: Missing 'Inventory Item Type' in TDD?
      *       Still need 'API Process Status' field to pass in!!!
      * Create WIM Item Trans Detail (PUCICPP).
      * CASE: *OTHERWISE
      * Format Dates.
      * CASE: *OTHERWISE
      * Transaction Date TS.
      * CASE: PAR.Transaction Date is Entered
      *
     C                   IF        P1A9DT <> 0
     C                   Z-ADD     *ZERO         WN0001                         Year Code
     C                   Z-ADD     *ZERO         WN0002                         Month
     C                   Z-ADD     *ZERO         WN0003                         Day of Month US
     C                   EVAL      WN0004 = ' '                                 Year Alpha (YYY
     C                   EVAL      WN0005 = ' '                                 Month (Char) US
     C                   EVAL      WN0006 = ' '                                 Day   (Char) US
     C                   Z-ADD     *ZERO         WN0007                         Year  NBR USR
     C                   EVAL      WN0008 = ' '                                 Year  (Char) US
     C                   EVAL      WN0009 = ' '                                 Date (Alpha) US
      *
      * CVT *CYMD toYYYY-MM-DD IF
     C                   EVAL      WN0009 = ' '                                 Date (Alpha) US
     C                   MOVEL     P1A9DT        WN0009                         Date (Alpha) US
      * ** YEAR **
     C                   Z-ADD     2             YRSW00
     C                   Z-ADD     2             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WN0009:ZQ     WN0008                 90      Year  (Char) US
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     *ZERO         ZQ
     C     '20'          CAT(P)    WN0008:ZQ     YL0002                         Year Alpha (YYY
     C                   Z-ADD     *ZERO         ZQ
     C     YL0002        CAT(P)    '-':ZQ        YL0003                         Text USR 5
      * ** MONTH **
     C                   Z-ADD     2             YRSW00
     C                   Z-ADD     4             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WN0009:ZQ     WN0005                 90      Month (Char) US
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     *ZERO         ZQ
     C     WN0005        CAT(P)    '-':ZQ        YL0004                         Text 3 Length U
      * ** DAY **
     C                   Z-ADD     2             YRSW00
     C                   Z-ADD     6             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WN0009:ZQ     WN0006                 90      Day   (Char) US
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     *ZERO         ZQ
     C     YL0004        CAT(P)    WN0006:ZQ     YL0005                         AS Date MM/DD
     C                   Z-ADD     *ZERO         ZQ
     C     YL0003        CAT(P)    YL0005:ZQ     YL0001                         Date Format
     C                   Z-ADD     *ZERO         ZQ
     C     YL0001        CAT(P)    @CN(001):ZQ   YL0006                         Date Timestamp
     C                   MOVEL     YL0006        YL0007                         Transaction Dt
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     *ZERO         YL0007                         Transaction Dt
     C                   MOVEL     @CN(002)      YL0007                         Transaction Dt
     C                   END                                                    *FI
      * Production Date TS.
      * CASE: PAR.Production Date is entered
      *
     C                   IF        P1ELDT <> 0
     C                   Z-ADD     *ZERO         WN0010                         Year Code
     C                   Z-ADD     *ZERO         WN0011                         Month
     C                   Z-ADD     *ZERO         WN0012                         Day of Month US
     C                   EVAL      WN0013 = ' '                                 Year Alpha (YYY
     C                   EVAL      WN0014 = ' '                                 Month (Char) US
     C                   EVAL      WN0015 = ' '                                 Day   (Char) US
     C                   Z-ADD     *ZERO         WN0016                         Year  NBR USR
     C                   EVAL      WN0017 = ' '                                 Year  (Char) US
     C                   EVAL      WN0018 = ' '                                 Date (Alpha) US
      *
      * CVT *CYMD toYYYY-MM-DD IF
     C                   EVAL      WN0018 = ' '                                 Date (Alpha) US
     C                   MOVEL     P1ELDT        WN0018                         Date (Alpha) US
      * ** YEAR **
     C                   Z-ADD     2             YRSW00
     C                   Z-ADD     2             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WN0018:ZQ     WN0017                 90      Year  (Char) US
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     *ZERO         ZQ
     C     '20'          CAT(P)    WN0017:ZQ     YL0002                         Year Alpha (YYY
     C                   Z-ADD     *ZERO         ZQ
     C     YL0002        CAT(P)    '-':ZQ        YL0003                         Text USR 5
      * ** MONTH **
     C                   Z-ADD     2             YRSW00
     C                   Z-ADD     4             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WN0018:ZQ     WN0014                 90      Month (Char) US
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     *ZERO         ZQ
     C     WN0014        CAT(P)    '-':ZQ        YL0004                         Text 3 Length U
      * ** DAY **
     C                   Z-ADD     2             YRSW00
     C                   Z-ADD     6             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WN0018:ZQ     WN0015                 90      Day   (Char) US
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     *ZERO         ZQ
     C     YL0004        CAT(P)    WN0015:ZQ     YL0005                         AS Date MM/DD
     C                   Z-ADD     *ZERO         ZQ
     C     YL0003        CAT(P)    YL0005:ZQ     YL0001                         Date Format
     C                   Z-ADD     *ZERO         ZQ
     C     YL0001        CAT(P)    @CN(001):ZQ   YL0006                         Date Timestamp
     C                   MOVEL     YL0006        YL0008                         Production Date
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     *ZERO         YL0008                         Production Date
     C                   MOVEL     @CN(002)      YL0008                         Production Date
     C                   END                                                    *FI
      * Get Item Info.
      * CASE: *OTHERWISE
      * Rtv Item Defaults      RT - Item Default  * 
     C                   EXSR      SARVGN
      * RTV U/M Primary        RT - Company Item  * 
     C                   EXSR      SBRVGN
      * If Unship=N & Inv Trns Type=Issue Types, Force Qty/Wgt to be Nega
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.USR Unship Flag is no
      *   |- c2    : PAR.WIM Inventory Trans ID is Issue
      *   |- c3    : PAR.WIM Inventory Trans Type is Issue Order Process
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        P5USST = 'N'
     C                   IF        P1NOSC = 'I'
     C                   IF        P1NPSC = 'IO'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Check Qty.
      * CASE: PAR.Transaction Quantity is Greater than zero
     C                   IF        Y0CX01 = '1'
      * Force negative.
     C                   IF        P4A5QT > 0
     C                   MULT      -1            P4A5QT                         Transaction Qua
     C                   END                                                    *FI
      * Check Wgt.
      * CASE: PAR.Transaction Weight is Greater than zero
      * Force negative.
     C                   IF        P3AHWG > 0
     C                   MULT      -1            P3AHWG                         Transaction Wei
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Get Next ITD Sequence #.
      * CASE: *OTHERWISE
     C                   Z-ADD     99999         YL0013                         ITD Sequence Nu
      * DN-Inventory Item Type is defaulted to 'FG' here! PIO will send i
      * Rtv Next ITD Seq Nbr  RT - WIM Item Trans Detail  * 
     C                   EXSR      SCRVGN
      * Crt WIM Item Trans Dtl CR - WIM Item Trans Detail  * 
     C                   EXSR      SDCRRC
      * Update WIM Item Balance Detail (PUCHCPP).
      * CASE: *OTHERWISE
      * DN-Inventory Item Type is defaulted to 'FG' here! PIO will send i
      * Upd WIM Item Bal Dtl  RT - WIM Item Balance Detail  * 
     C                   EXSR      SERVGN
      * Update WIM Item Balance (PUCGCPP).
      * CASE: *OTHERWISE
      * DN-Inventory Item Type is defaulted to 'FG' here! PIO will send i
      * Rtv Sum On Hand Wgt/QtyRT - WIM Item Balance Detail  * 
     C                   EXSR      SHRVGN
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
      * Upd On Hand Wgt/Qty   RT - WIM Item Balance  * 
     C                   IF        W0RTN = ' '
     C                   EXSR      SIRVGN
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv Item Defaults      RT - Item Default  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0009                         Item Structure
     C                   Z-ADD     *ZERO         YL0010                         Item Structure
     C                   Z-ADD     *ZERO         YL0011                         Item Structure
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WAHGCD                         Item Code
      * Setup key
     C                   Z-ADD     P1HGCD        WAHGCD                         Item Code
      * Establish starting position
     C     KRSSA         CHAIN     @BYREA1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1160'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WARINB        YL0009                         Item Structure
     C                   Z-ADD     WARHNB        YL0010                         Item Structure
     C                   Z-ADD     WARGNB        YL0011                         Item Structure
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * RTV U/M Primary        RT - Company Item  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBHGCD                         Item Code
      * Setup key
     C                   Z-ADD     P1AIC3        WBAIC3                         Company Number
     C                   Z-ADD     P1HGCD        WBHGCD                         Item Code
      * Establish starting position
     C     KRSSB         CHAIN     @BZREJU                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0326'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0012 = ' '                                 UOM Primary
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBADCD        YL0012                         UOM Primary
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Rtv Next ITD Seq Nbr  RT - WIM Item Trans Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KPSSC         KLIST
     C                   KFLD                    WQSC01                         Company Number
     C                   KFLD                    WQSC02                         Item Code
     C                   KFLD                    WQSC03                         Warehouse Code
     C                   KFLD                    WQSC04                         Inventory Item
     C                   KFLD                    WQSC05                         WIM Inventory T
     C                   KFLD                    WQSC06                         WIM Inventory T
     C                   KFLD                    WQSC07                         Transaction Dat
     C                   KFLD                    WCC4NY                         ITD Sequence Nu
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WQSC01                         Company Number
     C                   KFLD                    WQSC02                         Item Code
     C                   KFLD                    WQSC03                         Warehouse Code
     C                   KFLD                    WQSC04                         Inventory Item
     C                   KFLD                    WQSC05                         WIM Inventory T
     C                   KFLD                    WQSC06                         WIM Inventory T
     C                   KFLD                    WQSC07                         Transaction Dat
      * Setup key
     C                   Z-ADD     P1AIC3        WQSC01                         Company Number
     C                   Z-ADD     P1HGCD        WQSC02                         Item Code
     C                   MOVEL     P1AJCD        WQSC03                         Warehouse Code
     C                   MOVEL     'FG'          WQSC04                         Inventory Item
     C                   MOVEL     P1NOSC        WQSC05                         WIM Inventory T
     C                   MOVEL     P1NPSC        WQSC06                         WIM Inventory T
     C                   Z-ADD     P1A9DT        WQSC07                         Transaction Dat
     C                   Z-ADD     YL0013        WCC4NY                         ITD Sequence Nu
      * Establish starting position
     C     KPSSC         SETLL     @CICPM1                                      *
     C     KRSSC         READE     @CICPM1                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5255'     W0RTN
      * USER: Processing if Data record not found
     C                   Z-ADD     1             YL0013                         ITD Sequence Nu
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C     WCC4NY        ADD       1             YL0013                         ITD Sequence Nu
     C                   GOTO      SCEXIT                                       *QUIT
     C     KRSSC         READE     @CICPM1                                90    *
     C                   ENDDO
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDCRRC        BEGSR
      *================================================================
      * Crt WIM Item Trans Dtl CR - WIM Item Trans Detail  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0019                         Create Date Tim
     C                   EVAL      WN0020 = ' '                                 Create User ID
     C                   EVAL      WN0021 = ' '                                 Create Program
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @CICPKD
     C                   Z-ADD     P1AIC3        WDAIC3                         Company Number
     C                   Z-ADD     P1HGCD        WDHGCD                         Item Code
     C                   MOVEL     P1AJCD        WDAJCD                         Warehouse Code
     C                   MOVEL     'FG'          WDNDSC                         Inventory Item
     C                   MOVEL     P1NOSC        WDNOSC                         WIM Inventory T
     C                   MOVEL     P1NPSC        WDNPSC                         WIM Inventory T
     C                   Z-ADD     P1A9DT        WDA9DT                         Transaction Dat
     C                   Z-ADD     YL0013        WDC4NY                         ITD Sequence Nu
     C                   Z-ADD     P1ELDT        WDELDT                         Production Date
     C                   MOVEL     YL0008        WDBKTS                         Production Date
     C                   MOVEL     YL0007        WDBLTS                         Transaction Dt
     C                   MOVEL     YL0012        WDAZAB                         Transaction UOM
     C                   MOVEL     P1F1ST        WDF1ST                         Item Transactio
     C                   MOVEL     P1VQNA        WDVQNA                         Transaction Des
     C                   Z-ADD     P4A5QT        WDA5QT                         Transaction Qua
     C                   Z-ADD     P3AHWG        WDAHWG                         Transaction Wei
     C                   MOVEL     'LB'          WDA0AB                         Cost UOM
     C                   MOVEL     P1A1AB        WDA1AB                         Transaction Rea
     C                   MOVEL     P2XLCD        WDXLCD                         Shift Number
     C                   Z-ADD     P1C4NB        WDC4NB                         Order Number
     C                   Z-ADD     YL0009        WDRINB                         Item Structure
     C                   Z-ADD     YL0010        WDRHNB                         Item Structure
     C                   Z-ADD     YL0011        WDRGNB                         Item Structure
     C                   MOVEL     'A'           WDVSST                         Record Status
      *
      * USER: Processing before Data update
      * Set Crt Time Stamp DDL IF
      * *** Set CREATE Time Stamp Info.
      * PAR.Create Date Timestamp = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WDBGTS                         Create Date Tim
     C                   EVAL      WDRUU1 = ' '                                 Create User ID
     C                   MOVEL     ##USR         WDRUU1                         Create User ID
     C                   EVAL      WDRVU1 = ' '                                 Create Program
     C                   MOVEL     ##PGM         WDRVU1                         Create Program
     C     KLCRSD        KLIST
     C                   KFLD                    WDAIC3                         Company Number
     C                   KFLD                    WDHGCD                         Item Code
     C                   KFLD                    WDAJCD                         Warehouse Code
     C                   KFLD                    WDNDSC                         Inventory Item
     C                   KFLD                    WDNOSC                         WIM Inventory T
     C                   KFLD                    WDNPSC                         WIM Inventory T
     C                   KFLD                    WDA9DT                         Transaction Dat
     C                   KFLD                    WDC4NY                         ITD Sequence Nu
      * Check for duplicate primary key
     C     KLCRSD        SETLL     @CICPKD                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5256'     W0RTN
      * Send message 'WIM Item Trans Detail  EX'
     C                   MOVEL     'USR5256'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
     C                   WRITE     @CICPKD                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * Upd WIM Item Bal Dtl  RT - WIM Item Balance Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEHGCD                         Item Code
     C                   KFLD                    WEAJCD                         Warehouse Code
     C                   KFLD                    WENDSC                         Inventory Item
     C                   KFLD                    WEELDT                         Production Date
      * Setup key
     C                   Z-ADD     P1AIC3        WEAIC3                         Company Number
     C                   Z-ADD     P1HGCD        WEHGCD                         Item Code
     C                   MOVEL     P1AJCD        WEAJCD                         Warehouse Code
     C                   MOVEL     'FG'          WENDSC                         Inventory Item
     C                   Z-ADD     P1ELDT        WEELDT                         Production Date
      * Establish starting position
     C     KRSSE         CHAIN     @CHCPKB                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5251'     W0RTN
      * USER: Processing if Data record not found
      * Update On Hand Qty/Wgt?
      * CASE: PAR.Update On Hand Qty/Wgt U is Yes
     C                   IF        'N' = 'Y'
     C                   Z-ADD     P3AHWG        YL0014                         On Hand Weight
     C                   Z-ADD     P4A5QT        YL0015                         On Hand UOM1 Qu
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0014                         On Hand Weight
     C                   Z-ADD     *ZERO         YL0015                         On Hand UOM1 Qu
     C                   END                                                    *FI
      * LCL.Production Date YYYYMMDD = PAR.Production Date
     C     P1ELDT        ADD       1000000       XDINDT                         Production Date
     C                   EXSR      XCVT2
     C                   MOVEL     XDI2DT        YL0016
      * Crt WIM Item Bal Dtl  CR - WIM Item Balance Detail  * 
     C                   EXSR      SFCRRC
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C     WEQWWG        ADD       P3AHWG        YL0014                         On Hand Weight
     C     WETBQT        ADD       P4A5QT        YL0015                         On Hand UOM1 Qu
      * Chg WIM Item Bal Dtl  CH - WIM Item Balance Detail  * 
     C                   EXSR      SGCHRC
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFCRRC        BEGSR
      *================================================================
      * Crt WIM Item Bal Dtl  CR - WIM Item Balance Detail  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0022                         Create Date Tim
     C                   EVAL      WN0023 = ' '                                 Create User ID
     C                   EVAL      WN0024 = ' '                                 Create Program
     C                   EVAL      WN0025 = ' '                                 Update User Id
     C                   EVAL      WN0026 = ' '                                 Update Program
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @CHCPKA
     C                   Z-ADD     P1AIC3        WFAIC3                         Company Number
     C                   Z-ADD     P1HGCD        WFHGCD                         Item Code
     C                   MOVEL     P1AJCD        WFAJCD                         Warehouse Code
     C                   MOVEL     'FG'          WFNDSC                         Inventory Item
     C                   Z-ADD     P1ELDT        WFELDT                         Production Date
     C                   Z-ADD     *ZERO         WFABWG                         Physical Count
     C                   Z-ADD     *ZERO         WFAGQT                         Physical Count
     C                   EVAL      WFCTST = ' '                                 Physical Count
     C                   Z-ADD     YL0014        WFQWWG                         On Hand Weight
     C                   Z-ADD     YL0015        WFTBQT                         On Hand UOM1 Qu
     C                   Z-ADD     *ZERO         WFQXWG                         In Transit Weig
     C                   Z-ADD     *ZERO         WFTCQT                         In Transit UOM1
     C                   Z-ADD     *ZERO         WFQ0WG                         On Hold Weight
     C                   Z-ADD     *ZERO         WFTFQT                         On Hold UOM1 Qu
     C                   Z-ADD     *ZERO         WFQ1WG                         Available Weigh
     C                   Z-ADD     *ZERO         WFTGQT                         Available UOM1
     C                   Z-ADD     *ZERO         WFBMWG                         Physical Start
     C                   Z-ADD     *ZERO         WFDSQT                         Physical Start
     C                   Z-ADD     *ZERO         WFDHDT                         Physical Start
     C                   MOVEL     @CN(002)      WFBITS                         Physical Start
     C                   MOVEL     YL0016        WFBGD8                         Production Date
     C                   Z-ADD     YL0009        WFRINB                         Item Structure
     C                   Z-ADD     YL0010        WFRHNB                         Item Structure
     C                   Z-ADD     YL0011        WFRGNB                         Item Structure
     C                   MOVEL     'A'           WFVSST                         Record Status
     C                   MOVEL     @CN(002)      WFBHTS                         Update Date Tim
      *
      * USER: Processing before Data update
      * Set Crt Time Stamp DDL IF
      * *** Set CREATE Time Stamp Info.
      * PAR.Create Date Timestamp = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WFBGTS                         Create Date Tim
     C                   EVAL      WFRUU1 = ' '                                 Create User ID
     C                   MOVEL     ##USR         WFRUU1                         Create User ID
     C                   EVAL      WFRVU1 = ' '                                 Create Program
     C                   MOVEL     ##PGM         WFRVU1                         Create Program
      * *** Set CHANGE Time Stamp Info.
      * Cannot set Update Date TS here, will error.
     C                   EVAL      WFRWU1 = ' '                                 Update User Id
     C                   EVAL      WFRXU1 = ' '                                 Update Program
     C     KLCRSF        KLIST
     C                   KFLD                    WFAIC3                         Company Number
     C                   KFLD                    WFHGCD                         Item Code
     C                   KFLD                    WFAJCD                         Warehouse Code
     C                   KFLD                    WFNDSC                         Inventory Item
     C                   KFLD                    WFELDT                         Production Date
      * Check for duplicate primary key
     C     KLCRSF        SETLL     @CHCPKA                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5252'     W0RTN
      * Send message 'WIM Item Balance Detai EX'
     C                   MOVEL     'USR5252'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SFEXIT
     C                   ENDIF
      *
     C                   WRITE     @CHCPKA                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGCHRC        BEGSR
      *================================================================
      * Chg WIM Item Bal Dtl  CH - WIM Item Balance Detail  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0027                         Create Date Tim
     C                   EVAL      WN0028 = ' '                                 Create User ID
     C                   EVAL      WN0029 = ' '                                 Create Program
     C                   MOVEL     XDTSDL        WN0030                         Update Date Tim
     C                   EVAL      WN0031 = ' '                                 Update User Id
     C                   EVAL      WN0032 = ' '                                 Update Program
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @CHCPKA
     C                   Z-ADD     WEAIC3        WFAIC3                         Company Number
     C                   Z-ADD     WEHGCD        WFHGCD                         Item Code
     C                   MOVEL(P)  WEAJCD        WFAJCD                         Warehouse Code
     C                   MOVEL(P)  WENDSC        WFNDSC                         Inventory Item
     C                   Z-ADD     WEELDT        WFELDT                         Production Date
      *
     C     KLCHSG        KLIST
     C                   KFLD                    WFAIC3                         Company Number
     C                   KFLD                    WFHGCD                         Item Code
     C                   KFLD                    WFAJCD                         Warehouse Code
     C                   KFLD                    WFNDSC                         Inventory Item
     C                   KFLD                    WFELDT                         Production Date
     C     KLCHSG        CHAIN     @CHCPKA                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PUCHCPL0'    MDACP
     C                   MOVEL     '@CHCPKA'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SGEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SGEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPUCH1        YARDCS
      * Move non-key fields to @CHCPKA
     C                   Z-ADD     WEABWG        WFABWG                         Physical Count
     C                   Z-ADD     WEAGQT        WFAGQT                         Physical Count
     C                   MOVEL(P)  WECTST        WFCTST                         Physical Count
     C                   Z-ADD     YL0014        WFQWWG                         On Hand Weight
     C                   Z-ADD     YL0015        WFTBQT                         On Hand UOM1 Qu
     C                   Z-ADD     WEQXWG        WFQXWG                         In Transit Weig
     C                   Z-ADD     WETCQT        WFTCQT                         In Transit UOM1
     C                   Z-ADD     WEQ0WG        WFQ0WG                         On Hold Weight
     C                   Z-ADD     WETFQT        WFTFQT                         On Hold UOM1 Qu
     C                   Z-ADD     WEQ1WG        WFQ1WG                         Available Weigh
     C                   Z-ADD     WETGQT        WFTGQT                         Available UOM1
     C                   Z-ADD     WEBMWG        WFBMWG                         Physical Start
     C                   Z-ADD     WEDSQT        WFDSQT                         Physical Start
     C                   Z-ADD     WEDHDT        WFDHDT                         Physical Start
     C                   MOVEL(P)  WEBITS        WFBITS                         Physical Start
     C                   MOVEL(P)  WEBGD8        WFBGD8                         Production Date
     C                   Z-ADD     WERINB        WFRINB                         Item Structure
     C                   Z-ADD     WERHNB        WFRHNB                         Item Structure
     C                   Z-ADD     WERGNB        WFRGNB                         Item Structure
     C                   MOVEL(P)  WEVSST        WFVSST                         Record Status
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPUCH1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Chg Time Stamp DDL IF
      * *** Set CHANGE Time Stamp Info.
      * PAR.Update Date Timestamp = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WFBHTS                         Update Date Tim
     C                   EVAL      WFRWU1 = ' '                                 Update User Id
     C                   MOVEL     ##USR         WFRWU1                         Update User Id
     C                   EVAL      WFRXU1 = ' '                                 Update Program
     C                   MOVEL     ##PGM         WFRXU1                         Update Program
      * Set PGM.*Record Data Changed flag
     C                   IF        QPUCH1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @CHCPKA                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PUCHCPL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHRVGN        BEGSR
      *================================================================
      * Rtv Sum On Hand Wgt/QtyRT - WIM Item Balance Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0017                         On Hand Weight
     C                   Z-ADD     *ZERO         YL0018                         On Hand UOM1 Qu
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSH         KLIST
     C                   KFLD                    WQSH01                         Company Number
     C                   KFLD                    WQSH02                         Item Code
     C                   KFLD                    WQSH03                         Warehouse Code
     C                   KFLD                    WQSH04                         Inventory Item
      * Setup key
     C                   Z-ADD     P1AIC3        WQSH01                         Company Number
     C                   Z-ADD     P1HGCD        WQSH02                         Item Code
     C                   MOVEL     P1AJCD        WQSH03                         Warehouse Code
     C                   MOVEL     'FG'          WQSH04                         Inventory Item
      * Establish starting position
     C     KRSSH         SETLL     @CHCPKB                                      *
     C     KRSSH         READE     @CHCPKB                                90    *
      * Data record not found
     C   90              MOVEL     'USR5251'     W0RTN
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   ADD       WEQWWG        YL0017                         On Hand Weight
     C                   ADD       WETBQT        YL0018                         On Hand UOM1 Qu
     C     KRSSH         READE     @CHCPKB                                90    *
     C                   ENDDO
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   SIRVGN        BEGSR
      *================================================================
      * Upd On Hand Wgt/Qty   RT - WIM Item Balance  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSI         KLIST
     C                   KFLD                    WGAIC3                         Company Number
     C                   KFLD                    WGHGCD                         Item Code
     C                   KFLD                    WGAJCD                         Warehouse Code
     C                   KFLD                    WGNDSC                         Inventory Item
      * Setup key
     C                   Z-ADD     P1AIC3        WGAIC3                         Company Number
     C                   Z-ADD     P1HGCD        WGHGCD                         Item Code
     C                   MOVEL     P1AJCD        WGAJCD                         Warehouse Code
     C                   MOVEL     'FG'          WGNDSC                         Inventory Item
      * Establish starting position
     C     KRSSI         CHAIN     @CGCPJ8                            90        *
      * Data record not found
     C   90              MOVEL     'USR5249'     W0RTN
      * USER: Process Data record
      * Chg WIM Item Balance  CH - WIM Item Balance  * 
     C                   IF        NOT *IN90
     C                   EXSR      SJCHRC
     C                   ENDIF
      *================================================================
     CSR   SIEXIT        ENDSR
      /EJECT
     CSR   SJCHRC        BEGSR
      *================================================================
      * Chg WIM Item Balance  CH - WIM Item Balance  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0033                         Create Date Tim
     C                   EVAL      WN0034 = ' '                                 Create User ID
     C                   EVAL      WN0035 = ' '                                 Create Program
     C                   MOVEL     XDTSDL        WN0036                         Update Date Tim
     C                   EVAL      WN0037 = ' '                                 Update User Id
     C                   EVAL      WN0038 = ' '                                 Update Program
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @CGCPJ7
     C                   Z-ADD     WGAIC3        WHAIC3                         Company Number
     C                   Z-ADD     WGHGCD        WHHGCD                         Item Code
     C                   MOVEL(P)  WGAJCD        WHAJCD                         Warehouse Code
     C                   MOVEL(P)  WGNDSC        WHNDSC                         Inventory Item
      *
     C     KLCHSJ        KLIST
     C                   KFLD                    WHAIC3                         Company Number
     C                   KFLD                    WHHGCD                         Item Code
     C                   KFLD                    WHAJCD                         Warehouse Code
     C                   KFLD                    WHNDSC                         Inventory Item
     C     KLCHSJ        CHAIN     @CGCPJ7                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PUCGCPL0'    MDACP
     C                   MOVEL     '@CGCPJ7'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SJEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SJEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPUCG1        YBRDCS
      * Move non-key fields to @CGCPJ7
     C                   Z-ADD     YL0017        WHBOWG                         On Hand Weight
     C                   Z-ADD     YL0018        WHDDQT                         On Hand UOM1 Su
     C                   Z-ADD     WGQVWG        WHQVWG                         In Transit Weig
     C                   Z-ADD     WGS9QT        WHS9QT                         In Transit UOM1
     C                   Z-ADD     WGTAQT        WHTAQT                         Qty Available t
     C                   Z-ADD     WGQYWG        WHQYWG                         On Hold Weight
     C                   Z-ADD     WGTDQT        WHTDQT                         On Hold UOM1 Su
     C                   Z-ADD     WGQZWG        WHQZWG                         Available Weigh
     C                   Z-ADD     WGTEQT        WHTEQT                         Available UOM1
     C                   Z-ADD     WGRINB        WHRINB                         Item Structure
     C                   Z-ADD     WGRHNB        WHRHNB                         Item Structure
     C                   Z-ADD     WGRGNB        WHRGNB                         Item Structure
     C                   MOVEL(P)  WGVSST        WHVSST                         Record Status
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPUCG1 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Chg Time Stamp DDL IF
      * *** Set CHANGE Time Stamp Info.
      * PAR.Update Date Timestamp = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WHBHTS                         Update Date Tim
     C                   EVAL      WHRWU1 = ' '                                 Update User Id
     C                   MOVEL     ##USR         WHRWU1                         Update User Id
     C                   EVAL      WHRXU1 = ' '                                 Update Program
     C                   MOVEL     ##PGM         WHRXU1                         Update Program
      * Set PGM.*Record Data Changed flag
     C                   IF        QPUCG1 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @CGCPJ7                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PUCGCPL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SJEXIT        ENDSR
      /EJECT
     CSR   XCVT2         BEGSR
      *================================================================
      * Convert DTE to DT#
      *================================================================
     C                   MOVEL     '    -  -'    XDI2DT
     C                   IF        XDINDT = 1000000
     C                   Z-ADD     1             XDI2CY
     C                   Z-ADD     1             XDI2MM
     C                   Z-ADD     1             XDI2DD
     C                   ELSE
     C     XDINYY        ADD       1800          XDI2CY
     C                   Z-ADD     XDINMM        XDI2MM
     C                   Z-ADD     XDINDD        XDI2DD
     C                   END
      *================================================================
     CSR   XCVT2E        ENDSR
      /EJECT
     CSR   XSTMS         BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                   CALL      'Y2RTTSK'
     C                   PARM                    ##TMS                          System timestam
      *================================================================
     CSR   XSTMSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(002)      XDTSDL
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAHGCD                         Item Code
     C                   Z-ADD     *ZERO         WAAWPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WAAXPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WAAIWG                         Unit Weight
     C                   Z-ADD     *ZERO         WACZWG                         Minimum Weight
     C                   Z-ADD     *ZERO         WAC0WG                         Maximum Weight
     C                   Z-ADD     *ZERO         WAURTN                         Number Cases On
     C                   Z-ADD     *ZERO         WAACC8                         Vendor item Def
     C                   Z-ADD     *ZERO         WARINB                         Item Structure
     C                   Z-ADD     *ZERO         WARHNB                         Item Structure
     C                   Z-ADD     *ZERO         WARGNB                         Item Structure
     C                   Z-ADD     *ZERO         WATFNB                         Transportation
     C                   Z-ADD     *ZERO         WACHTM                         Fresh Chilling
     C                   Z-ADD     *ZERO         WASWGH                         Std Weight_Head
     C                   Z-ADD     *ZERO         WAPPHE                         Pieces Per Head
     C                   Z-ADD     *ZERO         WASFNB                         Pallet Tare Wei
     C                   Z-ADD     *ZERO         WAA3WG                         Misc Tare Weigh
     C                   Z-ADD     *ZERO         WASJNB                         Production Lead
     C                   Z-ADD     *ZERO         WASKNB                         Agrimetrics gro
     C                   Z-ADD     *ZERO         WASLNB                         Agrimetrics pac
     C                   Z-ADD     *ZERO         WASMNB                         Agrimetrics gra
     C                   Z-ADD     *ZERO         WACFNB                         PM Pounds per H
     C                   Z-ADD     *ZERO         WACGNB                         Item Frt Overag
     C                   Z-ADD     *ZERO         WAILNB                         Packages per ca
     C                   Z-ADD     *ZERO         WACHNB                         Use_Freeze_Sell
     C                   Z-ADD     *ZERO         WACINB                         PM Batch Size
     C                   Z-ADD     *ZERO         WACJNB                         Package Level s
     C                   Z-ADD     *ZERO         WACMNB                         Partial Item Co
     C                   Z-ADD     *ZERO         WACNNB                         WIP Item Code
     C                   Z-ADD     *ZERO         WACRNB                         WIP Reject Code
     C                   Z-ADD     *ZERO         WACSNB                         Std Costing Uni
     C                   Z-ADD     *ZERO         WACVNB                         FP Std Green We
     C                   Z-ADD     *ZERO         WACWNB                         PM Std LBS Man
     C                   Z-ADD     *ZERO         WACXNB                         PM Raw Meat LBS
     C                   Z-ADD     *ZERO         WACZNB                         PM Formula LBS
     C                   Z-ADD     *ZERO         WAC0NB                         PM Finished LBS
     C                   Z-ADD     *ZERO         WAB4NB                         PM Raw Material
     C                   Z-ADD     *ZERO         WATMVA                         Maximum Audit V
     C                   Z-ADD     *ZERO         WATNVA                         Minimum Audit V
     C                   Z-ADD     *ZERO         WABLPR                         Market Overage
     C                   Z-ADD     *ZERO         WABMPR                         Standard Overag
     C                   Z-ADD     *ZERO         WACMCO                         Item Pricing Co
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAICN1                         Item Category N
     C                   Z-ADD     *ZERO         WAICN2                         Item Category N
     C                   Z-ADD     *ZERO         WAV2NB                         Item Category N
     C                   Z-ADD     *ZERO         WAITCN                         Item Category N
     C                   Z-ADD     *ZERO         WAITC5                         Item Category N
     C                   Z-ADD     *ZERO         WAICN6                         Item Category N
     C                   Z-ADD     *ZERO         WAICN7                         Item Category N
     C                   Z-ADD     *ZERO         WAICN8                         Item Category N
     C                   Z-ADD     *ZERO         WAICN9                         Item Category N
     C                   Z-ADD     *ZERO         WAICN0                         Item Category N
     C                   Z-ADD     *ZERO         WAB5NB                         PM Line Number
     C                   Z-ADD     *ZERO         WABDNB                         Pieces Per Bag
     C                   Z-ADD     *ZERO         WABJNB                         Bags Per Unit
     C                   Z-ADD     *ZERO         WAF5WG                         Item Target Pri
     C                   Z-ADD     *ZERO         WAF6WG                         Minimum Piece W
     C                   Z-ADD     *ZERO         WAF7WG                         Maximum Piece W
     C                   Z-ADD     *ZERO         WABLNB                         Seaboard Equiva
     C                   Z-ADD     *ZERO         WABNNB                         Production Qty
     C                   Z-ADD     *ZERO         WAAHTM                         Job Time 1
     C                   Z-ADD     *ZERO         WAEKDT                         Job Date 1
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBHGCD                         Item Code
     C                   Z-ADD     *ZERO         WBAWPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WBAXPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WBAIWG                         Unit Weight
     C                   Z-ADD     *ZERO         WBCZWG                         Minimum Weight
     C                   Z-ADD     *ZERO         WBC0WG                         Maximum Weight
     C                   Z-ADD     *ZERO         WBURTN                         Number Cases On
     C                   Z-ADD     *ZERO         WBAJC8                         Vendor Item Def
     C                   Z-ADD     *ZERO         WBRINB                         Item Structure
     C                   Z-ADD     *ZERO         WBRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WBRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WBTFNB                         Transportation
     C                   Z-ADD     *ZERO         WBTMVA                         Maximum Audit V
     C                   Z-ADD     *ZERO         WBTNVA                         Minimum Audit V
     C                   Z-ADD     *ZERO         WBBLPR                         Market Overage
     C                   Z-ADD     *ZERO         WBBMPR                         Standard Overag
     C                   Z-ADD     *ZERO         WBCMCO                         Item Pricing Co
     C                   Z-ADD     *ZERO         WBCHTM                         Fresh Chilling
     C                   Z-ADD     *ZERO         WBSWGH                         Std Weight_Head
     C                   Z-ADD     *ZERO         WBPPHE                         Pieces Per Head
     C                   Z-ADD     *ZERO         WBICN1                         Item Category N
     C                   Z-ADD     *ZERO         WBICN2                         Item Category N
     C                   Z-ADD     *ZERO         WBV2NB                         Item Category N
     C                   Z-ADD     *ZERO         WBITCN                         Item Category N
     C                   Z-ADD     *ZERO         WBITC5                         Item Category N
     C                   Z-ADD     *ZERO         WBICN6                         Item Category N
     C                   Z-ADD     *ZERO         WBICN7                         Item Category N
     C                   Z-ADD     *ZERO         WBICN8                         Item Category N
     C                   Z-ADD     *ZERO         WBICN9                         Item Category N
     C                   Z-ADD     *ZERO         WBICN0                         Item Category N
     C                   Z-ADD     *ZERO         WBSFNB                         Pallet Tare Wei
     C                   Z-ADD     *ZERO         WBA3WG                         Misc Tare Weigh
     C                   Z-ADD     *ZERO         WBSJNB                         Production Lead
     C                   Z-ADD     *ZERO         WBSKNB                         Agrimetrics gro
     C                   Z-ADD     *ZERO         WBSLNB                         Agrimetrics pac
     C                   Z-ADD     *ZERO         WBSMNB                         Agrimetrics gra
     C                   Z-ADD     *ZERO         WBCFNB                         PM Pounds per H
     C                   Z-ADD     *ZERO         WBCGNB                         Item Frt Overag
     C                   Z-ADD     *ZERO         WBILNB                         Packages per ca
     C                   Z-ADD     *ZERO         WBCHNB                         Use_Freeze_Sell
     C                   Z-ADD     *ZERO         WBCINB                         PM Batch Size
     C                   Z-ADD     *ZERO         WBCJNB                         Package Level s
     C                   Z-ADD     *ZERO         WBCMNB                         Partial Item Co
     C                   Z-ADD     *ZERO         WBCNNB                         WIP Item Code
     C                   Z-ADD     *ZERO         WBCRNB                         WIP Reject Code
     C                   Z-ADD     *ZERO         WBCSNB                         Std Costing Uni
     C                   Z-ADD     *ZERO         WBCVNB                         FP Std Green We
     C                   Z-ADD     *ZERO         WBCWNB                         PM Std LBS Man
     C                   Z-ADD     *ZERO         WBCXNB                         PM Raw Meat LBS
     C                   Z-ADD     *ZERO         WBCZNB                         PM Formula LBS
     C                   Z-ADD     *ZERO         WBC0NB                         PM Finished LBS
     C                   Z-ADD     *ZERO         WBB4NB                         PM Raw Material
     C                   Z-ADD     *ZERO         WBB5NB                         PM Line Number
     C                   Z-ADD     *ZERO         WBBDNB                         Pieces Per Bag
     C                   Z-ADD     *ZERO         WBBJNB                         Bags Per Unit
     C                   Z-ADD     *ZERO         WBF5WG                         Item Target Pri
     C                   Z-ADD     *ZERO         WBF6WG                         Minimum Piece W
     C                   Z-ADD     *ZERO         WBF7WG                         Maximum Piece W
     C                   Z-ADD     *ZERO         WBBLNB                         Seaboard Equiva
     C                   Z-ADD     *ZERO         WBBNNB                         Production Qty
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCAIC3                         Company Number
     C                   Z-ADD     *ZERO         WCHGCD                         Item Code
     C                   Z-ADD     *ZERO         WCA9DT                         Transaction Dat
     C                   Z-ADD     *ZERO         WCC4NY                         ITD Sequence Nu
     C                   Z-ADD     *ZERO         WCELDT                         Production Date
     C                   MOVEL     XDTSDL        WCBKTS                         Production Date
     C                   MOVEL     XDTSDL        WCBLTS                         Transaction Dt
     C                   Z-ADD     *ZERO         WCA5QT                         Transaction Qua
     C                   Z-ADD     *ZERO         WCAHWG                         Transaction Wei
     C                   Z-ADD     *ZERO         WCC4NB                         Order Number
     C                   Z-ADD     *ZERO         WCRINB                         Item Structure
     C                   Z-ADD     *ZERO         WCRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WCRGNB                         Item Structure
     C                   MOVEL     XDTSDL        WCBGTS                         Create Date Tim
      * Clear all neither parameters
      * Crt WIM Item Trans Dtl CR - WIM Item Trans Detail  * 
     C                   MOVEL     XDTSDL        WDBGTS                         Create Date Tim
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEAIC3                         Company Number
     C                   Z-ADD     *ZERO         WEHGCD                         Item Code
     C                   Z-ADD     *ZERO         WEELDT                         Production Date
     C                   Z-ADD     *ZERO         WEABWG                         Physical Count
     C                   Z-ADD     *ZERO         WEAGQT                         Physical Count
     C                   Z-ADD     *ZERO         WEQWWG                         On Hand Weight
     C                   Z-ADD     *ZERO         WETBQT                         On Hand UOM1 Qu
     C                   Z-ADD     *ZERO         WEQXWG                         In Transit Weig
     C                   Z-ADD     *ZERO         WETCQT                         In Transit UOM1
     C                   Z-ADD     *ZERO         WEQ0WG                         On Hold Weight
     C                   Z-ADD     *ZERO         WETFQT                         On Hold UOM1 Qu
     C                   Z-ADD     *ZERO         WEQ1WG                         Available Weigh
     C                   Z-ADD     *ZERO         WETGQT                         Available UOM1
     C                   Z-ADD     *ZERO         WEBMWG                         Physical Start
     C                   Z-ADD     *ZERO         WEDSQT                         Physical Start
     C                   Z-ADD     *ZERO         WEDHDT                         Physical Start
     C                   MOVEL     XDTSDL        WEBITS                         Physical Start
     C                   MOVEL     @CN(003)      WEBGD8                         Production Date
     C                   Z-ADD     *ZERO         WERINB                         Item Structure
     C                   Z-ADD     *ZERO         WERHNB                         Item Structure
     C                   Z-ADD     *ZERO         WERGNB                         Item Structure
     C                   MOVEL     XDTSDL        WEBGTS                         Create Date Tim
     C                   MOVEL     XDTSDL        WEBHTS                         Update Date Tim
      * Clear all neither parameters
      * Crt WIM Item Bal Dtl  CR - WIM Item Balance Detail  * 
     C                   MOVEL     XDTSDL        WFBGTS                         Create Date Tim
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WGAIC3                         Company Number
     C                   Z-ADD     *ZERO         WGHGCD                         Item Code
     C                   Z-ADD     *ZERO         WGBOWG                         On Hand Weight
     C                   Z-ADD     *ZERO         WGDDQT                         On Hand UOM1 Su
     C                   Z-ADD     *ZERO         WGQVWG                         In Transit Weig
     C                   Z-ADD     *ZERO         WGS9QT                         In Transit UOM1
     C                   Z-ADD     *ZERO         WGTAQT                         Qty Available t
     C                   Z-ADD     *ZERO         WGQYWG                         On Hold Weight
     C                   Z-ADD     *ZERO         WGTDQT                         On Hold UOM1 Su
     C                   Z-ADD     *ZERO         WGQZWG                         Available Weigh
     C                   Z-ADD     *ZERO         WGTEQT                         Available UOM1
     C                   Z-ADD     *ZERO         WGRINB                         Item Structure
     C                   Z-ADD     *ZERO         WGRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WGRGNB                         Item Structure
     C                   MOVEL     XDTSDL        WGBGTS                         Create Date Tim
     C                   MOVEL     XDTSDL        WGBHTS                         Update Date Tim
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        YRSW00                         *Synon (5,0) wo
     C                   Z-ADD     *ZEROS        YRSW01                         *Synon (5,0) wo
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      * Define local work field Date Format
     C                   EVAL      YL0001 = ' '
      * Define local work field Year Alpha (YYYY) USR
     C                   EVAL      YL0002 = ' '
      * Define local work field Text USR 5
     C                   EVAL      YL0003 = ' '
      * Define local work field Text 3 Length USR
     C                   EVAL      YL0004 = ' '
      * Define local work field AS Date MM/DD
     C                   EVAL      YL0005 = ' '
      * Define local work field Date Timestamp Txt U
     C                   EVAL      YL0006 = ' '
      * Define local work field Transaction Dt Timestamp
     C                   MOVEL     XDTSDL        YL0007
      * Define local work field Production Date Timestamp
     C                   MOVEL     XDTSDL        YL0008
      * Define null work field Description Line One
     C                   EVAL      YN0001 = ' '
      * Define null work field Description Line Two
     C                   EVAL      YN0002 = ' '
      * Define null work field UOM Primary Dft
     C                   EVAL      YN0003 = ' '
      * Define null work field Conversion Factor 1
     C                   Z-ADD     *ZERO         YN0004
      * Define null work field Operation Factor 1
     C                   EVAL      YN0005 = ' '
      * Define null work field UOM Second Dft
     C                   EVAL      YN0006 = ' '
      * Define null work field Conversion Factor 2
     C                   Z-ADD     *ZERO         YN0007
      * Define null work field Operation Factor 2
     C                   EVAL      YN0008 = ' '
      * Define null work field UOM Third Dft
     C                   EVAL      YN0009 = ' '
      * Define null work field UOM Pricing Dft
     C                   EVAL      YN0010 = ' '
      * Define null work field Unit Weight
     C                   Z-ADD     *ZERO         YN0011
      * Define null work field Catch Weight Status
     C                   EVAL      YN0012 = ' '
      * Define local work field Item Structure Class Code
     C                   Z-ADD     *ZERO         YL0009
      * Define local work field Item Structure Group Code
     C                   Z-ADD     *ZERO         YL0010
      * Define local work field Item Structure Type Code
     C                   Z-ADD     *ZERO         YL0011
      * Define null work field Item Type Code
     C                   EVAL      YN0013 = ' '
      * Define null work field Package Type Code
     C                   EVAL      YN0014 = ' '
      * Define null work field Base_Conv_Loss Item
     C                   EVAL      YN0015 = ' '
      * Define null work field Variety_Rendered_Cut
     C                   EVAL      YN0016 = ' '
      * Define null work field Frozen Make to Order Sts
     C                   EVAL      YN0017 = ' '
      * Define null work field Credit Item Status
     C                   EVAL      YN0018 = ' '
      * Define null work field Seconds Item
     C                   EVAL      YN0019 = ' '
      * Define local work field UOM Primary
     C                   EVAL      YL0012 = ' '
      * Define local work field ITD Sequence Number
     C                   Z-ADD     *ZERO         YL0013
      * Define local work field On Hand Weight
     C                   Z-ADD     *ZERO         YL0014
      * Define local work field On Hand UOM1 Quantity
     C                   Z-ADD     *ZERO         YL0015
      * Define local work field Production Date YYYYMMDD
     C                   MOVEL     @CN(003)      YL0016
      * Define local work field On Hand Weight
     C                   Z-ADD     *ZERO         YL0017
      * Define local work field On Hand UOM1 Quantity
     C                   Z-ADD     *ZERO         YL0018
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 -00.00.00.000000
00002 0001-01-01-00.00.00.00000
00003 0001-01-01
