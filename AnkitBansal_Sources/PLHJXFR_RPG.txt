     H/TITLE ZZRtv Tattoo Hdr ExtInfXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:24:23
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     I@DNCPUY
      * Tattoo Header EXT         Retrieval index
      * Renamed input format fields
     I              DNHMNB                          WAHMNB
     I              DNBNNB                          WABNNB
     I              DNBONB                          WABONB
     I              DNCVNB                          WACVNB
     I              DNB0DT                          WAB0DT
     I              DNI5PR                          WAI5PR
     I              DNJBPR                          WAJBPR
     I              DNI6PR                          WAI6PR
     I              DNI7PR                          WAI7PR
     I              DNI8PR                          WAI8PR
     I              DNI9PR                          WAI9PR
     I              DNJAPR                          WAJAPR
     I              DNJCPR                          WAJCPR
     I              DNJDPR                          WAJDPR
     I              DNJEPR                          WAJEPR
     I              DNJFPR                          WAJFPR
     I              DNJGPR                          WAJGPR
     I              DNJHPR                          WAJHPR
     I              DNJIPR                          WAJIPR
     I              DNJJPR                          WAJJPR
     I              DNJKPR                          WAJKPR
     I              DNJLPR                          WAJLPR
     I              DNJMPR                          WAJMPR
     I              DNJNPR                          WAJNPR
     I              DNJOPR                          WAJOPR
     I              DNLTBF                          WALTBF
     I              DNHZPC                          WAHZPC
     I              DNLTHW                          WALTHW
     I              DNH0PC                          WAH0PC
     I              DNGTBF                          WAGTBF
     I              DNH1PC                          WAH1PC
     I              DNGTHW                          WAGTHW
     I              DNH2PC                          WAH2PC
     I              DNHLBF                          WAHLBF
     I              DNHLLE                          WAHLLE
     I              DNHLHW                          WAHLHW
     I              DNHLLP                          WAHLLP
     I              DNHGBF                          WAHGBF
     I              DNHGLE                          WAHGLE
     I              DNHGHW                          WAHGHW
     I              DNHFLP                          WAHFLP
     I              DNSNA1                          WASNA1
     I              DNSOA1                          WASOA1
     I              DNSPA1                          WASPA1
     I              DNDGSS                          WADGSS
     I              DNDHSS                          WADHSS
     I              DNDISS                          WADISS
     I              DNABCD                          WAABCD
     I              DNNYCD                          WANYCD
     I              DNOVCD                          WAOVCD
     I              DNAAVN                          WAAAVN
     I              DNAADT                          WAAADT
     I              DNAMTM                          WAAMTM
     I              DNAJST                          WAAJST
     I              DNAHVN                          WAAHVN
     I              DNAGVN                          WAAGVN
     I              DNABVN                          WAABVN
     I              DNABDT                          WAABDT
     I              DNABTM                          WAABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             16
      * KEY: Tattoo Header EXT         Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : RST BOL Load Number
     I                                    P   7   90P1BONB
      * I : RST TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : RST TH Kill Date
     I                                    P  13  160P1B0DT
     IP2PARM      DS
      * FLD: Tattoo Header
      * B : MAP TH CM Market Price
     I                                    P   1   32P2B8PR
      * B : MAP TH CM Base Mkt Price
     I                                    P   4   62P2AMPR
      * B : MAP TH CM Base Mkt Price Amt
     I                                    P   7  102P2ANPR
      * B : MAP TH CM Sort Discount Amt
     I                                    P  11  142P2AYVA
      * B : MAP TH CM Yield Gain/Loss Amt
     I                                    P  15  182P2AWVA
      * B : MAP TH CM Base Carcass Value
     I                                    P  19  222P2AOPR
      * B : MAP TH CM LN AddOn/Deduct Amt
     I                                    P  23  262P2AXVA
      * B : MAP TH CM Carcass Gross Amt
     I                                    P  27  302P2APPR
      * B : MAP TH CM Bse Mkt Live /CWT
     I                                    P  31  332P2D6PR
      * B : MAP TH CM Bse Mkt Carc /CWT
     I                                    P  34  362P2D7PR
      * B : MAP TH CM Srt Dsc Live /CWT
     I                                    P  37  392P2D8PR
      * B : MAP TH CM Srt Dsc Carc /CWT
     I                                    P  40  422P2D9PR
      * B : MAP TH CM Yld G/L Live /CWT
     I                                    P  43  452P2EAPR
      * B : MAP TH CM Yld G/L Carc /CWT
     I                                    P  46  482P2EBPR
      * B : MAP TH CM Crc Val Live /CWT
     I                                    P  49  512P2ECPR
      * B : MAP TH CM Crc Val Carc /CWT
     I                                    P  52  542P2EDPR
      * B : MAP TH CM Lean Prem Live /CWT
     I                                    P  55  572P2EEPR
      * B : MAP TH CM Lean Prem Carc /CWT
     I                                    P  58  602P2EFPR
      * B : MAP TH CM Gross Live /CWT
     I                                    P  61  632P2EGPR
      * B : MAP TH CM Gross Carc /CWT
     I                                    P  64  662P2EHPR
     IP3PARM      DS
      * B : MAP *Return code
     I                                        1   7 P3RTN
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Tattoo Hea
     C           P2B8PR    PARM P2B8PR    WP0001  52       TH CM Market Pr
     C           P2AMPR    PARM P2AMPR    WP0002  52       TH CM Base Mkt
     C           P2ANPR    PARM P2ANPR    WP0003  72       TH CM Base Mkt
     C           P2AYVA    PARM P2AYVA    WP0004  72       TH CM Sort Disc
     C           P2AWVA    PARM P2AWVA    WP0005  72       TH CM Yield Gai
     C           P2AOPR    PARM P2AOPR    WP0006  72       TH CM Base Carc
     C           P2AXVA    PARM P2AXVA    WP0007  72       TH CM LN AddOn/
     C           P2APPR    PARM P2APPR    WP0008  72       TH CM Carcass G
     C           P2D6PR    PARM P2D6PR    WP0009  52       TH CM Bse Mkt L
     C           P2D7PR    PARM P2D7PR    WP0010  52       TH CM Bse Mkt C
     C           P2D8PR    PARM P2D8PR    WP0011  52       TH CM Srt Dsc L
     C           P2D9PR    PARM P2D9PR    WP0012  52       TH CM Srt Dsc C
     C           P2EAPR    PARM P2EAPR    WP0013  52       TH CM Yld G/L L
     C           P2EBPR    PARM P2EBPR    WP0014  52       TH CM Yld G/L C
     C           P2ECPR    PARM P2ECPR    WP0015  52       TH CM Crc Val L
     C           P2EDPR    PARM P2EDPR    WP0016  52       TH CM Crc Val C
     C           P2EEPR    PARM P2EEPR    WP0017  52       TH CM Lean Prem
     C           P2EFPR    PARM P2EFPR    WP0018  52       TH CM Lean Prem
     C           P2EGPR    PARM P2EGPR    WP0019  52       TH CM Gross Liv
     C           P2EHPR    PARM P2EHPR    WP0020  52       TH CM Gross Car
     C           P3RTN     PARM P3RTN     WP0021  7        *Return code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * ZZRtv Tattoo Hdr ExtInfXF
      * MODIFICATIONS
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      * Rtv Tattoo Hdr Ext    RT - Tattoo Header EXT  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Tattoo Hdr Ext    RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WAHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WABONB           BOL Load Number
     C                     Z-ADDP1CVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KRSSA     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     Z-ADD*ZERO     P2B8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     P2AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     P2ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     P2AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     P2AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     P2AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     P2AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     P2APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     P2D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     P2D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     P2D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     P2D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     P2EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     P2EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     P2ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     P2EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     P2EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     P2EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     P2EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     P2EHPR           TH CM Gross Car
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWAI5PR    P2B8PR           TH CM Market Pr
     C                     Z-ADDWAJBPR    P2AMPR           TH CM Base Mkt
     C                     Z-ADDWAI6PR    P2ANPR           TH CM Base Mkt
     C                     Z-ADDWAI7PR    P2AYVA           TH CM Sort Disc
     C                     Z-ADDWAI8PR    P2AWVA           TH CM Yield Gai
     C                     Z-ADDWAI9PR    P2AOPR           TH CM Base Carc
     C                     Z-ADDWAJAPR    P2AXVA           TH CM LN AddOn/
     C                     Z-ADDWAJCPR    P2APPR           TH CM Carcass G
     C                     Z-ADDWAJDPR    P2D6PR           TH CM Bse Mkt L
     C                     Z-ADDWAJEPR    P2D7PR           TH CM Bse Mkt C
     C                     Z-ADDWAJFPR    P2D8PR           TH CM Srt Dsc L
     C                     Z-ADDWAJGPR    P2D9PR           TH CM Srt Dsc C
     C                     Z-ADDWAJHPR    P2EAPR           TH CM Yld G/L L
     C                     Z-ADDWAJIPR    P2EBPR           TH CM Yld G/L C
     C                     Z-ADDWAJJPR    P2ECPR           TH CM Crc Val L
     C                     Z-ADDWAJKPR    P2EDPR           TH CM Crc Val C
     C                     Z-ADDWAJLPR    P2EEPR           TH CM Lean Prem
     C                     Z-ADDWAJMPR    P2EFPR           TH CM Lean Prem
     C                     Z-ADDWAJNPR    P2EGPR           TH CM Gross Liv
     C                     Z-ADDWAJOPR    P2EHPR           TH CM Gross Car
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WAJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WAI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WAI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WAI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WAI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WAJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WAJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WAJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WAJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WAJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WAJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WAJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WAJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WAJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WAJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WAJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WAJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WAJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WAJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WALTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WAHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WALTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WAH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WAGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WAH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WAGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WAH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WAHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WAHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WAHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WAHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WAHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WAHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WAHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WAHFLP           TH Head GT Lean
     C                     Z-ADD*ZERO     WASNA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WASOA1           TE UnUsed Numbe
     C                     Z-ADD*ZERO     WASPA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
