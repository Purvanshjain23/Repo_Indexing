     H/TITLE WW Prdcr Purch Plan   ET  Edit transaction
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Maintain DBF header and associated DBF detail records
     H* - DBF header record fields appear on SFL control record
     H* - DBF detail records appear on SFL detail record
     H* - Program functions in two modes : *ADD and *CHANGE
     H* - Existing records may be updated or deleted
     H*   But key changes are not allowed
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Edit transaction
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 02/16/21  Time  : 14:58:09
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKAIETR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Prdcr Purch Plan   ET  Edit transaction
      *
     FPKAUCPL2IF  E           K        DISK
     F                                              KINFDS INFDS1
      * SPN : Purchase Plan Weekly Sum  SPN PrchPln/PrdcrPrchPln
      *
     FPKCFREL9IF  E           K        DISK
      * RSQ : Calendar Week             Week Start Date
      *
     FPKCFREL1IF  E           K        DISK
      * RTV : Calendar Week             Retrieval index
      *
     FPKAOCPL1IF  E           K        DISK
      * RTV : Kill/Cut Plan             Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKAWCPLBIF  E           K        DISK
      * RSQ : Buy Order Header          Co/Pdrc/Loc/Kill Dte
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKAUCPL1UF  E           K        DISK                      A
      * UPD : Purchase Plan Weekly Sum  Update index
      *
     FPKAVCPL0UF  E           K        DISK                      A
      * UPD : Producer Purchase Plan    Update index
      *
      * Screen: Field position and name array
     E                    W0BEG   7 052  5 0A
     E                    W0END   7 052  5 0A
     E                    W0NAM   7 052 10
     I@CFREIL
      * Calendar Week             Retrieval index
      * Renamed input format fields
     I              CFGANB                          WAGANB
     I              CFGBNB                          WAGBNB
     I              CFBGDT                          WABGDT
     I              CFBHDT                          WABHDT
     I              CFBIDT                          WABIDT
     I              CFBJDT                          WABJDT
     I              CFBKDT                          WABKDT
     I              CFBLDT                          WABLDT
     I              CFBMDT                          WABMDT
     I              CFBNDT                          WABNDT
     I              CFBODT                          WABODT
     I              CFAAVN                          WAAAVN
     I              CFAADT                          WAAADT
     I              CFAMTM                          WAAMTM
     I              CFAJST                          WAAJST
     I              CFAHVN                          WAAHVN
     I              CFAGVN                          WAAGVN
     I              CFABVN                          WAABVN
     I              CFABDT                          WAABDT
     I              CFABTM                          WAABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPKAUCPL1
      * UPD : Purchase Plan Weekly Sum  Update index
      * Current/previous header format fields
      * Current/previous master file format fields for change control
      *
      *
     I@2DBRC    E DSPKAVCPL0
      * UPD : Producer Purchase Plan    Update index
      * Current/previous detail format fields
      * Current/previous master file format fields for change control
      *
      *
      * Outward parameters
     IPARC        DS                              7
      * KEY : Purchase Plan Weekly Sum  Retrieval index
      * I : RST PPWS Company Number
     I                                    P   1   20PAHXNB
      * I : MAP CW Year
     I                                    P   3   50PAGANB
      * I : MAP CW Week Number
     I                                    P   6   70PAGBNB
      *
      * Outward parameters
     IPBRC        DS                              6
      * KEY : Producer                  Retrieval index
      * I : MAP PD Producer Code
     I                                        1   6 PBABCD
      *
      * Outward parameters
     IPCRC        DS                            237
      * RCD : Buy Order Load           Co/KillDte/DlvDte/DlvTme
      * I : RST BOH Company Number
     I                                    P   1   20PCHMNB
      * I : RST BOL Kill Date
     I                                    P  10  130PCCQDT
      *
      * Outward parameters
     IPDRC        DS                             25
      * KEY : Tattoo Header             Co/Prd/PDt(d)/Lc/Tto/Kld
      * I : RST BOH Company Number
     I                                    P   1   20PDHMNB
      * I : RST PD Producer Code
     I                                        3   8 PDABCD
      *
      * Outward parameters
     IPERC        DS                            219
      * RCD : Buy Order Header          Co/Pdrc/Loc/Kill Dte
      * I : RST BOH Company Number
     I                                    P   1   20PEHMNB
      * I : RST BOH Kill Date
     I                                    P  11  140PEASDT
      * I : MAP PPWS Company Number
     I                                    P 120 1210PEHXNB
      * I : MAP CW Year
     I                                    P 122 1240PEGANB
      * I : MAP CW Week Number
     I                                    P 125 1260PEGBNB
      * I : RST PD Producer Code
     I                                      127 132 PEABCD
      * I : RST PL Location Code
     I                                      133 138 PEAECD
      *
      * Outward parameters
     IPFRC        DS                             16
      * KEY : Producer Std Delv Sched   Retrieval index
      * I : RST PD Producer Code
     I                                        1   6 PFABCD
      * I : RST PL Location Code
     I                                        7  12 PFAECD
      *
     IYARDCS      DS                             73
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            122
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS                              7
      * KEY: Purchase Plan Weekly Sum  Retrieval index
      * I : RST PPWS Company Number
     I                                    P   1   20P1HXNB
      * I : RST CW Year
     I                                    P   3   50P1GANB
      * I : RST CW Week Number
     I                                    P   6   70P1GBNB
     IP2PARM      DS
      * FLD: Calendar Week
      * N : MAP CW Week Start Date
     I                                    P   1   40P2BGDT
      * N : MAP CW Week End Date
     I                                    P   5   80P2BHDT
      * N : MAP CW Mon Date
     I                                    P   9  120P2BIDT
      * N : MAP CW Tue Date
     I                                    P  13  160P2BJDT
      * N : MAP CW Wed Date
     I                                    P  17  200P2BKDT
      * N : MAP CW Thu Date
     I                                    P  21  240P2BLDT
      * N : MAP CW Fri Date
     I                                    P  25  280P2BMDT
      * N : MAP CW Sat Date
     I                                    P  29  320P2BNDT
      * N : MAP CW Sun Date
     I                                    P  33  360P2BODT
     IP3PARM      DS
      * FLD: *Arrays
      * I : MAP Oms Name
     I                                        1  30 P3EUTX
      * I : MAP Oms System Value Alpha
     I                                       31  70 P3EVTX
     IP4PARM      DS
      * N :  Buy Order Copy Sts USR
     I                                        1   4 P4LCST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Producer & Loc Required'
      * PD Producer Code
     I                                        1   6 ZA0001
      * PL Location Code
     I                                        7  12 ZA0002
      * *SFLSEL
     I                                       13  13 ZA0003
      * Message data for 'Producer & Loc Required'
      * PD Producer Code
     I                                        1   6 ZA0004
      * PL Location Code
     I                                        7  12 ZA0005
      * *SFLSEL
     I                                       13  13 ZA0006
      * Message data for 'Producer & Loc Required'
      * PD Producer Code
     I                                        1   6 ZA0007
      * PL Location Code
     I                                        7  12 ZA0008
      * *SFLSEL
     I                                       13  13 ZA0009
      * Message data for 'Producer & Loc Required'
      * PD Producer Code
     I                                        1   6 ZA0010
      * PL Location Code
     I                                        7  12 ZA0011
      * *SFLSEL
     I                                       13  13 ZA0012
      * Message data for 'Producer & Loc Required'
      * PD Producer Code
     I                                        1   6 ZA0013
      * PL Location Code
     I                                        7  12 ZA0014
      * *SFLSEL
     I                                       13  13 ZA0015
      * Message data for 'Producer & Loc Required'
      * PD Producer Code
     I                                        1   6 ZA0016
      * PL Location Code
     I                                        7  12 ZA0017
      * *SFLSEL
     I                                       13  13 ZA0018
      * Message data for 'Producer & Loc Required'
      * PD Producer Code
     I                                        1   6 ZA0019
      * PL Location Code
     I                                        7  12 ZA0020
      * *SFLSEL
     I                                       13  13 ZA0021
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Purchase P
     C           P3EUTX    PARM           WP0001 30        Oms Name
     C           P3EVTX    PARM           WP0002 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct program process
     C                     DO   *HIVAL                     DO
      * Initialize screen
     C                     EXSR ABIZSF
      * Set screen bypass indicator
     C           W0PMD     IFNE 'ADD'
     C                     MOVEL'Y'       W0BYP   1
     C                     ELSE
     C                     MOVEL'N'       W0BYP
     C                     END
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'                        DO
      * Convert fields to external form
     C                     EXSR MOCV#1
      * Bypass first screen for new transaction
     C           W0BYP     IFNE 'Y'
      * Display screen
     C                     EXSR CAEXFM
     C                     ELSE
      * Ensure all command keys set off
     C                     MOVE *ALL'0'   WKIN30 30
     C                     MOVEAWKIN30    *IN,1
     C                     END
      * Cancel screen bypass indicator
     C                     MOVEL'N'       W0BYP
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG           CAS
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            FACHMD
      * HOME: Request subfile reload
     C   30                CAS            ADHMKY
     C                     END                             SAC
     C           W0TRN     IFEQ 'Y'
      * Convert header fields to internal form
     C                     EXSR MPCV#1
      * Display next SFL page
     C   27                CAS            BAIZSF
      * Validate screen input
     C                     CAS            DAPRSF
     C                     END                             SAC
     C                     END                             FI
      *
     C                     END                             OD
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
     C                     END                             OD
      *****************************************************************
      /EJECT
     CSR         ABIZSF    BEGSR
      *================================================================
      * Initialize screen
      *================================================================
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  9
     C                     MOVE *ALL'1'   WKIND1  9
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     81    *
      * Initialise subfile control
     C                     EXSR MAIZ#1
      * Clear subfile
     C                     SETON                     80    *
     C                     WRITE#SFLCTL
     C                     SETOF                     80    *
      * Reset count of SFL records
     C                     Z-ADD*ZERO     ##RRMX  50
     C                     Z-ADD*ZERO     ##RR    50
      * If program mode is *ADD
     C           W0PMD     IFEQ 'ADD'
      * Initialise first page
     C                     EXSR BAIZSF
     C                     MOVEL'DTL'     W0SCR   3
     C                     ELSE
      * If program mode is *CHANGE
     C                     MOVEL'KEY'     W0SCR   3
     C                     END
      * Position subfile on page 1
     C                     Z-ADD1         ##SFRC
     C                     MOVEL'Y'       W0TRN   1
     C                     MOVEL'Y'       W0FST   1
      *================================================================
     CSR         ABEXIT    ENDSR
      /EJECT
     CSR         ADHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN   1
      *================================================================
     CSR         ADEXIT    ENDSR
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Fill remainder of subfile page with blank records
      *================================================================
      * Setof record error indicators
     C                     MOVEAWKIND0    *IN,31
      * Load subfile
     C                     Z-ADD##RRMX    ##RR    50
     C           1         DO   ##SFPG                     DO
     C                     ADD  1         ##RR
     C                     EXSR MDIZ#2
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           ##RR      DIV  ##SFPG    WK5N0   50
     C                     MVR            WK5N0          90*
     C  N90                END                             OD
      * Save highest SFL record number used
     C                     Z-ADD##RR      ##RRMX     81    *
     C           ##RRMX    SUB  ##SFPG    ##SFRC
     C                     ADD  1         ##SFRC
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN89     IFNE CAIN89
     C           *IN88     ORNE CAIN88
     C           *IN81     ORNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN89     CAIN89  1
     C                     MOVE *IN88     CAIN88  1
     C                     MOVE *IN81     CAIN81  1
     C                     MOVELW0SCR     W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END                              UOD
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSF    BEGSR
      *================================================================
      * Process subfile records
      *================================================================
      * Confirm/update is not deferred
     C           YPMTFD    IFEQ *BLANKS
     C                     MOVEL'N'       W0DCF   1
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MJIZ#2
     C                     END
      * Validate SFL control keys if input
     C           W0SCR     IFEQ 'KEY'
     C           W0PMD     OREQ 'ADD'
     C                     EXSR DCVLH1
      * QUIT if error:
     C   99                GOTO DAEXIT
     C                     END
      * If keys only, now get the rest of the data
     C           W0SCR     IFEQ 'KEY'
     C           YPMTFD    ANDEQ*BLANKS
     C           W0PMD     ANDNE'ADD'
     C                     EXSR DBLDSF
     C                     GOTO DAEXIT
     C                     END
      * Validate SFL control non keys
     C                     EXSR DEVLH2
      *................................................................
      * Process subfile records
     C           *IN81     IFEQ '1'
     C           1         DO   ##RRMX    ##RR
     C           ##RR      CHAIN#SFLRCD              92    *
      * Setof record error indicators
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98    No errors
      * Copy header keys to detail record for validation
     C                     Z-ADD#1HXNB    #2HXNB           PPWS Company Nu
     C                     Z-ADD#1GANB    #2GANB           CW Year
     C                     Z-ADD#1GBNB    #2GBNB           CW Week Number
      * Check for null record
     C                     EXSR DGNLRC
     C           W0NLR     IFEQ 'Y'
      * Null record - clear value mapped fields
     C                     EXSR MQIZ#2
     C                     END
      * Validate non-null subfile record
     C           W0NLR     IFEQ 'N'
     C           ##RR      OREQ YPMRRN
     C                     EXSR DIVLSF
     C                     END
      * If SFLRCD invalid, note that errors present
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     END                             OD
     C                     END                             FI
      *................................................................
      * Quit if subfile invalid:
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Calculate function fields
     C                     EXSR DKVLHV
      * Quit if header invalid:
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Update DBF from screen
     C                     EXSR EAUPFL
      * Quit if DBF updates failed:
     C           *IN99     CABEQ'1'       DAEXIT
      *
      * USER: Process command keys
      * CMD Key 14:  Display Weekly Summary
      * CASE: CTL.*CMD key is CF14
     C           *IN14     IFEQ '1'                        *IF
      * Rtv Week Nbr f/ a Dte RT - Calendar Week  * 
     C                     EXSR SARVGN
      * Dsp Weekly Summary    DF - Purchase Plan Weekly Sum  * 
     C                     CLEARPARC
     C                     Z-ADD#1HXNB    PAHXNB           PPWS Company Nu
     C                     Z-ADDWUGANB    PAGANB           CW Year
     C                     Z-ADDWUGBNB    PAGBNB           CW Week Number
      *
     C                     CALL 'PKAQDFR'              90  Dsp Weekly Summ
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Purchase P
     C                     PARM #PBGDT    WQ0001  70       CW Week Start D
     C                     PARM #PBHDT    WQ0002  70       CW Week End Dat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAQDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CMD Key 15:  Display Producers
      * CASE: CTL.*CMD key is CF15
     C           *IN15     IFEQ '1'                        *IF
      * Dsp Producers         DF - Producer  * 
     C                     CLEARPBRC
     C                     MOVELWUCRTX    PBABCD    P      PD Producer Cod
      *
     C                     CALL 'PKLMDFR'              90  Dsp Producers
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Producer
     C                     PARM P3EVTX    WQ0003 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLMDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'N'       W0TRN            *Continue trans
     C                     GOTO DAEXIT                     *QUIT
      * Exit after successful update
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBLDSF    BEGSR
      *================================================================
      * Load screen fields from DBF
      *================================================================
      * Load subfile control from DBF
     C                     EXSR MBFL#1
      * Validate SFL control non keys
     C                     EXSR DFVLH3
     C           YPMTFD    IFEQ *BLANKS
      * USER: Load existing header
      * Rtv Dates  1296       RT - Calendar Week  * 
     C                     EXSR SBRVGN
      * Rtv Plnd Kill/Hld Ovr RT - Kill Plan  * 
     C                     EXSR SCRVGN
     C                     END
      * Read all DBF detail records for header
      * Read ahead
     C           KSPNH     READE@AVCPBV                  92*
     C           *IN92     DOWEQ'0'
      * For each DBF detail record read:
     C                     ADD  1         ##RR    50
      * Setof record error indicators
     C                     MOVEAWKIND0    *IN,31
      * Initialise and load subfile record from DBF
     C                     EXSR MDIZ#2
     C                     EXSR MEFL#2
      * Validate details
     C                     EXSR DJVLSF
      * Output DBF to subfile
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
      * Read next Data record
     C           KSPNH     READE@AVCPBV                  92*
     C                     END                             WOD
     C                     Z-ADD##RR      ##RRMX     81    *
      * Fill to end of page with blank records
     C           ##RR      DIV  ##SFPG    WK5N0   50
     C                     MVR            WK5N0          90*
     C   90      ##RR      COMP *ZERO                9090  *
     C  N90                EXSR BAIZSF
      * Calculate function fields
     C                     EXSR DKVLHV
     C                     MOVEL'DTL'     W0SCR
      * Position subfile on page 1
     C                     Z-ADD1         ##SFRC
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCVLH1    BEGSR
      *================================================================
      * Validate header keys
      *================================================================
      * Check existence of header
     C           YPMTFD    IFEQ *BLANKS
     C                     EXSR DDRDH1
     C           W0PMD     IFNE 'ADD'
      * If header not found, error
     C           *IN90     IFEQ '1'
     C                     SETON                     99    PC
      * Send message 'Purchase Plan Weekly S NF'
     C                     MOVEL'PRK0045' ZAMSID
     C                     EXSR ZASNMS
     C                     END
     C                     ELSE
      * If header already exists, error
     C           *IN90     IFEQ '0'
     C                     SETON                     99    PC
      * Send message 'Purchase Plan Weekly S EX'
     C                     MOVEL'PRK0046' ZAMSID
     C                     EXSR ZASNMS
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DDRDH1    BEGSR
      *================================================================
      * Read header record
      *================================================================
     C           KSPNH     KLIST
     C                     KFLD           AUHXNB           PPWS Company Nu
     C                     KFLD           AUGANB           CW Year
     C                     KFLD           AUGBNB           CW Week Number
      * Setup key
     C                     Z-ADD#1HXNB    AUHXNB
     C                     Z-ADD#1GANB    AUGANB
     C                     Z-ADD#1GBNB    AUGBNB
     C           KSPNH     CHAIN@AUCPBU              90    *
      *================================================================
     CSR         DDEXIT    ENDSR
      /EJECT
     CSR         DEVLH2    BEGSR
      *================================================================
      * Validate header non-key fields
      *================================================================
      * Validate relations
     C                     EXSR DFVLH3
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFVLH3    BEGSR
      *================================================================
      * Validate header non-key relations
      *================================================================
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DGNLRC    BEGSR
      *================================================================
      * Check for null record
      *================================================================
     C                     MOVEL'N'       W0NLR   1
      * Existing records are never null
     C           #2OLRC    CABNE*BLANK    DGEXIT
     C           #2ABCD    CABNE*BLANK    DGEXIT           PD Producer Cod
     C           #2AECD    CABNE*BLANK    DGEXIT           PL Location Cod
     C           #RBCST    CABNE*BLANK    DGEXIT           Mon *SFLSEL USR
     C           #RBDST    CABNE*BLANK    DGEXIT           Tue *SFLSEL USR
     C           #RBEST    CABNE*BLANK    DGEXIT           Wed *SFLSEL USR
     C           #RBFST    CABNE*BLANK    DGEXIT           Thu *SFLSEL USR
     C           #RBGST    CABNE*BLANK    DGEXIT           Fri *SFLSEL USR
     C           #RBHST    CABNE*BLANK    DGEXIT           Sat *SFLSEL USR
     C           #RFKST    CABNE*BLANK    DGEXIT           Sun *SFLSEL USR
     C                     MOVEL'Y'       W0NLR
      *================================================================
     CSR         DGEXIT    ENDSR
      /EJECT
     CSR         DIVLSF    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
      * Validate Mon *SFLSEL USR
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#RBCST    W0NSRQ  1        Mon *SFLSEL USR
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#RBCST'  OREQ YPMTFD
     C           ##RR      ANDEQYPMRRN
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100509   Y2LSNO  70
     C           #RBCST    PARM #RBCST    W0EXVL 25        Mon *SFLSEL USR
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Tue *SFLSEL USR
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#RBDST    W0NSRQ  1        Tue *SFLSEL USR
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#RBDST'  OREQ YPMTFD
     C           ##RR      ANDEQYPMRRN
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100509   Y2LSNO  70
     C           #RBDST    PARM #RBDST    W0EXVL 25        Tue *SFLSEL USR
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Wed *SFLSEL USR
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#RBEST    W0NSRQ  1        Wed *SFLSEL USR
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#RBEST'  OREQ YPMTFD
     C           ##RR      ANDEQYPMRRN
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100509   Y2LSNO  70
     C           #RBEST    PARM #RBEST    W0EXVL 25        Wed *SFLSEL USR
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Thu *SFLSEL USR
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#RBFST    W0NSRQ  1        Thu *SFLSEL USR
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#RBFST'  OREQ YPMTFD
     C           ##RR      ANDEQYPMRRN
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100509   Y2LSNO  70
     C           #RBFST    PARM #RBFST    W0EXVL 25        Thu *SFLSEL USR
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Fri *SFLSEL USR
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#RBGST    W0NSRQ  1        Fri *SFLSEL USR
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#RBGST'  OREQ YPMTFD
     C           ##RR      ANDEQYPMRRN
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100509   Y2LSNO  70
     C           #RBGST    PARM #RBGST    W0EXVL 25        Fri *SFLSEL USR
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Sat *SFLSEL USR
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#RBHST    W0NSRQ  1        Sat *SFLSEL USR
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#RBHST'  OREQ YPMTFD
     C           ##RR      ANDEQYPMRRN
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100509   Y2LSNO  70
     C           #RBHST    PARM #RBHST    W0EXVL 25        Sat *SFLSEL USR
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Sun *SFLSEL USR
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#RFKST    W0NSRQ  1        Sun *SFLSEL USR
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#RFKST'  OREQ YPMTFD
     C           ##RR      ANDEQYPMRRN
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100509   Y2LSNO  70
     C           #RFKST    PARM #RFKST    W0EXVL 25        Sun *SFLSEL USR
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * Select Producer Location
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PGM.*Cursor field <IS> RCD.PD Producer Code
      *   |- c2    : PGM.*Cursor field <IS> RCD.PL Location Code
      *   '-
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#2ABCD'                   *IF
     C           W0CSRR    OREQ ##RR                       *
     C           W0CFL     ANDEQ'#2AECD'                   *OR
      * CASE: CTL.*CMD key is CF04
     C           *IN04     IFEQ '1'                        *IF
      * CASE: RCD.PD Producer Code is Blank
     C           #2ABCD    IFEQ *BLANK                     *IF
      * CASE: RCD.PL Location Code EQ WRK.Blank USR
     C           #2AECD    IFEQ WUCRTX                     *IF
      * SEL Producer Loc/PrPln SR - Producer Location  * 
     C                     CALL 'PKQGSRR'              90  SEL Producer Lo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HXNB    WQ0004  30       PPWS Company Nu
     C                     PARM #2GANB    WQ0005  40       CW Year
     C                     PARM #2GBNB    WQ0006  20       CW Week Number
     C           #2ABCD    PARM *BLANK    WQ0007  6        PD Producer Cod
     C           #2AECD    PARM *BLANK    WQ0008  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prompt Not Valid for this'
     C                     MOVEL'PRK0383' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prompt Not Valid for this'
     C                     MOVEL'PRK0383' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate relations
     C                     EXSR DJVLSF
      * PD Producer Code required
     C           #2ABCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9831  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * PL Location Code required
     C           #2AECD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9832  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DIEXIT    ENDSR
      /EJECT
     CSR         DJVLSF    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      * Check reference to Producer Location
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     983132*
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record relations
      * 5=Display Delivery Schedule
     C                     EXSR UASUBR                     5=Display Deliv
      * 7=Dsp Producer Location
     C                     EXSR UBSUBR                     7=Dsp Producer
      * 8=Work With Buy Orders
     C                     EXSR UCSUBR                     8=Work With Buy
      * 9=Edit Standard Delivery Schedule
     C                     EXSR UDSUBR                     9=Edit Standard
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile record function fields
     C                     ADD  #2A9NB    #CBVNB           Mon Head SUM
     C                     ADD  #2BBNB    #CBWNB           Tue Head SUM
     C                     ADD  #2BDNB    #CBXNB           Wed Head SUM
     C                     ADD  #2BFNB    #CBYNB           Thu Head SUM
     C                     ADD  #2BHNB    #CBZNB           Fri Head SUM
     C                     ADD  #2BJNB    #CB0NB           Sat Head SUM
     C                     ADD  #2BLNB    #CG6NB           Sun Head SUM
     C                     END
      *================================================================
     CSR         DJEXIT    ENDSR
      /EJECT
     CSR         DKVLHV    BEGSR
      *================================================================
      * Calculate function fields
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Header function fields
      * Add Hold Over Hogs
     C                     ADD  #CCKNB    #CBVNB           Mon Head SUM
     C                     ADD  #CCLNB    #CBWNB           Tue Head SUM
     C                     ADD  #CCMNB    #CBXNB           Wed Head SUM
     C                     ADD  #CCNNB    #CBYNB           Thu Head SUM
     C                     ADD  #CCONB    #CBZNB           Fri Head SUM
     C                     ADD  #CCPNB    #CB0NB           Sat Head SUM
     C                     ADD  #CG5NB    #CG6NB           Sun Head SUM
      * Add Mon total to week total
     C                     ADD  #CBVNB    #CB2NB           Week Head SUM
      * Add Tue total to week total
     C                     ADD  #CBWNB    #CB2NB           Week Head SUM
      * Add Wed total to week total
     C                     ADD  #CBXNB    #CB2NB           Week Head SUM
      * Add Thu total to week total
     C                     ADD  #CBYNB    #CB2NB           Week Head SUM
      * Add Fri total to week total
     C                     ADD  #CBZNB    #CB2NB           Week Head SUM
      * Add Sat total to week total
     C                     ADD  #CB0NB    #CB2NB           Week Head SUM
      * Add Sun total to week total
     C                     ADD  #CG6NB    #CB2NB           Week Head SUM
     C                     Z-ADD*ZERO     #CBUNB           Surplus/Shortag
      * Surplus/Shortage DRV
     C           #CB2NB    SUB  #CCJNB    #CBUNB           Surplus/Shortag
     C                     Z-ADD*ZERO     #CGZNB           Mon Surplus/Sho
      * Mon Surplus/Shortage DRV
     C           #CBVNB    SUB  #CGTNB    #CGZNB           Mon Surplus/Sho
     C                     Z-ADD*ZERO     #CG0NB           Tue Surplus/Sho
      * Tue Surplus/Shortage DRV
     C           #CBWNB    SUB  #CGUNB    #CG0NB           Tue Surplus/Sho
     C                     Z-ADD*ZERO     #CG1NB           Wed Surplus/Sho
      * Wed Surplus/Shortage DRV
     C           #CBXNB    SUB  #CGVNB    #CG1NB           Wed Surplus/Sho
     C                     Z-ADD*ZERO     #CG2NB           Thu Surplus/Sho
      * Thu Surplus/Shortage DRV
     C           #CBYNB    SUB  #CGWNB    #CG2NB           Thu Surplus/Sho
     C                     Z-ADD*ZERO     #CG3NB           Fri Surplus/Sho
      * Fri Surplus/Shortage DRV
     C           #CBZNB    SUB  #CGXNB    #CG3NB           Fri Surplus/Sho
     C                     Z-ADD*ZERO     #CG4NB           Sat Surplus/Sho
      * Sat Surplus/Shortage DRV
     C           #CB0NB    SUB  #CGYNB    #CG4NB           Sat Surplus/Sho
     C                     Z-ADD*ZERO     #CG8NB           Sun Surplus/Sho
      * Sun Surplus/Shortage DRV
     C           #CG6NB    SUB  #CG7NB    #CG8NB           Sun Surplus/Sho
     C                     END
      *================================================================
     CSR         DKEXIT    ENDSR
      /EJECT
     CSR         EAUPFL    BEGSR
      *================================================================
      * Update DBFs from screen
      *================================================================
      * Process header record
     C           #1OLRC    CASEQ*BLANK    EBADHD
      * Change header
     C                     CAS            ECCHHD
     C                     END
      * Quit if header update failed
     C   99                GOTO EA999
      * Process subfile records
     C           1         DO   ##RRMX    ##RR
     C           ##RR      CHAIN#SFLRCD              92    *
     C  N92                DO
      * Setof record error indicators
     C                     MOVEAWKIND0    *IN,31
      * Copy header keys to detail record for update
     C                     Z-ADD#1HXNB    #2HXNB           PPWS Company Nu
     C                     Z-ADD#1GANB    #2GANB           CW Year
     C                     Z-ADD#1GBNB    #2GBNB           CW Week Number
      * Process add line request
     C           #2OLRC    CASEQ*BLANK    EEADLN
      * Process change request
     C                     CAS            EFCHLN
     C                     END
      * USER: Process detail record
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     END                             OD
     C  N92                END                             OD
      *
     C           EA999     TAG
      * If errors during add, remove added records
     C           *IN99     IFEQ '1'
     C           W0PMD     ANDEQ'ADD'
     C                     EXSR ENRLBK
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBADHD    BEGSR
      *================================================================
      * Add header record
      *================================================================
      * USER: Create header DBF record
      * Crt Purchase Plan Wk  CR - Purchase Plan Weekly Sum  * 
     C                     EXSR SRCRRC
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    PC
     C                     ELSE
     C                     MOVEL@1DBRC    #1DBRC
     C                     MOVEL'Y'       #1OLRC
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECCHHD    BEGSR
      *================================================================
      * Change header record
      *================================================================
      * USER: Change header DBF record
      * Chg Purchase Plan Wk  CH - Purchase Plan Weekly Sum  * 
     C                     EXSR SSCHRC
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    PC
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EDDLHD    BEGSR
      *================================================================
      * Delete header record
      *================================================================
     C           #1OLRC    CABEQ*BLANK    EDEXIT
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    PC
     C                     ELSE
      * Signal record deleted
     C                     MOVEL*BLANK    #1OLRC
     C                     END
      *================================================================
     CSR         EDEXIT    ENDSR
      /EJECT
     CSR         EEADLN    BEGSR
      *================================================================
      * Add detail record
      *================================================================
      * Check for null record
     C                     EXSR DGNLRC
     C           W0NLR     CABEQ'Y'       EEEXIT
      * USER: Create detail DBF record
      * Crt Prdcr Purch Plan  CR - Producer Purchase Plan  * 
     C                     EXSR STCRRC
     C           W0RTN     IFNE *BLANK
      * Set on record error indicators
     C                     MOVEAWKIND1    *IN,31
     C                     SETON                         99*
     C                     ELSE
     C                     MOVEL@2DBRC    #2DBRC
     C                     MOVEL'Y'       #2OLRC
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         EFCHLN    BEGSR
      *================================================================
      * Change detail record
      *================================================================
      * USER: Change detail DBF record
      * Chg Prdcr Purch Plan  CH - Producer Purchase Plan  * 
     C                     EXSR SUCHRC
     C           W0RTN     IFNE *BLANK
      * Set on record error indicators
     C                     MOVEAWKIND1    *IN,31
     C                     SETON                         99*
     C                     END
      *================================================================
     CSR         EFEXIT    ENDSR
      /EJECT
     CSR         EGDLLN    BEGSR
      *================================================================
      * Delete detail record
      *================================================================
     C           #2OLRC    CABEQ*BLANK    EGEXIT
     C           W0RTN     IFNE *BLANK
      * Set on record error indicators
     C                     MOVEAWKIND1    *IN,31
     C                     SETON                         99*
     C                     ELSE
     C           W0RLB     IFEQ *BLANK
     C                     EXSR MDIZ#2
     C                     ELSE
     C                     MOVEL*BLANK    #2OLRC
     C                     END
     C                     END
      *================================================================
     CSR         EGEXIT    ENDSR
      /EJECT
     CSR         ENRLBK    BEGSR
      *================================================================
      * Remove added records
      *================================================================
      * Signal ROLLBACK mode
     C                     MOVEL'Y'       W0RLB   1
      * Delete header record
     C                     EXSR EDDLHD
      * Process subfile records
     C                     DO   ##RRMX    ##RR
     C           ##RR      CHAIN#SFLRCD              92    *
     C  N92                DO
      * Delete subfile record
     C                     EXSR EGDLLN
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     END                             OD
     C  N92                END                             OD
      * Clear ROLLBACK mode
     C                     MOVEL*BLANK    W0RLB
      *================================================================
     CSR         ENEXIT    ENDSR
      /EJECT
     CSR         FACHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
      * Change mode
     C                     MOVEL'CHG'     W0PMD
     C                     ELSE
      * Add mode
     C                     MOVEL'ADD'     W0PMD
     C                     END
      * Reset program for next entry
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
      * Protect detail key fields if existing record
     C           #2OLRC    COMP 'Y'                      82*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C           W0SCR     COMP 'KEY'                    88*
      * Protect header key fields in change mode, full screen
     C                     SETOF                     87    *
     C  N88N89             SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise header fields
      *================================================================
      * Existing record indicator
     C                     MOVEL*BLANK    #1OLRC
     C                     MOVELP3EVTX    #PEVTX           Oms System Valu
     C                     Z-ADDP2BGDT    #PBGDT           CW Week Start D
     C                     Z-ADDP2BHDT    #PBHDT           CW Week End Dat
     C                     Z-ADD*ZERO     #1A7NB           PPWS Plan Head
     C                     Z-ADD*ZERO     #1A6NB           PPWS Head Est
     C                     MOVEL*BLANK    #1A3ST           PPWS Sts
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADD*ZERO     #CCKNB           Mon Hold Over H
     C                     Z-ADD*ZERO     #CCLNB           tue Hold Over H
     C                     Z-ADD*ZERO     #CCMNB           wed Hold Over H
     C                     Z-ADD*ZERO     #CCNNB           thu Hold Over H
     C                     Z-ADD*ZERO     #CCONB           Fri Hold Over H
     C                     Z-ADD*ZERO     #CCPNB           sat Hold Over H
     C                     Z-ADD*ZERO     #CG5NB           Sun Head Held O
     C                     Z-ADDP1HXNB    #1HXNB           PPWS Company Nu
     C                     MOVELP3EUTX    #PEUTX           Oms Name
     C                     Z-ADDP1GANB    #1GANB           CW Year
     C                     Z-ADDP1GBNB    #1GBNB           CW Week Number
     C                     Z-ADD*ZERO     #CCJNB           Planned Kill US
     C                     Z-ADD*ZERO     #CB2NB           Week Head SUM
     C                     Z-ADD*ZERO     #CBUNB           Surplus/Shortag
     C                     Z-ADDP2BIDT    #PBIDT           CW Mon Date
      * Clear external version also
     C                     Z-ADD*ZERO     VPBIDT
     C                     Z-ADDP2BJDT    #PBJDT           CW Tue Date
      * Clear external version also
     C                     Z-ADD*ZERO     VPBJDT
     C                     Z-ADDP2BKDT    #PBKDT           CW Wed Date
      * Clear external version also
     C                     Z-ADD*ZERO     VPBKDT
     C                     Z-ADDP2BLDT    #PBLDT           CW Thu Date
      * Clear external version also
     C                     Z-ADD*ZERO     VPBLDT
     C                     Z-ADDP2BMDT    #PBMDT           CW Fri Date
      * Clear external version also
     C                     Z-ADD*ZERO     VPBMDT
     C                     Z-ADDP2BNDT    #PBNDT           CW Sat Date
      * Clear external version also
     C                     Z-ADD*ZERO     VPBNDT
     C                     Z-ADDP2BODT    #PBODT           CW Sun Date
      * Clear external version also
     C                     Z-ADD*ZERO     VPBODT
     C                     Z-ADD*ZERO     #CGZNB           Mon Surplus/Sho
     C                     Z-ADD*ZERO     #CG0NB           Tue Surplus/Sho
     C                     Z-ADD*ZERO     #CG1NB           Wed Surplus/Sho
     C                     Z-ADD*ZERO     #CG2NB           Thu Surplus/Sho
     C                     Z-ADD*ZERO     #CG3NB           Fri Surplus/Sho
     C                     Z-ADD*ZERO     #CG4NB           Sat Surplus/Sho
     C                     Z-ADD*ZERO     #CG8NB           Sun Surplus/Sho
     C                     Z-ADD*ZERO     #CGTNB           Mon Planned Kil
     C                     Z-ADD*ZERO     #CGUNB           Tue Planned Kil
     C                     Z-ADD*ZERO     #CGVNB           Wed Planned Kil
     C                     Z-ADD*ZERO     #CGWNB           Thu Planned Kil
     C                     Z-ADD*ZERO     #CGXNB           Fri Planned Kil
     C                     Z-ADD*ZERO     #CGYNB           Sat Planned Kil
     C                     Z-ADD*ZERO     #CG7NB           Sun Planned Kil
     C                     Z-ADD*ZERO     #CBVNB           Mon Head SUM
     C                     Z-ADD*ZERO     #CBWNB           Tue Head SUM
     C                     Z-ADD*ZERO     #CBXNB           Wed Head SUM
     C                     Z-ADD*ZERO     #CBYNB           Thu Head SUM
     C                     Z-ADD*ZERO     #CBZNB           Fri Head SUM
     C                     Z-ADD*ZERO     #CB0NB           Sat Head SUM
     C                     Z-ADD*ZERO     #CG6NB           Sun Head SUM
      * Check restriction within
     C                     EXSR VBCKRL
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move header DBF record fields to header screen
      *================================================================
      * Existing record indicator
     C                     MOVEL'Y'       #1OLRC
     C                     Z-ADDAUA7NB    #1A7NB           PPWS Plan Head
     C                     Z-ADDAUA6NB    #1A6NB           PPWS Head Est
     C                     MOVELAUA3ST    #1A3ST           PPWS Sts
     C                     MOVELAUAAVN    #1AAVN           RS User Changed
     C                     Z-ADDAUAADT    #1AADT           RS Date Changed
     C                     Z-ADDAUAMTM    #1AMTM           RS Time Changed
     C                     MOVELAUAJST    #1AJST           RS Record Statu
     C                     MOVELAUAHVN    #1AHVN           RS Job
     C                     MOVELAUAGVN    #1AGVN           RS Program
     C                     MOVELAUABVN    #1ABVN           RS User Added
     C                     Z-ADDAUABDT    #1ABDT           RS Date Added
     C                     Z-ADDAUABTM    #1ABTM           RS Time Added
     C                     Z-ADDAUHXNB    #1HXNB           PPWS Company Nu
     C                     Z-ADDAUGANB    #1GANB           CW Year
     C                     Z-ADDAUGBNB    #1GBNB           CW Week Number
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#2    BEGSR
      *================================================================
      * Initialise screen detail record
      *================================================================
      * Existing record indicator
     C                     MOVEL*BLANK    #2OLRC
     C                     Z-ADD#1HXNB    #2HXNB           PPWS Company Nu
     C                     Z-ADD#1GANB    #2GANB           CW Year
     C                     Z-ADD#1GBNB    #2GBNB           CW Week Number
     C                     Z-ADD*ZERO     #2A8NB           PPP Mon Head Es
     C                     Z-ADD*ZERO     #2BANB           PPP Tue Head Es
     C                     Z-ADD*ZERO     #2BCNB           PPP Wed Head Es
     C                     Z-ADD*ZERO     #2BENB           PPP Thu Head Es
     C                     Z-ADD*ZERO     #2BGNB           PPP Fri Head Es
     C                     Z-ADD*ZERO     #2BINB           PPP Sat Head Es
     C                     Z-ADD*ZERO     #2BKNB           PPP Sun Head Es
     C                     MOVEL*BLANK    #2AAVN           RS User Changed
     C                     Z-ADD*ZERO     #2AADT           RS Date Changed
     C                     Z-ADD*ZERO     #2AMTM           RS Time Changed
     C                     MOVEL*BLANK    #2AJST           RS Record Statu
     C                     MOVEL*BLANK    #2AHVN           RS Job
     C                     MOVEL*BLANK    #2AGVN           RS Program
     C                     MOVEL*BLANK    #2ABVN           RS User Added
     C                     Z-ADD*ZERO     #2ABDT           RS Date Added
     C                     Z-ADD*ZERO     #2ABTM           RS Time Added
     C                     MOVEL*BLANK    #2ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #2AECD           PL Location Cod
     C                     Z-ADD*ZERO     #2BMNB           PPP Week Head E
     C                     MOVEL*BLANK    #RBCST           Mon *SFLSEL USR
     C                     Z-ADD*ZERO     #2A9NB           PPP Mon Plan He
     C                     MOVEL*BLANK    #RBDST           Tue *SFLSEL USR
     C                     Z-ADD*ZERO     #2BBNB           PPP Tue Plan He
     C                     MOVEL*BLANK    #RBEST           Wed *SFLSEL USR
     C                     Z-ADD*ZERO     #2BDNB           PPP Wed Plan He
     C                     MOVEL*BLANK    #RBFST           Thu *SFLSEL USR
     C                     Z-ADD*ZERO     #2BFNB           PPP Thu Plan He
     C                     MOVEL*BLANK    #RBGST           Fri *SFLSEL USR
     C                     Z-ADD*ZERO     #2BHNB           PPP Fri Plan He
     C                     MOVEL*BLANK    #RBHST           Sat *SFLSEL USR
     C                     Z-ADD*ZERO     #2BJNB           PPP Sat Plan He
     C                     MOVEL*BLANK    #RFKST           Sun *SFLSEL USR
     C                     Z-ADD*ZERO     #2BLNB           PPP Sun Plan He
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MEFL#2    BEGSR
      *================================================================
      * Load screen detail record
      *================================================================
      * Existing record indicator
     C                     MOVEL'Y'       #2OLRC
     C                     Z-ADDAVHXNB    #2HXNB           PPWS Company Nu
     C                     Z-ADDAVGANB    #2GANB           CW Year
     C                     Z-ADDAVGBNB    #2GBNB           CW Week Number
     C                     Z-ADDAVA8NB    #2A8NB           PPP Mon Head Es
     C                     Z-ADDAVBANB    #2BANB           PPP Tue Head Es
     C                     Z-ADDAVBCNB    #2BCNB           PPP Wed Head Es
     C                     Z-ADDAVBENB    #2BENB           PPP Thu Head Es
     C                     Z-ADDAVBGNB    #2BGNB           PPP Fri Head Es
     C                     Z-ADDAVBINB    #2BINB           PPP Sat Head Es
     C                     Z-ADDAVBKNB    #2BKNB           PPP Sun Head Es
     C                     MOVELAVAAVN    #2AAVN           RS User Changed
     C                     Z-ADDAVAADT    #2AADT           RS Date Changed
     C                     Z-ADDAVAMTM    #2AMTM           RS Time Changed
     C                     MOVELAVAJST    #2AJST           RS Record Statu
     C                     MOVELAVAHVN    #2AHVN           RS Job
     C                     MOVELAVAGVN    #2AGVN           RS Program
     C                     MOVELAVABVN    #2ABVN           RS User Added
     C                     Z-ADDAVABDT    #2ABDT           RS Date Added
     C                     Z-ADDAVABTM    #2ABTM           RS Time Added
     C                     MOVELAVABCD    #2ABCD           PD Producer Cod
     C                     MOVELAVAECD    #2AECD           PL Location Cod
     C                     Z-ADDAVBMNB    #2BMNB           PPP Week Head E
     C                     Z-ADDAVA9NB    #2A9NB           PPP Mon Plan He
     C                     Z-ADDAVBBNB    #2BBNB           PPP Tue Plan He
     C                     Z-ADDAVBDNB    #2BDNB           PPP Wed Plan He
     C                     Z-ADDAVBFNB    #2BFNB           PPP Thu Plan He
     C                     Z-ADDAVBHNB    #2BHNB           PPP Fri Plan He
     C                     Z-ADDAVBJNB    #2BJNB           PPP Sat Plan He
     C                     Z-ADDAVBLNB    #2BLNB           PPP Sun Plan He
      * Update saved record image
     C                     MOVEL@2DBRC    #2DBRC
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MJIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     Z-ADD*ZERO     #CB2NB           Week Head SUM
     C                     Z-ADD*ZERO     #CBUNB           Surplus/Shortag
     C                     Z-ADD*ZERO     #CGZNB           Mon Surplus/Sho
     C                     Z-ADD*ZERO     #CG0NB           Tue Surplus/Sho
     C                     Z-ADD*ZERO     #CG1NB           Wed Surplus/Sho
     C                     Z-ADD*ZERO     #CG2NB           Thu Surplus/Sho
     C                     Z-ADD*ZERO     #CG3NB           Fri Surplus/Sho
     C                     Z-ADD*ZERO     #CG4NB           Sat Surplus/Sho
     C                     Z-ADD*ZERO     #CG8NB           Sun Surplus/Sho
     C                     Z-ADD*ZERO     #CBVNB           Mon Head SUM
     C                     Z-ADD*ZERO     #CBWNB           Tue Head SUM
     C                     Z-ADD*ZERO     #CBXNB           Wed Head SUM
     C                     Z-ADD*ZERO     #CBYNB           Thu Head SUM
     C                     Z-ADD*ZERO     #CBZNB           Fri Head SUM
     C                     Z-ADD*ZERO     #CB0NB           Sat Head SUM
     C                     Z-ADD*ZERO     #CG6NB           Sun Head SUM
      *================================================================
     CSR         MJEXIT    ENDSR
      /EJECT
     CSR         MOCV#1    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert CW Mon Date to display format
      * Convert date
     C           1000000   ADD  #PBIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPBIDT
      * Convert CW Tue Date to display format
      * Convert date
     C           1000000   ADD  #PBJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPBJDT
      * Convert CW Wed Date to display format
      * Convert date
     C           1000000   ADD  #PBKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPBKDT
      * Convert CW Thu Date to display format
      * Convert date
     C           1000000   ADD  #PBLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPBLDT
      * Convert CW Fri Date to display format
      * Convert date
     C           1000000   ADD  #PBMDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPBMDT
      * Convert CW Sat Date to display format
      * Convert date
     C           1000000   ADD  #PBNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPBNDT
      * Convert CW Sun Date to display format
      * Convert date
     C           1000000   ADD  #PBODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPBODT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         MPCV#1    BEGSR
      *================================================================
      * Convert control fields into internal form
      *================================================================
      * Quit if only keys available
     C           W0SCR     CABEQ'KEY'     MPEXIT
      *================================================================
     CSR         MPEXIT    ENDSR
      /EJECT
     CSR         MQIZ#2    BEGSR
      *================================================================
      * Clear value mapped fields
      *================================================================
      *================================================================
     CSR         MQEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Week Nbr f/ a Dte RT - Calendar Week  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           CFBGDT           CW Week Start D
      * Setup key
     C                     Z-ADD##JDT     CFBGDT           CW Week Start D
      * Establish starting position
     C           KPSSA     SETLL@CFREL6                    *
     C                     READ @CFREL6                  90*
      * Data record not found
     C   90                MOVEL'PRK0178' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDCFGANB    WUGANB           CW Year
     C                     Z-ADDCFGBNB    WUGBNB           CW Week Number
     C                     GOTO SAEXIT                     *QUIT
     C                     READ @CFREL6                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Dates  1296       RT - Calendar Week  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * C2206 Kill Plan Str Wk
      * 12/30/96   SLM     Establish number of Kill Plan for the
      *                    week was not accumulating correctly
      *                    if this the beginning year starts on
      *                    another day then Monday.
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WAGANB           CW Year
     C                     KFLD           WAGBNB           CW Week Number
      * Setup key
     C                     Z-ADD#1GANB    WAGANB           CW Year
     C                     Z-ADD#1GBNB    WAGBNB           CW Week Number
      * Establish starting position
     C           KRSSB     CHAIN@CFREIL              90    *
      * Data record not found
     C   90                MOVEL'PRK0178' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWABGDT    #PBGDT           CW Week Start D
     C                     Z-ADDWABHDT    #PBHDT           CW Week End Dat
     C                     Z-ADDWABIDT    #PBIDT           CW Mon Date
     C                     Z-ADDWABJDT    #PBJDT           CW Tue Date
     C                     Z-ADDWABKDT    #PBKDT           CW Wed Date
     C                     Z-ADDWABLDT    #PBLDT           CW Thu Date
     C                     Z-ADDWABMDT    #PBMDT           CW Fri Date
     C                     Z-ADDWABNDT    #PBNDT           CW Sat Date
     C                     Z-ADDWABODT    #PBODT           CW Sun Date
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Plnd Kill/Hld Ovr RT - Kill Plan  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Date To   USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * C2206 Kill Plan Str Wk
      * 12/30/96   SLM     Establish number of Kill Plan for the
      *                    week was not accumulating correctly
      *                    if this the beginning year starts on
      *                    another day then Monday.
     C                     Z-ADD0         #CCJNB           KP Planned Kill
     C                     Z-ADD0         #CCKNB           Mon Hold Over H
     C                     Z-ADD0         #CCLNB           tue Hold Over H
     C                     Z-ADD0         #CCMNB           wed Hold Over H
     C                     Z-ADD0         #CCNNB           thu Hold Over H
     C                     Z-ADD0         #CCONB           Fri Hold Over H
     C                     Z-ADD0         #CCPNB           sat Hold Over H
     C                     Z-ADD0         #CG5NB           Sun Head Held O
     C                     Z-ADD0         #CGTNB           Mon Planned Kil
     C                     Z-ADD0         #CGUNB           Tue Planned Kil
     C                     Z-ADD0         #CGVNB           Wed Planned Kil
     C                     Z-ADD0         #CGWNB           Thu Planned Kil
     C                     Z-ADD0         #CGXNB           Fri Planned Kil
     C                     Z-ADD0         #CGYNB           Sat Planned Kil
     C                     Z-ADD0         #CG7NB           Sun Planned Kil
      * Declare restrictor key work fields
     C           *LIKE     DEFN AOHTNB    WQSC01           KP Company Numb
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           KP Company Numb
     C                     KFLD           AOADDT           KP Kill/Cut Dat
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           KP Company Numb
      * Setup key
     C                     Z-ADD#1HXNB    WQSC01           KP Company Numb
     C                     Z-ADD#PBGDT    AOADDT           KP Kill/Cut Dat
      * Establish starting position
     C           KPSSC     SETLL@AOCPAO                    *
     C           KRSSC     READE@AOCPAO                  90*
      * Data record not found
     C   90                MOVEL'PRK0033' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.KP Kill Date LE PAR.CW Week End Date
     C           AOADDT    IFLE #PBHDT                     *IF
      * CASE: PAR.CW Mon Date EQ DB1.KP Kill Date
     C           #PBIDT    IFEQ AOADDT                     *IF
     C                     ADD  AOA0NB    #CCJNB           KP Planned Kill
     C                     ADD  AOCBNB    #CCKNB           Mon Hold Over H
     C                     ADD  AOA0NB    #CGTNB           Mon Planned Kil
     C                     ELSE
      * CASE: PAR.CW Tue Date EQ DB1.KP Kill Date
     C           #PBJDT    IFEQ AOADDT                     *IF
     C                     ADD  AOA0NB    #CCJNB           KP Planned Kill
     C                     ADD  AOCBNB    #CCLNB           tue Hold Over H
     C                     ADD  AOA0NB    #CGUNB           Tue Planned Kil
     C                     ELSE
      * CASE: PAR.CW Wed Date EQ DB1.KP Kill Date
     C           #PBKDT    IFEQ AOADDT                     *IF
     C                     ADD  AOA0NB    #CCJNB           KP Planned Kill
     C                     ADD  AOCBNB    #CCMNB           wed Hold Over H
     C                     ADD  AOA0NB    #CGVNB           Wed Planned Kil
     C                     ELSE
      * CASE: PAR.CW Thu Date EQ DB1.KP Kill Date
     C           #PBLDT    IFEQ AOADDT                     *IF
     C                     ADD  AOA0NB    #CCJNB           KP Planned Kill
     C                     ADD  AOCBNB    #CCNNB           thu Hold Over H
     C                     ADD  AOA0NB    #CGWNB           Thu Planned Kil
     C                     ELSE
      * CASE: PAR.CW Fri Date EQ DB1.KP Kill Date
     C           #PBMDT    IFEQ AOADDT                     *IF
     C                     ADD  AOA0NB    #CCJNB           KP Planned Kill
     C                     ADD  AOCBNB    #CCONB           Fri Hold Over H
     C                     ADD  AOA0NB    #CGXNB           Fri Planned Kil
     C                     ELSE
      * CASE: PAR.CW Sat Date EQ DB1.KP Kill Date
     C           #PBNDT    IFEQ AOADDT                     *IF
     C                     ADD  AOA0NB    #CCJNB           KP Planned Kill
     C                     ADD  AOCBNB    #CCPNB           sat Hold Over H
     C                     ADD  AOA0NB    #CGYNB           Sat Planned Kil
     C                     ELSE
      * CASE: PAR.CW Sun Date EQ DB1.KP Kill Date
     C           #PBODT    IFEQ AOADDT                     *IF
     C                     ADD  AOA0NB    #CCJNB           KP Planned Kill
     C                     ADD  AOCBNB    #CG5NB           Sun Head Held O
     C                     ADD  AOA0NB    #CG7NB           Sun Planned Kil
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@AOCPAO                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Head Planned      RT - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       Buy Order Head
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         #2A9NB           Head BO USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AWHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN AWABCD    WQSD02           PD Producer Cod
     C           *LIKE     DEFN AWAECD    WQSD03           PL Location Cod
     C           *LIKE     DEFN AWASDT    WQSD04           BOH Kill Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           PD Producer Cod
     C                     KFLD           WQSD03           PL Location Cod
     C                     KFLD           WQSD04           BOH Kill Date
      * Setup key
     C                     Z-ADD#1HXNB    WQSD01           BOH Company Num
     C                     MOVEL#2ABCD    WQSD02           PD Producer Cod
     C                     MOVEL#2AECD    WQSD03           PL Location Cod
     C                     Z-ADD#PBIDT    WQSD04           BOH Kill Date
      * Establish starting position
     C           KRSSD     SETLL@AWCPNB                    *
     C           KRSSD     READE@AWCPNB                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
     C                     EXSR SERVGN
     C                     ADD  WN0002    #2A9NB           Head BO USR
     C           KRSSD     READE@AWCPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WN0002           Buy Order Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN AXHMNB    WQSE01           BOH Company Num
     C           *LIKE     DEFN AXBNNB    WQSE02           BOH Buy Order N
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           BOH Buy Order N
      * Setup key
     C                     Z-ADDAWHMNB    WQSE01           BOH Company Num
     C                     Z-ADDAWBNNB    WQSE02           BOH Buy Order N
      * Establish starting position
     C           KRSSE     SETLL@AXCPBX                    *
     C           KRSSE     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  AXBPNB    WN0002           Buy Order Head
     C           KRSSE     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Head Planned      RT - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       Buy Order Head
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         #2BBNB           Head BO USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AWHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN AWABCD    WQSF02           PD Producer Cod
     C           *LIKE     DEFN AWAECD    WQSF03           PL Location Cod
     C           *LIKE     DEFN AWASDT    WQSF04           BOH Kill Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           PD Producer Cod
     C                     KFLD           WQSF03           PL Location Cod
     C                     KFLD           WQSF04           BOH Kill Date
      * Setup key
     C                     Z-ADD#1HXNB    WQSF01           BOH Company Num
     C                     MOVEL#2ABCD    WQSF02           PD Producer Cod
     C                     MOVEL#2AECD    WQSF03           PL Location Cod
     C                     Z-ADD#PBJDT    WQSF04           BOH Kill Date
      * Establish starting position
     C           KRSSF     SETLL@AWCPNB                    *
     C           KRSSF     READE@AWCPNB                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
     C                     EXSR SGRVGN
     C                     ADD  WN0003    #2BBNB           Head BO USR
     C           KRSSF     READE@AWCPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WN0003           Buy Order Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN AXHMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN AXBNNB    WQSG02           BOH Buy Order N
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           BOH Buy Order N
      * Setup key
     C                     Z-ADDAWHMNB    WQSG01           BOH Company Num
     C                     Z-ADDAWBNNB    WQSG02           BOH Buy Order N
      * Establish starting position
     C           KRSSG     SETLL@AXCPBX                    *
     C           KRSSG     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  AXBPNB    WN0003           Buy Order Head
     C           KRSSG     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Head Planned      RT - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  70       Buy Order Head
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         #2BDNB           Head BO USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AWHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN AWABCD    WQSH02           PD Producer Cod
     C           *LIKE     DEFN AWAECD    WQSH03           PL Location Cod
     C           *LIKE     DEFN AWASDT    WQSH04           BOH Kill Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           PD Producer Cod
     C                     KFLD           WQSH03           PL Location Cod
     C                     KFLD           WQSH04           BOH Kill Date
      * Setup key
     C                     Z-ADD#1HXNB    WQSH01           BOH Company Num
     C                     MOVEL#2ABCD    WQSH02           PD Producer Cod
     C                     MOVEL#2AECD    WQSH03           PL Location Cod
     C                     Z-ADD#PBKDT    WQSH04           BOH Kill Date
      * Establish starting position
     C           KRSSH     SETLL@AWCPNB                    *
     C           KRSSH     READE@AWCPNB                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
     C                     EXSR SIRVGN
     C                     ADD  WN0004    #2BDNB           Head BO USR
     C           KRSSH     READE@AWCPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WN0004           Buy Order Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN AXHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN AXBNNB    WQSI02           BOH Buy Order N
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
      * Setup key
     C                     Z-ADDAWHMNB    WQSI01           BOH Company Num
     C                     Z-ADDAWBNNB    WQSI02           BOH Buy Order N
      * Establish starting position
     C           KRSSI     SETLL@AXCPBX                    *
     C           KRSSI     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  AXBPNB    WN0004           Buy Order Head
     C           KRSSI     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Head Planned      RT - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  70       Buy Order Head
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         #2BFNB           Head BO USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AWHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN AWABCD    WQSJ02           PD Producer Cod
     C           *LIKE     DEFN AWAECD    WQSJ03           PL Location Cod
     C           *LIKE     DEFN AWASDT    WQSJ04           BOH Kill Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           PD Producer Cod
     C                     KFLD           WQSJ03           PL Location Cod
     C                     KFLD           WQSJ04           BOH Kill Date
      * Setup key
     C                     Z-ADD#1HXNB    WQSJ01           BOH Company Num
     C                     MOVEL#2ABCD    WQSJ02           PD Producer Cod
     C                     MOVEL#2AECD    WQSJ03           PL Location Cod
     C                     Z-ADD#PBLDT    WQSJ04           BOH Kill Date
      * Establish starting position
     C           KRSSJ     SETLL@AWCPNB                    *
     C           KRSSJ     READE@AWCPNB                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
     C                     EXSR SKRVGN
     C                     ADD  WN0005    #2BFNB           Head BO USR
     C           KRSSJ     READE@AWCPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WN0005           Buy Order Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN AXHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN AXBNNB    WQSK02           BOH Buy Order N
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           BOH Buy Order N
      * Setup key
     C                     Z-ADDAWHMNB    WQSK01           BOH Company Num
     C                     Z-ADDAWBNNB    WQSK02           BOH Buy Order N
      * Establish starting position
     C           KRSSK     SETLL@AXCPBX                    *
     C           KRSSK     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  AXBPNB    WN0005           Buy Order Head
     C           KRSSK     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Head Planned      RT - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0006  70       Buy Order Head
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         #2BHNB           Head BO USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AWHMNB    WQSL01           BOH Company Num
     C           *LIKE     DEFN AWABCD    WQSL02           PD Producer Cod
     C           *LIKE     DEFN AWAECD    WQSL03           PL Location Cod
     C           *LIKE     DEFN AWASDT    WQSL04           BOH Kill Date
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
     C                     KFLD           WQSL02           PD Producer Cod
     C                     KFLD           WQSL03           PL Location Cod
     C                     KFLD           WQSL04           BOH Kill Date
      * Setup key
     C                     Z-ADD#1HXNB    WQSL01           BOH Company Num
     C                     MOVEL#2ABCD    WQSL02           PD Producer Cod
     C                     MOVEL#2AECD    WQSL03           PL Location Cod
     C                     Z-ADD#PBMDT    WQSL04           BOH Kill Date
      * Establish starting position
     C           KRSSL     SETLL@AWCPNB                    *
     C           KRSSL     READE@AWCPNB                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
     C                     EXSR SMRVGN
     C                     ADD  WN0006    #2BHNB           Head BO USR
     C           KRSSL     READE@AWCPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WN0006           Buy Order Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN AXHMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN AXBNNB    WQSM02           BOH Buy Order N
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           BOH Buy Order N
      * Setup key
     C                     Z-ADDAWHMNB    WQSM01           BOH Company Num
     C                     Z-ADDAWBNNB    WQSM02           BOH Buy Order N
      * Establish starting position
     C           KRSSM     SETLL@AXCPBX                    *
     C           KRSSM     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  AXBPNB    WN0006           Buy Order Head
     C           KRSSM     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Head Planned      RT - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0007  70       Buy Order Head
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         #2BJNB           Head BO USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AWHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN AWABCD    WQSN02           PD Producer Cod
     C           *LIKE     DEFN AWAECD    WQSN03           PL Location Cod
     C           *LIKE     DEFN AWASDT    WQSN04           BOH Kill Date
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           PD Producer Cod
     C                     KFLD           WQSN03           PL Location Cod
     C                     KFLD           WQSN04           BOH Kill Date
      * Setup key
     C                     Z-ADD#1HXNB    WQSN01           BOH Company Num
     C                     MOVEL#2ABCD    WQSN02           PD Producer Cod
     C                     MOVEL#2AECD    WQSN03           PL Location Cod
     C                     Z-ADD#PBNDT    WQSN04           BOH Kill Date
      * Establish starting position
     C           KRSSN     SETLL@AWCPNB                    *
     C           KRSSN     READE@AWCPNB                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
     C                     EXSR SORVGN
     C                     ADD  WN0007    #2BJNB           Head BO USR
     C           KRSSN     READE@AWCPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WN0007           Buy Order Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN AXHMNB    WQSO01           BOH Company Num
     C           *LIKE     DEFN AXBNNB    WQSO02           BOH Buy Order N
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           BOH Company Num
     C                     KFLD           WQSO02           BOH Buy Order N
      * Setup key
     C                     Z-ADDAWHMNB    WQSO01           BOH Company Num
     C                     Z-ADDAWBNNB    WQSO02           BOH Buy Order N
      * Establish starting position
     C           KRSSO     SETLL@AXCPBX                    *
     C           KRSSO     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  AXBPNB    WN0007           Buy Order Head
     C           KRSSO     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Head Planned      RT - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008  70       Buy Order Head
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         #2BLNB           Head BO USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AWHMNB    WQSP01           BOH Company Num
     C           *LIKE     DEFN AWABCD    WQSP02           PD Producer Cod
     C           *LIKE     DEFN AWAECD    WQSP03           PL Location Cod
     C           *LIKE     DEFN AWASDT    WQSP04           BOH Kill Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
     C                     KFLD           WQSP02           PD Producer Cod
     C                     KFLD           WQSP03           PL Location Cod
     C                     KFLD           WQSP04           BOH Kill Date
      * Setup key
     C                     Z-ADD#1HXNB    WQSP01           BOH Company Num
     C                     MOVEL#2ABCD    WQSP02           PD Producer Cod
     C                     MOVEL#2AECD    WQSP03           PL Location Cod
     C                     Z-ADD#PBODT    WQSP04           BOH Kill Date
      * Establish starting position
     C           KRSSP     SETLL@AWCPNB                    *
     C           KRSSP     READE@AWCPNB                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
     C                     EXSR SQRVGN
     C                     ADD  WN0008    #2BLNB           Head BO USR
     C           KRSSP     READE@AWCPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Head Delv Plan    RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WN0008           Buy Order Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN AXHMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN AXBNNB    WQSQ02           BOH Buy Order N
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           BOH Buy Order N
      * Setup key
     C                     Z-ADDAWHMNB    WQSQ01           BOH Company Num
     C                     Z-ADDAWBNNB    WQSQ02           BOH Buy Order N
      * Establish starting position
     C           KRSSQ     SETLL@AXCPBX                    *
     C           KRSSQ     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  AXBPNB    WN0008           Buy Order Head
     C           KRSSQ     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Crt Purchase Plan Wk  CR - Purchase Plan Weekly Sum  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AUCPAV
     C                     Z-ADD#1HXNB    AUHXNB           PPWS Company Nu
     C                     Z-ADD#1GANB    AUGANB           CW Year
     C                     Z-ADD#1GBNB    AUGBNB           CW Week Number
     C                     Z-ADD#1A6NB    AUA6NB           PPWS Head Est
     C                     Z-ADD#CB2NB    AUA7NB           PPWS Plan Head
     C                     MOVEL#1A3ST    AUA3ST           PPWS Sts
     C                     MOVEL#1AAVN    AUAAVN           RS User Changed
     C                     Z-ADD#1AADT    AUAADT           RS Date Changed
     C                     Z-ADD#1AMTM    AUAMTM           RS Time Changed
     C                     MOVEL#1AJST    AUAJST           RS Record Statu
     C                     MOVEL#1AHVN    AUAHVN           RS Job
     C                     MOVEL#1AGVN    AUAGVN           RS Program
     C                     MOVEL#1ABVN    AUABVN           RS User Added
     C                     Z-ADD#1ABDT    AUABDT           RS Date Added
     C                     Z-ADD#1ABTM    AUABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       AUAJST           RS Record Statu
     C                     MOVEL##USR     AUABVN           RS User Added
     C                     Z-ADD##JDT     AUABDT           RS Date Added
     C                     Z-ADD##JTM     AUABTM           RS Time Added
     C                     MOVEL##PGM     AUAGVN           RS Program
     C                     MOVEL##JOB     AUAHVN           RS Job
     C           KLCRSR    KLIST
     C                     KFLD           AUHXNB           PPWS Company Nu
     C                     KFLD           AUGANB           CW Year
     C                     KFLD           AUGBNB           CW Week Number
      * Check for duplicate primary key
     C           KLCRSR    SETLL@AUCPAV                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0046' W0RTN   7
      * Send message 'Purchase Plan Weekly S EX'
     C                     MOVEL'PRK0046' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@AUCPAV                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Purchase Plan Wk  CH - Purchase Plan Weekly Sum  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AUCPAV
     C                     Z-ADD#1HXNB    AUHXNB           PPWS Company Nu
     C                     Z-ADD#1GANB    AUGANB           CW Year
     C                     Z-ADD#1GBNB    AUGBNB           CW Week Number
      *
     C           KLCHSS    KLIST
     C                     KFLD           AUHXNB           PPWS Company Nu
     C                     KFLD           AUGANB           CW Year
     C                     KFLD           AUGBNB           CW Week Number
     C           KLCHSS    CHAIN@AUCPAV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAUCPL1'MDACP
     C                     MOVEL'@AUCPAV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPKAUCPL1               91  *
     C                     GOTO SSEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @AUCPAV
     C                     Z-ADD#1A6NB    AUA6NB           PPWS Head Est
     C                     Z-ADD#CB2NB    AUA7NB           PPWS Plan Head
     C                     MOVEL#1A3ST    AUA3ST    P      PPWS Sts
     C                     MOVEL#1AAVN    AUAAVN    P      RS User Changed
     C                     Z-ADD#1AADT    AUAADT           RS Date Changed
     C                     Z-ADD#1AMTM    AUAMTM           RS Time Changed
     C                     MOVEL#1AJST    AUAJST    P      RS Record Statu
     C                     MOVEL#1AHVN    AUAHVN    P      RS Job
     C                     MOVEL#1AGVN    AUAGVN    P      RS Program
     C                     MOVEL#1ABVN    AUABVN    P      RS User Added
     C                     Z-ADD#1ABDT    AUABDT           RS Date Added
     C                     Z-ADD#1ABTM    AUABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     AUAAVN           RS User Changed
     C                     Z-ADD##JDT     AUAADT           RS Date Changed
     C                     Z-ADD##JTM     AUAMTM           RS Time Changed
     C                     MOVEL##JOB     AUAHVN           RS Job
     C                     MOVEL##PGM     AUAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AUCPAV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAUCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * Crt Prdcr Purch Plan  CR - Producer Purchase Plan  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AVCPAQ
     C                     Z-ADD#1HXNB    AVHXNB           PPWS Company Nu
     C                     Z-ADD#1GANB    AVGANB           CW Year
     C                     Z-ADD#1GBNB    AVGBNB           CW Week Number
     C                     MOVEL#2ABCD    AVABCD           PD Producer Cod
     C                     MOVEL#2AECD    AVAECD           PL Location Cod
     C                     Z-ADD#2BMNB    AVBMNB           PPP Week Head E
     C                     Z-ADD#2A8NB    AVA8NB           PPP Mon Head Es
     C                     Z-ADD#2A9NB    AVA9NB           PPP Mon Plan He
     C                     Z-ADD#2BANB    AVBANB           PPP Tue Head Es
     C                     Z-ADD#2BBNB    AVBBNB           PPP Tue Plan He
     C                     Z-ADD#2BCNB    AVBCNB           PPP Wed Head Es
     C                     Z-ADD#2BDNB    AVBDNB           PPP Wed Plan He
     C                     Z-ADD#2BENB    AVBENB           PPP Thu Head Es
     C                     Z-ADD#2BFNB    AVBFNB           PPP Thu Plan He
     C                     Z-ADD#2BGNB    AVBGNB           PPP Fri Head Es
     C                     Z-ADD#2BHNB    AVBHNB           PPP Fri Plan He
     C                     Z-ADD#2BINB    AVBINB           PPP Sat Head Es
     C                     Z-ADD#2BJNB    AVBJNB           PPP Sat Plan He
     C                     Z-ADD#2BKNB    AVBKNB           PPP Sun Head Es
     C                     Z-ADD#2BLNB    AVBLNB           PPP Sun Plan He
     C                     MOVEL#2AAVN    AVAAVN           RS User Changed
     C                     Z-ADD#2AADT    AVAADT           RS Date Changed
     C                     Z-ADD#2AMTM    AVAMTM           RS Time Changed
     C                     MOVEL#2AJST    AVAJST           RS Record Statu
     C                     MOVEL#2AHVN    AVAHVN           RS Job
     C                     MOVEL#2AGVN    AVAGVN           RS Program
     C                     MOVEL#2ABVN    AVABVN           RS User Added
     C                     Z-ADD#2ABDT    AVABDT           RS Date Added
     C                     Z-ADD#2ABTM    AVABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       AVAJST           RS Record Statu
     C                     MOVEL##USR     AVABVN           RS User Added
     C                     Z-ADD##JDT     AVABDT           RS Date Added
     C                     Z-ADD##JTM     AVABTM           RS Time Added
     C                     MOVEL##PGM     AVAGVN           RS Program
     C                     MOVEL##JOB     AVAHVN           RS Job
     C           KLCRST    KLIST
     C                     KFLD           AVHXNB           PPWS Company Nu
     C                     KFLD           AVGANB           CW Year
     C                     KFLD           AVGBNB           CW Week Number
     C                     KFLD           AVABCD           PD Producer Cod
     C                     KFLD           AVAECD           PL Location Cod
      * Check for duplicate primary key
     C           KLCRST    SETLL@AVCPAQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0048' W0RTN   7
      * Send message 'Producer Purchase Plan EX'
     C                     MOVEL'PRK0048' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@AVCPAQ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Prdcr Purch Plan  CH - Producer Purchase Plan  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AVCPAQ
     C                     Z-ADD#2HXNB    AVHXNB           PPWS Company Nu
     C                     Z-ADD#2GANB    AVGANB           CW Year
     C                     Z-ADD#2GBNB    AVGBNB           CW Week Number
     C                     MOVEL#2ABCD    AVABCD    P      PD Producer Cod
     C                     MOVEL#2AECD    AVAECD    P      PL Location Cod
      *
     C           KLCHSU    KLIST
     C                     KFLD           AVHXNB           PPWS Company Nu
     C                     KFLD           AVGANB           CW Year
     C                     KFLD           AVGBNB           CW Week Number
     C                     KFLD           AVABCD           PD Producer Cod
     C                     KFLD           AVAECD           PL Location Cod
     C           KLCHSU    CHAIN@AVCPAQ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAVCPL0'MDACP
     C                     MOVEL'@AVCPAQ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #2DBRC    IFNE @2DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPKAVCPL0               91  *
     C                     GOTO SUEXIT
     C                     ENDIF                           FI #2DBRC
      * Store record data for null update check
     C                     MOVE @2DBRC    YBRDCS
      * Move non-key fields to @AVCPAQ
     C                     Z-ADD#2BMNB    AVBMNB           PPP Week Head E
     C                     Z-ADD#2A8NB    AVA8NB           PPP Mon Head Es
     C                     Z-ADD#2A9NB    AVA9NB           PPP Mon Plan He
     C                     Z-ADD#2BANB    AVBANB           PPP Tue Head Es
     C                     Z-ADD#2BBNB    AVBBNB           PPP Tue Plan He
     C                     Z-ADD#2BCNB    AVBCNB           PPP Wed Head Es
     C                     Z-ADD#2BDNB    AVBDNB           PPP Wed Plan He
     C                     Z-ADD#2BENB    AVBENB           PPP Thu Head Es
     C                     Z-ADD#2BFNB    AVBFNB           PPP Thu Plan He
     C                     Z-ADD#2BGNB    AVBGNB           PPP Fri Head Es
     C                     Z-ADD#2BHNB    AVBHNB           PPP Fri Plan He
     C                     Z-ADD#2BINB    AVBINB           PPP Sat Head Es
     C                     Z-ADD#2BJNB    AVBJNB           PPP Sat Plan He
     C                     Z-ADD#2BKNB    AVBKNB           PPP Sun Head Es
     C                     Z-ADD#2BLNB    AVBLNB           PPP Sun Plan He
     C                     MOVEL#2AAVN    AVAAVN    P      RS User Changed
     C                     Z-ADD#2AADT    AVAADT           RS Date Changed
     C                     Z-ADD#2AMTM    AVAMTM           RS Time Changed
     C                     MOVEL#2AJST    AVAJST    P      RS Record Statu
     C                     MOVEL#2AHVN    AVAHVN    P      RS Job
     C                     MOVEL#2AGVN    AVAGVN    P      RS Program
     C                     MOVEL#2ABVN    AVABVN    P      RS User Added
     C                     Z-ADD#2ABDT    AVABDT           RS Date Added
     C                     Z-ADD#2ABTM    AVABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @2DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     AVAAVN           RS User Changed
     C                     Z-ADD##JDT     AVAADT           RS Date Changed
     C                     Z-ADD##JTM     AVAMTM           RS Time Changed
     C                     MOVEL##JOB     AVAHVN           RS Job
     C                     MOVEL##PGM     AVAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           @2DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AVCPAQ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@2DBRC    #2DBRC
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * 5=Display Delivery Schedule
      *================================================================
      * Mon Delivery Schedule
      * CASE: RCD.Mon *SFLSEL USR is Select Option 5
     C           #RBCST    IFEQ '5'                        *IF
     C           #RBCST    OREQ ' 5'
      * Dsp Delivery Schedule DF - Buy Order Load  * 
     C                     CLEARPCRC
     C                     Z-ADD#2HXNB    PCHMNB           BOH Company Num
     C                     Z-ADD#PBIDT    PCCQDT           BOL Kill Date
      *
     C                     CALL 'PKAVDFR'              90  Dsp Delivery Sc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Buy Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Tue Delivery Schedule
      * CASE: RCD.Tue *SFLSEL USR is Select Option 5
     C           #RBDST    IFEQ '5'                        *IF
     C           #RBDST    OREQ ' 5'
      * Dsp Delivery Schedule DF - Buy Order Load  * 
     C                     CLEARPCRC
     C                     Z-ADD#2HXNB    PCHMNB           BOH Company Num
     C                     Z-ADD#PBJDT    PCCQDT           BOL Kill Date
      *
     C                     CALL 'PKAVDFR'              90  Dsp Delivery Sc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Buy Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Wed Delivery Schedule
      * CASE: RCD.Wed *SFLSEL USR is Select Option 5
     C           #RBEST    IFEQ '5'                        *IF
     C           #RBEST    OREQ ' 5'
      * Dsp Delivery Schedule DF - Buy Order Load  * 
     C                     CLEARPCRC
     C                     Z-ADD#2HXNB    PCHMNB           BOH Company Num
     C                     Z-ADD#PBKDT    PCCQDT           BOL Kill Date
      *
     C                     CALL 'PKAVDFR'              90  Dsp Delivery Sc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Buy Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Thu Delivery Schedule
      * CASE: RCD.Thu *SFLSEL USR is Select Option 5
     C           #RBFST    IFEQ '5'                        *IF
     C           #RBFST    OREQ ' 5'
      * Dsp Delivery Schedule DF - Buy Order Load  * 
     C                     CLEARPCRC
     C                     Z-ADD#2HXNB    PCHMNB           BOH Company Num
     C                     Z-ADD#PBLDT    PCCQDT           BOL Kill Date
      *
     C                     CALL 'PKAVDFR'              90  Dsp Delivery Sc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Buy Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Fri Delivery Schedule
      * CASE: RCD.Fri *SFLSEL USR is Select Option 5
     C           #RBGST    IFEQ '5'                        *IF
     C           #RBGST    OREQ ' 5'
      * Dsp Delivery Schedule DF - Buy Order Load  * 
     C                     CLEARPCRC
     C                     Z-ADD#2HXNB    PCHMNB           BOH Company Num
     C                     Z-ADD#PBMDT    PCCQDT           BOL Kill Date
      *
     C                     CALL 'PKAVDFR'              90  Dsp Delivery Sc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Buy Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Sat Delivery Schedule
      * CASE: RCD.Sat *SFLSEL USR is Select Option 5
     C           #RBHST    IFEQ '5'                        *IF
     C           #RBHST    OREQ ' 5'
      * Dsp Delivery Schedule DF - Buy Order Load  * 
     C                     CLEARPCRC
     C                     Z-ADD#2HXNB    PCHMNB           BOH Company Num
     C                     Z-ADD#PBNDT    PCCQDT           BOL Kill Date
      *
     C                     CALL 'PKAVDFR'              90  Dsp Delivery Sc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Buy Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Sun Delivery Schedule
      * CASE: RCD.Sun *SFLSEL USR is Select Option 5
     C           #RFKST    IFEQ '5'                        *IF
     C           #RFKST    OREQ ' 5'
      * Dsp Delivery Schedule DF - Buy Order Load  * 
     C                     CLEARPCRC
     C                     Z-ADD#2HXNB    PCHMNB           BOH Company Num
     C                     Z-ADD#PBODT    PCCQDT           BOL Kill Date
      *
     C                     CALL 'PKAVDFR'              90  Dsp Delivery Sc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Buy Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * 7=Dsp Producer Location
      *================================================================
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : RCD.Mon *SFLSEL USR is *Option 7 request
      *   |- c2    : RCD.Tue *SFLSEL USR is *Option 7 request
      *   |- c3    : RCD.Wed *SFLSEL USR is *Option 7 request
      *   |- c4    : RCD.Thu *SFLSEL USR is *Option 7 request
      *   |- c5    : RCD.Fri *SFLSEL USR is *Option 7 request
      *   |- c6    : RCD.Sat *SFLSEL USR is *Option 7 request
      *   |- c7    : RCD.Sun *SFLSEL USR is *Option 7 request
      *   '-
     C           #RBCST    IFEQ '7'                        *IF
     C           #RBCST    OREQ ' 7'
     C           #RBDST    OREQ '7'                        *OR
     C           #RBDST    OREQ ' 7'
     C           #RBEST    OREQ '7'                        *OR
     C           #RBEST    OREQ ' 7'
     C           #RBFST    OREQ '7'                        *OR
     C           #RBFST    OREQ ' 7'
     C           #RBGST    OREQ '7'                        *OR
     C           #RBGST    OREQ ' 7'
     C           #RBHST    OREQ '7'                        *OR
     C           #RBHST    OREQ ' 7'
     C           #RFKST    OREQ '7'                        *OR
     C           #RFKST    OREQ ' 7'
      * Dsp Producer History  DF - Tattoo Header  * 
     C                     CLEARPDRC
     C                     Z-ADD#2HXNB    PDHMNB           BOH Company Num
     C                     MOVEL#2ABCD    PDABCD    P      PD Producer Cod
      *
     C                     CALL 'PKRUDFR'              90  Dsp Producer Hi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Tattoo Hea
     C                     PARM P3EVTX    WQ0011 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKRUDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9831  *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * 8=Work With Buy Orders
      *================================================================
      * Mon Work With Buy Orders
      * CASE: RCD.Mon *SFLSEL USR is Select Option 8
     C           #RBCST    IFEQ '8'                        *IF
     C           #RBCST    OREQ ' 8'
      * CASE: If Producer or Location Blank, Option 8 not valid
      *  - c1 OR c2
      *   |- c1    : RCD.PD Producer Code is Blank
      *   |- c2    : RCD.PL Location Code is Blank
      *   '-
     C           #2ABCD    IFEQ *BLANK                     *IF
     C           #2AECD    OREQ *BLANK                     *OR
      * Setup message data for message
     C                     MOVEL#2ABCD    ZA0001           PD Producer Cod
     C                     MOVEL#2AECD    ZA0002           PL Location Cod
     C                     MOVEL#RBCST    ZA0003           Mon *SFLSEL USR
      * Send message 'Producer & Loc Required'
     C                     MOVEL'PRK0749' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983132*
     C                     SETON                     33    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * WW Producer Buy Orders DF - Buy Order Header  * 
     C                     CLEARPERC
     C                     Z-ADD#2HXNB    PEHMNB           BOH Company Num
     C                     Z-ADD#PBIDT    PEASDT           BOH Kill Date
     C                     Z-ADD#2HXNB    PEHXNB           PPWS Company Nu
     C                     Z-ADD#2GANB    PEGANB           CW Year
     C                     Z-ADD#2GBNB    PEGBNB           CW Week Number
     C                     MOVEL#2ABCD    PEABCD    P      PD Producer Cod
     C                     MOVEL#2AECD    PEAECD    P      PL Location Cod
      *
     C                     CALL 'PKAMDFR'              90  WW Producer Buy
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             RCD: Buy Order
     C           #2A9NB    PARM #2A9NB    WQ0012  50       Head Total (5.0
     C                     PARM P3EUTX    WQ0013 30        Oms Name
     C                     PARM P3EVTX    WQ0014 40        Oms System Valu
     C           P4LCST    PARM *BLANK    WQ0015  4        Buy Order Copy
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAMDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Tue Work With Buy Orders
      * CASE: RCD.Tue *SFLSEL USR is Select Option 8
     C           #RBDST    IFEQ '8'                        *IF
     C           #RBDST    OREQ ' 8'
      * CASE: If Producer or Location Blank, Option 8 not valid
      *  - c1 OR c2
      *   |- c1    : RCD.PD Producer Code is Blank
      *   |- c2    : RCD.PL Location Code is Blank
      *   '-
     C           #2ABCD    IFEQ *BLANK                     *IF
     C           #2AECD    OREQ *BLANK                     *OR
      * Setup message data for message
     C                     MOVEL#2ABCD    ZA0004           PD Producer Cod
     C                     MOVEL#2AECD    ZA0005           PL Location Cod
     C                     MOVEL#RBDST    ZA0006           Tue *SFLSEL USR
      * Send message 'Producer & Loc Required'
     C                     MOVEL'PRK0749' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983132*
     C                     SETON                     34    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * WW Producer Buy Orders DF - Buy Order Header  * 
     C                     CLEARPERC
     C                     Z-ADD#2HXNB    PEHMNB           BOH Company Num
     C                     Z-ADD#PBJDT    PEASDT           BOH Kill Date
     C                     Z-ADD#2HXNB    PEHXNB           PPWS Company Nu
     C                     Z-ADD#2GANB    PEGANB           CW Year
     C                     Z-ADD#2GBNB    PEGBNB           CW Week Number
     C                     MOVEL#2ABCD    PEABCD    P      PD Producer Cod
     C                     MOVEL#2AECD    PEAECD    P      PL Location Cod
      *
     C                     CALL 'PKAMDFR'              90  WW Producer Buy
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             RCD: Buy Order
     C           #2BBNB    PARM #2BBNB    WQ0016  50       Head Total (5.0
     C                     PARM P3EUTX    WQ0017 30        Oms Name
     C                     PARM P3EVTX    WQ0018 40        Oms System Valu
     C           P4LCST    PARM *BLANK    WQ0019  4        Buy Order Copy
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAMDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Wed Work With Buy Orders
      * CASE: RCD.Wed *SFLSEL USR is Select Option 8
     C           #RBEST    IFEQ '8'                        *IF
     C           #RBEST    OREQ ' 8'
      * CASE: If Producer or Location Blank, Option 8 not valid
      *  - c1 OR c2
      *   |- c1    : RCD.PD Producer Code is Blank
      *   |- c2    : RCD.PL Location Code is Blank
      *   '-
     C           #2ABCD    IFEQ *BLANK                     *IF
     C           #2AECD    OREQ *BLANK                     *OR
      * Setup message data for message
     C                     MOVEL#2ABCD    ZA0007           PD Producer Cod
     C                     MOVEL#2AECD    ZA0008           PL Location Cod
     C                     MOVEL#RBEST    ZA0009           Wed *SFLSEL USR
      * Send message 'Producer & Loc Required'
     C                     MOVEL'PRK0749' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983132*
     C                     SETON                     35    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * WW Producer Buy Orders DF - Buy Order Header  * 
     C                     CLEARPERC
     C                     Z-ADD#2HXNB    PEHMNB           BOH Company Num
     C                     Z-ADD#PBKDT    PEASDT           BOH Kill Date
     C                     Z-ADD#2HXNB    PEHXNB           PPWS Company Nu
     C                     Z-ADD#2GANB    PEGANB           CW Year
     C                     Z-ADD#2GBNB    PEGBNB           CW Week Number
     C                     MOVEL#2ABCD    PEABCD    P      PD Producer Cod
     C                     MOVEL#2AECD    PEAECD    P      PL Location Cod
      *
     C                     CALL 'PKAMDFR'              90  WW Producer Buy
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             RCD: Buy Order
     C           #2BDNB    PARM #2BDNB    WQ0020  50       Head Total (5.0
     C                     PARM P3EUTX    WQ0021 30        Oms Name
     C                     PARM P3EVTX    WQ0022 40        Oms System Valu
     C           P4LCST    PARM *BLANK    WQ0023  4        Buy Order Copy
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAMDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Thu Work With Buy Orders
      * CASE: RCD.Thu *SFLSEL USR is Select Option 8
     C           #RBFST    IFEQ '8'                        *IF
     C           #RBFST    OREQ ' 8'
      * CASE: If Producer or Location Blank, Option 8 not valid
      *  - c1 OR c2
      *   |- c1    : RCD.PD Producer Code is Blank
      *   |- c2    : RCD.PL Location Code is Blank
      *   '-
     C           #2ABCD    IFEQ *BLANK                     *IF
     C           #2AECD    OREQ *BLANK                     *OR
      * Setup message data for message
     C                     MOVEL#2ABCD    ZA0010           PD Producer Cod
     C                     MOVEL#2AECD    ZA0011           PL Location Cod
     C                     MOVEL#RBFST    ZA0012           Thu *SFLSEL USR
      * Send message 'Producer & Loc Required'
     C                     MOVEL'PRK0749' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983132*
     C                     SETON                     36    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * WW Producer Buy Orders DF - Buy Order Header  * 
     C                     CLEARPERC
     C                     Z-ADD#2HXNB    PEHMNB           BOH Company Num
     C                     Z-ADD#PBLDT    PEASDT           BOH Kill Date
     C                     Z-ADD#2HXNB    PEHXNB           PPWS Company Nu
     C                     Z-ADD#2GANB    PEGANB           CW Year
     C                     Z-ADD#2GBNB    PEGBNB           CW Week Number
     C                     MOVEL#2ABCD    PEABCD    P      PD Producer Cod
     C                     MOVEL#2AECD    PEAECD    P      PL Location Cod
      *
     C                     CALL 'PKAMDFR'              90  WW Producer Buy
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             RCD: Buy Order
     C           #2BFNB    PARM #2BFNB    WQ0024  50       Head Total (5.0
     C                     PARM P3EUTX    WQ0025 30        Oms Name
     C                     PARM P3EVTX    WQ0026 40        Oms System Valu
     C           P4LCST    PARM *BLANK    WQ0027  4        Buy Order Copy
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAMDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Fri Work With Buy Orders
      * CASE: RCD.Fri *SFLSEL USR is Select Option 8
     C           #RBGST    IFEQ '8'                        *IF
     C           #RBGST    OREQ ' 8'
      * CASE: If Producer or Location Blank, Option 8 not valid
      *  - c1 OR c2
      *   |- c1    : RCD.PD Producer Code is Blank
      *   |- c2    : RCD.PL Location Code is Blank
      *   '-
     C           #2ABCD    IFEQ *BLANK                     *IF
     C           #2AECD    OREQ *BLANK                     *OR
      * Setup message data for message
     C                     MOVEL#2ABCD    ZA0013           PD Producer Cod
     C                     MOVEL#2AECD    ZA0014           PL Location Cod
     C                     MOVEL#RBGST    ZA0015           Fri *SFLSEL USR
      * Send message 'Producer & Loc Required'
     C                     MOVEL'PRK0749' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983132*
     C                     SETON                     37    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * WW Producer Buy Orders DF - Buy Order Header  * 
     C                     CLEARPERC
     C                     Z-ADD#2HXNB    PEHMNB           BOH Company Num
     C                     Z-ADD#PBMDT    PEASDT           BOH Kill Date
     C                     Z-ADD#2HXNB    PEHXNB           PPWS Company Nu
     C                     Z-ADD#2GANB    PEGANB           CW Year
     C                     Z-ADD#2GBNB    PEGBNB           CW Week Number
     C                     MOVEL#2ABCD    PEABCD    P      PD Producer Cod
     C                     MOVEL#2AECD    PEAECD    P      PL Location Cod
      *
     C                     CALL 'PKAMDFR'              90  WW Producer Buy
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             RCD: Buy Order
     C           #2BHNB    PARM #2BHNB    WQ0028  50       Head Total (5.0
     C                     PARM P3EUTX    WQ0029 30        Oms Name
     C                     PARM P3EVTX    WQ0030 40        Oms System Valu
     C           P4LCST    PARM *BLANK    WQ0031  4        Buy Order Copy
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAMDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Sat Work With Buy Orders
      * CASE: RCD.Sat *SFLSEL USR is Select Option 8
     C           #RBHST    IFEQ '8'                        *IF
     C           #RBHST    OREQ ' 8'
      * CASE: If Producer or Location Blank, Option 8 not valid
      *  - c1 OR c2
      *   |- c1    : RCD.PD Producer Code is Blank
      *   |- c2    : RCD.PL Location Code is Blank
      *   '-
     C           #2ABCD    IFEQ *BLANK                     *IF
     C           #2AECD    OREQ *BLANK                     *OR
      * Setup message data for message
     C                     MOVEL#2ABCD    ZA0016           PD Producer Cod
     C                     MOVEL#2AECD    ZA0017           PL Location Cod
     C                     MOVEL#RBHST    ZA0018           Sat *SFLSEL USR
      * Send message 'Producer & Loc Required'
     C                     MOVEL'PRK0749' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983132*
     C                     SETON                     38    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * WW Producer Buy Orders DF - Buy Order Header  * 
     C                     CLEARPERC
     C                     Z-ADD#2HXNB    PEHMNB           BOH Company Num
     C                     Z-ADD#PBNDT    PEASDT           BOH Kill Date
     C                     Z-ADD#2HXNB    PEHXNB           PPWS Company Nu
     C                     Z-ADD#2GANB    PEGANB           CW Year
     C                     Z-ADD#2GBNB    PEGBNB           CW Week Number
     C                     MOVEL#2ABCD    PEABCD    P      PD Producer Cod
     C                     MOVEL#2AECD    PEAECD    P      PL Location Cod
      *
     C                     CALL 'PKAMDFR'              90  WW Producer Buy
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             RCD: Buy Order
     C           #2BJNB    PARM #2BJNB    WQ0032  50       Head Total (5.0
     C                     PARM P3EUTX    WQ0033 30        Oms Name
     C                     PARM P3EVTX    WQ0034 40        Oms System Valu
     C           P4LCST    PARM *BLANK    WQ0035  4        Buy Order Copy
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAMDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Sun Work With Buy Orders
      * CASE: RCD.Sun *SFLSEL USR is Select Option 8
     C           #RFKST    IFEQ '8'                        *IF
     C           #RFKST    OREQ ' 8'
      * CASE: If Producer or Location Blank, Option 8 not valid
      *  - c1 OR c2
      *   |- c1    : RCD.PD Producer Code is Blank
      *   |- c2    : RCD.PL Location Code is Blank
      *   '-
     C           #2ABCD    IFEQ *BLANK                     *IF
     C           #2AECD    OREQ *BLANK                     *OR
      * Setup message data for message
     C                     MOVEL#2ABCD    ZA0019           PD Producer Cod
     C                     MOVEL#2AECD    ZA0020           PL Location Cod
     C                     MOVEL#RFKST    ZA0021           Sun *SFLSEL USR
      * Send message 'Producer & Loc Required'
     C                     MOVEL'PRK0749' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983132*
     C                     SETON                     39    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * WW Producer Buy Orders DF - Buy Order Header  * 
     C                     CLEARPERC
     C                     Z-ADD#2HXNB    PEHMNB           BOH Company Num
     C                     Z-ADD#PBODT    PEASDT           BOH Kill Date
     C                     Z-ADD#2HXNB    PEHXNB           PPWS Company Nu
     C                     Z-ADD#2GANB    PEGANB           CW Year
     C                     Z-ADD#2GBNB    PEGBNB           CW Week Number
     C                     MOVEL#2ABCD    PEABCD    P      PD Producer Cod
     C                     MOVEL#2AECD    PEAECD    P      PL Location Cod
      *
     C                     CALL 'PKAMDFR'              90  WW Producer Buy
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             RCD: Buy Order
     C           #2BLNB    PARM #2BLNB    WQ0036  50       Head Total (5.0
     C                     PARM P3EUTX    WQ0037 30        Oms Name
     C                     PARM P3EVTX    WQ0038 40        Oms System Valu
     C           P4LCST    PARM *BLANK    WQ0039  4        Buy Order Copy
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAMDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Load Planned Head after Copy
      * CASE: PAR.Buy Order Copy Sts USR is *Yes
     C           P4LCST    IFEQ '*YES'                     *IF
      * Rtv Head Planned      RT - Buy Order Header  * 
     C                     EXSR SDRVGN
      * Rtv Head Planned      RT - Buy Order Header  * 
     C                     EXSR SFRVGN
      * Rtv Head Planned      RT - Buy Order Header  * 
     C                     EXSR SHRVGN
      * Rtv Head Planned      RT - Buy Order Header  * 
     C                     EXSR SJRVGN
      * Rtv Head Planned      RT - Buy Order Header  * 
     C                     EXSR SLRVGN
      * Rtv Head Planned      RT - Buy Order Header  * 
     C                     EXSR SNRVGN
      * Rtv Head Planned      RT - Buy Order Header  * 
     C                     EXSR SPRVGN
     C                     MOVEL*BLANK    P4LCST           Buy Order Copy
     C                     MOVEL'*NO'     P4LCST           Buy Order Copy
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * 9=Edit Standard Delivery Schedule
      *================================================================
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : RCD.Mon *SFLSEL USR is *Option 9 (Reusable)
      *   |- c2    : RCD.Tue *SFLSEL USR is *Option 9 (Reusable)
      *   |- c3    : RCD.Wed *SFLSEL USR is *Option 9 (Reusable)
      *   |- c4    : RCD.Thu *SFLSEL USR is *Option 9 (Reusable)
      *   |- c5    : RCD.Fri *SFLSEL USR is *Option 9 (Reusable)
      *   |- c6    : RCD.Sat *SFLSEL USR is *Option 9 (Reusable)
      *   |- c7    : RCD.Sun *SFLSEL USR is *Option 9 (Reusable)
      *   '-
     C           #RBCST    IFEQ '9'                        *IF
     C           #RBDST    OREQ '9'                        *OR
     C           #RBEST    OREQ '9'                        *OR
     C           #RBFST    OREQ '9'                        *OR
     C           #RBGST    OREQ '9'                        *OR
     C           #RBHST    OREQ '9'                        *OR
     C           #RFKST    OREQ '9'                        *OR
      * Edt Std Delv Sched    EF - Producer Std Delv Sched  * 
     C                     CLEARPFRC
     C                     MOVEL#2ABCD    PFABCD    P      PD Producer Cod
     C                     MOVEL#2AECD    PFAECD    P      PL Location Cod
      *
     C                     CALL 'PKAEEFR'              90  Edt Std Delv Sc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Producer S
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAEEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#2ABCD    WK1X01  1
     C                     MOVEL#2AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#2ABCD'
     C           ##RR      ANDEQYPMRRN
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#2AECD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #2ABCD' defaulted for 'PD Producer Code'.
      * Field '(RCD) #2AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #2ABCD    PARM #2ABCD    WQ0009  6        PD Producer Cod
     C           #2AECD    PARM #2AECD    WQ0010  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     983132*
     C                     END
      *
     C           #2ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #2ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #2AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAAF    KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL#2ABCD    AFABCD
     C                     MOVEL#2AECD    AFAECD
     C           KLVAAF    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      *
     C           KLVBWA    KLIST
     C                     KFLD           WAGANB           CW Year
     C                     KFLD           WAGBNB           CW Week Number
      * Setup key
     C                     Z-ADD#1GANB    WAGANB
     C                     Z-ADD#1GBNB    WAGBNB
     C           KLVBWA    CHAIN@CFREIL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Restrictor relation not satisfied
      * Send message 'Calendar Week          NF'
     C                     MOVEL'PRK0178' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0178' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03840
     C           ZINPOS    ANDLE05376
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  15        W0CSRR  50
     C           03840     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD15        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           ZHF4RW    IFEQ 015
     C           ZHCSCL    ANDGE002
     C           ZHCSCL    ANDLE007
     C           *IN82     ANDNE'1'
     C                     MOVEL'#2ABCD'  YPMTFD           PD Producer Cod
     C                     END
      *
     C           ZHF4RW    IFEQ 015
     C           ZHCSCL    ANDGE009
     C           ZHCSCL    ANDLE014
     C           *IN82     ANDNE'1'
     C                     MOVEL'#2AECD'  YPMTFD           PL Location Cod
     C                     END
      *
     C           ZHF4RW    IFEQ 015
     C           ZHCSCL    ANDEQ024
     C                     MOVEL'#RBCST'  YPMTFD           Mon *SFLSEL USR
     C                     END
      *
     C           ZHF4RW    IFEQ 015
     C           ZHCSCL    ANDEQ032
     C                     MOVEL'#RBDST'  YPMTFD           Tue *SFLSEL USR
     C                     END
      *
     C           ZHF4RW    IFEQ 015
     C           ZHCSCL    ANDEQ040
     C                     MOVEL'#RBEST'  YPMTFD           Wed *SFLSEL USR
     C                     END
      *
     C           ZHF4RW    IFEQ 015
     C           ZHCSCL    ANDEQ048
     C                     MOVEL'#RBFST'  YPMTFD           Thu *SFLSEL USR
     C                     END
      *
     C           ZHF4RW    IFEQ 015
     C           ZHCSCL    ANDEQ056
     C                     MOVEL'#RBGST'  YPMTFD           Fri *SFLSEL USR
     C                     END
      *
     C           ZHF4RW    IFEQ 015
     C           ZHCSCL    ANDEQ064
     C                     MOVEL'#RBHST'  YPMTFD           Sat *SFLSEL USR
     C                     END
      *
     C           ZHF4RW    IFEQ 015
     C           ZHCSCL    ANDEQ072
     C                     MOVEL'#RFKST'  YPMTFD           Sun *SFLSEL USR
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'PKAIETRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2BGDT           CW Week Start D
     C                     Z-ADD*ZERO     P2BHDT           CW Week End Dat
     C                     Z-ADD*ZERO     P2BIDT           CW Mon Date
     C                     Z-ADD*ZERO     P2BJDT           CW Tue Date
     C                     Z-ADD*ZERO     P2BKDT           CW Wed Date
     C                     Z-ADD*ZERO     P2BLDT           CW Thu Date
     C                     Z-ADD*ZERO     P2BMDT           CW Fri Date
     C                     Z-ADD*ZERO     P2BNDT           CW Sat Date
     C                     Z-ADD*ZERO     P2BODT           CW Sun Date
     C                     MOVEL*BLANK    P4LCST           Buy Order Copy
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field CW Year
     C                     Z-ADD*ZERO     WUGANB  40
      * Define work field CW Week Number
     C                     Z-ADD*ZERO     WUGBNB  20
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAGANB           CW Year
     C                     Z-ADD*ZERO     WAGBNB           CW Week Number
     C                     Z-ADD*ZERO     WABGDT           CW Week Start D
     C                     Z-ADD*ZERO     WABHDT           CW Week End Dat
     C                     Z-ADD*ZERO     WABIDT           CW Mon Date
     C                     Z-ADD*ZERO     WABJDT           CW Tue Date
     C                     Z-ADD*ZERO     WABKDT           CW Wed Date
     C                     Z-ADD*ZERO     WABLDT           CW Thu Date
     C                     Z-ADD*ZERO     WABMDT           CW Fri Date
     C                     Z-ADD*ZERO     WABNDT           CW Sat Date
     C                     Z-ADD*ZERO     WABODT           CW Sun Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0TRN   1        *Continue trans
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'Y'       W0PMT   1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Subfile page size
     C                     Z-ADD06        ##SFPG  30       SFLPAG
      * Initialise subfile positioner
     C                     Z-ADD1         ##SFRC
      *
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      * C2206 Kill Plan Str Wk
      * 12/30/96   SLM     Establish number of Kill Plan for the
      *                    week was not accumulating correctly
      *                    if this the beginning year starts on
      *                    another day then Monday.
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP3EVTX    ##CMP
      *****************************************************************
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
00783007900083100845010470107701095
02073020810208902097021050211302121
02330023380234602354023620237002378
02586025940260202610026180262602634
02840028480285602864028720288002888
03842038490385603864038660387203874
03880038820388803890038960389803904
039060391203914
** W0END
00785008190083400846010540108401102
02078020860209402102021100211802126
02335023430235102359023670237502383
02590025980260602614026220263002638
02846028540286202870028780288602894
03847038540386203864038700387203878
03880038860388803894038960390203904
039100391203918
** W0NAM
#1HXNB    #PEUTX    #1GANB    #1GBNB    #CCJNB    #CB2NB    #CBUNB
VPBIDT    VPBJDT    VPBKDT    VPBLDT    VPBMDT    VPBNDT    VPBODT
#CGZNB    #CG0NB    #CG1NB    #CG2NB    #CG3NB    #CG4NB    #CG8NB
#CGTNB    #CGUNB    #CGVNB    #CGWNB    #CGXNB    #CGYNB    #CG7NB
#CBVNB    #CBWNB    #CBXNB    #CBYNB    #CBZNB    #CB0NB    #CG6NB
#2ABCD    #2AECD    #2BMNB    #RBCST    #2A9NB    #RBDST    #2BBNB
#RBEST    #2BDNB    #RBFST    #2BFNB    #RBGST    #2BHNB    #RBHST
#2BJNB    #RFKST    #2BLNB
