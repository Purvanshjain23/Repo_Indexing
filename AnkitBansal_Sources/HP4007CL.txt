/***************************************************************** */
/*  PROGRAM NUMBER:  HP4007CL                                      */
/*  PROGRAM NAME:    COPY BGF TARGEST                              */
/*  PROGRAMMER:      SHARON ZURN                                   */
/*  CREATE DATE:     10/16/06                                      */
/*                                                                 */
/*  FUNCTION:        THIS CL IS SUBMITTED WITH QCMDEXC FROM        */
/*                   HP4007-SPECIFY BGF TARGETS TO COPY.           */
/*                                                                 */
/*                   OPTIONS ARE PASSED THROUGH THE LDA.           */
/*                                                                 */
/*******************************************************************/
/*  MODIFIED:                                                      */
/*******************************************************************/

             PGM

             DCL        VAR(&QDATA) TYPE(*CHAR) LEN(40)

             DCL        VAR(&LDFCDYR) TYPE(*DEC) LEN(4)
             DCL        VAR(&LDFTTBCD) TYPE(*CHAR) LEN(5)

             CHGVAR     VAR(&LDFCDYR) VALUE(%SST(*LDA 1 4))
             CHGVAR     VAR(&LDFTTBCD) VALUE(%SST(*LDA 5 5))

/*-------------------------------------------------------------------*/
/* SET UP/RUN OPEN QUERY TO SELECT THE 'FROM' RECORDS TO COPY        */
/*-------------------------------------------------------------------*/

/*  ALWAYS SELECT RECORDS FOR THE SPECIFIED FROM YEAR            */

             CHGVAR     VAR(%SST(&QDATA 1 10)) VALUE('BYCDYR *EQ')
             CHGVAR     VAR(%SST(&QDATA 12 4)) VALUE(&LDFCDYR)

/* TARGET TABLE                                                   */

             IF         COND(&LDFTTBCD *NE ' ') THEN(DO)
             CHGVAR     VAR(%SST(&QDATA 17 16)) VALUE('*AND BYTTBCD +
                          *EQ')
             CHGVAR     VAR(%SST(&QDATA 34 1)) VALUE('"')
             CHGVAR     VAR(%SST(&QDATA 35 5)) VALUE(&LDFTTBCD)
             CHGVAR     VAR(%SST(&QDATA 40 1)) VALUE('"')
             ENDDO

             OVRDBF     FILE(HSP096) SHARE(*YES)
             OPNQRYF    FILE((HSP096)) QRYSLT(&QDATA) KEYFLD(*FILE) +
                          SEQONLY(*YES)

/*------------------------------------------------------------------*/
/*  CALL COPY PROGRAM                                                */
/*------------------------------------------------------------------*/

             CALL       PGM(HP3007)

             CLOF       OPNID(HSP096)
             DLTOVR     FILE(HSP096)

             ENDPGM

