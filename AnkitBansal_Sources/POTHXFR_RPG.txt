     H/TITLE Bld 3 Yr Workf        XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRBEND
     H* Date          : 05/25/07  Time  : 10:44:23
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : Application Profile       Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDLDCPL2IF  E           K        DISK
      * RSQ : A/R Balance File          Co/AR Cust/BalYr/BalMo(D
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FOMHSTPLVIF  E           K        DISK
      * RSQ : Sales History             RSQ Co/AR Cust/ShipDate
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FARBCREL5IF  E           K        DISK
      * RSQ : A/R Summary               RSQ Cust/Company       N
      *
     FPOANCPL0IF  E           K        DISK                      A
      * UPD : WF A/R Summary DSO        Update index
      *
     E                    UCT        40  1               CENTER TABLE
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WAAJVN
     I              DRAUNA                          WAAUNA
     I              DRB8NA                          WAB8NA
     I              DRAHVN                          WAAHVN
     I              DRI6ST                          WAI6ST
     I              DRI7ST                          WAI7ST
     I              DRXMST                          WAXMST
     I              DRXNST                          WAXNST
     I              DRI8ST                          WAI8ST
     I              DRNLNB                          WANLNB
     I              DRMPNA                          WAMPNA
     I              DRBCCD                          WABCCD
     I              DRAIC3                          WAAIC3
     I              DRDQCD                          WADQCD
     I              DRDRCD                          WADRCD
     I              DRAJCD                          WAAJCD
     I              DRBUVN                          WABUVN
     I              DRUVST                          WAUVST
     I              DRUWST                          WAUWST
     I              DRUXST                          WAUXST
     I              DRAATM                          WAAATM
     I              DRAYNA                          WAAYNA
     I              DRA0NA                          WAA0NA
     I              DRAXDT                          WAAXDT
      *
     I@DTRETE
      * Application Profile       Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WBAJVN
     I              DTDNCD                          WBDNCD
     I              DTAIC3                          WBAIC3
     I              DTDQCD                          WBDQCD
     I              DTDRCD                          WBDRCD
     I              DTAJCD                          WBAJCD
     I              DTJFST                          WBJFST
     I              DTUVST                          WBUVST
     I              DTUWST                          WBUWST
     I              DTUXST                          WBUXST
     I              DTAATM                          WBAATM
     I              DTAYNA                          WBAYNA
     I              DTA0NA                          WBA0NA
     I              DTAXDT                          WBAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WCDNCD
     I              DNAUNA                          WCAUNA
     I              DNVKST                          WCVKST
     I              DNRSCD                          WCRSCD
     I              DNUVST                          WCUVST
     I              DNUWST                          WCUWST
     I              DNUXST                          WCUXST
     I              DNAATM                          WCAATM
     I              DNAYNA                          WCAYNA
     I              DNA0NA                          WCA0NA
     I              DNAXDT                          WCAXDT
      *
     I@LDCPOU
      * A/R Balance File          Co/AR Cust/BalYr/BalMo(D
      * Renamed input format fields
     I              LDAIC3                          WDAIC3
     I              LDANC7                          WDANC7
     I              LDA1NB                          WDA1NB
     I              LDY4NB                          WDY4NB
     I              LDALVA                          WDALVA
     I              LDAIDT                          WDAIDT
     I              LDY5VA                          WDY5VA
     I              LDZAVA                          WDZAVA
     I              LDY7VA                          WDY7VA
     I              LDY8VA                          WDY8VA
     I              LDY9VA                          WDY9VA
     I              LDRTNX                          WDRTNX
     I              LDRUNX                          WDRUNX
     I              LDRVNX                          WDRVNX
     I              LDRWNX                          WDRWNX
     I              LDRXNX                          WDRXNX
     I              LDB4DY                          WDB4DY
     I              LDBSDY                          WDBSDY
     I              LDK2DT                          WDK2DT
     I              LDUNUS                          WDUNUS
     I              LDUNU2                          WDUNU2
     I              LDUVST                          WDUVST
     I              LDUWST                          WDUWST
     I              LDUXST                          WDUXST
     I              LDVSST                          WDVSST
     I              LDAATM                          WDAATM
     I              LDAYNA                          WDAYNA
     I              LDA0NA                          WDA0NA
     I              LDAXDT                          WDAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WEBKC7
     I              BBAYTX                          WEAYTX
     I              BBACNA                          WEACNA
     I              BBADNA                          WEADNA
     I              BBAENA                          WEAENA
     I              BBAJNA                          WEAJNA
     I              BBBGCD                          WEBGCD
     I              BBG5CD                          WEG5CD
     I              BBBTTX                          WEBTTX
     I              BBBVTX                          WEBVTX
     I              BBBWTX                          WEBWTX
     I              BBABTX                          WEABTX
     I              BBA2NA                          WEA2NA
     I              BBCBST                          WECBST
     I              BBB0NA                          WEB0NA
     I              BBP3NB                          WEP3NB
     I              BBAXNA                          WEAXNA
     I              BBI6DT                          WEI6DT
     I              BBAYDT                          WEAYDT
     I              BBANC7                          WEANC7
     I              BBBTC7                          WEBTC7
     I              BBK6ST                          WEK6ST
     I              BBUZST                          WEUZST
     I              BBKXCD                          WEKXCD
     I              BBLTCD                          WELTCD
     I              BBQNST                          WEQNST
     I              BBS2NB                          WES2NB
     I              BBVHVA                          WEVHVA
     I              BBI7DT                          WEI7DT
     I              BBRJST                          WERJST
     I              BBRKST                          WERKST
     I              BBQWST                          WEQWST
     I              BBQXST                          WEQXST
     I              BBQYST                          WEQYST
     I              BBUNCS                          WEUNCS
     I              BBUVST                          WEUVST
     I              BBUWST                          WEUWST
     I              BBUXST                          WEUXST
     I              BBVSST                          WEVSST
     I              BBAATM                          WEAATM
     I              BBAYNA                          WEAYNA
     I              BBA0NA                          WEA0NA
     I              BBAXDT                          WEAXDT
      *
     I@HSTPQF
      * Sales History             RSQ Co/AR Cust/ShipDate
      * Renamed input format fields
     I              F4AIC3                          WFAIC3
     I              F4C4NB                          WFC4NB
     I              F4DPNB                          WFDPNB
     I              F4UENB                          WFUENB
     I              F4MONA                          WFMONA
     I              F4RJCD                          WFRJCD
     I              F4RKCD                          WFRKCD
     I              F4GPTX                          WFGPTX
     I              F4ABTX                          WFABTX
     I              F4KXCD                          WFKXCD
     I              F4BOCD                          WFBOCD
     I              F4BTC7                          WFBTC7
     I              F4ANC7                          WFANC7
     I              F4AQTX                          WFAQTX
     I              F4BKC7                          WFBKC7
     I              F4BRTX                          WFBRTX
     I              F4HNNA                          WFHNNA
     I              F4DBCD                          WFDBCD
     I              F4CKTX                          WFCKTX
     I              F4BCNA                          WFBCNA
     I              F4A0DT                          WFA0DT
     I              F4ACDT                          WFACDT
     I              F4R4CD                          WFR4CD
     I              F4R5CD                          WFR5CD
     I              F4BFCD                          WFBFCD
     I              F4Q4CD                          WFQ4CD
     I              F4AQCD                          WFAQCD
     I              F4TBNB                          WFTBNB
     I              F4BZNA                          WFBZNA
     I              F4RLCD                          WFRLCD
     I              F4JNCD                          WFJNCD
     I              F4Q2CD                          WFQ2CD
     I              F4U2ST                          WFU2ST
     I              F4ATIN                          WFATIN
     I              F4T3NB                          WFT3NB
     I              F4RSRN                          WFRSRN
     I              F4ORIT                          WFORIT
     I              F4AJCD                          WFAJCD
     I              F4AVQT                          WFAVQT
     I              F4D0WG                          WFD0WG
     I              F4CCQT                          WFCCQT
     I              F4AUWG                          WFAUWG
     I              F4AGCD                          WFAGCD
     I              F4AKPR                          WFAKPR
     I              F4AUPR                          WFAUPR
     I              F4CRCD                          WFCRCD
     I              F4A5DT                          WFA5DT
     I              F4AWDT                          WFAWDT
     I              F4HDDT                          WFHDDT
     I              F4AGCS                          WFAGCS
     I              F4AQCS                          WFAQCS
     I              F4AVWG                          WFAVWG
     I              F4AYVA                          WFAYVA
     I              F4AMST                          WFAMST
     I              F4ANST                          WFANST
     I              F4VAST                          WFVAST
     I              F4L6NB                          WFL6NB
     I              F4UMCD                          WFUMCD
     I              F4HCDT                          WFHCDT
     I              F4ESNB                          WFESNB
     I              F4ETNB                          WFETNB
     I              F4BZNB                          WFBZNB
     I              F4EXQT                          WFEXQT
     I              F4BYWG                          WFBYWG
     I              F4S5NB                          WFS5NB
     I              F4MAVA                          WFMAVA
     I              F4KDVA                          WFKDVA
     I              F4USVA                          WFUSVA
     I              F4UTVA                          WFUTVA
     I              F4A4WG                          WFA4WG
     I              F4CKNB                          WFCKNB
     I              F4BMST                          WFBMST
     I              F4R8NB                          WFR8NB
     I              F4RMCD                          WFRMCD
     I              F4BZPR                          WFBZPR
     I              F4RDCD                          WFRDCD
     I              F4Q7CD                          WFQ7CD
     I              F4EXDT                          WFEXDT
     I              F4LQCD                          WFLQCD
     I              F4HICD                          WFHICD
     I              F4RBCD                          WFRBCD
     I              F4RGNB                          WFRGNB
     I              F4RHNB                          WFRHNB
     I              F4RINB                          WFRINB
     I              F4R1NB                          WFR1NB
     I              F4CONB                          WFCONB
     I              F4CEST                          WFCEST
     I              F4GNDT                          WFGNDT
     I              F4RMNB                          WFRMNB
     I              F4AODT                          WFAODT
     I              F4LLCD                          WFLLCD
     I              F4LMCD                          WFLMCD
     I              F4SKNB                          WFSKNB
     I              F4SLNB                          WFSLNB
     I              F4SMNB                          WFSMNB
     I              F4G7NA                          WFG7NA
     I              F4ONVA                          WFONVA
     I              F4N0CD                          WFN0CD
     I              F4B4NB                          WFB4NB
     I              F4B5NB                          WFB5NB
     I              F4N1CD                          WFN1CD
     I              F4GIDT                          WFGIDT
     I              F4Z1ST                          WFZ1ST
     I              F4ULVA                          WFULVA
     I              F4UNVA                          WFUNVA
     I              F4UOVA                          WFUOVA
     I              F4UPVA                          WFUPVA
     I              F4UQVA                          WFUQVA
     I              F4SDCD                          WFSDCD
     I              F4QZCD                          WFQZCD
     I              F4XWST                          WFXWST
     I              F4T9CD                          WFT9CD
     I              F4UBCD                          WFUBCD
     I              F4CFC7                          WFCFC7
     I              F4X1CD                          WFX1CD
     I              F4GASX                          WFGASX
     I              F4DUPR                          WFDUPR
     I              F4B6VL                          WFB6VL
     I              F4IANX                          WFIANX
     I              F4IBNX                          WFIBNX
     I              F4RPCD                          WFRPCD
     I              F4NYDT                          WFNYDT
     I              F4BZTM                          WFBZTM
     I              F4Z4NB                          WFZ4NB
     I              F4XACD                          WFXACD
     I              F4OANA                          WFOANA
     I              F4OKTX                          WFOKTX
     I              F4K4TX                          WFK4TX
     I              F4NBBO                          WFNBBO
     I              F4OCFR                          WFOCFR
     I              F4C0C7                          WFC0C7
     I              F4A1AA                          WFA1AA
     I              F4VEST                          WFVEST
     I              F4A5PR                          WFA5PR
     I              F4CDPR                          WFCDPR
     I              F4D0PR                          WFD0PR
     I              F4D0VL                          WFD0VL
     I              F4IRSX                          WFIRSX
     I              F4CEVL                          WFCEVL
     I              F4ISSX                          WFISSX
     I              F4ITSX                          WFITSX
     I              F4IUSX                          WFIUSX
     I              F4OHDT                          WFOHDT
     I              F4D9PR                          WFD9PR
     I              F4CFVL                          WFCFVL
     I              F4UVST                          WFUVST
     I              F4UWST                          WFUWST
     I              F4UXST                          WFUXST
     I              F4AATM                          WFAATM
     I              F4AYNA                          WFAYNA
     I              F4A0NA                          WFA0NA
     I              F4AXDT                          WFAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                          WGJNCD
     I              EXJVNA                          WGJVNA
     I              EXOAST                          WGOAST
     I              EXOBST                          WGOBST
     I              EXOEST                          WGOEST
     I              EXOFST                          WGOFST
     I              EXVBST                          WGVBST
     I              EXPYST                          WGPYST
     I              EXX8ST                          WGX8ST
     I              EXISTX                          WGISTX
     I              EXUVST                          WGUVST
     I              EXUWST                          WGUWST
     I              EXUXST                          WGUXST
     I              EXVSST                          WGVSST
     I              EXAATM                          WGAATM
     I              EXAYNA                          WGAYNA
     I              EXA0NA                          WGA0NA
     I              EXAXDT                          WGAXDT
      *
     I@ANCPF5
      * WF A/R Summary DSO        Update index
      * Renamed input format fields
     I              ANAIC3                          WHAIC3
     I              ANANC7                          WHANC7
     I              ANTGNX                          WHTGNX
     I              ANAYTX                          WHAYTX
     I              ANBTC7                          WHBTC7
     I              ANEBVL                          WHEBVL
     I              ANMUNX                          WHMUNX
     I              ANSTNX                          WHSTNX
     I              ANSSNX                          WHSSNX
     I              ANSUNX                          WHSUNX
     I              ANSVNX                          WHSVNX
     I              ANSWNX                          WHSWNX
     I              ANSXNX                          WHSXNX
     I              ANSYNX                          WHSYNX
     I              ANSZNX                          WHSZNX
     I              ANS0NX                          WHS0NX
     I              ANS1NX                          WHS1NX
     I              ANS2NX                          WHS2NX
     I              ANS3NX                          WHS3NX
     I              ANS4NX                          WHS4NX
     I              ANS5NX                          WHS5NX
     I              ANS6NX                          WHS6NX
     I              ANS7NX                          WHS7NX
     I              ANS8NX                          WHS8NX
     I              ANS9NX                          WHS9NX
     I              ANTANX                          WHTANX
     I              ANTBNX                          WHTBNX
     I              ANTFNX                          WHTFNX
     I              ANTCNX                          WHTCNX
     I              ANTDNX                          WHTDNX
     I              ANTENX                          WHTENX
      *
     I@BCREEC
      * A/R Summary               RSQ Cust/Company       N
      * Renamed input format fields
     I              BCAIC3                          WIAIC3
     I              BCANC7                          WIANC7
     I              BCAGVA                          WIAGVA
     I              BCACVA                          WIACVA
     I              BCADVA                          WIADVA
     I              BCAEVA                          WIAEVA
     I              BCAFVA                          WIAFVA
     I              BCAHVA                          WIAHVA
     I              BCVIVA                          WIVIVA
     I              BCVJVA                          WIVJVA
     I              BCVKVA                          WIVKVA
     I              BCVLVA                          WIVLVA
     I              BCVMVA                          WIVMVA
     I              BCVNVA                          WIVNVA
     I              BCEEVA                          WIEEVA
     I              BCAKTM                          WIAKTM
     I              BCAHDT                          WIAHDT
     I              BCANDT                          WIANDT
     I              BCANVA                          WIANVA
     I              BCALDT                          WIALDT
     I              BCAMVA                          WIAMVA
     I              BCAIDT                          WIAIDT
     I              BCALVA                          WIALVA
     I              BCDJNB                          WIDJNB
     I              BCDLNB                          WIDLNB
     I              BCDDNB                          WIDDNB
     I              BCDMNB                          WIDMNB
     I              BCDUDT                          WIDUDT
     I              BCLYNO                          WILYNO
     I              BCLYNC                          WILYNC
     I              BCLYNP                          WILYNP
     I              BCLYNI                          WILYNI
     I              BCADPM                          WIADPM
     I              BCVOVA                          WIVOVA
     I              BCBTDY                          WIBTDY
     I              BCBUDY                          WIBUDY
     I              BCVPVA                          WIVPVA
     I              BCVQVA                          WIVQVA
     I              BCBCCD                          WIBCCD
     I              BCR4CD                          WIR4CD
     I              BCCUMO                          WICUMO
     I              BCUVST                          WIUVST
     I              BCUWST                          WIUWST
     I              BCUXST                          WIUXST
     I              BCAATM                          WIAATM
     I              BCAYNA                          WIAYNA
     I              BCA0NA                          WIA0NA
     I              BCAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
     IQPOAN1    E DSPOANCPL0
      * UPD : WF A/R Summary DSO        Update index
      * Renamed input format fields
     I              ANAIC3                          WHAIC3
     I              ANANC7                          WHANC7
     I              ANTGNX                          WHTGNX
     I              ANAYTX                          WHAYTX
     I              ANBTC7                          WHBTC7
     I              ANEBVL                          WHEBVL
     I              ANMUNX                          WHMUNX
     I              ANSTNX                          WHSTNX
     I              ANSSNX                          WHSSNX
     I              ANSUNX                          WHSUNX
     I              ANSVNX                          WHSVNX
     I              ANSWNX                          WHSWNX
     I              ANSXNX                          WHSXNX
     I              ANSYNX                          WHSYNX
     I              ANSZNX                          WHSZNX
     I              ANS0NX                          WHS0NX
     I              ANS1NX                          WHS1NX
     I              ANS2NX                          WHS2NX
     I              ANS3NX                          WHS3NX
     I              ANS4NX                          WHS4NX
     I              ANS5NX                          WHS5NX
     I              ANS6NX                          WHS6NX
     I              ANS7NX                          WHS7NX
     I              ANS8NX                          WHS8NX
     I              ANS9NX                          WHS9NX
     I              ANTANX                          WHTANX
     I              ANTBNX                          WHTBNX
     I              ANTFNX                          WHTFNX
     I              ANTCNX                          WHTCNX
     I              ANTDNX                          WHTDNX
     I              ANTENX                          WHTENX
      *
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0001
      * Application Code
     I                                       11  16 ZA0002
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0003
      * Application Code
     I                                       11  16 ZA0004
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld 3 Yr Workf        XF
      * ** DLY029R 05/25/07 JRB Changed hard coded Co Num to Default Co N
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Application   IF
      * RTV Program Setup      RT - User Profile Control  * 
     C                     EXSR SARVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0001           User Profile Na
     C                     MOVEL'A/R'     ZA0002           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0001    P      User Profile Na
     C                     MOVEL'A/R'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0001           Company Number
     C                     MOVELWL0004    YN0001    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0001    P      User Profile Na
     C                     MOVEL'A/R'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0001           Company Number
     C                     MOVELWL0004    YN0001    P      Warehouse Code
     C                     END                             *FI
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0003           User Profile Na
     C                     MOVEL'A/R'     ZA0004           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SCRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Rtv Avg Days per Yr   RT - A/R Balance File  * 
     C                     EXSR SERVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Program Setup      RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    WAAJVN           User Profile Na
      * Establish starting position
     C           KRSSA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJVN           User Profile Na
     C                     KFLD           WBDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    WBAJVN           User Profile Na
     C                     MOVELWL0002    WBDNCD           Application Cod
      * Establish starting position
     C           KRSSB     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAIC3    WL0003           Company Number
     C                     MOVELWBAJCD    WL0004           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCDNCD    WQSC01           Application Cod
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSC01           Application Cod
     C                     MOVEL'A/R'     WQSC01           Application Cod
      * Establish starting position
     C           KRSSC     SETLL@DNRESF                    *
     C           KRSSC     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WCRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWCAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C           KRSSC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCDNCD    WQSD01           Application Cod
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Application Cod
      * Setup key
     C                     MOVELWCRSCD    WQSD01           Application Cod
      * Establish starting position
     C           KRSSD     SETLL@DNRESF                    *
     C           KRSSD     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCAUNA    WUAUNA           Description
     C           KRSSD     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Avg Days per Yr   RT - A/R Balance File  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  50       Bal Avg Days to
     C                     Z-ADD*ZERO     WN0004  20       Month
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * WRK.Current Year  USR = JOB.*Job date *YEAR
     C           ##JDT     ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUI0NX
     C           WUI0NX    SUB  1         WUSINX           YEAR 1 USR
     C           WUI0NX    SUB  2         WUSJNX           YEAR 2 USR
      * Format from/to dates for 2 years ago
     C                     Z-ADDWUSJNX    WUI8NX           Year  NBR USR
     C                     MOVELWUI8NX    WUT4TX           Year  (Char) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT4TX    CAT  '0101':ZQ WUT7TX    P      Date (Char-6) U
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WUT7TX:ZQ WUR4TX    P      Date (Alpha) US
     C                     MOVE WUR4TX    WUJEDT           Date From
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT4TX    CAT  '1231':ZQ WUT7TX    P      Date (Char-6) U
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WUT7TX:ZQ WUR4TX    P      Date (Alpha) US
     C                     MOVE WUR4TX    WUJFDT           Date To
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSE01           Company Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
      * Setup key
     C                     Z-ADDYL0001    WQSE01           Company Number
      * Establish starting position
     C           KRSSE     SETLL@LDCPOU                    *
     C           KRSSE     READE@LDCPOU                  90*
      * Data record not found
     C   90                MOVEL'USR2448' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.A/R Balance Year GE WRK.YEAR 2 USR
     C           WDA1NB    IFGE WUSJNX                     *IF
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWDANC7    WUANC7           A/R Customer Nu
     C                     Z-ADDWDA1NB    WUA1NB           A/R Balance Yea
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.A/R Customer Number NE WRK.A/R Customer Number
      *   |- c2    : DB1.A/R Balance Year NE WRK.A/R Balance Year
      *   '-
     C           WDANC7    IFNE WUANC7                     *IF
     C           WDA1NB    ORNE WUA1NB                     *OR
      * Calc avg at year or cust break
     C                     DIV  WN0004    WN0003           Bal Avg Days to
      * RTV Parent / Name      RT - Customer  * 
     C                     EXSR SFRVGN
      * CASE: WRK.A/R Balance Year EQ WRK.Current Year  USR
     C           WUA1NB    IFEQ WUI0NX                     *IF
     C                     Z-ADDWUVPVA    WUEBVL           DSO Sales Invoi
     C                     ELSE
      * CASE: WRK.A/R Balance Year EQ WRK.YEAR 1 USR
     C           WUA1NB    IFEQ WUSINX                     *IF
     C                     Z-ADDWUVQVA    WUEBVL           DSO Sales Invoi
     C                     ELSE
      * CASE: WRK.A/R Balance Year EQ WRK.YEAR 2 USR
     C           WUA1NB    IFEQ WUSJNX                     *IF
      * RTV AR Cust Pnd & Dllr RT - Sales History  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Crt A/R Summary DSO Wk CR - A/R Summary DSO Workfile  * 
     C                     EXSR SICRRC
     C                     Z-ADDWDANC7    WUANC7           A/R Customer Nu
     C                     Z-ADDWDA1NB    WUA1NB           A/R Balance Yea
     C                     Z-ADD*ZERO     WN0004           Month
     C                     Z-ADD*ZERO     WN0003           Bal Avg Days to
      * Rtv YTD/Last YR Inv $ RT - A/R Summary  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
     C                     ADD  WDB4DY    WN0003           Bal Avg Days to
     C                     ADD  1         WN0004           Month
     C                     END                             *FI
     C           KRSSE     READE@LDCPOU                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Parent / Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWUANC7    WEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEAYTX    WUAYTX           Customer Name
     C                     Z-ADDWEBTC7    WUBTC7           Parent Customer
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV AR Cust Pnd & Dllr RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCDWG           USR Weight Accu
     C                     Z-ADD*ZERO     WUEBVL           USR Billing Dtl
     C                     Z-ADDWUJEDT    WUBDDT           USR From Date
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFANC7    WQSG02           A/R Customer Nu
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           A/R Customer Nu
     C                     KFLD           WFGNDT           Actual Shipped
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           A/R Customer Nu
      * Setup key
     C                     Z-ADDWDAIC3    WQSG01           Company Number
     C                     Z-ADDWUANC7    WQSG02           A/R Customer Nu
     C                     Z-ADDWUJEDT    WFGNDT           Actual Shipped
      * Establish starting position
     C           KPSSG     SETLL@HSTPQF                    *
     C           KRSSG     READE@HSTPQF                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Billing Type       RT - Order Types  * 
     C                     EXSR SHRVGN
      * Edit for date range and continue if valid
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Actual Shipped Date LT WRK.USR From Date
      *   |- c2    : DB1.Actual Shipped Date GT PAR.USR To Date
      *   '-
     C           WFGNDT    IFLT WUBDDT                     *IF
     C           WFGNDT    ORGT WUJFDT                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWFUSVA    WUUSVA           FOB Gross Amoun
     C                     Z-ADDWFBYWG    WUBYWG           Weight Billed
      * FOB amount and weight
      * CASE: WRK.Billing Activity Type is Invoice
     C           WUOBST    IFEQ '1'                        *IF
      * CASE: DB1.Affect Sales Doll Status is no
     C           WFANST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WUUSVA           FOB Gross Amoun
     C                     END                             *FI
      * CASE: DB1.Affect Sales Pnds Status is no
     C           WFVAST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WUBYWG           Weight Billed
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Credit or Debit Memo
      * CASE: PAR.USR Sales Realiz. Flag is Process by Flags
     C           'N'       IFEQ 'P'                        *IF
      * CASE: DB1.Affect Sales Doll Status is no
     C           WFANST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WUUSVA           FOB Gross Amoun
     C                     END                             *FI
      * CASE: DB1.Affect Sales Pnds Status is no
     C           WFVAST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WUBYWG           Weight Billed
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.USR Sales Realiz. Flag is All
     C           'N'       IFEQ 'A'                        *IF
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Affect Sales Doll Status is no
      *   |- c2    : DB1.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WFANST    IFEQ 'N'                        *IF
     C           WFVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     WUUSVA           FOB Gross Amoun
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Affect Sales Pnds Status is no
      *   |- c2    : DB1.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WFVAST    IFEQ 'N'                        *IF
     C           WFANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     WUBYWG           Weight Billed
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.USR Sales Realiz. Flag is None
     C           'N'       IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WUUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WUBYWG           Weight Billed
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If credit memo weight is greater than zero, reverse the sign
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Weight Billed is Greater than zero
      *   |- c2    : WRK.Billing Activity Type is Credit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBYWG    IFGT *ZERO                      *IF
     C           WUOBST    IFEQ '2'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  WUBYWG    WUBYWG           Weight Billed
     C                     END                             *FI
     C           WFTBNB    DIV  100       WUBHPC    H      USR Percent Wor
     C           WUBHPC    MULT WUBYWG    WUDLVA    H      USR Freight Amo
     C                     Z-ADDWUUSVA    WUL8VA           Billing Detail
     C                     ADD  WUL8VA    WUEBVL           USR Billing Dtl
     C                     ADD  WUBYWG    WUCDWG           USR Weight Accu
     C                     END                             *FI
     C           KRSSG     READE@HSTPQF                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGJNCD           Order Type - Sa
      * Setup key
     C                     MOVELWFJNCD    WGJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSH     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGOBST    WUOBST           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt A/R Summary DSO Wk CR - A/R Summary DSO Workfile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ANCPF5
     C                     Z-ADDWDAIC3    WHAIC3           Company Number
     C                     Z-ADDWUANC7    WHANC7           A/R Customer Nu
     C                     Z-ADDWUA1NB    WHTGNX           DSO Year Key
     C                     MOVELWUAYTX    WHAYTX           Customer Name
     C                     Z-ADDWUBTC7    WHBTC7           Parent Customer
     C                     Z-ADDWUEBVL    WHEBVL           DSO Sales Invoi
     C                     Z-ADDWN0003    WHMUNX           DSO Avg Days to
     C                     Z-ADD*ZERO     WHSTNX           DSO Month 1
     C                     Z-ADD*ZERO     WHSSNX           DSO Days 1
     C                     Z-ADD*ZERO     WHSUNX           DSO Month 2
     C                     Z-ADD*ZERO     WHSVNX           DSO Days 2
     C                     Z-ADD*ZERO     WHSWNX           DSO Month 3
     C                     Z-ADD*ZERO     WHSXNX           DSO Days 3
     C                     Z-ADD*ZERO     WHSYNX           DSO Month 4
     C                     Z-ADD*ZERO     WHSZNX           DSO Days 4
     C                     Z-ADD*ZERO     WHS0NX           DSO Month 5
     C                     Z-ADD*ZERO     WHS1NX           DSO Days 5
     C                     Z-ADD*ZERO     WHS2NX           DSO Month 6
     C                     Z-ADD*ZERO     WHS3NX           DSO Days 6
     C                     Z-ADD*ZERO     WHS4NX           DSO Month 7
     C                     Z-ADD*ZERO     WHS5NX           DSO Days 7
     C                     Z-ADD*ZERO     WHS6NX           DSO Month 8
     C                     Z-ADD*ZERO     WHS7NX           DSO Days 8
     C                     Z-ADD*ZERO     WHS8NX           DSO Month 9
     C                     Z-ADD*ZERO     WHS9NX           DSO Days 9
     C                     Z-ADD*ZERO     WHTANX           DSO Month 10
     C                     Z-ADD*ZERO     WHTBNX           DSO Days 10
     C                     Z-ADD*ZERO     WHTFNX           DSO Month 11
     C                     Z-ADD*ZERO     WHTCNX           DSO Days 11
     C                     Z-ADD*ZERO     WHTDNX           DSO Month 12
     C                     Z-ADD*ZERO     WHTENX           DSO Days 12
      *
     C           KLCRSI    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHANC7           A/R Customer Nu
     C                     KFLD           WHTGNX           DSO Year Key
      * Check for duplicate primary key
     C           KLCRSI    SETLL@ANCPF5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2972' W0RTN   7
      * Send message 'WF A/R Summary DSO     EX'
     C                     MOVEL'USR2972' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@ANCPF5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv YTD/Last YR Inv $ RT - A/R Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WUVQVA           Last Year Sales
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIANC7    WQSJ01           A/R Customer Nu
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           A/R Customer Nu
      * Setup key
     C                     Z-ADDWDANC7    WQSJ01           A/R Customer Nu
      * Establish starting position
     C           KRSSJ     SETLL@BCREEC                    *
     C           KRSSJ     READE@BCREEC                  90*
      * Data record not found
     C   90                MOVEL'USR0172' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WIVPVA    WUVPVA           YTD Sales Invoi
     C                     ADD  WIVQVA    WUVQVA           Last Year Sales
     C           KRSSJ     READE@BCREEC                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WANLNB           Entity Number
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDA1NB           A/R Balance Yea
     C                     Z-ADD*ZERO     WDY4NB           A/R Balance Mon
     C                     Z-ADD*ZERO     WDALVA           Amount of Highe
     C                     Z-ADD*ZERO     WDAIDT           Date of Highest
     C                     Z-ADD*ZERO     WDY5VA           Beginning Balan
     C                     Z-ADD*ZERO     WDZAVA           A/R Balance Val
     C                     Z-ADD*ZERO     WDY7VA           A/R Balance Val
     C                     Z-ADD*ZERO     WDY8VA           A/R Balance Val
     C                     Z-ADD*ZERO     WDY9VA           A/R Balance Val
     C                     Z-ADD*ZERO     WDRTNX           Bal Nbr of Orde
     C                     Z-ADD*ZERO     WDRUNX           Bal Nbr of Cred
     C                     Z-ADD*ZERO     WDRVNX           Bal Nbr of Paym
     C                     Z-ADD*ZERO     WDRWNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WDRXNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WDB4DY           Bal Avg Days to
     C                     Z-ADD*ZERO     WDBSDY           Days to Pay
     C                     Z-ADD*ZERO     WDK2DT           Unused Load Dat
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Current Year  USR
     C                     Z-ADD*ZERO     WUI0NX  40
      * Define work field YEAR 1 USR
     C                     Z-ADD*ZERO     WUSINX  40
      * Define work field YEAR 2 USR
     C                     Z-ADD*ZERO     WUSJNX  40
      * Define work field Year  NBR USR
     C                     Z-ADD*ZERO     WUI8NX  20
      * Define work field Year  (Char) USR
     C                     MOVEL*BLANK    WUT4TX  2
      * Define work field Date (Char-6) USR
     C                     MOVEL*BLANK    WUT7TX  6
      * Define work field Date (Alpha) USR
     C                     MOVEL*BLANK    WUR4TX  7
      * Define work field Date From             USR
     C                     Z-ADD*ZERO     WUJEDT  70
      * Define work field Date To               USR
     C                     Z-ADD*ZERO     WUJFDT  70
      * Define work field A/R Customer Number
     C                     Z-ADD*ZERO     WUANC7  70
      * Define work field A/R Balance Year
     C                     Z-ADD*ZERO     WUA1NB  40
      * Define work field Customer Name
     C                     MOVEL*BLANK    WUAYTX 30
      * Define work field Parent Customer
     C                     Z-ADD*ZERO     WUBTC7  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEP3NB           D & B Number
     C                     Z-ADD*ZERO     WEI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WEAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WES2NB           Parent Credit L
     C                     Z-ADD*ZERO     WEVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WEI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field DSO Sales Invoiced
     C                     Z-ADD*ZERO     WUEBVL 112
      * Define work field YTD Sales Invoiced
     C                     Z-ADD*ZERO     WUVPVA 112
      * Define work field Last Year Sales Invoiced
     C                     Z-ADD*ZERO     WUVQVA 112
      * Define work field USR Weight Accumulated
     C                     Z-ADD*ZERO     WUCDWG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFBTC7           Parent Customer
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFA0DT           Order Date
     C                     Z-ADD*ZERO     WFACDT           Cancel Date
     C                     Z-ADD*ZERO     WFTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WFATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WFT3NB           Attach to Order
     C                     Z-ADD*ZERO     WFRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WFORIT           Original Item
     C                     Z-ADD*ZERO     WFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WFAKPR           Unit Price
     C                     Z-ADD*ZERO     WFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFAWDT           Invoice Date
     C                     Z-ADD*ZERO     WFHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAQCS           Unit Cost Order
     C                     Z-ADD*ZERO     WFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFL6NB           Contract Number
     C                     Z-ADD*ZERO     WFHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WFESNB           Accounting Year
     C                     Z-ADD*ZERO     WFETNB           Accounting Peri
     C                     Z-ADD*ZERO     WFBZNB           OM Week
     C                     Z-ADD*ZERO     WFEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WFBYWG           Weight Billed
     C                     Z-ADD*ZERO     WFS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WFMAVA           Billing Detail
     C                     Z-ADD*ZERO     WFKDVA           Billing Detail
     C                     Z-ADD*ZERO     WFUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WFUTVA           Standard Overag
     C                     Z-ADD*ZERO     WFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WFCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WFR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WFBZPR           Price Overage O
     C                     Z-ADD*ZERO     WFEXDT           Market Pricing
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WFSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WFSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WFONVA           Actual Freight
     C                     Z-ADD*ZERO     WFB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WFB5NB           PM Line Number
     C                     Z-ADD*ZERO     WFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WFULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WFUNVA           Trade Fund Accr
     C                     Z-ADD*ZERO     WFUOVA           Commission Amou
     C                     Z-ADD*ZERO     WFUPVA           Financials Amou
     C                     Z-ADD*ZERO     WFUQVA           Financials Amou
     C                     Z-ADD*ZERO     WFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WFIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WFIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WFNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WFBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WFZ4NB           MPC Number
     C                     Z-ADD*ZERO     WFOCFR           Ocean Freight
     C                     Z-ADD*ZERO     WFC0C7           Claim Number
     C                     Z-ADD*ZERO     WFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WFA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WFCDPR           Market Value
     C                     Z-ADD*ZERO     WFD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WFD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WFCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WFOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WFD9PR           SBD Accrual Amo
     C                     Z-ADD*ZERO     WFCFVL           HST Item Target
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field USR From Date
     C                     Z-ADD*ZERO     WUBDDT  70
      * Define work field Billing Activity Type
     C                     MOVEL*BLANK    WUOBST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field FOB Gross Amount
     C                     Z-ADD*ZERO     WUUSVA 112
      * Define work field Weight Billed
     C                     Z-ADD*ZERO     WUBYWG 112
      * Define work field USR Percent Work, 7.4
     C                     Z-ADD*ZERO     WUBHPC  74
      * Define work field USR Freight Amount 1
     C                     Z-ADD*ZERO     WUDLVA 112
      * Define work field Billing Detail Net Dol.
     C                     Z-ADD*ZERO     WUL8VA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WHTGNX           DSO Year Key
     C                     Z-ADD*ZERO     WHBTC7           Parent Customer
     C                     Z-ADD*ZERO     WHEBVL           DSO Sales Invoi
     C                     Z-ADD*ZERO     WHMUNX           DSO Avg Days to
     C                     Z-ADD*ZERO     WHSTNX           DSO Month 1
     C                     Z-ADD*ZERO     WHSSNX           DSO Days 1
     C                     Z-ADD*ZERO     WHSUNX           DSO Month 2
     C                     Z-ADD*ZERO     WHSVNX           DSO Days 2
     C                     Z-ADD*ZERO     WHSWNX           DSO Month 3
     C                     Z-ADD*ZERO     WHSXNX           DSO Days 3
     C                     Z-ADD*ZERO     WHSYNX           DSO Month 4
     C                     Z-ADD*ZERO     WHSZNX           DSO Days 4
     C                     Z-ADD*ZERO     WHS0NX           DSO Month 5
     C                     Z-ADD*ZERO     WHS1NX           DSO Days 5
     C                     Z-ADD*ZERO     WHS2NX           DSO Month 6
     C                     Z-ADD*ZERO     WHS3NX           DSO Days 6
     C                     Z-ADD*ZERO     WHS4NX           DSO Month 7
     C                     Z-ADD*ZERO     WHS5NX           DSO Days 7
     C                     Z-ADD*ZERO     WHS6NX           DSO Month 8
     C                     Z-ADD*ZERO     WHS7NX           DSO Days 8
     C                     Z-ADD*ZERO     WHS8NX           DSO Month 9
     C                     Z-ADD*ZERO     WHS9NX           DSO Days 9
     C                     Z-ADD*ZERO     WHTANX           DSO Month 10
     C                     Z-ADD*ZERO     WHTBNX           DSO Days 10
     C                     Z-ADD*ZERO     WHTFNX           DSO Month 11
     C                     Z-ADD*ZERO     WHTCNX           DSO Days 11
     C                     Z-ADD*ZERO     WHTDNX           DSO Month 12
     C                     Z-ADD*ZERO     WHTENX           DSO Days 12
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WIAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WIACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WIADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WIAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WIAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WIAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WIVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WIVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WIVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WIVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WIVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WIVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WIEEVA           Value of Open O
     C                     Z-ADD*ZERO     WIAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WIAHDT           Date of First S
     C                     Z-ADD*ZERO     WIANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WIANVA           Amount of Last
     C                     Z-ADD*ZERO     WIALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WIAMVA           Amount of Last
     C                     Z-ADD*ZERO     WIAIDT           Date of Highest
     C                     Z-ADD*ZERO     WIALVA           Amount of Highe
     C                     Z-ADD*ZERO     WIDJNB           Number of Invoi
     C                     Z-ADD*ZERO     WIDLNB           Number of Order
     C                     Z-ADD*ZERO     WIDDNB           Number of Credi
     C                     Z-ADD*ZERO     WIDMNB           Number of Payme
     C                     Z-ADD*ZERO     WIDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WILYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WILYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WILYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WILYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WIADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WIVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WIBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WIBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WIVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WIVQVA           Last Year Sales
     C                     Z-ADD*ZERO     WICUMO           Current Month
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  3
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0001  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Allow Multi-Company
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0004 10
      *================================================================
     CSR         ZZEXIT    ENDSR
