// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWL9D1R
// ?Date: 14.08.2025 Time: 02:56:54
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?Modification history
DO;

//? 5/6/2021 JBB SDD619 - Repayments by Business Users
//?                       Function created.  Display values in the
//?                       Tattoo Repayment Header record.
ENDDO;

//?USER: Load detail screen from DBF record

//?Load Repayment Status description
CASE;

// IF DTL.TRH Repayment Status is Cancelled
IF DTL.TRH_Repayment_Status = 'X';

// DTL.Repay Status Description = CON.Cancelled
DTL.Repay_Status_Description = 'Cancelled';

//?Load Repayment Status description
// IF DTL.TRH Repayment Status is Created
IF DTL.TRH_Repayment_Status = 'C';

// DTL.Repay Status Description = CON.Created
DTL.Repay_Status_Description = 'Created';

//?Load Repayment Status description
// IF DTL.TRH Repayment Status is In Progress
IF DTL.TRH_Repayment_Status = 'I';

// DTL.Repay Status Description = CON.In progress
DTL.Repay_Status_Description = 'In progress';

//?Load Repayment Status description
// IF *OTHERWISE
IF *OTHERWISE;

// DTL.Repay Status Description = CON.Repaid
DTL.Repay_Status_Description = 'Repaid';

ENDIF;

// DTL.Number 2 USR = DTL.TRH Payment Step
DTL.Number_2_USR = DTL.TRH_Payment_Step;

EXECUTE FUNCTION(Chk if Comments Exist RT) TYPE(RTVOBJ) FILE(PWAYCPP)           AB1366394;
PARAMETER(DB1.CC_Company_Number);
PARAMETER(DB1.TRH_Repayment_ID);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

 QUIT;

}


//?Determine Comments Exist text
CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// DTL.Yes/No Text 3 = CON.Yes
DTL.Yes_No_Text_3 = 'Yes';

//?Determine Comments Exist text
// IF *OTHERWISE
IF *OTHERWISE;

// DTL.Yes/No Text 3 = CON.No
DTL.Yes_No_Text_3 = 'No';

ENDIF;

//?USER: Process command keys

//?F7=Display Comments
CASE;

// IF DTL.*CMD key is CF07
IF DTL.*CMD_key = '07';

// Call program Dsp Tattoo Repay Cmnt DF.
CALL PROGRAM(Dsp Tattoo Repay Cmnt DF) ('PWMGDFR');
PARAMETER(DTL.CC_Company_Number);
PARAMETER(DTL.TRH_Repayment_ID);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);

ENDIF;

