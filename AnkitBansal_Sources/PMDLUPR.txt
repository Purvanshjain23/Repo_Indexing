/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  EXECUTE MISC TARE BATCH UPDATE AND                */
/*              RUN SEQUELS WITH PKG BOM AND WEIGHTS             */
/*                                                                  */
/*                                                                  */
/*  SYSTEM    - INVENTORY MANAGEMENT                                */
/*  PROGRAM   - PMDLUPR                                             */
/*  DATE      - 01/20/09                                            */
/*                                                                  */
/*      PARAMETERS:                                                 */
/*                                                                  */
/*     O    &RETURN     - RETURN CODE                               */
/*     B    &COMP    - COMPANY NUMBER (PASSED TO SQL)            */
/********************************************************************/
/*  RMC 1/30/2009 MAKE DIST LIST COMPANY SPECIFIC FOR SEQUELS BY USING +
/*                COMPANY VALUE PKGCHGCO  SET UP FOR EACH PLANT  */

/*  JBB 2/16/2017 ADD COMPANY 440 PROCESSING SIMILAR TO COMPANY 960 */
/*                E9064                                             */
/*  RMC 7/14/2021 COMPANY IS IN THE PARM SO RUN SQLS PER COMPANY PARM  */
/*                -- NOT ALL COMPANIES EVERY TIME                   */
/********************************************************************/

 PMDLUPR:    PGM        PARM(&RETURN &COMP)

/* PARMS                                                                      */
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7) /* RTN CODE */
             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0) /* Company  */
             DCL        VAR(&DIST) TYPE(*CHAR) LEN(10) /* DIST LIST*/
             DCL        VAR(&VALUE) TYPE(*CHAR) LEN(10) +
                          VALUE(PKGCHGCO) /* COMP VALU*/
/********************************************************************/
/*   MONITOR FOR ALL MESSAGES AT PROGRAM LEVEL                      */
/********************************************************************/

             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))
/********************************************************************/
/*   CALL BATCH UPDATE                                              */
/********************************************************************/

             CALL PGM(PMS5XFR) PARM('' &COMP)

/********************************************************************/
/*   GET DIST LIST FROM INPUT COMPANY VALUE: PKGCHGCO               */
/********************************************************************/
             CALL       PGM(POMTXFR) PARM('' &COMP &VALUE &DIST)
             IF         COND(&DIST *EQ ' ') THEN(CHGVAR VAR(&DIST) +
                          VALUE(PRKDEV2))

/********************************************************************/
/*   RUN SEQUEL                                                     */
/********************************************************************/
             IF         COND(&COMP *EQ 360) THEN(DO)
             EXECUTE    VIEW(PKGBOM_TAR) PCFMT(*XLS) +
                          RECIPIENT(&DIST) EMLMSG('Packaging BOM +
                          for 360') SETVAR((&COMP 360))
                          GOTO END
                          ENDDO

             IF         COND(&COMP *EQ 440) THEN(DO)
             EXECUTE    VIEW(PKGBOM_TAR) PCFMT(*XLS) RECIPIENT(&DIST) +
                          EMLMSG('Packaging BOM FOR 440') SETVAR((&COMP 440))
                          GOTO END
                          ENDDO

             IF         COND(&COMP *EQ 960) THEN(DO)
             EXECUTE    VIEW(PKGBOM_TAR) PCFMT(*XLS) RECIPIENT(&DIST) +
                          EMLMSG('Packaging BOM FOR 960') SETVAR((&COMP 960))
                          GOTO END
                          ENDDO
/********************************************************************/
MSGTRAP:
             SNDMSG     MSG('Request Failed. Please contact IT.') +
                          TOUSR(*REQUESTER)
 END:        ENDPGM
