     H/TITLE Edt Tattoo Hdr/Defect  ER Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 03/23/21  Time  : 08:52:08
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKKIE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt Tattoo Hdr/Defect  ER Edit record(1 screen)
      *
     FPKA1CPL0IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Tattoo Header             Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPLATREL1IF  E           K        DISK
      * RTV : Producer Site             Retrieval index
      *
     FPKEJCPL2IF  E           K        DISK
      * RSQ : Buy Order Load Weight     Co/BOL
      *
     FPKDZREL1IF  E           K        DISK
      * RTV : Tattoo Defect             Retrieval index
      *
     FPKA8REL5IF  E           K        DISK
      * RSQ : Hog Classification        Hog Class Type 'R'esale
      *
     FPKA8REL4IF  E           K        DISK
      * RSQ : Hog Classification        Hog Class Type Qualified
      *
     FPLAECPL2IF  E           K        DISK
      * RSQ : Delivery Sched Detail     BOH Co/BO/BOL/Kill Dt
      *
     FPLAFCPL2IF  E           K        DISK
      * RSQ : Delivery Tracking         BOH CO/BO/BOL/KillDt
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKA2CPL1IF  E           K        DISK
      * RTV : Tattoo Detail             Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPLASREL1IF  E           K        DISK
      * RTV : Producer Site Mileage     Retrieval index
      *
     FPLA8REL1IF  E           K        DISK
      * RTV : Producer Subsidiary       Retrieval index
      *
     FPKA7REL2IF  E           K        DISK
      * RSQ : Hog Defect                Active Hog Defects
      *
     FPKA3REL5IF  E           K        DISK
      * RSQ : Pen                       Co/Pen/Open
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKCCREL0IF  E           K        DISK
      * RTV : Tattoo Header Process     Retrieval index
      *
     FPKADREL0IF  E           K        DISK
      * RTV : Hog Buyer                 Retrieval index
      *
     FPKAIREL0IF  E           K        DISK
      * RTV : Genetic                   Retrieval index
      *
     FPKFJCPL4IF  E           K        DISK
      * RSQ : Tattoo Pending            Co/Tattoo/BOL
      *
     FPKA1CPLAIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Kill/Tattoo Active
      *
     FPKA2CPL8IF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Pen
      *
     FPKA3REL1IF  E           K        DISK
      * RTV : Pen                       Retrieval index
      *
     FPKA2CPLCIF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Bo/Ld/TTT/KillDt/Pen
      *
     FPLAOREL1IF  E           K        DISK
      * RTV : Producer EXT              Retrieval index
      *
     FPLAECPLFIF  E           K        DISK
      * RSQ : Delivery Sched Detail     Co/bol/Kdt/Sdate/Tim/Seq
      *
     FPKA1CPLFIF  E           K        DISK
      * RSQ : Tattoo Header             Co/BOL/Kill/Ttt
      *
     FPLB4REL1IF  E           K        DISK
      * RTV : Producer EXT2             Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKFJCPL0UF  E           K        DISK
      * UPD : Tattoo Pending            Update index
      *
     FPKA3REL0UF  E           K        DISK
      * UPD : Pen                       Update index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
     FPKAWCPL0UF  E           K        DISK
      * UPD : Buy Order Header          Update index
      *
     FPLAECPL1UF  E           K        DISK
      * UPD : Delivery Sched Detail     Update index
      *
     FPKA1CPL1UF  E           K        DISK                      A
      * UPD : Tattoo Header             Update index
      *
     FPKDZREL0UF  E           K        DISK                      A
      * UPD : Tattoo Defect             Update index
      *
     FPLAFCPL0UF  E           K        DISK
      * UPD : Delivery Tracking         Update index
      *
     FPKDNCPL0UF  E           K        DISK                      A
      * UPD : Tattoo Header EXT         Update index
      *
     FPKA2CPL0UF  E           K        DISK
      * UPD : Tattoo Detail             Update index
      *
      * KEY Screen: Field position and name array
     E                    W0BEG   5 005  5 0A
     E                    W0END   5 005  5 0A
     E                    W0NAM   5 005 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 070  5 0A
     E                    W1END   7 070  5 0A
     E                    W1NAM   7 070 10
      * Long constants
     E                    @CN#    1  05  6   @CN    25
     I@A8RESC
      * Hog Classification        Hog Class Type Qualified
      * Renamed input format fields
     I              A8BECD                          WABECD
     I              A8BDTX                          WABDTX
     I              A8BXST                          WABXST
     I              A8BYST                          WABYST
     I              A8BITX                          WABITX
     I              A8B0ST                          WAB0ST
     I              A8FBST                          WAFBST
     I              A8AAVN                          WAAAVN
     I              A8AADT                          WAAADT
     I              A8AMTM                          WAAMTM
     I              A8AJST                          WAAJST
     I              A8AHVN                          WAAHVN
     I              A8AGVN                          WAAGVN
     I              A8ABVN                          WAABVN
     I              A8ABDT                          WAABDT
     I              A8ABTM                          WAABTM
      *
     I@A8REDA
      * Hog Classification        Retrieval index
      * Renamed input format fields
     I              A8BECD                          WBBECD
     I              A8BDTX                          WBBDTX
     I              A8BXST                          WBBXST
     I              A8BYST                          WBBYST
     I              A8BITX                          WBBITX
     I              A8B0ST                          WBB0ST
     I              A8FBST                          WBFBST
     I              A8AAVN                          WBAAVN
     I              A8AADT                          WBAADT
     I              A8AMTM                          WBAMTM
     I              A8AJST                          WBAJST
     I              A8AHVN                          WBAHVN
     I              A8AGVN                          WBAGVN
     I              A8ABVN                          WBABVN
     I              A8ABDT                          WBABDT
     I              A8ABTM                          WBABTM
      *
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WCABCD
     I              AFAECD                          WCAECD
     I              AFA8TX                          WCA8TX
     I              AFGLNB                          WCGLNB
     I              AFATST                          WCATST
     I              AFASNB                          WCASNB
     I              AFAUST                          WCAUST
     I              AFQNST                          WCQNST
     I              AFQOST                          WCQOST
     I              AFQPST                          WCQPST
     I              AFQQST                          WCQQST
     I              AFQRST                          WCQRST
     I              AFN0TX                          WCN0TX
     I              AFQSST                          WCQSST
     I              AFQTST                          WCQTST
     I              AFQUST                          WCQUST
     I              AFQVST                          WCQVST
     I              AFR8ST                          WCR8ST
     I              AFR9ST                          WCR9ST
     I              AFSAST                          WCSAST
     I              AFSBST                          WCSBST
     I              AFSDST                          WCSDST
     I              AFSEST                          WCSEST
     I              AFSFST                          WCSFST
     I              AFHWNB                          WCHWNB
     I              AFFUCD                          WCFUCD
     I              AFAAVN                          WCAAVN
     I              AFAADT                          WCAADT
     I              AFAMTM                          WCAMTM
     I              AFAJST                          WCAJST
     I              AFAHVN                          WCAHVN
     I              AFAGVN                          WCAGVN
     I              AFABVN                          WCABVN
     I              AFABDT                          WCABDT
     I              AFABTM                          WCABTM
      *
     I@A8REPM
      * Producer Subsidiary       Retrieval index
      * Renamed input format fields
     I              A8ABCD                          WDABCD
     I              A8OVCD                          WDOVCD
     I              A8V2TX                          WDV2TX
     I              A8DCSS                          WDDCSS
     I              A8DDSS                          WDDDSS
     I              A8DESS                          WDDESS
     I              A8SKA1                          WDSKA1
     I              A8SLA1                          WDSLA1
     I              A8SMA1                          WDSMA1
     I              A8AAVN                          WDAAVN
     I              A8AADT                          WDAADT
     I              A8AMTM                          WDAMTM
     I              A8AJST                          WDAJST
     I              A8AHVN                          WDAHVN
     I              A8AGVN                          WDAGVN
     I              A8ABVN                          WDABVN
     I              A8ABDT                          WDABDT
     I              A8ABTM                          WDABTM
      *
     I@A7REMM
      * Hog Defect                Active Hog Defects
      * Renamed input format fields
     I              A7BDCD                          WEBDCD
     I              A7BCTX                          WEBCTX
     I              A7RXST                          WERXST
     I              A7R2ST                          WER2ST
     I              A7RYST                          WERYST
     I              A7RZST                          WERZST
     I              A7R0ST                          WER0ST
     I              A7R1ST                          WER1ST
     I              A7HYCD                          WEHYCD
     I              A7HZCD                          WEHZCD
     I              A7VYST                          WEVYST
     I              A7AEA1                          WEAEA1
     I              A7UOPR                          WEUOPR
     I              A7UPPR                          WEUPPR
     I              A7UQPR                          WEUQPR
     I              A7AAVN                          WEAAVN
     I              A7AADT                          WEAADT
     I              A7AMTM                          WEAMTM
     I              A7AJST                          WEAJST
     I              A7AHVN                          WEAHVN
     I              A7AGVN                          WEAGVN
     I              A7ABVN                          WEABVN
     I              A7ABDT                          WEABDT
     I              A7ABTM                          WEABTM
      *
     I@FJCPHV
      * Tattoo Pending            Update index
      * Renamed input format fields
     I              FJHONB                          WFHONB
     I              FJEZDT                          WFEZDT
     I              FJHSA1                          WFHSA1
     I              FJHMNB                          WFHMNB
     I              FJBNNB                          WFBNNB
     I              FJBONB                          WFBONB
     I              FJHRA1                          WFHRA1
     I              FJBKTM                          WFBKTM
     I              FJWPST                          WFWPST
     I              FJWQST                          WFWQST
     I              FJMIA1                          WFMIA1
     I              FJAAVN                          WFAAVN
     I              FJAADT                          WFAADT
     I              FJAMTM                          WFAMTM
     I              FJAJST                          WFAJST
     I              FJAHVN                          WFAHVN
     I              FJAGVN                          WFAGVN
     I              FJABVN                          WFABVN
     I              FJABDT                          WFABDT
     I              FJABTM                          WFABTM
      *
     I@A1CPL0
      * Tattoo Header             Co/Kill/Tattoo Active
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     I@A2CPKE
      * Tattoo Detail             Co/Pen
      * Renamed input format fields
     I              A2HMNB                          WHHMNB
     I              A2BNNB                          WHBNNB
     I              A2BONB                          WHBONB
     I              A2CVNB                          WHCVNB
     I              A2B0DT                          WHB0DT
     I              A2C2NB                          WHC2NB
     I              A2CZNB                          WHCZNB
     I              A2C0NB                          WHC0NB
     I              A2D8NB                          WHD8NB
     I              A2H7NB                          WHH7NB
     I              A2GGST                          WHGGST
     I              A2AJTM                          WHAJTM
     I              A2JEA1                          WHJEA1
     I              A2B7CD                          WHB7CD
     I              A2D7NB                          WHD7NB
     I              A2D9ST                          WHD9ST
     I              A2E3ST                          WHE3ST
     I              A2E4ST                          WHE4ST
     I              A2E5ST                          WHE5ST
     I              A2BVDT                          WHBVDT
     I              A2BWDT                          WHBWDT
     I              A2BXDT                          WHBXDT
     I              A2HVNB                          WHHVNB
     I              A2CMCD                          WHCMCD
     I              A2B9CD                          WHB9CD
     I              A2H8NB                          WHH8NB
     I              A2CYCD                          WHCYCD
     I              A2AAVN                          WHAAVN
     I              A2AADT                          WHAADT
     I              A2AMTM                          WHAMTM
     I              A2AJST                          WHAJST
     I              A2AHVN                          WHAHVN
     I              A2AGVN                          WHAGVN
     I              A2ABVN                          WHABVN
     I              A2ABDT                          WHABDT
     I              A2ABTM                          WHABTM
      *
     I@A3REDD
      * Pen                       Retrieval index
      * Renamed input format fields
     I              A3HVNB                          WIHVNB
     I              A3CMCD                          WICMCD
     I              A3BBTX                          WIBBTX
     I              A3CTNB                          WICTNB
     I              A3D6NB                          WID6NB
     I              A3B6CD                          WIB6CD
     I              A3DGST                          WIDGST
     I              A3EBNB                          WIEBNB
     I              A3FWST                          WIFWST
     I              A3HBNB                          WIHBNB
     I              A3AGCD                          WIAGCD
     I              A3AAVN                          WIAAVN
     I              A3AADT                          WIAADT
     I              A3AMTM                          WIAMTM
     I              A3AJST                          WIAJST
     I              A3AHVN                          WIAHVN
     I              A3AGVN                          WIAGVN
     I              A3ABVN                          WIABVN
     I              A3ABDT                          WIABDT
     I              A3ABTM                          WIABTM
      *
     I@A3REDC
      * Pen                       Update index
      * Renamed input format fields
     I              A3HVNB                          WJHVNB
     I              A3CMCD                          WJCMCD
     I              A3BBTX                          WJBBTX
     I              A3CTNB                          WJCTNB
     I              A3D6NB                          WJD6NB
     I              A3B6CD                          WJB6CD
     I              A3DGST                          WJDGST
     I              A3EBNB                          WJEBNB
     I              A3FWST                          WJFWST
     I              A3HBNB                          WJHBNB
     I              A3AGCD                          WJAGCD
     I              A3AAVN                          WJAAVN
     I              A3AADT                          WJAADT
     I              A3AMTM                          WJAMTM
     I              A3AJST                          WJAJST
     I              A3AHVN                          WJAHVN
     I              A3AGVN                          WJAGVN
     I              A3ABVN                          WJABVN
     I              A3ABDT                          WJABDT
     I              A3ABTM                          WJABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WKHMNB
     I              AXBNNB                          WKBNNB
     I              AXBONB                          WKBONB
     I              AXCQDT                          WKCQDT
     I              AXABTH                          WKABTH
     I              AXACTH                          WKACTH
     I              AXBPNB                          WKBPNB
     I              AXCSNB                          WKCSNB
     I              AXAUDT                          WKAUDT
     I              AXCMST                          WKCMST
     I              AXAGPR                          WKAGPR
     I              AXATVA                          WKATVA
     I              AXI1ST                          WKI1ST
     I              AXDHNB                          WKDHNB
     I              AXDINB                          WKDINB
     I              AXCNST                          WKCNST
     I              AXGINB                          WKGINB
     I              AXBZDT                          WKBZDT
     I              AXLSNB                          WKLSNB
     I              AXF3TX                          WKF3TX
     I              AXO8ST                          WKO8ST
     I              AXO9ST                          WKO9ST
     I              AXPAST                          WKPAST
     I              AXLDSH                          WKLDSH
     I              AXPBST                          WKPBST
     I              AXPCST                          WKPCST
     I              AXPDST                          WKPDST
     I              AXUWST                          WKUWST
     I              AXUXST                          WKUXST
     I              AXUYST                          WKUYST
     I              AXJKRU                          WKJKRU
     I              AXKEOR                          WKKEOR
     I              AXIOEW                          WKIOEW
     I              AXKJIO                          WKKJIO
     I              AXIOJR                          WKIOJR
     I              AXEIRR                          WKEIRR
     I              AXITMF                          WKITMF
     I              AXODJE                          WKODJE
     I              AXRJIF                          WKRJIF
     I              AXOEJF                          WKOEJF
     I              AXD0DT                          WKD0DT
     I              AXD1DT                          WKD1DT
     I              AXD2DT                          WKD2DT
     I              AXD3DT                          WKD3DT
     I              AXD4DT                          WKD4DT
     I              AXBNCD                          WKBNCD
     I              AXABCD                          WKABCD
     I              AXAECD                          WKAECD
     I              AXAAVN                          WKAAVN
     I              AXAADT                          WKAADT
     I              AXAMTM                          WKAMTM
     I              AXAJST                          WKAJST
     I              AXAHVN                          WKAHVN
     I              AXAGVN                          WKAGVN
     I              AXABVN                          WKABVN
     I              AXABDT                          WKABDT
     I              AXABTM                          WKABTM
      *
     I@AWCPAZ
      * Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WLHMNB
     I              AWBNNB                          WLBNNB
     I              AWARDT                          WLARDT
     I              AWASDT                          WLASDT
     I              AWA4ST                          WLA4ST
     I              AWA5ST                          WLA5ST
     I              AWAAPR                          WLAAPR
     I              AWA6ST                          WLA6ST
     I              AWA7ST                          WLA7ST
     I              AWB3ST                          WLB3ST
     I              AWALPR                          WLALPR
     I              AWETCD                          WLETCD
     I              AWEUCD                          WLEUCD
     I              AWJ5TX                          WLJ5TX
     I              AWD5DT                          WLD5DT
     I              AWD6DT                          WLD6DT
     I              AWD7DT                          WLD7DT
     I              AWD8DT                          WLD8DT
     I              AWD9DT                          WLD9DT
     I              AWJOEJ                          WLJOEJ
     I              AWKOFF                          WLKOFF
     I              AWKWPE                          WLKWPE
     I              AWIMBF                          WLIMBF
     I              AWOPTR                          WLOPTR
     I              AWOEJD                          WLOEJD
     I              AWIRMF                          WLIRMF
     I              AWJIRM                          WLJIRM
     I              AWJRKF                          WLJRKF
     I              AWKFIR                          WLKFIR
     I              AWUZST                          WLUZST
     I              AWU0ST                          WLU0ST
     I              AWU1ST                          WLU1ST
     I              AWU2ST                          WLU2ST
     I              AWU3ST                          WLU3ST
     I              AWHXNB                          WLHXNB
     I              AWGANB                          WLGANB
     I              AWGBNB                          WLGBNB
     I              AWABCD                          WLABCD
     I              AWAECD                          WLAECD
     I              AWAKCD                          WLAKCD
     I              AWALCD                          WLALCD
     I              AWAGCD                          WLAGCD
     I              AWAICD                          WLAICD
     I              AWAMCD                          WLAMCD
     I              AWACCD                          WLACCD
     I              AWAAVN                          WLAAVN
     I              AWAADT                          WLAADT
     I              AWAMTM                          WLAMTM
     I              AWAJST                          WLAJST
     I              AWAHVN                          WLAHVN
     I              AWAGVN                          WLAGVN
     I              AWABVN                          WLABVN
     I              AWABDT                          WLABDT
     I              AWABTM                          WLABTM
      *
     I@AECPIH
      * Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WMHONB
     I              AEE0DT                          WME0DT
     I              AEE6DT                          WME6DT
     I              AEAGTH                          WMAGTH
     I              AEHZA1                          WMHZA1
     I              AEH0A1                          WMH0A1
     I              AEH1A1                          WMH1A1
     I              AEJ4CD                          WMJ4CD
     I              AEJ5CD                          WMJ5CD
     I              AELBCD                          WMLBCD
     I              AELCCD                          WMLCCD
     I              AEIOA1                          WMIOA1
     I              AEH2A1                          WMH2A1
     I              AEIJA1                          WMIJA1
     I              AEK9CD                          WMK9CD
     I              AEK8CD                          WMK8CD
     I              AEJ6CD                          WMJ6CD
     I              AEJ7CD                          WMJ7CD
     I              AEMGCD                          WMMGCD
     I              AEW1ST                          WMW1ST
     I              AEW2ST                          WMW2ST
     I              AEH3A1                          WMH3A1
     I              AEMECD                          WMMECD
     I              AEMFCD                          WMMFCD
     I              AEW4ST                          WMW4ST
     I              AEXWST                          WMXWST
     I              AEFRDT                          WMFRDT
     I              AEBOTH                          WMBOTH
     I              AEE7DT                          WME7DT
     I              AEAHTH                          WMAHTH
     I              AEE8DT                          WME8DT
     I              AEAITH                          WMAITH
     I              AEXBST                          WMXBST
     I              AEXGST                          WMXGST
     I              AEXPST                          WMXPST
     I              AEXNST                          WMXNST
     I              AEXTST                          WMXTST
     I              AEXLST                          WMXLST
     I              AEW0ST                          WMW0ST
     I              AEYEST                          WMYEST
     I              AEFZDT                          WMFZDT
     I              AEB1TH                          WMB1TH
     I              AEAACD                          WMAACD
     I              AEABCD                          WMABCD
     I              AEAECD                          WMAECD
     I              AEHMNB                          WMHMNB
     I              AEBNNB                          WMBNNB
     I              AEBONB                          WMBONB
     I              AEY0A1                          WMY0A1
     I              AEY1A1                          WMY1A1
     I              AEDGT1                          WMDGT1
     I              AEDHT1                          WMDHT1
     I              AEIISS                          WMIISS
     I              AEAAVN                          WMAAVN
     I              AEAADT                          WMAADT
     I              AEAMTM                          WMAMTM
     I              AEAJST                          WMAJST
     I              AEAHVN                          WMAHVN
     I              AEAGVN                          WMAGVN
     I              AEABVN                          WMABVN
     I              AEABDT                          WMABDT
     I              AEABTM                          WMABTM
      *
     I@DZREX2
      * Tattoo Defect             Update index
      * Renamed input format fields
     I              DZHMNB                          WOHMNB
     I              DZBNNB                          WOBNNB
     I              DZBONB                          WOBONB
     I              DZCVNB                          WOCVNB
     I              DZB0DT                          WOB0DT
     I              DZBDCD                          WOBDCD
     I              DZLJNB                          WOLJNB
     I              DZBECD                          WOBECD
     I              DZB7SS                          WOB7SS
     I              DZB8SS                          WOB8SS
     I              DZB9SS                          WOB9SS
     I              DZCASS                          WOCASS
     I              DZNXA1                          WONXA1
     I              DZNYA1                          WONYA1
     I              DZNZA1                          WONZA1
     I              DZAAVN                          WOAAVN
     I              DZAADT                          WOAADT
     I              DZAMTM                          WOAMTM
     I              DZAJST                          WOAJST
     I              DZAHVN                          WOAHVN
     I              DZAGVN                          WOAGVN
     I              DZABVN                          WOABVN
     I              DZABDT                          WOABDT
     I              DZABTM                          WOABTM
      *
     I@AFCPIC
      * Delivery Tracking         Update index
      * Renamed input format fields
     I              AFHONB                          WRHONB
     I              AFE0DT                          WRE0DT
     I              AFE9DT                          WRE9DT
     I              AFAJTH                          WRAJTH
     I              AFH4A1                          WRH4A1
     I              AFFXDT                          WRFXDT
     I              AFJIA1                          WRJIA1
     I              AFIBA1                          WRIBA1
     I              AFW5ST                          WRW5ST
     I              AFICA1                          WRICA1
     I              AFK0CD                          WRK0CD
     I              AFK1CD                          WRK1CD
     I              AFLFCD                          WRLFCD
     I              AFLGCD                          WRLGCD
     I              AFIDA1                          WRIDA1
     I              AFIPA1                          WRIPA1
     I              AFLICD                          WRLICD
     I              AFJ8CD                          WRJ8CD
     I              AFJ9CD                          WRJ9CD
     I              AFMGCD                          WRMGCD
     I              AFXHST                          WRXHST
     I              AFXIST                          WRXIST
     I              AFIEA1                          WRIEA1
     I              AFKBCD                          WRKBCD
     I              AFKZCD                          WRKZCD
     I              AFLHCD                          WRLHCD
     I              AFFADT                          WRFADT
     I              AFAKTH                          WRAKTH
     I              AFBYTH                          WRBYTH
     I              AFW6ST                          WRW6ST
     I              AFXXST                          WRXXST
     I              AFFBDT                          WRFBDT
     I              AFALTH                          WRALTH
     I              AFBVTH                          WRBVTH
     I              AFAMTH                          WRAMTH
     I              AFFCDT                          WRFCDT
     I              AFANTH                          WRANTH
     I              AFBHTH                          WRBHTH
     I              AFFDDT                          WRFDDT
     I              AFAOTH                          WRAOTH
     I              AFBWTH                          WRBWTH
     I              AFAPTH                          WRAPTH
     I              AFFEDT                          WRFEDT
     I              AFAQTH                          WRAQTH
     I              AFARTH                          WRARTH
     I              AFFFDT                          WRFFDT
     I              AFASTH                          WRASTH
     I              AFATTH                          WRATTH
     I              AFFGDT                          WRFGDT
     I              AFAUTH                          WRAUTH
     I              AFFHDT                          WRFHDT
     I              AFAVTH                          WRAVTH
     I              AFAWTH                          WRAWTH
     I              AFBKTH                          WRBKTH
     I              AFBLTH                          WRBLTH
     I              AFXJST                          WRXJST
     I              AFK3CD                          WRK3CD
     I              AFFIDT                          WRFIDT
     I              AFAXTH                          WRAXTH
     I              AFAYTH                          WRAYTH
     I              AFFJDT                          WRFJDT
     I              AFAZTH                          WRAZTH
     I              AFA0TH                          WRA0TH
     I              AFFKDT                          WRFKDT
     I              AFA1TH                          WRA1TH
     I              AFA2TH                          WRA2TH
     I              AFFLDT                          WRFLDT
     I              AFA3TH                          WRA3TH
     I              AFA4TH                          WRA4TH
     I              AFBTTH                          WRBTTH
     I              AFFMDT                          WRFMDT
     I              AFA5TH                          WRA5TH
     I              AFA6TH                          WRA6TH
     I              AFBXTH                          WRBXTH
     I              AFXKST                          WRXKST
     I              AFYDST                          WRYDST
     I              AFFYDT                          WRFYDT
     I              AFB0TH                          WRB0TH
     I              AFBZTH                          WRBZTH
     I              AFH2A1                          WRH2A1
     I              AFJ2A1                          WRJ2A1
     I              AFJ3A1                          WRJ3A1
     I              AFKMA1                          WRKMA1
     I              AFJ4A1                          WRJ4A1
     I              AFJ5A1                          WRJ5A1
     I              AFJ6A1                          WRJ6A1
     I              AFJ7A1                          WRJ7A1
     I              AFJ8A1                          WRJ8A1
     I              AFJ9A1                          WRJ9A1
     I              AFKAA1                          WRKAA1
     I              AFKBA1                          WRKBA1
     I              AFKCA1                          WRKCA1
     I              AFKDA1                          WRKDA1
     I              AFKEA1                          WRKEA1
     I              AFKFA1                          WRKFA1
     I              AFKNA1                          WRKNA1
     I              AFKGA1                          WRKGA1
     I              AFKHA1                          WRKHA1
     I              AFKOA1                          WRKOA1
     I              AFKIA1                          WRKIA1
     I              AFKJA1                          WRKJA1
     I              AFKKA1                          WRKKA1
     I              AFKLA1                          WRKLA1
     I              AFYNST                          WRYNST
     I              AFYOST                          WRYOST
     I              AFABCD                          WRABCD
     I              AFAECD                          WRAECD
     I              AFAACD                          WRAACD
     I              AFHMNB                          WRHMNB
     I              AFBNNB                          WRBNNB
     I              AFBONB                          WRBONB
     I              AFAAVN                          WRAAVN
     I              AFAADT                          WRAADT
     I              AFAMTM                          WRAMTM
     I              AFAJST                          WRAJST
     I              AFAHVN                          WRAHVN
     I              AFAGVN                          WRAGVN
     I              AFABVN                          WRABVN
     I              AFABDT                          WRABDT
     I              AFABTM                          WRABTM
      *
     I@DNCPUX
      * Tattoo Header EXT         Update index
      * Renamed input format fields
     I              DNHMNB                          WSHMNB
     I              DNBNNB                          WSBNNB
     I              DNBONB                          WSBONB
     I              DNCVNB                          WSCVNB
     I              DNB0DT                          WSB0DT
     I              DNI5PR                          WSI5PR
     I              DNJBPR                          WSJBPR
     I              DNI6PR                          WSI6PR
     I              DNI7PR                          WSI7PR
     I              DNI8PR                          WSI8PR
     I              DNI9PR                          WSI9PR
     I              DNJAPR                          WSJAPR
     I              DNJCPR                          WSJCPR
     I              DNJDPR                          WSJDPR
     I              DNJEPR                          WSJEPR
     I              DNJFPR                          WSJFPR
     I              DNJGPR                          WSJGPR
     I              DNJHPR                          WSJHPR
     I              DNJIPR                          WSJIPR
     I              DNJJPR                          WSJJPR
     I              DNJKPR                          WSJKPR
     I              DNJLPR                          WSJLPR
     I              DNJMPR                          WSJMPR
     I              DNJNPR                          WSJNPR
     I              DNJOPR                          WSJOPR
     I              DNLTBF                          WSLTBF
     I              DNHZPC                          WSHZPC
     I              DNLTHW                          WSLTHW
     I              DNH0PC                          WSH0PC
     I              DNGTBF                          WSGTBF
     I              DNH1PC                          WSH1PC
     I              DNGTHW                          WSGTHW
     I              DNH2PC                          WSH2PC
     I              DNHLBF                          WSHLBF
     I              DNHLLE                          WSHLLE
     I              DNHLHW                          WSHLHW
     I              DNHLLP                          WSHLLP
     I              DNHGBF                          WSHGBF
     I              DNHGLE                          WSHGLE
     I              DNHGHW                          WSHGHW
     I              DNHFLP                          WSHFLP
     I              DNSNA1                          WSSNA1
     I              DNSOA1                          WSSOA1
     I              DNSPA1                          WSSPA1
     I              DNDGSS                          WSDGSS
     I              DNDHSS                          WSDHSS
     I              DNDISS                          WSDISS
     I              DNABCD                          WSABCD
     I              DNNYCD                          WSNYCD
     I              DNOVCD                          WSOVCD
     I              DNAAVN                          WSAAVN
     I              DNAADT                          WSAADT
     I              DNAMTM                          WSAMTM
     I              DNAJST                          WSAJST
     I              DNAHVN                          WSAHVN
     I              DNAGVN                          WSAGVN
     I              DNABVN                          WSABVN
     I              DNABDT                          WSABDT
     I              DNABTM                          WSABTM
      *
     I@A2CPDF
      * Tattoo Detail             Update index
      * Renamed input format fields
     I              A2HMNB                          WTHMNB
     I              A2BNNB                          WTBNNB
     I              A2BONB                          WTBONB
     I              A2CVNB                          WTCVNB
     I              A2B0DT                          WTB0DT
     I              A2C2NB                          WTC2NB
     I              A2CZNB                          WTCZNB
     I              A2C0NB                          WTC0NB
     I              A2D8NB                          WTD8NB
     I              A2H7NB                          WTH7NB
     I              A2GGST                          WTGGST
     I              A2AJTM                          WTAJTM
     I              A2JEA1                          WTJEA1
     I              A2B7CD                          WTB7CD
     I              A2D7NB                          WTD7NB
     I              A2D9ST                          WTD9ST
     I              A2E3ST                          WTE3ST
     I              A2E4ST                          WTE4ST
     I              A2E5ST                          WTE5ST
     I              A2BVDT                          WTBVDT
     I              A2BWDT                          WTBWDT
     I              A2BXDT                          WTBXDT
     I              A2HVNB                          WTHVNB
     I              A2CMCD                          WTCMCD
     I              A2B9CD                          WTB9CD
     I              A2H8NB                          WTH8NB
     I              A2CYCD                          WTCYCD
     I              A2AAVN                          WTAAVN
     I              A2AADT                          WTAADT
     I              A2AMTM                          WTAMTM
     I              A2AJST                          WTAJST
     I              A2AHVN                          WTAHVN
     I              A2AGVN                          WTAGVN
     I              A2ABVN                          WTABVN
     I              A2ABDT                          WTABDT
     I              A2ABTM                          WTABTM
      *
     I@A2CPNP
      * Tattoo Detail             Co/Bo/Ld/TTT/KillDt/Pen
      * Renamed input format fields
     I              A2HMNB                          WVHMNB
     I              A2BNNB                          WVBNNB
     I              A2BONB                          WVBONB
     I              A2CVNB                          WVCVNB
     I              A2B0DT                          WVB0DT
     I              A2C2NB                          WVC2NB
     I              A2CZNB                          WVCZNB
     I              A2C0NB                          WVC0NB
     I              A2D8NB                          WVD8NB
     I              A2H7NB                          WVH7NB
     I              A2GGST                          WVGGST
     I              A2AJTM                          WVAJTM
     I              A2JEA1                          WVJEA1
     I              A2B7CD                          WVB7CD
     I              A2D7NB                          WVD7NB
     I              A2D9ST                          WVD9ST
     I              A2E3ST                          WVE3ST
     I              A2E4ST                          WVE4ST
     I              A2E5ST                          WVE5ST
     I              A2BVDT                          WVBVDT
     I              A2BWDT                          WVBWDT
     I              A2BXDT                          WVBXDT
     I              A2HVNB                          WVHVNB
     I              A2CMCD                          WVCMCD
     I              A2B9CD                          WVB9CD
     I              A2H8NB                          WVH8NB
     I              A2CYCD                          WVCYCD
     I              A2AAVN                          WVAAVN
     I              A2AADT                          WVAADT
     I              A2AMTM                          WVAMTM
     I              A2AJST                          WVAJST
     I              A2AHVN                          WVAHVN
     I              A2AGVN                          WVAGVN
     I              A2ABVN                          WVABVN
     I              A2ABDT                          WVABDT
     I              A2ABTM                          WVABTM
      *
     I@AECPP1
      * Delivery Sched Detail     Co/bol/Kdt/Sdate/Tim/Seq
      * Renamed input format fields
     I              AEHONB                          WWHONB
     I              AEE0DT                          WWE0DT
     I              AEE6DT                          WWE6DT
     I              AEAGTH                          WWAGTH
     I              AEHZA1                          WWHZA1
     I              AEH0A1                          WWH0A1
     I              AEH1A1                          WWH1A1
     I              AEJ4CD                          WWJ4CD
     I              AEJ5CD                          WWJ5CD
     I              AELBCD                          WWLBCD
     I              AELCCD                          WWLCCD
     I              AEIOA1                          WWIOA1
     I              AEH2A1                          WWH2A1
     I              AEIJA1                          WWIJA1
     I              AEK9CD                          WWK9CD
     I              AEK8CD                          WWK8CD
     I              AEJ6CD                          WWJ6CD
     I              AEJ7CD                          WWJ7CD
     I              AEMGCD                          WWMGCD
     I              AEW1ST                          WWW1ST
     I              AEW2ST                          WWW2ST
     I              AEH3A1                          WWH3A1
     I              AEMECD                          WWMECD
     I              AEMFCD                          WWMFCD
     I              AEW4ST                          WWW4ST
     I              AEXWST                          WWXWST
     I              AEFRDT                          WWFRDT
     I              AEBOTH                          WWBOTH
     I              AEE7DT                          WWE7DT
     I              AEAHTH                          WWAHTH
     I              AEE8DT                          WWE8DT
     I              AEAITH                          WWAITH
     I              AEXBST                          WWXBST
     I              AEXGST                          WWXGST
     I              AEXPST                          WWXPST
     I              AEXNST                          WWXNST
     I              AEXTST                          WWXTST
     I              AEXLST                          WWXLST
     I              AEW0ST                          WWW0ST
     I              AEYEST                          WWYEST
     I              AEFZDT                          WWFZDT
     I              AEB1TH                          WWB1TH
     I              AEAACD                          WWAACD
     I              AEABCD                          WWABCD
     I              AEAECD                          WWAECD
     I              AEHMNB                          WWHMNB
     I              AEBNNB                          WWBNNB
     I              AEBONB                          WWBONB
     I              AEY0A1                          WWY0A1
     I              AEY1A1                          WWY1A1
     I              AEDGT1                          WWDGT1
     I              AEDHT1                          WWDHT1
     I              AEIISS                          WWIISS
     I              AEAAVN                          WWAAVN
     I              AEAADT                          WWAADT
     I              AEAMTM                          WWAMTM
     I              AEAJST                          WWAJST
     I              AEAHVN                          WWAHVN
     I              AEAGVN                          WWAGVN
     I              AEABVN                          WWABVN
     I              AEABDT                          WWABDT
     I              AEABTM                          WWABTM
      *
     I@A1CPOC
      * Tattoo Header             Co/BOL/Kill/Ttt
      * Renamed input format fields
     I              A1HMNB                          WXHMNB
     I              A1BNNB                          WXBNNB
     I              A1BONB                          WXBONB
     I              A1CVNB                          WXCVNB
     I              A1B0DT                          WXB0DT
     I              A1AWDT                          WXAWDT
     I              A1BICD                          WXBICD
     I              A1CPST                          WXCPST
     I              A1ACPR                          WXACPR
     I              A1B9PR                          WXB9PR
     I              A1CAPR                          WXCAPR
     I              A1C4ST                          WXC4ST
     I              A1AIPR                          WXAIPR
     I              A1A6DT                          WXA6DT
     I              A1C2ST                          WXC2ST
     I              A1CXNB                          WXCXNB
     I              A1CWNB                          WXCWNB
     I              A1FCNB                          WXFCNB
     I              A1H9NB                          WXH9NB
     I              A1FDNB                          WXFDNB
     I              A1FENB                          WXFENB
     I              A1HENB                          WXHENB
     I              A1HFNB                          WXHFNB
     I              A1CYNB                          WXCYNB
     I              A1LRNB                          WXLRNB
     I              A1E0NB                          WXE0NB
     I              A1A5PC                          WXA5PC
     I              A1FBNB                          WXFBNB
     I              A1A4PC                          WXA4PC
     I              A1F7NB                          WXF7NB
     I              A1HDNB                          WXHDNB
     I              A1F5NB                          WXF5NB
     I              A1F4NB                          WXF4NB
     I              A1F3NB                          WXF3NB
     I              A1F2NB                          WXF2NB
     I              A1AVPC                          WXAVPC
     I              A1AWPC                          WXAWPC
     I              A1CWPC                          WXCWPC
     I              A1A8PC                          WXA8PC
     I              A1A7PC                          WXA7PC
     I              A1B8PR                          WXB8PR
     I              A1AMPR                          WXAMPR
     I              A1ANPR                          WXANPR
     I              A1AYVA                          WXAYVA
     I              A1AWVA                          WXAWVA
     I              A1AOPR                          WXAOPR
     I              A1AXVA                          WXAXVA
     I              A1APPR                          WXAPPR
     I              A1ASPR                          WXASPR
     I              A1A4VA                          WXA4VA
     I              A1ATPR                          WXATPR
     I              A1A5VA                          WXA5VA
     I              A1CBPR                          WXCBPR
     I              A1CCPR                          WXCCPR
     I              A1LPNB                          WXLPNB
     I              A1CDPR                          WXCDPR
     I              A1A7VA                          WXA7VA
     I              A1A2PR                          WXA2PR
     I              A1JWST                          WXJWST
     I              A1CWST                          WXCWST
     I              A1D7ST                          WXD7ST
     I              A1D8ST                          WXD8ST
     I              A1DWST                          WXDWST
     I              A1D6ST                          WXD6ST
     I              A1GHNB                          WXGHNB
     I              A1BYDT                          WXBYDT
     I              A1E0ST                          WXE0ST
     I              A1E1ST                          WXE1ST
     I              A1E2ST                          WXE2ST
     I              A1BSDT                          WXBSDT
     I              A1BTDT                          WXBTDT
     I              A1BUDT                          WXBUDT
     I              A1HGNB                          WXHGNB
     I              A1HHNB                          WXHHNB
     I              A1HINB                          WXHINB
     I              A1A3PR                          WXA3PR
     I              A1A4PR                          WXA4PR
     I              A1A6PR                          WXA6PR
     I              A1J9NB                          WXJ9NB
     I              A1D6PR                          WXD6PR
     I              A1D7PR                          WXD7PR
     I              A1D8PR                          WXD8PR
     I              A1D9PR                          WXD9PR
     I              A1EAPR                          WXEAPR
     I              A1EBPR                          WXEBPR
     I              A1ECPR                          WXECPR
     I              A1EDPR                          WXEDPR
     I              A1EEPR                          WXEEPR
     I              A1EFPR                          WXEFPR
     I              A1EGPR                          WXEGPR
     I              A1EHPR                          WXEHPR
     I              A1KAST                          WXKAST
     I              A1J7ST                          WXJ7ST
     I              A1J9ST                          WXJ9ST
     I              A1OXNB                          WXOXNB
     I              A1LKST                          WXLKST
     I              A1LLST                          WXLLST
     I              A1J8ST                          WXJ8ST
     I              A1LIST                          WXLIST
     I              A1LJST                          WXLJST
     I              A1NZTX                          WXNZTX
     I              A1HJCD                          WXHJCD
     I              A1R4ST                          WXR4ST
     I              A1R5ST                          WXR5ST
     I              A1R6ST                          WXR6ST
     I              A1R7ST                          WXR7ST
     I              A1THWT                          WXTHWT
     I              A1T2WT                          WXT2WT
     I              A1THHD                          WXTHHD
     I              A1T2HD                          WXT2HD
     I              A1OBPR                          WXOBPR
     I              A1KOER                          WXKOER
     I              A1OPIR                          WXOPIR
     I              A1OPEM                          WXOPEM
     I              A1IORP                          WXIORP
     I              A1OWEO                          WXOWEO
     I              A1OQET                          WXOQET
     I              A1URST                          WXURST
     I              A1USST                          WXUSST
     I              A1HHPC                          WXHHPC
     I              A1S9PR                          WXS9PR
     I              A1TAPR                          WXTAPR
     I              A1TBPR                          WXTBPR
     I              A1JFUR                          WXJFUR
     I              A1KRIF                          WXKRIF
     I              A1KORF                          WXKORF
     I              A1KAPR                          WXKAPR
     I              A1KROT                          WXKROT
     I              A1OTJG                          WXOTJG
     I              A1IRJG                          WXIRJG
     I              A1IMJF                          WXIMJF
     I              A1IRGF                          WXIRGF
     I              A1KRJF                          WXKRJF
     I              A1OJRF                          WXOJRF
     I              A1KFOR                          WXKFOR
     I              A1ORJK                          WXORJK
     I              A1OMVJ                          WXOMVJ
     I              A1MVNF                          WXMVNF
     I              A1MCNF                          WXMCNF
     I              A1NCNF                          WXNCNF
     I              A1NCHF                          WXNCHF
     I              A1IGIR                          WXIGIR
     I              A1KFJR                          WXKFJR
     I              A1EADT                          WXEADT
     I              A1EBDT                          WXEBDT
     I              A1ECDT                          WXECDT
     I              A1EDDT                          WXEDDT
     I              A1EEDT                          WXEEDT
     I              A1U4ST                          WXU4ST
     I              A1U5ST                          WXU5ST
     I              A1U6ST                          WXU6ST
     I              A1U7ST                          WXU7ST
     I              A1U8ST                          WXU8ST
     I              A1U9ST                          WXU9ST
     I              A1VAST                          WXVAST
     I              A1VBST                          WXVBST
     I              A1BDCD                          WXBDCD
     I              A1CSCD                          WXCSCD
     I              A1ABCD                          WXABCD
     I              A1AECD                          WXAECD
     I              A1ACCD                          WXACCD
     I              A1AGCD                          WXAGCD
     I              A1BECD                          WXBECD
     I              A1AAVN                          WXAAVN
     I              A1AADT                          WXAADT
     I              A1AMTM                          WXAMTM
     I              A1AJST                          WXAJST
     I              A1AHVN                          WXAHVN
     I              A1AGVN                          WXAGVN
     I              A1ABVN                          WXABVN
     I              A1ABDT                          WXABDT
     I              A1ABTM                          WXABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            583
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     IQPKFJ1    E DSPKFJCPL0
      * UPD : Tattoo Pending            Update index
      * Renamed input format fields
     I              FJHONB                          WFHONB
     I              FJEZDT                          WFEZDT
     I              FJHSA1                          WFHSA1
     I              FJHMNB                          WFHMNB
     I              FJBNNB                          WFBNNB
     I              FJBONB                          WFBONB
     I              FJHRA1                          WFHRA1
     I              FJBKTM                          WFBKTM
     I              FJWPST                          WFWPST
     I              FJWQST                          WFWQST
     I              FJMIA1                          WFMIA1
     I              FJAAVN                          WFAAVN
     I              FJAADT                          WFAADT
     I              FJAMTM                          WFAMTM
     I              FJAJST                          WFAJST
     I              FJAHVN                          WFAHVN
     I              FJAGVN                          WFAGVN
     I              FJABVN                          WFABVN
     I              FJABDT                          WFABDT
     I              FJABTM                          WFABTM
      *
     IYARDCS      DS                             87
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKA31    E DSPKA3REL0
      * UPD : Pen                       Update index
      * Renamed input format fields
     I              A3HVNB                          WJHVNB
     I              A3CMCD                          WJCMCD
     I              A3BBTX                          WJBBTX
     I              A3CTNB                          WJCTNB
     I              A3D6NB                          WJD6NB
     I              A3B6CD                          WJB6CD
     I              A3DGST                          WJDGST
     I              A3EBNB                          WJEBNB
     I              A3FWST                          WJFWST
     I              A3HBNB                          WJHBNB
     I              A3AGCD                          WJAGCD
     I              A3AAVN                          WJAAVN
     I              A3AADT                          WJAADT
     I              A3AMTM                          WJAMTM
     I              A3AJST                          WJAJST
     I              A3AHVN                          WJAHVN
     I              A3AGVN                          WJAGVN
     I              A3ABVN                          WJABVN
     I              A3ABDT                          WJABDT
     I              A3ABTM                          WJABTM
      *
     IYBRDCS      DS                            107
     IYCRDCS      DS                            107
     IYDRDCS      DS                            107
     IYERDCS      DS                            107
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WKHMNB
     I              AXBNNB                          WKBNNB
     I              AXBONB                          WKBONB
     I              AXCQDT                          WKCQDT
     I              AXABTH                          WKABTH
     I              AXACTH                          WKACTH
     I              AXBPNB                          WKBPNB
     I              AXCSNB                          WKCSNB
     I              AXAUDT                          WKAUDT
     I              AXCMST                          WKCMST
     I              AXAGPR                          WKAGPR
     I              AXATVA                          WKATVA
     I              AXI1ST                          WKI1ST
     I              AXDHNB                          WKDHNB
     I              AXDINB                          WKDINB
     I              AXCNST                          WKCNST
     I              AXGINB                          WKGINB
     I              AXBZDT                          WKBZDT
     I              AXLSNB                          WKLSNB
     I              AXF3TX                          WKF3TX
     I              AXO8ST                          WKO8ST
     I              AXO9ST                          WKO9ST
     I              AXPAST                          WKPAST
     I              AXLDSH                          WKLDSH
     I              AXPBST                          WKPBST
     I              AXPCST                          WKPCST
     I              AXPDST                          WKPDST
     I              AXUWST                          WKUWST
     I              AXUXST                          WKUXST
     I              AXUYST                          WKUYST
     I              AXJKRU                          WKJKRU
     I              AXKEOR                          WKKEOR
     I              AXIOEW                          WKIOEW
     I              AXKJIO                          WKKJIO
     I              AXIOJR                          WKIOJR
     I              AXEIRR                          WKEIRR
     I              AXITMF                          WKITMF
     I              AXODJE                          WKODJE
     I              AXRJIF                          WKRJIF
     I              AXOEJF                          WKOEJF
     I              AXD0DT                          WKD0DT
     I              AXD1DT                          WKD1DT
     I              AXD2DT                          WKD2DT
     I              AXD3DT                          WKD3DT
     I              AXD4DT                          WKD4DT
     I              AXBNCD                          WKBNCD
     I              AXABCD                          WKABCD
     I              AXAECD                          WKAECD
     I              AXAAVN                          WKAAVN
     I              AXAADT                          WKAADT
     I              AXAMTM                          WKAMTM
     I              AXAJST                          WKAJST
     I              AXAHVN                          WKAHVN
     I              AXAGVN                          WKAGVN
     I              AXABVN                          WKABVN
     I              AXABDT                          WKABDT
     I              AXABTM                          WKABTM
      *
     IYFRDCS      DS                            237
     IQPKAW1    E DSPKAWCPL0
      * UPD : Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WLHMNB
     I              AWBNNB                          WLBNNB
     I              AWARDT                          WLARDT
     I              AWASDT                          WLASDT
     I              AWA4ST                          WLA4ST
     I              AWA5ST                          WLA5ST
     I              AWAAPR                          WLAAPR
     I              AWA6ST                          WLA6ST
     I              AWA7ST                          WLA7ST
     I              AWB3ST                          WLB3ST
     I              AWALPR                          WLALPR
     I              AWETCD                          WLETCD
     I              AWEUCD                          WLEUCD
     I              AWJ5TX                          WLJ5TX
     I              AWD5DT                          WLD5DT
     I              AWD6DT                          WLD6DT
     I              AWD7DT                          WLD7DT
     I              AWD8DT                          WLD8DT
     I              AWD9DT                          WLD9DT
     I              AWJOEJ                          WLJOEJ
     I              AWKOFF                          WLKOFF
     I              AWKWPE                          WLKWPE
     I              AWIMBF                          WLIMBF
     I              AWOPTR                          WLOPTR
     I              AWOEJD                          WLOEJD
     I              AWIRMF                          WLIRMF
     I              AWJIRM                          WLJIRM
     I              AWJRKF                          WLJRKF
     I              AWKFIR                          WLKFIR
     I              AWUZST                          WLUZST
     I              AWU0ST                          WLU0ST
     I              AWU1ST                          WLU1ST
     I              AWU2ST                          WLU2ST
     I              AWU3ST                          WLU3ST
     I              AWHXNB                          WLHXNB
     I              AWGANB                          WLGANB
     I              AWGBNB                          WLGBNB
     I              AWABCD                          WLABCD
     I              AWAECD                          WLAECD
     I              AWAKCD                          WLAKCD
     I              AWALCD                          WLALCD
     I              AWAGCD                          WLAGCD
     I              AWAICD                          WLAICD
     I              AWAMCD                          WLAMCD
     I              AWACCD                          WLACCD
     I              AWAAVN                          WLAAVN
     I              AWAADT                          WLAADT
     I              AWAMTM                          WLAMTM
     I              AWAJST                          WLAJST
     I              AWAHVN                          WLAHVN
     I              AWAGVN                          WLAGVN
     I              AWABVN                          WLABVN
     I              AWABDT                          WLABDT
     I              AWABTM                          WLABTM
      *
     IYGRDCS      DS                            219
     IQPLAE1    E DSPLAECPL1
      * UPD : Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WMHONB
     I              AEE0DT                          WME0DT
     I              AEE6DT                          WME6DT
     I              AEAGTH                          WMAGTH
     I              AEHZA1                          WMHZA1
     I              AEH0A1                          WMH0A1
     I              AEH1A1                          WMH1A1
     I              AEJ4CD                          WMJ4CD
     I              AEJ5CD                          WMJ5CD
     I              AELBCD                          WMLBCD
     I              AELCCD                          WMLCCD
     I              AEIOA1                          WMIOA1
     I              AEH2A1                          WMH2A1
     I              AEIJA1                          WMIJA1
     I              AEK9CD                          WMK9CD
     I              AEK8CD                          WMK8CD
     I              AEJ6CD                          WMJ6CD
     I              AEJ7CD                          WMJ7CD
     I              AEMGCD                          WMMGCD
     I              AEW1ST                          WMW1ST
     I              AEW2ST                          WMW2ST
     I              AEH3A1                          WMH3A1
     I              AEMECD                          WMMECD
     I              AEMFCD                          WMMFCD
     I              AEW4ST                          WMW4ST
     I              AEXWST                          WMXWST
     I              AEFRDT                          WMFRDT
     I              AEBOTH                          WMBOTH
     I              AEE7DT                          WME7DT
     I              AEAHTH                          WMAHTH
     I              AEE8DT                          WME8DT
     I              AEAITH                          WMAITH
     I              AEXBST                          WMXBST
     I              AEXGST                          WMXGST
     I              AEXPST                          WMXPST
     I              AEXNST                          WMXNST
     I              AEXTST                          WMXTST
     I              AEXLST                          WMXLST
     I              AEW0ST                          WMW0ST
     I              AEYEST                          WMYEST
     I              AEFZDT                          WMFZDT
     I              AEB1TH                          WMB1TH
     I              AEAACD                          WMAACD
     I              AEABCD                          WMABCD
     I              AEAECD                          WMAECD
     I              AEHMNB                          WMHMNB
     I              AEBNNB                          WMBNNB
     I              AEBONB                          WMBONB
     I              AEY0A1                          WMY0A1
     I              AEY1A1                          WMY1A1
     I              AEDGT1                          WMDGT1
     I              AEDHT1                          WMDHT1
     I              AEIISS                          WMIISS
     I              AEAAVN                          WMAAVN
     I              AEAADT                          WMAADT
     I              AEAMTM                          WMAMTM
     I              AEAJST                          WMAJST
     I              AEAHVN                          WMAHVN
     I              AEAGVN                          WMAGVN
     I              AEABVN                          WMABVN
     I              AEABDT                          WMABDT
     I              AEABTM                          WMABTM
      *
     IYHRDCS      DS                            275
     IYIRDCS      DS                            237
     IQPKDZ1    E DSPKDZREL0
      * UPD : Tattoo Defect             Update index
      * Renamed input format fields
     I              DZHMNB                          WOHMNB
     I              DZBNNB                          WOBNNB
     I              DZBONB                          WOBONB
     I              DZCVNB                          WOCVNB
     I              DZB0DT                          WOB0DT
     I              DZBDCD                          WOBDCD
     I              DZLJNB                          WOLJNB
     I              DZBECD                          WOBECD
     I              DZB7SS                          WOB7SS
     I              DZB8SS                          WOB8SS
     I              DZB9SS                          WOB9SS
     I              DZCASS                          WOCASS
     I              DZNXA1                          WONXA1
     I              DZNYA1                          WONYA1
     I              DZNZA1                          WONZA1
     I              DZAAVN                          WOAAVN
     I              DZAADT                          WOAADT
     I              DZAMTM                          WOAMTM
     I              DZAJST                          WOAJST
     I              DZAHVN                          WOAHVN
     I              DZAGVN                          WOAGVN
     I              DZABVN                          WOABVN
     I              DZABDT                          WOABDT
     I              DZABTM                          WOABTM
      *
     IYJRDCS      DS                            237
     IQPLAF1    E DSPLAFCPL0
      * UPD : Delivery Tracking         Update index
      * Renamed input format fields
     I              AFHONB                          WRHONB
     I              AFE0DT                          WRE0DT
     I              AFE9DT                          WRE9DT
     I              AFAJTH                          WRAJTH
     I              AFH4A1                          WRH4A1
     I              AFFXDT                          WRFXDT
     I              AFJIA1                          WRJIA1
     I              AFIBA1                          WRIBA1
     I              AFW5ST                          WRW5ST
     I              AFICA1                          WRICA1
     I              AFK0CD                          WRK0CD
     I              AFK1CD                          WRK1CD
     I              AFLFCD                          WRLFCD
     I              AFLGCD                          WRLGCD
     I              AFIDA1                          WRIDA1
     I              AFIPA1                          WRIPA1
     I              AFLICD                          WRLICD
     I              AFJ8CD                          WRJ8CD
     I              AFJ9CD                          WRJ9CD
     I              AFMGCD                          WRMGCD
     I              AFXHST                          WRXHST
     I              AFXIST                          WRXIST
     I              AFIEA1                          WRIEA1
     I              AFKBCD                          WRKBCD
     I              AFKZCD                          WRKZCD
     I              AFLHCD                          WRLHCD
     I              AFFADT                          WRFADT
     I              AFAKTH                          WRAKTH
     I              AFBYTH                          WRBYTH
     I              AFW6ST                          WRW6ST
     I              AFXXST                          WRXXST
     I              AFFBDT                          WRFBDT
     I              AFALTH                          WRALTH
     I              AFBVTH                          WRBVTH
     I              AFAMTH                          WRAMTH
     I              AFFCDT                          WRFCDT
     I              AFANTH                          WRANTH
     I              AFBHTH                          WRBHTH
     I              AFFDDT                          WRFDDT
     I              AFAOTH                          WRAOTH
     I              AFBWTH                          WRBWTH
     I              AFAPTH                          WRAPTH
     I              AFFEDT                          WRFEDT
     I              AFAQTH                          WRAQTH
     I              AFARTH                          WRARTH
     I              AFFFDT                          WRFFDT
     I              AFASTH                          WRASTH
     I              AFATTH                          WRATTH
     I              AFFGDT                          WRFGDT
     I              AFAUTH                          WRAUTH
     I              AFFHDT                          WRFHDT
     I              AFAVTH                          WRAVTH
     I              AFAWTH                          WRAWTH
     I              AFBKTH                          WRBKTH
     I              AFBLTH                          WRBLTH
     I              AFXJST                          WRXJST
     I              AFK3CD                          WRK3CD
     I              AFFIDT                          WRFIDT
     I              AFAXTH                          WRAXTH
     I              AFAYTH                          WRAYTH
     I              AFFJDT                          WRFJDT
     I              AFAZTH                          WRAZTH
     I              AFA0TH                          WRA0TH
     I              AFFKDT                          WRFKDT
     I              AFA1TH                          WRA1TH
     I              AFA2TH                          WRA2TH
     I              AFFLDT                          WRFLDT
     I              AFA3TH                          WRA3TH
     I              AFA4TH                          WRA4TH
     I              AFBTTH                          WRBTTH
     I              AFFMDT                          WRFMDT
     I              AFA5TH                          WRA5TH
     I              AFA6TH                          WRA6TH
     I              AFBXTH                          WRBXTH
     I              AFXKST                          WRXKST
     I              AFYDST                          WRYDST
     I              AFFYDT                          WRFYDT
     I              AFB0TH                          WRB0TH
     I              AFBZTH                          WRBZTH
     I              AFH2A1                          WRH2A1
     I              AFJ2A1                          WRJ2A1
     I              AFJ3A1                          WRJ3A1
     I              AFKMA1                          WRKMA1
     I              AFJ4A1                          WRJ4A1
     I              AFJ5A1                          WRJ5A1
     I              AFJ6A1                          WRJ6A1
     I              AFJ7A1                          WRJ7A1
     I              AFJ8A1                          WRJ8A1
     I              AFJ9A1                          WRJ9A1
     I              AFKAA1                          WRKAA1
     I              AFKBA1                          WRKBA1
     I              AFKCA1                          WRKCA1
     I              AFKDA1                          WRKDA1
     I              AFKEA1                          WRKEA1
     I              AFKFA1                          WRKFA1
     I              AFKNA1                          WRKNA1
     I              AFKGA1                          WRKGA1
     I              AFKHA1                          WRKHA1
     I              AFKOA1                          WRKOA1
     I              AFKIA1                          WRKIA1
     I              AFKJA1                          WRKJA1
     I              AFKKA1                          WRKKA1
     I              AFKLA1                          WRKLA1
     I              AFYNST                          WRYNST
     I              AFYOST                          WRYOST
     I              AFABCD                          WRABCD
     I              AFAECD                          WRAECD
     I              AFAACD                          WRAACD
     I              AFHMNB                          WRHMNB
     I              AFBNNB                          WRBNNB
     I              AFBONB                          WRBONB
     I              AFAAVN                          WRAAVN
     I              AFAADT                          WRAADT
     I              AFAMTM                          WRAMTM
     I              AFAJST                          WRAJST
     I              AFAHVN                          WRAHVN
     I              AFAGVN                          WRAGVN
     I              AFABVN                          WRABVN
     I              AFABDT                          WRABDT
     I              AFABTM                          WRABTM
      *
     IYKRDCS      DS                            455
     IQPKDN1    E DSPKDNCPL0
      * UPD : Tattoo Header EXT         Update index
      * Renamed input format fields
     I              DNHMNB                          WSHMNB
     I              DNBNNB                          WSBNNB
     I              DNBONB                          WSBONB
     I              DNCVNB                          WSCVNB
     I              DNB0DT                          WSB0DT
     I              DNI5PR                          WSI5PR
     I              DNJBPR                          WSJBPR
     I              DNI6PR                          WSI6PR
     I              DNI7PR                          WSI7PR
     I              DNI8PR                          WSI8PR
     I              DNI9PR                          WSI9PR
     I              DNJAPR                          WSJAPR
     I              DNJCPR                          WSJCPR
     I              DNJDPR                          WSJDPR
     I              DNJEPR                          WSJEPR
     I              DNJFPR                          WSJFPR
     I              DNJGPR                          WSJGPR
     I              DNJHPR                          WSJHPR
     I              DNJIPR                          WSJIPR
     I              DNJJPR                          WSJJPR
     I              DNJKPR                          WSJKPR
     I              DNJLPR                          WSJLPR
     I              DNJMPR                          WSJMPR
     I              DNJNPR                          WSJNPR
     I              DNJOPR                          WSJOPR
     I              DNLTBF                          WSLTBF
     I              DNHZPC                          WSHZPC
     I              DNLTHW                          WSLTHW
     I              DNH0PC                          WSH0PC
     I              DNGTBF                          WSGTBF
     I              DNH1PC                          WSH1PC
     I              DNGTHW                          WSGTHW
     I              DNH2PC                          WSH2PC
     I              DNHLBF                          WSHLBF
     I              DNHLLE                          WSHLLE
     I              DNHLHW                          WSHLHW
     I              DNHLLP                          WSHLLP
     I              DNHGBF                          WSHGBF
     I              DNHGLE                          WSHGLE
     I              DNHGHW                          WSHGHW
     I              DNHFLP                          WSHFLP
     I              DNSNA1                          WSSNA1
     I              DNSOA1                          WSSOA1
     I              DNSPA1                          WSSPA1
     I              DNDGSS                          WSDGSS
     I              DNDHSS                          WSDHSS
     I              DNDISS                          WSDISS
     I              DNABCD                          WSABCD
     I              DNNYCD                          WSNYCD
     I              DNOVCD                          WSOVCD
     I              DNAAVN                          WSAAVN
     I              DNAADT                          WSAADT
     I              DNAMTM                          WSAMTM
     I              DNAJST                          WSAJST
     I              DNAHVN                          WSAHVN
     I              DNAGVN                          WSAGVN
     I              DNABVN                          WSABVN
     I              DNABDT                          WSABDT
     I              DNABTM                          WSABTM
      *
     IQPKA21    E DSPKA2CPL0
      * UPD : Tattoo Detail             Update index
      * Renamed input format fields
     I              A2HMNB                          WTHMNB
     I              A2BNNB                          WTBNNB
     I              A2BONB                          WTBONB
     I              A2CVNB                          WTCVNB
     I              A2B0DT                          WTB0DT
     I              A2C2NB                          WTC2NB
     I              A2CZNB                          WTCZNB
     I              A2C0NB                          WTC0NB
     I              A2D8NB                          WTD8NB
     I              A2H7NB                          WTH7NB
     I              A2GGST                          WTGGST
     I              A2AJTM                          WTAJTM
     I              A2JEA1                          WTJEA1
     I              A2B7CD                          WTB7CD
     I              A2D7NB                          WTD7NB
     I              A2D9ST                          WTD9ST
     I              A2E3ST                          WTE3ST
     I              A2E4ST                          WTE4ST
     I              A2E5ST                          WTE5ST
     I              A2BVDT                          WTBVDT
     I              A2BWDT                          WTBWDT
     I              A2BXDT                          WTBXDT
     I              A2HVNB                          WTHVNB
     I              A2CMCD                          WTCMCD
     I              A2B9CD                          WTB9CD
     I              A2H8NB                          WTH8NB
     I              A2CYCD                          WTCYCD
     I              A2AAVN                          WTAAVN
     I              A2AADT                          WTAADT
     I              A2AMTM                          WTAMTM
     I              A2AJST                          WTAJST
     I              A2AHVN                          WTAHVN
     I              A2AGVN                          WTAGVN
     I              A2ABVN                          WTABVN
     I              A2ABDT                          WTABDT
     I              A2ABTM                          WTABTM
      *
     IYLRDCS      DS                            133
     IYMRDCS      DS                            237
     IYNRDCS      DS                            107
     IYORDCS      DS                            107
     IYPRDCS      DS                            107
     IYQRDCS      DS                            107
     IYRRDCS      DS                            107
     IYSRDCS      DS                            107
     IYTRDCS      DS                            107
     IYURDCS      DS                            107
     IYVRDCS      DS                            455
     IYWRDCS      DS                            583
     IYXRDCS      DS                            237
     IYYRDCS      DS                            583
     IYZRDCS      DS                            237
     IY0RDCS      DS                            107
     IY1RDCS      DS                            218
     IY2RDCS      DS                            218
     IY3RDCS      DS                            237
     IY4RDCS      DS                            275
     IY5RDCS      DS                            583
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IY6RDCS      DS                             87
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : RST BOL Load Number
     I                                    P   7   90P1BONB
      * B : RST TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : RST TH Kill Date
     I                                    P  13  160P1B0DT
      * I :  TH Group Reference
     I                                       17  26 P1BICD
      * N :  TH Dead On Arrival
     I                                    P  27  290P1CXNB
      * I : MAP TH Sex
     I                                       30  30 P1E2ST
      * I : MAP TH HPS Movement Ref #
     I                                    P  31  340P1OXNB
      * I : MAP TH Hog Class Type
     I                                       35  35 P1LLST
      * N :  TH HPS Farm Site
     I                                    P  36  380P1THHD
      * I : MAP PD Producer Code
     I                                       39  44 P1ABCD
      * I : MAP PL Location Code
     I                                       45  50 P1AECD
      * I : MAP GN Genetic Code
     I                                       51  55 P1AGCD
     IP2PARM      DS
      * FLD: *Arrays
      * I :  Oms System Value Alpha
     I                                        1  40 P2EVTX
      * I :  Name USR
     I                                       41  80 P2BSTX
      * I :  BOL Pln Delv Date
     I                                    P  81  840P2AUDT
      * B : MAP Record Added Usr
     I                                       85  85 P2IHST
      * I :  PD Name
     I                                       86 125 P2AGTX
      * I :  PL Name
     I                                      126 165 P2A8TX
      * I :  User modified: 0-not modi
     I                                      166 166 P2UMOD
      * N :  State
     I                                      167 169 P2DRTX
      * I :  Company Value Code    USR
     I                                      170 179 P2FACD
      * I :  SBD Top Load Sts
     I                                      180 180 P2WEST
     IP3PARM      DS
      * FLD: Source
      * N :  SR Source Code
     I                                        1   3 P3AACD
      * N :  SR Description
     I                                        4  28 P3AFTX
      * N :  SR Type
     I                                       29  29 P3IXST
     IP4PARM      DS
      * N :  SR Type Desc
     I                                        1  15 P4ISTX
     IP5PARM      DS
      * FLD: Producer Location
      * N :  PL Name
     I                                        1  40 P5A8TX
      * N :  PL State Code
     I                                       41  43 P5N0TX
      * N :  PL Site ID Required
     I                                       44  44 P5QTST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0001
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0002
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0003
      * Message data for 'Producer Site ID Required'
      * PS Site ID
     I                                        1  10 ZA0004
      * Message data for 'Producer Site/Mileage NF'
      * PS Site ID
     I                                        1  10 ZA0005
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0006
      * Message data for 'Producer Subsidiary Req'
      * Producer Subsidiary Code
     I                                        1   6 ZA0007
      * Message data for 'Producer Subsidiary NotFn'
      * Producer Subsidiary Code
     I                                        1   6 ZA0008
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0009
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0010
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0011
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0012
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0013
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0014
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0015
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0016
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0017
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0018
      * Message data for 'Class code inval for type'
      * TH Hog Class Type
     I                                        1   1 ZA0019
      * HC Class Code
     I                                        2   4 ZA0020
      * Message data for 'Enter Head On BOL'
      * BOL Shipped Head
     I                                    P   1   30ZA0021
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0022
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0023
      * Message data for 'Pen is req for rsl/int'
      * Pen Number
     I                                        1   3 ZA0024
      * Message data for 'Pen type not the same as'
      * Pen Number
     I                                        1   3 ZA0025
      * HC Class Type
     I                                        4   4 ZA0026
      * Pen Type
     I                                        5   5 ZA0027
      * Message data for 'Shipped Weight is Requird'
      * TH Shipped Weight
     I                                    P   1   41ZA0028
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0029
      * DF Defect Code
     I                                        2   7 ZA0030
      * DF Classification Defs
     I                                        8   8 ZA0031
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0032
      * DF Defect Code
     I                                        2   7 ZA0033
      * DF Classification Defs
     I                                        8   8 ZA0034
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0035
      * DF Defect Code
     I                                        2   7 ZA0036
      * DF Classification Defs
     I                                        8   8 ZA0037
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0038
      * DF Defect Code
     I                                        2   7 ZA0039
      * DF Classification Defs
     I                                        8   8 ZA0040
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0041
      * DF Defect Code
     I                                        2   7 ZA0042
      * DF Classification Defs
     I                                        8   8 ZA0043
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0044
      * DF Defect Code
     I                                        2   7 ZA0045
      * DF Classification Defs
     I                                        8   8 ZA0046
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0047
      * DF Defect Code
     I                                        2   7 ZA0048
      * DF Classification Defs
     I                                        8   8 ZA0049
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0050
      * DF Defect Code
     I                                        2   7 ZA0051
      * DF Classification Defs
     I                                        8   8 ZA0052
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0053
      * DF Defect Code
     I                                        2   7 ZA0054
      * DF Classification Defs
     I                                        8   8 ZA0055
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0056
      * DF Defect Code
     I                                        2   7 ZA0057
      * DF Classification Defs
     I                                        8   8 ZA0058
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0059
      * Message data for 'Tattoo &1 has been added.'
      * TH Tattoo Number
     I                                    P   1   30ZA0060
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM P1CVNB    WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P1BICD    PARM           WP0006 10        TH Group Refere
     C           P1E2ST    PARM           WP0007  1        TH Sex
     C           P1OXNB    PARM           WP0008  70       TH HPS Movement
     C           P1LLST    PARM           WP0009  1        TH Hog Class Ty
     C           P1ABCD    PARM           WP0010  6        PD Producer Cod
     C           P1AECD    PARM           WP0011  6        PL Location Cod
     C           P1AGCD    PARM           WP0012  5        GN Genetic Code
     C           P2EVTX    PARM           WP0013 40        Oms System Valu
     C           P2BSTX    PARM           WP0014 40        Name USR
     C           P2AUDT    PARM           WP0015  70       BOL Pln Delv Da
     C           P2IHST    PARM P2IHST    WP0016  1        Record Added Us
     C           P2AGTX    PARM           WP0017 40        PD Name
     C           P2A8TX    PARM           WP0018 40        PL Name
     C           P2UMOD    PARM           WP0019  1        User modified:
     C           P2FACD    PARM           WP0020 10        Company Value C
     C           P2WEST    PARM           WP0021  1        SBD Top Load St
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C  N09                EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    OREQ *ZERO                      BOH Buy Order N
     C           #1BONB    OREQ *ZERO                      BOL Load Number
     C           #1B0DT    OREQ *ZERO                      TH Kill Date
     C           #1CVNB    OREQ *ZERO                      TH Tattoo Numbe
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE BBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     BBIN89  1
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB
     C                     Z-ADD#1BNNB    A1BNNB
     C                     Z-ADD#1BONB    A1BONB
     C                     Z-ADD#1CVNB    A1CVNB
     C                     Z-ADD#1B0DT    A1B0DT
     C           KRTV      CHAIN@A1CPC4              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, flip to add mode
     C           *IN90     IFEQ '1'
     C                     MOVEL'ADD'     W0PMD
      * USER: Initialize detail screen (new record)
     C                     Z-ADD*ZERO     #DTZA1           Prior Movement
     C                     MOVELP5QTST    #DQTST           PL Site ID Requ
     C                     MOVELP1LLST    #1LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
      * ** Retrieve Site ID & Producer Subsidiary from Tattoo Header EXT
      * 8/25/2010 Susan changes S000923
      * Market or subject should go get the site id
      * Not Resale get TtoHdrExt - Resale Hog Blank out the site id, & Pr
      * CASE: DTL.TH Hog Class Type is Not Resale
     C           #1LLST    IFEQ 'M'                        *IF
     C           #1LLST    OREQ 'S'
      * ON A ADD THE TATTOO HEADER EXT WILL NOT BE THERE
      * Rtv Site ID/Prod Subs RT - Tattoo Header EXT  * 
     C                     EXSR SARVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DQTST           PL Site ID Requ
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     END                             *FI
     C                     MOVEL'N'       YL0001           TattooPend Set
      * Rtv Sch Shift/Shp Hd  RT - Buy Order Load  * 
     C                     EXSR SBRVGN
      * 9/22/2008 slm
      * do to adding fields to screen set cursor on new rules
      * Set Cursor
      * CASE: PAR.TH Hog Class Type is Market
     C           P1LLST    IFEQ 'M'                        *IF
      * set cursor  --- rules on when to position to Producer subsidary
      * CASE: DTL.BOL Shipped Head is *Zeros
     C           #DLDSH    IFEQ *ZERO                      *IF
      * *Set Cursor: DTL.BOL Shipped Head  (*Override=*YES)
     C                     Z-ADD006       W0ROW1
     C                     Z-ADD060       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.BOL Load Shipped Head is Not Zero
      *   |- c2    : WRK.Producer Subsidiary SUSR is Allow Producer Subsi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DLDSH    IFNE *ZERO                      *IF
     C           WUDJSS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * *Set Cursor: DTL.Producer Subsidary Code  (*Override=*YES)
     C                     Z-ADD007       W0ROW1
     C                     Z-ADD026       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.BOL Load Shipped Head is Not Zero
      *   |- c2    : DTL.PL Site ID Required is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DLDSH    IFNE *ZERO                      *IF
     C           #DQTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * *Set Cursor: DTL.PS Site ID  (*Override=*YES)
     C                     Z-ADD007       W0ROW1
     C                     Z-ADD048       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: DTL.BOL Load Shipped Head is Not Zero
     C           #DLDSH    IFNE *ZERO                      *IF
      * *Set Cursor: DTL.HC Class Code  (*Override=*YES)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD026       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.HC Class Code  (*Override=*NO)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD026       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * set cursor  --- rules on when to position to Class Code
      * CASE: DTL.BOL Load Shipped Head is Not Zero
     C           #DLDSH    IFNE *ZERO                      *IF
      * *Set Cursor: DTL.HC Class Code  (*Override=*YES)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD026       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.HC Class Code  (*Override=*NO)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD026       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELP3AACD    #1LKST           TH Source Code
     C                     MOVELP3IXST    #1KAST           TH Source Type
      * DTL.SR Type Desc = Condition name of PAR.SR Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM P3IXST    W0INVL 25        SR Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DISTX    PARM           W0CNNM 25        SR Type Desc
      *
      * External get state
      * CASE: DTL.TH Source Type is External
     C           #1KAST    IFEQ 'E'                        *IF
     C                     MOVELP5N0TX    #1NZTX           TH State
      * Get the State Code if Producer site id is still required
      * CASE: DTL.PL Site ID Required is Yes
     C           #DQTST    IFEQ 'Y'                        *IF
      * get th state
      * E3814 JJH 10/07/15 - Display PS Premises ID from Producer Site
      * test susan 1
      * Rtv Site State/PremiseRT - Producer Site  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
     C                     END                             *FI
      * External - movement number
      * CASE: DTL.TH Source Type is External
     C           #1KAST    IFEQ 'E'                        *IF
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
     C                     END                             *FI
      * Not live Int Get farm site, state - otherwise par movement
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.MTech Live Yes or No is No MTech not Live
      *   |- c2    : DTL.TH Source Type is Internal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'N'                        *IF
     C           #1KAST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Internal and not live
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
      * CASE: DTL.TH HPS Movement Ref # is Not entered
     C           #1OXNB    IFEQ *ZERO                      *IF
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     MOVEL*BLANK    #1AGCD           GN Genetic Code
     C                     MOVEL'PIC'     #1AGCD           GN Genetic Code
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0001  7        *Return code
     C                     PARM #1OXNB    WQ0002  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0003 25        Farm site Name
     C           #1THHD    PARM *ZERO     WQ0004  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0005  5        HPS FS Comp Rel
     C           #1NZTX    PARM *BLANK    WQ0006  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993538*
     C                     SETON                     39    *
     C                     END
     C                     MOVEL#1NZTX    YL0004           State
     C                     END                             *FI
      * live Int Get farm site, state - otherwise par movement
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.MTech Live Yes or No is Yes MTech is Live
      *   |- c2    : DTL.TH Source Type is Internal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'Y'                        *IF
     C           #1KAST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Internal and live
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
      * CASE: DTL.TH HPS Movement Ref # is Not entered
     C           #1OXNB    IFEQ *ZERO                      *IF
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     Z-ADDP1THHD    #1THHD           TH HPS Farm Sit
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0007  7        *Return code
     C                     PARM *BLANK    WQ0008 25        Farm site Name
     C                     PARM #1THHD    WQ0009  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0010  5        HPS FS Comp Rel
     C           YL0004    PARM *BLANK    WQ0011  3        State
     C                     PARM *BLANK    WQ0012 25        HPS Farm County
     C                     PARM *BLANK    WQ0013  5        HPS Cell Manage
     C                     PARM *BLANK    WQ0014 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0015 20        MTech Farm Site
     C                     PARM *BLANK    WQ0016 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
     C                     END
     C                     MOVELYL0004    #1NZTX           TH State
     C                     END                             *FI
     C                     MOVELP1BICD    #1BICD           TH Group Refere
     C                     MOVELP1E2ST    #1E2ST           TH Sex
     C                     MOVELP1AGCD    #1AGCD           GN Genetic Code
     C                     MOVELP2BSTX    #DBSTX           Name USR
     C                     Z-ADD#1B0DT    #1AWDT           TH Purchase Dat
     C                     MOVELP2AGTX    #DAGTX           PD Name
      * DTL.Description 30 USR = Condition name of DTL.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM #1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DKKTX    PARM           W0CNNM 25        Description 30
      *
     C                     MOVELWUCRTX    YL0005           Return Code USR
      * CASE: DTL.TH Source Type is Internal
     C           #1KAST    IFEQ 'I'                        *IF
      * CASE: DTL.TH HPS Movement Ref # is Entered
     C           #1OXNB    IFNE *ZERO                      *IF
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0005    PARM YL0005    WQ0017  7        Return Code USR
     C                     PARM #1NZTX    WQ0018  3        State
     C           #DLXTX    PARM *BLANK    WQ0019 30        State Desc 30 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0005    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0001           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.TH Source Type is External
     C           #1KAST    IFEQ 'E'                        *IF
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0005    PARM YL0005    WQ0020  7        Return Code USR
     C                     PARM #1NZTX    WQ0021  3        State
     C           #DLXTX    PARM *BLANK    WQ0022 30        State Desc 30 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0005    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0002           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       WUL9ST           Display Output
     C                     MOVEL'N'       WUMAST           Display Output
      * get defects/hd
     C                     EXSR UASUBR                     get defects/hd
     C                     MOVEL'N'       #1J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    #1C2ST           TH Resale Sprea
     C                     MOVEL*BLANK    WUKPST           @Status Interna
      * Retrieve hog classification
      * CASE: DTL.TH Hog Class Type is Resale
     C           #1LLST    IFEQ 'R'                        *IF
      * Rtv Hog Class Resale  RT - Hog Classification  * 
     C                     EXSR SGRVGN
      * CASE: DTL.TH Source Type is Internal
     C           #1KAST    IFEQ 'I'                        *IF
     C                     MOVEL'Y'       WUKPST           @Status Interna
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Hog Class Qualify RT - Hog Classification  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * DTL.HC Class Type Desc Usr = Condition name of DTL.TH Hog Class T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM #1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DE6TX    PARM           W0CNNM 25        HC Class Type D
      *
      * ******************************
      * Load description of pars passed in when a subj,rsl is created for
      * an existing tattoo.
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * Retrieve Group Reference Code (alpha) from HPS  Internal
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : PAR.TH Group Reference NE WRK.Blank USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           P1BICD    IFNE WUCRTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Z1v HPS Grp from Mvmt UP - STR HPS Interface  * 
     C                     CALL 'HP258'                90  Z1v HPS Grp fro
     C           WULMST    PARM WULMST    WQ0023  7        Return Code USR
     C                     PARM #1OXNB    WQ0024  70       TH HPS Movement
     C           #DEPCD    PARM *BLANK    WQ0025  7        HPS Group Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP258'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0003    IFEQ 'Y'                        *IF
     C                     END                             *FI
     C                     END                             *FI
      * Get Sex name
      * CASE: DTL.TH Sex NE WRK.Blank USR
     C           #1E2ST    IFNE WUCRTX                     *IF
      * DTL.Sex Desc Usr = Condition name of PAR.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM P1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
     C                     END                             *FI
      * Check producer for Insured, to diplay on screen
      * 5/16/2017 PASS in company number for STD D/a
      * Rtv/Chk Prdcr for Ins XF - Deduction/Addition  * 
     C                     CALL 'PKGDXFR'              90  Rtv/Chk Prdcr f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ABCD    WQ0026  6        PD Producer Cod
     C           WUABST    PARM *BLANK    WQ0027  1        @Status (Yes/No
     C                     PARM P1HMNB    WQ0028  30       PSDP Company Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKGDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Insured
      * CASE: WRK.@Status (Yes/No) is Yes
     C           WUABST    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   #DK5TX           Text 9 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DK5TX           Text 9 USR
     C                     END                             *FI
     C                     MOVEL'N'       #1LJST           TH Shift Held O
      * *----------------------------------------------------------*
      * * 01/23/03 PKD Retrieve the Movement Reference from Delivery
      *                Schedule to default.  If not in the Schedule
      *                Then retrieve it from the Tracking.
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * Externals and internals
      * Rtv Mvmnt,Farm f/BOL  RT - Delivery Sched Detail  * 
     C                     EXSR SIRVGN
      * If TH HPS Movement Ref # is zeros, retrieve value
      * CASE: DTL.TH HPS Movement Ref # EQ WRK.Zero USR
     C           #1OXNB    IFEQ WUE9NB                     *IF
      * Rtv Movement Number   RT - Delivery Tracking  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
      * If TH HPS Movement Ref # is still zeros - load default value
      * CASE: DTL.TH HPS Movement Ref # EQ WRK.Zero USR
     C           #1OXNB    IFEQ WUE9NB                     *IF
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------*
      * *----------------------------------------------------------*
      * Rtv Delivery TrackInf XF - Delivery Tracking  * 
     C                     CALL 'PLS3XFR'              90  Rtv Delivery Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0029  50       DT Farm Site Co
     C           #DK0CD    PARM *BLANK    WQ0030  5        DT Building
     C           #DK1CD    PARM *BLANK    WQ0031  5        DT Room
     C           #DLFCD    PARM *BLANK    WQ0032  5        DT Sire Line Co
     C                     PARM P1HMNB    WQ0033  30       BOH Company Num
     C                     PARM P1BNNB    WQ0034  70       BOH Buy Order N
     C                     PARM P1BONB    WQ0035  50       BOL Load Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLS3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * If record does exist, flip to change mode
     C                     MOVEL'CHG'     W0PMD
      * Load screen fields from DBF
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * DTL.TH Live Purch UOM  Usr = Condition name of DTL.TH Live Purcha
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM #1CPST    W0INVL 25        TH Live Purchas
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEPTX    PARM           W0CNNM 25        TH Live Purch U
      *
      * DTL.Sex Desc Usr = Condition name of DTL.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM #1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR SKRVGN
     C                     MOVEL'Y'       WUNEST           Ship Wgt Allow
      * Test of allow ship weight to be input/output
      * CASE: DTL.TH Payment Sts is Paid Anything
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over Record is Yes
     C           #1E1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test of held over quanity
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
      * USER: Initialize detail screen (existing record)
     C                     Z-ADDA1OXNB    #DTZA1           Prior Movement
     C                     MOVELP1LLST    #1LLST           TH Hog Class Ty
     C                     MOVELP5QTST    #DQTST           PL Site ID Requ
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
      * ** Retrieve Site ID & Producer Subsidiary from Tattoo Header EXT
      * NOT Resale get Tattoo hdr ext , Rsl hogs set to blks site id & pr
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           A1LLST    IFEQ 'M'                        *IF
     C           A1LLST    OREQ 'S'
      * Rtv Site ID/Prod Subs RT - Tattoo Header EXT  * 
     C                     EXSR SLRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DQTST           PL Site ID Requ
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     END                             *FI
      * The Bol Shipped Head is maintain in this program at the Tattoo Le
      * so regardless this field represents the shipped head for the load
      * Rtv Shipped Head      RT - Buy Order Load  * 
     C                     EXSR SMRVGN
      * 9/22/2008 slm
      * move set cursor to lower part of processing
      * do to adding fields to screen set cursor on new rules
      * Set Cursor
      * CASE: PAR.TH Hog Class Type is Market
     C           P1LLST    IFEQ 'M'                        *IF
      * set cursor  --- rules on when to position to Producer subsidary
      * CASE: DTL.BOL Shipped Head is *Zeros
     C           #DLDSH    IFEQ *ZERO                      *IF
      * *Set Cursor: DTL.BOL Shipped Head  (*Override=*YES)
     C                     Z-ADD006       W0ROW1
     C                     Z-ADD060       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.BOL Load Shipped Head is Not Zero
      *   |- c2    : WRK.Producer Subsidiary SUSR is Allow Producer Subsi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DLDSH    IFNE *ZERO                      *IF
     C           WUDJSS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * *Set Cursor: DTL.Producer Subsidary Code  (*Override=*YES)
     C                     Z-ADD007       W0ROW1
     C                     Z-ADD026       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.BOL Load Shipped Head is Not Zero
      *   |- c2    : DTL.PL Site ID Required is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DLDSH    IFNE *ZERO                      *IF
     C           #DQTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * *Set Cursor: DTL.PS Site ID  (*Override=*YES)
     C                     Z-ADD007       W0ROW1
     C                     Z-ADD048       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: DTL.BOL Load Shipped Head is Not Zero
     C           #DLDSH    IFNE *ZERO                      *IF
      * *Set Cursor: DTL.HC Class Code  (*Override=*YES)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD026       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.HC Class Code  (*Override=*NO)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD026       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * set cursor  --- rules on when to position to Class Code
      * CASE: DTL.BOL Load Shipped Head is Not Zero
     C           #DLDSH    IFNE *ZERO                      *IF
      * *Set Cursor: DTL.HC Class Code  (*Override=*YES)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD026       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.HC Class Code  (*Override=*NO)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD026       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       YL0007           Record Change U
      * DTL.Description 30 USR = Condition name of DTL.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM #1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DKKTX    PARM           W0CNNM 25        Description 30
      *
     C                     MOVELP2AGTX    #DAGTX           PD Name
     C                     MOVELP2A8TX    #DA8TX           PL Name
      * DTL.TH Live Purch UOM  Usr = Condition name of DB1.TH Live Purcha
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM A1CPST    W0INVL 25        TH Live Purchas
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEPTX    PARM           W0CNNM 25        TH Live Purch U
      *
      * DTL.Sex Desc Usr = Condition name of DB1.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM A1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
      * Rtv Hog Class Desc    RT - Hog Classification  * 
     C                     EXSR SNRVGN
     C                     MOVELP2BSTX    #DBSTX           Name USR
     C                     MOVELP3AACD    #1LKST           TH Source Code
     C                     MOVELP3IXST    #1KAST           TH Source Type
      * DTL.SR Type Desc = Condition name of PAR.SR Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM P3IXST    W0INVL 25        SR Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DISTX    PARM           W0CNNM 25        SR Type Desc
      *
      * State code - Prod, or producer site, or external
      * CASE: PAR.SR Type is External
     C           P3IXST    IFEQ 'E'                        *IF
      * Placed TH STATE CODE on the screen, def either prd loc, or site i
      * Rtv vendor info & site information from the producer
      * CASE: DTL.TH State EQ WRK.Blank USR
     C           #1NZTX    IFEQ WUCRTX                     *IF
     C                     MOVELP5N0TX    #1NZTX           TH State
      * CASE: DTL.PL Site ID Required is Yes
     C           #DQTST    IFEQ 'Y'                        *IF
      * get th state
      * E3814 JJH 10/07/15 - Display PS Premises ID from Producer Site
      * test susan 2
      * Rtv Site State/PremiseRT - Producer Site  * 
     C                     EXSR SORVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      * State code - mtech live and internals only
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.MTech Live Yes or No is Yes MTech is Live
      *   |- c2    : PAR.SR Type is Internal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'Y'                        *IF
     C           P3IXST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Get the State Code from the Farm Site
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0036  7        *Return code
     C                     PARM *BLANK    WQ0037 25        Farm site Name
     C                     PARM #1THHD    WQ0038  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0039  5        HPS FS Comp Rel
     C           #1NZTX    PARM *BLANK    WQ0040  3        State
     C           WUQGTX    PARM *BLANK    WQ0041 25        HPS Farm County
     C           WUJXCD    PARM *BLANK    WQ0042  5        HPS Cell Manage
     C           WUQFTX    PARM *BLANK    WQ0043 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0044 20        MTech Farm Site
     C                     PARM *BLANK    WQ0045 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993839*
     C                     END
     C                     END                             *FI
      * State code - mtech NOT live and internals only
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.MTech Live Yes or No is No MTech not Live
      *   |- c2    : PAR.SR Type is Internal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'N'                        *IF
     C           P3IXST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Placed TH STATE on the screen, FROM the farm site get the state
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0046  7        *Return code
     C                     PARM #1OXNB    WQ0047  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0048 25        Farm site Name
     C           #1THHD    PARM *ZERO     WQ0049  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0050  5        HPS FS Comp Rel
     C           #1NZTX    PARM *BLANK    WQ0051  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993538*
     C                     SETON                     39    *
     C                     END
     C                     MOVEL#1NZTX    YL0004           State
     C                     END                             *FI
     C                     MOVELWUCRTX    YL0005           Return Code USR
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0005    PARM YL0005    WQ0052  7        Return Code USR
     C                     PARM #1NZTX    WQ0053  3        State
     C           #DLXTX    PARM *BLANK    WQ0054 30        State Desc 30 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0005    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0003           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
      * The Bol Shipped Head is maintain in this program at the Tattoo Le
      * so regardless this field represents the shipped head for the load
      * Rtv Shipped Head      RT - Buy Order Load  * 
     C                     EXSR SPRVGN
      * DTL.HC Class Type Desc Usr = Condition name of DTL.TH Hog Class T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM #1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DE6TX    PARM           W0CNNM 25        HC Class Type D
      *
     C                     MOVELA1C2ST    #1C2ST           TH Resale Sprea
     C                     MOVEL*BLANK    WUKPST           @Status Interna
     C                     MOVEL'N'       WUL9ST           Display Output
     C                     MOVEL'N'       WUMAST           Display Output
      * MKT: Hide defect/head fields  and pen/hd recvd
      * CASE: DTL.TH Hog Class Type is Market
     C           #1LLST    IFEQ 'M'                        *IF
     C                     MOVEL'Y'       WUL9ST           Display Output
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Hog Class Type is Subject
      *   |- c2    : DTL.TH Source Type is External
      *   '-
     C           #1LLST    IFEQ 'S'                        *IF
     C           #1KAST    OREQ 'E'                        *OR
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     END                             *FI
     C                     END                             *FI
      * Set flag to display unweighed resale pen & received hd, get pen
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : DTL.TH Hog Class Type is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           #1LLST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUKPST           @Status Interna
      * Protect the defect/head/pen fields if tattoo has been weighed.
      * CASE: DTL.TH Resale Spread Sts is Spread
     C           #1C2ST    IFEQ 'P'                        *IF
     C                     MOVEL'Y'       WUL9ST           Display Output
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     END                             *FI
     C                     END                             *FI
      * Get Defect/Hd
     C                     EXSR UBSUBR                     Get Defect/Hd
      * Save input fields to check for changes later
     C                     MOVEL#1CPST    WUCPST           TH Live Purchas
     C                     Z-ADD#1ACPR    WUACPR           TH Live Purchas
     C                     MOVEL#1AGCD    WUAGCD           GN Genetic Code
     C                     Z-ADD#1HGNB    WUHGNB           TH Shipped Weig
      * Check producer for Insured, to diplay on screen
      * Rtv/Chk Prdcr for Ins XF - Deduction/Addition  * 
     C                     CALL 'PKGDXFR'              90  Rtv/Chk Prdcr f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ABCD    WQ0055  6        PD Producer Cod
     C           WUABST    PARM *BLANK    WQ0056  1        @Status (Yes/No
     C                     PARM P1HMNB    WQ0057  30       PSDP Company Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKGDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Insured
      * CASE: WRK.@Status (Yes/No) is Yes
     C           WUABST    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   #DK5TX           Text 9 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DK5TX           Text 9 USR
     C                     END                             *FI
      * Rtv Delivery TrackInf XF - Delivery Tracking  * 
     C                     CALL 'PLS3XFR'              90  Rtv Delivery Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0058  50       DT Farm Site Co
     C           #DK0CD    PARM *BLANK    WQ0059  5        DT Building
     C           #DK1CD    PARM *BLANK    WQ0060  5        DT Room
     C           #DLFCD    PARM *BLANK    WQ0061  5        DT Sire Line Co
     C                     PARM A1HMNB    WQ0062  30       BOH Company Num
     C                     PARM A1BNNB    WQ0063  70       BOH Buy Order N
     C                     PARM A1BONB    WQ0064  50       BOL Load Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLS3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check restriction within
     C                     EXSR VBCKRL
      * TH Tattoo Number required
     C           #1CVNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE CBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     CBIN89  1
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Validate TH Sex
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1E2ST'  IFEQ YPMTFD
      * TH Sex
     C                     MOVEL#1E2ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHE2ST
     C                     SELEC
     C           W0INVL    WHEQ 'M'                        M
     C                     Z-ADD1         ZHE2ST
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD2         ZHE2ST
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD3         ZHE2ST
     C                     ENDSL
     C                     EXFMTZGE2ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHE2ST    WHEQ 1
     C                     MOVEL'M'       W0INVL           M
     C           ZHE2ST    WHEQ 2
     C                     MOVEL'F'       W0INVL           F
     C           ZHE2ST    WHEQ 3
     C                     MOVEL'X'       W0INVL           X
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1E2ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate TH Schedule Kill Shift
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1LIST'  IFEQ YPMTFD
      * TH Schedule Kill Shift
     C                     MOVEL#1LIST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHLIST
     C                     SELEC
     C           W0INVL    WHEQ '1'                        1
     C                     Z-ADD1         ZHLIST
     C           W0INVL    WHEQ '2'                        2
     C                     Z-ADD2         ZHLIST
     C           W0INVL    WHEQ '3'                        3
     C                     Z-ADD3         ZHLIST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD4         ZHLIST
     C                     ENDSL
     C                     EXFMTZGLIST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHLIST    WHEQ 1
     C                     MOVEL'1'       W0INVL           1
     C           ZHLIST    WHEQ 2
     C                     MOVEL'2'       W0INVL           2
     C           ZHLIST    WHEQ 3
     C                     MOVEL'3'       W0INVL           3
     C           ZHLIST    WHEQ 4
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1LIST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate TH Live Purchase UOM
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1CPST'  IFEQ YPMTFD
      * TH Live Purchase UOM
     C                     MOVEL#1CPST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHCPST
     C                     SELEC
     C           W0INVL    WHEQ 'FL'                       FL
     C                     Z-ADD1         ZHCPST
     C           W0INVL    WHEQ 'LW'                       LW
     C                     Z-ADD2         ZHCPST
     C           W0INVL    WHEQ 'NH'                       NH
     C                     Z-ADD3         ZHCPST
     C           W0INVL    WHEQ 'NL'                       NL
     C                     Z-ADD4         ZHCPST
     C           W0INVL    WHEQ 'SW'                       SW
     C                     Z-ADD5         ZHCPST
     C           W0INVL    WHEQ 'LX'                       LX
     C                     Z-ADD6         ZHCPST
     C           W0INVL    WHEQ 'SX'                       SX
     C                     Z-ADD7         ZHCPST
     C                     ENDSL
     C                     EXFMTZGCPST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHCPST    WHEQ 1
     C                     MOVEL'FL'      W0INVL           FL
     C           ZHCPST    WHEQ 2
     C                     MOVEL'LW'      W0INVL           LW
     C           ZHCPST    WHEQ 3
     C                     MOVEL'NH'      W0INVL           NH
     C           ZHCPST    WHEQ 4
     C                     MOVEL'NL'      W0INVL           NL
     C           ZHCPST    WHEQ 5
     C                     MOVEL'SW'      W0INVL           SW
     C           ZHCPST    WHEQ 6
     C                     MOVEL'LX'      W0INVL           LX
     C           ZHCPST    WHEQ 7
     C                     MOVEL'SX'      W0INVL           SX
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1CPST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR TCRVGN
      * Rtv Pdctn Loc Name    RT - Producer Location  * 
     C                     EXSR TDRVGN
      * Rtv Hog Class         RT - Hog Classification  * 
     C                     EXSR TERVGN
      * DTL.SR Type Desc = Condition name of DTL.TH Source Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM #1KAST    W0INVL 25        TH Source Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DISTX    PARM           W0CNNM 25        SR Type Desc
      *
      * CASE: DTL.PL Site ID Required is Yes
     C           #DQTST    IFEQ 'Y'                        *IF
      * E10370 JJH 06/22/17 - Select Record Logic for Producer Site
      * E11249 JJH 08/29/17 - Only allow a Producer Site that has Produce
      *   Site Mileage for the Company
      * ** F4 = Select Producer Site ID to get mileage and or state code
      * CASE:
      *  - c2 AND c1
      *   |- c2    : DTL.*CMD key is *Prompt
      *   |- c1    : PGM.*Cursor field <IS> DTL.PS Site ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNYCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Prod Site Mileage SR - Producer Site Mileage  * 
     C                     CALL 'PLFQSRR'              90  Sel Prod Site M
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ABCD    WQ0075  6        PD Producer Cod
     C           #DNYCD    PARM #DNYCD    WQ0076 10        PS Site ID
     C                     PARM P1HMNB    WQ0077  30       PSM Company Num
     C           YL0008    PARM *ZERO     WQ0078  50       PSM Miles to Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLFQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
      * Rtv Site State ActOnlyRT - Producer Site  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
      * E10370 JJH 06/26/17 - Do not perform this logic if Source Code=TO
      * E11249 JJH 08/29/17 - Only allow a Producer Site that has Produce
      *   Site Mileage for the Company
      * CASE: DTL.TH Hog Class Type is Not Resale
     C           #1LLST    IFEQ 'M'                        *IF
     C           #1LLST    OREQ 'S'
      * Site ID will not be required on Resale Hogs
      * E00151 5/16/2008 SLM -- VALIDATE IF REQUIRED REGARDLESS OF CONTRA
      * * do not want to validate on contract
      * validate producer site id if required regardless of contract
      * ** Error if Site ID is blank
      * CASE: DTL.PS Site ID is *Blank
     C           #DNYCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DNYCD    ZA0004           PS Site ID
      * Send message 'Producer Site ID Required'
     C                     MOVEL'PRK1140' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * ** 1/4/06 LJB - If Site ID is entered, there must first
      * **   be a record in the Producer Site Mileage file.
      * **   Error if there is not.
      * Rtv PrdSiteMil CoMilStRT - Producer Site Mileage  * 
     C                     EXSR TGRVGN
      * ** Error if no matching record in Producer Site Mileage
      * CASE: LCL.PSM Miles to Company is No Miles
     C           YL0008    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DNYCD    ZA0005           PS Site ID
      * Send message 'Producer Site/Mileage NF'
     C                     MOVEL'PRK1153' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: DTL.TH State EQ WRK.Blank USR
     C           #1NZTX    IFEQ WUCRTX                     *IF
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0006           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Select on Producer Subsidiary
      * CASE: WRK.Producer Subsidiary SUSR is Allow Producer Subsidiary
     C           WUDJSS    IFEQ 'Y'                        *IF
      * ** F4 = Select Producer subsidiary
      * CASE:
      *  - c2 AND c1
      *   |- c2    : DTL.*CMD key is *Prompt
      *   |- c1    : PGM.*Cursor field <IS> DTL.Producer Subsidary Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DOVCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel ProdSubsidiary    SR - Producer Subsidiary  * 
     C                     CALL 'PLM2SRR'              90  Sel ProdSubsidi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ABCD    WQ0079  6        PD Producer Cod
     C           #DOVCD    PARM #DOVCD    WQ0080  6        Producer Subsid
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLM2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Validation on Producer subsidiary
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Producer Subsidary Code is Blank
      *   |- c2    : WRK.Producer Subsidiary SUSR is Allow Producer Subsi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DOVCD    IFEQ *BLANK                     *IF
     C           WUDJSS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DOVCD    ZA0007           Producer Subsid
      * Send message 'Producer Subsidiary Req'
     C                     MOVEL'PRK1215' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Producer Subsidary Code is Entered
      *   |- c2    : WRK.Producer Subsidiary SUSR is Allow Producer Subsi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DOVCD    IFNE *BLANK                     *IF
     C           WUDJSS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Val ProdSubsidiary    RT - Producer Subsidiary  * 
     C                     EXSR TIRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DOVCD    ZA0008           Producer Subsid
      * Send message 'Producer Subsidiary NotFn'
     C                     MOVEL'PRK1216' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * F4  on Defects
     C                     EXSR UCSUBR                     F4  on Defects
      * Validate Defects & bring back classification
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10 OR
      *  -  c11
      *   |- c1    : WRK.HC Defect Required is Yes
      *   |- c2    : DTL.Defect User  1 is Entered
      *   |- c3    : DTL.Defect User  2 is Entered
      *   |- c4    : DTL.Defect User  3 is Entered
      *   |- c5    : DTL.Defect User  4 is Entered
      *   |- c6    : DTL.Defect User  5 is Entered
      *   |- c7    : DTL.Defect User  6 is Entered
      *   |- c8    : DTL.Defect User  7 is Entered
      *   |- c9    : DTL.Defect User  8 is Entered
      *   |- c10   : DTL.Defect User  9 is Entered
      *   |- c11   : DTL.Defect User 10 is Entered
      *   '-
     C           WUBXST    IFEQ 'Y'                        *IF
     C           #DGUCD    ORNE *BLANK                     *OR
     C           #DGVCD    ORNE *BLANK                     *OR
     C           #DGWCD    ORNE *BLANK                     *OR
     C           #DGXCD    ORNE *BLANK                     *OR
     C           #DGYCD    ORNE *BLANK                     *OR
     C           #DGZCD    ORNE *BLANK                     *OR
     C           #DG0CD    ORNE *BLANK                     *OR
     C           #DG1CD    ORNE *BLANK                     *OR
     C           #DG2CD    ORNE *BLANK                     *OR
     C           #DG3CD    ORNE *BLANK                     *OR
      * Val def 1
      * CASE: DTL.Defect User  1 NE WRK.Blank Usr 1 fld Usr
     C           #DGUCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TJRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGUCD    ZA0009           Defect User  1
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 2
      * CASE: DTL.Defect User  2 NE WRK.Blank Usr 1 fld Usr
     C           #DGVCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TKRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGVCD    ZA0010           Defect User  2
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 3
      * CASE: DTL.Defect User  3 NE WRK.Blank Usr 1 fld Usr
     C           #DGWCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TLRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGWCD    ZA0011           Defect User  3
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 4
      * CASE: DTL.Defect User  4 NE WRK.Blank Usr 1 fld Usr
     C           #DGXCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TMRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGXCD    ZA0012           Defect User  4
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 5
      * CASE: DTL.Defect User  5 NE WRK.Blank Usr 1 fld Usr
     C           #DGYCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TNRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGYCD    ZA0013           Defect User  5
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9955  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 6
      * CASE: DTL.Defect User  6 NE WRK.Blank Usr 1 fld Usr
     C           #DGZCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TORVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGZCD    ZA0014           Defect User  6
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 7
      * CASE: DTL.Defect User  7 NE WRK.Blank Usr 1 fld Usr
     C           #DG0CD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TPRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DG0CD    ZA0015           Defect User  7
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9959  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 8
      * CASE: DTL.Defect User  8 NE WRK.Blank Usr 1 fld Usr
     C           #DG1CD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TQRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DG1CD    ZA0016           Defect User  8
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9961  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 9
      * CASE: DTL.Defect User  9 NE WRK.Blank Usr 1 fld Usr
     C           #DG2CD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TRRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DG2CD    ZA0017           Defect User  9
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9963  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 10
      * CASE: DTL.Defect User 10 NE WRK.Blank Usr 1 fld Usr
     C           #DG3CD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TSRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DG3CD    ZA0018           Defect User 10
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9965  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.HC Defect Required is Yes
     C           WUBXST    IFEQ 'Y'                        *IF
      * Validation of defects
      * CASE: DTL.Defect User  1 NE WRK.Blank Usr 1 fld Usr
     C           #DGUCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  2 NE WRK.Blank Usr 1 fld Usr
     C           #DGVCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  3 NE WRK.Blank Usr 1 fld Usr
     C           #DGWCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  4 NE WRK.Blank Usr 1 fld Usr
     C           #DGXCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  5 NE WRK.Blank Usr 1 fld Usr
     C           #DGYCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  6 NE WRK.Blank Usr 1 fld Usr
     C           #DGZCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  7 NE WRK.Blank Usr 1 fld Usr
     C           #DG0CD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  8 NE WRK.Blank Usr 1 fld Usr
     C           #DG1CD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  9 NE WRK.Blank Usr 1 fld Usr
     C           #DG2CD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User 10 NE WRK.Blank Usr 1 fld Usr
     C           #DG3CD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Defect required for class'
     C                     MOVEL'PRK0357' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate class code against class type.
      * CASE: WRK.TH Hog Class Type NE DTL.TH Hog Class Type
     C           WULLST    IFNE #1LLST                     *IF
      * Setup message data for message
     C                     MOVEL#1LLST    ZA0019           TH Hog Class Ty
     C                     MOVEL#1BECD    ZA0020           HC Class Code
      * Send message 'Class code inval for type'
     C                     MOVEL'PRK0601' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
      * Prompt on Pen
      * CASE: WRK.Display Output Only 2 USR is No
     C           WUMAST    IFEQ 'N'                        *IF
      * F4  on Pen
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Pen Number
     C           W0CFL     IFEQ '#DCMCD'                   *IF
      * Sel Pen Open/Hc Type  SR - Pen  * 
     C                     CALL 'PKJWSRR'              90  Sel Pen Open/Hc
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0091  30       Pen Company Num
     C           #DCMCD    PARM *BLANK    WQ0092  3        Pen Number
     C                     PARM #1LLST    WQ0093  1        TH Hog Class Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Load Shipped head   *
      * CASE: DTL.BOL Load Shipped Head is *Zeros
     C           #DLDSH    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#DLDSH    ZA0021           BOL Shipped Hea
      * Send message 'Enter Head On BOL'
     C                     MOVEL'PRK0911' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.BOL Shipped Head is GT 250
     C           #DLDSH    IFGT 265                        *IF
      * Send message 'Head cannot exceed 250.'
     C                     MOVEL'PRK0774' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Rtv EDI Trading Prt#
      * CASE: DTL.TH Source Type is External
     C           #1KAST    IFEQ 'E'                        *IF
      * Rtv EDI Trading Prt#  RT - Producer  * 
     C                     EXSR TTRVGN
     C                     END                             *FI
      * ** Don't exchange the screen field and the hidden state field
      * ** Just use the screen state field.      03/07/2006 LJB
     C                     MOVELWUCRTX    YL0005           Return Code USR
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : DTL.TH HPS Movement Ref # is Not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           #1OXNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    #DLXTX           State Desc 15 U
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0005    PARM YL0005    WQ0094  7        Return Code USR
     C                     PARM #1NZTX    WQ0095  3        State
     C           #DLXTX    PARM *BLANK    WQ0096 30        State Desc 30 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0005    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0022           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
      * Invalid state code send message if state code is blank
      * CASE: DTL.TH State is Entered
     C           #1NZTX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0023           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate live price and UOM
      * CASE: DTL.TH Payment Sts is Paid Producer
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate live price and live price UOM
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Live Purchase Price is Not Zeros
      *   |- c2    : DTL.TH Live Purchase UOM NE WRK.Blank USR
      *   '-
     C           #1ACPR    IFNE *ZERO                      *IF
     C           #1CPST    ORNE WUCRTX                     *OR
      * CASE: DTL.TH Live Purchase UOM EQ WRK.Blank USR
     C           #1CPST    IFEQ WUCRTX                     *IF
      * Send message 'UOM Required if lv price'
     C                     MOVEL'PRK0382' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rsl/Int -- Sum Defect hd for Head Total Usr
      * CASE: WRK.@Status Internal (Y/N) is Yes
     C           WUKPST    IFEQ 'Y'                        *IF
      *  Sum head up to HD RCVD if there arent any Scale Wgt Req defects
      * Chk Def Scale Wt Req  IF
      * If any defect has scale weight required, quit checking the defect
     C                     MOVEL'N'       WUR3ST           Scale Wt Requir
      * CASE: PAR.Defect User  1 NE WRK.Blank USR
     C           #DGUCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TURVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  2 NE WRK.Blank USR
     C           #DGVCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TVRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  3 NE WRK.Blank USR
     C           #DGWCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TWRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  4 NE WRK.Blank USR
     C           #DGXCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TXRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  5 NE WRK.Blank USR
     C           #DGYCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TYRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  6 NE WRK.Blank USR
     C           #DGZCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TZRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  7 NE WRK.Blank USR
     C           #DG0CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NARVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  8 NE WRK.Blank USR
     C           #DG1CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NBRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  9 NE WRK.Blank USR
     C           #DG2CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NCRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User 10 NE WRK.Blank USR
     C           #DG3CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NDRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * If Defect Scale Weight is Required or Sts is Spread dont calc hea
      * CASE: WRK.Scale Wt Required     USR is Yes
     C           WUR3ST    IFEQ 'Y'                        *IF
      * In CHANGE mode, a "M"ark for future spread cant be changed to lit
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Resale Spread Sts is Mark for Future Sprd Wgt
      *   |- c2    : PGM.*Program mode is *CHANGE
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1C2ST    IFEQ 'M'                        *IF
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Scale Weight required def'
     C                     MOVEL'PRK0779' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #DB5NB           Head Total USR
     C                     MOVEL*BLANK    #DCMCD           Pen Number
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Resale Spread Status
      * CASE: DTL.TH Resale Spread Sts is Spread
     C           #1C2ST    IFEQ 'P'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       #1C2ST           TH Resale Sprea
     C                     MOVEL'N'       WUMAST           Display Output
      * Rsl/Int-- Sum Defect head
      * DTL.Head Total USR =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10)
      * x1    : DTL.Defect HD user 1
      * +     : PGM.*Synon (17,7) work field
      * x2    : DTL.Defect HD user 2
      * +     : PGM.*Synon (17,7) work field
      * x3    : DTL.Defect HD user 3
      * +     : PGM.*Synon (17,7) work field
      * x4    : DTL.Defect HD user 4
      * +     : PGM.*Synon (17,7) work field
      * x5    : DTL.Defect HD user 5
      * +     : PGM.*Synon (17,7) work field
      * x6    : DTL.Defect HD user 6
      * +     : PGM.*Synon (17,7) work field
      * x7    : DTL.Defect HD user 7
      * +     : PGM.*Synon (17,7) work field
      * x8    : DTL.Defect HD user 8
      * +     : PGM.*Synon (17,7) work field
      * x9    : DTL.Defect HD user 9
      * +     : PGM.*Synon (17,7) work field
      * x10   : DTL.Defect HD user 10
     C           #DF1NB    ADD  #DFWNB    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  #DFYNB    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  #DFUNB    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  #DO3NB    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  #DO4NB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  #DO5NB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  #DFONB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  #DFXNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  #DFTNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    #DB5NB           Head Total USR
     C                     END                             *FI
      * Validate Pen
      * CASE: Empty and marked for spread
      *  - c1 AND c2
      *   |- c1    : DTL.Pen Number is Pen Number is Empty
      *   |- c2    : DTL.TH Resale Spread Sts is Mark for Future Sprd Wgt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DCMCD    IFEQ *BLANK                     *IF
     C           #1C2ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DCMCD    ZA0024           Pen Number
      * Send message 'Pen is req for rsl/int'
     C                     MOVEL'PRK0780' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Pen if not Empty.
      * CASE: DTL.Pen Number is Pen Number not Empty
     C           #DCMCD    IFGT *BLANK                     *IF
     C                     MOVELWUCRTX    WUFWST           Pen Type
      * Rtv Val Pen,Type      RT - Pen  * 
     C                     EXSR NERVGN
      * CASE: WRK.Pen Type is Resale
     C           WUFWST    IFEQ 'R'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Pen Type EQ WRK.Blank USR
     C           WUFWST    IFEQ WUCRTX                     *IF
      * Send message 'Pen                    NF'
     C                     MOVEL'PRK0065' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCMCD    ZA0025           Pen Number
     C                     MOVEL#1LLST    ZA0026           TH Hog Class Ty
     C                     MOVELWUFWST    ZA0027           Pen Type
      * Send message 'Pen type not the same as'
     C                     MOVEL'PRK0606' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Int -- Val Movement & Grp Refs If Not Mtech,If Mtech No validatio
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : LCL.MTech Live Yes or No is No MTech not Live
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Validate Movement Reference Number
      * CASE: DTL.TH HPS Movement Ref # EQ WRK.Zero USR
     C           #1OXNB    IFEQ WUE9NB                     *IF
      * Send message 'Movement Rfrnc Invalid'
     C                     MOVEL'PRK0535' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Z1l HPS Movement Rfrn UP - STR HPS Interface  * 
     C                     CALL 'HP251'                90  Z1l HPS Movemen
     C           WULMST    PARM WULMST    WQ0097  7        Return Code USR
     C                     PARM #1OXNB    WQ0098  70       TH HPS Movement
     C           WUSHDT    PARM *ZERO     WQ0099  80       Scheduled Kill
     C           WULDSH    PARM *ZERO     WQ0100  50       Scheduled Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP251'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
     C                     END
      * CASE: DTL.BOL Shipped Head is *Zeros
     C           #DLDSH    IFEQ *ZERO                      *IF
     C                     Z-ADDWULDSH    YL0009           BOL Shipped Hea
     C                     END                             *FI
      * CASE: WRK.Return Code USR is HPS Movement Rfrnc Err 1
     C           WULMST    IFEQ 'HPSM1'                    *IF
      * Send message 'Movement Rfrnc Invalid'
     C                     MOVEL'PRK0535' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.TH HPS Movement Ref # NE WRK.TH HPS Movement Ref #
     C           #1OXNB    IFNE WUOXNB                     *IF
     C                     Z-ADD#1OXNB    WUOXNB           TH HPS Movement
     C                     END                             *FI
     C                     ELSE
      * CASE: If Internal but Live with Mtech No validation
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : LCL.MTech Live Yes or No is Yes MTech is Live
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.TH HPS Movement Ref # NE WRK.TH HPS Movement Ref #
     C           #1OXNB    IFNE WUOXNB                     *IF
     C                     Z-ADD#1OXNB    WUOXNB           TH HPS Movement
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If Tattoo not already paid, set up payment sts
      * CASE: DTL.TH Payment Sts is Paid Producer
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv BOH Pay Type      RT - Buy Order Header  * 
     C                     EXSR NFRVGN
      * Set Payment Status
      * CASE: DTL.TH Live Purchase UOM is Live Payment
     C           #1CPST    IFEQ 'FL'                       *IF
     C           #1CPST    OREQ 'LW'
     C           #1CPST    OREQ 'NH'
     C           #1CPST    OREQ 'NL'
     C           #1CPST    OREQ 'SW'
     C           #1CPST    OREQ 'LX'
     C           #1CPST    OREQ 'SX'
      * Internal or External Live
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
     C                     MOVEL'IL'      #1CWST           TH Payment Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SL'      #1CWST           TH Payment Sts
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.TH Hog Class Type is Not Market
     C           #1LLST    IFEQ 'R'                        *IF
     C           #1LLST    OREQ 'S'
      * Live - Internal or External
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
     C                     MOVEL'IL'      #1CWST           TH Payment Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SL'      #1CWST           TH Payment Sts
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.BOH Payment Type is Carcass Merit
     C           WUA4ST    IFEQ 'C'                        *IF
      * Carcass Merit - Internal or External
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
     C                     MOVEL'IC'      #1CWST           TH Payment Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SC'      #1CWST           TH Payment Sts
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Live - Internal or External
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
     C                     MOVEL'IL'      #1CWST           TH Payment Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SL'      #1CWST           TH Payment Sts
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * Rtv Std Time,buyer    RT - Producer  * 
     C                     EXSR NGRVGN
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Tattoo Header Process
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Producer Location
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Buyer
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Genetic
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9940  *
     C                     END
      * Check reference to Hog Classification
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9934  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
      * DTL.TH Live Purch UOM  Usr = Condition name of DTL.TH Live Purcha
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM #1CPST    W0INVL 25        TH Live Purchas
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEPTX    PARM           W0CNNM 25        TH Live Purch U
      *
      * DTL.Sex Desc Usr = Condition name of DTL.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM #1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR NHRVGN
     C                     MOVEL'Y'       WUNEST           Ship Wgt Allow
      * Test of allow ship weight to be input/output
      * CASE: DTL.TH Payment Sts is Paid Anything
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over Record is Yes
     C           #1E1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test of held over quanity
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is CF03
      *   |- c2    : DTL.*CMD key is *Add
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN03     IFEQ '1'                        *IF
     C           *IN09     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv and UnAssigned    RT - Tattoo Pending  * 
     C                     EXSR NIRVGN
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Shipped Weight Validation
      * CASE: DTL.TH Live Purchase UOM is Shipped Weight List
     C           #1CPST    IFEQ 'SW'                       *IF
     C           #1CPST    OREQ 'SX'
      * CASE: WRK.Held Over Records Y/N is Yes
     C           WUNFST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.TH Shipped Weight is Greater then Zero
     C           #1HGNB    IFGT *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1HGNB    ZA0028           TH Shipped Weig
      * Send message 'Shipped Weight is Requird'
     C                     MOVEL'PRK0653' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Status
      * CASE: DTL.TH Payment Sts is Paid Producer
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
      * If UOM or price changes, set Status to Recalulate net
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Live Purchase UOM NE WRK.TH Live Purchase UOM
      *   |- c2    : DTL.TH Live Purchase Price NE WRK.TH Live Purchase P
      *   '-
     C           #1CPST    IFNE WUCPST                     *IF
     C           #1ACPR    ORNE WUACPR                     *OR
     C                     MOVEL'R'       #1JWST           TH Calc Net Sts
     C                     MOVELWUCRTX    #1J9ST           TH Payment Type
     C                     END                             *FI
     C                     END                             *FI
      * Changes in ship information to require reprint of scale ticket
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Shipped Weight NE WRK.TH Shipped Weight
      *   |- c2    : DTL.TH Live Purchase UOM is Shipped Weight List
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HGNB    IFNE WUHGNB                     *IF
     C           #1CPST    IFEQ 'SW'                       *IF
     C           #1CPST    OREQ 'SX'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'S'       WUCZST           @Print Status
     C                     END                             *FI
      * validation of Defects
     C                     EXSR UDSUBR                     validation of D
      * Internal farm site and state MTech NOTLive & MtechLive
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : LCL.MTech Live Yes or No is No MTech not Live
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get farm site by movement
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WURTN     PARM WURTN     WQ0148  7        *Return code
     C                     PARM #1OXNB    WQ0149  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0150 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0151  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0152  5        HPS FS Comp Rel
     C           P2DRTX    PARM *BLANK    WQ0153  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDWUETNB    #1THHD           TH HPS Farm Sit
      * CASE: WRK.Farm Site USR NE WRK.Zero USR
     C           WUETNB    IFNE WUE9NB                     *IF
     C                     MOVELP2DRTX    #1NZTX           TH State
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : LCL.MTech Live Yes or No is Yes MTech is Live
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * have farm site on screen now get state
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           WURTN     PARM WURTN     WQ0154  7        *Return code
     C                     PARM *BLANK    WQ0155 25        Farm site Name
     C                     PARM #1THHD    WQ0156  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0157  5        HPS FS Comp Rel
     C           #1NZTX    PARM *BLANK    WQ0158  3        State
     C           WUQGTX    PARM *BLANK    WQ0159 25        HPS Farm County
     C           WUJXCD    PARM *BLANK    WQ0160  5        HPS Cell Manage
     C           WUQFTX    PARM *BLANK    WQ0161 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0162 20        MTech Farm Site
     C                     PARM *BLANK    WQ0163 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993839*
     C                     END
      * CASE: DTL.TH HPS Farm Site NE WRK.Zero USR
     C           #1THHD    IFNE WUE9NB                     *IF
     C                     MOVELP2DRTX    #1NZTX           TH State
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate the state code regardless
     C                     MOVELWUCRTX    YL0005           Return Code USR
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0005    PARM YL0005    WQ0164  7        Return Code USR
     C                     PARM #1NZTX    WQ0165  3        State
     C           #DLXTX    PARM *BLANK    WQ0166 30        State Desc 30 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0005    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0059           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END
      * HC Class Code required
     C           #1BECD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * TH Sex required
     C           #1E2ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9937  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * GN Genetic Code required
     C           #1AGCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9940  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * TH Schedule Kill Shift required
     C           #1LIST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9942  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Force PUTOVR
     C                     SETON                         86*
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     Z-ADD#1CVNB    P1CVNB           TH Tattoo Numbe
     C                     END                             *FI
     C                     END                             *FI
     C           W0PMD     IFEQ 'ADD'
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
     C                     END
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * Crt Ttt Hdr-chg retrn IF
      * Mtech
     C                     EXSR UFSUBR                     Mtech
      * 022106 slm Site id must be updated when a record is created
      *        also make sure that the producer is on the record
     C                     MOVEL'Y'       YL0013           Random Tattoo S
      * HPE076 --
      * CASE: PAR.Company Value Code    USR is Last Tattoo - Research
     C           P2FACD    IFEQ @CN,003                    *IF
     C                     MOVEL'R'       YL0014           Tattoo Type USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0014           Tattoo Type USR
     C                     END                             *FI
      * Make sure tattoo is STILL unused, if not, get the next unused nbr
      * CASE: PAR.User modified: 0-not modi is Not modified
     C           P2UMOD    IFEQ '0'                        *IF
      * CASE:
      *  - c1ORc2 OR c3 OR c4
      *   |- c1    : PAR.Company Value Code    USR is Last Tattoo - Marke
      *   |- c2    : PAR.Company Value Code    USR is Last Tattoo - SBD T
      *   |- c3    : LCL.Random Tattoo Sts USR is Yes
      *   |- c4    : PAR.Company Value Code    USR is Last Tattoo - Resea
      *   '-
     C           P2FACD    IFEQ @CN,004                    *IF
     C           P2FACD    OREQ @CN,005                    *OR
     C           YL0013    OREQ 'Y'                        *OR
     C           P2FACD    OREQ @CN,003                    *OR
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR NKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0170  30       BOH Company Num
     C                     PARM #1LLST    WQ0171  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0172  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0173 10        Company Value C
     C                     PARM 'R'       WQ0174  1        Creation Point
     C                     PARM P1B0DT    WQ0175  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0176  7        Return Code USR
     C                     PARM #1KAST    WQ0177  1        SR Type
     C                     PARM P2WEST    WQ0178  1        SBD Top Load St
     C                     PARM YL0014    WQ0179  1        Tattoo Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Prev Kill Date    XF - STR Order Management Sys  * 
     C                     CALL 'PDRUXFR'              90  Rtv Prev Kill D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0180  30       BOH Company Num
     C                     PARM P1B0DT    WQ0181  70       Cut Date
     C           YL0015    PARM *ZERO     WQ0182  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR NLRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0183  30       BOH Company Num
     C                     PARM #1LLST    WQ0184  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0185  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0186 10        Company Value C
     C                     PARM 'R'       WQ0187  1        Creation Point
     C                     PARM P1B0DT    WQ0188  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0189  7        Return Code USR
     C                     PARM #1KAST    WQ0190  1        SR Type
     C                     PARM P2WEST    WQ0191  1        SBD Top Load St
     C                     PARM YL0014    WQ0192  1        Tattoo Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Check next kill date **
      * Rtv Nxt Kill Dt 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDUXXFR'              90  Rtv Nxt Kill Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0193  30       CC Company Numb
     C                     PARM P1B0DT    WQ0194  70       Kill Date Usr
     C           YL0016    PARM *ZERO     WQ0195  70       Next Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR NMRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0196  30       BOH Company Num
     C                     PARM #1LLST    WQ0197  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0198  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0199 10        Company Value C
     C                     PARM 'R'       WQ0200  1        Creation Point
     C                     PARM P1B0DT    WQ0201  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0202  7        Return Code USR
     C                     PARM #1KAST    WQ0203  1        SR Type
     C                     PARM P2WEST    WQ0204  1        SBD Top Load St
     C                     PARM YL0014    WQ0205  1        Tattoo Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0206  30       BOH Company Num
     C                     PARM #1LLST    WQ0207  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0208  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0209 10        Company Value C
     C                     PARM 'R'       WQ0210  1        Creation Point
     C                     PARM P1B0DT    WQ0211  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0212  7        Return Code USR
     C                     PARM #1KAST    WQ0213  1        SR Type
     C                     PARM P2WEST    WQ0214  1        SBD Top Load St
     C                     PARM YL0014    WQ0215  1        Tattoo Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If internal output head rcvd and create tattoo detail,upd pen
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.@Status Internal (Y/N) is No
      *   |- c2    : PAR.TH Resale Spread Sts is Not Spread/Spread
      *   '-
     C           WUKPST    IFEQ *BLANK                     *IF
     C           #1C2ST    OREQ *BLANK                     *OR
     C           #1C2ST    OREQ 'P'
     C                     Z-ADD#1CWNB    WUCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WUDINB           BOL Live Wgt Re
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#DB5NB    WUCWNB           TH Head Receive
      * Crt Tattoo Dtl        XF - Tattoo Detail  * 
     C                     CALL 'PKZXXFR'              90  Crt Tattoo Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0216  30       BOH Company Num
     C                     PARM P1BNNB    WQ0217  70       BOH Buy Order N
     C                     PARM P1BONB    WQ0218  50       BOL Load Number
     C                     PARM P1B0DT    WQ0219  70       TH Kill Date
     C                     PARM *ZERO     WQ0220  51       TD Avg Live Wgt
     C                     PARM *BLANK    WQ0221  1        TD Gen Bal To K
     C                     PARM 'N'       WQ0222  1        TD Recs Created
     C                     PARM 'N'       WQ0223  1        TD User Status
     C                     PARM 'N'       WQ0224  1        TD User Status
     C                     PARM *ZERO     WQ0225  70       TD User Date 1
     C                     PARM *ZERO     WQ0226  70       TD User Date 2
     C                     PARM *ZERO     WQ0227  70       TD Drive Date
     C                     PARM P1HMNB    WQ0228  30       Pen Company Num
     C                     PARM #1CVNB    WQ0229  50       Tattoo Number N
     C                     PARM *ZERO     WQ0230  71       Live Wgt Tot US
     C                     PARM #DB5NB    WQ0231  70       Head Total USR
     C                     PARM #DCMCD    WQ0232  3        Pen Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKZXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
     C                     EXSR NNRVGN
     C                     Z-ADD*ZERO     WUDINB           BOL Live Wgt Re
      * Rtv/Chg Bol Hd rcvd   RT - Buy Order Load  * 
     C                     EXSR NXRVGN
      * BOH - Change Status to Locked so BOH info may not be changed!
      * Rtv/Chg BOH Status     RT - Buy Order Header  * 
     C                     EXSR OARVGN
      * Rtv Chg Lock Sts      RT - Delivery Sched Detail  * 
     C                     EXSR OCRVGN
     C                     END                             *FI
      * Create Tattoo Header - Tattoo Header  * 
     C                     EXSR OECRRC
      * New File Created(Buy order load EXT) to load Load SHipped Head
      * Upd Shipped Head      RT - Buy Order Load  * 
     C                     EXSR OFRVGN
      * E00144 slm allow defects on Market and Resale
      * Market hogs will only be for LFT OR EUT/KOA
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) #1BECD' defaulted for 'HC Class Code'.
      * Crt Tattoo Def-10     IF
      * Rtv Del Tattoo Def - Tattoo Defect  * 
     C                     EXSR OHRVGN
      * Defect 1
      * CASE: PAR.Defect User  1 NE WRK.Blank Usr 1 fld Usr
     C           #DGUCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OJCRRC
     C                     END                             *FI
      * Defect 2
      * CASE: PAR.Defect User  2 NE WRK.Blank Usr 1 fld Usr
     C           #DGVCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OLCRRC
     C                     END                             *FI
      * Defect 3
      * CASE: PAR.Defect User  3 NE WRK.Blank Usr 1 fld Usr
     C           #DGWCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR ONCRRC
     C                     END                             *FI
      * Defect 4
      * CASE: PAR.Defect User  4 NE WRK.Blank Usr 1 fld Usr
     C           #DGXCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OPCRRC
     C                     END                             *FI
      * Defect 5
      * CASE: PAR.Defect User  5 NE WRK.Blank Usr 1 fld Usr
     C           #DGYCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR ORCRRC
     C                     END                             *FI
      * Defect 6
      * CASE: PAR.Defect User  6 NE WRK.Blank Usr 1 fld Usr
     C           #DGZCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OTCRRC
     C                     END                             *FI
      * Defect 7
      * CASE: PAR.Defect User  7 NE WRK.Blank Usr 1 fld Usr
     C           #DG0CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OVCRRC
     C                     END                             *FI
      * Defect 8
      * CASE: PAR.Defect User  8 NE WRK.Blank Usr 1 fld Usr
     C           #DG1CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OXCRRC
     C                     END                             *FI
      * Defect 9
      * CASE: PAR.Defect User  9 NE WRK.Blank Usr 1 fld Usr
     C           #DG2CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OZCRRC
     C                     END                             *FI
      * Defect 10
      * CASE: PAR.Defect User 10 NE WRK.Blank Usr 1 fld Usr
     C           #DG3CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR PBCRRC
     C                     END                             *FI
      * CASE: PAR.TH Hog Class Type is Market
     C           #1LLST    IFEQ 'M'                        *IF
      * Chg TaDefTots THdrBol XF - Tattoo Defect  * 
     C                     CALL 'PLL2XFR'              90  Chg TaDefTots T
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0242  30       BOH Company Num
     C                     PARM P1BNNB    WQ0243  70       BOH Buy Order N
     C                     PARM P1BONB    WQ0244  50       BOL Load Number
     C                     PARM #1CVNB    WQ0245  50       TH Tattoo Numbe
     C                     PARM P1B0DT    WQ0246  70       TH Kill Date
     C                     PARM #1LLST    WQ0247  1        TH Hog Class Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Movement number to the Buy Order load
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0012    IFEQ 'Y'                        *IF
      * Live yes will allow the usr to enter the movment number
      * in stead of assigning a movement number
      * CASE: PAR.TH Source Type is Internal
     C           #1KAST    IFEQ 'I'                        *IF
      * Chg Movement# BOL     RT - Buy Order Load  * 
     C                     EXSR PDRVGN
     C                     END                             *FI
     C                     END                             *FI
      * 4/8/2008 slm Support Issue - Move# and Reference was not
      * getting updated in the delivery tracking if the tattoo was
      * added.  This was getting updated on the change only
      * If External -- change group/movement on Delv Tracking if its ther
      * CASE: PAR.TH Source Type is External
     C           #1KAST    IFEQ 'E'                        *IF
      * Rtv Chg Movemnt/Group RT - Delivery Tracking  * 
     C                     EXSR PFRVGN
     C                     END                             *FI
      * ** 12/28/05 LJB - Create Tattoo hdr ext rec with Producer code an
      * ** site id
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
     C                     EXSR PHCRRC
      * Send "Tatto has been added" message
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     Z-ADD#1CVNB    ZA0060           TH Tattoo Numbe
      * Send message 'Tattoo &1 has been added.'
     C                     MOVEL'PRK0359' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       YL0011           Record Added Us
     C                     GOTO ECEXIT                     *QUIT
     C                     END                             *FI
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Tattoo Header,Pen IF
      * Modificaitons and Comments
     C                     EXSR UGSUBR                     Modificaitons a
      * Mtech
     C                     EXSR UHSUBR                     Mtech
      * IF Internal -- chg td and pen
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.@Status Internal (Y/N) is No
      *   |- c2    : PAR.TH Resale Spread Sts is Not Spread/Spread
      *   '-
     C           WUKPST    IFEQ *BLANK                     *IF
     C           #1C2ST    OREQ *BLANK                     *OR
     C           #1C2ST    OREQ 'P'
     C                     Z-ADD#1CWNB    WUCWNB           TH Head Receive
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#DB5NB    WUCWNB           TH Head Receive
      * Rtv Crt/Chg hd, pen  RT - Tattoo Detail  * 
     C                     EXSR PIRVGN
      * Update BOL if head received changed with the head diff.
      * CASE: PAR.Head Total USR NE PAR.TH Head Received
     C           #DB5NB    IFNE #1CWNB                     *IF
     C           #DB5NB    SUB  #1CWNB    WUZYNB           Head Total Usr
     C                     Z-ADD*ZERO     WUDINB           BOL Live Wgt Re
      * Rtv/Chg Bol Hd rcvd   RT - Buy Order Load  * 
     C                     EXSR PKRVGN
     C                     END                             *FI
      * Update pen count  -- if head or pen changed
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Head Total USR NE PAR.TH Head Received
      *   |- c2    : PAR.Pen Number NE PAR.Pen Usr
      *   '-
     C           #DB5NB    IFNE #1CWNB                     *IF
     C           #DCMCD    ORNE WUCBCD                     *OR
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
     C                     EXSR PNRVGN
     C                     END                             *FI
      * Update pen count -- original pen if pen changed
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Pen Number NE PAR.Pen Usr
      *   |- c2    : PAR.Pen Usr is Pen Number not Empty
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DCMCD    IFNE WUCBCD                     *IF
     C           WUCBCD    IFGT *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
     C                     EXSR PXRVGN
     C                     END                             *FI
     C                     END                             *FI
      * If External -- change group/movement on Delv Tracking if its ther
      * CASE: PAR.TH Source Type is External
     C           #1KAST    IFEQ 'E'                        *IF
      * Rtv Chg Movemnt/Group RT - Delivery Tracking  * 
     C                     EXSR QHRVGN
     C                     END                             *FI
      * Chg Tattoo Hdr w/new  CH - Tattoo Header  * 
     C                     EXSR QJCHRC
      * Rtv/Chg Ttt's Lv Prc  XF - Tattoo Header  * 
     C                     CALL 'PKR8XFR'              90  Rtv/Chg Ttt's L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0277  30       BOH Company Num
     C                     PARM P1BNNB    WQ0278  70       BOH Buy Order N
     C                     PARM P1BONB    WQ0279  50       BOL Load Number
     C                     PARM #1CVNB    WQ0280  50       TH Tattoo Numbe
     C                     PARM P1B0DT    WQ0281  70       TH Kill Date
     C                     PARM #1AWDT    WQ0282  70       TH Purchase Dat
     C                     PARM #1BICD    WQ0283 10        TH Group Refere
     C                     PARM #1CPST    WQ0284  2        TH Live Purchas
     C                     PARM #1ACPR    WQ0285  52       TH Live Purchas
     C                     PARM #1B9PR    WQ0286  72       TH Live Gross A
     C                     PARM #1CAPR    WQ0287  72       TH LIve Net Amt
     C                     PARM #1C4ST    WQ0288  2        TH Resale UOM
     C                     PARM #1AIPR    WQ0289  52       TH Recalc Live
     C                     PARM #1A6DT    WQ0290  70       TH Pricing Date
     C                     PARM #1C2ST    WQ0291  1        TH Resale Sprea
     C                     PARM #1CXNB    WQ0292  50       TH Dead On Arri
     C                     PARM WUCWNB    WQ0293  50       TH Head Receive
     C                     PARM #1FCNB    WQ0294  50       TH Yard Deads
     C                     PARM #1H9NB    WQ0295  50       TH Held Over
     C                     PARM #1FDNB    WQ0296  50       TH Head Condemn
     C                     PARM #1FENB    WQ0297  50       TH Head Killed
     C                     PARM #1HENB    WQ0298  50       TH Head Adds
     C                     PARM #1HFNB    WQ0299  50       TH Head Accepte
     C                     PARM #1CYNB    WQ0300  71       TH Live Wgt
     C                     PARM #1LRNB    WQ0301  71       TH Adj Live Wgt
     C                     PARM #1E0NB    WQ0302  71       TH Hot Wgt
     C                     PARM #1A5PC    WQ0303  61       TH Tot Loin Eye
     C                     PARM #1FBNB    WQ0304  61       TH Tot Backfat
     C                     PARM #1A4PC    WQ0305  61       TH Tot Light Re
     C                     PARM #1F7NB    WQ0306  51       TH Avg Live Wgt
     C                     PARM #1HDNB    WQ0307  51       TH Avg Hot Wgt
     C                     PARM #1F5NB    WQ0308  31       TH Avg Light Re
     C                     PARM #1F4NB    WQ0309  31       TH Avg Lean Per
     C                     PARM #1F3NB    WQ0310  31       TH Avg Loin Eye
     C                     PARM #1F2NB    WQ0311  31       TH Avg Backfat
     C                     PARM #1AVPC    WQ0312  52       TH Std Yield Pe
     C                     PARM #1AWPC    WQ0313  52       TH Actual Yield
     C                     PARM #1CWPC    WQ0314  52       TH Adj Actual Y
     C                     PARM #1A8PC    WQ0315  52       TH Yield Differ
     C                     PARM #1A7PC    WQ0316  31       TH Recalc Live
     C                     PARM #1B8PR    WQ0317  52       TH CM Market Pr
     C                     PARM #1AMPR    WQ0318  52       TH CM Base Mkt
     C                     PARM #1ANPR    WQ0319  72       TH CM Base Mkt
     C                     PARM #1AYVA    WQ0320  72       TH CM Sort Disc
     C                     PARM #1AWVA    WQ0321  72       TH CM Yield Gai
     C                     PARM #1AOPR    WQ0322  72       TH CM Base Carc
     C                     PARM #1AXVA    WQ0323  72       TH CM LN AddOn/
     C                     PARM #1APPR    WQ0324  72       TH CM Carcass G
     C                     PARM #1ASPR    WQ0325  72       TH Deduction Am
     C                     PARM #1A4VA    WQ0326  72       TH Total Net WO
     C                     PARM #1ATPR    WQ0327  72       TH Carcass Net
     C                     PARM #1A5VA    WQ0328  72       TH Additions Am
     C                     PARM #1CBPR    WQ0329  72       TH Payment Gros
     C                     PARM #1CCPR    WQ0330  72       Th Payment Net
     C                     PARM #1LPNB    WQ0331  80       TH AP Voucher/D
     C                     PARM #1CDPR    WQ0332  72       TH Freight Amou
     C                     PARM #1A7VA    WQ0333  72       TH Accrual Amou
     C                     PARM #1A2PR    WQ0334  72       TH Fixed Cost A
     C                     PARM #1JWST    WQ0335  1        TH Calc Net Sts
     C                     PARM #1CWST    WQ0336  2        TH Payment Sts
     C                     PARM #1D7ST    WQ0337  1        TH Header Error
     C                     PARM #1D8ST    WQ0338  1        TH Detail Error
     C                     PARM #1DWST    WQ0339  1        TH Kill Balanci
     C                     PARM #1D6ST    WQ0340  1        TH Bal to Kill
     C                     PARM #1GHNB    WQ0341  80       TH Commission A
     C                     PARM #1BYDT    WQ0342  70       TH Voucher Paym
     C                     PARM #1E0ST    WQ0343  1        TH User Error O
     C                     PARM #1E1ST    WQ0344  1        TH Held Over Re
     C                     PARM #1E2ST    WQ0345  1        TH Sex
     C                     PARM #1BSDT    WQ0346  70       TH Held/Ovr Com
     C                     PARM #1BTDT    WQ0347  70       TH Commission P
     C                     PARM #1BUDT    WQ0348  70       TH Actual Check
     C                     PARM #1HGNB    WQ0349  71       TH Shipped Weig
     C                     PARM #1HHNB    WQ0350  71       TH Avg Hot Wgt
     C                     PARM #1HINB    WQ0351  31       TH FFLI
     C                     PARM #1A3PR    WQ0352  72       TH Kill Product
     C                     PARM #1A4PR    WQ0353  72       TH Cut Product
     C                     PARM #1A6PR    WQ0354  72       TH Render Produ
     C                     PARM #1J9NB    WQ0355  50       TH Head Exclude
     C                     PARM #1D6PR    WQ0356  52       TH CM Bse Mkt L
     C                     PARM #1D7PR    WQ0357  52       TH CM Bse Mkt C
     C                     PARM #1D8PR    WQ0358  52       TH CM Srt Dsc L
     C                     PARM #1D9PR    WQ0359  52       TH CM Srt Dsc C
     C                     PARM #1EAPR    WQ0360  52       TH CM Yld G/L L
     C                     PARM #1EBPR    WQ0361  52       TH CM Yld G/L C
     C                     PARM #1ECPR    WQ0362  52       TH CM Crc Val L
     C                     PARM #1EDPR    WQ0363  52       TH CM Crc Val C
     C                     PARM #1EEPR    WQ0364  52       TH CM Lean Prem
     C                     PARM #1EFPR    WQ0365  52       TH CM Lean Prem
     C                     PARM #1EGPR    WQ0366  52       TH CM Gross Liv
     C                     PARM #1EHPR    WQ0367  52       TH CM Gross Car
     C                     PARM #1KAST    WQ0368  1        TH Source Type
     C                     PARM #1J7ST    WQ0369  1        TH Scale Ticket
     C                     PARM #1J9ST    WQ0370  1        TH Payment Type
     C                     PARM #1OXNB    WQ0371  70       TH HPS Movement
     C                     PARM #1LKST    WQ0372  3        TH Source Code
     C                     PARM #1LLST    WQ0373  1        TH Hog Class Ty
     C                     PARM #1J8ST    WQ0374  1        TH Posted to HP
     C                     PARM #1LIST    WQ0375  1        TH Schedule Kil
     C                     PARM #1LJST    WQ0376  1        TH Shift Held O
     C                     PARM #1NZTX    WQ0377  3        TH State
     C                     PARM #1HJCD    WQ0378  3        TH Unused Code
     C                     PARM #1R4ST    WQ0379  2        TH Unused Sts 2
     C                     PARM #1R5ST    WQ0380  1        TH Commission S
     C                     PARM #1R6ST    WQ0381  1        TH Paid 2 Week
     C                     PARM #1R7ST    WQ0382  1        TH Unused Sts 1
     C                     PARM #1THWT    WQ0383  71       TH DOA Weight
     C                     PARM #1T2WT    WQ0384  71       TH Avg Lean % E
     C                     PARM #1THHD    WQ0385  50       TH HPS Farm Sit
     C                     PARM #1T2HD    WQ0386  50       TH Shift Held O
     C                     PARM #1OBPR    WQ0387  72       TH Sorting Amou
     C                     PARM #1BDCD    WQ0388  6        DF Defect Code
     C                     PARM #1CSCD    WQ0389  6        THP Process Cod
     C                     PARM P1ABCD    WQ0390  6        PD Producer Cod
     C                     PARM P1AECD    WQ0391  6        PL Location Cod
     C                     PARM #1ACCD    WQ0392  3        HB Buyer Code
     C                     PARM #1AGCD    WQ0393  5        GN Genetic Code
     C                     PARM #1BECD    WQ0394  3        HC Class Code
     C                     PARM #1AAVN    WQ0395 10        RS User Changed
     C                     PARM #1AADT    WQ0396  70       RS Date Changed
     C                     PARM #1AMTM    WQ0397  60       RS Time Changed
     C                     PARM #1AJST    WQ0398  1        RS Record Statu
     C                     PARM #1AHVN    WQ0399 10        RS Job
     C                     PARM #1AGVN    WQ0400 10        RS Program
     C                     PARM #1ABVN    WQ0401 10        RS User Added
     C                     PARM #1ABDT    WQ0402  70       RS Date Added
     C                     PARM #1ABTM    WQ0403  60       RS Time Added
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKR8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993645*
     C                     SETON                     444337*
     C                     SETON                     463542*
     C                     SETON                     393840*
     C                     SETON                     34    *
     C                     END
      * New File Created(buy order head ext) to load load shipped head
      * Upd Shipped Head      RT - Buy Order Load  * 
     C                     EXSR QORVGN
      * Crt Tattoo Def-10     IF
      * Rtv Del Tattoo Def - Tattoo Defect  * 
     C                     EXSR QQRVGN
      * Defect 1
      * CASE: PAR.Defect User  1 NE WRK.Blank Usr 1 fld Usr
     C           #DGUCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR QSCRRC
     C                     END                             *FI
      * Defect 2
      * CASE: PAR.Defect User  2 NE WRK.Blank Usr 1 fld Usr
     C           #DGVCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR QUCRRC
     C                     END                             *FI
      * Defect 3
      * CASE: PAR.Defect User  3 NE WRK.Blank Usr 1 fld Usr
     C           #DGWCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR QWCRRC
     C                     END                             *FI
      * Defect 4
      * CASE: PAR.Defect User  4 NE WRK.Blank Usr 1 fld Usr
     C           #DGXCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR QYCRRC
     C                     END                             *FI
      * Defect 5
      * CASE: PAR.Defect User  5 NE WRK.Blank Usr 1 fld Usr
     C           #DGYCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RACRRC
     C                     END                             *FI
      * Defect 6
      * CASE: PAR.Defect User  6 NE WRK.Blank Usr 1 fld Usr
     C           #DGZCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RCCRRC
     C                     END                             *FI
      * Defect 7
      * CASE: PAR.Defect User  7 NE WRK.Blank Usr 1 fld Usr
     C           #DG0CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RECRRC
     C                     END                             *FI
      * Defect 8
      * CASE: PAR.Defect User  8 NE WRK.Blank Usr 1 fld Usr
     C           #DG1CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RGCRRC
     C                     END                             *FI
      * Defect 9
      * CASE: PAR.Defect User  9 NE WRK.Blank Usr 1 fld Usr
     C           #DG2CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RICRRC
     C                     END                             *FI
      * Defect 10
      * CASE: PAR.Defect User 10 NE WRK.Blank Usr 1 fld Usr
     C           #DG3CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RKCRRC
     C                     END                             *FI
      * CASE: PAR.TH Hog Class Type is Market
     C           #1LLST    IFEQ 'M'                        *IF
      * Chg TaDefTots THdrBol XF - Tattoo Defect  * 
     C                     CALL 'PLL2XFR'              90  Chg TaDefTots T
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0404  30       BOH Company Num
     C                     PARM P1BNNB    WQ0405  70       BOH Buy Order N
     C                     PARM P1BONB    WQ0406  50       BOL Load Number
     C                     PARM #1CVNB    WQ0407  50       TH Tattoo Numbe
     C                     PARM P1B0DT    WQ0408  70       TH Kill Date
     C                     PARM #1LLST    WQ0409  1        TH Hog Class Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Change pen desc if the genetics for the tattoo changed
      * CASE: PAR.GN Genetic Code NE PAR.Genetic Code USR
     C           #1AGCD    IFNE WUAGCD                     *IF
      * Rtv Dtl Pen/Chg PenDscRT - Tattoo Detail  * 
     C                     EXSR RMRVGN
     C                     END                             *FI
      * ** 12/28/05 LJB - include changes in the Tattoo Header Ext file
      * ** 02/22/06 slm - Add the Producer as well as the Site id.
      * UPDATE only the Producer ID and the Site ID.
      * for all Tattoo Header Ext records without kill date.
      * Read by Key first to get record added. by kill date.
      * Chg TatHdrExt by Key  RT - Tattoo Header EXT  * 
     C                     EXSR RSRVGN
      * This read is to change all records.
      * Chg TatHdrExt All TattRT - Tattoo Header EXT  * 
     C                     EXSR RWRVGN
      * Movement number to the buy order load
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0023    IFEQ 'Y'                        *IF
      * Live yes will allow the usr to enter the movment number
      * in stead of assigning a movement number
      * CASE: PAR.TH Source Type is Internal
     C           #1KAST    IFEQ 'I'                        *IF
      * Upd Movement # BOL    XF - Tattoo Header  * 
     C                     CALL 'PLSXXFR'              90  Upd Movement #
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0414  30       BOH Company Num
     C                     PARM P1BNNB    WQ0415  70       BOH Buy Order N
     C                     PARM P1BONB    WQ0416  50       BOL Load Number
     C                     PARM #1CVNB    WQ0417  50       TH Tattoo Numbe
     C                     PARM P1B0DT    WQ0418  70       TH Kill Date
     C                     PARM #1AWDT    WQ0419  70       TH Purchase Dat
     C                     PARM #1OXNB    WQ0420  70       TH HPS Movement
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLSXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * E10812 JJH 01/22/18 - Update Movement# in Buy Order Load and
      *                       Delivery Schedule Detail.
      * Rtv HPS Automation    RT - Producer EXT  * 
     C                     EXSR RZRVGN
      * Update Movement Number in Buy Order Load & Delivery Sched Detail
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.HPS Automation (Y/N) is Yes
      *   |- c2    : PAR.TH Source Type is External
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0031    IFEQ 'Y'                        *IF
     C           #1KAST    IFEQ 'E'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Upd Movement Number   RT - Buy Order Load  * 
     C                     EXSR UIRVGN
      * Upd Movement Number   RT - Delivery Sched Detail  * 
     C                     EXSR UKRVGN
     C                     END                             *FI
      * E10812 JJH 01/22/18 - Update Movement Number in all Tattoo Header
      *                       for the Buy Order Load.
      * Upd Movment Number - Tattoo Header  * 
     C                     EXSR UMRVGN
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           Y5RDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1HMNB    IFEQ *ZERO                      BOH Company Num
     C           P1BNNB    OREQ *ZERO                      BOH Buy Order N
     C           P1BONB    OREQ *ZERO                      BOL Load Number
     C           P1B0DT    OREQ *ZERO                      TH Kill Date
     C           P1CVNB    OREQ *ZERO                      TH Tattoo Numbe
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           WUDJSS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           #DQTST    IFEQ *BLANK                     *IF
     C           #DQTST    OREQ 'N'
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUFRSS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C                     MOVEL'0'       *IN75
     C           WUFSSS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           WUECSS    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           WUKPST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           WUMAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           WUNEST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN69
     C           WUNFST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #DQTST           PL Site ID Requ
     C                     MOVELP2IHST    #PIHST           Record Added Us
     C                     MOVEL*BLANK    #DBSTX           Name USR
     C                     Z-ADD*ZERO     #DTZA1           Prior Movement
     C                     MOVEL*BLANK    #DAGTX           PD Name
     C                     MOVEL*BLANK    #DA8TX           PL Name
     C                     MOVEL*BLANK    #DEPCD           Group Reference
     C                     MOVEL*BLANK    #DO3TX           OMS State
     C                     Z-ADD*ZERO     #DNVA1           LFT usr
     C                     Z-ADD*ZERO     #DNWA1           EUT/KOA Hogs us
     C                     MOVEL*BLANK    #1BDCD           DF Defect Code
     C                     MOVEL*BLANK    #DBCTX           DF Description
     C                     Z-ADD*ZERO     #1B9PR           TH Live Gross A
     C                     Z-ADD*ZERO     #1CAPR           TH LIve Net Amt
     C                     MOVEL*BLANK    #1C4ST           TH Resale UOM
     C                     Z-ADD*ZERO     #1AIPR           TH Recalc Live
     C                     Z-ADD*ZERO     #1A6DT           TH Pricing Date
     C                     MOVEL*BLANK    #1C2ST           TH Resale Sprea
     C                     Z-ADD*ZERO     #1FCNB           TH Yard Deads
     C                     Z-ADD*ZERO     #1H9NB           TH Held Over
     C                     Z-ADD*ZERO     #1FDNB           TH Head Condemn
     C                     Z-ADD*ZERO     #1FENB           TH Head Killed
     C                     Z-ADD*ZERO     #1LRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     #1HENB           TH Head Adds
     C                     Z-ADD*ZERO     #1HFNB           TH Head Accepte
     C                     Z-ADD*ZERO     #1CYNB           TH Live Wgt
     C                     Z-ADD*ZERO     #1E0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     #1A5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     #1FBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     #1A4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     #1F7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     #1HDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #1F5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     #1F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     #1F3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1F2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     #1AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     #1AWPC           TH Actual Yield
     C                     Z-ADD*ZERO     #1CWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     #1A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     #1A7PC           TH Recalc Live
     C                     Z-ADD*ZERO     #1B8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     #1AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #1ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #1AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     #1AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     #1AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     #1AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     #1APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     #1ASPR           TH Deduction Am
     C                     Z-ADD*ZERO     #1A4VA           TH Total Net WO
     C                     Z-ADD*ZERO     #1A5VA           TH Additions Am
     C                     Z-ADD*ZERO     #1CBPR           TH Payment Gros
     C                     Z-ADD*ZERO     #1CCPR           Th Payment Net
     C                     Z-ADD*ZERO     #1LPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     #1CDPR           TH Freight Amou
     C                     Z-ADD*ZERO     #1ATPR           TH Carcass Net
     C                     Z-ADD*ZERO     #1A7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     #1A2PR           TH Fixed Cost A
     C                     MOVEL*BLANK    #1JWST           TH Calc Net Sts
     C                     MOVEL*BLANK    #1CWST           TH Payment Sts
     C                     MOVEL*BLANK    #1D7ST           TH Header Error
     C                     MOVEL*BLANK    #1D8ST           TH Detail Error
     C                     MOVEL*BLANK    #1DWST           TH Kill Balanci
     C                     MOVEL*BLANK    #1D6ST           TH Bal to Kill
     C                     Z-ADD*ZERO     #1GHNB           TH Commission A
     C                     Z-ADD*ZERO     #1BYDT           TH Voucher Paym
     C                     MOVEL*BLANK    #1E0ST           TH User Error O
     C                     MOVEL*BLANK    #1E1ST           TH Held Over Re
     C                     Z-ADD*ZERO     #1BSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     #1BTDT           TH Commission P
     C                     Z-ADD*ZERO     #1BUDT           TH Actual Check
     C                     Z-ADD*ZERO     #1HHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #1HINB           TH FFLI
     C                     Z-ADD*ZERO     #1A3PR           TH Kill Product
     C                     Z-ADD*ZERO     #1A4PR           TH Cut Product
     C                     Z-ADD*ZERO     #1A6PR           TH Render Produ
     C                     Z-ADD*ZERO     #1J9NB           TH Head Exclude
     C                     Z-ADD*ZERO     #1D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     #1D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     #1D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     #1D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     #1EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     #1EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     #1ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     #1EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     #1EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #1EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #1EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     #1EHPR           TH CM Gross Car
     C                     MOVEL*BLANK    #1KAST           TH Source Type
     C                     MOVEL*BLANK    #1J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    #1J8ST           TH Posted to HP
     C                     MOVEL*BLANK    #1LJST           TH Shift Held O
     C                     MOVEL*BLANK    #1HJCD           TH Unused Code
     C                     MOVEL*BLANK    #1R4ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1R5ST           TH Commission S
     C                     MOVEL*BLANK    #1R6ST           TH Paid 2 Week
     C                     MOVEL*BLANK    #1R7ST           TH Unused Sts 1
     C                     Z-ADD*ZERO     #1THWT           TH DOA Weight
     C                     Z-ADD*ZERO     #1T2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     #1T2HD           TH Shift Held O
     C                     Z-ADD*ZERO     #1OBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     #1KOER           TH Head Identif
     C                     Z-ADD*ZERO     #1OPIR           TH Percent Iden
     C                     Z-ADD*ZERO     #1OPEM           TH Percent Acce
     C                     Z-ADD*ZERO     #1IORP           TH Head Adjuste
     C                     Z-ADD*ZERO     #1OWEO           TH PHA Head Add
     C                     MOVEL*BLANK    #1OQET           TH PHA Add Type
     C                     MOVEL*BLANK    #1URST           TH PHA Average
     C                     MOVEL*BLANK    #1USST           TH PHA Add Reas
     C                     Z-ADD*ZERO     #1HHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     #1S9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     #1TAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     #1TBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     #1JFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     #1KRIF           TH Broken Back
     C                     Z-ADD*ZERO     #1KORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     #1KAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     #1KROT           TH Excluded Car
     C                     Z-ADD*ZERO     #1OTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     #1IRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     #1IMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     #1IRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     #1KRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1OJRF           TH Break Even P
     C                     Z-ADD*ZERO     #1KFOR           TH Meat Value F
     C                     Z-ADD*ZERO     #1ORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     #1OMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     #1MVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1MCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     #1NCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     #1NCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     #1IGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1KFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     #1EADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1EBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1EEDT           TH Unused Date
     C                     MOVEL*BLANK    #1U4ST           TH Unused Sts 1
     C                     MOVEL*BLANK    #1U5ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1U6ST           TH Unused Sts 3
     C                     MOVEL*BLANK    #1U7ST           TH Unused Sts 4
     C                     MOVEL*BLANK    #1U8ST           TH Unused Sts 5
     C                     MOVEL*BLANK    #1U9ST           TH Unused Sts 6
     C                     MOVEL*BLANK    #1VAST           TH Unused Sts 7
     C                     MOVEL*BLANK    #1VBST           TH Unused Sts 8
     C                     MOVEL*BLANK    #1J9ST           TH Payment Type
     C                     MOVEL*BLANK    #1LKST           TH Source Code
     C                     MOVEL*BLANK    #1CSCD           THP Process Cod
     C                     MOVEL*BLANK    #1ACCD           HB Buyer Code
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     MOVEL*BLANK    #DKKTX           Description 30
     C                     MOVEL*BLANK    #DISTX           SR Type Desc
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     Z-ADD*ZERO     #1AWDT           TH Purchase Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1AWDT
     C                     MOVELP1LLST    #1LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    #DE6TX           HC Class Type D
     C                     Z-ADD*ZERO     #DLDSH           BOL Shipped Hea
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DBGT1           PS Premises ID
     C                     MOVEL*BLANK    #1BECD           HC Class Code
     C                     MOVEL*BLANK    #DBDTX           HC Description
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
     C                     MOVEL*BLANK    #1BICD           TH Group Refere
     C                     MOVELP1E2ST    #1E2ST           TH Sex
     C                     MOVEL*BLANK    #DFRTX           Sex Desc Usr
     C                     Z-ADD*ZERO     #1THHD           TH HPS Farm Sit
     C                     MOVEL*BLANK    #1NZTX           TH State
     C                     MOVEL*BLANK    #DLXTX           State Desc 15 U
     C                     MOVEL*BLANK    #DK0CD           DT Building
     C                     MOVEL*BLANK    #DK1CD           DT Room
     C                     MOVELP1AGCD    #1AGCD           GN Genetic Code
     C                     MOVEL*BLANK    #DLFCD           DT Sire Line Co
     C                     MOVEL*BLANK    #DCMCD           Pen Number
     C                     MOVEL*BLANK    #1LIST           TH Schedule Kil
     C                     Z-ADD*ZERO     #1CWNB           TH Head Receive
     C                     Z-ADD*ZERO     #1CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     #DB5NB           Head Total USR
     C                     Z-ADD*ZERO     #1ACPR           TH Live Purchas
     C                     MOVEL*BLANK    #DK5TX           Text 9 USR
     C                     Z-ADD*ZERO     #1ECDT           TH Head LFT
     C                     Z-ADD*ZERO     #1EDDT           TH Head EUT/KOA
     C                     MOVEL*BLANK    #1CPST           TH Live Purchas
     C                     MOVEL*BLANK    #DEPTX           TH Live Purch U
     C                     Z-ADD*ZERO     #1HGNB           TH Shipped Weig
     C                     MOVEL*BLANK    #DGUCD           Defect User  1
     C                     Z-ADD*ZERO     #DF1NB           Defect HD user
     C                     MOVEL*BLANK    #DCLSS           Class Df 1 Usr
     C                     MOVEL*BLANK    #DGVCD           Defect User  2
     C                     Z-ADD*ZERO     #DFWNB           Defect HD user
     C                     MOVEL*BLANK    #DCMSS           Class Df 2 Usr
     C                     MOVEL*BLANK    #DGWCD           Defect User  3
     C                     Z-ADD*ZERO     #DFYNB           Defect HD user
     C                     MOVEL*BLANK    #DCNSS           Class Df 3 Usr
     C                     MOVEL*BLANK    #DGXCD           Defect User  4
     C                     Z-ADD*ZERO     #DFUNB           Defect HD user
     C                     MOVEL*BLANK    #DCOSS           Class Df 4 Usr
     C                     MOVEL*BLANK    #DGYCD           Defect User  5
     C                     Z-ADD*ZERO     #DO3NB           Defect HD user
     C                     MOVEL*BLANK    #DCPSS           Class Df 5 Usr
     C                     MOVEL*BLANK    #DGZCD           Defect User  6
     C                     Z-ADD*ZERO     #DO4NB           Defect HD user
     C                     MOVEL*BLANK    #DCQSS           Class Df 6 Usr
     C                     MOVEL*BLANK    #DG0CD           Defect User  7
     C                     Z-ADD*ZERO     #DO5NB           Defect HD user
     C                     MOVEL*BLANK    #DCRSS           Class Df 7 Usr
     C                     MOVEL*BLANK    #DG1CD           Defect User  8
     C                     Z-ADD*ZERO     #DFONB           Defect HD user
     C                     MOVEL*BLANK    #DCSSS           Class Df 8 Usr
     C                     MOVEL*BLANK    #DG2CD           Defect User  9
     C                     Z-ADD*ZERO     #DFXNB           Defect HD user
     C                     MOVEL*BLANK    #DCTSS           Class Df 9 Usr
     C                     MOVEL*BLANK    #DG3CD           Defect User 10
     C                     Z-ADD*ZERO     #DFTNB           Defect HD user
     C                     MOVEL*BLANK    #DCUSS           Class Df 10 Usr
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @A1CPC4 fields to screen
      *================================================================
     C                     Z-ADDA1HMNB    #1HMNB           BOH Company Num
     C                     MOVELA1BDCD    #1BDCD           DF Defect Code
     C                     Z-ADDA1B9PR    #1B9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    #1CAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    #1C4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    #1AIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    #1A6DT           TH Pricing Date
     C                     MOVELA1C2ST    #1C2ST           TH Resale Sprea
     C                     Z-ADDA1FCNB    #1FCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    #1H9NB           TH Held Over
     C                     Z-ADDA1FDNB    #1FDNB           TH Head Condemn
     C                     Z-ADDA1FENB    #1FENB           TH Head Killed
     C                     Z-ADDA1LRNB    #1LRNB           TH Adj Live Wgt
     C                     Z-ADDA1HENB    #1HENB           TH Head Adds
     C                     Z-ADDA1HFNB    #1HFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    #1CYNB           TH Live Wgt
     C                     Z-ADDA1E0NB    #1E0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    #1A5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    #1FBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    #1A4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    #1F7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    #1HDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    #1F5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    #1F4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    #1F3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    #1F2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    #1AVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    #1AWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    #1CWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    #1A8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    #1A7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    #1B8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    #1AMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    #1ANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    #1AYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    #1AWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    #1AOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    #1AXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    #1APPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    #1ASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    #1A4VA           TH Total Net WO
     C                     Z-ADDA1A5VA    #1A5VA           TH Additions Am
     C                     Z-ADDA1CBPR    #1CBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    #1CCPR           Th Payment Net
     C                     Z-ADDA1LPNB    #1LPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    #1CDPR           TH Freight Amou
     C                     Z-ADDA1ATPR    #1ATPR           TH Carcass Net
     C                     Z-ADDA1A7VA    #1A7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    #1A2PR           TH Fixed Cost A
     C                     MOVELA1JWST    #1JWST           TH Calc Net Sts
     C                     MOVELA1CWST    #1CWST           TH Payment Sts
     C                     MOVELA1D7ST    #1D7ST           TH Header Error
     C                     MOVELA1D8ST    #1D8ST           TH Detail Error
     C                     MOVELA1DWST    #1DWST           TH Kill Balanci
     C                     MOVELA1D6ST    #1D6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    #1GHNB           TH Commission A
     C                     Z-ADDA1BYDT    #1BYDT           TH Voucher Paym
     C                     MOVELA1E0ST    #1E0ST           TH User Error O
     C                     MOVELA1E1ST    #1E1ST           TH Held Over Re
     C                     Z-ADDA1BSDT    #1BSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    #1BTDT           TH Commission P
     C                     Z-ADDA1BUDT    #1BUDT           TH Actual Check
     C                     Z-ADDA1HHNB    #1HHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    #1HINB           TH FFLI
     C                     Z-ADDA1A3PR    #1A3PR           TH Kill Product
     C                     Z-ADDA1A4PR    #1A4PR           TH Cut Product
     C                     Z-ADDA1A6PR    #1A6PR           TH Render Produ
     C                     Z-ADDA1J9NB    #1J9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    #1D6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    #1D7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    #1D8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    #1D9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    #1EAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    #1EBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    #1ECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    #1EDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    #1EEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    #1EFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    #1EGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    #1EHPR           TH CM Gross Car
     C                     MOVELA1KAST    #1KAST           TH Source Type
     C                     MOVELA1J7ST    #1J7ST           TH Scale Ticket
     C                     MOVELA1J8ST    #1J8ST           TH Posted to HP
     C                     MOVELA1LJST    #1LJST           TH Shift Held O
     C                     MOVELA1HJCD    #1HJCD           TH Unused Code
     C                     MOVELA1R4ST    #1R4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    #1R5ST           TH Commission S
     C                     MOVELA1R6ST    #1R6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    #1R7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    #1THWT           TH DOA Weight
     C                     Z-ADDA1T2WT    #1T2WT           TH Avg Lean % E
     C                     Z-ADDA1T2HD    #1T2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    #1OBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    #1KOER           TH Head Identif
     C                     Z-ADDA1OPIR    #1OPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    #1OPEM           TH Percent Acce
     C                     Z-ADDA1IORP    #1IORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    #1OWEO           TH PHA Head Add
     C                     MOVELA1OQET    #1OQET           TH PHA Add Type
     C                     MOVELA1URST    #1URST           TH PHA Average
     C                     MOVELA1USST    #1USST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    #1HHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    #1S9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    #1TAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    #1TBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    #1JFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    #1KRIF           TH Broken Back
     C                     Z-ADDA1KORF    #1KORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    #1KAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    #1KROT           TH Excluded Car
     C                     Z-ADDA1OTJG    #1OTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    #1IRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    #1IMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    #1IRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    #1KRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    #1OJRF           TH Break Even P
     C                     Z-ADDA1KFOR    #1KFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    #1ORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    #1OMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    #1MVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    #1MCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    #1NCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    #1NCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    #1IGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    #1KFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    #1EADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    #1EBDT           TH Cold Scl Upl
     C                     Z-ADDA1EEDT    #1EEDT           TH Unused Date
     C                     MOVELA1U4ST    #1U4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    #1U5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    #1U6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    #1U7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    #1U8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    #1U9ST           TH Unused Sts 6
     C                     MOVELA1VAST    #1VAST           TH Unused Sts 7
     C                     MOVELA1VBST    #1VBST           TH Unused Sts 8
     C                     MOVELA1J9ST    #1J9ST           TH Payment Type
     C                     MOVELA1LKST    #1LKST           TH Source Code
     C                     MOVELA1CSCD    #1CSCD           THP Process Cod
     C                     MOVELA1ACCD    #1ACCD           HB Buyer Code
     C                     MOVELA1AAVN    #1AAVN           RS User Changed
     C                     Z-ADDA1AADT    #1AADT           RS Date Changed
     C                     Z-ADDA1AMTM    #1AMTM           RS Time Changed
     C                     MOVELA1AJST    #1AJST           RS Record Statu
     C                     MOVELA1AHVN    #1AHVN           RS Job
     C                     MOVELA1AGVN    #1AGVN           RS Program
     C                     MOVELA1ABVN    #1ABVN           RS User Added
     C                     Z-ADDA1ABDT    #1ABDT           RS Date Added
     C                     Z-ADDA1ABTM    #1ABTM           RS Time Added
     C                     MOVELA1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELA1AECD    #1AECD           PL Location Cod
     C                     Z-ADDA1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    #1BONB           BOL Load Number
     C                     Z-ADDA1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    #1B0DT           TH Kill Date
     C                     Z-ADDA1AWDT    #1AWDT           TH Purchase Dat
     C                     MOVELA1LLST    #1LLST           TH Hog Class Ty
     C                     MOVELA1BECD    #1BECD           HC Class Code
     C                     Z-ADDA1OXNB    #1OXNB           TH HPS Movement
     C                     MOVELA1BICD    #1BICD           TH Group Refere
     C                     MOVELA1E2ST    #1E2ST           TH Sex
     C                     Z-ADDA1THHD    #1THHD           TH HPS Farm Sit
     C                     MOVELA1NZTX    #1NZTX           TH State
     C                     MOVELA1AGCD    #1AGCD           GN Genetic Code
     C                     MOVELA1LIST    #1LIST           TH Schedule Kil
     C                     Z-ADDA1CWNB    #1CWNB           TH Head Receive
     C                     Z-ADDA1CXNB    #1CXNB           TH Dead On Arri
     C                     Z-ADDA1ACPR    #1ACPR           TH Live Purchas
     C                     Z-ADDA1ECDT    #1ECDT           TH Head LFT
     C                     Z-ADDA1EDDT    #1EDDT           TH Head EUT/KOA
     C                     MOVELA1CPST    #1CPST           TH Live Purchas
     C                     Z-ADDA1HGNB    #1HGNB           TH Shipped Weig
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP2IHST    #PIHST           Record Added Us
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
      * Check restriction within
     C                     EXSR VHCKRL
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      * Convert TH Purchase Date to display format
      * Convert date
     C           1000000   ADD  #1AWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AWDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG0CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNA     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG1CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNB     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG2CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNC     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG3CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSND     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * Rtv Val Pen,Type      RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A3HVNB    WQNE01           Pen Company Num
     C           *LIKE     DEFN A3CMCD    WQNE02           Pen Number
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WQNE01           Pen Company Num
     C                     KFLD           WQNE02           Pen Number
      * Setup key
     C                     Z-ADD#1HMNB    WQNE01           Pen Company Num
     C                     MOVEL#DCMCD    WQNE02           Pen Number
      * Establish starting position
     C           KRSNE     SETLL@A3REKF                    *
     C           KRSNE     READE@A3REKF                  90*
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA3FWST    WUFWST           Pen Type
     C           KRSNE     READE@A3REKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * Rtv BOH Pay Type      RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD#1HMNB    AWHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSNF     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'L'       WUA4ST           BOH Payment Typ
     C                     MOVEL'O'       WUA5ST           BOH Buy Order T
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWA4ST    WUA4ST           BOH Payment Typ
     C                     MOVELAWA5ST    WUA5ST           BOH Buy Order T
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * Rtv Std Time,buyer    RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSNG     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACAATH    WUAATH           PD Std Delv Tim
     C                     Z-ADDACAMNB    WUAMNB           PD Std Truck Si
     C                     MOVELACIWST    WUIWST           PD Freight Exp
     C                     MOVELACAACD    WUAACD           SR Source Code
     C                     MOVELACACCD    #1ACCD           HB Buyer Code
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#1BDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNH     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #DBCTX           DF Description
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    #DBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * Rtv and UnAssigned    RT - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJHONB    WQNI01           CC Company Numb
     C           *LIKE     DEFN FJHSA1    WQNI02           TP Tattoo Numbe
     C           *LIKE     DEFN FJHMNB    WQNI03           BOH Company Num
     C           *LIKE     DEFN FJBNNB    WQNI04           BOH Buy Order N
     C           *LIKE     DEFN FJBONB    WQNI05           BOL Load Number
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           WQNI01           CC Company Numb
     C                     KFLD           WQNI02           TP Tattoo Numbe
     C                     KFLD           WQNI03           BOH Company Num
     C                     KFLD           WQNI04           BOH Buy Order N
     C                     KFLD           WQNI05           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQNI01           CC Company Numb
     C                     Z-ADDP1CVNB    WQNI02           TP Tattoo Numbe
     C                     Z-ADDP1HMNB    WQNI03           BOH Company Num
     C                     Z-ADDP1BNNB    WQNI04           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNI05           BOL Load Number
      * Establish starting position
     C           KRSNI     SETLL@FJCPKH                    *
     C           KRSNI     READE@FJCPKH                  90*
      * Data record not found
     C   90                MOVEL'PRK1012' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo UnAssigned CH - Tattoo Pending  * 
     C                     EXSR NJCHRC
     C           KRSNI     READE@FJCPKH                  90*
     C                     ENDDO
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJCHRC    BEGSR
      *================================================================
      * Chg Tattoo UnAssigned CH - Tattoo Pending  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       Employee ID
     C                     Z-ADD*ZERO     WN0002  60       TP Tattoo Creat
     C                     MOVEL*BLANK    WN0003  1        TP Alley Number
     C                     Z-ADD*ZERO     WN0004  50       Employee Number
     C                     MOVEL*BLANK    WN0005 10        RS User Changed
     C                     Z-ADD*ZERO     WN0006  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0007  60       RS Time Changed
     C                     MOVEL*BLANK    WN0008  1        RS Record Statu
     C                     MOVEL*BLANK    WN0009 10        RS Job
     C                     MOVEL*BLANK    WN0010 10        RS Program
     C                     MOVEL*BLANK    WN0011 10        RS User Added
     C                     Z-ADD*ZERO     WN0012  70       RS Date Added
     C                     Z-ADD*ZERO     WN0013  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPHV
     C                     Z-ADDFJHONB    WFHONB           CC Company Numb
     C                     Z-ADDFJEZDT    WFEZDT           TP Tattoo Date
     C                     Z-ADDFJHSA1    WFHSA1           TP Tattoo Numbe
      *
     C           KLCHNJ    KLIST
     C                     KFLD           WFHONB           CC Company Numb
     C                     KFLD           WFEZDT           TP Tattoo Date
     C                     KFLD           WFHSA1           TP Tattoo Numbe
     C           KLCHNJ    CHAIN@FJCPHV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFJCPL0'MDACP
     C                     MOVEL'@FJCPHV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFJ1    YARDCS
      * Move non-key fields to @FJCPHV
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     MOVEL'P'       WFWQST    P      TP Tattoo Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WFAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WFAADT    PARM *ZERO     WQ0106  70       *DATE
     C           WFAMTM    PARM *ZERO     WQ0107  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPHV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQNK01           BOH Company Num
     C           *LIKE     DEFN WGB0DT    WQNK02           TH Kill Date
     C           *LIKE     DEFN WGCVNB    WQNK03           TH Tattoo Numbe
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           WQNK01           BOH Company Num
     C                     KFLD           WQNK02           TH Kill Date
     C                     KFLD           WQNK03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNK01           BOH Company Num
     C                     Z-ADDP1B0DT    WQNK02           TH Kill Date
     C                     Z-ADD#1CVNB    WQNK03           TH Tattoo Numbe
      * Establish starting position
     C           KRSNK     SETLL@A1CPL0                    *
     C           KRSNK     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NKEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQNL01           BOH Company Num
     C           *LIKE     DEFN WGB0DT    WQNL02           TH Kill Date
     C           *LIKE     DEFN WGCVNB    WQNL03           TH Tattoo Numbe
      * Define keylist
     C           KRSNL     KLIST
     C                     KFLD           WQNL01           BOH Company Num
     C                     KFLD           WQNL02           TH Kill Date
     C                     KFLD           WQNL03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNL01           BOH Company Num
     C                     Z-ADDYL0015    WQNL02           TH Kill Date
     C                     Z-ADD#1CVNB    WQNL03           TH Tattoo Numbe
      * Establish starting position
     C           KRSNL     SETLL@A1CPL0                    *
     C           KRSNL     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NLEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQNM01           BOH Company Num
     C           *LIKE     DEFN WGB0DT    WQNM02           TH Kill Date
     C           *LIKE     DEFN WGCVNB    WQNM03           TH Tattoo Numbe
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           WQNM01           BOH Company Num
     C                     KFLD           WQNM02           TH Kill Date
     C                     KFLD           WQNM03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNM01           BOH Company Num
     C                     Z-ADDYL0016    WQNM02           TH Kill Date
     C                     Z-ADD#1CVNB    WQNM03           TH Tattoo Numbe
      * Establish starting position
     C           KRSNM     SETLL@A1CPL0                    *
     C           KRSNM     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NMEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Set Pen Totals to Zeros - Pen  * 
     C                     EXSR NORVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQNN01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQNN02           Pen Number
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           WQNN01           BOH Company Num
     C                     KFLD           WQNN02           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WQNN01           BOH Company Num
     C                     MOVEL#DCMCD    WQNN02           Pen Number
      * Establish starting position
     C           KRSNN     SETLL@A2CPKE                    *
     C           KRSNN     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR NQCHRC
     C                     GOTO NNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Totals    RT - Pen  * 
     C                     EXSR NRRVGN
     C           KRSNN     READE@A2CPKE                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR NTRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR NWCHRC
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NORVGN    BEGSR
      *================================================================
      * Set Pen Totals to Zeros - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNO     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WIHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSNO     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pen               CH - Pen  * 
     C                     EXSR NPCHRC
     C                     ENDIF
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHNP    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHNP    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YBRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUCRTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWUCRTX    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0014  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0015  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0016  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0017  1        Pen Sts
     C                     Z-ADD*ZERO     WN0018  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0019  1        Pen Type
     C                     Z-ADD*ZERO     WN0020  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0021 10        RS User Changed
     C                     Z-ADD*ZERO     WN0022  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0023  60       RS Time Changed
     C                     MOVEL*BLANK    WN0024  1        RS Record Statu
     C                     MOVEL*BLANK    WN0025 10        RS Job
     C                     MOVEL*BLANK    WN0026 10        RS Program
     C                     MOVEL*BLANK    WN0027 10        RS User Added
     C                     Z-ADD*ZERO     WN0028  70       RS Date Added
     C                     Z-ADD*ZERO     WN0029  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHNQ    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHNQ    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YCRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Totals    RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WIHVNB           Pen Company Num
     C                     MOVELWHCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSNR     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHC0NB    ADD  WID6NB    WUD6NB           Pen Current Hea
     C                     SUB  WHD8NB    WUD6NB           Pen Current Hea
      * Chg Pen               CH - Pen  * 
     C                     EXSR NSCHRC
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHNS    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHNS    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YDRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWIBBTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADDWUD6NB    WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWIAGCD    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQNT01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQNT02           Pen Number
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WQNT01           BOH Company Num
     C                     KFLD           WQNT02           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WQNT01           BOH Company Num
     C                     MOVELWHCMCD    WQNT02           Pen Number
      * Establish starting position
     C           KRSNT     SETLL@A2CPKE                    *
     C           KRSNT     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO NTEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WHB9CD    IFEQ 'D'                        *IF
     C           WHB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR NURVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNT     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NURVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQNU01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQNU02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQNU03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQNU04           TH Tattoo Numbe
      * Define keylist
     C           KRSNU     KLIST
     C                     KFLD           WQNU01           BOH Company Num
     C                     KFLD           WQNU02           BOH Buy Order N
     C                     KFLD           WQNU03           BOL Load Number
     C                     KFLD           WQNU04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWHHMNB    WQNU01           BOH Company Num
     C                     Z-ADDWHBNNB    WQNU02           BOH Buy Order N
     C                     Z-ADDWHBONB    WQNU03           BOL Load Number
     C                     Z-ADDWHCVNB    WQNU04           TH Tattoo Numbe
      * Establish starting position
     C           KRSNU     SETLL@A1CPC4                    *
     C           KRSNU     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO NUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELA1AGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR NVRVGN
     C           KRSNU     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNV     KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVELA1AGCD    AIAGCD           GN Genetic Code
      * Establish starting position
     C           KRSNV     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0030  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0031  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0032  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0033  1        Pen Sts
     C                     Z-ADD*ZERO     WN0034  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0035  1        Pen Type
     C                     Z-ADD*ZERO     WN0036  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0037 10        RS User Changed
     C                     Z-ADD*ZERO     WN0038  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0039  60       RS Time Changed
     C                     MOVEL*BLANK    WN0040  1        RS Record Statu
     C                     MOVEL*BLANK    WN0041 10        RS Job
     C                     MOVEL*BLANK    WN0042 10        RS Program
     C                     MOVEL*BLANK    WN0043 10        RS User Added
     C                     Z-ADD*ZERO     WN0044  70       RS Date Added
     C                     Z-ADD*ZERO     WN0045  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHNW    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHNW    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YERDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXRVGN    BEGSR
      *================================================================
      * Rtv/Chg Bol Hd rcvd   RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNX     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSNX     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           AXDHNB    ADD  WUCWNB    WUDHNB           BOL Head Receiv
     C                     ADD  AXDINB    WUDINB           BOL Live Wgt Re
      * Calculate freight based on the unit of measure
     C                     Z-ADDAXATVA    WUATVA           BOL Freight Amt
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
     C                     EXSR NYRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.BOL Freight Allocation is Freight is Allocated
      *   |- c2    : WRK.Tattoo is paid Usr is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           AXI1ST    IFEQ 'Y'                        *IF
     C           WUNPST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: DB1.BOL Trucker Payment Sts is Paid Trucker
     C           AXCNST    IFEQ 'PT'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc Freight Amt       XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ5XFR'              90  Clc Freight Amt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM AXHMNB    WQ0233  30       BOH Company Num
     C                     PARM AXBNNB    WQ0234  70       BOH Buy Order N
     C                     PARM AXBONB    WQ0235  50       BOL Load Number
     C                     PARM AXCMST    WQ0236  2        BOL Freight UOM
     C                     PARM AXAGPR    WQ0237  72       BOL Freight Uni
     C           WUATVA    PARM WUATVA    WQ0238  72       BOL Freight Amt
     C                     PARM AXI1ST    WQ0239  1        BOL Freight All
     C                     PARM WUDHNB    WQ0240  70       BOL Head Receiv
     C                     PARM WUDINB    WQ0241  71       BOL Live Wgt Re
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : WRK.BOL Freight Amt is Not Zeros
      *   |- c2    : WRK.BOL Head Received is Greater then Zero
      *   |- c3    : DB1.BOL Trucker Payment Sts is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUATVA    IFNE 0                          *IF
     C           WUDHNB    IFGT 0                          *IF
     C           AXCNST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ST'      WUCNST           BOL Trucker Pay
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELAXCNST    WUCNST           BOL Trucker Pay
     C                     END                             *FI
      * Chg Buy Order Detail  CH - Buy Order Load  * 
     C                     EXSR NZCHRC
     C                     ENDIF
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYRVGN    BEGSR
      *================================================================
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUK4PR           Tot Frt Spdb af
     C                     MOVEL'N'       WUNFST           Held Over Recor
     C                     MOVEL'N'       WUNPST           Tattoo is paid
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQNY01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQNY02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQNY03           BOL Load Number
      * Define keylist
     C           KRSNY     KLIST
     C                     KFLD           WQNY01           BOH Company Num
     C                     KFLD           WQNY02           BOH Buy Order N
     C                     KFLD           WQNY03           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    WQNY01           BOH Company Num
     C                     Z-ADDAXBNNB    WQNY02           BOH Buy Order N
     C                     Z-ADDAXBONB    WQNY03           BOL Load Number
      * Establish starting position
     C           KRSNY     SETLL@A1CPC4                    *
     C           KRSNY     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If one tattoo is paid but freight was spread then accumulate
      * what is paid, for held over respread problem
      * when this probelm goes away, then just flag that there is one pai
      * CASE: DB1.TH Payment Sts is Paid Anything
     C           A1CWST    IFEQ 'PL'                       *IF
     C           A1CWST    OREQ 'PC'
     C           A1CWST    OREQ 'NC'
     C           A1CWST    OREQ 'NL'
      * CHECK IF FREIGHT AMOUNT IS IN RECORD
      * CASE: DB1.TH Freight Amount is Not Zeros
     C           A1CDPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUNPST           Tattoo is paid
     C                     END                             *FI
     C                     ADD  A1CDPR    WUK4PR           Tot Frt Spdb af
     C                     ELSE
      * CASE: *OTHERWISE
      * CHECK FOR HELD OVER RECORD
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TH Held Over Record is Yes
      *   |- c2    : DB1.TH Held Over is greater than 0
      *   '-
     C           A1E1ST    IFEQ 'Y'                        *IF
     C           A1H9NB    ORGT 0                          *OR
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNY     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZCHRC    BEGSR
      *================================================================
      * Chg Buy Order Detail  CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0046  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0047  1        Reported to USD
     C                     MOVEL*BLANK    WN0048  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0049  2        BOL Status 5
     C                     MOVEL*BLANK    WN0050  2        BOL Status 6
     C                     MOVEL*BLANK    WN0051  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0052  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0053  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0054  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0055  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0056  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0057 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0058 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0059 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0060 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0061 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0062  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0063  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0064  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0065  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0066  70       BOL Unused Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDAXHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    WKBONB           BOL Load Number
      *
     C           KLCHNZ    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHNZ    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YFRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADDAXCQDT    WKCQDT           BOL Kill Date
     C                     Z-ADDAXABTH    WKABTH           BOL Pln Delv St
     C                     Z-ADDAXACTH    WKACTH           BOL Pln Delv En
     C                     Z-ADDAXBPNB    WKBPNB           BOL Pln Head De
     C                     Z-ADDAXCSNB    WKCSNB           BOL Shipped Wgt
     C                     Z-ADDAXAUDT    WKAUDT           BOL Pln Delv Da
     C                     MOVELAXCMST    WKCMST    P      BOL Freight UOM
     C                     Z-ADDAXAGPR    WKAGPR           BOL Freight Uni
     C                     Z-ADDWUATVA    WKATVA           BOL Freight Amt
     C                     MOVELAXI1ST    WKI1ST    P      BOL Freight All
     C                     Z-ADDWUDHNB    WKDHNB           BOL Head Receiv
     C                     Z-ADDWUDINB    WKDINB           BOL Live Wgt Re
     C                     MOVELWUCNST    WKCNST    P      BOL Trucker Pay
     C                     Z-ADDAXGINB    WKGINB           BOL Trucker Che
     C                     Z-ADDAXBZDT    WKBZDT           BOL Trucker Che
     C                     Z-ADDAXLSNB    WKLSNB           BOL AP Voucher
     C                     MOVELAXF3TX    WKF3TX    P      BOL Trailer
     C                     MOVELAXO8ST    WKO8ST    P      BOL Freight Exp
     C                     MOVELAXO9ST    WKO9ST    P      BOL Scheduled K
     C                     MOVELAXPAST    WKPAST    P      BOL Truck Scale
     C                     MOVELAXPDST    WKPDST    P      BOL Violated Au
     C                     MOVELAXBNCD    WKBNCD    P      TRK Trucker Cod
     C                     MOVELAXABCD    WKABCD    P      PD Producer Cod
     C                     MOVELAXAECD    WKAECD    P      PL Location Cod
     C                     MOVELAXAAVN    WKAAVN    P      RS User Changed
     C                     Z-ADDAXAADT    WKAADT           RS Date Changed
     C                     Z-ADDAXAMTM    WKAMTM           RS Time Changed
     C                     MOVELAXAJST    WKAJST    P      RS Record Statu
     C                     MOVELAXAHVN    WKAHVN    P      RS Job
     C                     MOVELAXAGVN    WKAGVN    P      RS Program
     C                     MOVELAXABVN    WKABVN    P      RS User Added
     C                     Z-ADDAXABDT    WKABDT           RS Date Added
     C                     Z-ADDAXABTM    WKABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OARVGN    BEGSR
      *================================================================
      * Rtv/Chg BOH Status     RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOA     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDP1HMNB    AWHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSOA     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) AWETCD' defaulted for 'BOH Commodity Market Code'.
      * Field '(DB1) AWEUCD' defaulted for 'BOH Commodity Price Group'.
      * Field '(DB1) AWJ5TX' defaulted for 'BOH Market Date Method'.
      * Chg BOH Status         CH - Buy Order Header  * 
     C                     EXSR OBCHRC
     C                     ENDIF
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBCHRC    BEGSR
      *================================================================
      * Chg BOH Status         CH - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0067  70       BOH MPR Reporti
     C                     Z-ADD*ZERO     WN0068  70       BOH Hedge Date
     C                     Z-ADD*ZERO     WN0069  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0070  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0071  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0072  70       BOH Hedge Head
     C                     Z-ADD*ZERO     WN0073  70       BOH Hedge Refer
     C                     Z-ADD*ZERO     WN0074  70       BOH Hedge Time
     C                     Z-ADD*ZERO     WN0075  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0076  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0077  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0078  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0079 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0080 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0081 112       BOH Unused Nbr
     C                     MOVEL*BLANK    WN0082  1        BOH MPR Reporti
     C                     MOVEL*BLANK    WN0083  1        BOH MPR EST RPT
     C                     MOVEL*BLANK    WN0084  2        BOH MPR Purchas
     C                     MOVEL*BLANK    WN0085  3        BOH Status 4
     C                     MOVEL*BLANK    WN0086  3        BOH Status 5
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @AWCPAZ
     C                     Z-ADDAWHMNB    WLHMNB           BOH Company Num
     C                     Z-ADDAWBNNB    WLBNNB           BOH Buy Order N
      *
     C           KLCHOB    KLIST
     C                     KFLD           WLHMNB           BOH Company Num
     C                     KFLD           WLBNNB           BOH Buy Order N
     C           KLCHOB    CHAIN@AWCPAZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAWCPL0'MDACP
     C                     MOVEL'@AWCPAZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAW1    YGRDCS
      * Move non-key fields to @AWCPAZ
     C                     Z-ADDAWARDT    WLARDT           BOH Buy Order D
     C                     Z-ADDAWASDT    WLASDT           BOH Kill Date
     C                     MOVELAWA4ST    WLA4ST    P      BOH Payment Typ
     C                     MOVELAWA5ST    WLA5ST    P      BOH Buy Order T
     C                     Z-ADDAWAAPR    WLAAPR           BOH Market Add/
     C                     MOVEL'L'       WLA6ST    P      BOH Status
     C                     MOVELAWA7ST    WLA7ST    P      BOH Delv Plan P
     C                     MOVELAWB3ST    WLB3ST    P      BOH Quote Price
     C                     Z-ADDAWALPR    WLALPR           BOH Quoted Base
     C                     MOVELAWETCD    WLETCD    P      BOH Commodity M
     C                     MOVELAWEUCD    WLEUCD    P      BOH Commodity P
     C                     MOVELAWJ5TX    WLJ5TX    P      BOH Market Date
     C                     Z-ADDAWHXNB    WLHXNB           PPWS Company Nu
     C                     Z-ADDAWGANB    WLGANB           CW Year
     C                     Z-ADDAWGBNB    WLGBNB           CW Week Number
     C                     MOVELAWABCD    WLABCD    P      PD Producer Cod
     C                     MOVELAWAECD    WLAECD    P      PL Location Cod
     C                     MOVELAWAKCD    WLAKCD    P      PC Contract Cod
     C                     MOVELAWALCD    WLALCD    P      PSC Sub-Contrac
     C                     MOVELAWAGCD    WLAGCD    P      GN Genetic Code
     C                     MOVELAWAICD    WLAICD    P      PO Option Code
     C                     MOVELAWAMCD    WLAMCD    P      CMP Program Cod
     C                     MOVELAWACCD    WLACCD    P      HB Buyer Code
     C                     MOVELAWAAVN    WLAAVN    P      RS User Changed
     C                     Z-ADDAWAADT    WLAADT           RS Date Changed
     C                     Z-ADDAWAMTM    WLAMTM           RS Time Changed
     C                     MOVELAWAJST    WLAJST    P      RS Record Statu
     C                     MOVELAWAHVN    WLAHVN    P      RS Job
     C                     MOVELAWAGVN    WLAGVN    P      RS Program
     C                     MOVELAWABVN    WLABVN    P      RS User Added
     C                     Z-ADDAWABDT    WLABDT           RS Date Added
     C                     Z-ADDAWABTM    WLABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WLAAVN           RS User Changed
     C                     Z-ADD##JDT     WLAADT           RS Date Changed
     C                     Z-ADD##JTM     WLAMTM           RS Time Changed
     C                     MOVEL##JOB     WLAHVN           RS Job
     C                     MOVEL##PGM     WLAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@AWCPAZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAWCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCRVGN    BEGSR
      *================================================================
      * Rtv Chg Lock Sts      RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AEHMNB    WQOC01           BOH Company Num
     C           *LIKE     DEFN AEBNNB    WQOC02           BOH Buy Order N
     C           *LIKE     DEFN AEBONB    WQOC03           BOL Load Number
     C           *LIKE     DEFN AEE0DT    WQOC04           DSH Kill Date
      * Define keylist
     C           KRSOC     KLIST
     C                     KFLD           WQOC01           BOH Company Num
     C                     KFLD           WQOC02           BOH Buy Order N
     C                     KFLD           WQOC03           BOL Load Number
     C                     KFLD           WQOC04           DSH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOC01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOC02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOC03           BOL Load Number
     C                     Z-ADDP1B0DT    WQOC04           DSH Kill Date
      * Establish starting position
     C           KRSOC     SETLL@AECPI5                    *
     C           KRSOC     READE@AECPI5                  90*
      * Data record not found
     C   90                MOVEL'PRK1028' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Delv Sched Dtl    CH - Delivery Sched Detail  * 
     C                     EXSR ODCHRC
     C           KRSOC     READE@AECPI5                  90*
     C                     ENDDO
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODCHRC    BEGSR
      *================================================================
      * Chg Delv Sched Dtl    CH - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @AECPIH
     C                     Z-ADDAEHONB    WMHONB           CC Company Numb
     C                     Z-ADDAEE0DT    WME0DT           DSH Kill Date
     C                     Z-ADDAEE6DT    WME6DT           DSD Delivery Da
     C                     Z-ADDAEAGTH    WMAGTH           DSD Delivery Ti
     C                     Z-ADDAEHZA1    WMHZA1           DSD Delivery Ti
      *
     C           KLCHOD    KLIST
     C                     KFLD           WMHONB           CC Company Numb
     C                     KFLD           WME0DT           DSH Kill Date
     C                     KFLD           WME6DT           DSD Delivery Da
     C                     KFLD           WMAGTH           DSD Delivery Ti
     C                     KFLD           WMHZA1           DSD Delivery Ti
     C           KLCHOD    CHAIN@AECPIH              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAECPL1'MDACP
     C                     MOVEL'@AECPIH' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO ODEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO ODEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAE1    YHRDCS
      * Move non-key fields to @AECPIH
     C                     Z-ADDAEH0A1    WMH0A1           DSD Scheduled H
     C                     Z-ADDAEH1A1    WMH1A1           DSD Farm Site C
     C                     MOVELAEJ4CD    WMJ4CD    P      DSD Building
     C                     MOVELAEJ5CD    WMJ5CD    P      DSD Room
     C                     MOVELAELBCD    WMLBCD    P      DSD Sire Line C
     C                     MOVELAELCCD    WMLCCD    P      DSD Hog Group C
     C                     Z-ADDAEIOA1    WMIOA1           DSD Unused Head
     C                     Z-ADDAEH2A1    WMH2A1           DSD Scheduled D
     C                     Z-ADDAEIJA1    WMIJA1           DSD Scheduled K
     C                     MOVELAEK9CD    WMK9CD    P      DSD Transportat
     C                     MOVELAEK8CD    WMK8CD    P      DSD Trucker Cod
     C                     MOVELAEJ6CD    WMJ6CD    P      DSD Driver
     C                     MOVELAEJ7CD    WMJ7CD    P      DSD Loading Cre
     C                     MOVELAEMGCD    WMMGCD    P      CHR Code
     C                     MOVELAEW1ST    WMW1ST    P      DSD Load Type
     C                     MOVELAEW2ST    WMW2ST    P      DSD Full/Split
     C                     Z-ADDAEH3A1    WMH3A1           DSD Movement Nu
     C                     MOVELAEMECD    WMMECD    P      DSD Truck ID
     C                     MOVELAEMFCD    WMMFCD    P      DSD Trailer ID
     C                     MOVELAEW4ST    WMW4ST    P      DSD Movement Pr
     C                     MOVELAEXWST    WMXWST    P      DSD Sched Route
     C                     Z-ADDAEFRDT    WMFRDT           DSD Sched Route
     C                     Z-ADDAEBOTH    WMBOTH           DSD Sched Route
     C                     Z-ADDAEE7DT    WME7DT           DSD Sch Farm Ar
     C                     Z-ADDAEAHTH    WMAHTH           DSD Sch Farm Ar
     C                     Z-ADDAEE8DT    WME8DT           DSD Sch Start L
     C                     Z-ADDAEAITH    WMAITH           DSD Sch Start L
     C                     MOVELAEXBST    WMXBST    P      DSD Receiving S
     C                     MOVELAEXGST    WMXGST    P      DSD Kill Shift
     C                     MOVELAEXPST    WMXPST    P      DSD BOL Kill Sh
     C                     MOVELAEXNST    WMXNST    P      DSD HPS Post St
     C                     MOVELAEXTST    WMXTST    P      DSD HPE Post St
     C                     MOVEL'L'       WMXLST    P      DSD Lock Status
     C                     MOVELAEW0ST    WMW0ST    P      DSD Source Type
     C                     MOVELAEYEST    WMYEST    P      DSD Transfer St
     C                     Z-ADDAEFZDT    WMFZDT           DSD Unused Date
     C                     Z-ADDAEB1TH    WMB1TH           DSD Unused Time
     C                     MOVELAEAACD    WMAACD    P      SR Source Code
     C                     MOVELAEABCD    WMABCD    P      PD Producer Cod
     C                     MOVELAEAECD    WMAECD    P      PL Location Cod
     C                     Z-ADDAEHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDAEBNNB    WMBNNB           BOH Buy Order N
     C                     Z-ADDAEBONB    WMBONB           BOL Load Number
     C                     Z-ADDAEY0A1    WMY0A1           DSD PRD Srv Bat
     C                     Z-ADDAEY1A1    WMY1A1           DSD PRD Srv Sch
     C                     MOVELAEDGT1    WMDGT1    P      DSD Ref 1
     C                     MOVELAEDHT1    WMDHT1    P      DSD Ref 2
     C                     MOVELAEIISS    WMIISS    P      DSD Ref Status
     C                     MOVELAEAAVN    WMAAVN    P      RS User Changed
     C                     Z-ADDAEAADT    WMAADT           RS Date Changed
     C                     Z-ADDAEAMTM    WMAMTM           RS Time Changed
     C                     MOVELAEAJST    WMAJST    P      RS Record Statu
     C                     MOVELAEAHVN    WMAHVN    P      RS Job
     C                     MOVELAEAGVN    WMAGVN    P      RS Program
     C                     MOVELAEABVN    WMABVN    P      RS User Added
     C                     Z-ADDAEABDT    WMABDT           RS Date Added
     C                     Z-ADDAEABTM    WMABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@AECPIH                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAECPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OECRRC    BEGSR
      *================================================================
      * Create Tattoo Header - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @A1CPC5
     C                     Z-ADDP1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    A1B0DT           TH Kill Date
     C                     Z-ADD#1AWDT    A1AWDT           TH Purchase Dat
     C                     MOVEL#1BICD    A1BICD           TH Group Refere
     C                     MOVEL#1CPST    A1CPST           TH Live Purchas
     C                     Z-ADD#1ACPR    A1ACPR           TH Live Purchas
     C                     Z-ADD#1B9PR    A1B9PR           TH Live Gross A
     C                     Z-ADD#1CAPR    A1CAPR           TH LIve Net Amt
     C                     MOVEL#1C4ST    A1C4ST           TH Resale UOM
     C                     Z-ADD#1AIPR    A1AIPR           TH Recalc Live
     C                     Z-ADD#1A6DT    A1A6DT           TH Pricing Date
     C                     MOVEL#1C2ST    A1C2ST           TH Resale Sprea
     C                     Z-ADD#1CXNB    A1CXNB           TH Dead On Arri
     C                     Z-ADDWUCWNB    A1CWNB           TH Head Receive
     C                     Z-ADD#1FCNB    A1FCNB           TH Yard Deads
     C                     Z-ADD#1H9NB    A1H9NB           TH Held Over
     C                     Z-ADD#1FDNB    A1FDNB           TH Head Condemn
     C                     Z-ADD#1FENB    A1FENB           TH Head Killed
     C                     Z-ADD#1HENB    A1HENB           TH Head Adds
     C                     Z-ADD#1HFNB    A1HFNB           TH Head Accepte
     C                     Z-ADD#1CYNB    A1CYNB           TH Live Wgt
     C                     Z-ADD#1LRNB    A1LRNB           TH Adj Live Wgt
     C                     Z-ADD#1E0NB    A1E0NB           TH Hot Wgt
     C                     Z-ADD#1A5PC    A1A5PC           TH Tot Loin Eye
     C                     Z-ADD#1FBNB    A1FBNB           TH Tot Backfat
     C                     Z-ADD#1A4PC    A1A4PC           TH Tot Light Re
     C                     Z-ADD#1F7NB    A1F7NB           TH Avg Live Wgt
     C                     Z-ADD#1HDNB    A1HDNB           TH Avg Hot Wgt
     C                     Z-ADD#1F5NB    A1F5NB           TH Avg Light Re
     C                     Z-ADD#1F4NB    A1F4NB           TH Avg Lean Per
     C                     Z-ADD#1F3NB    A1F3NB           TH Avg Loin Eye
     C                     Z-ADD#1F2NB    A1F2NB           TH Avg Backfat
     C                     Z-ADD#1AVPC    A1AVPC           TH Std Yield Pe
     C                     Z-ADD#1AWPC    A1AWPC           TH Actual Yield
     C                     Z-ADD#1CWPC    A1CWPC           TH Adj Actual Y
     C                     Z-ADD#1A8PC    A1A8PC           TH Yield Differ
     C                     Z-ADD#1A7PC    A1A7PC           TH Recalc Live
     C                     Z-ADD#1B8PR    A1B8PR           TH CM Market Pr
     C                     Z-ADD#1AMPR    A1AMPR           TH CM Base Mkt
     C                     Z-ADD#1ANPR    A1ANPR           TH CM Base Mkt
     C                     Z-ADD#1AYVA    A1AYVA           TH CM Sort Disc
     C                     Z-ADD#1AWVA    A1AWVA           TH CM Yield Gai
     C                     Z-ADD#1AOPR    A1AOPR           TH CM Base Carc
     C                     Z-ADD#1AXVA    A1AXVA           TH CM LN AddOn/
     C                     Z-ADD#1APPR    A1APPR           TH CM Carcass G
     C                     Z-ADD#1ASPR    A1ASPR           TH Deduction Am
     C                     Z-ADD#1A4VA    A1A4VA           TH Total Net WO
     C                     Z-ADD#1ATPR    A1ATPR           TH Carcass Net
     C                     Z-ADD#1A5VA    A1A5VA           TH Additions Am
     C                     Z-ADD#1CBPR    A1CBPR           TH Payment Gros
     C                     Z-ADD#1CCPR    A1CCPR           Th Payment Net
     C                     Z-ADD#1LPNB    A1LPNB           TH AP Voucher/D
     C                     Z-ADD#1CDPR    A1CDPR           TH Freight Amou
     C                     Z-ADD#1A7VA    A1A7VA           TH Accrual Amou
     C                     Z-ADD#1A2PR    A1A2PR           TH Fixed Cost A
     C                     MOVEL#1JWST    A1JWST           TH Calc Net Sts
     C                     MOVEL#1CWST    A1CWST           TH Payment Sts
     C                     MOVEL#1D7ST    A1D7ST           TH Header Error
     C                     MOVEL#1D8ST    A1D8ST           TH Detail Error
     C                     MOVEL#1DWST    A1DWST           TH Kill Balanci
     C                     MOVEL#1D6ST    A1D6ST           TH Bal to Kill
     C                     Z-ADD#1GHNB    A1GHNB           TH Commission A
     C                     Z-ADD#1BYDT    A1BYDT           TH Voucher Paym
     C                     MOVEL#1E0ST    A1E0ST           TH User Error O
     C                     MOVEL#1E1ST    A1E1ST           TH Held Over Re
     C                     MOVEL#1E2ST    A1E2ST           TH Sex
     C                     Z-ADD#1BSDT    A1BSDT           TH Held/Ovr Com
     C                     Z-ADD#1BTDT    A1BTDT           TH Commission P
     C                     Z-ADD#1BUDT    A1BUDT           TH Actual Check
     C                     Z-ADD#1HGNB    A1HGNB           TH Shipped Weig
     C                     Z-ADD#1HHNB    A1HHNB           TH Avg Hot Wgt
     C                     Z-ADD#1HINB    A1HINB           TH FFLI
     C                     Z-ADD#1A3PR    A1A3PR           TH Kill Product
     C                     Z-ADD#1A4PR    A1A4PR           TH Cut Product
     C                     Z-ADD#1A6PR    A1A6PR           TH Render Produ
     C                     Z-ADD#1J9NB    A1J9NB           TH Head Exclude
     C                     Z-ADD#1D6PR    A1D6PR           TH CM Bse Mkt L
     C                     Z-ADD#1D7PR    A1D7PR           TH CM Bse Mkt C
     C                     Z-ADD#1D8PR    A1D8PR           TH CM Srt Dsc L
     C                     Z-ADD#1D9PR    A1D9PR           TH CM Srt Dsc C
     C                     Z-ADD#1EAPR    A1EAPR           TH CM Yld G/L L
     C                     Z-ADD#1EBPR    A1EBPR           TH CM Yld G/L C
     C                     Z-ADD#1ECPR    A1ECPR           TH CM Crc Val L
     C                     Z-ADD#1EDPR    A1EDPR           TH CM Crc Val C
     C                     Z-ADD#1EEPR    A1EEPR           TH CM Lean Prem
     C                     Z-ADD#1EFPR    A1EFPR           TH CM Lean Prem
     C                     Z-ADD#1EGPR    A1EGPR           TH CM Gross Liv
     C                     Z-ADD#1EHPR    A1EHPR           TH CM Gross Car
     C                     MOVEL#1KAST    A1KAST           TH Source Type
     C                     MOVEL#1J7ST    A1J7ST           TH Scale Ticket
     C                     MOVEL#1J9ST    A1J9ST           TH Payment Type
     C                     Z-ADD#1OXNB    A1OXNB           TH HPS Movement
     C                     MOVEL#1LKST    A1LKST           TH Source Code
     C                     MOVEL#1LLST    A1LLST           TH Hog Class Ty
     C                     MOVEL#1J8ST    A1J8ST           TH Posted to HP
     C                     MOVEL#1LIST    A1LIST           TH Schedule Kil
     C                     MOVEL#1LJST    A1LJST           TH Shift Held O
     C                     MOVEL#1NZTX    A1NZTX           TH State
     C                     MOVEL#1HJCD    A1HJCD           TH Unused Code
     C                     MOVEL#1R4ST    A1R4ST           TH Unused Sts 2
     C                     MOVEL#1R5ST    A1R5ST           TH Commission S
     C                     MOVEL#1R6ST    A1R6ST           TH Paid 2 Week
     C                     MOVEL#1R7ST    A1R7ST           TH Unused Sts 1
     C                     Z-ADD#1THWT    A1THWT           TH DOA Weight
     C                     Z-ADD#1T2WT    A1T2WT           TH Avg Lean % E
     C                     Z-ADD#1THHD    A1THHD           TH HPS Farm Sit
     C                     Z-ADD#1T2HD    A1T2HD           TH Shift Held O
     C                     Z-ADD#1OBPR    A1OBPR           TH Sorting Amou
     C                     Z-ADD#1KOER    A1KOER           TH Head Identif
     C                     Z-ADD#1OPIR    A1OPIR           TH Percent Iden
     C                     Z-ADD#1OPEM    A1OPEM           TH Percent Acce
     C                     Z-ADD#1IORP    A1IORP           TH Head Adjuste
     C                     Z-ADD#1OWEO    A1OWEO           TH PHA Head Add
     C                     MOVEL#1OQET    A1OQET           TH PHA Add Type
     C                     MOVEL#1URST    A1URST           TH PHA Average
     C                     MOVEL#1USST    A1USST           TH PHA Add Reas
     C                     Z-ADD#1HHPC    A1HHPC           TH PHA Yield Pe
     C                     Z-ADD#1S9PR    A1S9PR           TH PHA Lean Prm
     C                     Z-ADD#1TAPR    A1TAPR           TH VC Gross Val
     C                     Z-ADD#1TBPR    A1TBPR           TH Excluded Gro
     C                     Z-ADD#1JFUR    A1JFUR           TH Avg Lean %
     C                     Z-ADD#1KRIF    A1KRIF           TH Broken Back
     C                     Z-ADD#1KORF    A1KORF           TH Hot Scl Uplo
     C                     Z-ADD#1KAPR    A1KAPR           TH Unused Nbr 4
     C                     Z-ADD#1KROT    A1KROT           TH Excluded Car
     C                     Z-ADD#1OTJG    A1OTJG           TH Excluded Pre
     C                     Z-ADD#1IRJG    A1IRJG           TH Unused Nbr 7
     C                     Z-ADD#1IMJF    A1IMJF           TH Unused Nbr 8
     C                     Z-ADD#1IRGF    A1IRGF           TH Unused Nbr 9
     C                     Z-ADD#1KRJF    A1KRJF           TH Unused Nbr 1
     C                     Z-ADD#1OJRF    A1OJRF           TH Break Even P
     C                     Z-ADD#1KFOR    A1KFOR           TH Meat Value F
     C                     Z-ADD#1ORJK    A1ORJK           TH Yld Parm Adj
     C                     Z-ADD#1OMVJ    A1OMVJ           TH PHA Sort Dis
     C                     Z-ADD#1MVNF    A1MVNF           TH Avg Loin Eye
     C                     Z-ADD#1MCNF    A1MCNF           TH Avg Backfat
     C                     Z-ADD#1NCNF    A1NCNF           TH HITCH Old Pa
     C                     Z-ADD#1NCHF    A1NCHF           TH MPR Sort Los
     C                     Z-ADD#1IGIR    A1IGIR           TH Unused Nbr 1
     C                     Z-ADD#1KFJR    A1KFJR           TH Unused Nbr 2
     C                     Z-ADD#1EADT    A1EADT           TH Cold Scl Upl
     C                     Z-ADD#1EBDT    A1EBDT           TH Cold Scl Upl
     C                     Z-ADD#1ECDT    A1ECDT           TH Head LFT
     C                     Z-ADD#1EDDT    A1EDDT           TH Head EUT/KOA
     C                     Z-ADD#1EEDT    A1EEDT           TH Unused Date
     C                     MOVEL#1U4ST    A1U4ST           TH Unused Sts 1
     C                     MOVEL#1U5ST    A1U5ST           TH Unused Sts 2
     C                     MOVEL#1U6ST    A1U6ST           TH Unused Sts 3
     C                     MOVEL#1U7ST    A1U7ST           TH Unused Sts 4
     C                     MOVEL#1U8ST    A1U8ST           TH Unused Sts 5
     C                     MOVEL#1U9ST    A1U9ST           TH Unused Sts 6
     C                     MOVEL#1VAST    A1VAST           TH Unused Sts 7
     C                     MOVEL#1VBST    A1VBST           TH Unused Sts 8
     C                     MOVEL#1BDCD    A1BDCD           DF Defect Code
     C                     MOVE *BLANK    A1CSCD           THP Process Cod
     C                     MOVEL'RECV'    A1CSCD           THP Process Cod
     C                     MOVELP1ABCD    A1ABCD           PD Producer Cod
     C                     MOVELP1AECD    A1AECD           PL Location Cod
     C                     MOVEL#1ACCD    A1ACCD           HB Buyer Code
     C                     MOVEL#1AGCD    A1AGCD           GN Genetic Code
     C                     MOVEL#1BECD    A1BECD           HC Class Code
     C                     MOVEL#1AAVN    A1AAVN           RS User Changed
     C                     Z-ADD#1AADT    A1AADT           RS Date Changed
     C                     Z-ADD#1AMTM    A1AMTM           RS Time Changed
     C                     MOVEL#1AJST    A1AJST           RS Record Statu
     C                     MOVEL#1AHVN    A1AHVN           RS Job
     C                     MOVEL#1AGVN    A1AGVN           RS Program
     C                     MOVEL#1ABVN    A1ABVN           RS User Added
     C                     Z-ADD#1ABDT    A1ABDT           RS Date Added
     C                     Z-ADD#1ABTM    A1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       A1AJST           RS Record Statu
     C                     MOVEL##USR     A1ABVN           RS User Added
     C                     Z-ADD##JDT     A1ABDT           RS Date Added
     C                     Z-ADD##JTM     A1ABTM           RS Time Added
     C                     MOVEL##PGM     A1AGVN           RS Program
     C                     MOVEL##JOB     A1AHVN           RS Job
     C                     MOVEL'N'       A1E0ST           TH User Error O
      * Chg/Crt Tatto/Spc Flds IF
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Function Description:  If there are any fields that need to be
      * Changed/Created during the Change functions or Create function
      * Presently: Payment Type
      * Add this routine to all of the change objects and create object
      * that update the Payment Type
      * CASE: PAR.TH Payment Sts is Live anything
     C           A1CWST    IFEQ 'ML'                       *IF
     C           A1CWST    OREQ 'PL'
     C           A1CWST    OREQ 'NL'
     C           A1CWST    OREQ 'SL'
     C           A1CWST    OREQ 'IL'
     C                     MOVEL'L'       A1J9ST           TH Payment Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       A1J9ST           TH Payment Type
     C                     END                             *FI
     C           KLCROE    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCROE    SETLL@A1CPC5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0062' W0RTN   7
      * Send message 'Tattoo Header          EX'
     C                     MOVEL'PRK0062' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OEEXIT
     C                     ENDIF
      *
     C                     WRITE@A1CPC5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFRVGN    BEGSR
      *================================================================
      * Upd Shipped Head      RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOF     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSOF     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Shipped Head      CH - Buy Order Load  * 
     C                     EXSR OGCHRC
     C                     ENDIF
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGCHRC    BEGSR
      *================================================================
      * Chg Shipped Head      CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0087  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0088  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0089  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0090  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0091  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0092  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0093  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0094  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0095  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0096  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0097  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0098  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0099  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0100  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0101  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0102  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0103 11        BOL Trailer
     C                     MOVEL*BLANK    WN0104  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0105  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0106  1        BOL Truck Scale
     C                     MOVEL*BLANK    WN0107  1        Reported to USD
     C                     MOVEL*BLANK    WN0108  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0109  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0110  2        BOL Status 5
     C                     MOVEL*BLANK    WN0111  2        BOL Status 6
     C                     MOVEL*BLANK    WN0112  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0113  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0114  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0115  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0116  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0117  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0118 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0119 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0120 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0121 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0122 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0123  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0124  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0125  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0126  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0127  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0128  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0129  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0130  6        PL Location Cod
     C                     MOVEL*BLANK    WN0131 10        RS User Changed
     C                     Z-ADD*ZERO     WN0132  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0133  60       RS Time Changed
     C                     MOVEL*BLANK    WN0134  1        RS Record Statu
     C                     MOVEL*BLANK    WN0135 10        RS Job
     C                     MOVEL*BLANK    WN0136 10        RS Program
     C                     MOVEL*BLANK    WN0137 10        RS User Added
     C                     Z-ADD*ZERO     WN0138  70       RS Date Added
     C                     Z-ADD*ZERO     WN0139  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDP1HMNB    WKHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WKBONB           BOL Load Number
      *
     C           KLCHOG    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHOG    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YIRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADD#DLDSH    WKLDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHRVGN    BEGSR
      *================================================================
      * Rtv Del Tattoo Def - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQOH01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQOH02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQOH03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQOH04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQOH05           TH Kill Date
      * Define keylist
     C           KRSOH     KLIST
     C                     KFLD           WQOH01           BOH Company Num
     C                     KFLD           WQOH02           BOH Buy Order N
     C                     KFLD           WQOH03           BOL Load Number
     C                     KFLD           WQOH04           TH Tattoo Numbe
     C                     KFLD           WQOH05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOH01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOH02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOH03           BOL Load Number
     C                     Z-ADD#1CVNB    WQOH04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQOH05           TH Kill Date
      * Establish starting position
     C           KRSOH     SETLL@DZREX3                    *
     C           KRSOH     READE@DZREX3                  90*
      * Data record not found
     C   90                MOVEL'PRK0738' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Tattoo Defect     DO - Tattoo Defect  * 
     C                     EXSR OIDLRC
     C           KRSOH     READE@DZREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         OIDLRC    BEGSR
      *================================================================
      * Dlt Tattoo Defect     DO - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DZREX2
     C                     Z-ADDDZHMNB    WOHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    WOBONB           BOL Load Number
     C                     Z-ADDDZCVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    WOB0DT           TH Kill Date
     C                     MOVELDZBDCD    WOBDCD           DF Defect Code
      *
     C           KLDLOI    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
     C           KLDLOI    CHAIN@DZREX2              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDZREL0'MDACP
     C                     MOVEL'@DZREX2' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DZREX2                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         OIEXIT    ENDSR
      /EJECT
     CSR         OJCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0140  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGUCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DF1NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OKRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROJ    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROJ    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OJEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OJEXIT    ENDSR
      /EJECT
     CSR         OKRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOK     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOK     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OKEXIT    ENDSR
      /EJECT
     CSR         OLCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0141  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGVCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFWNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OMRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROL    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROL    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OLEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OLEXIT    ENDSR
      /EJECT
     CSR         OMRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOM     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOM     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OMEXIT    ENDSR
      /EJECT
     CSR         ONCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0142  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGWCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFYNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OORVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRON    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRON    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO ONEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         ONEXIT    ENDSR
      /EJECT
     CSR         OORVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOO     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOO     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OOEXIT    ENDSR
      /EJECT
     CSR         OPCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0143  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGXCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFUNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OQRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROP    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROP    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OPEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OPEXIT    ENDSR
      /EJECT
     CSR         OQRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOQ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOQ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OQEXIT    ENDSR
      /EJECT
     CSR         ORCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0144  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGYCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO3NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OSRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROR    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROR    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OREXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OREXIT    ENDSR
      /EJECT
     CSR         OSRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOS     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOS     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OSEXIT    ENDSR
      /EJECT
     CSR         OTCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0145  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGZCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO4NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OURVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROT    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROT    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OTEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OTEXIT    ENDSR
      /EJECT
     CSR         OURVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOU     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOU     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OUEXIT    ENDSR
      /EJECT
     CSR         OVCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0146  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG0CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO5NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OWRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROV    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROV    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OVEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OVEXIT    ENDSR
      /EJECT
     CSR         OWRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOW     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOW     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OWEXIT    ENDSR
      /EJECT
     CSR         OXCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0147  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG1CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFONB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OYRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROX    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROX    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OXEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OXEXIT    ENDSR
      /EJECT
     CSR         OYRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOY     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOY     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OYEXIT    ENDSR
      /EJECT
     CSR         OZCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0148  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG2CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFXNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR PARVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROZ    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROZ    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OZEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OZEXIT    ENDSR
      /EJECT
     CSR         PARVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPA     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSPA     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO PAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         PAEXIT    ENDSR
      /EJECT
     CSR         PBCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0149  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG3CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFTNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR PCRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRPB    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRPB    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PBEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PBEXIT    ENDSR
      /EJECT
     CSR         PCRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPC     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSPC     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO PCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         PCEXIT    ENDSR
      /EJECT
     CSR         PDRVGN    BEGSR
      *================================================================
      * Chg Movement# BOL     RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPD     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSPD     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.BOL HPS Movement Number is Not entered
     C           AXJKRU    IFEQ 0                          *IF
      * Chg Movement# Bol     CO - Buy Order Load  * 
     C                     EXSR PECHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         PDEXIT    ENDSR
      /EJECT
     CSR         PECHRC    BEGSR
      *================================================================
      * Chg Movement# Bol     CO - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0150  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0151  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0152  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0153  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0154  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0155  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0156  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0157  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0158  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0159  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0160  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0161  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0162  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0163  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0164  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0165  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0166 11        BOL Trailer
     C                     MOVEL*BLANK    WN0167  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0168  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0169  1        BOL Truck Scale
     C                     Z-ADD*ZERO     WN0170  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0171  1        Reported to USD
     C                     MOVEL*BLANK    WN0172  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0173  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0174  2        BOL Status 5
     C                     MOVEL*BLANK    WN0175  2        BOL Status 6
     C                     MOVEL*BLANK    WN0176  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0177  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0178  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0179  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0180  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0181 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0182 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0183 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0184 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0185 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0186  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0187  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0188  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0189  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0190  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0191  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0192  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0193  6        PL Location Cod
     C                     MOVEL*BLANK    WN0194 10        RS User Changed
     C                     Z-ADD*ZERO     WN0195  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0196  60       RS Time Changed
     C                     MOVEL*BLANK    WN0197  1        RS Record Statu
     C                     MOVEL*BLANK    WN0198 10        RS Job
     C                     MOVEL*BLANK    WN0199 10        RS Program
     C                     MOVEL*BLANK    WN0200 10        RS User Added
     C                     Z-ADD*ZERO     WN0201  70       RS Date Added
     C                     Z-ADD*ZERO     WN0202  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDAXHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    WKBONB           BOL Load Number
      *
     C           KLCHPE    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHPE    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YJRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADD#1OXNB    WKJKRU           BOL HPS Movemen
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PEEXIT    ENDSR
      /EJECT
     CSR         PFRVGN    BEGSR
      *================================================================
      * Rtv Chg Movemnt/Group RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQPF01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQPF02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQPF03           BOL Load Number
      * Define keylist
     C           KRSPF     KLIST
     C                     KFLD           WQPF01           BOH Company Num
     C                     KFLD           WQPF02           BOH Buy Order N
     C                     KFLD           WQPF03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQPF01           BOH Company Num
     C                     Z-ADDP1BNNB    WQPF02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQPF03           BOL Load Number
      * Establish starting position
     C           KRSPF     SETLL@AFCPI4                    *
     C           KRSPF     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Movement/Group    CH - Delivery Tracking  * 
     C                     EXSR PGCHRC
     C           KRSPF     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         PFEXIT    ENDSR
      /EJECT
     CSR         PGCHRC    BEGSR
      *================================================================
      * Chg Movement/Group    CH - Delivery Tracking  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0203  70       DT Actual Kill
     C                     Z-ADD*ZERO     WN0204  20       DT Actual Deliv
     C                     Z-ADD*ZERO     WN0205  20       DT Scheduled Ho
     C                     MOVEL*BLANK    WN0206  1        DT Delivery Ini
     C                     Z-ADD*ZERO     WN0207  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0208  5        DT Building
     C                     MOVEL*BLANK    WN0209  5        DT Room
     C                     MOVEL*BLANK    WN0210  5        DT Sire Line Co
     C                     Z-ADD*ZERO     WN0211  30       DT Delivered He
     C                     Z-ADD*ZERO     WN0212  71       DT Delivered We
     C                     MOVEL*BLANK    WN0213  5        DT Trucker Code
     C                     MOVEL*BLANK    WN0214  5        DT Driver
     C                     MOVEL*BLANK    WN0215  5        DT Loading Crew
     C                     MOVEL*BLANK    WN0216  6        CHR Code
     C                     MOVEL*BLANK    WN0217  2        DT Load Type
     C                     MOVEL*BLANK    WN0218  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0219 15        DT Truck ID
     C                     MOVEL*BLANK    WN0220 15        DT Trailer ID
     C                     MOVEL*BLANK    WN0221  5        DT Transportati
     C                     Z-ADD*ZERO     WN0222  70       DT Transprtn Of
     C                     Z-ADD*ZERO     WN0223  40       DT Transprtn Of
     C                     Z-ADD*ZERO     WN0224  40       DT Arrive@Frm v
     C                     MOVEL*BLANK    WN0225  1        DT On-Time Farm
     C                     MOVEL*BLANK    WN0226  1        DT Route Start
     C                     Z-ADD*ZERO     WN0227  70       DT Route Start
     C                     Z-ADD*ZERO     WN0228  40       DT Route Start
     C                     Z-ADD*ZERO     WN0229  40       DT Route Start
     C                     Z-ADD*ZERO     WN0230  40       DT Wait @ Trans
     C                     Z-ADD*ZERO     WN0231  70       DT Arrive @ Far
     C                     Z-ADD*ZERO     WN0232  40       DT Arrive @ Far
     C                     Z-ADD*ZERO     WN0233  40       DT Drive Time T
     C                     Z-ADD*ZERO     WN0234  70       DT Start Loadin
     C                     Z-ADD*ZERO     WN0235  40       DT Start Loadin
     C                     Z-ADD*ZERO     WN0236  40       DT Start Loadin
     C                     Z-ADD*ZERO     WN0237  40       DT Wait @ Farm
     C                     Z-ADD*ZERO     WN0238  70       DT Frm End Load
     C                     Z-ADD*ZERO     WN0239  40       DT Frm End Load
     C                     Z-ADD*ZERO     WN0240  40       DT Load Time
     C                     Z-ADD*ZERO     WN0241  70       DT Leave Farm D
     C                     Z-ADD*ZERO     WN0242  40       DT Leave Farm T
     C                     Z-ADD*ZERO     WN0243  40       DT Wait-Depart
     C                     Z-ADD*ZERO     WN0244  70       DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WN0245  40       DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WN0246  70       DT Arrive @ Pla
     C                     Z-ADD*ZERO     WN0247  40       DT Arrive @ Pla
     C                     Z-ADD*ZERO     WN0248  40       DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WN0249  40       DT Drive Time T
     C                     Z-ADD*ZERO     WN0250  40       DT Delv Time Va
     C                     MOVEL*BLANK    WN0251  1        DT On Time Deli
     C                     MOVEL*BLANK    WN0252  6        Delivery Reason
     C                     Z-ADD*ZERO     WN0253  70       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0254  40       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0255  40       DT Wait @ TrkSc
     C                     Z-ADD*ZERO     WN0256  70       DT To Recv Dock
     C                     Z-ADD*ZERO     WN0257  40       DT To Recv Dock
     C                     Z-ADD*ZERO     WN0258  40       DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WN0259  70       DT Start Unload
     C                     Z-ADD*ZERO     WN0260  40       DT Start Unload
     C                     Z-ADD*ZERO     WN0261  40       DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WN0262  70       DT End Unload D
     C                     Z-ADD*ZERO     WN0263  40       DT End Unload T
     C                     Z-ADD*ZERO     WN0264  40       DT Unload Time
     C                     Z-ADD*ZERO     WN0265  40       DT Unload Varia
     C                     Z-ADD*ZERO     WN0266  70       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0267  40       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0268  40       DT Wait Time @
     C                     Z-ADD*ZERO     WN0269  40       DT Formula Wait
     C                     MOVEL*BLANK    WN0270  1        DT Source Type
     C                     MOVEL*BLANK    WN0271  4        DT GATE UPDATE
     C                     Z-ADD*ZERO     WN0272  70       DT Unused Date
     C                     Z-ADD*ZERO     WN0273  40       DT Unused Time
     C                     Z-ADD*ZERO     WN0274  40       DT Unused Wait
     C                     Z-ADD*ZERO     WN0275  30       DSD Scheduled D
     C                     Z-ADD*ZERO     WN0276  50       DT Head Receive
     C                     Z-ADD*ZERO     WN0277  71       DT Weight Recei
     C                     Z-ADD*ZERO     WN0278  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0279  50       DT Head DOA
     C                     Z-ADD*ZERO     WN0280  71       DT Weight DOA
     C                     Z-ADD*ZERO     WN0281  50       DT Head Yard De
     C                     Z-ADD*ZERO     WN0282  71       DT Weight Yard
     C                     Z-ADD*ZERO     WN0283  50       DT Head Condemn
     C                     Z-ADD*ZERO     WN0284  71       DT Weight Conde
     C                     Z-ADD*ZERO     WN0285  50       DT Head Held Ov
     C                     Z-ADD*ZERO     WN0286  71       DT Weight Held
     C                     Z-ADD*ZERO     WN0287  50       DT Head Killed
     C                     Z-ADD*ZERO     WN0288  71       DT Weight Kille
     C                     Z-ADD*ZERO     WN0289  50       DT Head Market
     C                     Z-ADD*ZERO     WN0290  71       DT Weight Marke
     C                     Z-ADD*ZERO     WN0291  51       DT Avg Weight M
     C                     Z-ADD*ZERO     WN0292  50       DT Head Resale
     C                     Z-ADD*ZERO     WN0293  71       DT Weight Resal
     C                     Z-ADD*ZERO     WN0294  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0295  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0296  71       DT Weight Unuse
     C                     Z-ADD*ZERO     WN0297  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0298  71       DT Weight Unuse
     C                     MOVEL*BLANK    WN0299  1        DT Error Sts
     C                     MOVEL*BLANK    WN0300  2        DT Error Reason
     C                     MOVEL*BLANK    WN0301  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0302  6        PL Location Cod
     C                     MOVEL*BLANK    WN0303  3        SR Source Code
     C                     Z-ADD*ZERO     WN0304  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0305  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0306  50       BOL Load Number
     C                     MOVEL*BLANK    WN0307 10        RS User Changed
     C                     Z-ADD*ZERO     WN0308  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0309  60       RS Time Changed
     C                     MOVEL*BLANK    WN0310  1        RS Record Statu
     C                     MOVEL*BLANK    WN0311 10        RS Job
     C                     MOVEL*BLANK    WN0312 10        RS Program
     C                     MOVEL*BLANK    WN0313 10        RS User Added
     C                     Z-ADD*ZERO     WN0314  70       RS Date Added
     C                     Z-ADD*ZERO     WN0315  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @AFCPIC
     C                     Z-ADDAFHONB    WRHONB           CC Company Numb
     C                     Z-ADDAFE0DT    WRE0DT           DSH Kill Date
     C                     Z-ADDAFE9DT    WRE9DT           DT Delivery Dat
     C                     Z-ADDAFAJTH    WRAJTH           DT Delivery Tim
     C                     Z-ADDAFH4A1    WRH4A1           DT Delivery Tim
      *
     C           KLCHPG    KLIST
     C                     KFLD           WRHONB           CC Company Numb
     C                     KFLD           WRE0DT           DSH Kill Date
     C                     KFLD           WRE9DT           DT Delivery Dat
     C                     KFLD           WRAJTH           DT Delivery Tim
     C                     KFLD           WRH4A1           DT Delivery Tim
     C           KLCHPG    CHAIN@AFCPIC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAFCPL0'MDACP
     C                     MOVEL'@AFCPIC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAF1    YKRDCS
      * Move non-key fields to @AFCPIC
     C                     MOVEL#1BICD    WRLGCD    P      DT Hog Group Re
     C                     Z-ADD#1OXNB    WRIEA1           DT Movement Num
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAF1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WRAAVN           RS User Changed
     C                     Z-ADD##JDT     WRAADT           RS Date Changed
     C                     Z-ADD##JTM     WRAMTM           RS Time Changed
     C                     MOVEL##JOB     WRAHVN           RS Job
     C                     MOVEL##PGM     WRAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAF1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@AFCPIC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PGEXIT    ENDSR
      /EJECT
     CSR         PHCRRC    BEGSR
      *================================================================
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0316 10        RS User Changed
     C                     Z-ADD*ZERO     WN0317  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0318  60       RS Time Changed
     C                     MOVEL*BLANK    WN0319  1        RS Record Statu
     C                     MOVEL*BLANK    WN0320 10        RS Job
     C                     MOVEL*BLANK    WN0321 10        RS Program
     C                     MOVEL*BLANK    WN0322 10        RS User Added
     C                     Z-ADD*ZERO     WN0323  70       RS Date Added
     C                     Z-ADD*ZERO     WN0324  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DNCPUX
     C                     Z-ADDP1HMNB    WSHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WSBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WSB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WSI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WSJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WSI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WSI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WSI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WSI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WSJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WSJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WSJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WSJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WSJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WSJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WSJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WSJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WSJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WSJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WSJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WSJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WSLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WSHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WSLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WSH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WSGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WSH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WSGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WSH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WSHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WSHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WSHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WSHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WSHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WSHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WSHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WSHFLP           TH Head GT Lean
     C                     Z-ADDYL0017    WSSNA1           TE Unused Numbe
     C                     Z-ADDYL0018    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDYL0019    WSSPA1           TE Unused Numbe
     C                     MOVELYL0020    WSDGSS           TE Unused Statu
     C                     MOVELYL0021    WSDHSS           TE Unused Statu
     C                     MOVELYL0022    WSDISS           TE Unused Statu
     C                     MOVELP1ABCD    WSABCD           PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD           PS Site ID
     C                     MOVEL#DOVCD    WSOVCD           Producer Subsid
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WSAJST           RS Record Statu
     C                     MOVEL##USR     WSABVN           RS User Added
     C                     Z-ADD##JDT     WSABDT           RS Date Added
     C                     Z-ADD##JTM     WSABTM           RS Time Added
     C                     MOVEL##PGM     WSAGVN           RS Program
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL*BLANK    WSAAVN           RS User Changed
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C           KLCRPH    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRPH    SETLL@DNCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0638' W0RTN   7
      * Send message 'Tattoo Header EXT      EX'
     C                     MOVEL'PRK0638' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PHEXIT
     C                     ENDIF
      *
     C                     WRITE@DNCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PHEXIT    ENDSR
      /EJECT
     CSR         PIRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg hd, pen  RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPI     KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2BNNB           BOH Buy Order N
     C                     KFLD           A2BONB           BOL Load Number
     C                     KFLD           A2CVNB           TH Tattoo Numbe
     C                     KFLD           A2B0DT           TH Kill Date
     C                     KFLD           A2C2NB           TD Sequence Num
      * Setup key
     C                     Z-ADDP1HMNB    A2HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    A2BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    A2BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A2CVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    A2B0DT           TH Kill Date
     C                     Z-ADD1         A2C2NB           TD Sequence Num
      * Establish starting position
     C           KRSPI     CHAIN@A2CPDG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Tattoo Dtl Rsl    XF - Tattoo Detail  * 
     C                     CALL 'PKMMXFR'              90  Crt Tattoo Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0251  30       BOH Company Num
     C                     PARM P1BNNB    WQ0252  70       BOH Buy Order N
     C                     PARM P1BONB    WQ0253  50       BOL Load Number
     C                     PARM P1B0DT    WQ0254  70       TH Kill Date
     C                     PARM *ZERO     WQ0255  51       TD Avg Live Wgt
     C                     PARM *BLANK    WQ0256  1        TD Gen Bal To K
     C                     PARM 'N'       WQ0257  1        TD Recs Created
     C                     PARM 'N'       WQ0258  1        TD User Status
     C                     PARM 'N'       WQ0259  1        TD User Status
     C                     PARM *ZERO     WQ0260  70       TD User Date 1
     C                     PARM *ZERO     WQ0261  70       TD User Date 2
     C                     PARM *ZERO     WQ0262  70       TD Drive Date
     C                     PARM P1HMNB    WQ0263  30       Pen Company Num
     C                     PARM #DCMCD    WQ0264  3        Pen Number
     C                     PARM #1CVNB    WQ0265  50       Tattoo Number N
     C                     PARM *ZERO     WQ0266  71       Live Wgt Tot US
     C                     PARM #DB5NB    WQ0267  70       Head Total USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     GOTO PIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Tattoo Detail     CH - Tattoo Detail  * 
     C                     EXSR PJCHRC
     C                     ENDIF
      *================================================================
     CSR         PIEXIT    ENDSR
      /EJECT
     CSR         PJCHRC    BEGSR
      *================================================================
      * Chg Tattoo Detail     CH - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @A2CPDF
     C                     Z-ADDA2HMNB    WTHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    WTBNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    WTBONB           BOL Load Number
     C                     Z-ADDA2CVNB    WTCVNB           TH Tattoo Numbe
     C                     Z-ADDA2B0DT    WTB0DT           TH Kill Date
     C                     Z-ADDA2C2NB    WTC2NB           TD Sequence Num
      *
     C           KLCHPJ    KLIST
     C                     KFLD           WTHMNB           BOH Company Num
     C                     KFLD           WTBNNB           BOH Buy Order N
     C                     KFLD           WTBONB           BOL Load Number
     C                     KFLD           WTCVNB           TH Tattoo Numbe
     C                     KFLD           WTB0DT           TH Kill Date
     C                     KFLD           WTC2NB           TD Sequence Num
     C           KLCHPJ    CHAIN@A2CPDF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA2CPL0'MDACP
     C                     MOVEL'@A2CPDF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA21    YLRDCS
      * Move non-key fields to @A2CPDF
     C                     Z-ADDA2CZNB    WTCZNB           TD Live Wgt
     C                     Z-ADD#DB5NB    WTC0NB           TD Pen Head
     C                     Z-ADDA2D8NB    WTD8NB           TD Yard Dead
     C                     Z-ADDA2H7NB    WTH7NB           TD Held Over
     C                     MOVELA2GGST    WTGGST    P      TD Held Over St
     C                     Z-ADDA2AJTM    WTAJTM           TD Drive Time
     C                     Z-ADDA2JEA1    WTJEA1           TD Drive Hour
     C                     Z-ADDA2B7CD    WTB7CD           TD Drive Card N
     C                     Z-ADDA2D7NB    WTD7NB           TD Avg Live Wgt
     C                     MOVELA2D9ST    WTD9ST    P      TD Gen Bal To K
     C                     MOVELA2E3ST    WTE3ST    P      TD Recs Created
     C                     MOVELA2E4ST    WTE4ST    P      TD User Status
     C                     MOVELA2E5ST    WTE5ST    P      TD User Status
     C                     Z-ADDA2BVDT    WTBVDT           TD User Date 1
     C                     Z-ADDA2BWDT    WTBWDT           TD User Date 2
     C                     Z-ADDA2BXDT    WTBXDT           TD Drive Date
     C                     Z-ADDA2HVNB    WTHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WTCMCD    P      Pen Number
     C                     MOVELA2B9CD    WTB9CD    P      TDP Process Cod
     C                     Z-ADDA2H8NB    WTH8NB           Held Over Pen C
     C                     MOVELA2CYCD    WTCYCD    P      Held Over Pen N
     C                     MOVELA2AAVN    WTAAVN    P      RS User Changed
     C                     Z-ADDA2AADT    WTAADT           RS Date Changed
     C                     Z-ADDA2AMTM    WTAMTM           RS Time Changed
     C                     MOVELA2AJST    WTAJST    P      RS Record Statu
     C                     MOVELA2AHVN    WTAHVN    P      RS Job
     C                     MOVELA2AGVN    WTAGVN    P      RS Program
     C                     MOVELA2ABVN    WTABVN    P      RS User Added
     C                     Z-ADDA2ABDT    WTABDT           RS Date Added
     C                     Z-ADDA2ABTM    WTABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WTAAVN           RS User Changed
     C                     Z-ADD##JDT     WTAADT           RS Date Changed
     C                     Z-ADD##JTM     WTAMTM           RS Time Changed
     C                     MOVEL##JOB     WTAHVN           RS Job
     C                     MOVEL##PGM     WTAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@A2CPDF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PJEXIT    ENDSR
      /EJECT
     CSR         PKRVGN    BEGSR
      *================================================================
      * Rtv/Chg Bol Hd rcvd   RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPK     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSPK     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           AXDHNB    ADD  WUZYNB    WUDHNB           BOL Head Receiv
     C                     ADD  AXDINB    WUDINB           BOL Live Wgt Re
      * Calculate freight based on the unit of measure
     C                     Z-ADDAXATVA    WUATVA           BOL Freight Amt
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
     C                     EXSR PLRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.BOL Freight Allocation is Freight is Allocated
      *   |- c2    : WRK.Tattoo is paid Usr is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           AXI1ST    IFEQ 'Y'                        *IF
     C           WUNPST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: DB1.BOL Trucker Payment Sts is Paid Trucker
     C           AXCNST    IFEQ 'PT'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc Freight Amt       XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ5XFR'              90  Clc Freight Amt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM AXHMNB    WQ0268  30       BOH Company Num
     C                     PARM AXBNNB    WQ0269  70       BOH Buy Order N
     C                     PARM AXBONB    WQ0270  50       BOL Load Number
     C                     PARM AXCMST    WQ0271  2        BOL Freight UOM
     C                     PARM AXAGPR    WQ0272  72       BOL Freight Uni
     C           WUATVA    PARM WUATVA    WQ0273  72       BOL Freight Amt
     C                     PARM AXI1ST    WQ0274  1        BOL Freight All
     C                     PARM WUDHNB    WQ0275  70       BOL Head Receiv
     C                     PARM WUDINB    WQ0276  71       BOL Live Wgt Re
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : WRK.BOL Freight Amt is Not Zeros
      *   |- c2    : WRK.BOL Head Received is Greater then Zero
      *   |- c3    : DB1.BOL Trucker Payment Sts is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUATVA    IFNE 0                          *IF
     C           WUDHNB    IFGT 0                          *IF
     C           AXCNST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ST'      WUCNST           BOL Trucker Pay
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELAXCNST    WUCNST           BOL Trucker Pay
     C                     END                             *FI
      * Chg Buy Order Detail  CH - Buy Order Load  * 
     C                     EXSR PMCHRC
     C                     ENDIF
      *================================================================
     CSR         PKEXIT    ENDSR
      /EJECT
     CSR         PLRVGN    BEGSR
      *================================================================
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUK4PR           Tot Frt Spdb af
     C                     MOVEL'N'       WUNFST           Held Over Recor
     C                     MOVEL'N'       WUNPST           Tattoo is paid
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQPL01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQPL02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQPL03           BOL Load Number
      * Define keylist
     C           KRSPL     KLIST
     C                     KFLD           WQPL01           BOH Company Num
     C                     KFLD           WQPL02           BOH Buy Order N
     C                     KFLD           WQPL03           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    WQPL01           BOH Company Num
     C                     Z-ADDAXBNNB    WQPL02           BOH Buy Order N
     C                     Z-ADDAXBONB    WQPL03           BOL Load Number
      * Establish starting position
     C           KRSPL     SETLL@A1CPC4                    *
     C           KRSPL     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If one tattoo is paid but freight was spread then accumulate
      * what is paid, for held over respread problem
      * when this probelm goes away, then just flag that there is one pai
      * CASE: DB1.TH Payment Sts is Paid Anything
     C           A1CWST    IFEQ 'PL'                       *IF
     C           A1CWST    OREQ 'PC'
     C           A1CWST    OREQ 'NC'
     C           A1CWST    OREQ 'NL'
      * CHECK IF FREIGHT AMOUNT IS IN RECORD
      * CASE: DB1.TH Freight Amount is Not Zeros
     C           A1CDPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUNPST           Tattoo is paid
     C                     END                             *FI
     C                     ADD  A1CDPR    WUK4PR           Tot Frt Spdb af
     C                     ELSE
      * CASE: *OTHERWISE
      * CHECK FOR HELD OVER RECORD
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TH Held Over Record is Yes
      *   |- c2    : DB1.TH Held Over is greater than 0
      *   '-
     C           A1E1ST    IFEQ 'Y'                        *IF
     C           A1H9NB    ORGT 0                          *OR
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C           KRSPL     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         PLEXIT    ENDSR
      /EJECT
     CSR         PMCHRC    BEGSR
      *================================================================
      * Chg Buy Order Detail  CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0325  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0326  1        Reported to USD
     C                     MOVEL*BLANK    WN0327  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0328  2        BOL Status 5
     C                     MOVEL*BLANK    WN0329  2        BOL Status 6
     C                     MOVEL*BLANK    WN0330  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0331  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0332  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0333  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0334  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0335  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0336 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0337 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0338 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0339 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0340 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0341  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0342  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0343  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0344  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0345  70       BOL Unused Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDAXHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    WKBONB           BOL Load Number
      *
     C           KLCHPM    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHPM    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YMRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADDAXCQDT    WKCQDT           BOL Kill Date
     C                     Z-ADDAXABTH    WKABTH           BOL Pln Delv St
     C                     Z-ADDAXACTH    WKACTH           BOL Pln Delv En
     C                     Z-ADDAXBPNB    WKBPNB           BOL Pln Head De
     C                     Z-ADDAXCSNB    WKCSNB           BOL Shipped Wgt
     C                     Z-ADDAXAUDT    WKAUDT           BOL Pln Delv Da
     C                     MOVELAXCMST    WKCMST    P      BOL Freight UOM
     C                     Z-ADDAXAGPR    WKAGPR           BOL Freight Uni
     C                     Z-ADDWUATVA    WKATVA           BOL Freight Amt
     C                     MOVELAXI1ST    WKI1ST    P      BOL Freight All
     C                     Z-ADDWUDHNB    WKDHNB           BOL Head Receiv
     C                     Z-ADDWUDINB    WKDINB           BOL Live Wgt Re
     C                     MOVELWUCNST    WKCNST    P      BOL Trucker Pay
     C                     Z-ADDAXGINB    WKGINB           BOL Trucker Che
     C                     Z-ADDAXBZDT    WKBZDT           BOL Trucker Che
     C                     Z-ADDAXLSNB    WKLSNB           BOL AP Voucher
     C                     MOVELAXF3TX    WKF3TX    P      BOL Trailer
     C                     MOVELAXO8ST    WKO8ST    P      BOL Freight Exp
     C                     MOVELAXO9ST    WKO9ST    P      BOL Scheduled K
     C                     MOVELAXPAST    WKPAST    P      BOL Truck Scale
     C                     MOVELAXPDST    WKPDST    P      BOL Violated Au
     C                     MOVELAXBNCD    WKBNCD    P      TRK Trucker Cod
     C                     MOVELAXABCD    WKABCD    P      PD Producer Cod
     C                     MOVELAXAECD    WKAECD    P      PL Location Cod
     C                     MOVELAXAAVN    WKAAVN    P      RS User Changed
     C                     Z-ADDAXAADT    WKAADT           RS Date Changed
     C                     Z-ADDAXAMTM    WKAMTM           RS Time Changed
     C                     MOVELAXAJST    WKAJST    P      RS Record Statu
     C                     MOVELAXAHVN    WKAHVN    P      RS Job
     C                     MOVELAXAGVN    WKAGVN    P      RS Program
     C                     MOVELAXABVN    WKABVN    P      RS User Added
     C                     Z-ADDAXABDT    WKABDT           RS Date Added
     C                     Z-ADDAXABTM    WKABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PMEXIT    ENDSR
      /EJECT
     CSR         PNRVGN    BEGSR
      *================================================================
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Set Pen Totals to Zeros - Pen  * 
     C                     EXSR PORVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQPN01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQPN02           Pen Number
      * Define keylist
     C           KRSPN     KLIST
     C                     KFLD           WQPN01           BOH Company Num
     C                     KFLD           WQPN02           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WQPN01           BOH Company Num
     C                     MOVEL#DCMCD    WQPN02           Pen Number
      * Establish starting position
     C           KRSPN     SETLL@A2CPKE                    *
     C           KRSPN     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR PQCHRC
     C                     GOTO PNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Totals    RT - Pen  * 
     C                     EXSR PRRVGN
     C           KRSPN     READE@A2CPKE                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR PTRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR PWCHRC
      *================================================================
     CSR         PNEXIT    ENDSR
      /EJECT
     CSR         PORVGN    BEGSR
      *================================================================
      * Set Pen Totals to Zeros - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPO     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WIHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSPO     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pen               CH - Pen  * 
     C                     EXSR PPCHRC
     C                     ENDIF
      *================================================================
     CSR         POEXIT    ENDSR
      /EJECT
     CSR         PPCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHPP    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHPP    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YNRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUCRTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWUCRTX    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PPEXIT    ENDSR
      /EJECT
     CSR         PQCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0346  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0347  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0348  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0349  1        Pen Sts
     C                     Z-ADD*ZERO     WN0350  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0351  1        Pen Type
     C                     Z-ADD*ZERO     WN0352  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0353 10        RS User Changed
     C                     Z-ADD*ZERO     WN0354  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0355  60       RS Time Changed
     C                     MOVEL*BLANK    WN0356  1        RS Record Statu
     C                     MOVEL*BLANK    WN0357 10        RS Job
     C                     MOVEL*BLANK    WN0358 10        RS Program
     C                     MOVEL*BLANK    WN0359 10        RS User Added
     C                     Z-ADD*ZERO     WN0360  70       RS Date Added
     C                     Z-ADD*ZERO     WN0361  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHPQ    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHPQ    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YORDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PQEXIT    ENDSR
      /EJECT
     CSR         PRRVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Totals    RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPR     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WIHVNB           Pen Company Num
     C                     MOVELWHCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSPR     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHC0NB    ADD  WID6NB    WUD6NB           Pen Current Hea
     C                     SUB  WHD8NB    WUD6NB           Pen Current Hea
      * Chg Pen               CH - Pen  * 
     C                     EXSR PSCHRC
     C                     ENDIF
      *================================================================
     CSR         PREXIT    ENDSR
      /EJECT
     CSR         PSCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHPS    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHPS    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YPRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWIBBTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADDWUD6NB    WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWIAGCD    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PSEXIT    ENDSR
      /EJECT
     CSR         PTRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQPT01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQPT02           Pen Number
      * Define keylist
     C           KRSPT     KLIST
     C                     KFLD           WQPT01           BOH Company Num
     C                     KFLD           WQPT02           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WQPT01           BOH Company Num
     C                     MOVELWHCMCD    WQPT02           Pen Number
      * Establish starting position
     C           KRSPT     SETLL@A2CPKE                    *
     C           KRSPT     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO PTEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WHB9CD    IFEQ 'D'                        *IF
     C           WHB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR PURVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSPT     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         PTEXIT    ENDSR
      /EJECT
     CSR         PURVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQPU01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQPU02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQPU03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQPU04           TH Tattoo Numbe
      * Define keylist
     C           KRSPU     KLIST
     C                     KFLD           WQPU01           BOH Company Num
     C                     KFLD           WQPU02           BOH Buy Order N
     C                     KFLD           WQPU03           BOL Load Number
     C                     KFLD           WQPU04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWHHMNB    WQPU01           BOH Company Num
     C                     Z-ADDWHBNNB    WQPU02           BOH Buy Order N
     C                     Z-ADDWHBONB    WQPU03           BOL Load Number
     C                     Z-ADDWHCVNB    WQPU04           TH Tattoo Numbe
      * Establish starting position
     C           KRSPU     SETLL@A1CPC4                    *
     C           KRSPU     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO PUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELA1AGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR PVRVGN
     C           KRSPU     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         PUEXIT    ENDSR
      /EJECT
     CSR         PVRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPV     KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVELA1AGCD    AIAGCD           GN Genetic Code
      * Establish starting position
     C           KRSPV     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO PVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         PVEXIT    ENDSR
      /EJECT
     CSR         PWCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0362  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0363  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0364  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0365  1        Pen Sts
     C                     Z-ADD*ZERO     WN0366  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0367  1        Pen Type
     C                     Z-ADD*ZERO     WN0368  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0369 10        RS User Changed
     C                     Z-ADD*ZERO     WN0370  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0371  60       RS Time Changed
     C                     MOVEL*BLANK    WN0372  1        RS Record Statu
     C                     MOVEL*BLANK    WN0373 10        RS Job
     C                     MOVEL*BLANK    WN0374 10        RS Program
     C                     MOVEL*BLANK    WN0375 10        RS User Added
     C                     Z-ADD*ZERO     WN0376  70       RS Date Added
     C                     Z-ADD*ZERO     WN0377  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHPW    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHPW    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YQRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PWEXIT    ENDSR
      /EJECT
     CSR         PXRVGN    BEGSR
      *================================================================
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Set Pen Totals to Zeros - Pen  * 
     C                     EXSR PYRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQPX01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQPX02           Pen Number
      * Define keylist
     C           KRSPX     KLIST
     C                     KFLD           WQPX01           BOH Company Num
     C                     KFLD           WQPX02           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WQPX01           BOH Company Num
     C                     MOVELWUCBCD    WQPX02           Pen Number
      * Establish starting position
     C           KRSPX     SETLL@A2CPKE                    *
     C           KRSPX     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR QACHRC
     C                     GOTO PXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Totals    RT - Pen  * 
     C                     EXSR QBRVGN
     C           KRSPX     READE@A2CPKE                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR QDRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR QGCHRC
      *================================================================
     CSR         PXEXIT    ENDSR
      /EJECT
     CSR         PYRVGN    BEGSR
      *================================================================
      * Set Pen Totals to Zeros - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPY     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WIHVNB           Pen Company Num
     C                     MOVELWUCBCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSPY     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pen               CH - Pen  * 
     C                     EXSR PZCHRC
     C                     ENDIF
      *================================================================
     CSR         PYEXIT    ENDSR
      /EJECT
     CSR         PZCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YRRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHPZ    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHPZ    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YRRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUCRTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWUCRTX    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YRRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PZEXIT    ENDSR
      /EJECT
     CSR         QACHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0378  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0379  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0380  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0381  1        Pen Sts
     C                     Z-ADD*ZERO     WN0382  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0383  1        Pen Type
     C                     Z-ADD*ZERO     WN0384  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0385 10        RS User Changed
     C                     Z-ADD*ZERO     WN0386  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0387  60       RS Time Changed
     C                     MOVEL*BLANK    WN0388  1        RS Record Statu
     C                     MOVEL*BLANK    WN0389 10        RS Job
     C                     MOVEL*BLANK    WN0390 10        RS Program
     C                     MOVEL*BLANK    WN0391 10        RS User Added
     C                     Z-ADD*ZERO     WN0392  70       RS Date Added
     C                     Z-ADD*ZERO     WN0393  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YSRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVELWUCBCD    WJCMCD    P      Pen Number
      *
     C           KLCHQA    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHQA    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL020.
     C                     MOVEL'LBL020'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YSRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YSRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QAEXIT    ENDSR
      /EJECT
     CSR         QBRVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Totals    RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQB     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WIHVNB           Pen Company Num
     C                     MOVELWHCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSQB     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHC0NB    ADD  WID6NB    WUD6NB           Pen Current Hea
     C                     SUB  WHD8NB    WUD6NB           Pen Current Hea
      * Chg Pen               CH - Pen  * 
     C                     EXSR QCCHRC
     C                     ENDIF
      *================================================================
     CSR         QBEXIT    ENDSR
      /EJECT
     CSR         QCCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YTRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHQC    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHQC    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL021.
     C                     MOVEL'LBL021'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YTRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWIBBTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADDWUD6NB    WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWIAGCD    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YTRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QCEXIT    ENDSR
      /EJECT
     CSR         QDRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQQD01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQQD02           Pen Number
      * Define keylist
     C           KRSQD     KLIST
     C                     KFLD           WQQD01           BOH Company Num
     C                     KFLD           WQQD02           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WQQD01           BOH Company Num
     C                     MOVELWHCMCD    WQQD02           Pen Number
      * Establish starting position
     C           KRSQD     SETLL@A2CPKE                    *
     C           KRSQD     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO QDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WHB9CD    IFEQ 'D'                        *IF
     C           WHB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR QERVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSQD     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         QDEXIT    ENDSR
      /EJECT
     CSR         QERVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQQE01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQQE02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQQE03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQQE04           TH Tattoo Numbe
      * Define keylist
     C           KRSQE     KLIST
     C                     KFLD           WQQE01           BOH Company Num
     C                     KFLD           WQQE02           BOH Buy Order N
     C                     KFLD           WQQE03           BOL Load Number
     C                     KFLD           WQQE04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWHHMNB    WQQE01           BOH Company Num
     C                     Z-ADDWHBNNB    WQQE02           BOH Buy Order N
     C                     Z-ADDWHBONB    WQQE03           BOL Load Number
     C                     Z-ADDWHCVNB    WQQE04           TH Tattoo Numbe
      * Establish starting position
     C           KRSQE     SETLL@A1CPC4                    *
     C           KRSQE     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO QEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELA1AGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR QFRVGN
     C           KRSQE     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         QEEXIT    ENDSR
      /EJECT
     CSR         QFRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQF     KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVELA1AGCD    AIAGCD           GN Genetic Code
      * Establish starting position
     C           KRSQF     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO QFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         QFEXIT    ENDSR
      /EJECT
     CSR         QGCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0394  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0395  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0396  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0397  1        Pen Sts
     C                     Z-ADD*ZERO     WN0398  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0399  1        Pen Type
     C                     Z-ADD*ZERO     WN0400  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0401 10        RS User Changed
     C                     Z-ADD*ZERO     WN0402  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0403  60       RS Time Changed
     C                     MOVEL*BLANK    WN0404  1        RS Record Statu
     C                     MOVEL*BLANK    WN0405 10        RS Job
     C                     MOVEL*BLANK    WN0406 10        RS Program
     C                     MOVEL*BLANK    WN0407 10        RS User Added
     C                     Z-ADD*ZERO     WN0408  70       RS Date Added
     C                     Z-ADD*ZERO     WN0409  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YURDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVELWUCBCD    WJCMCD    P      Pen Number
      *
     C           KLCHQG    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHQG    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL022.
     C                     MOVEL'LBL022'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YURDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YURDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QGEXIT    ENDSR
      /EJECT
     CSR         QHRVGN    BEGSR
      *================================================================
      * Rtv Chg Movemnt/Group RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQQH01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQQH02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQQH03           BOL Load Number
      * Define keylist
     C           KRSQH     KLIST
     C                     KFLD           WQQH01           BOH Company Num
     C                     KFLD           WQQH02           BOH Buy Order N
     C                     KFLD           WQQH03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQQH01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQH02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQH03           BOL Load Number
      * Establish starting position
     C           KRSQH     SETLL@AFCPI4                    *
     C           KRSQH     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Movement/Group    CH - Delivery Tracking  * 
     C                     EXSR QICHRC
     C           KRSQH     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         QHEXIT    ENDSR
      /EJECT
     CSR         QICHRC    BEGSR
      *================================================================
      * Chg Movement/Group    CH - Delivery Tracking  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0410  70       DT Actual Kill
     C                     Z-ADD*ZERO     WN0411  20       DT Actual Deliv
     C                     Z-ADD*ZERO     WN0412  20       DT Scheduled Ho
     C                     MOVEL*BLANK    WN0413  1        DT Delivery Ini
     C                     Z-ADD*ZERO     WN0414  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0415  5        DT Building
     C                     MOVEL*BLANK    WN0416  5        DT Room
     C                     MOVEL*BLANK    WN0417  5        DT Sire Line Co
     C                     Z-ADD*ZERO     WN0418  30       DT Delivered He
     C                     Z-ADD*ZERO     WN0419  71       DT Delivered We
     C                     MOVEL*BLANK    WN0420  5        DT Trucker Code
     C                     MOVEL*BLANK    WN0421  5        DT Driver
     C                     MOVEL*BLANK    WN0422  5        DT Loading Crew
     C                     MOVEL*BLANK    WN0423  6        CHR Code
     C                     MOVEL*BLANK    WN0424  2        DT Load Type
     C                     MOVEL*BLANK    WN0425  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0426 15        DT Truck ID
     C                     MOVEL*BLANK    WN0427 15        DT Trailer ID
     C                     MOVEL*BLANK    WN0428  5        DT Transportati
     C                     Z-ADD*ZERO     WN0429  70       DT Transprtn Of
     C                     Z-ADD*ZERO     WN0430  40       DT Transprtn Of
     C                     Z-ADD*ZERO     WN0431  40       DT Arrive@Frm v
     C                     MOVEL*BLANK    WN0432  1        DT On-Time Farm
     C                     MOVEL*BLANK    WN0433  1        DT Route Start
     C                     Z-ADD*ZERO     WN0434  70       DT Route Start
     C                     Z-ADD*ZERO     WN0435  40       DT Route Start
     C                     Z-ADD*ZERO     WN0436  40       DT Route Start
     C                     Z-ADD*ZERO     WN0437  40       DT Wait @ Trans
     C                     Z-ADD*ZERO     WN0438  70       DT Arrive @ Far
     C                     Z-ADD*ZERO     WN0439  40       DT Arrive @ Far
     C                     Z-ADD*ZERO     WN0440  40       DT Drive Time T
     C                     Z-ADD*ZERO     WN0441  70       DT Start Loadin
     C                     Z-ADD*ZERO     WN0442  40       DT Start Loadin
     C                     Z-ADD*ZERO     WN0443  40       DT Start Loadin
     C                     Z-ADD*ZERO     WN0444  40       DT Wait @ Farm
     C                     Z-ADD*ZERO     WN0445  70       DT Frm End Load
     C                     Z-ADD*ZERO     WN0446  40       DT Frm End Load
     C                     Z-ADD*ZERO     WN0447  40       DT Load Time
     C                     Z-ADD*ZERO     WN0448  70       DT Leave Farm D
     C                     Z-ADD*ZERO     WN0449  40       DT Leave Farm T
     C                     Z-ADD*ZERO     WN0450  40       DT Wait-Depart
     C                     Z-ADD*ZERO     WN0451  70       DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WN0452  40       DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WN0453  70       DT Arrive @ Pla
     C                     Z-ADD*ZERO     WN0454  40       DT Arrive @ Pla
     C                     Z-ADD*ZERO     WN0455  40       DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WN0456  40       DT Drive Time T
     C                     Z-ADD*ZERO     WN0457  40       DT Delv Time Va
     C                     MOVEL*BLANK    WN0458  1        DT On Time Deli
     C                     MOVEL*BLANK    WN0459  6        Delivery Reason
     C                     Z-ADD*ZERO     WN0460  70       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0461  40       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0462  40       DT Wait @ TrkSc
     C                     Z-ADD*ZERO     WN0463  70       DT To Recv Dock
     C                     Z-ADD*ZERO     WN0464  40       DT To Recv Dock
     C                     Z-ADD*ZERO     WN0465  40       DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WN0466  70       DT Start Unload
     C                     Z-ADD*ZERO     WN0467  40       DT Start Unload
     C                     Z-ADD*ZERO     WN0468  40       DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WN0469  70       DT End Unload D
     C                     Z-ADD*ZERO     WN0470  40       DT End Unload T
     C                     Z-ADD*ZERO     WN0471  40       DT Unload Time
     C                     Z-ADD*ZERO     WN0472  40       DT Unload Varia
     C                     Z-ADD*ZERO     WN0473  70       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0474  40       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0475  40       DT Wait Time @
     C                     Z-ADD*ZERO     WN0476  40       DT Formula Wait
     C                     MOVEL*BLANK    WN0477  1        DT Source Type
     C                     MOVEL*BLANK    WN0478  4        DT GATE UPDATE
     C                     Z-ADD*ZERO     WN0479  70       DT Unused Date
     C                     Z-ADD*ZERO     WN0480  40       DT Unused Time
     C                     Z-ADD*ZERO     WN0481  40       DT Unused Wait
     C                     Z-ADD*ZERO     WN0482  30       DSD Scheduled D
     C                     Z-ADD*ZERO     WN0483  50       DT Head Receive
     C                     Z-ADD*ZERO     WN0484  71       DT Weight Recei
     C                     Z-ADD*ZERO     WN0485  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0486  50       DT Head DOA
     C                     Z-ADD*ZERO     WN0487  71       DT Weight DOA
     C                     Z-ADD*ZERO     WN0488  50       DT Head Yard De
     C                     Z-ADD*ZERO     WN0489  71       DT Weight Yard
     C                     Z-ADD*ZERO     WN0490  50       DT Head Condemn
     C                     Z-ADD*ZERO     WN0491  71       DT Weight Conde
     C                     Z-ADD*ZERO     WN0492  50       DT Head Held Ov
     C                     Z-ADD*ZERO     WN0493  71       DT Weight Held
     C                     Z-ADD*ZERO     WN0494  50       DT Head Killed
     C                     Z-ADD*ZERO     WN0495  71       DT Weight Kille
     C                     Z-ADD*ZERO     WN0496  50       DT Head Market
     C                     Z-ADD*ZERO     WN0497  71       DT Weight Marke
     C                     Z-ADD*ZERO     WN0498  51       DT Avg Weight M
     C                     Z-ADD*ZERO     WN0499  50       DT Head Resale
     C                     Z-ADD*ZERO     WN0500  71       DT Weight Resal
     C                     Z-ADD*ZERO     WN0501  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0502  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0503  71       DT Weight Unuse
     C                     Z-ADD*ZERO     WN0504  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0505  71       DT Weight Unuse
     C                     MOVEL*BLANK    WN0506  1        DT Error Sts
     C                     MOVEL*BLANK    WN0507  2        DT Error Reason
     C                     MOVEL*BLANK    WN0508  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0509  6        PL Location Cod
     C                     MOVEL*BLANK    WN0510  3        SR Source Code
     C                     Z-ADD*ZERO     WN0511  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0512  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0513  50       BOL Load Number
     C                     MOVEL*BLANK    WN0514 10        RS User Changed
     C                     Z-ADD*ZERO     WN0515  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0516  60       RS Time Changed
     C                     MOVEL*BLANK    WN0517  1        RS Record Statu
     C                     MOVEL*BLANK    WN0518 10        RS Job
     C                     MOVEL*BLANK    WN0519 10        RS Program
     C                     MOVEL*BLANK    WN0520 10        RS User Added
     C                     Z-ADD*ZERO     WN0521  70       RS Date Added
     C                     Z-ADD*ZERO     WN0522  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YVRDC   1
      *
      * Move key fields to @AFCPIC
     C                     Z-ADDAFHONB    WRHONB           CC Company Numb
     C                     Z-ADDAFE0DT    WRE0DT           DSH Kill Date
     C                     Z-ADDAFE9DT    WRE9DT           DT Delivery Dat
     C                     Z-ADDAFAJTH    WRAJTH           DT Delivery Tim
     C                     Z-ADDAFH4A1    WRH4A1           DT Delivery Tim
      *
     C           KLCHQI    KLIST
     C                     KFLD           WRHONB           CC Company Numb
     C                     KFLD           WRE0DT           DSH Kill Date
     C                     KFLD           WRE9DT           DT Delivery Dat
     C                     KFLD           WRAJTH           DT Delivery Tim
     C                     KFLD           WRH4A1           DT Delivery Tim
     C           KLCHQI    CHAIN@AFCPIC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAFCPL0'MDACP
     C                     MOVEL'@AFCPIC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL023.
     C                     MOVEL'LBL023'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAF1    YVRDCS
      * Move non-key fields to @AFCPIC
     C                     MOVEL#1BICD    WRLGCD    P      DT Hog Group Re
     C                     Z-ADD#1OXNB    WRIEA1           DT Movement Num
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAF1    IFNE YVRDCS
     C           YVRDC     ANDNE'N'
     C                     MOVE 'Y'       YVRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WRAAVN           RS User Changed
     C                     Z-ADD##JDT     WRAADT           RS Date Changed
     C                     Z-ADD##JTM     WRAMTM           RS Time Changed
     C                     MOVEL##JOB     WRAHVN           RS Job
     C                     MOVEL##PGM     WRAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAF1    IFNE YVRDCS
     C           YVRDC     ANDNE'N'
     C                     MOVE 'Y'       YVRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YVRDC     IFEQ 'Y'
     C                     UPDAT@AFCPIC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QIEXIT    ENDSR
      /EJECT
     CSR         QJCHRC    BEGSR
      *================================================================
      * Chg Tattoo Hdr w/new  CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0523  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0524  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0525  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0526  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0527  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0528  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0529  3        TH PHA Average
     C                     MOVEL*BLANK    WN0530  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0531  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0532  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0533  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0534  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0535  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0536  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0537  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0538  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0539  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0540  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0541  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0542  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0543 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0544 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0545 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0546 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0547  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0548  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0549  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0550  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0551  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0552  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0553  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0554  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0555  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0556  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0557  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0558  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0559  70       TH Unused Date
     C                     MOVEL*BLANK    WN0560  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0561  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0562  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0563  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0564  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0565  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0566  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0567  1        TH Unused Sts 8
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YWRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDP1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    A1B0DT           TH Kill Date
      *
     C           KLCHQJ    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
     C           KLCHQJ    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL024.
     C                     MOVEL'LBL024'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YWRDCS
      * USER: Processing after Data read
     C                     Z-ADDA1CXNB    YL0024           TH Dead On Arri
      * Move non-key fields to @A1CPC5
     C                     Z-ADD#1AWDT    A1AWDT           TH Purchase Dat
     C                     MOVEL#1BICD    A1BICD    P      TH Group Refere
     C                     MOVEL#1CPST    A1CPST    P      TH Live Purchas
     C                     Z-ADD#1ACPR    A1ACPR           TH Live Purchas
     C                     Z-ADD#1B9PR    A1B9PR           TH Live Gross A
     C                     Z-ADD#1CAPR    A1CAPR           TH LIve Net Amt
     C                     MOVEL#1C4ST    A1C4ST    P      TH Resale UOM
     C                     Z-ADD#1AIPR    A1AIPR           TH Recalc Live
     C                     Z-ADD#1A6DT    A1A6DT           TH Pricing Date
     C                     MOVEL#1C2ST    A1C2ST    P      TH Resale Sprea
     C                     Z-ADD#1CXNB    A1CXNB           TH Dead On Arri
     C                     Z-ADD#1CWNB    A1CWNB           TH Head Receive
     C                     Z-ADD#1FCNB    A1FCNB           TH Yard Deads
     C                     Z-ADD#1H9NB    A1H9NB           TH Held Over
     C                     Z-ADD#1FDNB    A1FDNB           TH Head Condemn
     C                     Z-ADD#1FENB    A1FENB           TH Head Killed
     C                     Z-ADD#1HENB    A1HENB           TH Head Adds
     C                     Z-ADD#1HFNB    A1HFNB           TH Head Accepte
     C                     Z-ADD#1CYNB    A1CYNB           TH Live Wgt
     C                     Z-ADD#1LRNB    A1LRNB           TH Adj Live Wgt
     C                     Z-ADD#1E0NB    A1E0NB           TH Hot Wgt
     C                     Z-ADD#1A5PC    A1A5PC           TH Tot Loin Eye
     C                     Z-ADD#1FBNB    A1FBNB           TH Tot Backfat
     C                     Z-ADD#1A4PC    A1A4PC           TH Tot Light Re
     C                     Z-ADD#1F7NB    A1F7NB           TH Avg Live Wgt
     C                     Z-ADD#1HDNB    A1HDNB           TH Avg Hot Wgt
     C                     Z-ADD#1F5NB    A1F5NB           TH Avg Light Re
     C                     Z-ADD#1F4NB    A1F4NB           TH Avg Lean Per
     C                     Z-ADD#1F3NB    A1F3NB           TH Avg Loin Eye
     C                     Z-ADD#1F2NB    A1F2NB           TH Avg Backfat
     C                     Z-ADD#1AVPC    A1AVPC           TH Std Yield Pe
     C                     Z-ADD#1AWPC    A1AWPC           TH Actual Yield
     C                     Z-ADD#1CWPC    A1CWPC           TH Adj Actual Y
     C                     Z-ADD#1A8PC    A1A8PC           TH Yield Differ
     C                     Z-ADD#1A7PC    A1A7PC           TH Recalc Live
     C                     Z-ADD#1B8PR    A1B8PR           TH CM Market Pr
     C                     Z-ADD#1AMPR    A1AMPR           TH CM Base Mkt
     C                     Z-ADD#1ANPR    A1ANPR           TH CM Base Mkt
     C                     Z-ADD#1AYVA    A1AYVA           TH CM Sort Disc
     C                     Z-ADD#1AWVA    A1AWVA           TH CM Yield Gai
     C                     Z-ADD#1AOPR    A1AOPR           TH CM Base Carc
     C                     Z-ADD#1AXVA    A1AXVA           TH CM LN AddOn/
     C                     Z-ADD#1APPR    A1APPR           TH CM Carcass G
     C                     Z-ADD#1ASPR    A1ASPR           TH Deduction Am
     C                     Z-ADD#1A4VA    A1A4VA           TH Total Net WO
     C                     Z-ADD#1ATPR    A1ATPR           TH Carcass Net
     C                     Z-ADD#1A5VA    A1A5VA           TH Additions Am
     C                     Z-ADD#1CBPR    A1CBPR           TH Payment Gros
     C                     Z-ADD#1CCPR    A1CCPR           Th Payment Net
     C                     Z-ADD#1LPNB    A1LPNB           TH AP Voucher/D
     C                     Z-ADD#1CDPR    A1CDPR           TH Freight Amou
     C                     Z-ADD#1A7VA    A1A7VA           TH Accrual Amou
     C                     Z-ADD#1A2PR    A1A2PR           TH Fixed Cost A
     C                     MOVEL#1JWST    A1JWST    P      TH Calc Net Sts
     C                     MOVEL#1CWST    A1CWST    P      TH Payment Sts
     C                     MOVEL#1D7ST    A1D7ST    P      TH Header Error
     C                     MOVEL#1D8ST    A1D8ST    P      TH Detail Error
     C                     MOVEL#1DWST    A1DWST    P      TH Kill Balanci
     C                     MOVEL#1D6ST    A1D6ST    P      TH Bal to Kill
     C                     Z-ADD#1GHNB    A1GHNB           TH Commission A
     C                     Z-ADD#1BYDT    A1BYDT           TH Voucher Paym
     C                     MOVEL#1E0ST    A1E0ST    P      TH User Error O
     C                     MOVEL#1E1ST    A1E1ST    P      TH Held Over Re
     C                     MOVEL#1E2ST    A1E2ST    P      TH Sex
     C                     Z-ADD#1BSDT    A1BSDT           TH Held/Ovr Com
     C                     Z-ADD#1BTDT    A1BTDT           TH Commission P
     C                     Z-ADD#1BUDT    A1BUDT           TH Actual Check
     C                     Z-ADD#1HGNB    A1HGNB           TH Shipped Weig
     C                     Z-ADD#1HHNB    A1HHNB           TH Avg Hot Wgt
     C                     Z-ADD#1HINB    A1HINB           TH FFLI
     C                     Z-ADD#1A3PR    A1A3PR           TH Kill Product
     C                     Z-ADD#1A4PR    A1A4PR           TH Cut Product
     C                     Z-ADD#1A6PR    A1A6PR           TH Render Produ
     C                     Z-ADD#1J9NB    A1J9NB           TH Head Exclude
     C                     Z-ADD#1D6PR    A1D6PR           TH CM Bse Mkt L
     C                     Z-ADD#1D7PR    A1D7PR           TH CM Bse Mkt C
     C                     Z-ADD#1D8PR    A1D8PR           TH CM Srt Dsc L
     C                     Z-ADD#1D9PR    A1D9PR           TH CM Srt Dsc C
     C                     Z-ADD#1EAPR    A1EAPR           TH CM Yld G/L L
     C                     Z-ADD#1EBPR    A1EBPR           TH CM Yld G/L C
     C                     Z-ADD#1ECPR    A1ECPR           TH CM Crc Val L
     C                     Z-ADD#1EDPR    A1EDPR           TH CM Crc Val C
     C                     Z-ADD#1EEPR    A1EEPR           TH CM Lean Prem
     C                     Z-ADD#1EFPR    A1EFPR           TH CM Lean Prem
     C                     Z-ADD#1EGPR    A1EGPR           TH CM Gross Liv
     C                     Z-ADD#1EHPR    A1EHPR           TH CM Gross Car
     C                     MOVEL#1KAST    A1KAST    P      TH Source Type
     C                     MOVEL#1J7ST    A1J7ST    P      TH Scale Ticket
     C                     MOVEL#1J9ST    A1J9ST    P      TH Payment Type
     C                     Z-ADD#1OXNB    A1OXNB           TH HPS Movement
     C                     MOVEL#1LKST    A1LKST    P      TH Source Code
     C                     MOVEL#1LLST    A1LLST    P      TH Hog Class Ty
     C                     MOVEL#1J8ST    A1J8ST    P      TH Posted to HP
     C                     MOVEL#1LIST    A1LIST    P      TH Schedule Kil
     C                     MOVEL#1LJST    A1LJST    P      TH Shift Held O
     C                     MOVEL#1NZTX    A1NZTX    P      TH State
     C                     MOVEL#1HJCD    A1HJCD    P      TH Unused Code
     C                     MOVEL#1R4ST    A1R4ST    P      TH Unused Sts 2
     C                     MOVEL#1R5ST    A1R5ST    P      TH Commission S
     C                     MOVEL#1R6ST    A1R6ST    P      TH Paid 2 Week
     C                     MOVEL#1R7ST    A1R7ST    P      TH Unused Sts 1
     C                     Z-ADD#1THWT    A1THWT           TH DOA Weight
     C                     Z-ADD#1T2WT    A1T2WT           TH Avg Lean % E
     C                     Z-ADD#1THHD    A1THHD           TH HPS Farm Sit
     C                     Z-ADD#1T2HD    A1T2HD           TH Shift Held O
     C                     Z-ADD#1OBPR    A1OBPR           TH Sorting Amou
     C                     MOVEL#1BDCD    A1BDCD    P      DF Defect Code
     C                     MOVEL#1CSCD    A1CSCD    P      THP Process Cod
     C                     MOVELP1ABCD    A1ABCD    P      PD Producer Cod
     C                     MOVELP1AECD    A1AECD    P      PL Location Cod
     C                     MOVEL#1ACCD    A1ACCD    P      HB Buyer Code
     C                     MOVEL#1AGCD    A1AGCD    P      GN Genetic Code
     C                     MOVEL#1BECD    A1BECD    P      HC Class Code
     C                     MOVEL#1AAVN    A1AAVN    P      RS User Changed
     C                     Z-ADD#1AADT    A1AADT           RS Date Changed
     C                     Z-ADD#1AMTM    A1AMTM           RS Time Changed
     C                     MOVEL#1AJST    A1AJST    P      RS Record Statu
     C                     MOVEL#1AHVN    A1AHVN    P      RS Job
     C                     MOVEL#1AGVN    A1AGVN    P      RS Program
     C                     MOVEL#1ABVN    A1ABVN    P      RS User Added
     C                     Z-ADD#1ABDT    A1ABDT           RS Date Added
     C                     Z-ADD#1ABTM    A1ABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YWRDCS
     C           YWRDC     ANDNE'N'
     C                     MOVE 'Y'       YWRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     A1AAVN           RS User Changed
     C                     Z-ADD##JDT     A1AADT           RS Date Changed
     C                     Z-ADD##JTM     A1AMTM           RS Time Changed
     C                     MOVEL##JOB     A1AHVN           RS Job
     C                     MOVEL##PGM     A1AGVN           RS Program
      * Chg/Crt Tatto/Spc Flds IF
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Function Description:  If there are any fields that need to be
      * Changed/Created during the Change functions or Create function
      * Presently: Payment Type
      * Add this routine to all of the change objects and create object
      * that update the Payment Type
      * CASE: PAR.TH Payment Sts is Live anything
     C           A1CWST    IFEQ 'ML'                       *IF
     C           A1CWST    OREQ 'PL'
     C           A1CWST    OREQ 'NL'
     C           A1CWST    OREQ 'SL'
     C           A1CWST    OREQ 'IL'
     C                     MOVEL'L'       A1J9ST           TH Payment Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       A1J9ST           TH Payment Type
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YWRDCS
     C           YWRDC     ANDNE'N'
     C                     MOVE 'Y'       YWRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YWRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: PAR.TH Dead On Arrival NE LCL.TH Dead On Arrival
     C           #1CXNB    IFNE YL0024                     *IF
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
     C                     EXSR QKRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         QJEXIT    ENDSR
      /EJECT
     CSR         QKRVGN    BEGSR
      *================================================================
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQK     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDA1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSQK     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.BOL Truck Scale Weigh Sts is Respread
      *   |- c2    : DB1.BOL Truck Scale Weigh Sts is Not Spread
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'R'       IFEQ 'R'                        *IF
     C           AXPAST    IFEQ 'I'                        *IF
     C           AXPAST    OREQ 'N'
     C           AXPAST    OREQ *BLANK
     C           AXPAST    OREQ 'O'
     C           AXPAST    OREQ 'R'
     C           AXPAST    OREQ 'A'
     C           AXPAST    OREQ 'C'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
     C                     EXSR QLCHRC
     C                     END                             *FI
      * CASE: PAR.BOL Truck Scale Weigh Sts is Respread
     C           'R'       IFEQ 'R'                        *IF
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
     C                     EXSR QMRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         QKEXIT    ENDSR
      /EJECT
     CSR         QLCHRC    BEGSR
      *================================================================
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0568  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0569  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0570  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0571  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0572  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0573  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0574  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0575  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0576  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0577  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0578  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0579  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0580  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0581  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0582  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0583  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0584 11        BOL Trailer
     C                     MOVEL*BLANK    WN0585  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0586  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0587  1        Reported to USD
     C                     MOVEL*BLANK    WN0588  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0589  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0590  2        BOL Status 5
     C                     MOVEL*BLANK    WN0591  2        BOL Status 6
     C                     MOVEL*BLANK    WN0592  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0593  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0594  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0595  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0596  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0597  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0598 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0599 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0600 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0601 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0602 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0603  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0604  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0605  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0606  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0607  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0608  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0609  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0610  6        PL Location Cod
     C                     MOVEL*BLANK    WN0611 10        RS User Changed
     C                     Z-ADD*ZERO     WN0612  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0613  60       RS Time Changed
     C                     MOVEL*BLANK    WN0614  1        RS Record Statu
     C                     MOVEL*BLANK    WN0615 10        RS Job
     C                     MOVEL*BLANK    WN0616 10        RS Program
     C                     MOVEL*BLANK    WN0617 10        RS User Added
     C                     Z-ADD*ZERO     WN0618  70       RS Date Added
     C                     Z-ADD*ZERO     WN0619  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YXRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDAXHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    WKBONB           BOL Load Number
      *
     C           KLCHQL    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHQL    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL025.
     C                     MOVEL'LBL025'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YXRDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'R'       WKPAST    P      BOL Truck Scale
     C                     Z-ADDAXLDSH    WKLDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YXRDCS
     C           YXRDC     ANDNE'N'
     C                     MOVE 'Y'       YXRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YXRDCS
     C           YXRDC     ANDNE'N'
     C                     MOVE 'Y'       YXRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YXRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QLEXIT    ENDSR
      /EJECT
     CSR         QMRVGN    BEGSR
      *================================================================
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQQM01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQQM02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQQM03           BOL Load Number
      * Define keylist
     C           KRSQM     KLIST
     C                     KFLD           WQQM01           BOH Company Num
     C                     KFLD           WQQM02           BOH Buy Order N
     C                     KFLD           WQQM03           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    WQQM01           BOH Company Num
     C                     Z-ADDAXBNNB    WQQM02           BOH Buy Order N
     C                     Z-ADDAXBONB    WQQM03           BOL Load Number
      * Establish starting position
     C           KRSQM     SETLL@A1CPC4                    *
     C           KRSQM     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           A1LLST    IFEQ 'M'                        *IF
     C           A1LLST    OREQ 'S'
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
     C                     EXSR QNCHRC
     C                     END                             *FI
     C           KRSQM     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         QMEXIT    ENDSR
      /EJECT
     CSR         QNCHRC    BEGSR
      *================================================================
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0620  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0621 10        TH Group Refere
     C                     MOVEL*BLANK    WN0622  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0623  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0624  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0625  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0626  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0627  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0628  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0629  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0630  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0631  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0632  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0633  50       TH Held Over
     C                     Z-ADD*ZERO     WN0634  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0635  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0636  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0637  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0638  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0639  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0640  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0641  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0642  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0643  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0644  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0645  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0646  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0647  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0648  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0649  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0650  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0651  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0652  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0653  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0654  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0655  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0656  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0657  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0658  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0659  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0660  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0661  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0662  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0663  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0664  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0665  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0666  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0667  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0668  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0669  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0670  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0671  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0672  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0673  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0674  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0675  1        TH Detail Error
     C                     MOVEL*BLANK    WN0676  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0677  80       TH Commission A
     C                     Z-ADD*ZERO     WN0678  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0679  1        TH User Error O
     C                     MOVEL*BLANK    WN0680  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0681  1        TH Sex
     C                     Z-ADD*ZERO     WN0682  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0683  70       TH Commission P
     C                     Z-ADD*ZERO     WN0684  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0685  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0686  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0687  31       TH FFLI
     C                     Z-ADD*ZERO     WN0688  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0689  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0690  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0691  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0692  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0693  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0694  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0695  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0696  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0697  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0698  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0699  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0700  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0701  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0702  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0703  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0704  1        TH Source Type
     C                     MOVEL*BLANK    WN0705  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0706  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0707  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0708  3        TH Source Code
     C                     MOVEL*BLANK    WN0709  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0710  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0711  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0712  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0713  3        TH State
     C                     MOVEL*BLANK    WN0714  3        TH Unused Code
     C                     MOVEL*BLANK    WN0715  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0716  1        TH Commission S
     C                     MOVEL*BLANK    WN0717  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0718  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0719  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0720  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0721  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0722  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0723  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0724  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0725  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0726  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0727  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0728  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0729  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0730  3        TH PHA Average
     C                     MOVEL*BLANK    WN0731  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0732  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0733  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0734  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0735  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0736  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0737  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0738  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0739  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0740  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0741  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0742  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0743  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0744 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0745 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0746 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0747 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0748  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0749  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0750  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0751  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0752  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0753  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0754  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0755  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0756  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0757  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0758  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0759  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0760  70       TH Unused Date
     C                     MOVEL*BLANK    WN0761  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0762  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0763  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0764  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0765  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0766  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0767  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0768  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0769  6        DF Defect Code
     C                     MOVEL*BLANK    WN0770  6        THP Process Cod
     C                     MOVEL*BLANK    WN0771  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0772  6        PL Location Cod
     C                     MOVEL*BLANK    WN0773  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0774  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0775  3        HC Class Code
     C                     MOVEL*BLANK    WN0776 10        RS User Changed
     C                     Z-ADD*ZERO     WN0777  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0778  60       RS Time Changed
     C                     MOVEL*BLANK    WN0779  1        RS Record Statu
     C                     MOVEL*BLANK    WN0780 10        RS Job
     C                     MOVEL*BLANK    WN0781 10        RS Program
     C                     MOVEL*BLANK    WN0782 10        RS User Added
     C                     Z-ADD*ZERO     WN0783  70       RS Date Added
     C                     Z-ADD*ZERO     WN0784  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YYRDC   1
      *
      * Move key fields to @A1CPC5
      *
     C           KLCHQN    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
     C           KLCHQN    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL026.
     C                     MOVEL'LBL026'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YYRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVEL'E'       A1D7ST    P      TH Header Error
     C                     MOVEL'E'       A1DWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YYRDCS
     C           YYRDC     ANDNE'N'
     C                     MOVE 'Y'       YYRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YYRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QNEXIT    ENDSR
      /EJECT
     CSR         QORVGN    BEGSR
      *================================================================
      * Upd Shipped Head      RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQO     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSQO     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Shipped Head      CH - Buy Order Load  * 
     C                     EXSR QPCHRC
     C                     ENDIF
      *================================================================
     CSR         QOEXIT    ENDSR
      /EJECT
     CSR         QPCHRC    BEGSR
      *================================================================
      * Chg Shipped Head      CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0785  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0786  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0787  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0788  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0789  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0790  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0791  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0792  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0793  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0794  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0795  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0796  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0797  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0798  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0799  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0800  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0801 11        BOL Trailer
     C                     MOVEL*BLANK    WN0802  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0803  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0804  1        BOL Truck Scale
     C                     MOVEL*BLANK    WN0805  1        Reported to USD
     C                     MOVEL*BLANK    WN0806  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0807  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0808  2        BOL Status 5
     C                     MOVEL*BLANK    WN0809  2        BOL Status 6
     C                     MOVEL*BLANK    WN0810  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0811  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0812  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0813  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0814  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0815  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0816 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0817 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0818 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0819 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0820 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0821  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0822  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0823  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0824  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0825  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0826  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0827  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0828  6        PL Location Cod
     C                     MOVEL*BLANK    WN0829 10        RS User Changed
     C                     Z-ADD*ZERO     WN0830  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0831  60       RS Time Changed
     C                     MOVEL*BLANK    WN0832  1        RS Record Statu
     C                     MOVEL*BLANK    WN0833 10        RS Job
     C                     MOVEL*BLANK    WN0834 10        RS Program
     C                     MOVEL*BLANK    WN0835 10        RS User Added
     C                     Z-ADD*ZERO     WN0836  70       RS Date Added
     C                     Z-ADD*ZERO     WN0837  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YZRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDP1HMNB    WKHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WKBONB           BOL Load Number
      *
     C           KLCHQP    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHQP    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL027.
     C                     MOVEL'LBL027'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YZRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADD#DLDSH    WKLDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YZRDCS
     C           YZRDC     ANDNE'N'
     C                     MOVE 'Y'       YZRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YZRDCS
     C           YZRDC     ANDNE'N'
     C                     MOVE 'Y'       YZRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YZRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QPEXIT    ENDSR
      /EJECT
     CSR         QQRVGN    BEGSR
      *================================================================
      * Rtv Del Tattoo Def - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQQQ01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQQQ02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQQQ03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQQQ04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQQQ05           TH Kill Date
      * Define keylist
     C           KRSQQ     KLIST
     C                     KFLD           WQQQ01           BOH Company Num
     C                     KFLD           WQQQ02           BOH Buy Order N
     C                     KFLD           WQQQ03           BOL Load Number
     C                     KFLD           WQQQ04           TH Tattoo Numbe
     C                     KFLD           WQQQ05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQQQ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQQ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQQ03           BOL Load Number
     C                     Z-ADD#1CVNB    WQQQ04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQQQ05           TH Kill Date
      * Establish starting position
     C           KRSQQ     SETLL@DZREX3                    *
     C           KRSQQ     READE@DZREX3                  90*
      * Data record not found
     C   90                MOVEL'PRK0738' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Tattoo Defect     DO - Tattoo Defect  * 
     C                     EXSR QRDLRC
     C           KRSQQ     READE@DZREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         QQEXIT    ENDSR
      /EJECT
     CSR         QRDLRC    BEGSR
      *================================================================
      * Dlt Tattoo Defect     DO - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DZREX2
     C                     Z-ADDDZHMNB    WOHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    WOBONB           BOL Load Number
     C                     Z-ADDDZCVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    WOB0DT           TH Kill Date
     C                     MOVELDZBDCD    WOBDCD           DF Defect Code
      *
     C           KLDLQR    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
     C           KLDLQR    CHAIN@DZREX2              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDZREL0'MDACP
     C                     MOVEL'@DZREX2' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL028.
     C                     MOVEL'LBL028'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QREXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DZREX2                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         QREXIT    ENDSR
      /EJECT
     CSR         QSCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0838  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGUCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DF1NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR QTRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRQS    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRQS    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QSEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QSEXIT    ENDSR
      /EJECT
     CSR         QTRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQT     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSQT     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO QTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         QTEXIT    ENDSR
      /EJECT
     CSR         QUCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0839  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGVCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFWNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR QVRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRQU    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRQU    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QUEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QUEXIT    ENDSR
      /EJECT
     CSR         QVRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQV     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSQV     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO QVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         QVEXIT    ENDSR
      /EJECT
     CSR         QWCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0840  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGWCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFYNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR QXRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRQW    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRQW    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QWEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QWEXIT    ENDSR
      /EJECT
     CSR         QXRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQX     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSQX     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO QXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         QXEXIT    ENDSR
      /EJECT
     CSR         QYCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0841  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGXCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFUNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR QZRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRQY    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRQY    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QYEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QYEXIT    ENDSR
      /EJECT
     CSR         QZRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQZ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSQZ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO QZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         QZEXIT    ENDSR
      /EJECT
     CSR         RACRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0842  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGYCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO3NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RBRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRA    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRA    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RAEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RAEXIT    ENDSR
      /EJECT
     CSR         RBRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRB     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRB     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RBEXIT    ENDSR
      /EJECT
     CSR         RCCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0843  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGZCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO4NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RDRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRC    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRC    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RCEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RCEXIT    ENDSR
      /EJECT
     CSR         RDRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRD     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRD     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RDEXIT    ENDSR
      /EJECT
     CSR         RECRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0844  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG0CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO5NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RFRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRE    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRE    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO REEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         REEXIT    ENDSR
      /EJECT
     CSR         RFRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRF     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRF     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RFEXIT    ENDSR
      /EJECT
     CSR         RGCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0845  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG1CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFONB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RHRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRG    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRG    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RGEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RGEXIT    ENDSR
      /EJECT
     CSR         RHRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRH     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRH     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RHEXIT    ENDSR
      /EJECT
     CSR         RICRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0846  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG2CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFXNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RJRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRI    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRI    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RIEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RIEXIT    ENDSR
      /EJECT
     CSR         RJRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRJ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRJ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RJEXIT    ENDSR
      /EJECT
     CSR         RKCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0847  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG3CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFTNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RLRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRK    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRK    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RKEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RKEXIT    ENDSR
      /EJECT
     CSR         RLRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRL     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRL     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RLEXIT    ENDSR
      /EJECT
     CSR         RMRVGN    BEGSR
      *================================================================
      * Rtv Dtl Pen/Chg PenDscRT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVHMNB    WQRM01           BOH Company Num
     C           *LIKE     DEFN WVBNNB    WQRM02           BOH Buy Order N
     C           *LIKE     DEFN WVBONB    WQRM03           BOL Load Number
     C           *LIKE     DEFN WVCVNB    WQRM04           TH Tattoo Numbe
     C           *LIKE     DEFN WVB0DT    WQRM05           TH Kill Date
      * Define keylist
     C           KRSRM     KLIST
     C                     KFLD           WQRM01           BOH Company Num
     C                     KFLD           WQRM02           BOH Buy Order N
     C                     KFLD           WQRM03           BOL Load Number
     C                     KFLD           WQRM04           TH Tattoo Numbe
     C                     KFLD           WQRM05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQRM01           BOH Company Num
     C                     Z-ADDP1BNNB    WQRM02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQRM03           BOL Load Number
     C                     Z-ADD#1CVNB    WQRM04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQRM05           TH Kill Date
      * Establish starting position
     C           KRSRM     SETLL@A2CPNP                    *
     C           KRSRM     READE@A2CPNP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO RMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Gntcs,descRT - Pen  * 
     C                     EXSR RNRVGN
     C           KRSRM     READE@A2CPNP                  90*
     C                     ENDDO
      *================================================================
     CSR         RMEXIT    ENDSR
      /EJECT
     CSR         RNRVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Gntcs,descRT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRN     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDWVHVNB    WIHVNB           Pen Company Num
     C                     MOVELWVCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSRN     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWUCRTX    WUAGCD           GN Genetic Code
     C                     MOVELWUCRTX    WUAWTX           GN Description
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR RORVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR RRCHRC
     C                     ENDIF
      *================================================================
     CSR         RNEXIT    ENDSR
      /EJECT
     CSR         RORVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQRO01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQRO02           Pen Number
      * Define keylist
     C           KRSRO     KLIST
     C                     KFLD           WQRO01           BOH Company Num
     C                     KFLD           WQRO02           Pen Number
      * Setup key
     C                     Z-ADDWIHVNB    WQRO01           BOH Company Num
     C                     MOVELWICMCD    WQRO02           Pen Number
      * Establish starting position
     C           KRSRO     SETLL@A2CPKE                    *
     C           KRSRO     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO ROEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WHB9CD    IFEQ 'D'                        *IF
     C           WHB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR RPRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSRO     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         ROEXIT    ENDSR
      /EJECT
     CSR         RPRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQRP01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQRP02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQRP03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQRP04           TH Tattoo Numbe
      * Define keylist
     C           KRSRP     KLIST
     C                     KFLD           WQRP01           BOH Company Num
     C                     KFLD           WQRP02           BOH Buy Order N
     C                     KFLD           WQRP03           BOL Load Number
     C                     KFLD           WQRP04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWHHMNB    WQRP01           BOH Company Num
     C                     Z-ADDWHBNNB    WQRP02           BOH Buy Order N
     C                     Z-ADDWHBONB    WQRP03           BOL Load Number
     C                     Z-ADDWHCVNB    WQRP04           TH Tattoo Numbe
      * Establish starting position
     C           KRSRP     SETLL@A1CPC4                    *
     C           KRSRP     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO RPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELA1AGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR RQRVGN
     C           KRSRP     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         RPEXIT    ENDSR
      /EJECT
     CSR         RQRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRQ     KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVELA1AGCD    AIAGCD           GN Genetic Code
      * Establish starting position
     C           KRSRQ     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO RQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         RQEXIT    ENDSR
      /EJECT
     CSR         RRCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0848  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0849  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0850  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0851  1        Pen Sts
     C                     Z-ADD*ZERO     WN0852  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0853  1        Pen Type
     C                     Z-ADD*ZERO     WN0854  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0855 10        RS User Changed
     C                     Z-ADD*ZERO     WN0856  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0857  60       RS Time Changed
     C                     MOVEL*BLANK    WN0858  1        RS Record Statu
     C                     MOVEL*BLANK    WN0859 10        RS Job
     C                     MOVEL*BLANK    WN0860 10        RS Program
     C                     MOVEL*BLANK    WN0861 10        RS User Added
     C                     Z-ADD*ZERO     WN0862  70       RS Date Added
     C                     Z-ADD*ZERO     WN0863  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y0RDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHRR    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHRR    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL029.
     C                     MOVEL'LBL029'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO RREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO RREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    Y0RDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE Y0RDCS
     C           Y0RDC     ANDNE'N'
     C                     MOVE 'Y'       Y0RDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE Y0RDCS
     C           Y0RDC     ANDNE'N'
     C                     MOVE 'Y'       Y0RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y0RDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         RREXIT    ENDSR
      /EJECT
     CSR         RSRVGN    BEGSR
      *================================================================
      * Chg TatHdrExt by Key  RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRS     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    DNHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    DNBONB           BOL Load Number
     C                     Z-ADD#1CVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSRS     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
     C                     EXSR RTCRRC
     C                     GOTO RSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg TatHdrExtWTOPrdSitCH - Tattoo Header EXT  * 
     C                     EXSR RUCHRC
     C                     ENDIF
      *================================================================
     CSR         RSEXIT    ENDSR
      /EJECT
     CSR         RTCRRC    BEGSR
      *================================================================
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0864 10        RS User Changed
     C                     Z-ADD*ZERO     WN0865  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0866  60       RS Time Changed
     C                     MOVEL*BLANK    WN0867  1        RS Record Statu
     C                     MOVEL*BLANK    WN0868 10        RS Job
     C                     MOVEL*BLANK    WN0869 10        RS Program
     C                     MOVEL*BLANK    WN0870 10        RS User Added
     C                     Z-ADD*ZERO     WN0871  70       RS Date Added
     C                     Z-ADD*ZERO     WN0872  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DNCPUX
     C                     Z-ADDP1HMNB    WSHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WSBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WSB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WSI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WSJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WSI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WSI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WSI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WSI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WSJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WSJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WSJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WSJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WSJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WSJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WSJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WSJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WSJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WSJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WSJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WSJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WSLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WSHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WSLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WSH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WSGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WSH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WSGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WSH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WSHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WSHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WSHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WSHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WSHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WSHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WSHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WSHFLP           TH Head GT Lean
     C                     Z-ADDYL0025    WSSNA1           TE Unused Numbe
     C                     Z-ADDYL0026    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDYL0027    WSSPA1           TE Unused Numbe
     C                     MOVELYL0028    WSDGSS           TE Unused Statu
     C                     MOVELYL0029    WSDHSS           TE Unused Statu
     C                     MOVELYL0030    WSDISS           TE Unused Statu
     C                     MOVELP1ABCD    WSABCD           PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD           PS Site ID
     C                     MOVEL#DOVCD    WSOVCD           Producer Subsid
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WSAJST           RS Record Statu
     C                     MOVEL##USR     WSABVN           RS User Added
     C                     Z-ADD##JDT     WSABDT           RS Date Added
     C                     Z-ADD##JTM     WSABTM           RS Time Added
     C                     MOVEL##PGM     WSAGVN           RS Program
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL*BLANK    WSAAVN           RS User Changed
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C           KLCRRT    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRRT    SETLL@DNCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0638' W0RTN   7
      * Send message 'Tattoo Header EXT      EX'
     C                     MOVEL'PRK0638' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RTEXIT
     C                     ENDIF
      *
     C                     WRITE@DNCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RTEXIT    ENDSR
      /EJECT
     CSR         RUCHRC    BEGSR
      *================================================================
      * Chg TatHdrExtWTOPrdSitCH - Tattoo Header EXT  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0873  52       TH CA Market Pr
     C                     Z-ADD*ZERO     WN0874  72       TH CA Base Mark
     C                     Z-ADD*ZERO     WN0875  72       TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0876  72       TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0877  72       TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0878  72       TH CA Base Carc
     C                     Z-ADD*ZERO     WN0879  72       TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0880  72       TH CA Carcass G
     C                     Z-ADD*ZERO     WN0881  52       TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WN0882  52       TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WN0883  52       TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WN0884  52       TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WN0885  52       TH CA Yld G/L L
     C                     Z-ADD*ZERO     WN0886  52       TH CA Yld G/L C
     C                     Z-ADD*ZERO     WN0887  52       TH CA Crc Val L
     C                     Z-ADD*ZERO     WN0888  52       TH CA Crc Val C
     C                     Z-ADD*ZERO     WN0889  52       TH CA Lean Prm
     C                     Z-ADD*ZERO     WN0890  52       TH CA Lean Prm
     C                     Z-ADD*ZERO     WN0891  52       TH CA Gross Liv
     C                     Z-ADD*ZERO     WN0892  52       TH CA Gross Car
     C                     Z-ADD*ZERO     WN0893  31       TH Min LT Backf
     C                     Z-ADD*ZERO     WN0894  31       TH Min LT LoinE
     C                     Z-ADD*ZERO     WN0895  71       TH Min LT Hot W
     C                     Z-ADD*ZERO     WN0896  31       TH Min LT Lean
     C                     Z-ADD*ZERO     WN0897  31       TH Max GT Backf
     C                     Z-ADD*ZERO     WN0898  31       TH Max GT LoinE
     C                     Z-ADD*ZERO     WN0899  71       TH Max GT Hot W
     C                     Z-ADD*ZERO     WN0900  31       TH Max GT Lean
     C                     Z-ADD*ZERO     WN0901  50       TH Head LT Back
     C                     Z-ADD*ZERO     WN0902  50       TH Head LT Loin
     C                     Z-ADD*ZERO     WN0903  50       TH Head LT Hot
     C                     Z-ADD*ZERO     WN0904  50       TH Head LT Lean
     C                     Z-ADD*ZERO     WN0905  50       TH Head GT Back
     C                     Z-ADD*ZERO     WN0906  50       TH Head GT Loin
     C                     Z-ADD*ZERO     WN0907  50       TH Head GT Hot
     C                     Z-ADD*ZERO     WN0908  50       TH Head GT Lean
     C                     MOVEL*BLANK    WN0909 10        RS User Changed
     C                     Z-ADD*ZERO     WN0910  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0911  60       RS Time Changed
     C                     MOVEL*BLANK    WN0912  1        RS Record Statu
     C                     MOVEL*BLANK    WN0913 10        RS Job
     C                     MOVEL*BLANK    WN0914 10        RS Program
     C                     MOVEL*BLANK    WN0915 10        RS User Added
     C                     Z-ADD*ZERO     WN0916  70       RS Date Added
     C                     Z-ADD*ZERO     WN0917  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y1RDC   1
      *
      * Move key fields to @DNCPUX
     C                     Z-ADDDNHMNB    WSHMNB           BOH Company Num
     C                     Z-ADDDNBNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDDNBONB    WSBONB           BOL Load Number
     C                     Z-ADDDNCVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDDNB0DT    WSB0DT           TH Kill Date
      *
     C           KLCHRU    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
     C           KLCHRU    CHAIN@DNCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) DNSNA1' defaulted for 'TE Unused Number 1'.
      * Field '(PAR) DNSOA1' defaulted for 'TE UnUsed Number 2'.
      * Field '(PAR) DNSPA1' defaulted for 'TE Unused Number 3'.
      * Field '(PAR) DNDGSS' defaulted for 'TE Unused Status 1'.
      * Field '(PAR) DNDHSS' defaulted for 'TE Unused Status 2'.
      * Field '(PAR) DNDISS' defaulted for 'TE Unused Status 3'.
      * Field '(PAR) #DOVCD' defaulted for 'Producer Subsidiary Code'.
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
     C                     EXSR RVCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDNCPL0'MDACP
     C                     MOVEL'@DNCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL030.
     C                     MOVEL'LBL030'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO RUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO RUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDN1    Y1RDCS
      * Move non-key fields to @DNCPUX
     C                     Z-ADDDNSNA1    WSSNA1           TE Unused Numbe
     C                     Z-ADDDNSOA1    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDDNSPA1    WSSPA1           TE Unused Numbe
     C                     MOVELDNDGSS    WSDGSS    P      TE Unused Statu
     C                     MOVELDNDHSS    WSDHSS    P      TE Unused Statu
     C                     MOVELDNDISS    WSDISS    P      TE Unused Statu
     C                     MOVELP1ABCD    WSABCD    P      PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD    P      PS Site ID
     C                     MOVEL#DOVCD    WSOVCD    P      Producer Subsid
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDN1    IFNE Y1RDCS
     C           Y1RDC     ANDNE'N'
     C                     MOVE 'Y'       Y1RDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WSAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WSAADT    PARM *ZERO     WQ0410  70       *DATE
     C           WSAMTM    PARM *ZERO     WQ0411  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL##PGM     WSAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDN1    IFNE Y1RDCS
     C           Y1RDC     ANDNE'N'
     C                     MOVE 'Y'       Y1RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y1RDC     IFEQ 'Y'
     C                     UPDAT@DNCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         RUEXIT    ENDSR
      /EJECT
     CSR         RVCRRC    BEGSR
      *================================================================
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0918 10        RS User Changed
     C                     Z-ADD*ZERO     WN0919  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0920  60       RS Time Changed
     C                     MOVEL*BLANK    WN0921  1        RS Record Statu
     C                     MOVEL*BLANK    WN0922 10        RS Job
     C                     MOVEL*BLANK    WN0923 10        RS Program
     C                     MOVEL*BLANK    WN0924 10        RS User Added
     C                     Z-ADD*ZERO     WN0925  70       RS Date Added
     C                     Z-ADD*ZERO     WN0926  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DNCPUX
     C                     Z-ADDDNHMNB    WSHMNB           BOH Company Num
     C                     Z-ADDDNBNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDDNBONB    WSBONB           BOL Load Number
     C                     Z-ADDDNCVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDDNB0DT    WSB0DT           TH Kill Date
     C                     Z-ADDWN0873    WSI5PR           TH CA Market Pr
     C                     Z-ADDWN0874    WSJBPR           TH CA Base Mark
     C                     Z-ADDWN0875    WSI6PR           TH CA Base Mkt
     C                     Z-ADDWN0876    WSI7PR           TH CA Sort Disc
     C                     Z-ADDWN0877    WSI8PR           TH CA Yield Gai
     C                     Z-ADDWN0878    WSI9PR           TH CA Base Carc
     C                     Z-ADDWN0879    WSJAPR           TH CA Lean Prem
     C                     Z-ADDWN0880    WSJCPR           TH CA Carcass G
     C                     Z-ADDWN0881    WSJDPR           TH CA Bse Mkt L
     C                     Z-ADDWN0882    WSJEPR           TH CA Bse Mkt C
     C                     Z-ADDWN0883    WSJFPR           TH CA Srt Dsc L
     C                     Z-ADDWN0884    WSJGPR           TH CA Srt Dsc C
     C                     Z-ADDWN0885    WSJHPR           TH CA Yld G/L L
     C                     Z-ADDWN0886    WSJIPR           TH CA Yld G/L C
     C                     Z-ADDWN0887    WSJJPR           TH CA Crc Val L
     C                     Z-ADDWN0888    WSJKPR           TH CA Crc Val C
     C                     Z-ADDWN0889    WSJLPR           TH CA Lean Prm
     C                     Z-ADDWN0890    WSJMPR           TH CA Lean Prm
     C                     Z-ADDWN0891    WSJNPR           TH CA Gross Liv
     C                     Z-ADDWN0892    WSJOPR           TH CA Gross Car
     C                     Z-ADDWN0893    WSLTBF           TH Min LT Backf
     C                     Z-ADDWN0894    WSHZPC           TH Min LT LoinE
     C                     Z-ADDWN0895    WSLTHW           TH Min LT Hot W
     C                     Z-ADDWN0896    WSH0PC           TH Min LT Lean
     C                     Z-ADDWN0897    WSGTBF           TH Max GT Backf
     C                     Z-ADDWN0898    WSH1PC           TH Max GT LoinE
     C                     Z-ADDWN0899    WSGTHW           TH Max GT Hot W
     C                     Z-ADDWN0900    WSH2PC           TH Max GT Lean
     C                     Z-ADDWN0901    WSHLBF           TH Head LT Back
     C                     Z-ADDWN0902    WSHLLE           TH Head LT Loin
     C                     Z-ADDWN0903    WSHLHW           TH Head LT Hot
     C                     Z-ADDWN0904    WSHLLP           TH Head LT Lean
     C                     Z-ADDWN0905    WSHGBF           TH Head GT Back
     C                     Z-ADDWN0906    WSHGLE           TH Head GT Loin
     C                     Z-ADDWN0907    WSHGHW           TH Head GT Hot
     C                     Z-ADDWN0908    WSHFLP           TH Head GT Lean
     C                     Z-ADDDNSNA1    WSSNA1           TE Unused Numbe
     C                     Z-ADDDNSOA1    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDDNSPA1    WSSPA1           TE Unused Numbe
     C                     MOVELDNDGSS    WSDGSS           TE Unused Statu
     C                     MOVELDNDHSS    WSDHSS           TE Unused Statu
     C                     MOVELDNDISS    WSDISS           TE Unused Statu
     C                     MOVELP1ABCD    WSABCD           PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD           PS Site ID
     C                     MOVEL#DOVCD    WSOVCD           Producer Subsid
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WSAJST           RS Record Statu
     C                     MOVEL##USR     WSABVN           RS User Added
     C                     Z-ADD##JDT     WSABDT           RS Date Added
     C                     Z-ADD##JTM     WSABTM           RS Time Added
     C                     MOVEL##PGM     WSAGVN           RS Program
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL*BLANK    WSAAVN           RS User Changed
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C           KLCRRV    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRRV    SETLL@DNCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0638' W0RTN   7
      * Send message 'Tattoo Header EXT      EX'
     C                     MOVEL'PRK0638' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RVEXIT
     C                     ENDIF
      *
     C                     WRITE@DNCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RVEXIT    ENDSR
      /EJECT
     CSR         RWRVGN    BEGSR
      *================================================================
      * Chg TatHdrExt All TattRT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNHMNB    WQRW01           BOH Company Num
     C           *LIKE     DEFN DNBNNB    WQRW02           BOH Buy Order N
     C           *LIKE     DEFN DNBONB    WQRW03           BOL Load Number
     C           *LIKE     DEFN DNCVNB    WQRW04           TH Tattoo Numbe
      * Define keylist
     C           KRSRW     KLIST
     C                     KFLD           WQRW01           BOH Company Num
     C                     KFLD           WQRW02           BOH Buy Order N
     C                     KFLD           WQRW03           BOL Load Number
     C                     KFLD           WQRW04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQRW01           BOH Company Num
     C                     Z-ADDP1BNNB    WQRW02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQRW03           BOL Load Number
     C                     Z-ADD#1CVNB    WQRW04           TH Tattoo Numbe
      * Establish starting position
     C           KRSRW     SETLL@DNCPUY                    *
     C           KRSRW     READE@DNCPUY                  90*
      * Data record not found
     C   90                MOVEL'PRK0637' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg TatHdrExtWTOPrdSitCH - Tattoo Header EXT  * 
     C                     EXSR RXCHRC
     C           KRSRW     READE@DNCPUY                  90*
     C                     ENDDO
      *================================================================
     CSR         RWEXIT    ENDSR
      /EJECT
     CSR         RXCHRC    BEGSR
      *================================================================
      * Chg TatHdrExtWTOPrdSitCH - Tattoo Header EXT  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0927  52       TH CA Market Pr
     C                     Z-ADD*ZERO     WN0928  72       TH CA Base Mark
     C                     Z-ADD*ZERO     WN0929  72       TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0930  72       TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0931  72       TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0932  72       TH CA Base Carc
     C                     Z-ADD*ZERO     WN0933  72       TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0934  72       TH CA Carcass G
     C                     Z-ADD*ZERO     WN0935  52       TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WN0936  52       TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WN0937  52       TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WN0938  52       TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WN0939  52       TH CA Yld G/L L
     C                     Z-ADD*ZERO     WN0940  52       TH CA Yld G/L C
     C                     Z-ADD*ZERO     WN0941  52       TH CA Crc Val L
     C                     Z-ADD*ZERO     WN0942  52       TH CA Crc Val C
     C                     Z-ADD*ZERO     WN0943  52       TH CA Lean Prm
     C                     Z-ADD*ZERO     WN0944  52       TH CA Lean Prm
     C                     Z-ADD*ZERO     WN0945  52       TH CA Gross Liv
     C                     Z-ADD*ZERO     WN0946  52       TH CA Gross Car
     C                     Z-ADD*ZERO     WN0947  31       TH Min LT Backf
     C                     Z-ADD*ZERO     WN0948  31       TH Min LT LoinE
     C                     Z-ADD*ZERO     WN0949  71       TH Min LT Hot W
     C                     Z-ADD*ZERO     WN0950  31       TH Min LT Lean
     C                     Z-ADD*ZERO     WN0951  31       TH Max GT Backf
     C                     Z-ADD*ZERO     WN0952  31       TH Max GT LoinE
     C                     Z-ADD*ZERO     WN0953  71       TH Max GT Hot W
     C                     Z-ADD*ZERO     WN0954  31       TH Max GT Lean
     C                     Z-ADD*ZERO     WN0955  50       TH Head LT Back
     C                     Z-ADD*ZERO     WN0956  50       TH Head LT Loin
     C                     Z-ADD*ZERO     WN0957  50       TH Head LT Hot
     C                     Z-ADD*ZERO     WN0958  50       TH Head LT Lean
     C                     Z-ADD*ZERO     WN0959  50       TH Head GT Back
     C                     Z-ADD*ZERO     WN0960  50       TH Head GT Loin
     C                     Z-ADD*ZERO     WN0961  50       TH Head GT Hot
     C                     Z-ADD*ZERO     WN0962  50       TH Head GT Lean
     C                     MOVEL*BLANK    WN0963 10        RS User Changed
     C                     Z-ADD*ZERO     WN0964  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0965  60       RS Time Changed
     C                     MOVEL*BLANK    WN0966  1        RS Record Statu
     C                     MOVEL*BLANK    WN0967 10        RS Job
     C                     MOVEL*BLANK    WN0968 10        RS Program
     C                     MOVEL*BLANK    WN0969 10        RS User Added
     C                     Z-ADD*ZERO     WN0970  70       RS Date Added
     C                     Z-ADD*ZERO     WN0971  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y2RDC   1
      *
      * Move key fields to @DNCPUX
     C                     Z-ADDDNHMNB    WSHMNB           BOH Company Num
     C                     Z-ADDDNBNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDDNBONB    WSBONB           BOL Load Number
     C                     Z-ADDDNCVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDDNB0DT    WSB0DT           TH Kill Date
      *
     C           KLCHRX    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
     C           KLCHRX    CHAIN@DNCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) DNSNA1' defaulted for 'TE Unused Number 1'.
      * Field '(PAR) DNSOA1' defaulted for 'TE UnUsed Number 2'.
      * Field '(PAR) DNSPA1' defaulted for 'TE Unused Number 3'.
      * Field '(PAR) DNDGSS' defaulted for 'TE Unused Status 1'.
      * Field '(PAR) DNDHSS' defaulted for 'TE Unused Status 2'.
      * Field '(PAR) DNDISS' defaulted for 'TE Unused Status 3'.
      * Field '(PAR) #DOVCD' defaulted for 'Producer Subsidiary Code'.
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
     C                     EXSR RYCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDNCPL0'MDACP
     C                     MOVEL'@DNCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL031.
     C                     MOVEL'LBL031'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO RXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO RXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDN1    Y2RDCS
      * Move non-key fields to @DNCPUX
     C                     Z-ADDDNSNA1    WSSNA1           TE Unused Numbe
     C                     Z-ADDDNSOA1    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDDNSPA1    WSSPA1           TE Unused Numbe
     C                     MOVELDNDGSS    WSDGSS    P      TE Unused Statu
     C                     MOVELDNDHSS    WSDHSS    P      TE Unused Statu
     C                     MOVELDNDISS    WSDISS    P      TE Unused Statu
     C                     MOVELP1ABCD    WSABCD    P      PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD    P      PS Site ID
     C                     MOVEL#DOVCD    WSOVCD    P      Producer Subsid
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDN1    IFNE Y2RDCS
     C           Y2RDC     ANDNE'N'
     C                     MOVE 'Y'       Y2RDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WSAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WSAADT    PARM *ZERO     WQ0412  70       *DATE
     C           WSAMTM    PARM *ZERO     WQ0413  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL##PGM     WSAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDN1    IFNE Y2RDCS
     C           Y2RDC     ANDNE'N'
     C                     MOVE 'Y'       Y2RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y2RDC     IFEQ 'Y'
     C                     UPDAT@DNCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         RXEXIT    ENDSR
      /EJECT
     CSR         RYCRRC    BEGSR
      *================================================================
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0972 10        RS User Changed
     C                     Z-ADD*ZERO     WN0973  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0974  60       RS Time Changed
     C                     MOVEL*BLANK    WN0975  1        RS Record Statu
     C                     MOVEL*BLANK    WN0976 10        RS Job
     C                     MOVEL*BLANK    WN0977 10        RS Program
     C                     MOVEL*BLANK    WN0978 10        RS User Added
     C                     Z-ADD*ZERO     WN0979  70       RS Date Added
     C                     Z-ADD*ZERO     WN0980  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DNCPUX
     C                     Z-ADDDNHMNB    WSHMNB           BOH Company Num
     C                     Z-ADDDNBNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDDNBONB    WSBONB           BOL Load Number
     C                     Z-ADDDNCVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDDNB0DT    WSB0DT           TH Kill Date
     C                     Z-ADDWN0927    WSI5PR           TH CA Market Pr
     C                     Z-ADDWN0928    WSJBPR           TH CA Base Mark
     C                     Z-ADDWN0929    WSI6PR           TH CA Base Mkt
     C                     Z-ADDWN0930    WSI7PR           TH CA Sort Disc
     C                     Z-ADDWN0931    WSI8PR           TH CA Yield Gai
     C                     Z-ADDWN0932    WSI9PR           TH CA Base Carc
     C                     Z-ADDWN0933    WSJAPR           TH CA Lean Prem
     C                     Z-ADDWN0934    WSJCPR           TH CA Carcass G
     C                     Z-ADDWN0935    WSJDPR           TH CA Bse Mkt L
     C                     Z-ADDWN0936    WSJEPR           TH CA Bse Mkt C
     C                     Z-ADDWN0937    WSJFPR           TH CA Srt Dsc L
     C                     Z-ADDWN0938    WSJGPR           TH CA Srt Dsc C
     C                     Z-ADDWN0939    WSJHPR           TH CA Yld G/L L
     C                     Z-ADDWN0940    WSJIPR           TH CA Yld G/L C
     C                     Z-ADDWN0941    WSJJPR           TH CA Crc Val L
     C                     Z-ADDWN0942    WSJKPR           TH CA Crc Val C
     C                     Z-ADDWN0943    WSJLPR           TH CA Lean Prm
     C                     Z-ADDWN0944    WSJMPR           TH CA Lean Prm
     C                     Z-ADDWN0945    WSJNPR           TH CA Gross Liv
     C                     Z-ADDWN0946    WSJOPR           TH CA Gross Car
     C                     Z-ADDWN0947    WSLTBF           TH Min LT Backf
     C                     Z-ADDWN0948    WSHZPC           TH Min LT LoinE
     C                     Z-ADDWN0949    WSLTHW           TH Min LT Hot W
     C                     Z-ADDWN0950    WSH0PC           TH Min LT Lean
     C                     Z-ADDWN0951    WSGTBF           TH Max GT Backf
     C                     Z-ADDWN0952    WSH1PC           TH Max GT LoinE
     C                     Z-ADDWN0953    WSGTHW           TH Max GT Hot W
     C                     Z-ADDWN0954    WSH2PC           TH Max GT Lean
     C                     Z-ADDWN0955    WSHLBF           TH Head LT Back
     C                     Z-ADDWN0956    WSHLLE           TH Head LT Loin
     C                     Z-ADDWN0957    WSHLHW           TH Head LT Hot
     C                     Z-ADDWN0958    WSHLLP           TH Head LT Lean
     C                     Z-ADDWN0959    WSHGBF           TH Head GT Back
     C                     Z-ADDWN0960    WSHGLE           TH Head GT Loin
     C                     Z-ADDWN0961    WSHGHW           TH Head GT Hot
     C                     Z-ADDWN0962    WSHFLP           TH Head GT Lean
     C                     Z-ADDDNSNA1    WSSNA1           TE Unused Numbe
     C                     Z-ADDDNSOA1    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDDNSPA1    WSSPA1           TE Unused Numbe
     C                     MOVELDNDGSS    WSDGSS           TE Unused Statu
     C                     MOVELDNDHSS    WSDHSS           TE Unused Statu
     C                     MOVELDNDISS    WSDISS           TE Unused Statu
     C                     MOVELP1ABCD    WSABCD           PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD           PS Site ID
     C                     MOVEL#DOVCD    WSOVCD           Producer Subsid
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WSAJST           RS Record Statu
     C                     MOVEL##USR     WSABVN           RS User Added
     C                     Z-ADD##JDT     WSABDT           RS Date Added
     C                     Z-ADD##JTM     WSABTM           RS Time Added
     C                     MOVEL##PGM     WSAGVN           RS Program
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL*BLANK    WSAAVN           RS User Changed
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C           KLCRRY    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRRY    SETLL@DNCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0638' W0RTN   7
      * Send message 'Tattoo Header EXT      EX'
     C                     MOVEL'PRK0638' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RYEXIT
     C                     ENDIF
      *
     C                     WRITE@DNCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RYEXIT    ENDSR
      /EJECT
     CSR         RZRVGN    BEGSR
      *================================================================
      * Rtv HPS Automation    RT - Producer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRZ     KLIST
     C                     KFLD           AOABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    AOABCD           PD Producer Cod
      * Establish starting position
     C           KRSRZ     CHAIN@AOREKK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1097' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0031           HPS Automation
     C                     GOTO RZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAOMLCD    YL0031           HPS Automation
     C                     ENDIF
      *================================================================
     CSR         RZEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Site ID/Prod Subs RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    DNHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    DNBONB           BOL Load Number
     C                     Z-ADDP1CVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSA     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    #DNYCD           PS Site ID
     C                     MOVELDNOVCD    #DOVCD           Producer Subsid
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Sch Shift/Shp Hd  RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSB     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           BOL Pln Head De
     C                     MOVEL*BLANK    #1LIST           BOL Scheduled K
     C                     Z-ADD*ZERO     #DLDSH           BOL Shipped Hea
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAXBPNB    YL0002           BOL Pln Head De
     C                     MOVELAXO9ST    #1LIST           BOL Scheduled K
     C                     Z-ADDAXLDSH    #DLDSH           BOL Shipped Hea
     C                     GOTO SBEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Site State/PremiseRT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVELP1ABCD    ATABCD           PD Producer Cod
     C                     MOVEL#DNYCD    ATNYCD           PS Site ID
      * Establish starting position
     C           KRSSC     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     MOVEL*BLANK    #DBGT1           PS Premises ID
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           ATAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELATT2TX    #1NZTX           PS State
     C                     MOVELATBGT1    #DBGT1           PS Premises ID
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     MOVEL*BLANK    #DBGT1           PS Premises ID
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EJHONB    WQSD01           CC Company Numb
     C           *LIKE     DEFN EJBNNB    WQSD02           BOH Buy Order N
     C           *LIKE     DEFN EJBONB    WQSD03           BOL Load Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           CC Company Numb
     C                     KFLD           WQSD02           BOH Buy Order N
     C                     KFLD           WQSD03           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WQSD01           CC Company Numb
     C                     Z-ADD#1BNNB    WQSD02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSD03           BOL Load Number
      * Establish starting position
     C           KRSSD     SETLL@EJCPBK                    *
     C           KRSSD     READE@EJCPBK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0841' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1OXNB           BOLW Movement N
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEJBOMV    #1OXNB           BOLW Movement N
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@EJCPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EJHONB    WQSE01           CC Company Numb
     C           *LIKE     DEFN EJBNNB    WQSE02           BOH Buy Order N
     C           *LIKE     DEFN EJBONB    WQSE03           BOL Load Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CC Company Numb
     C                     KFLD           WQSE02           BOH Buy Order N
     C                     KFLD           WQSE03           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WQSE01           CC Company Numb
     C                     Z-ADD#1BNNB    WQSE02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSE03           BOL Load Number
      * Establish starting position
     C           KRSSE     SETLL@EJCPBK                    *
     C           KRSSE     READE@EJCPBK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0841' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1OXNB           BOLW Movement N
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEJBOMV    #1OXNB           BOLW Movement N
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@EJCPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Def-10&Cls RT - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WUODNB           Defect Count Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQSF04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQSF05           TH Kill Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
     C                     KFLD           WQSF05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSF01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSF02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSF03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSF04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSF05           TH Kill Date
      * Establish starting position
     C           KRSSF     SETLL@DZREX3                    *
     C           KRSSF     READE@DZREX3                  90*
      * Data record not found
     C   90                MOVEL'PRK0738' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Defect Count Usr is One
     C           WUODNB    IFEQ 1                          *IF
     C                     MOVELDZBDCD    #DGUCD           Defect User  1
     C                     Z-ADDDZLJNB    #DF1NB           Defect HD user
     C                     MOVELDZB7SS    #DCLSS           Defect Cls User
     C                     Z-ADD2         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Two
     C           WUODNB    IFEQ 2                          *IF
     C                     MOVELDZBDCD    #DGVCD           Defect User  2
     C                     Z-ADDDZLJNB    #DFWNB           Defect HD user
     C                     MOVELDZB7SS    #DCMSS           Defect Cls User
     C                     Z-ADD3         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Three
     C           WUODNB    IFEQ 3                          *IF
     C                     MOVELDZBDCD    #DGWCD           Defect User  3
     C                     Z-ADDDZLJNB    #DFYNB           Defect HD user
     C                     MOVELDZB7SS    #DCNSS           Defect Cls User
     C                     Z-ADD4         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Four
     C           WUODNB    IFEQ 4                          *IF
     C                     MOVELDZBDCD    #DGXCD           Defect User  4
     C                     Z-ADDDZLJNB    #DFUNB           Defect HD user
     C                     MOVELDZB7SS    #DCOSS           Defect Cls User
     C                     Z-ADD5         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Five
     C           WUODNB    IFEQ 5                          *IF
     C                     MOVELDZBDCD    #DGYCD           Defect User  5
     C                     Z-ADDDZLJNB    #DO3NB           Defect HD user
     C                     MOVELDZB7SS    #DCPSS           Defect Cls User
     C                     Z-ADD6         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Six
     C           WUODNB    IFEQ 6                          *IF
     C                     MOVELDZBDCD    #DGZCD           Defect User  6
     C                     Z-ADDDZLJNB    #DO4NB           Defect HD user
     C                     MOVELDZB7SS    #DCQSS           Defect Cls User
     C                     Z-ADD7         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Seven
     C           WUODNB    IFEQ 7                          *IF
     C                     MOVELDZBDCD    #DG0CD           Defect User  7
     C                     Z-ADDDZLJNB    #DO5NB           Defect HD user
     C                     MOVELDZB7SS    #DCRSS           Defect Cls User
     C                     Z-ADD8         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Eight
     C           WUODNB    IFEQ 8                          *IF
     C                     MOVELDZBDCD    #DG1CD           Defect User  8
     C                     Z-ADDDZLJNB    #DFONB           Defect HD user
     C                     MOVELDZB7SS    #DCSSS           Defect Cls User
     C                     Z-ADD9         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Nine
     C           WUODNB    IFEQ 9                          *IF
     C                     MOVELDZBDCD    #DG2CD           Defect User  9
     C                     Z-ADDDZLJNB    #DFXNB           Defect HD user
     C                     MOVELDZB7SS    #DCTSS           Defect Cls User
     C                     Z-ADD10        WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Ten
     C           WUODNB    IFEQ 10                         *IF
     C                     MOVELDZBDCD    #DG3CD           Defect User 10
     C                     Z-ADDDZLJNB    #DFTNB           Defect HD user
     C                     MOVELDZB7SS    #DCUSS           Defect Cls User
     C                     Z-ADD11        WUODNB           Defect Count Us
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@DZREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Resale  RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A8FBST    WQSG01           HC Class Type
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           HC Class Type
      * Setup key
     C                     MOVEL#1LLST    WQSG01           HC Class Type
      * Establish starting position
     C           KRSSG     SETLL@A8RETX                    *
     C           KRSSG     READE@A8RETX                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1BECD           HC Class Code
     C                     MOVEL*BLANK    #DBDTX           HC Description
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8BECD    #1BECD           HC Class Code
     C                     MOVELA8BDTX    #DBDTX           HC Description
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@A8RETX                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Qualify RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAFBST    WQSH01           HC Class Type
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           HC Class Type
      * Setup key
     C                     MOVEL#1LLST    WQSH01           HC Class Type
      * Establish starting position
     C           KRSSH     SETLL@A8RESC                    *
     C           KRSSH     READE@A8RESC                  90*
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABECD    #1BECD           HC Class Code
     C                     MOVELWABDTX    #DBDTX           HC Description
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@A8RESC                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Mvmnt,Farm f/BOL  RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AEHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN AEBNNB    WQSI02           BOH Buy Order N
     C           *LIKE     DEFN AEBONB    WQSI03           BOL Load Number
     C           *LIKE     DEFN AEE0DT    WQSI04           DSH Kill Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
     C                     KFLD           WQSI03           BOL Load Number
     C                     KFLD           WQSI04           DSH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSI01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSI02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSI03           BOL Load Number
     C                     Z-ADDP1B0DT    WQSI04           DSH Kill Date
      * Establish starting position
     C           KRSSI     SETLL@AECPI5                    *
     C           KRSSI     READE@AECPI5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1028' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0006           DSD Farm Site C
     C                     Z-ADD*ZERO     #1OXNB           DSD Movement Nu
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAEH1A1    YL0006           DSD Farm Site C
     C                     Z-ADDAEH3A1    #1OXNB           DSD Movement Nu
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@AECPI5                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Movement Number   RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSJ03           BOL Load Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQSJ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSJ03           BOL Load Number
      * Establish starting position
     C           KRSSJ     SETLL@AFCPI4                    *
     C           KRSSJ     READE@AFCPI4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1OXNB           DT Movement Num
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFIEA1    #1OXNB           DT Movement Num
     C           KRSSJ     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#1BDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSK     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #DBCTX           DF Description
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    #DBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Site ID/Prod Subs RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    DNHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    DNBONB           BOL Load Number
     C                     Z-ADDP1CVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSL     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    #DNYCD           PS Site ID
     C                     MOVELDNOVCD    #DOVCD           Producer Subsid
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Shipped Head      RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSM     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DLDSH           BOL Shipped Hea
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAXLDSH    #DLDSH           BOL Shipped Hea
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Desc    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WBBECD           HC Class Code
      * Setup key
     C                     MOVELA1BECD    WBBECD           HC Class Code
      * Establish starting position
     C           KRSSN     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #DBDTX           HC Description
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBDTX    #DBDTX           HC Description
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Site State/PremiseRT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVELP1ABCD    ATABCD           PD Producer Cod
     C                     MOVEL#DNYCD    ATNYCD           PS Site ID
      * Establish starting position
     C           KRSSO     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     MOVEL*BLANK    #DBGT1           PS Premises ID
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           ATAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELATT2TX    #1NZTX           PS State
     C                     MOVELATBGT1    #DBGT1           PS Premises ID
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     MOVEL*BLANK    #DBGT1           PS Premises ID
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Shipped Head      RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSP     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DLDSH           BOL Shipped Hea
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAXLDSH    #DLDSH           BOL Shipped Hea
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Def-10&Cls RT - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WUODNB           Defect Count Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQSQ02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQSQ03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQSQ04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQSQ05           TH Kill Date
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           BOH Buy Order N
     C                     KFLD           WQSQ03           BOL Load Number
     C                     KFLD           WQSQ04           TH Tattoo Numbe
     C                     KFLD           WQSQ05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSQ01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSQ02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSQ03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSQ04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSQ05           TH Kill Date
      * Establish starting position
     C           KRSSQ     SETLL@DZREX3                    *
     C           KRSSQ     READE@DZREX3                  90*
      * Data record not found
     C   90                MOVEL'PRK0738' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Defect Count Usr is One
     C           WUODNB    IFEQ 1                          *IF
     C                     MOVELDZBDCD    #DGUCD           Defect User  1
     C                     Z-ADDDZLJNB    #DF1NB           Defect HD user
     C                     MOVELDZB7SS    #DCLSS           Defect Cls User
     C                     Z-ADD2         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Two
     C           WUODNB    IFEQ 2                          *IF
     C                     MOVELDZBDCD    #DGVCD           Defect User  2
     C                     Z-ADDDZLJNB    #DFWNB           Defect HD user
     C                     MOVELDZB7SS    #DCMSS           Defect Cls User
     C                     Z-ADD3         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Three
     C           WUODNB    IFEQ 3                          *IF
     C                     MOVELDZBDCD    #DGWCD           Defect User  3
     C                     Z-ADDDZLJNB    #DFYNB           Defect HD user
     C                     MOVELDZB7SS    #DCNSS           Defect Cls User
     C                     Z-ADD4         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Four
     C           WUODNB    IFEQ 4                          *IF
     C                     MOVELDZBDCD    #DGXCD           Defect User  4
     C                     Z-ADDDZLJNB    #DFUNB           Defect HD user
     C                     MOVELDZB7SS    #DCOSS           Defect Cls User
     C                     Z-ADD5         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Five
     C           WUODNB    IFEQ 5                          *IF
     C                     MOVELDZBDCD    #DGYCD           Defect User  5
     C                     Z-ADDDZLJNB    #DO3NB           Defect HD user
     C                     MOVELDZB7SS    #DCPSS           Defect Cls User
     C                     Z-ADD6         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Six
     C           WUODNB    IFEQ 6                          *IF
     C                     MOVELDZBDCD    #DGZCD           Defect User  6
     C                     Z-ADDDZLJNB    #DO4NB           Defect HD user
     C                     MOVELDZB7SS    #DCQSS           Defect Cls User
     C                     Z-ADD7         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Seven
     C           WUODNB    IFEQ 7                          *IF
     C                     MOVELDZBDCD    #DG0CD           Defect User  7
     C                     Z-ADDDZLJNB    #DO5NB           Defect HD user
     C                     MOVELDZB7SS    #DCRSS           Defect Cls User
     C                     Z-ADD8         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Eight
     C           WUODNB    IFEQ 8                          *IF
     C                     MOVELDZBDCD    #DG1CD           Defect User  8
     C                     Z-ADDDZLJNB    #DFONB           Defect HD user
     C                     MOVELDZB7SS    #DCSSS           Defect Cls User
     C                     Z-ADD9         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Nine
     C           WUODNB    IFEQ 9                          *IF
     C                     MOVELDZBDCD    #DG2CD           Defect User  9
     C                     Z-ADDDZLJNB    #DFXNB           Defect HD user
     C                     MOVELDZB7SS    #DCTSS           Defect Cls User
     C                     Z-ADD10        WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Ten
     C           WUODNB    IFEQ 10                         *IF
     C                     MOVELDZBDCD    #DG3CD           Defect User 10
     C                     Z-ADDDZLJNB    #DFTNB           Defect HD user
     C                     MOVELDZB7SS    #DCUSS           Defect Cls User
     C                     Z-ADD11        WUODNB           Defect Count Us
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@DZREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGUCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSR     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGVCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSS     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGWCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSST     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGXCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSU     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGYCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSV     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGZCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSW     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG0CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSX     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG1CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSY     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG2CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSZ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG3CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTA     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Detail     RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2BNNB           BOH Buy Order N
     C                     KFLD           A2BONB           BOL Load Number
     C                     KFLD           A2CVNB           TH Tattoo Numbe
     C                     KFLD           A2B0DT           TH Kill Date
     C                     KFLD           A2C2NB           TD Sequence Num
      * Setup key
     C                     Z-ADD#1HMNB    A2HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A2BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A2BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A2CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A2B0DT           TH Kill Date
     C                     Z-ADD1         A2C2NB           TD Sequence Num
      * Establish starting position
     C           KRSTB     CHAIN@A2CPDG              90    *
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA2HVNB    WUHVNB           Pen Company Num
     C                     MOVELA2CMCD    #DCMCD           Pen Number
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSTC     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    #DAGTX           PD Name
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Pdctn Loc Name    RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WCABCD           PD Producer Cod
     C                     KFLD           WCAECD           PL Location Cod
      * Setup key
     C                     MOVELP1ABCD    WCABCD           PD Producer Cod
     C                     MOVELP1AECD    WCAECD           PL Location Cod
      * Establish starting position
     C           KRSTD     CHAIN@AFREAR              90    *
      * Data record not found
     C   90                MOVEL'PRK0015' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCA8TX    #DA8TX           PL Name
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Hog Class         RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WBBECD           HC Class Code
      * Setup key
     C                     MOVEL#1BECD    WBBECD           HC Class Code
      * Establish starting position
     C           KRSTE     CHAIN@A8REDA              90    *
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBDTX    #DBDTX           HC Description
     C                     MOVELWBBXST    WUBXST           HC Defect Requi
     C                     MOVELWBBYST    WUBYST           HC Price Requir
     C                     MOVELWBBITX    WUBITX           HC Resolution
     C                     MOVELWBB0ST    WUB0ST           HC Qualificatio
     C                     MOVELWBFBST    WULLST           HC Class Type
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Site State ActOnlyRT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVELP1ABCD    ATABCD           PD Producer Cod
     C                     MOVEL#DNYCD    ATNYCD           PS Site ID
      * Establish starting position
     C           KRSTF     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           ATAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELATT2TX    #1NZTX           PS State
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv PrdSiteMil CoMilStRT - Producer Site Mileage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           ASABCD           PD Producer Cod
     C                     KFLD           ASNYCD           PS Site ID
     C                     KFLD           ASLKA1           PSM Company Num
      * Setup key
     C                     MOVELP1ABCD    ASABCD           PD Producer Cod
     C                     MOVEL#DNYCD    ASNYCD           PS Site ID
     C                     Z-ADDP1HMNB    ASLKA1           PSM Company Num
      * Establish starting position
     C           KRSTG     CHAIN@ASREK9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0008           PSM Miles to Co
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Site State ActOnlyRT - Producer Site  * 
     C                     EXSR THRVGN
      * PAR = DB1 By name
     C                     Z-ADDASLLA1    YL0008           PSM Miles to Co
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Site State ActOnlyRT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVELASABCD    ATABCD           PD Producer Cod
     C                     MOVELASNYCD    ATNYCD           PS Site ID
      * Establish starting position
     C           KRSTH     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           ATAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELATT2TX    #1NZTX           PS State
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Val ProdSubsidiary    RT - Producer Subsidiary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WDABCD           PD Producer Cod
     C                     KFLD           WDOVCD           Producer Subsid
      * Setup key
     C                     MOVELP1ABCD    WDABCD           PD Producer Cod
     C                     MOVEL#DOVCD    WDOVCD           Producer Subsid
      * Establish starting position
     C           KRSTI     CHAIN@A8REPM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1213' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WDAJST    IFEQ 'A'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTJ01           DF Defect Code
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           DF Defect Code
      * Setup key
     C                     MOVEL#DGUCD    WQTJ01           DF Defect Code
      * Establish starting position
     C           KRSTJ     SETLL@A7REMM                    *
     C           KRSTJ     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCLSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCLSS           DF Classificati
     C           KRSTJ     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTK01           DF Defect Code
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           DF Defect Code
      * Setup key
     C                     MOVEL#DGVCD    WQTK01           DF Defect Code
      * Establish starting position
     C           KRSTK     SETLL@A7REMM                    *
     C           KRSTK     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCMSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCMSS           DF Classificati
     C           KRSTK     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTL01           DF Defect Code
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           DF Defect Code
      * Setup key
     C                     MOVEL#DGWCD    WQTL01           DF Defect Code
      * Establish starting position
     C           KRSTL     SETLL@A7REMM                    *
     C           KRSTL     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCNSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCNSS           DF Classificati
     C           KRSTL     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTM01           DF Defect Code
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           DF Defect Code
      * Setup key
     C                     MOVEL#DGXCD    WQTM01           DF Defect Code
      * Establish starting position
     C           KRSTM     SETLL@A7REMM                    *
     C           KRSTM     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCOSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCOSS           DF Classificati
     C           KRSTM     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTN01           DF Defect Code
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           DF Defect Code
      * Setup key
     C                     MOVEL#DGYCD    WQTN01           DF Defect Code
      * Establish starting position
     C           KRSTN     SETLL@A7REMM                    *
     C           KRSTN     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCPSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCPSS           DF Classificati
     C           KRSTN     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTO01           DF Defect Code
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           DF Defect Code
      * Setup key
     C                     MOVEL#DGZCD    WQTO01           DF Defect Code
      * Establish starting position
     C           KRSTO     SETLL@A7REMM                    *
     C           KRSTO     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCQSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCQSS           DF Classificati
     C           KRSTO     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTP01           DF Defect Code
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           DF Defect Code
      * Setup key
     C                     MOVEL#DG0CD    WQTP01           DF Defect Code
      * Establish starting position
     C           KRSTP     SETLL@A7REMM                    *
     C           KRSTP     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCRSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCRSS           DF Classificati
     C           KRSTP     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTQ01           DF Defect Code
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           DF Defect Code
      * Setup key
     C                     MOVEL#DG1CD    WQTQ01           DF Defect Code
      * Establish starting position
     C           KRSTQ     SETLL@A7REMM                    *
     C           KRSTQ     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCSSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCSSS           DF Classificati
     C           KRSTQ     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTR01           DF Defect Code
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           DF Defect Code
      * Setup key
     C                     MOVEL#DG2CD    WQTR01           DF Defect Code
      * Establish starting position
     C           KRSTR     SETLL@A7REMM                    *
     C           KRSTR     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCTSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCTSS           DF Classificati
     C           KRSTR     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTS01           DF Defect Code
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           DF Defect Code
      * Setup key
     C                     MOVEL#DG3CD    WQTS01           DF Defect Code
      * Establish starting position
     C           KRSTS     SETLL@A7REMM                    *
     C           KRSTS     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCUSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCUSS           DF Classificati
     C           KRSTS     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Rtv EDI Trading Prt#  RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSTT     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUGJNB           PD EDI Trading
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGJNB    WUGJNB           PD EDI Trading
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGUCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTU     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGVCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTV     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGWCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTW     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGXCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTX     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGYCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTY     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGZCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTZ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * get defects/hd
      *================================================================
     C                     MOVEL'Y'       WUL9ST           Display Output
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     MOVEL*BLANK    #DGUCD           Defect User  1
     C                     MOVEL*BLANK    #DGVCD           Defect User  2
     C                     MOVEL*BLANK    #DGWCD           Defect User  3
     C                     MOVEL*BLANK    #DGXCD           Defect User  4
     C                     MOVEL*BLANK    #DGYCD           Defect User  5
     C                     MOVEL*BLANK    #DGZCD           Defect User  6
     C                     MOVEL*BLANK    #DG0CD           Defect User  7
     C                     MOVEL*BLANK    #DG1CD           Defect User  8
     C                     MOVEL*BLANK    #DG2CD           Defect User  9
     C                     MOVEL*BLANK    #DG3CD           Defect User 10
     C                     Z-ADD*ZERO     #DF1NB           Defect HD user
     C                     Z-ADD*ZERO     #DFWNB           Defect HD user
     C                     Z-ADD*ZERO     #DFYNB           Defect HD user
     C                     Z-ADD*ZERO     #DFUNB           Defect HD user
     C                     Z-ADD*ZERO     #DO3NB           Defect HD user
     C                     Z-ADD*ZERO     #DO4NB           Defect HD user
     C                     Z-ADD*ZERO     #DO5NB           Defect HD user
     C                     Z-ADD*ZERO     #DFONB           Defect HD user
     C                     Z-ADD*ZERO     #DFXNB           Defect HD user
     C                     Z-ADD*ZERO     #DFTNB           Defect HD user
      * Rtv Tattoo Def-10&Cls RT - Tattoo Defect  * 
     C                     EXSR SFRVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Hog Class Type is Subject
      *   |- c2    : DTL.TH Source Type is External
      *   '-
     C           #1LLST    IFEQ 'S'                        *IF
     C           #1KAST    OREQ 'E'                        *OR
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get Defect/Hd
      *================================================================
     C                     MOVEL*BLANK    #DGUCD           Defect User  1
     C                     MOVEL*BLANK    #DGVCD           Defect User  2
     C                     MOVEL*BLANK    #DGWCD           Defect User  3
     C                     MOVEL*BLANK    #DGXCD           Defect User  4
     C                     MOVEL*BLANK    #DGYCD           Defect User  5
     C                     MOVEL*BLANK    #DGZCD           Defect User  6
     C                     MOVEL*BLANK    #DG0CD           Defect User  7
     C                     MOVEL*BLANK    #DG1CD           Defect User  8
     C                     MOVEL*BLANK    #DG2CD           Defect User  9
     C                     MOVEL*BLANK    #DG3CD           Defect User 10
     C                     Z-ADD*ZERO     #DF1NB           Defect HD user
     C                     Z-ADD*ZERO     #DFWNB           Defect HD user
     C                     Z-ADD*ZERO     #DFYNB           Defect HD user
     C                     Z-ADD*ZERO     #DFUNB           Defect HD user
     C                     Z-ADD*ZERO     #DO3NB           Defect HD user
     C                     Z-ADD*ZERO     #DO4NB           Defect HD user
     C                     Z-ADD*ZERO     #DO5NB           Defect HD user
     C                     Z-ADD*ZERO     #DFONB           Defect HD user
     C                     Z-ADD*ZERO     #DFXNB           Defect HD user
     C                     Z-ADD*ZERO     #DFTNB           Defect HD user
      * Rtv Tattoo Def-10&Cls RT - Tattoo Defect  * 
     C                     EXSR SQRVGN
      * CASE: DTL.TH Hog Class Type is Not Market
     C           #1LLST    IFEQ 'R'                        *IF
     C           #1LLST    OREQ 'S'
      * If Resale/internal
      * CASE: WRK.@Status Internal (Y/N) is Yes
     C           WUKPST    IFEQ 'Y'                        *IF
      * Chk Def Scale Wt Req  IF
      * If any defect has scale weight required, quit checking the defect
     C                     MOVEL'N'       WUR3ST           Scale Wt Requir
      * CASE: PAR.Defect User  1 NE WRK.Blank USR
     C           #DGUCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SRRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  2 NE WRK.Blank USR
     C           #DGVCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SSRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  3 NE WRK.Blank USR
     C           #DGWCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR STRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  4 NE WRK.Blank USR
     C           #DGXCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SURVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  5 NE WRK.Blank USR
     C           #DGYCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SVRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  6 NE WRK.Blank USR
     C           #DGZCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SWRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  7 NE WRK.Blank USR
     C           #DG0CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SXRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  8 NE WRK.Blank USR
     C           #DG1CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SYRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  9 NE WRK.Blank USR
     C           #DG2CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SZRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User 10 NE WRK.Blank USR
     C           #DG3CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TARVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * If Defect Scale Wgt Req dont calc TH Head Received
      * CASE: WRK.Scale Wt Required     USR is Yes
     C           WUR3ST    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     #DB5NB           Head Total USR
     C                     MOVEL*BLANK    #DCMCD           Pen Number
     C                     MOVEL*BLANK    WUCBCD           Pen Usr
     C                     ELSE
      * CASE: *OTHERWISE
      * Rsl/Int-- Sum Defect head
      * DTL.Head Total USR =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10)
      * x1    : DTL.Defect HD user 1
      * +     : PGM.*Synon (17,7) work field
      * x2    : DTL.Defect HD user 2
      * +     : PGM.*Synon (17,7) work field
      * x3    : DTL.Defect HD user 3
      * +     : PGM.*Synon (17,7) work field
      * x4    : DTL.Defect HD user 4
      * +     : PGM.*Synon (17,7) work field
      * x5    : DTL.Defect HD user 5
      * +     : PGM.*Synon (17,7) work field
      * x6    : DTL.Defect HD user 6
      * +     : PGM.*Synon (17,7) work field
      * x7    : DTL.Defect HD user 7
      * +     : PGM.*Synon (17,7) work field
      * x8    : DTL.Defect HD user 8
      * +     : PGM.*Synon (17,7) work field
      * x9    : DTL.Defect HD user 9
      * +     : PGM.*Synon (17,7) work field
      * x10   : DTL.Defect HD user 10
     C           #DF1NB    ADD  #DFWNB    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  #DFYNB    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  #DFUNB    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  #DO3NB    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  #DO4NB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  #DO5NB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  #DFONB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  #DFXNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  #DFTNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    #DB5NB           Head Total USR
      * Rtv Pen
      * Rtv Tattoo Detail     RT - Tattoo Detail  * 
     C                     EXSR TBRVGN
     C                     MOVEL#DCMCD    WUCBCD           Pen Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * F4  on Defects
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  1
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGUCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGUCD    PARM #DGUCD    WQ0081  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9947  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  2
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGVCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGVCD    PARM #DGVCD    WQ0082  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9949  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  3
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGWCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGWCD    PARM #DGWCD    WQ0083  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9951  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  4
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGXCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGXCD    PARM #DGXCD    WQ0084  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9953  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  5
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGYCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGYCD    PARM #DGYCD    WQ0085  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9955  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  6
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGZCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGZCD    PARM #DGZCD    WQ0086  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9957  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  7
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DG0CD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DG0CD    PARM #DG0CD    WQ0087  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9959  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  8
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DG1CD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DG1CD    PARM #DG1CD    WQ0088  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9961  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  9
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DG2CD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DG2CD    PARM #DG2CD    WQ0089  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9963  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User 10
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DG3CD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DG3CD    PARM #DG3CD    WQ0090  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9965  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * validation of Defects
      *================================================================
      * Validate Class Type
     C                     EXSR UESUBR                     Validate Class
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Validate Class Type
      *================================================================
      * val 1
      * CASE: DTL.Defect User  1 is Entered
     C           #DGUCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGUCD    PARM #DGUCD    WQ0108  6        DF Defect Code
     C           #DCLSS    PARM #DCLSS    WQ0109  1        DF Classificati
     C                     PARM #1LLST    WQ0110  1        TH Hog Class Ty
     C           YL0010    PARM *BLANK    WQ0111  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9947  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0010    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0029           TH Hog Class Ty
     C                     MOVEL#DGUCD    ZA0030           Defect User  1
     C                     MOVEL#DCLSS    ZA0031           Class Df 1 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 2
      * CASE: DTL.Defect User  2 is Entered
     C           #DGVCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGVCD    PARM #DGVCD    WQ0112  6        DF Defect Code
     C           #DCMSS    PARM #DCMSS    WQ0113  1        DF Classificati
     C                     PARM #1LLST    WQ0114  1        TH Hog Class Ty
     C           YL0010    PARM *BLANK    WQ0115  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9949  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0010    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0032           TH Hog Class Ty
     C                     MOVEL#DGVCD    ZA0033           Defect User  2
     C                     MOVEL#DCMSS    ZA0034           Class Df 2 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 3
      * CASE: DTL.Defect User  3 is Entered
     C           #DGWCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGWCD    PARM #DGWCD    WQ0116  6        DF Defect Code
     C           #DCNSS    PARM #DCNSS    WQ0117  1        DF Classificati
     C                     PARM #1LLST    WQ0118  1        TH Hog Class Ty
     C           YL0010    PARM *BLANK    WQ0119  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9951  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0010    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0035           TH Hog Class Ty
     C                     MOVEL#DGWCD    ZA0036           Defect User  3
     C                     MOVEL#DCNSS    ZA0037           Class Df 3 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 4
      * CASE: DTL.Defect User  4 is Entered
     C           #DGXCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGXCD    PARM #DGXCD    WQ0120  6        DF Defect Code
     C           #DCOSS    PARM #DCOSS    WQ0121  1        DF Classificati
     C                     PARM #1LLST    WQ0122  1        TH Hog Class Ty
     C           YL0010    PARM *BLANK    WQ0123  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9953  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0010    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0038           TH Hog Class Ty
     C                     MOVEL#DGXCD    ZA0039           Defect User  4
     C                     MOVEL#DCOSS    ZA0040           Class Df 4 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 5
      * CASE: DTL.Defect User  5 is Entered
     C           #DGYCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGYCD    PARM #DGYCD    WQ0124  6        DF Defect Code
     C           #DCPSS    PARM #DCPSS    WQ0125  1        DF Classificati
     C                     PARM #1LLST    WQ0126  1        TH Hog Class Ty
     C           YL0010    PARM *BLANK    WQ0127  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9955  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0010    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0041           TH Hog Class Ty
     C                     MOVEL#DGYCD    ZA0042           Defect User  5
     C                     MOVEL#DCPSS    ZA0043           Class Df 5 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9955  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 6
      * CASE: DTL.Defect User  6 is Entered
     C           #DGZCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGZCD    PARM #DGZCD    WQ0128  6        DF Defect Code
     C           #DCQSS    PARM #DCQSS    WQ0129  1        DF Classificati
     C                     PARM #1LLST    WQ0130  1        TH Hog Class Ty
     C           YL0010    PARM *BLANK    WQ0131  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9957  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0010    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0044           TH Hog Class Ty
     C                     MOVEL#DGZCD    ZA0045           Defect User  6
     C                     MOVEL#DCQSS    ZA0046           Class Df 6 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 7
      * CASE: DTL.Defect User  7 is Entered
     C           #DG0CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG0CD    PARM #DG0CD    WQ0132  6        DF Defect Code
     C           #DCRSS    PARM #DCRSS    WQ0133  1        DF Classificati
     C                     PARM #1LLST    WQ0134  1        TH Hog Class Ty
     C           YL0010    PARM *BLANK    WQ0135  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9959  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0010    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0047           TH Hog Class Ty
     C                     MOVEL#DG0CD    ZA0048           Defect User  7
     C                     MOVEL#DCRSS    ZA0049           Class Df 7 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9959  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 8
      * CASE: DTL.Defect User  8 is Entered
     C           #DG1CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG1CD    PARM #DG1CD    WQ0136  6        DF Defect Code
     C           #DCSSS    PARM #DCSSS    WQ0137  1        DF Classificati
     C                     PARM #1LLST    WQ0138  1        TH Hog Class Ty
     C           YL0010    PARM *BLANK    WQ0139  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9961  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0010    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0050           TH Hog Class Ty
     C                     MOVEL#DG1CD    ZA0051           Defect User  8
     C                     MOVEL#DCSSS    ZA0052           Class Df 8 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9961  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 9
      * CASE: DTL.Defect User  9 is Entered
     C           #DG2CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG2CD    PARM #DG2CD    WQ0140  6        DF Defect Code
     C           #DCTSS    PARM #DCTSS    WQ0141  1        DF Classificati
     C                     PARM #1LLST    WQ0142  1        TH Hog Class Ty
     C           YL0010    PARM *BLANK    WQ0143  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9963  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0010    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0053           TH Hog Class Ty
     C                     MOVEL#DG2CD    ZA0054           Defect User  9
     C                     MOVEL#DCTSS    ZA0055           Class Df 9 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9963  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 10
      * CASE: DTL.Defect User 10 is Entered
     C           #DG3CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG3CD    PARM #DG3CD    WQ0144  6        DF Defect Code
     C           #DCUSS    PARM #DCUSS    WQ0145  1        DF Classificati
     C                     PARM #1LLST    WQ0146  1        TH Hog Class Ty
     C           YL0010    PARM *BLANK    WQ0147  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9965  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0010    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0056           TH Hog Class Ty
     C                     MOVEL#DG3CD    ZA0057           Defect User 10
     C                     MOVEL#DCUSS    ZA0058           Class Df 10 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9965  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Mtech
      *================================================================
      * Mtech Live Yes or no
      * E2423 Update the Buy Order Load movement if internal
      * and the tattoo has a movement number but the buy order load does
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0167  30       BOH Company Num
     C                     PARM @CN,002   WQ0168 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0169 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0012           MTech Live Yes
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Modificaitons and Comments
      *================================================================
      * E10812 JJH 01/22/18 - Market Hog Order to Cash
      * - Update the Movement Number in the Buy Order Load, If
      *   - Producer's HSP Autamation Flag = Y, and
      *   - External Hog
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Mtech
      *================================================================
      * Mtech Live Yes or no
      * E2423 Update the Buy Order Load movement if internal
      * and the tattoo has a movement number find out if the buy ordere l
      * needs to get updated as well
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0248  30       BOH Company Num
     C                     PARM @CN,002   WQ0249 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0250 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0023           MTech Live Yes
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UIRVGN    BEGSR
      *================================================================
      * Upd Movement Number   RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSUI     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSUI     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Movement# Bol     CO - Buy Order Load  * 
     C                     EXSR UJCHRC
     C                     ENDIF
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJCHRC    BEGSR
      *================================================================
      * Chg Movement# Bol     CO - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0981  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0982  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0983  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0984  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0985  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0986  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0987  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0988  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0989  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0990  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0991  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0992  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0993  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0994  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0995  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0996  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0997 11        BOL Trailer
     C                     MOVEL*BLANK    WN0998  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0999  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN1000  1        BOL Truck Scale
     C                     Z-ADD*ZERO     WN1001  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN1002  1        Reported to USD
     C                     MOVEL*BLANK    WN1003  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN1004  1        BOL Violated Au
     C                     MOVEL*BLANK    WN1005  2        BOL Status 5
     C                     MOVEL*BLANK    WN1006  2        BOL Status 6
     C                     MOVEL*BLANK    WN1007  3        BOL Status 7
     C                     Z-ADD*ZERO     WN1008  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN1009  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN1010  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN1011  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN1012 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN1013 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN1014 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN1015 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN1016 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN1017  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN1018  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN1019  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN1020  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN1021  70       BOL Unused Date
     C                     MOVEL*BLANK    WN1022  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN1023  6        PD Producer Cod
     C                     MOVEL*BLANK    WN1024  6        PL Location Cod
     C                     MOVEL*BLANK    WN1025 10        RS User Changed
     C                     Z-ADD*ZERO     WN1026  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1027  60       RS Time Changed
     C                     MOVEL*BLANK    WN1028  1        RS Record Statu
     C                     MOVEL*BLANK    WN1029 10        RS Job
     C                     MOVEL*BLANK    WN1030 10        RS Program
     C                     MOVEL*BLANK    WN1031 10        RS User Added
     C                     Z-ADD*ZERO     WN1032  70       RS Date Added
     C                     Z-ADD*ZERO     WN1033  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y3RDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDP1HMNB    WKHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WKBONB           BOL Load Number
      *
     C           KLCHUJ    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHUJ    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL032.
     C                     MOVEL'LBL032'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO UJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO UJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    Y3RDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADD#1OXNB    WKJKRU           BOL HPS Movemen
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE Y3RDCS
     C           Y3RDC     ANDNE'N'
     C                     MOVE 'Y'       Y3RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y3RDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKRVGN    BEGSR
      *================================================================
      * Upd Movement Number   RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWHONB    WQUK01           CC Company Numb
     C           *LIKE     DEFN WWHMNB    WQUK02           BOH Company Num
     C           *LIKE     DEFN WWBNNB    WQUK03           BOH Buy Order N
     C           *LIKE     DEFN WWBONB    WQUK04           BOL Load Number
     C           *LIKE     DEFN WWE0DT    WQUK05           DSH Kill Date
      * Define keylist
     C           KRSUK     KLIST
     C                     KFLD           WQUK01           CC Company Numb
     C                     KFLD           WQUK02           BOH Company Num
     C                     KFLD           WQUK03           BOH Buy Order N
     C                     KFLD           WQUK04           BOL Load Number
     C                     KFLD           WQUK05           DSH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQUK01           CC Company Numb
     C                     Z-ADDP1HMNB    WQUK02           BOH Company Num
     C                     Z-ADDP1BNNB    WQUK03           BOH Buy Order N
     C                     Z-ADDP1BONB    WQUK04           BOL Load Number
     C                     Z-ADDP1B0DT    WQUK05           DSH Kill Date
      * Establish starting position
     C           KRSUK     SETLL@AECPP1                    *
     C           KRSUK     READE@AECPP1                  90*
      * Data record not found
     C   90                MOVEL'PRK1028' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Movement Number   CH - Delivery Sched Detail  * 
     C                     EXSR ULCHRC
     C           KRSUK     READE@AECPP1                  90*
     C                     ENDDO
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULCHRC    BEGSR
      *================================================================
      * Chg Movement Number   CH - Delivery Sched Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1034  20       DSD Scheduled H
     C                     Z-ADD*ZERO     WN1035  50       DSD Farm Site C
     C                     MOVEL*BLANK    WN1036  5        DSD Building
     C                     MOVEL*BLANK    WN1037  5        DSD Room
     C                     MOVEL*BLANK    WN1038  5        DSD Sire Line C
     C                     MOVEL*BLANK    WN1039  7        DSD Hog Group C
     C                     Z-ADD*ZERO     WN1040  30       DSD Unused Head
     C                     Z-ADD*ZERO     WN1041  30       DSD Scheduled D
     C                     Z-ADD*ZERO     WN1042  30       DSD Scheduled K
     C                     MOVEL*BLANK    WN1043  5        DSD Transportat
     C                     MOVEL*BLANK    WN1044  5        DSD Trucker Cod
     C                     MOVEL*BLANK    WN1045  5        DSD Driver
     C                     MOVEL*BLANK    WN1046  5        DSD Loading Cre
     C                     MOVEL*BLANK    WN1047  6        CHR Code
     C                     MOVEL*BLANK    WN1048  2        DSD Load Type
     C                     MOVEL*BLANK    WN1049  1        DSD Full/Split
     C                     MOVEL*BLANK    WN1050 15        DSD Truck ID
     C                     MOVEL*BLANK    WN1051 15        DSD Trailer ID
     C                     MOVEL*BLANK    WN1052  1        DSD Movement Pr
     C                     MOVEL*BLANK    WN1053  1        DSD Sched Route
     C                     Z-ADD*ZERO     WN1054  70       DSD Sched Route
     C                     Z-ADD*ZERO     WN1055  40       DSD Sched Route
     C                     Z-ADD*ZERO     WN1056  70       DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WN1057  40       DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WN1058  70       DSD Sch Start L
     C                     Z-ADD*ZERO     WN1059  40       DSD Sch Start L
     C                     MOVEL*BLANK    WN1060  1        DSD Receiving S
     C                     MOVEL*BLANK    WN1061  1        DSD Kill Shift
     C                     MOVEL*BLANK    WN1062  1        DSD BOL Kill Sh
     C                     MOVEL*BLANK    WN1063  1        DSD HPS Post St
     C                     MOVEL*BLANK    WN1064  1        DSD HPE Post St
     C                     MOVEL*BLANK    WN1065  1        DSD Lock Status
     C                     MOVEL*BLANK    WN1066  1        DSD Source Type
     C                     MOVEL*BLANK    WN1067  4        DSD Transfer St
     C                     Z-ADD*ZERO     WN1068  70       DSD Unused Date
     C                     Z-ADD*ZERO     WN1069  40       DSD Unused Time
     C                     MOVEL*BLANK    WN1070  3        SR Source Code
     C                     MOVEL*BLANK    WN1071  6        PD Producer Cod
     C                     MOVEL*BLANK    WN1072  6        PL Location Cod
     C                     Z-ADD*ZERO     WN1073  30       BOH Company Num
     C                     Z-ADD*ZERO     WN1074  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN1075  50       BOL Load Number
     C                     Z-ADD*ZERO     WN1076 100       DSD PRD Srv Bat
     C                     Z-ADD*ZERO     WN1077 100       DSD PRD Srv Sch
     C                     MOVEL*BLANK    WN1078 10        DSD Ref 1
     C                     MOVEL*BLANK    WN1079 10        DSD Ref 2
     C                     MOVEL*BLANK    WN1080  2        DSD Ref Status
     C                     MOVEL*BLANK    WN1081 10        RS User Changed
     C                     Z-ADD*ZERO     WN1082  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1083  60       RS Time Changed
     C                     MOVEL*BLANK    WN1084  1        RS Record Statu
     C                     MOVEL*BLANK    WN1085 10        RS Job
     C                     MOVEL*BLANK    WN1086 10        RS Program
     C                     MOVEL*BLANK    WN1087 10        RS User Added
     C                     Z-ADD*ZERO     WN1088  70       RS Date Added
     C                     Z-ADD*ZERO     WN1089  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y4RDC   1
      *
      * Move key fields to @AECPIH
     C                     Z-ADDWWHONB    WMHONB           CC Company Numb
     C                     Z-ADDWWE0DT    WME0DT           DSH Kill Date
     C                     Z-ADDWWE6DT    WME6DT           DSD Delivery Da
     C                     Z-ADDWWAGTH    WMAGTH           DSD Delivery Ti
     C                     Z-ADDWWHZA1    WMHZA1           DSD Delivery Ti
      *
     C           KLCHUL    KLIST
     C                     KFLD           WMHONB           CC Company Numb
     C                     KFLD           WME0DT           DSH Kill Date
     C                     KFLD           WME6DT           DSD Delivery Da
     C                     KFLD           WMAGTH           DSD Delivery Ti
     C                     KFLD           WMHZA1           DSD Delivery Ti
     C           KLCHUL    CHAIN@AECPIH              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAECPL1'MDACP
     C                     MOVEL'@AECPIH' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL033.
     C                     MOVEL'LBL033'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO ULEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO ULEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAE1    Y4RDCS
      * Move non-key fields to @AECPIH
     C                     Z-ADD#1OXNB    WMH3A1           DSD Movement Nu
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE Y4RDCS
     C           Y4RDC     ANDNE'N'
     C                     MOVE 'Y'       Y4RDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WMAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WMAADT    PARM *ZERO     WQ0421  70       *DATE
     C           WMAMTM    PARM *ZERO     WQ0422  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE Y4RDCS
     C           Y4RDC     ANDNE'N'
     C                     MOVE 'Y'       Y4RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y4RDC     IFEQ 'Y'
     C                     UPDAT@AECPIH                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAECPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMRVGN    BEGSR
      *================================================================
      * Upd Movment Number - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXHMNB    WQUM01           BOH Company Num
     C           *LIKE     DEFN WXBNNB    WQUM02           BOH Buy Order N
     C           *LIKE     DEFN WXBONB    WQUM03           BOL Load Number
     C           *LIKE     DEFN WXB0DT    WQUM04           TH Kill Date
      * Define keylist
     C           KRSUM     KLIST
     C                     KFLD           WQUM01           BOH Company Num
     C                     KFLD           WQUM02           BOH Buy Order N
     C                     KFLD           WQUM03           BOL Load Number
     C                     KFLD           WQUM04           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQUM01           BOH Company Num
     C                     Z-ADDP1BNNB    WQUM02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQUM03           BOL Load Number
     C                     Z-ADDP1B0DT    WQUM04           TH Kill Date
      * Establish starting position
     C           KRSUM     SETLL@A1CPOC                    *
     C           KRSUM     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.TH HPS Movement Ref # NE DB1.TH HPS Movement Ref #
     C           #1OXNB    IFNE WXOXNB                     *IF
      * Chg Movement #        CH - Tattoo Header  * 
     C                     EXSR UNCHRC
     C                     END                             *FI
     C           KRSUM     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNCHRC    BEGSR
      *================================================================
      * Chg Movement #        CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1090  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN1091 10        TH Group Refere
     C                     MOVEL*BLANK    WN1092  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN1093  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN1094  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN1095  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN1096  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN1097  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN1098  70       TH Pricing Date
     C                     MOVEL*BLANK    WN1099  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN1100  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN1101  50       TH Head Receive
     C                     Z-ADD*ZERO     WN1102  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN1103  50       TH Held Over
     C                     Z-ADD*ZERO     WN1104  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN1105  50       TH Head Killed
     C                     Z-ADD*ZERO     WN1106  50       TH Head Adds
     C                     Z-ADD*ZERO     WN1107  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN1108  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN1109  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN1110  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN1111  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN1112  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN1113  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN1114  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN1115  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN1116  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN1117  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN1118  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN1119  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN1120  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN1121  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN1122  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN1123  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN1124  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN1125  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN1126  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN1127  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN1128  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN1129  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN1130  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN1131  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN1132  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN1133  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN1134  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN1135  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN1136  72       TH Additions Am
     C                     Z-ADD*ZERO     WN1137  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN1138  72       Th Payment Net
     C                     Z-ADD*ZERO     WN1139  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN1140  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN1141  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN1142  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN1143  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN1144  2        TH Payment Sts
     C                     MOVEL*BLANK    WN1145  1        TH Header Error
     C                     MOVEL*BLANK    WN1146  1        TH Detail Error
     C                     MOVEL*BLANK    WN1147  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN1148  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN1149  80       TH Commission A
     C                     Z-ADD*ZERO     WN1150  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN1151  1        TH User Error O
     C                     MOVEL*BLANK    WN1152  1        TH Held Over Re
     C                     MOVEL*BLANK    WN1153  1        TH Sex
     C                     Z-ADD*ZERO     WN1154  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN1155  70       TH Commission P
     C                     Z-ADD*ZERO     WN1156  70       TH Actual Check
     C                     Z-ADD*ZERO     WN1157  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN1158  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN1159  31       TH FFLI
     C                     Z-ADD*ZERO     WN1160  72       TH Kill Product
     C                     Z-ADD*ZERO     WN1161  72       TH Cut Product
     C                     Z-ADD*ZERO     WN1162  72       TH Render Produ
     C                     Z-ADD*ZERO     WN1163  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN1164  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN1165  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN1166  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN1167  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN1168  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN1169  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN1170  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN1171  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN1172  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1173  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1174  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN1175  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN1176  1        TH Source Type
     C                     MOVEL*BLANK    WN1177  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN1178  1        TH Payment Type
     C                     MOVEL*BLANK    WN1179  3        TH Source Code
     C                     MOVEL*BLANK    WN1180  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN1181  1        TH Posted to HP
     C                     MOVEL*BLANK    WN1182  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN1183  1        TH Shift Held O
     C                     MOVEL*BLANK    WN1184  3        TH State
     C                     MOVEL*BLANK    WN1185  3        TH Unused Code
     C                     MOVEL*BLANK    WN1186  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1187  1        TH Commission S
     C                     MOVEL*BLANK    WN1188  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN1189  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN1190  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN1191  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN1192  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN1193  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN1194  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN1195  50       TH Head Identif
     C                     Z-ADD*ZERO     WN1196  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN1197  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN1198  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN1199  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN1200  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN1201  3        TH PHA Average
     C                     MOVEL*BLANK    WN1202  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN1203  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN1204  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN1205  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN1206  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN1207  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN1208  50       TH Broken Back
     C                     Z-ADD*ZERO     WN1209  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN1210  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN1211  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN1212  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN1213  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN1214  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN1215 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN1216 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1217 112       TH Break Even P
     C                     Z-ADD*ZERO     WN1218 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN1219  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN1220  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN1221  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN1222  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN1223  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN1224  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN1225  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1226  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN1227  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1228  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1229  70       TH Head LFT
     C                     Z-ADD*ZERO     WN1230  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN1231  70       TH Unused Date
     C                     MOVEL*BLANK    WN1232  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN1233  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1234  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN1235  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN1236  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN1237  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN1238  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN1239  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN1240  6        DF Defect Code
     C                     MOVEL*BLANK    WN1241  6        THP Process Cod
     C                     MOVEL*BLANK    WN1242  6        PD Producer Cod
     C                     MOVEL*BLANK    WN1243  6        PL Location Cod
     C                     MOVEL*BLANK    WN1244  3        HB Buyer Code
     C                     MOVEL*BLANK    WN1245  5        GN Genetic Code
     C                     MOVEL*BLANK    WN1246  3        HC Class Code
     C                     MOVEL*BLANK    WN1247 10        RS User Changed
     C                     Z-ADD*ZERO     WN1248  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1249  60       RS Time Changed
     C                     MOVEL*BLANK    WN1250  1        RS Record Statu
     C                     MOVEL*BLANK    WN1251 10        RS Job
     C                     MOVEL*BLANK    WN1252 10        RS Program
     C                     MOVEL*BLANK    WN1253 10        RS User Added
     C                     Z-ADD*ZERO     WN1254  70       RS Date Added
     C                     Z-ADD*ZERO     WN1255  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y5RDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWXHMNB    A1HMNB           BOH Company Num
     C                     Z-ADDWXBNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDWXBONB    A1BONB           BOL Load Number
     C                     Z-ADDWXCVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDWXB0DT    A1B0DT           TH Kill Date
      *
     C           KLCHUN    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
     C           KLCHUN    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL034.
     C                     MOVEL'LBL034'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO UNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO UNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    Y5RDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD#1OXNB    A1OXNB           TH HPS Movement
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE Y5RDCS
     C           Y5RDC     ANDNE'N'
     C                     MOVE 'Y'       Y5RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y5RDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UORVGN    BEGSR
      *================================================================
      * RTV THDR NF UnAssnPend RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSUO     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSUO     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv and UnAssigned    RT - Tattoo Pending  * 
     C                     EXSR UPRVGN
     C                     GOTO UOEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPRVGN    BEGSR
      *================================================================
      * Rtv and UnAssigned    RT - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJHONB    WQUP01           CC Company Numb
     C           *LIKE     DEFN FJHSA1    WQUP02           TP Tattoo Numbe
     C           *LIKE     DEFN FJHMNB    WQUP03           BOH Company Num
     C           *LIKE     DEFN FJBNNB    WQUP04           BOH Buy Order N
     C           *LIKE     DEFN FJBONB    WQUP05           BOL Load Number
      * Define keylist
     C           KRSUP     KLIST
     C                     KFLD           WQUP01           CC Company Numb
     C                     KFLD           WQUP02           TP Tattoo Numbe
     C                     KFLD           WQUP03           BOH Company Num
     C                     KFLD           WQUP04           BOH Buy Order N
     C                     KFLD           WQUP05           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WQUP01           CC Company Numb
     C                     Z-ADD#1CVNB    WQUP02           TP Tattoo Numbe
     C                     Z-ADD#1HMNB    WQUP03           BOH Company Num
     C                     Z-ADD#1BNNB    WQUP04           BOH Buy Order N
     C                     Z-ADD#1BONB    WQUP05           BOL Load Number
      * Establish starting position
     C           KRSUP     SETLL@FJCPKH                    *
     C           KRSUP     READE@FJCPKH                  90*
      * Data record not found
     C   90                MOVEL'PRK1012' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo UnAssigned CH - Tattoo Pending  * 
     C                     EXSR UQCHRC
     C           KRSUP     READE@FJCPKH                  90*
     C                     ENDDO
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQCHRC    BEGSR
      *================================================================
      * Chg Tattoo UnAssigned CH - Tattoo Pending  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1256  50       Employee ID
     C                     Z-ADD*ZERO     WN1257  60       TP Tattoo Creat
     C                     MOVEL*BLANK    WN1258  1        TP Alley Number
     C                     Z-ADD*ZERO     WN1259  50       Employee Number
     C                     MOVEL*BLANK    WN1260 10        RS User Changed
     C                     Z-ADD*ZERO     WN1261  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1262  60       RS Time Changed
     C                     MOVEL*BLANK    WN1263  1        RS Record Statu
     C                     MOVEL*BLANK    WN1264 10        RS Job
     C                     MOVEL*BLANK    WN1265 10        RS Program
     C                     MOVEL*BLANK    WN1266 10        RS User Added
     C                     Z-ADD*ZERO     WN1267  70       RS Date Added
     C                     Z-ADD*ZERO     WN1268  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y6RDC   1
      *
      * Move key fields to @FJCPHV
     C                     Z-ADDFJHONB    WFHONB           CC Company Numb
     C                     Z-ADDFJEZDT    WFEZDT           TP Tattoo Date
     C                     Z-ADDFJHSA1    WFHSA1           TP Tattoo Numbe
      *
     C           KLCHUQ    KLIST
     C                     KFLD           WFHONB           CC Company Numb
     C                     KFLD           WFEZDT           TP Tattoo Date
     C                     KFLD           WFHSA1           TP Tattoo Numbe
     C           KLCHUQ    CHAIN@FJCPHV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFJCPL0'MDACP
     C                     MOVEL'@FJCPHV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL035.
     C                     MOVEL'LBL035'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO UQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO UQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFJ1    Y6RDCS
      * Move non-key fields to @FJCPHV
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     MOVEL'P'       WFWQST    P      TP Tattoo Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE Y6RDCS
     C           Y6RDC     ANDNE'N'
     C                     MOVE 'Y'       Y6RDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WFAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WFAADT    PARM *ZERO     WQ0428  70       *DATE
     C           WFAMTM    PARM *ZERO     WQ0429  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE Y6RDCS
     C           Y6RDC     ANDNE'N'
     C                     MOVE 'Y'       Y6RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y6RDC     IFEQ 'Y'
     C                     UPDAT@FJCPHV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E14229 JBB 12/11/18 - Allow 960 to have Multiple Movement#
      * - Modify code to only update the Movement Number for Company 960
      *   on the Tattoo Header.  All othe rcompanies have the abillity to
      *   update the Movement Number in the Tattoo Header, Delivery
      *   Tracking, Delivery Sched Detail, and Buy Order Load files. Thes
      *   modifications will be made in the "Chg Tattoo Header,Pen IF"
      *   function.
      * E10812 slm 12/11/18 - This is updating all of the
      * tattoo numbers on this load with 1 movement number
      * E10812 JJH 01/22/18 - Market Hog Order to Cash
      * - Update the Movement Number in the Buy Order Load, If
      *   - Producer's HSP Autamation Flag = Y, and
      *   - External Hog
      * E11249 JJH 08/29/17 - Producer Site Sync 960 961
      * - If Producer Site Mileage Required = Yes, then display and allow
      *   SELRCD based on Producer Site Mileage.
      * - SNDERRMSG if a user selects a Producer Site that does not have
      *  a Producer Site Mileage record for the Tattoo Header's Company
      * R10369 JJH 08/24/17 - Producer Site Sync 960 961
      * - If Tattoo Header Source Code = TO, then use the Producer Site
      *   SELRCD over the Producer Site Mileage file.
      * E10370 JJH 06/27/17 - Producer Site Mileage for Source Type = TO
      * - Do not perform logic for TH Hog Class Type = Not Resale, if the
      *   Source Type = TO.
      * - This will prevent of error with a Missing State because Produce
      *   Site Mileage is not required with Source Type = TO.
      * E10370 JJH 06/22/17 - Select Record logic for Producer Site
      * - If SR Source Code = TO - Triumph Member (Owner), call SELRCD
      *     PLGKSRR - Without Company Code, otherwise
      * - Call SELRCD PLFQSRR (with Company Code)
      * 05/16/17 Add company to the Producer Std Ded/add and also
      * to the Producer location Std Ded/add and also
      * E3814 JJH 10/07/15 - Display PS Premises ID when the PS Site ID
      *   exists.
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *   length from 5 to 7.
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Modification History Created IS 061308 slm
      *================================================================
      * ***** Change log
      * PK0495 12/12/02  1) Remove ref/upd of the Group Reference Code US
      * 2) Update"Delivered Head"in the Delivery Tracking with "Load Head
      * 3) Group Ref is Optional on the screen now. May be used f/ EXT.
      * *****
      * 8/7/03 RMC Per Jancie - dont default BOL Shipped Head
      * *****
      * 12/27/05 LJB - 1. Add PS Site ID to screen - Non-display if
      *    LCL.Site ID Required from Producer Location file = "N"
      *    2. If Site ID is prompted, call Select Producer Site Mileage
      *    3. If Site ID is entered, Producer Site Mileage must exist
      *    else, error
      *    4. If LCL.Site ID Required = Y and DTL.TH Source Code = "CPR"
      *    then Site ID is a requried entry.
      *    5. If Site ID is entered, Tattoo Header EXT is updated
      * *****
      * 01/16/05 SLM -    Additional rules for site id
      *    6. If Resale do not require Site ID
      * *****
      * 03/07/2006 LJB  The State field on the screen was reverting to
      * ** the value retrieved from the file when it had been changed
      * ** on the screen. This was due to the initially retrieved value
      * ** being saved in a hidden field. The screen value was then
      * ** replaced with the hidden value. References to the hidden field
      * ** have been commented out and the entered value is retained.
      * ** The hidden value will only be used if the state is cleared out
      * *****
      * 04/26/06 SLM -    Additional rules for site id
      *   The State Cde will now reside in the Prod site mileage db
      *   get the 3 position field from there to populate the th state co
      *   the th state code
      *   3 pos. TH STATE CODE replace the oms state code usr (2 pos)
      *   use the same routines on the maintenance of the producer
      *   location  - the Vnd Routines.  with a 3 position field
      *   this is also the validation of state code and getting the
      *   description of the state code.
      *   If a Tattoo is in *chg do not replace the State Code if state
      *   is different then site.
      *   If a Tattoo is in *chg and the user select f4 on the site and
      *   selection occurs then replace the th state code
      * 5/16/08 SLM E00151 Producer Site validation regardless of Contrac
      * This is no effect to guymon due to they do not use the
      * the producer site file
      * 6/12/08 SLM E00144 LFT head and EUT/KOA head allow
      *             use of the defect with Market Hogs
      * 9/19/08 SLM E00150 Allow Producer Subsidiary defined at Tattoo
      * Header Ext
      * 9/19/08 SLM E00150 Allow Producer Subsidiary defined at Tattoo
      * Header Ext
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0430  30       BOH Company Num
     C                     PARM @CN,002   WQ0431 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0432 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0003           MTech Live Yes
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Producer work for remainder of program
      *================================================================
      * CASE: PAR.TH Hog Class Type is Market
     C           P1LLST    IFEQ 'M'                        *IF
      * Rtv ProdSubsidiaryPrc RT - Producer Subsidiary  * 
     C                     EXSR UVRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDJSS           Producer Subsid
     C                     END                             *FI
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
     C                     EXSR UWRVGN
      * Rtv Source Type       RT - Source  * 
     C                     EXSR UYRVGN
      * PAR.SR Type Desc = Condition name of PAR.SR Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM P3IXST    W0INVL 25        SR Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           P4ISTX    PARM           W0CNNM 25        SR Type Desc
      *
      * Rtv PL Vnd Nbr, state RT - Producer Location  * 
     C                     EXSR UZRVGN
      * CASE: PAR.TH Hog Class Type is Resale
     C           P1LLST    IFEQ 'R'                        *IF
     C                     MOVEL'A'       WUECSS           Allow User to E
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.PL Site ID Required is Yes
     C           P5QTST    IFEQ 'Y'                        *IF
      * used on the state code
     C                     MOVEL*BLANK    WUECSS           Allow User to E
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'A'       WUECSS           Allow User to E
      * CASE: PAR.SR Type is Internal
     C           P3IXST    IFEQ 'I'                        *IF
     C                     MOVEL*BLANK    WUECSS           Allow User to E
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVRVGN    BEGSR
      *================================================================
      * Rtv ProdSubsidiaryPrc RT - Producer Subsidiary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC R9771  3/24/17 check for active only
     C                     MOVEL'N'       WUDJSS           Producer Subsid
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDABCD    WQUV01           PD Producer Cod
      * Define keylist
     C           KRSUV     KLIST
     C                     KFLD           WQUV01           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WQUV01           PD Producer Cod
      * Establish starting position
     C           KRSUV     SETLL@A8REPM                    *
     C           KRSUV     READE@A8REPM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1213' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUDJSS           Producer Subsid
     C                     GOTO UVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WDAJST    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       WUDJSS           Producer Subsid
     C                     GOTO UVEXIT                     *QUIT
     C                     END                             *FI
     C           KRSUV     READE@A8REPM                  90*
     C                     ENDDO
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSUW     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSUW     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUGCNB           PD VND Address
     C                     MOVEL*BLANK    P3AACD           SR Source Code
     C                     GOTO UWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WUGCNB           PD VND Address
     C                     MOVELACAACD    P3AACD           SR Source Code
      * CASE: DB1.PD VND Address Number is Zero
     C           ACGCNB    IFEQ 0                          *IF
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR UXRVGN
     C                     Z-ADD7         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUQHCD:ZQ YL0032    P  90  Text 7 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0032    YL0033           Amount USR
     C                     Z-ADDYL0033    WUGCNB           PD VND Address
     C                     END                             *FI
     C                     GOTO UWEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSUX     KLIST
     C                     KFLD           B4ABCD           PD Producer Cod
      * Setup key
     C                     MOVELACABCD    B4ABCD           PD Producer Cod
      * Establish starting position
     C           KRSUX     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = PAR By name
     C                     GOTO UXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB4QHCD    WUQHCD           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSUY     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELP3AACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSUY     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    P3IXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZRVGN    BEGSR
      *================================================================
      * Rtv PL Vnd Nbr, state RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSUZ     KLIST
     C                     KFLD           WCABCD           PD Producer Cod
     C                     KFLD           WCAECD           PL Location Cod
      * Setup key
     C                     MOVELP1ABCD    WCABCD           PD Producer Cod
     C                     MOVELP1AECD    WCAECD           PL Location Cod
      * Establish starting position
     C           KRSUZ     CHAIN@AFREAR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0015' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P5A8TX           PL Name
     C                     Z-ADD*ZERO     WUGLNB           Pl VND Address
     C                     MOVEL*BLANK    P5N0TX           PL State Code
     C                     MOVEL*BLANK    P5QTST           PL Site ID Requ
     C                     GOTO UZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCA8TX    P5A8TX           PL Name
     C                     Z-ADDWCGLNB    WUGLNB           Pl VND Address
     C                     MOVELWCN0TX    P5N0TX           PL State Code
     C                     MOVELWCQTST    P5QTST           PL Site ID Requ
     C                     ENDIF
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1CVNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(KEY) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(KEY) #1BONB' defaulted for 'BOL Load Number'.
      * Field '(KEY) #1CVNB' defaulted for 'TH Tattoo Number'.
      * Field '(KEY) #1B0DT' defaulted for 'TH Kill Date'.
     C                     CALL 'PWLHSRR'              90  Sel Tattoo Head
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0065  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0066  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0067  50       BOL Load Number
     C           #1CVNB    PARM #1CVNB    WQ0068  50       TH Tattoo Numbe
     C           #1B0DT    PARM #1B0DT    WQ0069  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWLHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(KEY) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(KEY) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1ABCD' defaulted for 'PD Producer Code'.
      * Field '(PAR) P1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0070  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0071  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0072  50       BOL Load Number
     C                     PARM P1ABCD    WQ0073  6        PD Producer Cod
     C                     PARM P1AECD    WQ0074  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VB999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVBAX    KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    AXHMNB
     C                     Z-ADD#1BNNB    AXBNNB
     C                     Z-ADD#1BONB    AXBONB
     C           KLVBAX    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
     C           VB999     TAG
      * Restrictor relation not satisfied
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Header Process
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1CSCD    IFEQ *BLANK                     THP Process Cod
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCCC    KLIST
     C                     KFLD           CCCSCD           THP Process Cod
      * Setup key
     C                     MOVEL#1CSCD    CCCSCD
     C           KLVCCC    CHAIN@CCREH3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Tattoo Header Process  NF'
     C                     MOVEL'PRK0172' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0172' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0101  6        PD Producer Cod
     C           #1AECD    PARM #1AECD    WQ0102  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #1AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWC    KLIST
     C                     KFLD           WCABCD           PD Producer Cod
     C                     KFLD           WCAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    WCABCD
     C                     MOVEL#1AECD    WCAECD
     C           KLVDWC    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Hog Buyer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ACCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HB Buyer Code
     C           YPMTFD    OREQ '#1ACCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ACCD' defaulted for 'HB Buyer Code'.
     C                     CALL 'PKD3SRR'              90  Sel Hog Buyer
     C                     PARM *BLANK    W0RTN   7
     C           #1ACCD    PARM #1ACCD    WQ0103  3        HB Buyer Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKD3SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ACCD    IFNE *BLANK                     HB Buyer Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ACCD    IFEQ *BLANK                     HB Buyer Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAD    KLIST
     C                     KFLD           ADACCD           HB Buyer Code
      * Setup key
     C                     MOVEL#1ACCD    ADACCD
     C           KLVEAD    CHAIN@ADREAF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Hog Buyer              NF'
     C                     MOVEL'PRK0011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0011' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Genetic
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        GN Genetic Code
     C           YPMTFD    OREQ '#1AGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AGCD' defaulted for 'GN Genetic Code'.
     C                     CALL 'PKNASRR'              90  Sel Genetic Act
     C                     PARM *BLANK    W0RTN   7
     C           #1AGCD    PARM #1AGCD    WQ0104  5        GN Genetic Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKNASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9940  *
     C                     END
      *
     C           #1AGCD    IFNE *BLANK                     GN Genetic Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AGCD    IFEQ *BLANK                     GN Genetic Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFAI    KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVEL#1AGCD    AIAGCD
     C           KLVFAI    CHAIN@AIREA9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Genetic                NF'
     C                     MOVEL'PRK0021' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0021' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Hog Classification
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BECD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HC Class Code
     C           YPMTFD    OREQ '#1BECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BECD' defaulted for 'HC Class Code'.
     C                     CALL 'PKC0SRR'              90  Sel Hog Classif
     C                     PARM *BLANK    W0RTN   7
     C           #1BECD    PARM #1BECD    WQ0105  3        HC Class Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKC0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9934  *
     C                     END
      *
     C           #1BECD    IFNE *BLANK                     HC Class Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BECD    IFEQ *BLANK                     HC Class Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGWB    KLIST
     C                     KFLD           WBBECD           HC Class Code
      * Setup key
     C                     MOVEL#1BECD    WBBECD
     C           KLVGWB    CHAIN@A8REDA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Hog Classification     NF'
     C                     MOVEL'PRK0075' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0075' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(KEY) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(KEY) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1ABCD' defaulted for 'PD Producer Code'.
      * Field '(PAR) P1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0423  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0424  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0425  50       BOL Load Number
     C                     PARM P1ABCD    WQ0426  6        PD Producer Cod
     C                     PARM P1AECD    WQ0427  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VH999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVHAX    KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    AXHMNB
     C                     Z-ADD#1BNNB    AXBNNB
     C                     Z-ADD#1BONB    AXBONB
     C           KLVHAX    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
     C           VH999     TAG
      * Restrictor relation not satisfied
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VISUBR    BEGSR
      *================================================================
      * Get Hps movement and hps farm site - Add mode only
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.SR Type is Internal
      *   |- c2    : LCL.MTech Live Yes or No is Yes MTech is Live
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3IXST    IFEQ 'I'                        *IF
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Mvmnt,Farm f/BOL  RT - Delivery Sched Detail  * 
     C                     EXSR VJRVGN
      * If TH HPS Movement Ref # is zeros, retrieve value  DLV TRACK
      * CASE: WRK.TH HPS Movement Ref # EQ WRK.Zero USR
     C           WUOXNB    IFEQ WUE9NB                     *IF
      * movement and farm site
      * Rtv Movement NumbMtechRT - Delivery Tracking  * 
     C                     EXSR VKRVGN
     C                     END                             *FI
      * If TH HPS Movement Ref # is zeros, retrieve value  BOLW
      * CASE: WRK.TH HPS Movement Ref # EQ WRK.Zero USR
     C           WUOXNB    IFEQ WUE9NB                     *IF
      * movement and farm site
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
     C                     EXSR VLRVGN
     C                     Z-ADD*ZERO     P1THHD           TH HPS Farm Sit
     C                     END                             *FI
      * If TH HPS Movement Ref # is still zeros - load default value
      * CASE: WRK.TH HPS Movement Ref # EQ WRK.Zero USR
     C           WUOXNB    IFEQ WUE9NB                     *IF
      * movement and farm site
     C                     Z-ADDP1OXNB    WUOXNB           TH HPS Movement
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJRVGN    BEGSR
      *================================================================
      * Rtv Mvmnt,Farm f/BOL  RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AEHMNB    WQVJ01           BOH Company Num
     C           *LIKE     DEFN AEBNNB    WQVJ02           BOH Buy Order N
     C           *LIKE     DEFN AEBONB    WQVJ03           BOL Load Number
     C           *LIKE     DEFN AEE0DT    WQVJ04           DSH Kill Date
      * Define keylist
     C           KRSVJ     KLIST
     C                     KFLD           WQVJ01           BOH Company Num
     C                     KFLD           WQVJ02           BOH Buy Order N
     C                     KFLD           WQVJ03           BOL Load Number
     C                     KFLD           WQVJ04           DSH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQVJ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQVJ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQVJ03           BOL Load Number
     C                     Z-ADDP1B0DT    WQVJ04           DSH Kill Date
      * Establish starting position
     C           KRSVJ     SETLL@AECPI5                    *
     C           KRSVJ     READE@AECPI5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1028' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P1THHD           DSD Farm Site C
     C                     Z-ADD*ZERO     WUOXNB           DSD Movement Nu
     C                     GOTO VJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAEH1A1    P1THHD           DSD Farm Site C
     C                     Z-ADDAEH3A1    WUOXNB           DSD Movement Nu
     C                     GOTO VJEXIT                     *QUIT
     C           KRSVJ     READE@AECPI5                  90*
     C                     ENDDO
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKRVGN    BEGSR
      *================================================================
      * Rtv Movement NumbMtechRT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQVK01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQVK02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQVK03           BOL Load Number
      * Define keylist
     C           KRSVK     KLIST
     C                     KFLD           WQVK01           BOH Company Num
     C                     KFLD           WQVK02           BOH Buy Order N
     C                     KFLD           WQVK03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQVK01           BOH Company Num
     C                     Z-ADDP1BNNB    WQVK02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQVK03           BOL Load Number
      * Establish starting position
     C           KRSVK     SETLL@AFCPI4                    *
     C           KRSVK     READE@AFCPI4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P1THHD           DT Farm Site Co
     C                     Z-ADD*ZERO     WUOXNB           DT Movement Num
     C                     GOTO VKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    P1THHD           DT Farm Site Co
     C                     Z-ADDAFIEA1    WUOXNB           DT Movement Num
     C           KRSVK     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLRVGN    BEGSR
      *================================================================
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EJHONB    WQVL01           CC Company Numb
     C           *LIKE     DEFN EJBNNB    WQVL02           BOH Buy Order N
     C           *LIKE     DEFN EJBONB    WQVL03           BOL Load Number
      * Define keylist
     C           KRSVL     KLIST
     C                     KFLD           WQVL01           CC Company Numb
     C                     KFLD           WQVL02           BOH Buy Order N
     C                     KFLD           WQVL03           BOL Load Number
      * Setup key
     C                     Z-ADDP1OXNB    WQVL01           CC Company Numb
     C                     Z-ADDP1BNNB    WQVL02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQVL03           BOL Load Number
      * Establish starting position
     C           KRSVL     SETLL@EJCPBK                    *
     C           KRSVL     READE@EJCPBK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0841' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUOXNB           BOLW Movement N
     C                     GOTO VLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEJBOMV    WUOXNB           BOLW Movement N
     C                     GOTO VLEXIT                     *QUIT
     C           KRSVL     READE@EJCPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR1    IFEQ '1'
     C           W0OVR1    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C                     Z-ADDW0ROW1    ZZCSRW
     C                     Z-ADDW0COL1    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0ROW1  30
     C                     Z-ADD0         W0COL1  30
     C                     MOVE '2'       W0OVR1  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1CVNB'  YPMTFD           TH Tattoo Numbe
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDGE026
     C           ZHCSCL    ANDLE028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1BECD'  YPMTFD           HC Class Code
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ026
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1E2ST'  YPMTFD           TH Sex
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDGE026
     C           ZHCSCL    ANDLE030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1AGCD'  YPMTFD           GN Genetic Code
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ026
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1LIST'  YPMTFD           TH Schedule Kil
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDGE026
     C           ZHCSCL    ANDLE027
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN71     ANDEQ'0'
     C                     MOVEL'#1CPST'  YPMTFD           TH Live Purchas
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * RTV THDR NF UnAssnPend RT - Tattoo Header  * 
     C                     EXSR UORVGN
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     P1THHD           TH HPS Farm Sit
     C                     MOVEL*BLANK    P2DRTX           State
     C                     MOVEL*BLANK    P3AACD           SR Source Code
     C                     MOVEL*BLANK    P3AFTX           SR Description
     C                     MOVEL*BLANK    P3IXST           SR Type
     C                     MOVEL*BLANK    P4ISTX           SR Type Desc
     C                     MOVEL*BLANK    P5A8TX           PL Name
     C                     MOVEL*BLANK    P5N0TX           PL State Code
     C                     MOVEL*BLANK    P5QTST           PL Site ID Requ
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Producer Subsidiary SUSR
     C                     MOVEL*BLANK    WUDJSS  1
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Display Output Only Usr
     C                     MOVEL*BLANK    WUL9ST  1
      * Define work field Display Output Only 2 USR
     C                     MOVEL*BLANK    WUMAST  1
      * Define work field Defect Count Usr
     C                     Z-ADD*ZERO     WUODNB  30
      * Define work field @Status Internal (Y/N)
     C                     MOVEL*BLANK    WUKPST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field @Status (Yes/No)
     C                     MOVEL*BLANK    WUABST  1
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Ship Wgt Allow Ent Usr
     C                     MOVEL*BLANK    WUNEST  1
      * Define work field Held Over Records Y/N
     C                     MOVEL*BLANK    WUNFST  1
      * Define work field HPS Farm County
     C                     MOVEL*BLANK    WUQGTX 25
      * Define work field HPS Cell Manager Code USR
     C                     MOVEL*BLANK    WUJXCD  5
      * Define work field HPS Cell Manager Nm USR
     C                     MOVEL*BLANK    WUQFTX 25
      * Define work field Scale Wt Required     USR
     C                     MOVEL*BLANK    WUR3ST  1
      * Define work field DF Scale Weight Required
     C                     MOVEL*BLANK    WUR2ST  1
      * Define work field Pen Usr
     C                     MOVEL*BLANK    WUCBCD  3
      * Define work field Pen Company Number
     C                     Z-ADD*ZERO     WUHVNB  30
      * Define work field TH Live Purchase UOM
     C                     MOVEL*BLANK    WUCPST  2
      * Define work field TH Live Purchase Price
     C                     Z-ADD*ZERO     WUACPR  52
      * Define work field GN Genetic Code
     C                     MOVEL*BLANK    WUAGCD  5
      * Define work field TH Shipped Weight
     C                     Z-ADD*ZERO     WUHGNB  71
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WCASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WCHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field HC Defect Required
     C                     MOVEL*BLANK    WUBXST  1
      * Define work field HC Price Required
     C                     MOVEL*BLANK    WUBYST  1
      * Define work field HC Resolution
     C                     MOVEL*BLANK    WUBITX 60
      * Define work field HC Qualification
     C                     MOVEL*BLANK    WUB0ST  1
      * Define work field TH Hog Class Type
     C                     MOVEL*BLANK    WULLST  1
      * Define work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    WUIXTX  1
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAEA1           DF Market Perce
     C                     Z-ADD*ZERO     WEUOPR           DF Unused Price
     C                     Z-ADD*ZERO     WEUPPR           DF Unused Price
     C                     Z-ADD*ZERO     WEUQPR           DF Unused Price
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field PD EDI Trading Partner #
     C                     Z-ADD*ZERO     WUGJNB  80
      * Define work field Pen Type
     C                     MOVEL*BLANK    WUFWST  1
      * Define work field Scheduled Kill Dt 8.0 USR
     C                     Z-ADD*ZERO     WUSHDT  80
      * Define work field BOL Shipped Head
     C                     Z-ADD*ZERO     WULDSH  50
      * Define work field TH HPS Movement Ref #
     C                     Z-ADD*ZERO     WUOXNB  70
      * Define work field BOH Payment Type
     C                     MOVEL*BLANK    WUA4ST  1
      * Define work field BOH Buy Order Type
     C                     MOVEL*BLANK    WUA5ST  1
      * Define work field PD Std Delv Time
     C                     Z-ADD*ZERO     WUAATH  40
      * Define work field PD Std Truck Size
     C                     Z-ADD*ZERO     WUAMNB  50
      * Define work field PD Freight Exp Paid By
     C                     MOVEL*BLANK    WUIWST  1
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHONB           CC Company Numb
     C                     Z-ADD*ZERO     WFEZDT           TP Tattoo Date
     C                     Z-ADD*ZERO     WFHSA1           TP Tattoo Numbe
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFHRA1           Employee ID
     C                     Z-ADD*ZERO     WFBKTM           TP Tattoo Creat
     C                     Z-ADD*ZERO     WFMIA1           Employee Number
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Define work field @Print Status
     C                     MOVEL*BLANK    WUCZST  1
      * Define work field Farm Site USR
     C                     Z-ADD*ZERO     WUETNB  50
      * Define work field Defect Add/Chg Usr
     C                     MOVEL*BLANK    WUQKST  1
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WGACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WGB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WGCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WGAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WGA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WGCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WGCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WGFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WGH9NB           TH Held Over
     C                     Z-ADD*ZERO     WGFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WGFENB           TH Head Killed
     C                     Z-ADD*ZERO     WGHENB           TH Head Adds
     C                     Z-ADD*ZERO     WGHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WGCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WGLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WGE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WGA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WGFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WGA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WGF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WGHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WGF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WGF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WGF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WGF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WGAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WGAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WGCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WGA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WGA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WGB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WGAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WGANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WGAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WGAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WGAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WGAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WGAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WGASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WGA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WGATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WGA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WGCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WGCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WGLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WGCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WGA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WGA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WGGHNB           TH Commission A
     C                     Z-ADD*ZERO     WGBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WGBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WGBTDT           TH Commission P
     C                     Z-ADD*ZERO     WGBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WGHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WGHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WGHINB           TH FFLI
     C                     Z-ADD*ZERO     WGA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WGA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WGA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WGJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WGD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WGD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WGD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WGD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WGEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WGEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WGECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WGEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WGEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WGEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WGEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WGEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WGOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WGTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WGT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WGTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WGT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WGOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WGKOER           TH Head Identif
     C                     Z-ADD*ZERO     WGOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WGOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WGIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WGOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WGHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WGS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WGTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WGTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WGJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WGKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WGKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WGKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WGKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WGOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WGIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WGIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WGIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WGKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WGOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WGKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WGORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WGOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WGMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WGMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WGNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WGNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WGIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WGKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WGEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WGEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WGECDT           TH Head LFT
     C                     Z-ADD*ZERO     WGEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WGEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field Company Value Code    USR
     C                     MOVEL*BLANK    WUFACD 10
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field BOL Live Wgt Received
     C                     Z-ADD*ZERO     WUDINB  71
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WHBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WHBONB           BOL Load Number
     C                     Z-ADD*ZERO     WHCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WHB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WHC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WHCZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WHC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WHD8NB           TD Yard Dead
     C                     Z-ADD*ZERO     WHH7NB           TD Held Over
     C                     Z-ADD*ZERO     WHAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WHJEA1           TD Drive Hour
     C                     Z-ADD*ZERO     WHB7CD           TD Drive Card N
     C                     Z-ADD*ZERO     WHD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     WHBVDT           TD User Date 1
     C                     Z-ADD*ZERO     WHBWDT           TD User Date 2
     C                     Z-ADD*ZERO     WHBXDT           TD Drive Date
     C                     Z-ADD*ZERO     WHHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WHH8NB           Held Over Pen C
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WICTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WID6NB           Pen Current Hea
     C                     Z-ADD*ZERO     WIB6CD           Pen Current Dri
     C                     Z-ADD*ZERO     WIEBNB           Pen Drive Seque
     C                     Z-ADD*ZERO     WIHBNB           Pen Adjustment
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Define work field Pen Description
     C                     MOVEL*BLANK    WUBBTX 25
      * Define work field Pen Current Head
     C                     Z-ADD*ZERO     WUD6NB  50
      * Define work field Genetic Code USR
     C                     MOVEL*BLANK    WUA1CD  5
      * Define work field Pen Desc              USR
     C                     MOVEL*BLANK    WUJTTX 25
      * Define work field BOL Head Received
     C                     Z-ADD*ZERO     WUDHNB  70
      * Define work field BOL Freight Amt
     C                     Z-ADD*ZERO     WUATVA  72
      * Define work field Tattoo is paid Usr
     C                     MOVEL*BLANK    WUNPST  1
      * Define work field Tot Frt Spdb aft pay Usr
     C                     Z-ADD*ZERO     WUK4PR  72
      * Define work field BOL Trucker Payment Sts
     C                     MOVEL*BLANK    WUCNST  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WKBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WKBONB           BOL Load Number
     C                     Z-ADD*ZERO     WKCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WKABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WKACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WKBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WKCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WKAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WKAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WKATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WKDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WKDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WKGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WKBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WKLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WKLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WKJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WKKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WKIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WKKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WKIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WKEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WKITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WKODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WKRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WKOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WKD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WKD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WKD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WKD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WKD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WLBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WLARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WLASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WLAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WLALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WLD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WLD6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WLD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WLD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WLD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WLJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WLKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WLKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WLIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WLGANB           CW Year
     C                     Z-ADD*ZERO     WLGBNB           CW Week Number
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMHONB           CC Company Numb
     C                     Z-ADD*ZERO     WME0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WME6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WMAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WMHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WMH0A1           DSD Scheduled H
     C                     Z-ADD*ZERO     WMH1A1           DSD Farm Site C
     C                     Z-ADD*ZERO     WMIOA1           DSD Unused Head
     C                     Z-ADD*ZERO     WMH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WMIJA1           DSD Scheduled K
     C                     Z-ADD*ZERO     WMH3A1           DSD Movement Nu
     C                     Z-ADD*ZERO     WMFRDT           DSD Sched Route
     C                     Z-ADD*ZERO     WMBOTH           DSD Sched Route
     C                     Z-ADD*ZERO     WME7DT           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WMAHTH           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WME8DT           DSD Sch Start L
     C                     Z-ADD*ZERO     WMAITH           DSD Sch Start L
     C                     Z-ADD*ZERO     WMFZDT           DSD Unused Date
     C                     Z-ADD*ZERO     WMB1TH           DSD Unused Time
     C                     Z-ADD*ZERO     WMHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WMBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WMBONB           BOL Load Number
     C                     Z-ADD*ZERO     WMY0A1           DSD PRD Srv Bat
     C                     Z-ADD*ZERO     WMY1A1           DSD PRD Srv Sch
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WOBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WOBONB           BOL Load Number
     C                     Z-ADD*ZERO     WOCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WOB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WOLJNB           TDF Head Defect
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WSBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WSBONB           BOL Load Number
     C                     Z-ADD*ZERO     WSCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WSB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WSI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WSJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WSI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WSI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WSI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WSI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WSJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WSJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WSJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WSJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WSJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WSJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WSJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WSJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WSJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WSJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WSJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WSJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WSLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WSHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WSLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WSH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WSGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WSH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WSGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WSH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WSHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WSHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WSHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WSHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WSHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WSHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WSHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WSHFLP           TH Head GT Lean
     C                     Z-ADD*ZERO     WSSNA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WSSOA1           TE UnUsed Numbe
     C                     Z-ADD*ZERO     WSSPA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WSABDT           RS Date Added
     C                     Z-ADD*ZERO     WSABTM           RS Time Added
      * Define work field Prior Movement #
     C                     Z-ADD*ZERO     WUTZA1  70
      * Define work field Head Total Usr 2
     C                     Z-ADD*ZERO     WUZYNB  70
      * Define work field GN Description
     C                     MOVEL*BLANK    WUAWTX 25
      * Define work field Display Output Only 3 USR
     C                     MOVEL*BLANK    WUFRSS  1
      * Define work field Display Output Only 4 USR
     C                     MOVEL*BLANK    WUFSSS  1
      * Define work field Allow User to Enter Usr
     C                     MOVEL*BLANK    WUECSS  1
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field PD VND Address Number
     C                     Z-ADD*ZERO     WUGCNB  80
      * Define work field M3 Supplier ID
     C                     MOVEL*BLANK    WUQHCD 10
      * Define work field Pl VND Address Number
     C                     Z-ADD*ZERO     WUGLNB  80
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD08 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD07 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD06 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD05 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD04 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0001  6
      * Define local work field TattooPend Set to Pending
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field BOL Pln Head Delv
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field State
     C                     MOVEL*BLANK    YL0004  3
      * Define null work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    YN0002 25
      * Define null work field HPS Farm County
     C                     MOVEL*BLANK    YN0003 25
      * Define null work field HPS Cell Manager Code USR
     C                     MOVEL*BLANK    YN0004  5
      * Define null work field HPS Cell Manager Nm USR
     C                     MOVEL*BLANK    YN0005 25
      * Define null work field MTech Farm Site Ref
     C                     MOVEL*BLANK    YN0006 20
      * Define null work field MTech Cell Manager Ref
     C                     MOVEL*BLANK    YN0007 20
      * Define local work field Return Code USR
     C                     MOVEL*BLANK    YL0005  7
      * Define local work field DSD Farm Site Code
     C                     Z-ADD*ZERO     YL0006  50
      * Define null work field DT Farm Site Code
     C                     Z-ADD*ZERO     YN0008  50
      * Define local work field Record Change Usr
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field PSM Miles to Company
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field BOL Shipped Head
     C                     Z-ADD*ZERO     YL0009  50
      * Define local work field *Return code
     C                     MOVEL*BLANK    YL0010  7
      * Define local work field Record Added Usr
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Random Tattoo Sts USR
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Tattoo Type USR
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field TH Kill Date
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Next Kill Date
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field TE Unused Number 1
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field TE UnUsed Number 2
     C                     Z-ADD*ZERO     YL0018  50
      * Define local work field TE Unused Number 3
     C                     Z-ADD*ZERO     YL0019  50
      * Define local work field TE Unused Status 1
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field TE Unused Status 2
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field TE Unused Status 3
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field TH Dead On Arrival
     C                     Z-ADD*ZERO     YL0024  50
      * Define local work field TE Unused Number 1
     C                     Z-ADD*ZERO     YL0025  50
      * Define local work field TE UnUsed Number 2
     C                     Z-ADD*ZERO     YL0026  50
      * Define local work field TE Unused Number 3
     C                     Z-ADD*ZERO     YL0027  50
      * Define local work field TE Unused Status 1
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field TE Unused Status 2
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field TE Unused Status 3
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field HPS Automation (Y/N)
     C                     MOVEL*BLANK    YL0031 10
      * Define local work field Text 7 USR
     C                     MOVEL*BLANK    YL0032  7
      * Define local work field Amount USR
     C                     Z-ADD*ZERO     YL0033  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Select initial mode
     C           @1NROP    IFEQ *ZERO
      * Add mode
     C                     MOVEL'ADD'     W0PMD   3
     C                     ELSE
      * Change mode
     C                     MOVEL'CHG'     W0PMD
     C                     END
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR URSUBR                     Modifications a
      * E00150 Prod/Subsidiary
      * 09/19/08 SLM E00150 Add the Producer Subsidiary to the
      * Tattoo Header Ext  -- Only on non Resale hogs
      * Allow the user to inter the Producer Subsidiary for this
      * tattoo if the Producer Subsidiary has records for any subsidiary
      * then the Producer Subsidiary code will be required for this tatto
      * Modification History Created IS 061308 slm
     C                     EXSR USSUBR                     Modification Hi
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     MOVEL'N'       YL0011           Record Added Us
     C                     MOVEL'N'       YL0007           Record Change U
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UTSUBR                     Get the MTech L
      * Producer work for remainder of program
     C                     EXSR UUSUBR                     Producer work f
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * Get Hps movement and hps farm site - Add mode only
     C                     EXSR VISUBR                     Get Hps movemen
     C                     END                             *FI
      * Rules: Screen with Mtech Live and Internal Producer
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUFSSS           Display Output
      * CASE: PAR.SR Type is Internal
     C           P3IXST    IFEQ 'I'                        *IF
     C                     MOVEL'Y'       WUFSSS           Display Output
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUFSSS           Display Output
     C                     END                             *FI
      * The following field will now be opened to allow entry on internal
      * hogs, movement, farm site, and farm site will go get the
      * the state code
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * Internal farm site
     C                     MOVEL'N'       WUFSSS           Display Output
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         ZZEXIT    ENDSR
** KEY Screen: Field position and name array
0104901305015610181702329
** W0END
0105101311015650182402333
** W0NAM
#1HMNB    #1BNNB    #1BONB    V1B0DT    #1CVNB
** W1BEG
00794008050104701054010780108601099
01303013290155901561015960181801840
01864020740208102330023640258602590
02620028420284602871028820309803116
03136033540340003610036540386603873
03896039100412204129043780486704874
04880048820488904895048980490504911
04914049210492704930049370494305123
05130051360513805145051510515405161
05167051700517705183051860519305199
** W1END
00803008190105201059010840109001103
01310013360155901570016000182301849
01870020760209802336023730258602597
02624028440286002875028860310203120
03138033540340403614036600387103881
03903039170412304153043850487204878
04880048870489304895049030490904911
04919049250492704935049410494305128
05134051360514305149051510515905165
05167051750518105183051910519705199
** W1NAM
#DKKTX    #DISTX    #1ABCD    #1AECD    #1BNNB    #1BONB    #1CVNB
V1B0DT    V1AWDT    #1LLST    #DE6TX    #DLDSH    #DOVCD    #DNYCD
#DBGT1    #1BECD    #DBDTX    #1OXNB    #1BICD    #1E2ST    #DFRTX
#1THHD    #1NZTX    #DLXTX    #DK0CD    #DK1CD    #1AGCD    #DLFCD
#DCMCD    #1LIST    #1CWNB    #1CXNB    #DB5NB    #1ACPR    #DK5TX
#1ECDT    #1EDDT    #1CPST    #DEPTX    #1HGNB    #DGUCD    #DF1NB
#DCLSS    #DGVCD    #DFWNB    #DCMSS    #DGWCD    #DFYNB    #DCNSS
#DGXCD    #DFUNB    #DCOSS    #DGYCD    #DO3NB    #DCPSS    #DGZCD
#DO4NB    #DCQSS    #DG0CD    #DO5NB    #DCRSS    #DG1CD    #DFONB
#DCSSS    #DG2CD    #DFXNB    #DCTSS    #DG3CD    #DFTNB    #DCUSS
** @CN
00001 *INSURED*
00002 MTECHLIVE
00003 LSTTTTRSC
00004 LSTTTTMKT
00005 LSTTTTTOP
