     H/TITLE Exc Crt Prd Vch p/BatchXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 02/24/22  Time  : 15:30:13
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKBKCPL0IF  E           K        DISK
      * RTV : Hog Voucher Header        Retrieval index
      *
     FPKBLCPL1IF  E           K        DISK
      * RTV : Hog Voucher Detail        Retrieval index
      *
     FPLCEREL1IF  E           K        DISK
      * RTV : M3 Voucher Number Series  Retrieval index
      *
     FPKBAREL0IF  E           K        DISK
      * RTV : Trucker                   Retrieval index
      *
     FPKACRELAIF  E           K        DISK
      * RSQ : Producer                  Vendor Number
      *
     FPLB4REL1IF  E           K        DISK
      * RTV : Producer EXT2             Retrieval index
      *
     FPLB4REL2IF  E           K        DISK
      * RSQ : Producer EXT2             Supplier/Producer
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPLB2REL1IF  E           K        DISK
      * RTV : M3 Supplier               Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKBBREL0IF  E           K        DISK
      * RTV : Deduction/Addition        Retrieval index
      *
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPKA1CPLFIF  E           K        DISK
      * RSQ : Tattoo Header             Co/BOL/Kill/Ttt
      *
     FPLCCCPL2IF  E           K        DISK
      * RSQ : M3 Supplier Payment Head  Co/Div/Supplier/SupplInv
      *
     FPLCEREL0UF  E           K        DISK
      * UPD : M3 Voucher Number Series  Update index
      *
     FPLCCCPL0UF  E           K        DISK                      A
      * UPD : M3 Supplier Payment Head  Update index
      *
     FPLCFCPL0IF  E           K        DISK                      A
      * UPD : M3 Supplier Payment Addl  Update index
      *
     FPKBLCPL0UF  E           K        DISK
      * UPD : Hog Voucher Detail        Update index
      *
      * Long constants
     E                    @CN#    1  05  6   @CN    25
     I@BKCPEJ
      * Hog Voucher Header        Retrieval index
      * Renamed input format fields
     I              BKHNNB                          WAHNNB
     I              BKLWNB                          WALWNB
     I              BKG9NB                          WAG9NB
     I              BKLXNB                          WALXNB
     I              BKLYNB                          WALYNB
     I              BKCSST                          WACSST
     I              BKDKNB                          WADKNB
     I              BKA2DT                          WAA2DT
     I              BKCIPR                          WACIPR
     I              BKCJPR                          WACJPR
     I              BKCKPR                          WACKPR
     I              BKCLPR                          WACLPR
     I              BKCMPR                          WACMPR
     I              BKAUVA                          WAAUVA
     I              BKAVVA                          WAAVVA
     I              BKCHPR                          WACHPR
     I              BKAJVA                          WAAJVA
     I              BKBUPC                          WABUPC
     I              BKJHST                          WAJHST
     I              BKC0ST                          WAC0ST
     I              BKA4DT                          WAA4DT
     I              BKCUST                          WACUST
     I              BKABCD                          WAABCD
     I              BKBNCD                          WABNCD
     I              BKCFCD                          WACFCD
     I              BKAAVN                          WAAAVN
     I              BKAADT                          WAAADT
     I              BKAMTM                          WAAMTM
     I              BKAJST                          WAAJST
     I              BKAHVN                          WAAHVN
     I              BKAGVN                          WAAGVN
     I              BKABVN                          WAABVN
     I              BKABDT                          WAABDT
     I              BKABTM                          WAABTM
      *
     I@BLCPEP
      * Hog Voucher Detail        Retrieval index
      * Renamed input format fields
     I              BLHNNB                          WBHNNB
     I              BLLWNB                          WBLWNB
     I              BLG9NB                          WBG9NB
     I              BLDLNB                          WBDLNB
     I              BLCNPR                          WBCNPR
     I              BLCOPR                          WBCOPR
     I              BLCPPR                          WBCPPR
     I              BLCQPR                          WBCQPR
     I              BLCRPR                          WBCRPR
     I              BLAKVA                          WBAKVA
     I              BLALVA                          WBALVA
     I              BLCVPR                          WBCVPR
     I              BLAMVA                          WBAMVA
     I              BLAEPC                          WBAEPC
     I              BLI6ST                          WBI6ST
     I              BLJIST                          WBJIST
     I              BLJPST                          WBJPST
     I              BLC2SS                          WBC2SS
     I              BLOTCD                          WBOTCD
     I              BLF5TX                          WBF5TX
     I              BLL5A1                          WBL5A1
     I              BLL6A1                          WBL6A1
     I              BLJQST                          WBJQST
     I              BLC4SS                          WBC4SS
     I              BLC5SS                          WBC5SS
     I              BLC3SS                          WBC3SS
     I              BLOKA1                          WBOKA1
     I              BLOLA1                          WBOLA1
     I              BLOMA1                          WBOMA1
     I              BLQ0CD                          WBQ0CD
     I              BLWSA1                          WBWSA1
     I              BLWOA1                          WBWOA1
     I              BLHFDT                          WBHFDT
     I              BLB2TM                          WBB2TM
     I              BLHMNB                          WBHMNB
     I              BLBNNB                          WBBNNB
     I              BLBONB                          WBBONB
     I              BLCVNB                          WBCVNB
     I              BLB0DT                          WBB0DT
     I              BLABCD                          WBABCD
     I              BLAECD                          WBAECD
     I              BLAAVN                          WBAAVN
     I              BLAADT                          WBAADT
     I              BLAMTM                          WBAMTM
     I              BLAJST                          WBAJST
     I              BLAHVN                          WBAHVN
     I              BLAGVN                          WBAGVN
     I              BLABVN                          WBABVN
     I              BLABDT                          WBABDT
     I              BLABTM                          WBABTM
      *
     I@CEREUV
      * M3 Voucher Number Series  Retrieval index
      * Renamed input format fields
     I              CEQ4CD                          WCQ4CD
     I              CEAPT1                          WCAPT1
     I              CEWTA1                          WCWTA1
     I              CEWUA1                          WCWUA1
     I              CEWVA1                          WCWVA1
     I              CEAAVN                          WCAAVN
     I              CEAADT                          WCAADT
     I              CEAMTM                          WCAMTM
     I              CEAJST                          WCAJST
     I              CEAHVN                          WCAHVN
     I              CEAGVN                          WCAGVN
     I              CEABVN                          WCABVN
     I              CEABDT                          WCABDT
     I              CEABTM                          WCABTM
      *
     I@CEREUU
      * M3 Voucher Number Series  Update index
      * Renamed input format fields
     I              CEQ4CD                          WDQ4CD
     I              CEAPT1                          WDAPT1
     I              CEWTA1                          WDWTA1
     I              CEWUA1                          WDWUA1
     I              CEWVA1                          WDWVA1
     I              CEAAVN                          WDAAVN
     I              CEAADT                          WDAADT
     I              CEAMTM                          WDAMTM
     I              CEAJST                          WDAJST
     I              CEAHVN                          WDAHVN
     I              CEAGVN                          WDAGVN
     I              CEABVN                          WDABVN
     I              CEABDT                          WDABDT
     I              CEABTM                          WDABTM
      *
     I@BAREDS
      * Trucker                   Retrieval index
      * Renamed input format fields
     I              BABNCD                          WEBNCD
     I              BABJTX                          WEBJTX
     I              BAB6ST                          WEB6ST
     I              BAGMNB                          WEGMNB
     I              BAC3TX                          WEC3TX
     I              BAAAVN                          WEAAVN
     I              BAAADT                          WEAADT
     I              BAAMTM                          WEAMTM
     I              BAAJST                          WEAJST
     I              BAAHVN                          WEAHVN
     I              BAAGVN                          WEAGVN
     I              BAABVN                          WEABVN
     I              BAABDT                          WEABDT
     I              BAABTM                          WEABTM
      *
     I@ACREBC
      * Producer                  Vendor Number
      * Renamed input format fields
     I              ACABCD                          WFABCD
     I              ACAGTX                          WFAGTX
     I              ACALNB                          WFALNB
     I              ACAATH                          WFAATH
     I              ACAMNB                          WFAMNB
     I              ACIWST                          WFIWST
     I              ACAPST                          WFAPST
     I              ACGCNB                          WFGCNB
     I              ACGJNB                          WFGJNB
     I              ACC2TX                          WFC2TX
     I              ACAACD                          WFAACD
     I              ACACCD                          WFACCD
     I              ACADCD                          WFADCD
     I              ACAAVN                          WFAAVN
     I              ACAADT                          WFAADT
     I              ACAMTM                          WFAMTM
     I              ACAJST                          WFAJST
     I              ACAHVN                          WFAHVN
     I              ACAGVN                          WFAGVN
     I              ACABVN                          WFABVN
     I              ACABDT                          WFABDT
     I              ACABTM                          WFABTM
      *
     I@B4RET4
      * Producer EXT2             Retrieval index
      * Renamed input format fields
     I              B4ABCD                          WGABCD
     I              B4QHCD                          WGQHCD
     I              B4AAVN                          WGAAVN
     I              B4AADT                          WGAADT
     I              B4AMTM                          WGAMTM
     I              B4AJST                          WGAJST
     I              B4AHVN                          WGAHVN
     I              B4AGVN                          WGAGVN
     I              B4ABVN                          WGABVN
     I              B4ABDT                          WGABDT
     I              B4ABTM                          WGABTM
      *
     I@B4REW9
      * Producer EXT2             Supplier/Producer
      * Renamed input format fields
     I              B4ABCD                          WHABCD
     I              B4QHCD                          WHQHCD
     I              B4AAVN                          WHAAVN
     I              B4AADT                          WHAADT
     I              B4AMTM                          WHAMTM
     I              B4AJST                          WHAJST
     I              B4AHVN                          WHAHVN
     I              B4AGVN                          WHAGVN
     I              B4ABVN                          WHABVN
     I              B4ABDT                          WHABDT
     I              B4ABTM                          WHABTM
      *
     I@ACREAI
      * Producer                  Retrieval index
      * Renamed input format fields
     I              ACABCD                          WIABCD
     I              ACAGTX                          WIAGTX
     I              ACALNB                          WIALNB
     I              ACAATH                          WIAATH
     I              ACAMNB                          WIAMNB
     I              ACIWST                          WIIWST
     I              ACAPST                          WIAPST
     I              ACGCNB                          WIGCNB
     I              ACGJNB                          WIGJNB
     I              ACC2TX                          WIC2TX
     I              ACAACD                          WIAACD
     I              ACACCD                          WIACCD
     I              ACADCD                          WIADCD
     I              ACAAVN                          WIAAVN
     I              ACAADT                          WIAADT
     I              ACAMTM                          WIAMTM
     I              ACAJST                          WIAJST
     I              ACAHVN                          WIAHVN
     I              ACAGVN                          WIAGVN
     I              ACABVN                          WIABVN
     I              ACABDT                          WIABDT
     I              ACABTM                          WIABTM
      *
     I@B2RETY
      * M3 Supplier               Retrieval index
      * Renamed input format fields
     I              B2QHCD                          WJQHCD
     I              B2ZNTX                          WJZNTX
     I              B2ZOTX                          WJZOTX
     I              B2ZPTX                          WJZPTX
     I              B2ZQTX                          WJZQTX
     I              B2Z5TX                          WJZ5TX
     I              B2ZRTX                          WJZRTX
     I              B2ZSTX                          WJZSTX
     I              B2ZTTX                          WJZTTX
     I              B2ZVTX                          WJZVTX
     I              B2ZXTX                          WJZXTX
     I              B2ZZTX                          WJZZTX
     I              B2Z0TX                          WJZ0TX
     I              B2Z1TX                          WJZ1TX
     I              B2GOSS                          WJGOSS
     I              B2HZSS                          WJHZSS
     I              B2ASDX                          WJASDX
     I              B2B4TM                          WJB4TM
     I              B2SACD                          WJSACD
     I              B2R8CD                          WJR8CD
     I              B2H4SS                          WJH4SS
     I              B2AAVN                          WJAAVN
     I              B2AADT                          WJAADT
     I              B2AMTM                          WJAMTM
     I              B2AJST                          WJAJST
     I              B2AHVN                          WJAHVN
     I              B2AGVN                          WJAGVN
     I              B2ABVN                          WJABVN
     I              B2ABDT                          WJABDT
     I              B2ABTM                          WJABTM
      *
     I@AAREAC
      * Source                    Retrieval index
      * Renamed input format fields
     I              AAAACD                          WKAACD
     I              AAAFTX                          WKAFTX
     I              AAIXST                          WKIXST
     I              AACYSS                          WKCYSS
     I              AACZSS                          WKCZSS
     I              AAC0SS                          WKC0SS
     I              AAC1SS                          WKC1SS
     I              AAAAVN                          WKAAVN
     I              AAAADT                          WKAADT
     I              AAAMTM                          WKAMTM
     I              AAAJST                          WKAJST
     I              AAAHVN                          WKAHVN
     I              AAAGVN                          WKAGVN
     I              AAABVN                          WKABVN
     I              AAABDT                          WKABDT
     I              AAABTM                          WKABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WLHMNB
     I              A1BNNB                          WLBNNB
     I              A1BONB                          WLBONB
     I              A1CVNB                          WLCVNB
     I              A1B0DT                          WLB0DT
     I              A1AWDT                          WLAWDT
     I              A1BICD                          WLBICD
     I              A1CPST                          WLCPST
     I              A1ACPR                          WLACPR
     I              A1B9PR                          WLB9PR
     I              A1CAPR                          WLCAPR
     I              A1C4ST                          WLC4ST
     I              A1AIPR                          WLAIPR
     I              A1A6DT                          WLA6DT
     I              A1C2ST                          WLC2ST
     I              A1CXNB                          WLCXNB
     I              A1CWNB                          WLCWNB
     I              A1FCNB                          WLFCNB
     I              A1H9NB                          WLH9NB
     I              A1FDNB                          WLFDNB
     I              A1FENB                          WLFENB
     I              A1HENB                          WLHENB
     I              A1HFNB                          WLHFNB
     I              A1CYNB                          WLCYNB
     I              A1LRNB                          WLLRNB
     I              A1E0NB                          WLE0NB
     I              A1A5PC                          WLA5PC
     I              A1FBNB                          WLFBNB
     I              A1A4PC                          WLA4PC
     I              A1F7NB                          WLF7NB
     I              A1HDNB                          WLHDNB
     I              A1F5NB                          WLF5NB
     I              A1F4NB                          WLF4NB
     I              A1F3NB                          WLF3NB
     I              A1F2NB                          WLF2NB
     I              A1AVPC                          WLAVPC
     I              A1AWPC                          WLAWPC
     I              A1CWPC                          WLCWPC
     I              A1A8PC                          WLA8PC
     I              A1A7PC                          WLA7PC
     I              A1B8PR                          WLB8PR
     I              A1AMPR                          WLAMPR
     I              A1ANPR                          WLANPR
     I              A1AYVA                          WLAYVA
     I              A1AWVA                          WLAWVA
     I              A1AOPR                          WLAOPR
     I              A1AXVA                          WLAXVA
     I              A1APPR                          WLAPPR
     I              A1ASPR                          WLASPR
     I              A1A4VA                          WLA4VA
     I              A1ATPR                          WLATPR
     I              A1A5VA                          WLA5VA
     I              A1CBPR                          WLCBPR
     I              A1CCPR                          WLCCPR
     I              A1LPNB                          WLLPNB
     I              A1CDPR                          WLCDPR
     I              A1A7VA                          WLA7VA
     I              A1A2PR                          WLA2PR
     I              A1JWST                          WLJWST
     I              A1CWST                          WLCWST
     I              A1D7ST                          WLD7ST
     I              A1D8ST                          WLD8ST
     I              A1DWST                          WLDWST
     I              A1D6ST                          WLD6ST
     I              A1GHNB                          WLGHNB
     I              A1BYDT                          WLBYDT
     I              A1E0ST                          WLE0ST
     I              A1E1ST                          WLE1ST
     I              A1E2ST                          WLE2ST
     I              A1BSDT                          WLBSDT
     I              A1BTDT                          WLBTDT
     I              A1BUDT                          WLBUDT
     I              A1HGNB                          WLHGNB
     I              A1HHNB                          WLHHNB
     I              A1HINB                          WLHINB
     I              A1A3PR                          WLA3PR
     I              A1A4PR                          WLA4PR
     I              A1A6PR                          WLA6PR
     I              A1J9NB                          WLJ9NB
     I              A1D6PR                          WLD6PR
     I              A1D7PR                          WLD7PR
     I              A1D8PR                          WLD8PR
     I              A1D9PR                          WLD9PR
     I              A1EAPR                          WLEAPR
     I              A1EBPR                          WLEBPR
     I              A1ECPR                          WLECPR
     I              A1EDPR                          WLEDPR
     I              A1EEPR                          WLEEPR
     I              A1EFPR                          WLEFPR
     I              A1EGPR                          WLEGPR
     I              A1EHPR                          WLEHPR
     I              A1KAST                          WLKAST
     I              A1J7ST                          WLJ7ST
     I              A1J9ST                          WLJ9ST
     I              A1OXNB                          WLOXNB
     I              A1LKST                          WLLKST
     I              A1LLST                          WLLLST
     I              A1J8ST                          WLJ8ST
     I              A1LIST                          WLLIST
     I              A1LJST                          WLLJST
     I              A1NZTX                          WLNZTX
     I              A1HJCD                          WLHJCD
     I              A1R4ST                          WLR4ST
     I              A1R5ST                          WLR5ST
     I              A1R6ST                          WLR6ST
     I              A1R7ST                          WLR7ST
     I              A1THWT                          WLTHWT
     I              A1T2WT                          WLT2WT
     I              A1THHD                          WLTHHD
     I              A1T2HD                          WLT2HD
     I              A1OBPR                          WLOBPR
     I              A1KOER                          WLKOER
     I              A1OPIR                          WLOPIR
     I              A1OPEM                          WLOPEM
     I              A1IORP                          WLIORP
     I              A1OWEO                          WLOWEO
     I              A1OQET                          WLOQET
     I              A1URST                          WLURST
     I              A1USST                          WLUSST
     I              A1HHPC                          WLHHPC
     I              A1S9PR                          WLS9PR
     I              A1TAPR                          WLTAPR
     I              A1TBPR                          WLTBPR
     I              A1JFUR                          WLJFUR
     I              A1KRIF                          WLKRIF
     I              A1KORF                          WLKORF
     I              A1KAPR                          WLKAPR
     I              A1KROT                          WLKROT
     I              A1OTJG                          WLOTJG
     I              A1IRJG                          WLIRJG
     I              A1IMJF                          WLIMJF
     I              A1IRGF                          WLIRGF
     I              A1KRJF                          WLKRJF
     I              A1OJRF                          WLOJRF
     I              A1KFOR                          WLKFOR
     I              A1ORJK                          WLORJK
     I              A1OMVJ                          WLOMVJ
     I              A1MVNF                          WLMVNF
     I              A1MCNF                          WLMCNF
     I              A1NCNF                          WLNCNF
     I              A1NCHF                          WLNCHF
     I              A1IGIR                          WLIGIR
     I              A1KFJR                          WLKFJR
     I              A1EADT                          WLEADT
     I              A1EBDT                          WLEBDT
     I              A1ECDT                          WLECDT
     I              A1EDDT                          WLEDDT
     I              A1EEDT                          WLEEDT
     I              A1U4ST                          WLU4ST
     I              A1U5ST                          WLU5ST
     I              A1U6ST                          WLU6ST
     I              A1U7ST                          WLU7ST
     I              A1U8ST                          WLU8ST
     I              A1U9ST                          WLU9ST
     I              A1VAST                          WLVAST
     I              A1VBST                          WLVBST
     I              A1BDCD                          WLBDCD
     I              A1CSCD                          WLCSCD
     I              A1ABCD                          WLABCD
     I              A1AECD                          WLAECD
     I              A1ACCD                          WLACCD
     I              A1AGCD                          WLAGCD
     I              A1BECD                          WLBECD
     I              A1AAVN                          WLAAVN
     I              A1AADT                          WLAADT
     I              A1AMTM                          WLAMTM
     I              A1AJST                          WLAJST
     I              A1AHVN                          WLAHVN
     I              A1AGVN                          WLAGVN
     I              A1ABVN                          WLABVN
     I              A1ABDT                          WLABDT
     I              A1ABTM                          WLABTM
      *
     I@CCCPUX
      * M3 Supplier Payment Head  Update index
      * Renamed input format fields
     I              CCWJA1                          WMWJA1
     I              CCQXCD                          WMQXCD
     I              CCWOA1                          WMWOA1
     I              CCQYCD                          WMQYCD
     I              CCQZCD                          WMQZCD
     I              CCQ0CD                          WMQ0CD
     I              CCQ1CD                          WMQ1CD
     I              CCWPA1                          WMWPA1
     I              CCAFDX                          WMAFDX
     I              CCQ5CD                          WMQ5CD
     I              CCQ6CD                          WMQ6CD
     I              CCLFVA                          WMLFVA
     I              CCLGVA                          WMLGVA
     I              CCLNVA                          WMLNVA
     I              CCLHVA                          WMLHVA
     I              CCLIVA                          WMLIVA
     I              CCG3SS                          WMG3SS
     I              CCWYA1                          WMWYA1
     I              CCQ2CD                          WMQ2CD
     I              CCQ3CD                          WMQ3CD
     I              CCWSA1                          WMWSA1
     I              CCAKT1                          WMAKT1
     I              CCWXA1                          WMWXA1
     I              CCAXT1                          WMAXT1
     I              CCQ7CD                          WMQ7CD
     I              CCG2SS                          WMG2SS
     I              CCANT1                          WMANT1
     I              CCAOT1                          WMAOT1
     I              CCAGDX                          WMAGDX
     I              CCB0TM                          WMB0TM
     I              CCART1                          WMART1
     I              CCLOVA                          WMLOVA
     I              CCRACD                          WMRACD
     I              CCLPVA                          WMLPVA
     I              CCAIDX                          WMAIDX
     I              CCAZT1                          WMAZT1
     I              CCAJDX                          WMAJDX
     I              CCA0T1                          WMA0T1
     I              CCRBCD                          WMRBCD
     I              CCRCCD                          WMRCCD
     I              CCAKDX                          WMAKDX
     I              CCALDX                          WMALDX
     I              CCW1A1                          WMW1A1
     I              CCLQVA                          WMLQVA
     I              CCAODX                          WMAODX
     I              CCLRVA                          WMLRVA
     I              CCLVVA                          WMLVVA
     I              CCAMDX                          WMAMDX
     I              CCW2A1                          WMW2A1
     I              CCLSVA                          WMLSVA
     I              CCLTVA                          WMLTVA
     I              CCLUVA                          WMLUVA
     I              CCA1T1                          WMA1T1
     I              CCW3A1                          WMW3A1
     I              CCRDCD                          WMRDCD
     I              CCRECD                          WMRECD
     I              CCRFCD                          WMRFCD
     I              CCRGCD                          WMRGCD
     I              CCA2T1                          WMA2T1
     I              CCA3T1                          WMA3T1
     I              CCA4T1                          WMA4T1
     I              CCA5T1                          WMA5T1
     I              CCA6T1                          WMA6T1
     I              CCA7T1                          WMA7T1
     I              CCANDX                          WMANDX
     I              CCRHCD                          WMRHCD
     I              CCW4A1                          WMW4A1
     I              CCW5A1                          WMW5A1
     I              CCA8T1                          WMA8T1
     I              CCW6A1                          WMW6A1
     I              CCA9T1                          WMA9T1
     I              CCW7A1                          WMW7A1
     I              CCW8A1                          WMW8A1
     I              CCG5SS                          WMG5SS
     I              CCAPDX                          WMAPDX
     I              CCB1TM                          WMB1TM
     I              CCAAVN                          WMAAVN
     I              CCAADT                          WMAADT
     I              CCAMTM                          WMAMTM
     I              CCAJST                          WMAJST
     I              CCAHVN                          WMAHVN
     I              CCAGVN                          WMAGVN
     I              CCABVN                          WMABVN
     I              CCABDT                          WMABDT
     I              CCABTM                          WMABTM
      *
     I@CFCPU4
      * M3 Supplier Payment Addl  Update index
      * Renamed input format fields
     I              CFWJA1                          WOWJA1
     I              CFQXCD                          WOQXCD
     I              CFWOA1                          WOWOA1
     I              CFQ8CD                          WOQ8CD
     I              CFAYT1                          WOAYT1
     I              CFW0A1                          WOW0A1
     I              CFWHA1                          WOWHA1
     I              CFWZA1                          WOWZA1
     I              CFAGDX                          WOAGDX
     I              CFB0TM                          WOB0TM
     I              CFAHDX                          WOAHDX
     I              CFWIA1                          WOWIA1
     I              CFQ9CD                          WOQ9CD
      *
     I@BLCPEI
      * Hog Voucher Detail        Update index
      * Renamed input format fields
     I              BLHNNB                          WRHNNB
     I              BLLWNB                          WRLWNB
     I              BLG9NB                          WRG9NB
     I              BLDLNB                          WRDLNB
     I              BLCNPR                          WRCNPR
     I              BLCOPR                          WRCOPR
     I              BLCPPR                          WRCPPR
     I              BLCQPR                          WRCQPR
     I              BLCRPR                          WRCRPR
     I              BLAKVA                          WRAKVA
     I              BLALVA                          WRALVA
     I              BLCVPR                          WRCVPR
     I              BLAMVA                          WRAMVA
     I              BLAEPC                          WRAEPC
     I              BLI6ST                          WRI6ST
     I              BLJIST                          WRJIST
     I              BLJPST                          WRJPST
     I              BLC2SS                          WRC2SS
     I              BLOTCD                          WROTCD
     I              BLF5TX                          WRF5TX
     I              BLL5A1                          WRL5A1
     I              BLL6A1                          WRL6A1
     I              BLJQST                          WRJQST
     I              BLC4SS                          WRC4SS
     I              BLC5SS                          WRC5SS
     I              BLC3SS                          WRC3SS
     I              BLOKA1                          WROKA1
     I              BLOLA1                          WROLA1
     I              BLOMA1                          WROMA1
     I              BLQ0CD                          WRQ0CD
     I              BLWSA1                          WRWSA1
     I              BLWOA1                          WRWOA1
     I              BLHFDT                          WRHFDT
     I              BLB2TM                          WRB2TM
     I              BLHMNB                          WRHMNB
     I              BLBNNB                          WRBNNB
     I              BLBONB                          WRBONB
     I              BLCVNB                          WRCVNB
     I              BLB0DT                          WRB0DT
     I              BLABCD                          WRABCD
     I              BLAECD                          WRAECD
     I              BLAAVN                          WRAAVN
     I              BLAADT                          WRAADT
     I              BLAMTM                          WRAMTM
     I              BLAJST                          WRAJST
     I              BLAHVN                          WRAHVN
     I              BLAGVN                          WRAGVN
     I              BLABVN                          WRABVN
     I              BLABDT                          WRABDT
     I              BLABTM                          WRABTM
      *
     I@BBRED5
      * Deduction/Addition        Retrieval index
      * Renamed input format fields
     I              BBBQCD                          WSBQCD
     I              BBBLTX                          WSBLTX
     I              BBB9ST                          WSB9ST
     I              BBCAST                          WSCAST
     I              BBAEPR                          WSAEPR
     I              BBI9ST                          WSI9ST
     I              BBCBST                          WSCBST
     I              BBI2ST                          WSI2ST
     I              BBF7TX                          WSF7TX
     I              BBE2CD                          WSE2CD
     I              BBOTNB                          WSOTNB
     I              BBNSST                          WSNSST
     I              BBNTST                          WSNTST
     I              BBNUST                          WSNUST
     I              BBNVST                          WSNVST
     I              BBNWST                          WSNWST
     I              BBNXST                          WSNXST
     I              BBNYST                          WSNYST
     I              BBNZST                          WSNZST
     I              BBN1ST                          WSN1ST
     I              BBN0ST                          WSN0ST
     I              BBRICD                          WSRICD
     I              BBRJCD                          WSRJCD
     I              BBBAT1                          WSBAT1
     I              BBBBT1                          WSBBT1
     I              BBAAVN                          WSAAVN
     I              BBAADT                          WSAADT
     I              BBAMTM                          WSAMTM
     I              BBAJST                          WSAJST
     I              BBAHVN                          WSAHVN
     I              BBAGVN                          WSAGVN
     I              BBABVN                          WSABVN
     I              BBABDT                          WSABDT
     I              BBABTM                          WSABTM
      *
     I@CDCPIU
      * Tattoo Ded/Add            Retrieval index
      * Renamed input format fields
     I              CDHMNB                          WTHMNB
     I              CDBNNB                          WTBNNB
     I              CDBONB                          WTBONB
     I              CDCVNB                          WTCVNB
     I              CDB0DT                          WTB0DT
     I              CDBQCD                          WTBQCD
     I              CDAZVA                          WTAZVA
     I              CDA0VA                          WTA0VA
     I              CDJBST                          WTJBST
     I              CDEIST                          WTEIST
     I              CDJDST                          WTJDST
     I              CDDPCD                          WTDPCD
     I              CDE3CD                          WTE3CD
     I              CDAQNB                          WTAQNB
     I              CDOCST                          WTOCST
     I              CDPEST                          WTPEST
     I              CDPFST                          WTPFST
     I              CDPGST                          WTPGST
     I              CDPIST                          WTPIST
     I              CDPJST                          WTPJST
     I              CDPKST                          WTPKST
     I              CDPLST                          WTPLST
     I              CDAAVN                          WTAAVN
     I              CDAADT                          WTAADT
     I              CDAMTM                          WTAMTM
     I              CDAJST                          WTAJST
     I              CDAHVN                          WTAHVN
     I              CDAGVN                          WTAGVN
     I              CDABVN                          WTABVN
     I              CDABDT                          WTABDT
     I              CDABTM                          WTABTM
      *
     I@A1CPOC
      * Tattoo Header             Co/BOL/Kill/Ttt
      * Renamed input format fields
     I              A1HMNB                          WVHMNB
     I              A1BNNB                          WVBNNB
     I              A1BONB                          WVBONB
     I              A1CVNB                          WVCVNB
     I              A1B0DT                          WVB0DT
     I              A1AWDT                          WVAWDT
     I              A1BICD                          WVBICD
     I              A1CPST                          WVCPST
     I              A1ACPR                          WVACPR
     I              A1B9PR                          WVB9PR
     I              A1CAPR                          WVCAPR
     I              A1C4ST                          WVC4ST
     I              A1AIPR                          WVAIPR
     I              A1A6DT                          WVA6DT
     I              A1C2ST                          WVC2ST
     I              A1CXNB                          WVCXNB
     I              A1CWNB                          WVCWNB
     I              A1FCNB                          WVFCNB
     I              A1H9NB                          WVH9NB
     I              A1FDNB                          WVFDNB
     I              A1FENB                          WVFENB
     I              A1HENB                          WVHENB
     I              A1HFNB                          WVHFNB
     I              A1CYNB                          WVCYNB
     I              A1LRNB                          WVLRNB
     I              A1E0NB                          WVE0NB
     I              A1A5PC                          WVA5PC
     I              A1FBNB                          WVFBNB
     I              A1A4PC                          WVA4PC
     I              A1F7NB                          WVF7NB
     I              A1HDNB                          WVHDNB
     I              A1F5NB                          WVF5NB
     I              A1F4NB                          WVF4NB
     I              A1F3NB                          WVF3NB
     I              A1F2NB                          WVF2NB
     I              A1AVPC                          WVAVPC
     I              A1AWPC                          WVAWPC
     I              A1CWPC                          WVCWPC
     I              A1A8PC                          WVA8PC
     I              A1A7PC                          WVA7PC
     I              A1B8PR                          WVB8PR
     I              A1AMPR                          WVAMPR
     I              A1ANPR                          WVANPR
     I              A1AYVA                          WVAYVA
     I              A1AWVA                          WVAWVA
     I              A1AOPR                          WVAOPR
     I              A1AXVA                          WVAXVA
     I              A1APPR                          WVAPPR
     I              A1ASPR                          WVASPR
     I              A1A4VA                          WVA4VA
     I              A1ATPR                          WVATPR
     I              A1A5VA                          WVA5VA
     I              A1CBPR                          WVCBPR
     I              A1CCPR                          WVCCPR
     I              A1LPNB                          WVLPNB
     I              A1CDPR                          WVCDPR
     I              A1A7VA                          WVA7VA
     I              A1A2PR                          WVA2PR
     I              A1JWST                          WVJWST
     I              A1CWST                          WVCWST
     I              A1D7ST                          WVD7ST
     I              A1D8ST                          WVD8ST
     I              A1DWST                          WVDWST
     I              A1D6ST                          WVD6ST
     I              A1GHNB                          WVGHNB
     I              A1BYDT                          WVBYDT
     I              A1E0ST                          WVE0ST
     I              A1E1ST                          WVE1ST
     I              A1E2ST                          WVE2ST
     I              A1BSDT                          WVBSDT
     I              A1BTDT                          WVBTDT
     I              A1BUDT                          WVBUDT
     I              A1HGNB                          WVHGNB
     I              A1HHNB                          WVHHNB
     I              A1HINB                          WVHINB
     I              A1A3PR                          WVA3PR
     I              A1A4PR                          WVA4PR
     I              A1A6PR                          WVA6PR
     I              A1J9NB                          WVJ9NB
     I              A1D6PR                          WVD6PR
     I              A1D7PR                          WVD7PR
     I              A1D8PR                          WVD8PR
     I              A1D9PR                          WVD9PR
     I              A1EAPR                          WVEAPR
     I              A1EBPR                          WVEBPR
     I              A1ECPR                          WVECPR
     I              A1EDPR                          WVEDPR
     I              A1EEPR                          WVEEPR
     I              A1EFPR                          WVEFPR
     I              A1EGPR                          WVEGPR
     I              A1EHPR                          WVEHPR
     I              A1KAST                          WVKAST
     I              A1J7ST                          WVJ7ST
     I              A1J9ST                          WVJ9ST
     I              A1OXNB                          WVOXNB
     I              A1LKST                          WVLKST
     I              A1LLST                          WVLLST
     I              A1J8ST                          WVJ8ST
     I              A1LIST                          WVLIST
     I              A1LJST                          WVLJST
     I              A1NZTX                          WVNZTX
     I              A1HJCD                          WVHJCD
     I              A1R4ST                          WVR4ST
     I              A1R5ST                          WVR5ST
     I              A1R6ST                          WVR6ST
     I              A1R7ST                          WVR7ST
     I              A1THWT                          WVTHWT
     I              A1T2WT                          WVT2WT
     I              A1THHD                          WVTHHD
     I              A1T2HD                          WVT2HD
     I              A1OBPR                          WVOBPR
     I              A1KOER                          WVKOER
     I              A1OPIR                          WVOPIR
     I              A1OPEM                          WVOPEM
     I              A1IORP                          WVIORP
     I              A1OWEO                          WVOWEO
     I              A1OQET                          WVOQET
     I              A1URST                          WVURST
     I              A1USST                          WVUSST
     I              A1HHPC                          WVHHPC
     I              A1S9PR                          WVS9PR
     I              A1TAPR                          WVTAPR
     I              A1TBPR                          WVTBPR
     I              A1JFUR                          WVJFUR
     I              A1KRIF                          WVKRIF
     I              A1KORF                          WVKORF
     I              A1KAPR                          WVKAPR
     I              A1KROT                          WVKROT
     I              A1OTJG                          WVOTJG
     I              A1IRJG                          WVIRJG
     I              A1IMJF                          WVIMJF
     I              A1IRGF                          WVIRGF
     I              A1KRJF                          WVKRJF
     I              A1OJRF                          WVOJRF
     I              A1KFOR                          WVKFOR
     I              A1ORJK                          WVORJK
     I              A1OMVJ                          WVOMVJ
     I              A1MVNF                          WVMVNF
     I              A1MCNF                          WVMCNF
     I              A1NCNF                          WVNCNF
     I              A1NCHF                          WVNCHF
     I              A1IGIR                          WVIGIR
     I              A1KFJR                          WVKFJR
     I              A1EADT                          WVEADT
     I              A1EBDT                          WVEBDT
     I              A1ECDT                          WVECDT
     I              A1EDDT                          WVEDDT
     I              A1EEDT                          WVEEDT
     I              A1U4ST                          WVU4ST
     I              A1U5ST                          WVU5ST
     I              A1U6ST                          WVU6ST
     I              A1U7ST                          WVU7ST
     I              A1U8ST                          WVU8ST
     I              A1U9ST                          WVU9ST
     I              A1VAST                          WVVAST
     I              A1VBST                          WVVBST
     I              A1BDCD                          WVBDCD
     I              A1CSCD                          WVCSCD
     I              A1ABCD                          WVABCD
     I              A1AECD                          WVAECD
     I              A1ACCD                          WVACCD
     I              A1AGCD                          WVAGCD
     I              A1BECD                          WVBECD
     I              A1AAVN                          WVAAVN
     I              A1AADT                          WVAADT
     I              A1AMTM                          WVAMTM
     I              A1AJST                          WVAJST
     I              A1AHVN                          WVAHVN
     I              A1AGVN                          WVAGVN
     I              A1ABVN                          WVABVN
     I              A1ABDT                          WVABDT
     I              A1ABTM                          WVABTM
      *
     I@CCCPU7
      * M3 Supplier Payment Head  Co/Div/Supplier/SupplInv
      * Renamed input format fields
     I              CCWJA1                          WWWJA1
     I              CCQXCD                          WWQXCD
     I              CCWOA1                          WWWOA1
     I              CCQYCD                          WWQYCD
     I              CCQZCD                          WWQZCD
     I              CCQ0CD                          WWQ0CD
     I              CCQ1CD                          WWQ1CD
     I              CCWPA1                          WWWPA1
     I              CCAFDX                          WWAFDX
     I              CCQ5CD                          WWQ5CD
     I              CCQ6CD                          WWQ6CD
     I              CCLFVA                          WWLFVA
     I              CCLGVA                          WWLGVA
     I              CCLNVA                          WWLNVA
     I              CCLHVA                          WWLHVA
     I              CCLIVA                          WWLIVA
     I              CCG3SS                          WWG3SS
     I              CCWYA1                          WWWYA1
     I              CCQ2CD                          WWQ2CD
     I              CCQ3CD                          WWQ3CD
     I              CCWSA1                          WWWSA1
     I              CCAKT1                          WWAKT1
     I              CCWXA1                          WWWXA1
     I              CCAXT1                          WWAXT1
     I              CCQ7CD                          WWQ7CD
     I              CCG2SS                          WWG2SS
     I              CCANT1                          WWANT1
     I              CCAOT1                          WWAOT1
     I              CCAGDX                          WWAGDX
     I              CCB0TM                          WWB0TM
     I              CCART1                          WWART1
     I              CCLOVA                          WWLOVA
     I              CCRACD                          WWRACD
     I              CCLPVA                          WWLPVA
     I              CCAIDX                          WWAIDX
     I              CCAZT1                          WWAZT1
     I              CCAJDX                          WWAJDX
     I              CCA0T1                          WWA0T1
     I              CCRBCD                          WWRBCD
     I              CCRCCD                          WWRCCD
     I              CCAKDX                          WWAKDX
     I              CCALDX                          WWALDX
     I              CCW1A1                          WWW1A1
     I              CCLQVA                          WWLQVA
     I              CCAODX                          WWAODX
     I              CCLRVA                          WWLRVA
     I              CCLVVA                          WWLVVA
     I              CCAMDX                          WWAMDX
     I              CCW2A1                          WWW2A1
     I              CCLSVA                          WWLSVA
     I              CCLTVA                          WWLTVA
     I              CCLUVA                          WWLUVA
     I              CCA1T1                          WWA1T1
     I              CCW3A1                          WWW3A1
     I              CCRDCD                          WWRDCD
     I              CCRECD                          WWRECD
     I              CCRFCD                          WWRFCD
     I              CCRGCD                          WWRGCD
     I              CCA2T1                          WWA2T1
     I              CCA3T1                          WWA3T1
     I              CCA4T1                          WWA4T1
     I              CCA5T1                          WWA5T1
     I              CCA6T1                          WWA6T1
     I              CCA7T1                          WWA7T1
     I              CCANDX                          WWANDX
     I              CCRHCD                          WWRHCD
     I              CCW4A1                          WWW4A1
     I              CCW5A1                          WWW5A1
     I              CCA8T1                          WWA8T1
     I              CCW6A1                          WWW6A1
     I              CCA9T1                          WWA9T1
     I              CCW7A1                          WWW7A1
     I              CCW8A1                          WWW8A1
     I              CCG5SS                          WWG5SS
     I              CCAPDX                          WWAPDX
     I              CCB1TM                          WWB1TM
     I              CCAAVN                          WWAAVN
     I              CCAADT                          WWAADT
     I              CCAMTM                          WWAMTM
     I              CCAJST                          WWAJST
     I              CCAHVN                          WWAHVN
     I              CCAGVN                          WWAGVN
     I              CCABVN                          WWABVN
     I              CCABDT                          WWABDT
     I              CCABTM                          WWABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPLCE1    E DSPLCEREL0
      * UPD : M3 Voucher Number Series  Update index
      * Renamed input format fields
     I              CEQ4CD                          WDQ4CD
     I              CEAPT1                          WDAPT1
     I              CEWTA1                          WDWTA1
     I              CEWUA1                          WDWUA1
     I              CEWVA1                          WDWVA1
     I              CEAAVN                          WDAAVN
     I              CEAADT                          WDAADT
     I              CEAMTM                          WDAMTM
     I              CEAJST                          WDAJST
     I              CEAHVN                          WDAHVN
     I              CEAGVN                          WDAGVN
     I              CEABVN                          WDABVN
     I              CEABDT                          WDABDT
     I              CEABTM                          WDABTM
      *
     IYARDCS      DS                            100
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            100
     IQPLCC1    E DSPLCCCPL0
      * UPD : M3 Supplier Payment Head  Update index
      * Renamed input format fields
     I              CCWJA1                          WMWJA1
     I              CCQXCD                          WMQXCD
     I              CCWOA1                          WMWOA1
     I              CCQYCD                          WMQYCD
     I              CCQZCD                          WMQZCD
     I              CCQ0CD                          WMQ0CD
     I              CCQ1CD                          WMQ1CD
     I              CCWPA1                          WMWPA1
     I              CCAFDX                          WMAFDX
     I              CCQ5CD                          WMQ5CD
     I              CCQ6CD                          WMQ6CD
     I              CCLFVA                          WMLFVA
     I              CCLGVA                          WMLGVA
     I              CCLNVA                          WMLNVA
     I              CCLHVA                          WMLHVA
     I              CCLIVA                          WMLIVA
     I              CCG3SS                          WMG3SS
     I              CCWYA1                          WMWYA1
     I              CCQ2CD                          WMQ2CD
     I              CCQ3CD                          WMQ3CD
     I              CCWSA1                          WMWSA1
     I              CCAKT1                          WMAKT1
     I              CCWXA1                          WMWXA1
     I              CCAXT1                          WMAXT1
     I              CCQ7CD                          WMQ7CD
     I              CCG2SS                          WMG2SS
     I              CCANT1                          WMANT1
     I              CCAOT1                          WMAOT1
     I              CCAGDX                          WMAGDX
     I              CCB0TM                          WMB0TM
     I              CCART1                          WMART1
     I              CCLOVA                          WMLOVA
     I              CCRACD                          WMRACD
     I              CCLPVA                          WMLPVA
     I              CCAIDX                          WMAIDX
     I              CCAZT1                          WMAZT1
     I              CCAJDX                          WMAJDX
     I              CCA0T1                          WMA0T1
     I              CCRBCD                          WMRBCD
     I              CCRCCD                          WMRCCD
     I              CCAKDX                          WMAKDX
     I              CCALDX                          WMALDX
     I              CCW1A1                          WMW1A1
     I              CCLQVA                          WMLQVA
     I              CCAODX                          WMAODX
     I              CCLRVA                          WMLRVA
     I              CCLVVA                          WMLVVA
     I              CCAMDX                          WMAMDX
     I              CCW2A1                          WMW2A1
     I              CCLSVA                          WMLSVA
     I              CCLTVA                          WMLTVA
     I              CCLUVA                          WMLUVA
     I              CCA1T1                          WMA1T1
     I              CCW3A1                          WMW3A1
     I              CCRDCD                          WMRDCD
     I              CCRECD                          WMRECD
     I              CCRFCD                          WMRFCD
     I              CCRGCD                          WMRGCD
     I              CCA2T1                          WMA2T1
     I              CCA3T1                          WMA3T1
     I              CCA4T1                          WMA4T1
     I              CCA5T1                          WMA5T1
     I              CCA6T1                          WMA6T1
     I              CCA7T1                          WMA7T1
     I              CCANDX                          WMANDX
     I              CCRHCD                          WMRHCD
     I              CCW4A1                          WMW4A1
     I              CCW5A1                          WMW5A1
     I              CCA8T1                          WMA8T1
     I              CCW6A1                          WMW6A1
     I              CCA9T1                          WMA9T1
     I              CCW7A1                          WMW7A1
     I              CCW8A1                          WMW8A1
     I              CCG5SS                          WMG5SS
     I              CCAPDX                          WMAPDX
     I              CCB1TM                          WMB1TM
     I              CCAAVN                          WMAAVN
     I              CCAADT                          WMAADT
     I              CCAMTM                          WMAMTM
     I              CCAJST                          WMAJST
     I              CCAHVN                          WMAHVN
     I              CCAGVN                          WMAGVN
     I              CCABVN                          WMABVN
     I              CCABDT                          WMABDT
     I              CCABTM                          WMABTM
      *
     IYCRDCS      DS                            770
     IQPLCF1    E DSPLCFCPL0
      * UPD : M3 Supplier Payment Addl  Update index
      * Renamed input format fields
     I              CFWJA1                          WOWJA1
     I              CFQXCD                          WOQXCD
     I              CFWOA1                          WOWOA1
     I              CFQ8CD                          WOQ8CD
     I              CFAYT1                          WOAYT1
     I              CFW0A1                          WOW0A1
     I              CFWHA1                          WOWHA1
     I              CFWZA1                          WOWZA1
     I              CFAGDX                          WOAGDX
     I              CFB0TM                          WOB0TM
     I              CFAHDX                          WOAHDX
     I              CFWIA1                          WOWIA1
     I              CFQ9CD                          WOQ9CD
      *
     IQPKBL1    E DSPKBLCPL0
      * UPD : Hog Voucher Detail        Update index
      * Renamed input format fields
     I              BLHNNB                          WRHNNB
     I              BLLWNB                          WRLWNB
     I              BLG9NB                          WRG9NB
     I              BLDLNB                          WRDLNB
     I              BLCNPR                          WRCNPR
     I              BLCOPR                          WRCOPR
     I              BLCPPR                          WRCPPR
     I              BLCQPR                          WRCQPR
     I              BLCRPR                          WRCRPR
     I              BLAKVA                          WRAKVA
     I              BLALVA                          WRALVA
     I              BLCVPR                          WRCVPR
     I              BLAMVA                          WRAMVA
     I              BLAEPC                          WRAEPC
     I              BLI6ST                          WRI6ST
     I              BLJIST                          WRJIST
     I              BLJPST                          WRJPST
     I              BLC2SS                          WRC2SS
     I              BLOTCD                          WROTCD
     I              BLF5TX                          WRF5TX
     I              BLL5A1                          WRL5A1
     I              BLL6A1                          WRL6A1
     I              BLJQST                          WRJQST
     I              BLC4SS                          WRC4SS
     I              BLC5SS                          WRC5SS
     I              BLC3SS                          WRC3SS
     I              BLOKA1                          WROKA1
     I              BLOLA1                          WROLA1
     I              BLOMA1                          WROMA1
     I              BLQ0CD                          WRQ0CD
     I              BLWSA1                          WRWSA1
     I              BLWOA1                          WRWOA1
     I              BLHFDT                          WRHFDT
     I              BLB2TM                          WRB2TM
     I              BLHMNB                          WRHMNB
     I              BLBNNB                          WRBNNB
     I              BLBONB                          WRBONB
     I              BLCVNB                          WRCVNB
     I              BLB0DT                          WRB0DT
     I              BLABCD                          WRABCD
     I              BLAECD                          WRAECD
     I              BLAAVN                          WRAAVN
     I              BLAADT                          WRAADT
     I              BLAMTM                          WRAMTM
     I              BLAJST                          WRAJST
     I              BLAHVN                          WRAHVN
     I              BLAGVN                          WRAGVN
     I              BLABVN                          WRABVN
     I              BLABDT                          WRABDT
     I              BLABTM                          WRABTM
      *
     IYDRDCS      DS                            225
     IYERDCS      DS                            100
     IYFRDCS      DS                            100
     IYGRDCS      DS                            770
     IYHRDCS      DS                            100
     IYIRDCS      DS                            100
     IYJRDCS      DS                            770
     IYKRDCS      DS                            770
     IYLRDCS      DS                            100
     IYMRDCS      DS                            100
     IYNRDCS      DS                            770
     IYORDCS      DS                            100
     IYPRDCS      DS                            100
     IYQRDCS      DS                            770
     IYRRDCS      DS                            770
     IYSRDCS      DS                            100
     IYTRDCS      DS                            100
     IYURDCS      DS                            770
     IYVRDCS      DS                            100
     IYWRDCS      DS                            100
     IYXRDCS      DS                            770
     IYYRDCS      DS                            770
     IYZRDCS      DS                            100
     IY0RDCS      DS                            100
     IY1RDCS      DS                            770
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Hog Voucher Header
      * I :  VCH Company number
     I                                    P   1   20P1HNNB
      * I :  VCH Batch Number
     I                                    P   3   50P1LWNB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HNNB    PARM           WP0001  30       VCH Company num
     C           P1LWNB    PARM           WP0002  50       VCH Batch Numbe
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Crt Prd Vch p/BatchXF
      * From Date
     C                     MOVEL*BLANK    YL0001           Date CDE USR
     C                     MOVEL##JDT     YL0001           Date CDE USR
     C                     MOVELYL0001    YL0002           Date From Conve
      * Cvt Date              UP - STR Miscellaneous  * 
     C                     CALL 'PKPOUPR'              90  Cvt Date
     C                     PARM YL0002    WQ0001 10        Date From Conve
     C           YL0003    PARM *BLANK    WQ0002 11        Date To Convert
     C                     PARM '*CYMD'   WQ0003  8        Date From Forma
     C                     PARM '*YYMD'   WQ0004  8        Date To Format
     C                     PARM '*NONE'   WQ0005  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0003    YL0004           Date To Format
     C                     MOVE YL0004    YL0005           MGL Entry Date
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HNNB    WQ0006  30       BOH Company Num
     C                     PARM 'M3HPEVCH'WQ0007 10        Company Value C
     C           YL0006    PARM *BLANK    WQ0008 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Value Nbr XF - STR Order Management Sys  * 
     C                     CALL 'PDHGXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HNNB    WQ0009  30       BOH Company Num
     C                     PARM @CN,001   WQ0010 10        Company Value C
     C           YL0007    PARM *ZERO     WQ0011 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HNNB    WQ0012  30       BOH Company Num
     C                     PARM @CN,002   WQ0013 10        Company Value C
     C           YL0008    PARM *BLANK    WQ0014 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HNNB    WQ0015  30       BOH Company Num
     C                     PARM @CN,003   WQ0016 10        Company Value C
     C           YL0009    PARM *BLANK    WQ0017 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HNNB    WQ0018  30       BOH Company Num
     C                     PARM @CN,004   WQ0019 10        Company Value C
     C           YL0010    PARM *BLANK    WQ0020 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Crt M3 Vchr Head  RT - Hog Voucher Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'HPE'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSNA     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0061           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR NBCHRC
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHNB    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHNB    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YPRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCCRRC    BEGSR
      *================================================================
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CCCPUX
     C                     Z-ADDYL0007    WMWJA1           MGL Company
     C                     MOVELYL0008    WMQXCD           MGL Division
     C                     Z-ADDYL0060    WMWOA1           MGL Invoice Bat
     C                     MOVELYL0039    WMQYCD           MGL Payee
     C                     MOVELYL0040    WMQZCD           MGL Supplier
     C                     MOVELYL0059    WMQ0CD           MGL Supplier In
     C                     MOVEL'30'      WMQ1CD           MGL Invoice Bat
     C                     Z-ADD10        WMWPA1           MGL Invoice Sta
     C                     Z-ADDYL0016    WMAFDX           MGL Invoice Dat
     C                     MOVELWN0001    WMQ5CD           MGL Currency
     C                     MOVELWN0002    WMQ6CD           MGL Payment Ter
     C                     Z-ADD*ZERO     WMLFVA           MGL Total Line
     C                     Z-ADD*ZERO     WMLGVA           MGL Cash Discou
     C                     Z-ADDYL0055    WMLNVA           MGL Foreign Cur
     C                     Z-ADD*ZERO     WMLHVA           MGL Total Charg
     C                     Z-ADD*ZERO     WMLIVA           MGL Total Due
     C                     MOVEL'0'       WMG3SS           MGL Invoice Mat
     C                     Z-ADD*ZERO     WMWYA1           MGL Service Cod
     C                     MOVELWN0003    WMQ2CD           MGL Payment Met
     C                     MOVELYL0011    WMQ3CD           MGL Voucher Num
     C                     Z-ADDYL0061    WMWSA1           MGL Voucher Num
     C                     MOVELYL0025    WMAKT1           MGL Description
     C                     Z-ADD01        WMWXA1           MGL Exchange Ra
     C                     MOVEL*BLANK    WMAXT1           MGL Purchase Or
     C                     MOVEL*BLANK    WMQ7CD           MGL Cash discou
     C                     MOVELWN0004    WMG2SS           MGL Get Payee D
     C                     MOVELYL0017    WMANT1           MGL Job Number
     C                     MOVEL##PGM     WMAOT1           MGL Job Name
     C                     Z-ADDYL0005    WMAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WMB0TM           MGL Entry Time
     C                     MOVEL*BLANK    WMART1           MGL Reference N
     C                     Z-ADD*ZERO     WMLOVA           MGL Exchange ra
     C                     MOVEL*BLANK    WMRACD           MGL Trade code
     C                     Z-ADD*ZERO     WMLPVA           MGL VAT
     C                     Z-ADDYL0016    WMAIDX           MGL Accounting
     C                     MOVELYL0010    WMAZT1           MGL Authorized
     C                     Z-ADD*ZERO     WMAJDX           MGL Due date
     C                     MOVEL*BLANK    WMA0T1           MGL Future rate
     C                     MOVEL*BLANK    WMRBCD           MGL From/to cou
     C                     MOVEL*BLANK    WMRCCD           MGL Base countr
     C                     Z-ADD*ZERO     WMAKDX           MGL Order date
     C                     Z-ADD*ZERO     WMALDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW1A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLQVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAODX           MGL Cash discou
     C                     Z-ADD*ZERO     WMLRVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLVVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAMDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW2A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLSVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLTVA           MGL Total taxab
     C                     Z-ADD*ZERO     WMLUVA           MGL Prepaid amo
     C                     MOVEL*BLANK    WMA1T1           MGL VAT reg num
     C                     Z-ADD*ZERO     WMW3A1           MGL Tax applica
     C                     MOVEL*BLANK    WMRDCD           MGL Document co
     C                     MOVE *BLANK    WMRECD           MGL AP standard
     C                     MOVEL'01'      WMRECD           MGL AP standard
     C                     MOVELYL0063    WMRFCD           MGL Debit note
     C                     MOVEL*BLANK    WMRGCD           MGL Our invoici
     C                     MOVEL*BLANK    WMA2T1           MGL Text line 1
     C                     MOVEL*BLANK    WMA3T1           MGL Text line 2
     C                     MOVEL*BLANK    WMA4T1           MGL Text line 3
     C                     MOVEL*BLANK    WMA5T1           MGL EAN loc cod
     C                     MOVEL*BLANK    WMA6T1           MGL EAN loc cde
     C                     MOVEL*BLANK    WMA7T1           MGL EAN loc cod
     C                     Z-ADD*ZERO     WMANDX           MGL Delivery da
     C                     MOVEL*BLANK    WMRHCD           MGL Bank accoun
     C                     Z-ADD*ZERO     WMW4A1           MGL Geographica
     C                     Z-ADD*ZERO     WMW5A1           MGL Tax include
     C                     MOVEL*BLANK    WMA8T1           MGL Original in
     C                     Z-ADD*ZERO     WMW6A1           MGL Original ye
     C                     MOVEL*BLANK    WMA9T1           MGL Payment req
     C                     Z-ADD*ZERO     WMW7A1           MGL Year
     C                     Z-ADD*ZERO     WMW8A1           MGL Partial val
     C                     MOVEL'0'       WMG5SS           MGL ERP Process
     C                     Z-ADD*ZERO     WMAPDX           MGL ERP Process
     C                     Z-ADD*ZERO     WMB1TM           MGL ERP Process
     C                     MOVEL*BLANK    WMAAVN           RS User Changed
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     MOVELWTAJST    WMAJST           RS Record Statu
     C                     MOVELWTAHVN    WMAHVN           RS Job
     C                     MOVELWTAGVN    WMAGVN           RS Program
     C                     MOVELWTABVN    WMABVN           RS User Added
     C                     Z-ADDWTABDT    WMABDT           RS Date Added
     C                     Z-ADDWTABTM    WMABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVEL##USR     WMABVN           RS User Added
     C                     Z-ADD##JDT     WMABDT           RS Date Added
     C                     Z-ADD##JTM     WMABTM           RS Time Added
     C                     MOVEL##PGM     WMAGVN           RS Program
     C                     MOVEL##JOB     WMAHVN           RS Job
     C           KLCRNC    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
      * Check for duplicate primary key
     C           KLCRNC    SETLL@CCCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1374' W0RTN   7
      * USER: Processing if Data record already exists
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR NDCHRC
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C                     WRITE@CCCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDCHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @CCCPUX
      *
     C           KLCHND    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHND    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    YQRDCS
      * Move non-key fields to @CCCPUX
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NECRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD412       WOQ8CD           MGL AP Informat
     C                     MOVELYL0026    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRNE    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRNE    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD413       WOQ8CD           MGL AP Informat
     C                     MOVELYL0009    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRNF    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRNF    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * Rtv Add H/O SpplInv#  RT - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWWJA1    WQNG01           MGL Company
     C           *LIKE     DEFN WWQXCD    WQNG02           MGL Division
     C           *LIKE     DEFN WWQZCD    WQNG03           MGL Supplier
     C           *LIKE     DEFN WWQ0CD    WQNG04           MGL Supplier In
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           WQNG01           MGL Company
     C                     KFLD           WQNG02           MGL Division
     C                     KFLD           WQNG03           MGL Supplier
     C                     KFLD           WQNG04           MGL Supplier In
      * Setup key
     C                     Z-ADDYL0007    WQNG01           MGL Company
     C                     MOVELYL0008    WQNG02           MGL Division
     C                     MOVELYL0040    WQNG03           MGL Supplier
     C                     MOVELYL0059    WQNG04           MGL Supplier In
      * Establish starting position
     C           KRSNG     SETLL@CCCPU7                    *
     C           KRSNG     READE@CCCPU7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1373' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.MGL ERP Process Sts is Not Processed
     C           WWG5SS    IFEQ '0'                        *IF
     C           WWLNVA    ADD  YL0055    YL0062           PAD Transaction
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR NHCHRC
     C                     END                             *FI
     C           KRSNG     READE@CCCPU7                  90*
     C                     ENDDO
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHCHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YRRDC   1
      *
      * Move key fields to @CCCPUX
     C                     Z-ADDWWWJA1    WMWJA1           MGL Company
     C                     MOVELWWQXCD    WMQXCD    P      MGL Division
     C                     Z-ADDWWWOA1    WMWOA1           MGL Invoice Bat
      *
     C           KLCHNH    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHNH    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    YRRDCS
      * Move non-key fields to @CCCPUX
     C                     MOVELWWQYCD    WMQYCD    P      MGL Payee
     C                     MOVELWWQZCD    WMQZCD    P      MGL Supplier
     C                     MOVELWWQ0CD    WMQ0CD    P      MGL Supplier In
     C                     MOVELWWQ1CD    WMQ1CD    P      MGL Invoice Bat
     C                     Z-ADDWWWPA1    WMWPA1           MGL Invoice Sta
     C                     Z-ADDWWAFDX    WMAFDX           MGL Invoice Dat
     C                     MOVELWWQ5CD    WMQ5CD    P      MGL Currency
     C                     MOVELWWQ6CD    WMQ6CD    P      MGL Payment Ter
     C                     Z-ADDWWLFVA    WMLFVA           MGL Total Line
     C                     Z-ADDWWLGVA    WMLGVA           MGL Cash Discou
     C                     Z-ADDYL0062    WMLNVA           MGL Foreign Cur
     C                     Z-ADDWWLHVA    WMLHVA           MGL Total Charg
     C                     Z-ADDWWLIVA    WMLIVA           MGL Total Due
     C                     MOVELWWG3SS    WMG3SS    P      MGL Invoice Mat
     C                     Z-ADDWWWYA1    WMWYA1           MGL Service Cod
     C                     MOVELWWQ2CD    WMQ2CD    P      MGL Payment Met
     C                     MOVELWWQ3CD    WMQ3CD    P      MGL Voucher Num
     C                     Z-ADDWWWSA1    WMWSA1           MGL Voucher Num
     C                     MOVELWWAKT1    WMAKT1    P      MGL Description
     C                     Z-ADDWWWXA1    WMWXA1           MGL Exchange Ra
     C                     MOVELWWAXT1    WMAXT1    P      MGL Purchase Or
     C                     MOVELWWQ7CD    WMQ7CD    P      MGL Cash discou
     C                     MOVELWWG2SS    WMG2SS    P      MGL Get Payee D
     C                     MOVELWWANT1    WMANT1    P      MGL Job Number
     C                     MOVELWWAOT1    WMAOT1    P      MGL Job Name
     C                     Z-ADDWWAGDX    WMAGDX           MGL Entry Date
     C                     Z-ADDWWB0TM    WMB0TM           MGL Entry Time
     C                     MOVELWWART1    WMART1    P      MGL Reference N
     C                     Z-ADDWWLOVA    WMLOVA           MGL Exchange ra
     C                     MOVELWWRACD    WMRACD    P      MGL Trade code
     C                     Z-ADDWWLPVA    WMLPVA           MGL VAT
     C                     Z-ADDWWAIDX    WMAIDX           MGL Accounting
     C                     MOVELWWAZT1    WMAZT1    P      MGL Authorized
     C                     Z-ADDWWAJDX    WMAJDX           MGL Due date
     C                     MOVELWWA0T1    WMA0T1    P      MGL Future rate
     C                     MOVELWWRBCD    WMRBCD    P      MGL From/to cou
     C                     MOVELWWRCCD    WMRCCD    P      MGL Base countr
     C                     Z-ADDWWAKDX    WMAKDX           MGL Order date
     C                     Z-ADDWWALDX    WMALDX           MGL Cash discou
     C                     Z-ADDWWW1A1    WMW1A1           MGL Cash discou
     C                     Z-ADDWWLQVA    WMLQVA           MGL Cash discou
     C                     Z-ADDWWAODX    WMAODX           MGL Cash discou
     C                     Z-ADDWWLRVA    WMLRVA           MGL Cash discou
     C                     Z-ADDWWLVVA    WMLVVA           MGL Cash discou
     C                     Z-ADDWWAMDX    WMAMDX           MGL Cash discou
     C                     Z-ADDWWW2A1    WMW2A1           MGL Cash discou
     C                     Z-ADDWWLSVA    WMLSVA           MGL Cash discou
     C                     Z-ADDWWLTVA    WMLTVA           MGL Total taxab
     C                     Z-ADDWWLUVA    WMLUVA           MGL Prepaid amo
     C                     MOVELWWA1T1    WMA1T1    P      MGL VAT reg num
     C                     Z-ADDWWW3A1    WMW3A1           MGL Tax applica
     C                     MOVELWWRDCD    WMRDCD    P      MGL Document co
     C                     MOVELWWRECD    WMRECD    P      MGL AP standard
     C                     MOVELWWRFCD    WMRFCD    P      MGL Debit note
     C                     MOVELWWRGCD    WMRGCD    P      MGL Our invoici
     C                     MOVELWWA2T1    WMA2T1    P      MGL Text line 1
     C                     MOVELWWA3T1    WMA3T1    P      MGL Text line 2
     C                     MOVELWWA4T1    WMA4T1    P      MGL Text line 3
     C                     MOVELWWA5T1    WMA5T1    P      MGL EAN loc cod
     C                     MOVELWWA6T1    WMA6T1    P      MGL EAN loc cde
     C                     MOVELWWA7T1    WMA7T1    P      MGL EAN loc cod
     C                     Z-ADDWWANDX    WMANDX           MGL Delivery da
     C                     MOVELWWRHCD    WMRHCD    P      MGL Bank accoun
     C                     Z-ADDWWW4A1    WMW4A1           MGL Geographica
     C                     Z-ADDWWW5A1    WMW5A1           MGL Tax include
     C                     MOVELWWA8T1    WMA8T1    P      MGL Original in
     C                     Z-ADDWWW6A1    WMW6A1           MGL Original ye
     C                     MOVELWWA9T1    WMA9T1    P      MGL Payment req
     C                     Z-ADDWWW7A1    WMW7A1           MGL Year
     C                     Z-ADDWWW8A1    WMW8A1           MGL Partial val
     C                     MOVELWWG5SS    WMG5SS    P      MGL ERP Process
     C                     Z-ADDWWAPDX    WMAPDX           MGL ERP Process
     C                     Z-ADDWWB1TM    WMB1TM           MGL ERP Process
     C                     MOVELWWAAVN    WMAAVN    P      RS User Changed
     C                     Z-ADDWWAADT    WMAADT           RS Date Changed
     C                     Z-ADDWWAMTM    WMAMTM           RS Time Changed
     C                     MOVELWWAJST    WMAJST    P      RS Record Statu
     C                     MOVELWWAHVN    WMAHVN    P      RS Job
     C                     MOVELWWAGVN    WMAGVN    P      RS Program
     C                     MOVELWWABVN    WMABVN    P      RS User Added
     C                     Z-ADDWWABDT    WMABDT           RS Date Added
     C                     Z-ADDWWABTM    WMABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YRRDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'S2D'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSNI     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0060           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR NJCHRC
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YSRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHNJ    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHNJ    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YSRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YSRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'HPE'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSNK     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0061           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR NLCHRC
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YTRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHNL    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHNL    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL020.
     C                     MOVEL'LBL020'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YTRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YTRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMCRRC    BEGSR
      *================================================================
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CCCPUX
     C                     Z-ADDYL0007    WMWJA1           MGL Company
     C                     MOVELYL0008    WMQXCD           MGL Division
     C                     Z-ADDYL0060    WMWOA1           MGL Invoice Bat
     C                     MOVELYL0039    WMQYCD           MGL Payee
     C                     MOVELYL0040    WMQZCD           MGL Supplier
     C                     MOVELYL0059    WMQ0CD           MGL Supplier In
     C                     MOVEL'30'      WMQ1CD           MGL Invoice Bat
     C                     Z-ADD10        WMWPA1           MGL Invoice Sta
     C                     Z-ADDYL0016    WMAFDX           MGL Invoice Dat
     C                     MOVELWN0001    WMQ5CD           MGL Currency
     C                     MOVELWN0002    WMQ6CD           MGL Payment Ter
     C                     Z-ADD*ZERO     WMLFVA           MGL Total Line
     C                     Z-ADD*ZERO     WMLGVA           MGL Cash Discou
     C                     Z-ADDYL0055    WMLNVA           MGL Foreign Cur
     C                     Z-ADD*ZERO     WMLHVA           MGL Total Charg
     C                     Z-ADD*ZERO     WMLIVA           MGL Total Due
     C                     MOVEL'0'       WMG3SS           MGL Invoice Mat
     C                     Z-ADD*ZERO     WMWYA1           MGL Service Cod
     C                     MOVELWN0003    WMQ2CD           MGL Payment Met
     C                     MOVELYL0011    WMQ3CD           MGL Voucher Num
     C                     Z-ADDYL0061    WMWSA1           MGL Voucher Num
     C                     MOVELYL0025    WMAKT1           MGL Description
     C                     Z-ADD01        WMWXA1           MGL Exchange Ra
     C                     MOVEL*BLANK    WMAXT1           MGL Purchase Or
     C                     MOVEL*BLANK    WMQ7CD           MGL Cash discou
     C                     MOVELWN0004    WMG2SS           MGL Get Payee D
     C                     MOVELYL0017    WMANT1           MGL Job Number
     C                     MOVEL##PGM     WMAOT1           MGL Job Name
     C                     Z-ADDYL0005    WMAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WMB0TM           MGL Entry Time
     C                     MOVEL*BLANK    WMART1           MGL Reference N
     C                     Z-ADD*ZERO     WMLOVA           MGL Exchange ra
     C                     MOVEL*BLANK    WMRACD           MGL Trade code
     C                     Z-ADD*ZERO     WMLPVA           MGL VAT
     C                     Z-ADDYL0016    WMAIDX           MGL Accounting
     C                     MOVELYL0010    WMAZT1           MGL Authorized
     C                     Z-ADD*ZERO     WMAJDX           MGL Due date
     C                     MOVEL*BLANK    WMA0T1           MGL Future rate
     C                     MOVEL*BLANK    WMRBCD           MGL From/to cou
     C                     MOVEL*BLANK    WMRCCD           MGL Base countr
     C                     Z-ADD*ZERO     WMAKDX           MGL Order date
     C                     Z-ADD*ZERO     WMALDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW1A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLQVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAODX           MGL Cash discou
     C                     Z-ADD*ZERO     WMLRVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLVVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAMDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW2A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLSVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLTVA           MGL Total taxab
     C                     Z-ADD*ZERO     WMLUVA           MGL Prepaid amo
     C                     MOVEL*BLANK    WMA1T1           MGL VAT reg num
     C                     Z-ADD*ZERO     WMW3A1           MGL Tax applica
     C                     MOVEL*BLANK    WMRDCD           MGL Document co
     C                     MOVE *BLANK    WMRECD           MGL AP standard
     C                     MOVEL'01'      WMRECD           MGL AP standard
     C                     MOVELYL0063    WMRFCD           MGL Debit note
     C                     MOVEL*BLANK    WMRGCD           MGL Our invoici
     C                     MOVEL*BLANK    WMA2T1           MGL Text line 1
     C                     MOVEL*BLANK    WMA3T1           MGL Text line 2
     C                     MOVEL*BLANK    WMA4T1           MGL Text line 3
     C                     MOVEL*BLANK    WMA5T1           MGL EAN loc cod
     C                     MOVEL*BLANK    WMA6T1           MGL EAN loc cde
     C                     MOVEL*BLANK    WMA7T1           MGL EAN loc cod
     C                     Z-ADD*ZERO     WMANDX           MGL Delivery da
     C                     MOVEL*BLANK    WMRHCD           MGL Bank accoun
     C                     Z-ADD*ZERO     WMW4A1           MGL Geographica
     C                     Z-ADD*ZERO     WMW5A1           MGL Tax include
     C                     MOVEL*BLANK    WMA8T1           MGL Original in
     C                     Z-ADD*ZERO     WMW6A1           MGL Original ye
     C                     MOVEL*BLANK    WMA9T1           MGL Payment req
     C                     Z-ADD*ZERO     WMW7A1           MGL Year
     C                     Z-ADD*ZERO     WMW8A1           MGL Partial val
     C                     MOVEL'0'       WMG5SS           MGL ERP Process
     C                     Z-ADD*ZERO     WMAPDX           MGL ERP Process
     C                     Z-ADD*ZERO     WMB1TM           MGL ERP Process
     C                     MOVEL*BLANK    WMAAVN           RS User Changed
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     MOVELWTAJST    WMAJST           RS Record Statu
     C                     MOVELWTAHVN    WMAHVN           RS Job
     C                     MOVELWTAGVN    WMAGVN           RS Program
     C                     MOVELWTABVN    WMABVN           RS User Added
     C                     Z-ADDWTABDT    WMABDT           RS Date Added
     C                     Z-ADDWTABTM    WMABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVEL##USR     WMABVN           RS User Added
     C                     Z-ADD##JDT     WMABDT           RS Date Added
     C                     Z-ADD##JTM     WMABTM           RS Time Added
     C                     MOVEL##PGM     WMAGVN           RS Program
     C                     MOVEL##JOB     WMAHVN           RS Job
     C           KLCRNM    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
      * Check for duplicate primary key
     C           KLCRNM    SETLL@CCCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1374' W0RTN   7
      * USER: Processing if Data record already exists
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR NNCHRC
     C                     GOTO NMEXIT
     C                     ENDIF
      *
     C                     WRITE@CCCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNCHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YURDC   1
      *
      * Move key fields to @CCCPUX
      *
     C           KLCHNN    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHNN    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL021.
     C                     MOVEL'LBL021'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    YURDCS
      * Move non-key fields to @CCCPUX
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YURDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NOCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD412       WOQ8CD           MGL AP Informat
     C                     MOVELYL0026    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRNO    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRNO    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NOEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD413       WOQ8CD           MGL AP Informat
     C                     MOVELYL0009    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRNP    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRNP    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NPEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * Rtv M3 Debit Note Rsn RT - Deduction/Addition  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNQ     KLIST
     C                     KFLD           WSBQCD           DED D/A Code
      * Setup key
     C                     MOVELWTBQCD    WSBQCD           DED D/A Code
      * Establish starting position
     C           KRSNQ     CHAIN@BBRED5              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0056           DED M3 Debit No
     C                     MOVEL*BLANK    YL0057           DED M3 Debt Nt
     C                     GOTO NQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSRICD    YL0056           DED M3 Debit No
     C                     MOVELWSRJCD    YL0057           DED M3 Debt Nt
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'S2D'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSNR     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0060           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR NSCHRC
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YVRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHNS    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHNS    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL022.
     C                     MOVEL'LBL022'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YVRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YVRDCS
     C           YVRDC     ANDNE'N'
     C                     MOVE 'Y'       YVRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YVRDCS
     C           YVRDC     ANDNE'N'
     C                     MOVE 'Y'       YVRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YVRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'HPE'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSNT     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0061           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR NUCHRC
     C                     ENDIF
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NUCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YWRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHNU    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHNU    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL023.
     C                     MOVEL'LBL023'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YWRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YWRDCS
     C           YWRDC     ANDNE'N'
     C                     MOVE 'Y'       YWRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YWRDCS
     C           YWRDC     ANDNE'N'
     C                     MOVE 'Y'       YWRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YWRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVCRRC    BEGSR
      *================================================================
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CCCPUX
     C                     Z-ADDYL0007    WMWJA1           MGL Company
     C                     MOVELYL0008    WMQXCD           MGL Division
     C                     Z-ADDYL0060    WMWOA1           MGL Invoice Bat
     C                     MOVELYL0039    WMQYCD           MGL Payee
     C                     MOVELYL0040    WMQZCD           MGL Supplier
     C                     MOVELYL0059    WMQ0CD           MGL Supplier In
     C                     MOVEL'30'      WMQ1CD           MGL Invoice Bat
     C                     Z-ADD10        WMWPA1           MGL Invoice Sta
     C                     Z-ADDYL0016    WMAFDX           MGL Invoice Dat
     C                     MOVELWN0001    WMQ5CD           MGL Currency
     C                     MOVELWN0002    WMQ6CD           MGL Payment Ter
     C                     Z-ADD*ZERO     WMLFVA           MGL Total Line
     C                     Z-ADD*ZERO     WMLGVA           MGL Cash Discou
     C                     Z-ADDYL0055    WMLNVA           MGL Foreign Cur
     C                     Z-ADD*ZERO     WMLHVA           MGL Total Charg
     C                     Z-ADD*ZERO     WMLIVA           MGL Total Due
     C                     MOVEL'0'       WMG3SS           MGL Invoice Mat
     C                     Z-ADD*ZERO     WMWYA1           MGL Service Cod
     C                     MOVELWN0003    WMQ2CD           MGL Payment Met
     C                     MOVELYL0011    WMQ3CD           MGL Voucher Num
     C                     Z-ADDYL0061    WMWSA1           MGL Voucher Num
     C                     MOVELYL0025    WMAKT1           MGL Description
     C                     Z-ADD01        WMWXA1           MGL Exchange Ra
     C                     MOVEL*BLANK    WMAXT1           MGL Purchase Or
     C                     MOVEL*BLANK    WMQ7CD           MGL Cash discou
     C                     MOVEL'1'       WMG2SS           MGL Get Payee D
     C                     MOVELYL0017    WMANT1           MGL Job Number
     C                     MOVEL##PGM     WMAOT1           MGL Job Name
     C                     Z-ADDYL0005    WMAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WMB0TM           MGL Entry Time
     C                     MOVEL*BLANK    WMART1           MGL Reference N
     C                     Z-ADD*ZERO     WMLOVA           MGL Exchange ra
     C                     MOVEL*BLANK    WMRACD           MGL Trade code
     C                     Z-ADD*ZERO     WMLPVA           MGL VAT
     C                     Z-ADDYL0016    WMAIDX           MGL Accounting
     C                     MOVELYL0010    WMAZT1           MGL Authorized
     C                     Z-ADD*ZERO     WMAJDX           MGL Due date
     C                     MOVEL*BLANK    WMA0T1           MGL Future rate
     C                     MOVEL*BLANK    WMRBCD           MGL From/to cou
     C                     MOVEL*BLANK    WMRCCD           MGL Base countr
     C                     Z-ADD*ZERO     WMAKDX           MGL Order date
     C                     Z-ADD*ZERO     WMALDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW1A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLQVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAODX           MGL Cash discou
     C                     Z-ADD*ZERO     WMLRVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLVVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAMDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW2A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLSVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLTVA           MGL Total taxab
     C                     Z-ADD*ZERO     WMLUVA           MGL Prepaid amo
     C                     MOVEL*BLANK    WMA1T1           MGL VAT reg num
     C                     Z-ADD*ZERO     WMW3A1           MGL Tax applica
     C                     MOVEL*BLANK    WMRDCD           MGL Document co
     C                     MOVE *BLANK    WMRECD           MGL AP standard
     C                     MOVEL'01'      WMRECD           MGL AP standard
     C                     MOVELYL0063    WMRFCD           MGL Debit note
     C                     MOVEL*BLANK    WMRGCD           MGL Our invoici
     C                     MOVEL*BLANK    WMA2T1           MGL Text line 1
     C                     MOVEL*BLANK    WMA3T1           MGL Text line 2
     C                     MOVEL*BLANK    WMA4T1           MGL Text line 3
     C                     MOVEL*BLANK    WMA5T1           MGL EAN loc cod
     C                     MOVEL*BLANK    WMA6T1           MGL EAN loc cde
     C                     MOVEL*BLANK    WMA7T1           MGL EAN loc cod
     C                     Z-ADD*ZERO     WMANDX           MGL Delivery da
     C                     MOVEL*BLANK    WMRHCD           MGL Bank accoun
     C                     Z-ADD*ZERO     WMW4A1           MGL Geographica
     C                     Z-ADD*ZERO     WMW5A1           MGL Tax include
     C                     MOVEL*BLANK    WMA8T1           MGL Original in
     C                     Z-ADD*ZERO     WMW6A1           MGL Original ye
     C                     MOVEL*BLANK    WMA9T1           MGL Payment req
     C                     Z-ADD*ZERO     WMW7A1           MGL Year
     C                     Z-ADD*ZERO     WMW8A1           MGL Partial val
     C                     MOVEL'0'       WMG5SS           MGL ERP Process
     C                     Z-ADD*ZERO     WMAPDX           MGL ERP Process
     C                     Z-ADD*ZERO     WMB1TM           MGL ERP Process
     C                     MOVEL*BLANK    WMAAVN           RS User Changed
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     MOVELWTAJST    WMAJST           RS Record Statu
     C                     MOVELWTAHVN    WMAHVN           RS Job
     C                     MOVELWTAGVN    WMAGVN           RS Program
     C                     MOVELWTABVN    WMABVN           RS User Added
     C                     Z-ADDWTABDT    WMABDT           RS Date Added
     C                     Z-ADDWTABTM    WMABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVEL##USR     WMABVN           RS User Added
     C                     Z-ADD##JDT     WMABDT           RS Date Added
     C                     Z-ADD##JTM     WMABTM           RS Time Added
     C                     MOVEL##PGM     WMAGVN           RS Program
     C                     MOVEL##JOB     WMAHVN           RS Job
     C           KLCRNV    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
      * Check for duplicate primary key
     C           KLCRNV    SETLL@CCCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1374' W0RTN   7
      * USER: Processing if Data record already exists
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR NWCHRC
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C                     WRITE@CCCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWCHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YXRDC   1
      *
      * Move key fields to @CCCPUX
      *
     C           KLCHNW    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHNW    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL024.
     C                     MOVEL'LBL024'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    YXRDCS
      * Move non-key fields to @CCCPUX
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YXRDCS
     C           YXRDC     ANDNE'N'
     C                     MOVE 'Y'       YXRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YXRDCS
     C           YXRDC     ANDNE'N'
     C                     MOVE 'Y'       YXRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YXRDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD412       WOQ8CD           MGL AP Informat
     C                     MOVELYL0026    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRNX    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRNX    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NXEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD413       WOQ8CD           MGL AP Informat
     C                     MOVELYL0009    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRNY    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRNY    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NYEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZRVGN    BEGSR
      *================================================================
      * Rtv Add H/O SpplInv#  RT - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWWJA1    WQNZ01           MGL Company
     C           *LIKE     DEFN WWQXCD    WQNZ02           MGL Division
     C           *LIKE     DEFN WWQZCD    WQNZ03           MGL Supplier
     C           *LIKE     DEFN WWQ0CD    WQNZ04           MGL Supplier In
      * Define keylist
     C           KRSNZ     KLIST
     C                     KFLD           WQNZ01           MGL Company
     C                     KFLD           WQNZ02           MGL Division
     C                     KFLD           WQNZ03           MGL Supplier
     C                     KFLD           WQNZ04           MGL Supplier In
      * Setup key
     C                     Z-ADDYL0007    WQNZ01           MGL Company
     C                     MOVELYL0008    WQNZ02           MGL Division
     C                     MOVELYL0040    WQNZ03           MGL Supplier
     C                     MOVELYL0059    WQNZ04           MGL Supplier In
      * Establish starting position
     C           KRSNZ     SETLL@CCCPU7                    *
     C           KRSNZ     READE@CCCPU7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1373' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.MGL ERP Process Sts is Not Processed
     C           WWG5SS    IFEQ '0'                        *IF
     C           WWLNVA    ADD  YL0055    YL0062           PAD Transaction
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR OACHRC
     C                     END                             *FI
     C           KRSNZ     READE@CCCPU7                  90*
     C                     ENDDO
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OACHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YYRDC   1
      *
      * Move key fields to @CCCPUX
     C                     Z-ADDWWWJA1    WMWJA1           MGL Company
     C                     MOVELWWQXCD    WMQXCD    P      MGL Division
     C                     Z-ADDWWWOA1    WMWOA1           MGL Invoice Bat
      *
     C           KLCHOA    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHOA    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL025.
     C                     MOVEL'LBL025'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    YYRDCS
      * Move non-key fields to @CCCPUX
     C                     MOVELWWQYCD    WMQYCD    P      MGL Payee
     C                     MOVELWWQZCD    WMQZCD    P      MGL Supplier
     C                     MOVELWWQ0CD    WMQ0CD    P      MGL Supplier In
     C                     MOVELWWQ1CD    WMQ1CD    P      MGL Invoice Bat
     C                     Z-ADDWWWPA1    WMWPA1           MGL Invoice Sta
     C                     Z-ADDWWAFDX    WMAFDX           MGL Invoice Dat
     C                     MOVELWWQ5CD    WMQ5CD    P      MGL Currency
     C                     MOVELWWQ6CD    WMQ6CD    P      MGL Payment Ter
     C                     Z-ADDWWLFVA    WMLFVA           MGL Total Line
     C                     Z-ADDWWLGVA    WMLGVA           MGL Cash Discou
     C                     Z-ADDYL0062    WMLNVA           MGL Foreign Cur
     C                     Z-ADDWWLHVA    WMLHVA           MGL Total Charg
     C                     Z-ADDWWLIVA    WMLIVA           MGL Total Due
     C                     MOVELWWG3SS    WMG3SS    P      MGL Invoice Mat
     C                     Z-ADDWWWYA1    WMWYA1           MGL Service Cod
     C                     MOVELWWQ2CD    WMQ2CD    P      MGL Payment Met
     C                     MOVELWWQ3CD    WMQ3CD    P      MGL Voucher Num
     C                     Z-ADDWWWSA1    WMWSA1           MGL Voucher Num
     C                     MOVELWWAKT1    WMAKT1    P      MGL Description
     C                     Z-ADDWWWXA1    WMWXA1           MGL Exchange Ra
     C                     MOVELWWAXT1    WMAXT1    P      MGL Purchase Or
     C                     MOVELWWQ7CD    WMQ7CD    P      MGL Cash discou
     C                     MOVELWWG2SS    WMG2SS    P      MGL Get Payee D
     C                     MOVELWWANT1    WMANT1    P      MGL Job Number
     C                     MOVELWWAOT1    WMAOT1    P      MGL Job Name
     C                     Z-ADDWWAGDX    WMAGDX           MGL Entry Date
     C                     Z-ADDWWB0TM    WMB0TM           MGL Entry Time
     C                     MOVELWWART1    WMART1    P      MGL Reference N
     C                     Z-ADDWWLOVA    WMLOVA           MGL Exchange ra
     C                     MOVELWWRACD    WMRACD    P      MGL Trade code
     C                     Z-ADDWWLPVA    WMLPVA           MGL VAT
     C                     Z-ADDWWAIDX    WMAIDX           MGL Accounting
     C                     MOVELWWAZT1    WMAZT1    P      MGL Authorized
     C                     Z-ADDWWAJDX    WMAJDX           MGL Due date
     C                     MOVELWWA0T1    WMA0T1    P      MGL Future rate
     C                     MOVELWWRBCD    WMRBCD    P      MGL From/to cou
     C                     MOVELWWRCCD    WMRCCD    P      MGL Base countr
     C                     Z-ADDWWAKDX    WMAKDX           MGL Order date
     C                     Z-ADDWWALDX    WMALDX           MGL Cash discou
     C                     Z-ADDWWW1A1    WMW1A1           MGL Cash discou
     C                     Z-ADDWWLQVA    WMLQVA           MGL Cash discou
     C                     Z-ADDWWAODX    WMAODX           MGL Cash discou
     C                     Z-ADDWWLRVA    WMLRVA           MGL Cash discou
     C                     Z-ADDWWLVVA    WMLVVA           MGL Cash discou
     C                     Z-ADDWWAMDX    WMAMDX           MGL Cash discou
     C                     Z-ADDWWW2A1    WMW2A1           MGL Cash discou
     C                     Z-ADDWWLSVA    WMLSVA           MGL Cash discou
     C                     Z-ADDWWLTVA    WMLTVA           MGL Total taxab
     C                     Z-ADDWWLUVA    WMLUVA           MGL Prepaid amo
     C                     MOVELWWA1T1    WMA1T1    P      MGL VAT reg num
     C                     Z-ADDWWW3A1    WMW3A1           MGL Tax applica
     C                     MOVELWWRDCD    WMRDCD    P      MGL Document co
     C                     MOVELWWRECD    WMRECD    P      MGL AP standard
     C                     MOVELWWRFCD    WMRFCD    P      MGL Debit note
     C                     MOVELWWRGCD    WMRGCD    P      MGL Our invoici
     C                     MOVELWWA2T1    WMA2T1    P      MGL Text line 1
     C                     MOVELWWA3T1    WMA3T1    P      MGL Text line 2
     C                     MOVELWWA4T1    WMA4T1    P      MGL Text line 3
     C                     MOVELWWA5T1    WMA5T1    P      MGL EAN loc cod
     C                     MOVELWWA6T1    WMA6T1    P      MGL EAN loc cde
     C                     MOVELWWA7T1    WMA7T1    P      MGL EAN loc cod
     C                     Z-ADDWWANDX    WMANDX           MGL Delivery da
     C                     MOVELWWRHCD    WMRHCD    P      MGL Bank accoun
     C                     Z-ADDWWW4A1    WMW4A1           MGL Geographica
     C                     Z-ADDWWW5A1    WMW5A1           MGL Tax include
     C                     MOVELWWA8T1    WMA8T1    P      MGL Original in
     C                     Z-ADDWWW6A1    WMW6A1           MGL Original ye
     C                     MOVELWWA9T1    WMA9T1    P      MGL Payment req
     C                     Z-ADDWWW7A1    WMW7A1           MGL Year
     C                     Z-ADDWWW8A1    WMW8A1           MGL Partial val
     C                     MOVELWWG5SS    WMG5SS    P      MGL ERP Process
     C                     Z-ADDWWAPDX    WMAPDX           MGL ERP Process
     C                     Z-ADDWWB1TM    WMB1TM           MGL ERP Process
     C                     MOVELWWAAVN    WMAAVN    P      RS User Changed
     C                     Z-ADDWWAADT    WMAADT           RS Date Changed
     C                     Z-ADDWWAMTM    WMAMTM           RS Time Changed
     C                     MOVELWWAJST    WMAJST    P      RS Record Statu
     C                     MOVELWWAHVN    WMAHVN    P      RS Job
     C                     MOVELWWAGVN    WMAGVN    P      RS Program
     C                     MOVELWWABVN    WMABVN    P      RS User Added
     C                     Z-ADDWWABDT    WMABDT           RS Date Added
     C                     Z-ADDWWABTM    WMABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YYRDCS
     C           YYRDC     ANDNE'N'
     C                     MOVE 'Y'       YYRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YYRDCS
     C           YYRDC     ANDNE'N'
     C                     MOVE 'Y'       YYRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YYRDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOB     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'S2D'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSOB     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0060           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR OCCHRC
     C                     ENDIF
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YZRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHOC    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHOC    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL026.
     C                     MOVEL'LBL026'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YZRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YZRDCS
     C           YZRDC     ANDNE'N'
     C                     MOVE 'Y'       YZRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YZRDCS
     C           YZRDC     ANDNE'N'
     C                     MOVE 'Y'       YZRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YZRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOD     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'HPE'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSOD     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0061           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR OECHRC
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OECHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y0RDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHOE    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHOE    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL027.
     C                     MOVEL'LBL027'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    Y0RDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE Y0RDCS
     C           Y0RDC     ANDNE'N'
     C                     MOVE 'Y'       Y0RDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE Y0RDCS
     C           Y0RDC     ANDNE'N'
     C                     MOVE 'Y'       Y0RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y0RDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFCRRC    BEGSR
      *================================================================
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CCCPUX
     C                     Z-ADDYL0007    WMWJA1           MGL Company
     C                     MOVELYL0008    WMQXCD           MGL Division
     C                     Z-ADDYL0060    WMWOA1           MGL Invoice Bat
     C                     MOVELYL0039    WMQYCD           MGL Payee
     C                     MOVELYL0040    WMQZCD           MGL Supplier
     C                     MOVELYL0059    WMQ0CD           MGL Supplier In
     C                     MOVEL'30'      WMQ1CD           MGL Invoice Bat
     C                     Z-ADD10        WMWPA1           MGL Invoice Sta
     C                     Z-ADDYL0016    WMAFDX           MGL Invoice Dat
     C                     MOVELWN0001    WMQ5CD           MGL Currency
     C                     MOVELWN0002    WMQ6CD           MGL Payment Ter
     C                     Z-ADD*ZERO     WMLFVA           MGL Total Line
     C                     Z-ADD*ZERO     WMLGVA           MGL Cash Discou
     C                     Z-ADDYL0055    WMLNVA           MGL Foreign Cur
     C                     Z-ADD*ZERO     WMLHVA           MGL Total Charg
     C                     Z-ADD*ZERO     WMLIVA           MGL Total Due
     C                     MOVEL'0'       WMG3SS           MGL Invoice Mat
     C                     Z-ADD*ZERO     WMWYA1           MGL Service Cod
     C                     MOVELWN0003    WMQ2CD           MGL Payment Met
     C                     MOVELYL0011    WMQ3CD           MGL Voucher Num
     C                     Z-ADDYL0061    WMWSA1           MGL Voucher Num
     C                     MOVELYL0025    WMAKT1           MGL Description
     C                     Z-ADD01        WMWXA1           MGL Exchange Ra
     C                     MOVEL*BLANK    WMAXT1           MGL Purchase Or
     C                     MOVEL*BLANK    WMQ7CD           MGL Cash discou
     C                     MOVELWN0004    WMG2SS           MGL Get Payee D
     C                     MOVELYL0017    WMANT1           MGL Job Number
     C                     MOVEL##PGM     WMAOT1           MGL Job Name
     C                     Z-ADDYL0005    WMAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WMB0TM           MGL Entry Time
     C                     MOVEL*BLANK    WMART1           MGL Reference N
     C                     Z-ADD*ZERO     WMLOVA           MGL Exchange ra
     C                     MOVEL*BLANK    WMRACD           MGL Trade code
     C                     Z-ADD*ZERO     WMLPVA           MGL VAT
     C                     Z-ADDYL0016    WMAIDX           MGL Accounting
     C                     MOVELYL0010    WMAZT1           MGL Authorized
     C                     Z-ADD*ZERO     WMAJDX           MGL Due date
     C                     MOVEL*BLANK    WMA0T1           MGL Future rate
     C                     MOVEL*BLANK    WMRBCD           MGL From/to cou
     C                     MOVEL*BLANK    WMRCCD           MGL Base countr
     C                     Z-ADD*ZERO     WMAKDX           MGL Order date
     C                     Z-ADD*ZERO     WMALDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW1A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLQVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAODX           MGL Cash discou
     C                     Z-ADD*ZERO     WMLRVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLVVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAMDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW2A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLSVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLTVA           MGL Total taxab
     C                     Z-ADD*ZERO     WMLUVA           MGL Prepaid amo
     C                     MOVEL*BLANK    WMA1T1           MGL VAT reg num
     C                     Z-ADD*ZERO     WMW3A1           MGL Tax applica
     C                     MOVEL*BLANK    WMRDCD           MGL Document co
     C                     MOVE *BLANK    WMRECD           MGL AP standard
     C                     MOVEL'01'      WMRECD           MGL AP standard
     C                     MOVELYL0063    WMRFCD           MGL Debit note
     C                     MOVEL*BLANK    WMRGCD           MGL Our invoici
     C                     MOVEL*BLANK    WMA2T1           MGL Text line 1
     C                     MOVEL*BLANK    WMA3T1           MGL Text line 2
     C                     MOVEL*BLANK    WMA4T1           MGL Text line 3
     C                     MOVEL*BLANK    WMA5T1           MGL EAN loc cod
     C                     MOVEL*BLANK    WMA6T1           MGL EAN loc cde
     C                     MOVEL*BLANK    WMA7T1           MGL EAN loc cod
     C                     Z-ADD*ZERO     WMANDX           MGL Delivery da
     C                     MOVEL*BLANK    WMRHCD           MGL Bank accoun
     C                     Z-ADD*ZERO     WMW4A1           MGL Geographica
     C                     Z-ADD*ZERO     WMW5A1           MGL Tax include
     C                     MOVEL*BLANK    WMA8T1           MGL Original in
     C                     Z-ADD*ZERO     WMW6A1           MGL Original ye
     C                     MOVEL*BLANK    WMA9T1           MGL Payment req
     C                     Z-ADD*ZERO     WMW7A1           MGL Year
     C                     Z-ADD*ZERO     WMW8A1           MGL Partial val
     C                     MOVEL'0'       WMG5SS           MGL ERP Process
     C                     Z-ADD*ZERO     WMAPDX           MGL ERP Process
     C                     Z-ADD*ZERO     WMB1TM           MGL ERP Process
     C                     MOVEL*BLANK    WMAAVN           RS User Changed
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     MOVELWTAJST    WMAJST           RS Record Statu
     C                     MOVELWTAHVN    WMAHVN           RS Job
     C                     MOVELWTAGVN    WMAGVN           RS Program
     C                     MOVELWTABVN    WMABVN           RS User Added
     C                     Z-ADDWTABDT    WMABDT           RS Date Added
     C                     Z-ADDWTABTM    WMABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVEL##USR     WMABVN           RS User Added
     C                     Z-ADD##JDT     WMABDT           RS Date Added
     C                     Z-ADD##JTM     WMABTM           RS Time Added
     C                     MOVEL##PGM     WMAGVN           RS Program
     C                     MOVEL##JOB     WMAHVN           RS Job
     C           KLCROF    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
      * Check for duplicate primary key
     C           KLCROF    SETLL@CCCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1374' W0RTN   7
      * USER: Processing if Data record already exists
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR OGCHRC
     C                     GOTO OFEXIT
     C                     ENDIF
      *
     C                     WRITE@CCCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGCHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y1RDC   1
      *
      * Move key fields to @CCCPUX
      *
     C           KLCHOG    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHOG    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL028.
     C                     MOVEL'LBL028'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    Y1RDCS
      * Move non-key fields to @CCCPUX
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE Y1RDCS
     C           Y1RDC     ANDNE'N'
     C                     MOVE 'Y'       Y1RDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE Y1RDCS
     C           Y1RDC     ANDNE'N'
     C                     MOVE 'Y'       Y1RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y1RDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD412       WOQ8CD           MGL AP Informat
     C                     MOVELYL0026    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCROH    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCROH    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OHEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         OICRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD413       WOQ8CD           MGL AP Informat
     C                     MOVELYL0009    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCROI    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCROI    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OIEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OIEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Crt M3 Vchr Head  RT - Hog Voucher Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  3        MGL Currency
     C                     MOVEL*BLANK    WN0002  3        MGL Payment Ter
     C                     MOVEL*BLANK    WN0003  3        MGL Payment Met
     C                     MOVEL*BLANK    WN0004  1        MGL Get Payee D
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'HPE'     YL0011           MGL Voucher Num
     C                     MOVEL'1'       WN0004           MGL Get Payee D
     C                     MOVEL*BLANK    WN0001           MGL Currency
     C                     MOVEL*BLANK    WN0002           MGL Payment Ter
     C                     MOVEL*BLANK    WN0003           MGL Payment Met
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHNNB    WQSA01           VCH Company num
     C           *LIKE     DEFN WALWNB    WQSA02           VCH Batch Numbe
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           VCH Company num
     C                     KFLD           WQSA02           VCH Batch Numbe
      * Setup key
     C                     Z-ADDP1HNNB    WQSA01           VCH Company num
     C                     Z-ADDP1LWNB    WQSA02           VCH Batch Numbe
      * Establish starting position
     C           KRSSA     SETLL@BKCPEJ                    *
     C           KRSSA     READE@BKCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Each detail will have a diff invoice batch number
      * Invoice Date
     C                     MOVEL*BLANK    YL0012           Date CDE USR
     C                     MOVELWAA4DT    YL0012           Date CDE USR
     C                     MOVELYL0012    YL0013           Date From Conve
      * Cvt Date              UP - STR Miscellaneous  * 
     C                     CALL 'PKPOUPR'              90  Cvt Date
     C                     PARM YL0013    WQ0021 10        Date From Conve
     C           YL0014    PARM *BLANK    WQ0022 11        Date To Convert
     C                     PARM '*CYMD'   WQ0023  8        Date From Forma
     C                     PARM '*YYMD'   WQ0024  8        Date To Format
     C                     PARM '*NONE'   WQ0025  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0014    YL0015           Date To Format
     C                     MOVE YL0015    YL0016           MGL Invoice Dat
      * Supplier invoice
     C                     MOVEL*BLANK    YL0017           MGL Job Number
     C                     MOVEL##JNO     YL0017           MGL Job Number
      * CASE: DB1.VCH Payee Type is Internal
     C           WACSST    IFEQ 'I'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Crt M3 Vchr Line  RT - Hog Voucher Detail  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@BKCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Crt M3 Vchr Line  RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0020           Held Over Recor
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHNNB    WQSB01           VCH Company num
     C           *LIKE     DEFN WBLWNB    WQSB02           VCH Batch Numbe
     C           *LIKE     DEFN WBG9NB    WQSB03           VCH Header Numb
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           VCH Company num
     C                     KFLD           WQSB02           VCH Batch Numbe
     C                     KFLD           WQSB03           VCH Header Numb
     C                     KFLD           WBDLNB           VCD Line
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           VCH Company num
     C                     KFLD           WQSB02           VCH Batch Numbe
     C                     KFLD           WQSB03           VCH Header Numb
      * Setup key
     C                     Z-ADDWAHNNB    WQSB01           VCH Company num
     C                     Z-ADDWALWNB    WQSB02           VCH Batch Numbe
     C                     Z-ADDWAG9NB    WQSB03           VCH Header Numb
     C                     Z-ADD1         WBDLNB           VCD Line
      * Establish starting position
     C           KPSSB     SETLL@BLCPEP                    *
     C           KRSSB     READE@BLCPEP                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR SCRVGN
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR SERVGN
      * Supplier invoice
      * CASE: PAR.VCH Payee Type is Trucker
     C           WACSST    IFEQ 'T'                        *IF
      * Rtv Trucker Name - Trucker  * 
     C                     EXSR SGRVGN
     C                     MOVELYL0024    YL0025           MGL Description
     C                     MOVEL*BLANK    YL0026           MGL AP Addition
     C                     MOVELWABNCD    YL0026           MGL AP Addition
      * Guymon Trucker
      * CASE: DB1.VCH Company number is SBD Farms of Guymon, Ok
     C           WBHNNB    IFEQ 360                        *IF
     C                     MOVELWBBNNB    YL0027           Buy Order Numbe
     C                     Z-ADDWBBONB    YL0028           Buy Order Load
     C                     MOVELYL0028    YL0029           Buy Order Load
      * RMC WI 475 BO increase to 7.0 from 5.0
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0027    CAT  '-':ZQ    YL0030    P      Text 8 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0030    CAT  YL0029:ZQ YL0031    P      Text 12 USR
     C                     Z-ADD1         ZQ      50
     C           YL0031    CAT  YL0019:ZQ YL0032    P      MGL Supplier In
     C                     END                             *FI
      * Triumph Trucker - supplier inv same format as GUYMON's check's su
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.VCH Company number is Triumph Foods Market
      *   |- c2    : DB1.VCH Company number is Triumph Foods-2
      *   '-
     C           WBHNNB    IFEQ 960                        *IF
     C           WBHNNB    OREQ 961                        *OR
     C                     MOVELWBBNNB    YL0027           Buy Order Numbe
     C                     Z-ADDWBBONB    YL0028           Buy Order Load
     C                     MOVELYL0028    YL0029           Buy Order Load
     C                     Z-ADDWBCVNB    YL0033           Tattoo Nbr 4
     C                     MOVELYL0033    YL0034           Tattoo Nbr Alph
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0029    CAT  '-':ZQ    YL0035    P      Buy Order Load
      * RMC WI 475 BO increase to 7.0 from 5.0
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0027    CAT  '-':ZQ    YL0030    P      Text 8 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0030    CAT  YL0035:ZQ YL0036    P      Text 13 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0036    CAT  YL0034:ZQ YL0037    P      Text 17 USR
     C                     MOVEL*BLANK    YL0032           MGL Supplier In
     C                     MOVELYL0037    YL0032           MGL Supplier In
     C                     END                             *FI
      * Sioux Trucker - supplier inv same format as GUYMON's check's supp
      * CASE: DB1.VCH Company number is Sioux City
     C           WBHNNB    IFEQ 440                        *IF
     C                     MOVELWBBNNB    YL0027           Buy Order Numbe
     C                     Z-ADDWBBONB    YL0028           Buy Order Load
     C                     MOVELYL0028    YL0029           Buy Order Load
     C                     Z-ADDWBCVNB    YL0033           Tattoo Nbr 4
     C                     MOVELYL0033    YL0034           Tattoo Nbr Alph
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0029    CAT  '-':ZQ    YL0035    P      Buy Order Load
      * RMC WI 475 BO increase to 7.0 from 5.0
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0027    CAT  '-':ZQ    YL0030    P      Text 8 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0030    CAT  YL0035:ZQ YL0036    P      Text 13 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0036    CAT  YL0034:ZQ YL0037    P      Text 17 USR
     C                     MOVEL*BLANK    YL0032           MGL Supplier In
     C                     MOVELYL0037    YL0032           MGL Supplier In
     C                     END                             *FI
      * Rtv Trucker M3 Payer# RT - Trucker  * 
     C                     EXSR SHRVGN
     C                     MOVELYL0038    YL0039           MGL Payee
     C                     MOVELYL0038    YL0040           MGL Supplier
     C                     ELSE
      * CASE: *OTHERWISE
      * 360 Format Supplier invoice number  - prints on check stub
      * CASE: DB1.VCH Company number is SBD Farms of Guymon, Ok
     C           WBHNNB    IFEQ 360                        *IF
     C                     MOVELWBBNNB    YL0027           Buy Order Numbe
     C                     Z-ADDWBBONB    YL0028           Buy Order Load
     C                     MOVELYL0028    YL0029           Buy Order Load
     C                     Z-ADDWBCVNB    YL0033           Tattoo Nbr 4
     C                     MOVELYL0033    YL0034           Tattoo Nbr Alph
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0029    CAT  '-':ZQ    YL0035    P      Buy Order Load
      * RMC WI 475 BO increase to 7.0 from 5.0
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0027    CAT  '-':ZQ    YL0030    P      Text 8 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0030    CAT  YL0035:ZQ YL0036    P      Text 13 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0036    CAT  YL0034:ZQ YL0037    P      Text 17 USR
     C                     MOVEL*BLANK    YL0032           MGL Supplier In
     C                     MOVELYL0037    YL0032           MGL Supplier In
     C                     END                             *FI
      * 960 Format Supplier invoice number -  prints on check stub
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.VCH Company number is Triumph Foods Market
      *   |- c2    : DB1.VCH Company number is Triumph Foods-2
      *   '-
     C           WBHNNB    IFEQ 960                        *IF
     C           WBHNNB    OREQ 961                        *OR
     C                     MOVELWBBNNB    YL0027           Buy Order Numbe
     C                     Z-ADDWBBONB    YL0028           Buy Order Load
     C                     MOVELYL0028    YL0029           Buy Order Load
     C                     Z-ADDWBCVNB    YL0033           Tattoo Nbr 4
     C                     MOVELYL0033    YL0034           Tattoo Nbr Alph
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0029    CAT  '-':ZQ    YL0035    P      Buy Order Load
      * RMC WI 475 BO increase to 7.0 from 5.0
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0027    CAT  '-':ZQ    YL0030    P      Text 8 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0030    CAT  YL0035:ZQ YL0036    P      Text 13 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0036    CAT  YL0034:ZQ YL0037    P      Text 17 USR
     C                     MOVEL*BLANK    YL0032           MGL Supplier In
     C                     MOVELYL0037    YL0032           MGL Supplier In
     C                     END                             *FI
      * 440 Format Supplier invoice number -  prints on check stub
      * CASE: DB1.VCH Company number is Sioux City
     C           WBHNNB    IFEQ 440                        *IF
     C                     MOVELWBBNNB    YL0027           Buy Order Numbe
     C                     Z-ADDWBBONB    YL0028           Buy Order Load
     C                     MOVELYL0028    YL0029           Buy Order Load
     C                     Z-ADDWBCVNB    YL0033           Tattoo Nbr 4
     C                     MOVELYL0033    YL0034           Tattoo Nbr Alph
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0029    CAT  '-':ZQ    YL0035    P      Buy Order Load
      * RMC WI 475 BO increase to 7.0 from 5.0
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0027    CAT  '-':ZQ    YL0030    P      Text 8 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0030    CAT  YL0035:ZQ YL0036    P      Text 13 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0036    CAT  YL0034:ZQ YL0037    P      Text 17 USR
     C                     MOVEL*BLANK    YL0032           MGL Supplier In
     C                     MOVELYL0037    YL0032           MGL Supplier In
     C                     END                             *FI
      * USE ap addresOFF OF VCH HEADER. DETAIL WONT HAVE SPLIT PRDCR, IF
      * RMC SDN 440 8/13/21
      * if M3 is live, then format the div||Vnd to get the supplier.
      *   else the E1 Vnd is in the Voucher Header, so use it to get M3 S
      * CASE: PAR.Live with M3   USR is Yes
     C           YL0006    IFEQ 'Y'                        *IF
     C                     Z-ADDWALXNB    WUZBA1           VCH Address  #
     C                     MOVELWUZBA1    WUSTTX           Text 7 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0008    CAT  WUSTTX:ZQ YL0038    P      M3 Supplier ID
     C                     ELSE
      * CASE: *OTHERWISE
      * get the m3 supplier from the e1 vendor # thats in the vch hdr
      * Rtv M3 Supp w/E1 Vnd  RT - Producer  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     MOVELYL0038    YL0039           MGL Payee
     C                     MOVELYL0038    YL0040           MGL Supplier
      * E13055 JJH 05/15/18 - Get MGL Description from M3 Supplier,
      *  force producer code to TRMPH if source is TO
      * Rtv Producer EXT2-NM  RT - Producer EXT2  * 
     C                     EXSR SKRVGN
      * Rtv M3 Supplier Name  RT - M3 Supplier  * 
     C                     EXSR SMRVGN
      * CASE: LCL.SR Source Code is Triumph Member (Owner)
     C           YL0042    IFEQ 'TO'                       *IF
     C                     MOVEL*BLANK    YL0041           PD Producer Cod
     C                     MOVEL'TRMPH'   YL0041           PD Producer Cod
     C                     END                             *FI
      * Rtv Src Cntrt Type    RT - Source  * use for split processing
     C                     EXSR SNRVGN
     C                     MOVELYL0043    YL0025           MGL Description
     C                     MOVEL*BLANK    YL0026           MGL AP Addition
     C                     MOVELYL0041    YL0026           MGL AP Addition
      * Rtv Held Over Y/N     RT - Tattoo Header  * 
     C                     EXSR SORVGN
     C                     END                             *FI
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
     C                     EXSR SPCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR SRCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR SSCRRC
      *  DO -- when live/parallel - update hog voucher detail with M3 vou
      * CASE: PAR.Live with M3   USR is Live or Parallel
     C           YL0006    IFEQ 'P'                        *IF
     C           YL0006    OREQ 'Y'
      * ************   add parallel to the above when ready to
      * Chg Voucher ERP Flds  CH - Hog Voucher Detail  * 
     C                     EXSR STCHRC
      * if M3 Live, update TH, BOL
      * CASE: PAR.Live with M3   USR is Yes
     C           YL0006    IFEQ 'Y'                        *IF
      * CASE: PAR.VCH Payee Type is Truck Checks
     C           WACSST    IFEQ 'T'                        *IF
      * Rtv/Chg BOL Vchr Info XF - STR HPE Interface/OthSys  * 
     C                     CALL 'PKTJXFR'              90  Rtv/Chg BOL Vch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0026  30       BOH Company Num
     C                     PARM WBBNNB    WQ0027  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0028  50       BOL Load Number
     C                     PARM YL0023    WQ0029  80       BOL AP Voucher
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: PAR.VCH Payee Type is Producer Checks
     C           WACSST    IFEQ 'I'                        *IF
     C           WACSST    OREQ 'E'
      * Rtv/Chg TH Vchr Info  XF - STR HPE Interface/OthSys  * 
     C                     CALL 'PKTKXFR'              90  Rtv/Chg TH Vchr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0030  30       BOH Company Num
     C                     PARM WBBNNB    WQ0031  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0032  50       BOL Load Number
     C                     PARM WBCVNB    WQ0033  50       TH Tattoo Numbe
     C                     PARM YL0023    WQ0034  80       TH AP Voucher/D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Split -- write it out too
      * CASE: DB1.VCD Less Split Amount is Not Zeros
     C           WBCVPR    IFNE 0                          *IF
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR SURVGN
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR SWRVGN
     C                     MOVELYL0025    YL0046           Name USR
     C                     Z-ADD1         ZQ      50
     C           YL0046    CAT  'SPLIT':ZQYL0025    P      MGL Description
      * RMC  Use SPLIT Debit note reason per member/non/resale.   4.14.17
      * CASE: LCL.TH Hog Class Type is Market
     C           YL0045    IFEQ 'M'                        *IF
      * CASE: LCL.SR Source Contract Type is Member (Owner)
     C           YL0044    IFEQ 'M'                        *IF
     C                     MOVEL'SMEMP'   YL0047           Ded D/A Code 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SNMMP'   YL0047           Ded D/A Code 1
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.TH Hog Class Type is Resale
     C           YL0045    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    YL0047           Ded D/A Code 1
     C                     MOVEL'SRSL'    YL0047           Ded D/A Code 1
     C                     ELSE
      * CASE: *OTHERWISE
      * Catchall
     C                     MOVEL'SNMMP'   YL0047           Ded D/A Code 1
     C                     END                             *FI
     C                     END                             *FI
      * Rtv M3 Debit Note Rsn RT - Deduction/Addition  * 
     C                     EXSR SYRVGN
     C                     MOVEL*BLANK    YL0050           MGL Debit note
     C                     MOVELYL0048    YL0050           MGL Debit note
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
     C                     EXSR SZCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR TBCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR TCCRRC
     C                     MOVELYL0046    YL0025           MGL Description
     C                     END                             *FI
      * RMC 4/10/17 DONT CREATE D/A FOR SPLIT
      * CASE: PAR.VCH Split Check Sts is No
     C           WAJHST    IFEQ 'N'                        *IF
      * Create batch header rcd for each deduction/addition
      * CASE: PAR.VCH Payee Type is Producer Checks
     C           WACSST    IFEQ 'I'                        *IF
     C           WACSST    OREQ 'E'
      * Rtv/Crt M3 InvBtchHdr RT - Tattoo Ded/Add  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@BLCPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'S2D'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSSC     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0021           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR SDCHRC
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHSD    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YARDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'HPE'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSSE     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0023           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR SFCHRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHSF    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHSF    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YBRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Trucker Name - Trucker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WEBNCD           TRK Trucker Cod
      * Setup key
     C                     MOVELWABNCD    WEBNCD           TRK Trucker Cod
      * Establish starting position
     C           KRSSG     CHAIN@BAREDS              90    *
      * Data record not found
     C   90                MOVEL'PRK0079' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBJTX    YL0024           TRK Name
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Trucker M3 Payer# RT - Trucker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WEBNCD           TRK Trucker Cod
      * Setup key
     C                     MOVELWABNCD    WEBNCD           TRK Trucker Cod
      * Establish starting position
     C           KRSSH     CHAIN@BAREDS              90    *
      * Data record not found
     C   90                MOVEL'PRK0079' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEC3TX    YL0038           TRK M3 Supplier
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv M3 Supp w/E1 Vnd  RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFGCNB    WQSI01           PD VND Address
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           PD VND Address
      * Setup key
     C                     Z-ADDWALXNB    WQSI01           PD VND Address
      * Establish starting position
     C           KRSSI     SETLL@ACREBC                    *
     C           KRSSI     READE@ACREBC                  90*
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Get M3 supplier using E1 Vnd# -- sdn440
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR SJRVGN
     C           KRSSI     READE@ACREBC                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WGABCD           PD Producer Cod
      * Setup key
     C                     MOVELWFABCD    WGABCD           PD Producer Cod
      * Establish starting position
     C           KRSSJ     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0038           M3 Supplier ID
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGQHCD    YL0038           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2-NM  RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHQHCD    WQSK01           M3 Supplier ID
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           M3 Supplier ID
      * Setup key
     C                     MOVELYL0038    WQSK01           M3 Supplier ID
      * Establish starting position
     C           KRSSK     SETLL@B4REW9                    *
     C           KRSSK     READE@B4REW9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = PAR By name
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Producer Nm, Srce RT - Producer  * 
     C                     EXSR SLRVGN
     C                     MOVELWHABCD    YL0041           PD Producer Cod
     C           KRSSK     READE@B4REW9                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Producer Nm, Srce RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIABCD           PD Producer Cod
      * Setup key
     C                     MOVELWHABCD    WIABCD           PD Producer Cod
      * Establish starting position
     C           KRSSL     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0042           SR Source Code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIAACD    YL0042           SR Source Code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv M3 Supplier Name  RT - M3 Supplier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WJQHCD           M3 Supplier ID
      * Setup key
     C                     MOVELYL0038    WJQHCD           M3 Supplier ID
      * Establish starting position
     C           KRSSM     CHAIN@B2RETY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1325' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0043           M3 Supplier Nam
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJZNTX    YL0043           M3 Supplier Nam
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Src Cntrt Type    RT - Source  * use for split processing
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WKAACD           SR Source Code
      * Setup key
     C                     MOVELYL0042    WKAACD           SR Source Code
      * Establish starting position
     C           KRSSN     CHAIN@AAREAC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0005' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0044           SR Source Contr
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKCYSS    YL0044           SR Source Contr
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Held Over Y/N     RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLHMNB    WQSO01           BOH Company Num
     C           *LIKE     DEFN WLBNNB    WQSO02           BOH Buy Order N
     C           *LIKE     DEFN WLBONB    WQSO03           BOL Load Number
     C           *LIKE     DEFN WLCVNB    WQSO04           TH Tattoo Numbe
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           BOH Company Num
     C                     KFLD           WQSO02           BOH Buy Order N
     C                     KFLD           WQSO03           BOL Load Number
     C                     KFLD           WQSO04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHMNB    WQSO01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSO02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSO03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSO04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSO     SETLL@A1CPC4                    *
     C           KRSSO     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0045           TH Hog Class Ty
     C                     MOVEL*BLANK    YL0020           Held Over Recor
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Held Over Record is Yes
     C           WLE1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0020           Held Over Recor
     C                     END                             *FI
     C                     MOVELWLLLST    YL0045           TH Hog Class Ty
     C           KRSSO     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CCCPUX
     C                     Z-ADDYL0007    WMWJA1           MGL Company
     C                     MOVELYL0008    WMQXCD           MGL Division
     C                     Z-ADDYL0021    WMWOA1           MGL Invoice Bat
     C                     MOVELYL0039    WMQYCD           MGL Payee
     C                     MOVELYL0040    WMQZCD           MGL Supplier
     C                     MOVELYL0032    WMQ0CD           MGL Supplier In
     C                     MOVEL'20'      WMQ1CD           MGL Invoice Bat
     C                     Z-ADD10        WMWPA1           MGL Invoice Sta
     C                     Z-ADDYL0016    WMAFDX           MGL Invoice Dat
     C                     MOVELWN0001    WMQ5CD           MGL Currency
     C                     MOVELWN0002    WMQ6CD           MGL Payment Ter
     C                     Z-ADD*ZERO     WMLFVA           MGL Total Line
     C                     Z-ADD*ZERO     WMLGVA           MGL Cash Discou
     C                     Z-ADDWBAKVA    WMLNVA           MGL Foreign Cur
     C                     Z-ADD*ZERO     WMLHVA           MGL Total Charg
     C                     Z-ADD*ZERO     WMLIVA           MGL Total Due
     C                     MOVEL'0'       WMG3SS           MGL Invoice Mat
     C                     Z-ADD*ZERO     WMWYA1           MGL Service Cod
     C                     MOVELWN0003    WMQ2CD           MGL Payment Met
     C                     MOVELYL0011    WMQ3CD           MGL Voucher Num
     C                     Z-ADDYL0023    WMWSA1           MGL Voucher Num
     C                     MOVELYL0025    WMAKT1           MGL Description
     C                     Z-ADD01        WMWXA1           MGL Exchange Ra
     C                     MOVEL*BLANK    WMAXT1           MGL Purchase Or
     C                     MOVEL*BLANK    WMQ7CD           MGL Cash discou
     C                     MOVELWN0004    WMG2SS           MGL Get Payee D
     C                     MOVELYL0017    WMANT1           MGL Job Number
     C                     MOVEL##PGM     WMAOT1           MGL Job Name
     C                     Z-ADDYL0005    WMAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WMB0TM           MGL Entry Time
     C                     MOVEL*BLANK    WMART1           MGL Reference N
     C                     Z-ADD*ZERO     WMLOVA           MGL Exchange ra
     C                     MOVEL*BLANK    WMRACD           MGL Trade code
     C                     Z-ADD*ZERO     WMLPVA           MGL VAT
     C                     Z-ADD*ZERO     WMAIDX           MGL Accounting
     C                     MOVELYL0010    WMAZT1           MGL Authorized
     C                     Z-ADD*ZERO     WMAJDX           MGL Due date
     C                     MOVEL*BLANK    WMA0T1           MGL Future rate
     C                     MOVEL*BLANK    WMRBCD           MGL From/to cou
     C                     MOVEL*BLANK    WMRCCD           MGL Base countr
     C                     Z-ADD*ZERO     WMAKDX           MGL Order date
     C                     Z-ADD*ZERO     WMALDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW1A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLQVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAODX           MGL Cash discou
     C                     Z-ADD*ZERO     WMLRVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLVVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAMDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW2A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLSVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLTVA           MGL Total taxab
     C                     Z-ADD*ZERO     WMLUVA           MGL Prepaid amo
     C                     MOVEL*BLANK    WMA1T1           MGL VAT reg num
     C                     Z-ADD*ZERO     WMW3A1           MGL Tax applica
     C                     MOVEL*BLANK    WMRDCD           MGL Document co
     C                     MOVEL*BLANK    WMRECD           MGL AP standard
     C                     MOVEL*BLANK    WMRFCD           MGL Debit note
     C                     MOVEL*BLANK    WMRGCD           MGL Our invoici
     C                     MOVEL*BLANK    WMA2T1           MGL Text line 1
     C                     MOVEL*BLANK    WMA3T1           MGL Text line 2
     C                     MOVEL*BLANK    WMA4T1           MGL Text line 3
     C                     MOVEL*BLANK    WMA5T1           MGL EAN loc cod
     C                     MOVEL*BLANK    WMA6T1           MGL EAN loc cde
     C                     MOVEL*BLANK    WMA7T1           MGL EAN loc cod
     C                     Z-ADD*ZERO     WMANDX           MGL Delivery da
     C                     MOVEL*BLANK    WMRHCD           MGL Bank accoun
     C                     Z-ADD*ZERO     WMW4A1           MGL Geographica
     C                     Z-ADD*ZERO     WMW5A1           MGL Tax include
     C                     MOVEL*BLANK    WMA8T1           MGL Original in
     C                     Z-ADD*ZERO     WMW6A1           MGL Original ye
     C                     MOVEL*BLANK    WMA9T1           MGL Payment req
     C                     Z-ADD*ZERO     WMW7A1           MGL Year
     C                     Z-ADD*ZERO     WMW8A1           MGL Partial val
     C                     MOVEL'0'       WMG5SS           MGL ERP Process
     C                     Z-ADD*ZERO     WMAPDX           MGL ERP Process
     C                     Z-ADD*ZERO     WMB1TM           MGL ERP Process
     C                     MOVEL*BLANK    WMAAVN           RS User Changed
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     MOVELWBAJST    WMAJST           RS Record Statu
     C                     MOVELWBAHVN    WMAHVN           RS Job
     C                     MOVELWBAGVN    WMAGVN           RS Program
     C                     MOVELWBABVN    WMABVN           RS User Added
     C                     Z-ADDWBABDT    WMABDT           RS Date Added
     C                     Z-ADDWBABTM    WMABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVEL##USR     WMABVN           RS User Added
     C                     Z-ADD##JDT     WMABDT           RS Date Added
     C                     Z-ADD##JTM     WMABTM           RS Time Added
     C                     MOVEL##PGM     WMAGVN           RS Program
     C                     MOVEL##JOB     WMAHVN           RS Job
     C           KLCRSP    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
      * Check for duplicate primary key
     C           KLCRSP    SETLL@CCCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1374' W0RTN   7
      * USER: Processing if Data record already exists
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR SQCHRC
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@CCCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @CCCPUX
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHSQ    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    YCRDCS
      * Move non-key fields to @CCCPUX
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0021    WOWOA1           MGL Invoice Bat
     C                     Z-ADD412       WOQ8CD           MGL AP Informat
     C                     MOVELYL0026    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRSR    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRSR    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0021    WOWOA1           MGL Invoice Bat
     C                     Z-ADD413       WOQ8CD           MGL AP Informat
     C                     MOVELYL0009    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRSS    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRSS    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Voucher ERP Flds  CH - Hog Voucher Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  72       VCD Base Mkt Pr
     C                     Z-ADD*ZERO     WN0006  72       VCD Sort Disc A
     C                     Z-ADD*ZERO     WN0007  72       VCD Yield Gain/
     C                     Z-ADD*ZERO     WN0008  72       VCD Base Carcas
     C                     Z-ADD*ZERO     WN0009  72       VCD LN Add on/D
     C                     Z-ADD*ZERO     WN0010  92       VCD Gross Amt
     C                     Z-ADD*ZERO     WN0011  92       VCD Deduction A
     C                     Z-ADD*ZERO     WN0012  72       VCD Less Split
     C                     Z-ADD*ZERO     WN0013  92       VCD Net Amt
     C                     Z-ADD*ZERO     WN0014  30       VCD Split Perce
     C                     MOVEL*BLANK    WN0015  1        VCD Payment Typ
     C                     MOVEL*BLANK    WN0016  1        VCD Hog Class T
     C                     MOVEL*BLANK    WN0017  1        VCD BO Type
     C                     MOVEL*BLANK    WN0018  1        VCD Source Cont
     C                     MOVEL*BLANK    WN0019  3        VCD Source Code
     C                     MOVEL*BLANK    WN0020 20        VCD Check Descr
     C                     Z-ADD*ZERO     WN0021  50       VCD Received He
     C                     Z-ADD*ZERO     WN0022  50       VCD Head Killed
     C                     MOVEL*BLANK    WN0023  1        VCD Push Paymen
     C                     MOVEL*BLANK    WN0024  1        VCD Repayment F
     C                     MOVEL*BLANK    WN0025  1        VCD Unused Stat
     C                     MOVEL*BLANK    WN0026  1        VCD Unused Stat
     C                     Z-ADD*ZERO     WN0027  50       VCD Unused Head
     C                     Z-ADD*ZERO     WN0028  50       VCD UnUsed Head
     C                     Z-ADD*ZERO     WN0029  50       VCD UnUsed Head
     C                     Z-ADD*ZERO     WN0030  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0031  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0032  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0033  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0034  70       TH Kill Date
     C                     MOVEL*BLANK    WN0035  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0036  6        PL Location Cod
     C                     MOVEL*BLANK    WN0037 10        RS User Changed
     C                     Z-ADD*ZERO     WN0038  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0039  60       RS Time Changed
     C                     MOVEL*BLANK    WN0040  1        RS Record Statu
     C                     MOVEL*BLANK    WN0041 10        RS Job
     C                     MOVEL*BLANK    WN0042 10        RS Program
     C                     MOVEL*BLANK    WN0043 10        RS User Added
     C                     Z-ADD*ZERO     WN0044  70       RS Date Added
     C                     Z-ADD*ZERO     WN0045  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BLCPEI
     C                     Z-ADDWBHNNB    WRHNNB           VCH Company num
     C                     Z-ADDWBLWNB    WRLWNB           VCH Batch Numbe
     C                     Z-ADDWBG9NB    WRG9NB           VCH Header Numb
     C                     Z-ADDWBDLNB    WRDLNB           VCD Line
      *
     C           KLCHST    KLIST
     C                     KFLD           WRHNNB           VCH Company num
     C                     KFLD           WRLWNB           VCH Batch Numbe
     C                     KFLD           WRG9NB           VCH Header Numb
     C                     KFLD           WRDLNB           VCD Line
     C           KLCHST    CHAIN@BLCPEI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBLCPL0'MDACP
     C                     MOVEL'@BLCPEI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBL1    YDRDCS
      * Move non-key fields to @BLCPEI
     C                     MOVELYL0032    WRQ0CD    P      MGL Supplier In
     C                     Z-ADDYL0023    WRWSA1           MGL Voucher Num
     C                     Z-ADDYL0021    WRWOA1           MGL Invoice Bat
     C                     Z-ADD##JDT     WRHFDT           MGL Process to
     C                     Z-ADD##JTM     WRB2TM           MGL Process to
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBL1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WRAAVN           RS User Changed
     C                     Z-ADD##JDT     WRAADT           RS Date Changed
     C                     Z-ADD##JTM     WRAMTM           RS Time Changed
     C                     MOVEL##JOB     WRAHVN           RS Job
     C                     MOVEL##PGM     WRAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBL1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BLCPEI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'S2D'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSSU     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0021           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR SVCHRC
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHSV    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHSV    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YERDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'HPE'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSSW     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0023           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR SXCHRC
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHSX    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHSX    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YFRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv M3 Debit Note Rsn RT - Deduction/Addition  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WSBQCD           DED D/A Code
      * Setup key
     C                     MOVELYL0047    WSBQCD           DED D/A Code
      * Establish starting position
     C           KRSSY     CHAIN@BBRED5              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0048           DED M3 Debit No
     C                     MOVEL*BLANK    YL0049           DED M3 Debt Nt
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSRICD    YL0048           DED M3 Debit No
     C                     MOVELWSRJCD    YL0049           DED M3 Debt Nt
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CCCPUX
     C                     Z-ADDYL0007    WMWJA1           MGL Company
     C                     MOVELYL0008    WMQXCD           MGL Division
     C                     Z-ADDYL0021    WMWOA1           MGL Invoice Bat
     C                     MOVELYL0039    WMQYCD           MGL Payee
     C                     MOVELYL0040    WMQZCD           MGL Supplier
     C                     MOVELYL0032    WMQ0CD           MGL Supplier In
     C                     MOVEL'30'      WMQ1CD           MGL Invoice Bat
     C                     Z-ADD10        WMWPA1           MGL Invoice Sta
     C                     Z-ADDYL0016    WMAFDX           MGL Invoice Dat
     C                     MOVELWN0001    WMQ5CD           MGL Currency
     C                     MOVELWN0002    WMQ6CD           MGL Payment Ter
     C                     Z-ADD*ZERO     WMLFVA           MGL Total Line
     C                     Z-ADD*ZERO     WMLGVA           MGL Cash Discou
     C                     Z-ADDWBCVPR    WMLNVA           MGL Foreign Cur
     C                     Z-ADD*ZERO     WMLHVA           MGL Total Charg
     C                     Z-ADD*ZERO     WMLIVA           MGL Total Due
     C                     MOVEL'0'       WMG3SS           MGL Invoice Mat
     C                     Z-ADD*ZERO     WMWYA1           MGL Service Cod
     C                     MOVELWN0003    WMQ2CD           MGL Payment Met
     C                     MOVELYL0011    WMQ3CD           MGL Voucher Num
     C                     Z-ADDYL0023    WMWSA1           MGL Voucher Num
     C                     MOVELYL0025    WMAKT1           MGL Description
     C                     Z-ADD01        WMWXA1           MGL Exchange Ra
     C                     MOVEL*BLANK    WMAXT1           MGL Purchase Or
     C                     MOVEL*BLANK    WMQ7CD           MGL Cash discou
     C                     MOVELWN0004    WMG2SS           MGL Get Payee D
     C                     MOVELYL0017    WMANT1           MGL Job Number
     C                     MOVEL##PGM     WMAOT1           MGL Job Name
     C                     Z-ADDYL0005    WMAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WMB0TM           MGL Entry Time
     C                     MOVEL*BLANK    WMART1           MGL Reference N
     C                     Z-ADD*ZERO     WMLOVA           MGL Exchange ra
     C                     MOVEL*BLANK    WMRACD           MGL Trade code
     C                     Z-ADD*ZERO     WMLPVA           MGL VAT
     C                     Z-ADD*ZERO     WMAIDX           MGL Accounting
     C                     MOVELYL0010    WMAZT1           MGL Authorized
     C                     Z-ADD*ZERO     WMAJDX           MGL Due date
     C                     MOVEL*BLANK    WMA0T1           MGL Future rate
     C                     MOVEL*BLANK    WMRBCD           MGL From/to cou
     C                     MOVEL*BLANK    WMRCCD           MGL Base countr
     C                     Z-ADD*ZERO     WMAKDX           MGL Order date
     C                     Z-ADD*ZERO     WMALDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW1A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLQVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAODX           MGL Cash discou
     C                     Z-ADD*ZERO     WMLRVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLVVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAMDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW2A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLSVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLTVA           MGL Total taxab
     C                     Z-ADD*ZERO     WMLUVA           MGL Prepaid amo
     C                     MOVEL*BLANK    WMA1T1           MGL VAT reg num
     C                     Z-ADD*ZERO     WMW3A1           MGL Tax applica
     C                     MOVEL*BLANK    WMRDCD           MGL Document co
     C                     MOVEL*BLANK    WMRECD           MGL AP standard
     C                     MOVELYL0050    WMRFCD           MGL Debit note
     C                     MOVEL*BLANK    WMRGCD           MGL Our invoici
     C                     MOVEL*BLANK    WMA2T1           MGL Text line 1
     C                     MOVEL*BLANK    WMA3T1           MGL Text line 2
     C                     MOVEL*BLANK    WMA4T1           MGL Text line 3
     C                     MOVEL*BLANK    WMA5T1           MGL EAN loc cod
     C                     MOVEL*BLANK    WMA6T1           MGL EAN loc cde
     C                     MOVEL*BLANK    WMA7T1           MGL EAN loc cod
     C                     Z-ADD*ZERO     WMANDX           MGL Delivery da
     C                     MOVEL*BLANK    WMRHCD           MGL Bank accoun
     C                     Z-ADD*ZERO     WMW4A1           MGL Geographica
     C                     Z-ADD*ZERO     WMW5A1           MGL Tax include
     C                     MOVEL*BLANK    WMA8T1           MGL Original in
     C                     Z-ADD*ZERO     WMW6A1           MGL Original ye
     C                     MOVEL*BLANK    WMA9T1           MGL Payment req
     C                     Z-ADD*ZERO     WMW7A1           MGL Year
     C                     Z-ADD*ZERO     WMW8A1           MGL Partial val
     C                     MOVEL'0'       WMG5SS           MGL ERP Process
     C                     Z-ADD*ZERO     WMAPDX           MGL ERP Process
     C                     Z-ADD*ZERO     WMB1TM           MGL ERP Process
     C                     MOVEL*BLANK    WMAAVN           RS User Changed
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     MOVELWBAJST    WMAJST           RS Record Statu
     C                     MOVELWBAHVN    WMAHVN           RS Job
     C                     MOVELWBAGVN    WMAGVN           RS Program
     C                     MOVELWBABVN    WMABVN           RS User Added
     C                     Z-ADDWBABDT    WMABDT           RS Date Added
     C                     Z-ADDWBABTM    WMABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVEL##USR     WMABVN           RS User Added
     C                     Z-ADD##JDT     WMABDT           RS Date Added
     C                     Z-ADD##JTM     WMABTM           RS Time Added
     C                     MOVEL##PGM     WMAGVN           RS Program
     C                     MOVEL##JOB     WMAHVN           RS Job
     C           KLCRSZ    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@CCCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1374' W0RTN   7
      * USER: Processing if Data record already exists
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR TACHRC
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@CCCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @CCCPUX
      *
     C           KLCHTA    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHTA    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    YGRDCS
      * Move non-key fields to @CCCPUX
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0021    WOWOA1           MGL Invoice Bat
     C                     Z-ADD412       WOQ8CD           MGL AP Informat
     C                     MOVELYL0026    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRTB    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRTB    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0021    WOWOA1           MGL Invoice Bat
     C                     Z-ADD413       WOQ8CD           MGL AP Informat
     C                     MOVELYL0009    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRTC    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRTC    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv/Crt M3 InvBtchHdr RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC 2/24/2022 SDN440 FOR TPALW CALCS
      *               use head killed for the kill date -> not the total
      * 9/7/17 RMC 440 wont contra reason for TPALW -- chk for >blank
      * ** Create M3 Inv Batch header for each deduction/addition
      *   with type = 30 = debit note, and reason code = d/a code
      *  For held over tattoo, the h/o d/a will already exist for the
      *  supplier invoice number (must be unique in M3), so add to it
      * AP standard document must be 01 for these debit note records.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTHMNB    WQTD01           BOH Company Num
     C           *LIKE     DEFN WTBNNB    WQTD02           BOH Buy Order N
     C           *LIKE     DEFN WTBONB    WQTD03           BOL Load Number
     C           *LIKE     DEFN WTCVNB    WQTD04           TH Tattoo Numbe
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           BOH Company Num
     C                     KFLD           WQTD02           BOH Buy Order N
     C                     KFLD           WQTD03           BOL Load Number
     C                     KFLD           WQTD04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHMNB    WQTD01           BOH Company Num
     C                     Z-ADDWBBNNB    WQTD02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQTD03           BOL Load Number
     C                     Z-ADDWBCVNB    WQTD04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTD     SETLL@CDCPIU                    *
     C           KRSTD     READE@CDCPIU                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * EXPENSE PAID BY PRODUCER
      * CASE: DB1.THD Expense Paid by is Producer
     C           WTPEST    IFEQ 'P'                        *IF
      * Triumph Transp allowance accrual --> TPALW -- and frt allow accrl
      * CASE: DB1.DED D/A Code is Triumph Transport Allow
     C           WTBQCD    IFEQ 'TPALW'                    *IF
      * Rtv Company Value Nbr XF - STR Order Management Sys  * 
     C                     CALL 'PDHGXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WTHMNB    WQ0035  30       BOH Company Num
     C                     PARM 'TPALW'   WQ0036 10        Company Value C
     C           YL0052    PARM *ZERO     WQ0037 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDYL0052    YL0053           Percent Decimal
      * CASE: LCL.System Value Numeric  USR is Not 0
     C           YL0052    IFNE 0                          *IF
      * RMC 2/24/2022 use head killed for the kill date -> not the total
      * CASE: PAR.Held Over Record Ld is Yes
     C           YL0020    IFEQ 'Y'                        *IF
      * Rtv Hd Killed         RT - Tattoo Header  * 
     C                     EXSR TERVGN
     C           YL0054    MULT YL0053    YL0055           MGL Foreign Cur
     C                     ELSE
      * CASE: *OTHERWISE
     C           WBL6A1    MULT YL0053    YL0055           MGL Foreign Cur
     C                     END                             *FI
      * Rtv M3 Debit Note Rsn RT - Deduction/Addition  * 
     C                     EXSR TFRVGN
      * HPPURFRT rcd     --- freight written as a debit
     C                     Z-ADD*ZERO     ZQ      50
     C           WTBQCD    CAT  '+':ZQ    YL0058    P      Text 6 USR
     C                     Z-ADD1         ZQ      50
     C           YL0032    CAT  YL0058:ZQ YL0059    P      MGL Supplier In
      * If not hold over , write TPALW+ rcd
      * CASE: PAR.Held Over Record Ld is Not Yes
     C           YL0020    IFEQ *BLANK                     *IF
     C           YL0020    OREQ 'N'
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR TGRVGN
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR TIRVGN
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
     C                     EXSR TKCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR TMCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR TNCRRC
     C                     END                             *FI
      * If held over and rcd exists add to TPALW+, else create it
      * CASE: PAR.Held Over Record Ld is Yes
     C           YL0020    IFEQ 'Y'                        *IF
      * Rtv Add H/O SpplInv#  RT - M3 Supplier Payment Head  * 
     C                     EXSR TORVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR TQRVGN
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR TSRVGN
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
     C                     EXSR TUCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR TWCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR TXCRRC
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.DED M3 Debt Nt Rsn-Contra is Entered
     C           YL0057    IFGT *BLANK                     *IF
      * HPTALACT rcd     --- allowance written as a credit - contra Dbt N
      * Accrual Amt = (head killed*4) - ( vcd d/a amt) * -1
      * Compute: CR freight accrl
      * LCL.MGL Foreign Currency Amt =
      *    *COMPUTE ((x1-x3) * x2)
      * x1    : LCL.MGL Foreign Currency Amt
      * -     : PGM.*Synon (15,5) work field
      * x3    : DB1.THD Ded/Add Amount
      * *     : PGM.*Synon (15,5) work field *
      * x2    : CON.-1
     C           YL0055    SUB  WTA0VA    W0WB01           *Synon (15,5) w
     C           W0WB01    MULT -1        W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0055           MGL Foreign Cur
     C                     Z-ADD*ZERO     ZQ      50
     C           WTBQCD    CAT  '-':ZQ    YL0058    P      Text 6 USR
     C                     Z-ADD1         ZQ      50
     C           YL0032    CAT  YL0058:ZQ YL0059    P      MGL Supplier In
      * If not hold over , write TPALW- rcd
      * CASE: PAR.Held Over Record Ld is Not Yes
     C           YL0020    IFEQ *BLANK                     *IF
     C           YL0020    OREQ 'N'
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR TYRVGN
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR NARVGN
     C                     MOVEL*BLANK    YL0063           MGL Debit note
     C                     MOVEL*BLANK    YL0063           MGL Debit note
     C                     MOVELYL0057    YL0063           MGL Debit note
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
     C                     EXSR NCCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR NECRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR NFCRRC
     C                     END                             *FI
      * If held over and rcd exists add to TPALW-, else create it
      * CASE: PAR.Held Over Record Ld is Yes
     C           YL0020    IFEQ 'Y'                        *IF
      * Rtv Add H/O SpplInv#  RT - M3 Supplier Payment Head  * 
     C                     EXSR NGRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR NIRVGN
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR NKRVGN
     C                     MOVEL*BLANK    YL0063           MGL Debit note
     C                     MOVEL*BLANK    YL0063           MGL Debit note
     C                     MOVELYL0057    YL0063           MGL Debit note
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
     C                     EXSR NMCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR NOCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR NPCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * **********************
      * Write Regular D/A that arent TPALW and dont have the frt allow ac
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.DED D/A Code is Triumph Transport Allow
      *   |- c2    : LCL.System Value Numeric  USR is Not 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WTBQCD    IFEQ 'TPALW'                    *IF
     C           YL0052    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv M3 Debit Note Rsn RT - Deduction/Addition  * 
     C                     EXSR NQRVGN
      * CASE: DB1.THD Unit Amt Sign is Subtract
     C           WTJBST    IFEQ '-'                        *IF
     C           -1        MULT WTA0VA    YL0055           MGL Foreign Cur
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWTA0VA    YL0055           MGL Foreign Cur
     C                     END                             *FI
     C                     Z-ADD1         ZQ      50
     C           YL0032    CAT  WTBQCD:ZQ YL0059    P      MGL Supplier In
      * If not hold over, then write the d/a record
      * CASE: PAR.Held Over Record Ld is Not Yes
     C           YL0020    IFEQ *BLANK                     *IF
     C           YL0020    OREQ 'N'
      * Write bal sheet rcd to g/l file     f911
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR NRRVGN
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR NTRVGN
     C                     MOVEL*BLANK    YL0063           MGL Debit note
     C                     MOVEL*BLANK    YL0063           MGL Debit note
     C                     MOVELYL0056    YL0063           MGL Debit note
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
     C                     EXSR NVCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR NXCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR NYCRRC
     C                     END                             *FI
      * If held over and rcd exists add to Suppl Inv Rcd, else create it
      * CASE: PAR.Held Over Record Ld is Yes
     C           YL0020    IFEQ 'Y'                        *IF
      * Rtv Add H/O SpplInv#  RT - M3 Supplier Payment Head  * 
     C                     EXSR NZRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR OBRVGN
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
     C                     EXSR ODRVGN
     C                     MOVEL*BLANK    YL0063           MGL Debit note
     C                     MOVEL*BLANK    YL0063           MGL Debit note
     C                     MOVELYL0056    YL0063           MGL Debit note
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
     C                     EXSR OFCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR OHCRRC
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
     C                     EXSR OICRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTD     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Hd Killed         RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVHMNB    WQTE01           BOH Company Num
     C           *LIKE     DEFN WVBNNB    WQTE02           BOH Buy Order N
     C           *LIKE     DEFN WVBONB    WQTE03           BOL Load Number
     C           *LIKE     DEFN WVB0DT    WQTE04           TH Kill Date
     C           *LIKE     DEFN WVCVNB    WQTE05           TH Tattoo Numbe
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           BOH Company Num
     C                     KFLD           WQTE02           BOH Buy Order N
     C                     KFLD           WQTE03           BOL Load Number
     C                     KFLD           WQTE04           TH Kill Date
     C                     KFLD           WQTE05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWTHMNB    WQTE01           BOH Company Num
     C                     Z-ADDWTBNNB    WQTE02           BOH Buy Order N
     C                     Z-ADDWTBONB    WQTE03           BOL Load Number
     C                     Z-ADDWTB0DT    WQTE04           TH Kill Date
     C                     Z-ADDWTCVNB    WQTE05           TH Tattoo Numbe
      * Establish starting position
     C           KRSTE     SETLL@A1CPOC                    *
     C           KRSTE     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWVFENB    YL0054           TH Head Killed
     C           KRSTE     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv M3 Debit Note Rsn RT - Deduction/Addition  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WSBQCD           DED D/A Code
      * Setup key
     C                     MOVELWTBQCD    WSBQCD           DED D/A Code
      * Establish starting position
     C           KRSTF     CHAIN@BBRED5              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0056           DED M3 Debit No
     C                     MOVEL*BLANK    YL0057           DED M3 Debt Nt
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSRICD    YL0056           DED M3 Debit No
     C                     MOVELWSRJCD    YL0057           DED M3 Debt Nt
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'S2D'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSTG     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0060           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR THCHRC
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHTH    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHTH    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YHRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'HPE'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSTI     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0061           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR TJCHRC
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHTJ    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHTJ    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YIRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CCCPUX
     C                     Z-ADDYL0007    WMWJA1           MGL Company
     C                     MOVELYL0008    WMQXCD           MGL Division
     C                     Z-ADDYL0060    WMWOA1           MGL Invoice Bat
     C                     MOVELYL0039    WMQYCD           MGL Payee
     C                     MOVELYL0040    WMQZCD           MGL Supplier
     C                     MOVELYL0059    WMQ0CD           MGL Supplier In
     C                     MOVEL'30'      WMQ1CD           MGL Invoice Bat
     C                     Z-ADD10        WMWPA1           MGL Invoice Sta
     C                     Z-ADDYL0016    WMAFDX           MGL Invoice Dat
     C                     MOVELWN0001    WMQ5CD           MGL Currency
     C                     MOVELWN0002    WMQ6CD           MGL Payment Ter
     C                     Z-ADD*ZERO     WMLFVA           MGL Total Line
     C                     Z-ADD*ZERO     WMLGVA           MGL Cash Discou
     C                     Z-ADDYL0055    WMLNVA           MGL Foreign Cur
     C                     Z-ADD*ZERO     WMLHVA           MGL Total Charg
     C                     Z-ADD*ZERO     WMLIVA           MGL Total Due
     C                     MOVEL'0'       WMG3SS           MGL Invoice Mat
     C                     Z-ADD*ZERO     WMWYA1           MGL Service Cod
     C                     MOVELWN0003    WMQ2CD           MGL Payment Met
     C                     MOVELYL0011    WMQ3CD           MGL Voucher Num
     C                     Z-ADDYL0061    WMWSA1           MGL Voucher Num
     C                     MOVELYL0025    WMAKT1           MGL Description
     C                     Z-ADD01        WMWXA1           MGL Exchange Ra
     C                     MOVEL*BLANK    WMAXT1           MGL Purchase Or
     C                     MOVEL*BLANK    WMQ7CD           MGL Cash discou
     C                     MOVELWN0004    WMG2SS           MGL Get Payee D
     C                     MOVELYL0017    WMANT1           MGL Job Number
     C                     MOVEL##PGM     WMAOT1           MGL Job Name
     C                     Z-ADDYL0005    WMAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WMB0TM           MGL Entry Time
     C                     MOVEL*BLANK    WMART1           MGL Reference N
     C                     Z-ADD*ZERO     WMLOVA           MGL Exchange ra
     C                     MOVEL*BLANK    WMRACD           MGL Trade code
     C                     Z-ADD*ZERO     WMLPVA           MGL VAT
     C                     Z-ADDYL0016    WMAIDX           MGL Accounting
     C                     MOVELYL0010    WMAZT1           MGL Authorized
     C                     Z-ADD*ZERO     WMAJDX           MGL Due date
     C                     MOVEL*BLANK    WMA0T1           MGL Future rate
     C                     MOVEL*BLANK    WMRBCD           MGL From/to cou
     C                     MOVEL*BLANK    WMRCCD           MGL Base countr
     C                     Z-ADD*ZERO     WMAKDX           MGL Order date
     C                     Z-ADD*ZERO     WMALDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW1A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLQVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAODX           MGL Cash discou
     C                     Z-ADD*ZERO     WMLRVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLVVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAMDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW2A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLSVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLTVA           MGL Total taxab
     C                     Z-ADD*ZERO     WMLUVA           MGL Prepaid amo
     C                     MOVEL*BLANK    WMA1T1           MGL VAT reg num
     C                     Z-ADD*ZERO     WMW3A1           MGL Tax applica
     C                     MOVEL*BLANK    WMRDCD           MGL Document co
     C                     MOVE *BLANK    WMRECD           MGL AP standard
     C                     MOVEL'01'      WMRECD           MGL AP standard
     C                     MOVELYL0056    WMRFCD           MGL Debit note
     C                     MOVEL*BLANK    WMRGCD           MGL Our invoici
     C                     MOVEL*BLANK    WMA2T1           MGL Text line 1
     C                     MOVEL*BLANK    WMA3T1           MGL Text line 2
     C                     MOVEL*BLANK    WMA4T1           MGL Text line 3
     C                     MOVEL*BLANK    WMA5T1           MGL EAN loc cod
     C                     MOVEL*BLANK    WMA6T1           MGL EAN loc cde
     C                     MOVEL*BLANK    WMA7T1           MGL EAN loc cod
     C                     Z-ADD*ZERO     WMANDX           MGL Delivery da
     C                     MOVEL*BLANK    WMRHCD           MGL Bank accoun
     C                     Z-ADD*ZERO     WMW4A1           MGL Geographica
     C                     Z-ADD*ZERO     WMW5A1           MGL Tax include
     C                     MOVEL*BLANK    WMA8T1           MGL Original in
     C                     Z-ADD*ZERO     WMW6A1           MGL Original ye
     C                     MOVEL*BLANK    WMA9T1           MGL Payment req
     C                     Z-ADD*ZERO     WMW7A1           MGL Year
     C                     Z-ADD*ZERO     WMW8A1           MGL Partial val
     C                     MOVEL'0'       WMG5SS           MGL ERP Process
     C                     Z-ADD*ZERO     WMAPDX           MGL ERP Process
     C                     Z-ADD*ZERO     WMB1TM           MGL ERP Process
     C                     MOVEL*BLANK    WMAAVN           RS User Changed
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     MOVELWTAJST    WMAJST           RS Record Statu
     C                     MOVELWTAHVN    WMAHVN           RS Job
     C                     MOVELWTAGVN    WMAGVN           RS Program
     C                     MOVELWTABVN    WMABVN           RS User Added
     C                     Z-ADDWTABDT    WMABDT           RS Date Added
     C                     Z-ADDWTABTM    WMABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVEL##USR     WMABVN           RS User Added
     C                     Z-ADD##JDT     WMABDT           RS Date Added
     C                     Z-ADD##JTM     WMABTM           RS Time Added
     C                     MOVEL##PGM     WMAGVN           RS Program
     C                     MOVEL##JOB     WMAHVN           RS Job
     C           KLCRTK    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
      * Check for duplicate primary key
     C           KLCRTK    SETLL@CCCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1374' W0RTN   7
      * USER: Processing if Data record already exists
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR TLCHRC
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@CCCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @CCCPUX
      *
     C           KLCHTL    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHTL    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    YJRDCS
      * Move non-key fields to @CCCPUX
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD412       WOQ8CD           MGL AP Informat
     C                     MOVELYL0026    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRTM    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRTM    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD413       WOQ8CD           MGL AP Informat
     C                     MOVELYL0009    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRTN    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRTN    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv Add H/O SpplInv#  RT - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWWJA1    WQTO01           MGL Company
     C           *LIKE     DEFN WWQXCD    WQTO02           MGL Division
     C           *LIKE     DEFN WWQZCD    WQTO03           MGL Supplier
     C           *LIKE     DEFN WWQ0CD    WQTO04           MGL Supplier In
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           MGL Company
     C                     KFLD           WQTO02           MGL Division
     C                     KFLD           WQTO03           MGL Supplier
     C                     KFLD           WQTO04           MGL Supplier In
      * Setup key
     C                     Z-ADDYL0007    WQTO01           MGL Company
     C                     MOVELYL0008    WQTO02           MGL Division
     C                     MOVELYL0040    WQTO03           MGL Supplier
     C                     MOVELYL0059    WQTO04           MGL Supplier In
      * Establish starting position
     C           KRSTO     SETLL@CCCPU7                    *
     C           KRSTO     READE@CCCPU7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1373' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.MGL ERP Process Sts is Not Processed
     C           WWG5SS    IFEQ '0'                        *IF
     C           WWLNVA    ADD  YL0055    YL0062           PAD Transaction
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR TPCHRC
     C                     END                             *FI
     C           KRSTO     READE@CCCPU7                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @CCCPUX
     C                     Z-ADDWWWJA1    WMWJA1           MGL Company
     C                     MOVELWWQXCD    WMQXCD    P      MGL Division
     C                     Z-ADDWWWOA1    WMWOA1           MGL Invoice Bat
      *
     C           KLCHTP    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHTP    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    YKRDCS
      * Move non-key fields to @CCCPUX
     C                     MOVELWWQYCD    WMQYCD    P      MGL Payee
     C                     MOVELWWQZCD    WMQZCD    P      MGL Supplier
     C                     MOVELWWQ0CD    WMQ0CD    P      MGL Supplier In
     C                     MOVELWWQ1CD    WMQ1CD    P      MGL Invoice Bat
     C                     Z-ADDWWWPA1    WMWPA1           MGL Invoice Sta
     C                     Z-ADDWWAFDX    WMAFDX           MGL Invoice Dat
     C                     MOVELWWQ5CD    WMQ5CD    P      MGL Currency
     C                     MOVELWWQ6CD    WMQ6CD    P      MGL Payment Ter
     C                     Z-ADDWWLFVA    WMLFVA           MGL Total Line
     C                     Z-ADDWWLGVA    WMLGVA           MGL Cash Discou
     C                     Z-ADDYL0062    WMLNVA           MGL Foreign Cur
     C                     Z-ADDWWLHVA    WMLHVA           MGL Total Charg
     C                     Z-ADDWWLIVA    WMLIVA           MGL Total Due
     C                     MOVELWWG3SS    WMG3SS    P      MGL Invoice Mat
     C                     Z-ADDWWWYA1    WMWYA1           MGL Service Cod
     C                     MOVELWWQ2CD    WMQ2CD    P      MGL Payment Met
     C                     MOVELWWQ3CD    WMQ3CD    P      MGL Voucher Num
     C                     Z-ADDWWWSA1    WMWSA1           MGL Voucher Num
     C                     MOVELWWAKT1    WMAKT1    P      MGL Description
     C                     Z-ADDWWWXA1    WMWXA1           MGL Exchange Ra
     C                     MOVELWWAXT1    WMAXT1    P      MGL Purchase Or
     C                     MOVELWWQ7CD    WMQ7CD    P      MGL Cash discou
     C                     MOVELWWG2SS    WMG2SS    P      MGL Get Payee D
     C                     MOVELWWANT1    WMANT1    P      MGL Job Number
     C                     MOVELWWAOT1    WMAOT1    P      MGL Job Name
     C                     Z-ADDWWAGDX    WMAGDX           MGL Entry Date
     C                     Z-ADDWWB0TM    WMB0TM           MGL Entry Time
     C                     MOVELWWART1    WMART1    P      MGL Reference N
     C                     Z-ADDWWLOVA    WMLOVA           MGL Exchange ra
     C                     MOVELWWRACD    WMRACD    P      MGL Trade code
     C                     Z-ADDWWLPVA    WMLPVA           MGL VAT
     C                     Z-ADDWWAIDX    WMAIDX           MGL Accounting
     C                     MOVELWWAZT1    WMAZT1    P      MGL Authorized
     C                     Z-ADDWWAJDX    WMAJDX           MGL Due date
     C                     MOVELWWA0T1    WMA0T1    P      MGL Future rate
     C                     MOVELWWRBCD    WMRBCD    P      MGL From/to cou
     C                     MOVELWWRCCD    WMRCCD    P      MGL Base countr
     C                     Z-ADDWWAKDX    WMAKDX           MGL Order date
     C                     Z-ADDWWALDX    WMALDX           MGL Cash discou
     C                     Z-ADDWWW1A1    WMW1A1           MGL Cash discou
     C                     Z-ADDWWLQVA    WMLQVA           MGL Cash discou
     C                     Z-ADDWWAODX    WMAODX           MGL Cash discou
     C                     Z-ADDWWLRVA    WMLRVA           MGL Cash discou
     C                     Z-ADDWWLVVA    WMLVVA           MGL Cash discou
     C                     Z-ADDWWAMDX    WMAMDX           MGL Cash discou
     C                     Z-ADDWWW2A1    WMW2A1           MGL Cash discou
     C                     Z-ADDWWLSVA    WMLSVA           MGL Cash discou
     C                     Z-ADDWWLTVA    WMLTVA           MGL Total taxab
     C                     Z-ADDWWLUVA    WMLUVA           MGL Prepaid amo
     C                     MOVELWWA1T1    WMA1T1    P      MGL VAT reg num
     C                     Z-ADDWWW3A1    WMW3A1           MGL Tax applica
     C                     MOVELWWRDCD    WMRDCD    P      MGL Document co
     C                     MOVELWWRECD    WMRECD    P      MGL AP standard
     C                     MOVELWWRFCD    WMRFCD    P      MGL Debit note
     C                     MOVELWWRGCD    WMRGCD    P      MGL Our invoici
     C                     MOVELWWA2T1    WMA2T1    P      MGL Text line 1
     C                     MOVELWWA3T1    WMA3T1    P      MGL Text line 2
     C                     MOVELWWA4T1    WMA4T1    P      MGL Text line 3
     C                     MOVELWWA5T1    WMA5T1    P      MGL EAN loc cod
     C                     MOVELWWA6T1    WMA6T1    P      MGL EAN loc cde
     C                     MOVELWWA7T1    WMA7T1    P      MGL EAN loc cod
     C                     Z-ADDWWANDX    WMANDX           MGL Delivery da
     C                     MOVELWWRHCD    WMRHCD    P      MGL Bank accoun
     C                     Z-ADDWWW4A1    WMW4A1           MGL Geographica
     C                     Z-ADDWWW5A1    WMW5A1           MGL Tax include
     C                     MOVELWWA8T1    WMA8T1    P      MGL Original in
     C                     Z-ADDWWW6A1    WMW6A1           MGL Original ye
     C                     MOVELWWA9T1    WMA9T1    P      MGL Payment req
     C                     Z-ADDWWW7A1    WMW7A1           MGL Year
     C                     Z-ADDWWW8A1    WMW8A1           MGL Partial val
     C                     MOVELWWG5SS    WMG5SS    P      MGL ERP Process
     C                     Z-ADDWWAPDX    WMAPDX           MGL ERP Process
     C                     Z-ADDWWB1TM    WMB1TM           MGL ERP Process
     C                     MOVELWWAAVN    WMAAVN    P      RS User Changed
     C                     Z-ADDWWAADT    WMAADT           RS Date Changed
     C                     Z-ADDWWAMTM    WMAMTM           RS Time Changed
     C                     MOVELWWAJST    WMAJST    P      RS Record Statu
     C                     MOVELWWAHVN    WMAHVN    P      RS Job
     C                     MOVELWWAGVN    WMAGVN    P      RS Program
     C                     MOVELWWABVN    WMABVN    P      RS User Added
     C                     Z-ADDWWABDT    WMABDT           RS Date Added
     C                     Z-ADDWWABTM    WMABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'S2D'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSTQ     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0060           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR TRCHRC
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHTR    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHTR    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YLRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'HPE'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSTS     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0061           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR TTCHRC
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHTT    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHTT    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YMRDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCRRC    BEGSR
      *================================================================
      * Crt M3 Supp Paym Head CR - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CCCPUX
     C                     Z-ADDYL0007    WMWJA1           MGL Company
     C                     MOVELYL0008    WMQXCD           MGL Division
     C                     Z-ADDYL0060    WMWOA1           MGL Invoice Bat
     C                     MOVELYL0039    WMQYCD           MGL Payee
     C                     MOVELYL0040    WMQZCD           MGL Supplier
     C                     MOVELYL0059    WMQ0CD           MGL Supplier In
     C                     MOVEL'30'      WMQ1CD           MGL Invoice Bat
     C                     Z-ADD10        WMWPA1           MGL Invoice Sta
     C                     Z-ADDYL0016    WMAFDX           MGL Invoice Dat
     C                     MOVELWN0001    WMQ5CD           MGL Currency
     C                     MOVELWN0002    WMQ6CD           MGL Payment Ter
     C                     Z-ADD*ZERO     WMLFVA           MGL Total Line
     C                     Z-ADD*ZERO     WMLGVA           MGL Cash Discou
     C                     Z-ADDYL0055    WMLNVA           MGL Foreign Cur
     C                     Z-ADD*ZERO     WMLHVA           MGL Total Charg
     C                     Z-ADD*ZERO     WMLIVA           MGL Total Due
     C                     MOVEL'0'       WMG3SS           MGL Invoice Mat
     C                     Z-ADD*ZERO     WMWYA1           MGL Service Cod
     C                     MOVELWN0003    WMQ2CD           MGL Payment Met
     C                     MOVELYL0011    WMQ3CD           MGL Voucher Num
     C                     Z-ADDYL0061    WMWSA1           MGL Voucher Num
     C                     MOVELYL0025    WMAKT1           MGL Description
     C                     Z-ADD01        WMWXA1           MGL Exchange Ra
     C                     MOVEL*BLANK    WMAXT1           MGL Purchase Or
     C                     MOVEL*BLANK    WMQ7CD           MGL Cash discou
     C                     MOVELWN0004    WMG2SS           MGL Get Payee D
     C                     MOVELYL0017    WMANT1           MGL Job Number
     C                     MOVEL##PGM     WMAOT1           MGL Job Name
     C                     Z-ADDYL0005    WMAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WMB0TM           MGL Entry Time
     C                     MOVEL*BLANK    WMART1           MGL Reference N
     C                     Z-ADD*ZERO     WMLOVA           MGL Exchange ra
     C                     MOVEL*BLANK    WMRACD           MGL Trade code
     C                     Z-ADD*ZERO     WMLPVA           MGL VAT
     C                     Z-ADDYL0016    WMAIDX           MGL Accounting
     C                     MOVELYL0010    WMAZT1           MGL Authorized
     C                     Z-ADD*ZERO     WMAJDX           MGL Due date
     C                     MOVEL*BLANK    WMA0T1           MGL Future rate
     C                     MOVEL*BLANK    WMRBCD           MGL From/to cou
     C                     MOVEL*BLANK    WMRCCD           MGL Base countr
     C                     Z-ADD*ZERO     WMAKDX           MGL Order date
     C                     Z-ADD*ZERO     WMALDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW1A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLQVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAODX           MGL Cash discou
     C                     Z-ADD*ZERO     WMLRVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLVVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAMDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW2A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLSVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLTVA           MGL Total taxab
     C                     Z-ADD*ZERO     WMLUVA           MGL Prepaid amo
     C                     MOVEL*BLANK    WMA1T1           MGL VAT reg num
     C                     Z-ADD*ZERO     WMW3A1           MGL Tax applica
     C                     MOVEL*BLANK    WMRDCD           MGL Document co
     C                     MOVE *BLANK    WMRECD           MGL AP standard
     C                     MOVEL'01'      WMRECD           MGL AP standard
     C                     MOVELYL0056    WMRFCD           MGL Debit note
     C                     MOVEL*BLANK    WMRGCD           MGL Our invoici
     C                     MOVEL*BLANK    WMA2T1           MGL Text line 1
     C                     MOVEL*BLANK    WMA3T1           MGL Text line 2
     C                     MOVEL*BLANK    WMA4T1           MGL Text line 3
     C                     MOVEL*BLANK    WMA5T1           MGL EAN loc cod
     C                     MOVEL*BLANK    WMA6T1           MGL EAN loc cde
     C                     MOVEL*BLANK    WMA7T1           MGL EAN loc cod
     C                     Z-ADD*ZERO     WMANDX           MGL Delivery da
     C                     MOVEL*BLANK    WMRHCD           MGL Bank accoun
     C                     Z-ADD*ZERO     WMW4A1           MGL Geographica
     C                     Z-ADD*ZERO     WMW5A1           MGL Tax include
     C                     MOVEL*BLANK    WMA8T1           MGL Original in
     C                     Z-ADD*ZERO     WMW6A1           MGL Original ye
     C                     MOVEL*BLANK    WMA9T1           MGL Payment req
     C                     Z-ADD*ZERO     WMW7A1           MGL Year
     C                     Z-ADD*ZERO     WMW8A1           MGL Partial val
     C                     MOVEL'0'       WMG5SS           MGL ERP Process
     C                     Z-ADD*ZERO     WMAPDX           MGL ERP Process
     C                     Z-ADD*ZERO     WMB1TM           MGL ERP Process
     C                     MOVEL*BLANK    WMAAVN           RS User Changed
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     MOVELWTAJST    WMAJST           RS Record Statu
     C                     MOVELWTAHVN    WMAHVN           RS Job
     C                     MOVELWTAGVN    WMAGVN           RS Program
     C                     MOVELWTABVN    WMABVN           RS User Added
     C                     Z-ADDWTABDT    WMABDT           RS Date Added
     C                     Z-ADDWTABTM    WMABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVEL##USR     WMABVN           RS User Added
     C                     Z-ADD##JDT     WMABDT           RS Date Added
     C                     Z-ADD##JTM     WMABTM           RS Time Added
     C                     MOVEL##PGM     WMAGVN           RS Program
     C                     MOVEL##JOB     WMAHVN           RS Job
     C           KLCRTU    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
      * Check for duplicate primary key
     C           KLCRTU    SETLL@CCCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1374' W0RTN   7
      * USER: Processing if Data record already exists
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
     C                     EXSR TVCHRC
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C                     WRITE@CCCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVCHRC    BEGSR
      *================================================================
      * Chg M3 Supp Paym Head CH - M3 Supplier Payment Head  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @CCCPUX
      *
     C           KLCHTV    KLIST
     C                     KFLD           WMWJA1           MGL Company
     C                     KFLD           WMQXCD           MGL Division
     C                     KFLD           WMWOA1           MGL Invoice Bat
     C           KLCHTV    CHAIN@CCCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCCCPL0'MDACP
     C                     MOVEL'@CCCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCC1    YNRDCS
      * Move non-key fields to @CCCPUX
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCC1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@CCCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD412       WOQ8CD           MGL AP Informat
     C                     MOVELYL0026    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRTW    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRTW    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXCRRC    BEGSR
      *================================================================
      * Crt M3 Supplier Addtl CR - M3 Supplier Payment Addl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPU4
     C                     Z-ADDYL0007    WOWJA1           MGL Company
     C                     MOVELYL0008    WOQXCD           MGL Division
     C                     Z-ADDYL0060    WOWOA1           MGL Invoice Bat
     C                     Z-ADD413       WOQ8CD           MGL AP Informat
     C                     MOVELYL0009    WOAYT1           MGL AP Addition
     C                     Z-ADD1         WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADDYL0005    WOAGDX           MGL Entry Date
     C                     Z-ADD##JTM     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
     C                     MOVEL##USR     WOQ9CD           MGL Changed By
      *
     C           KLCRTX    KLIST
     C                     KFLD           WOWJA1           MGL Company
     C                     KFLD           WOQXCD           MGL Division
     C                     KFLD           WOWOA1           MGL Invoice Bat
     C                     KFLD           WOQ8CD           MGL AP Informat
      * Check for duplicate primary key
     C           KLCRTX    SETLL@CFCPU4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1380' W0RTN   7
      * Send message 'M3 Supplier Payment Ad EX'
     C                     MOVEL'PRK1380' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPU4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Rtv Next Voucher Nbr   RT - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WCQ4CD           M3 Voucher Numb
      * Setup key
     C                     MOVEL'S2D'     WCQ4CD           M3 Voucher Numb
      * Establish starting position
     C           KRSTY     CHAIN@CEREUV              90    *
      * Data record not found
     C   90                MOVEL'PRK1377' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCWVA1    YL0060           M3 Voucher Next
      * Increment
     C           WCWVA1    ADD  1         YL0022           M3 Voucher Next
      * CASE: LCL.M3 Voucher Next Number GT DB1.M3 Voucher High Number
     C           YL0022    IFGT WCWUA1                     *IF
     C                     Z-ADDWCWTA1    YL0022           M3 Voucher Next
     C                     END                             *FI
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
     C                     EXSR TZCHRC
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCHRC    BEGSR
      *================================================================
      * Chg M3 Voucher Number  CH - M3 Voucher Number Series  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @CEREUU
     C                     MOVELWCQ4CD    WDQ4CD    P      M3 Voucher Numb
      *
     C           KLCHTZ    KLIST
     C                     KFLD           WDQ4CD           M3 Voucher Numb
     C           KLCHTZ    CHAIN@CEREUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLCEREL0'MDACP
     C                     MOVEL'@CEREUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLCE1    YORDCS
      * Move non-key fields to @CEREUU
     C                     MOVELWCAPT1    WDAPT1    P      M3 Voucher Desc
     C                     Z-ADDWCWTA1    WDWTA1           M3 Voucher Low
     C                     Z-ADDWCWUA1    WDWUA1           M3 Voucher High
     C                     Z-ADDYL0022    WDWVA1           M3 Voucher Next
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLCE1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@CEREUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLCEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHNNB           VCH Company num
     C                     Z-ADD*ZERO     WALWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     WAG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     WALXNB           VCH AP Address
     C                     Z-ADD*ZERO     WALYNB           VCH AP Voucher
     C                     Z-ADD*ZERO     WADKNB           VCH Manual Chec
     C                     Z-ADD*ZERO     WAA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     WACIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WACJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WACKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WACLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WACMPR           VCH LN Add on/D
     C                     Z-ADD*ZERO     WAAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WAAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WACHPR           VCH Less Split
     C                     Z-ADD*ZERO     WAAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WABUPC           VCH Split %
     C                     Z-ADD*ZERO     WAA4DT           VCH G/L Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHNNB           VCH Company num
     C                     Z-ADD*ZERO     WBLWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     WBG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     WBDLNB           VCD Line
     C                     Z-ADD*ZERO     WBCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     WBCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     WBCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     WBCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     WBCRPR           VCD LN Add on/D
     C                     Z-ADD*ZERO     WBAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     WBALVA           VCD Deduction A
     C                     Z-ADD*ZERO     WBCVPR           VCD Less Split
     C                     Z-ADD*ZERO     WBAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     WBAEPC           VCD Split Perce
     C                     Z-ADD*ZERO     WBL5A1           VCD Received He
     C                     Z-ADD*ZERO     WBL6A1           VCD Head Killed
     C                     Z-ADD*ZERO     WBOKA1           VCD Unused Head
     C                     Z-ADD*ZERO     WBOLA1           VCD UnUsed Head
     C                     Z-ADD*ZERO     WBOMA1           VCD UnUsed Head
     C                     Z-ADD*ZERO     WBWSA1           MGL Voucher Num
     C                     Z-ADD*ZERO     WBWOA1           MGL Invoice Bat
     C                     Z-ADD*ZERO     WBHFDT           MGL Process to
     C                     Z-ADD*ZERO     WBB2TM           MGL Process to
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCWTA1           M3 Voucher Low
     C                     Z-ADD*ZERO     WCWUA1           M3 Voucher High
     C                     Z-ADD*ZERO     WCWVA1           M3 Voucher Next
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEGMNB           TRK VND Address
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field VCH Address  # 7,0    usr
     C                     Z-ADD*ZERO     WUZBA1  70
      * Define work field Text 7 USR
     C                     MOVEL*BLANK    WUSTTX  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFALNB           PD Production C
     C                     Z-ADD*ZERO     WFAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WFAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WFGCNB           PD VND Address
     C                     Z-ADD*ZERO     WFGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJASDX           M3 ERP Process
     C                     Z-ADD*ZERO     WJB4TM           M3 ERP Process
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WLBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WLBONB           BOL Load Number
     C                     Z-ADD*ZERO     WLCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WLB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WLAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WLACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WLB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WLCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WLAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WLA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WLCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WLCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WLFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WLH9NB           TH Held Over
     C                     Z-ADD*ZERO     WLFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WLFENB           TH Head Killed
     C                     Z-ADD*ZERO     WLHENB           TH Head Adds
     C                     Z-ADD*ZERO     WLHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WLCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WLLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WLE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WLA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WLFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WLA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WLF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WLHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WLF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WLF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WLF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WLF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WLAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WLAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WLCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WLA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WLA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WLB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WLAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WLANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WLAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WLAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WLAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WLAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WLAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WLASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WLA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WLATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WLA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WLCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WLCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WLLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WLCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WLA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WLA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WLGHNB           TH Commission A
     C                     Z-ADD*ZERO     WLBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WLBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WLBTDT           TH Commission P
     C                     Z-ADD*ZERO     WLBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WLHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WLHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WLHINB           TH FFLI
     C                     Z-ADD*ZERO     WLA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WLA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WLA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WLJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WLD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WLD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WLD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WLD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WLEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WLEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WLECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WLEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WLEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WLEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WLEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WLEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WLOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WLTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WLT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WLTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WLT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WLOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WLKOER           TH Head Identif
     C                     Z-ADD*ZERO     WLOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WLOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WLIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WLOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WLHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WLS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WLTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WLTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WLJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WLKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WLKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WLKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WLKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WLOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WLIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WLIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WLIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WLKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WLOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WLKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WLORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WLOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WLMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WLMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WLNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WLNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WLIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WLKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WLEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WLEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WLECDT           TH Head LFT
     C                     Z-ADD*ZERO     WLEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WLEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMWJA1           MGL Company
     C                     Z-ADD*ZERO     WMWOA1           MGL Invoice Bat
     C                     Z-ADD*ZERO     WMWPA1           MGL Invoice Sta
     C                     Z-ADD*ZERO     WMAFDX           MGL Invoice Dat
     C                     Z-ADD*ZERO     WMLFVA           MGL Total Line
     C                     Z-ADD*ZERO     WMLGVA           MGL Cash Discou
     C                     Z-ADD*ZERO     WMLNVA           MGL Foreign Cur
     C                     Z-ADD*ZERO     WMLHVA           MGL Total Charg
     C                     Z-ADD*ZERO     WMLIVA           MGL Total Due
     C                     Z-ADD*ZERO     WMWYA1           MGL Service Cod
     C                     Z-ADD*ZERO     WMWSA1           MGL Voucher Num
     C                     Z-ADD*ZERO     WMWXA1           MGL Exchange Ra
     C                     Z-ADD*ZERO     WMAGDX           MGL Entry Date
     C                     Z-ADD*ZERO     WMB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WMLOVA           MGL Exchange ra
     C                     Z-ADD*ZERO     WMLPVA           MGL VAT
     C                     Z-ADD*ZERO     WMAIDX           MGL Accounting
     C                     Z-ADD*ZERO     WMAJDX           MGL Due date
     C                     Z-ADD*ZERO     WMAKDX           MGL Order date
     C                     Z-ADD*ZERO     WMALDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW1A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLQVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAODX           MGL Cash discou
     C                     Z-ADD*ZERO     WMLRVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLVVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMAMDX           MGL Cash discou
     C                     Z-ADD*ZERO     WMW2A1           MGL Cash discou
     C                     Z-ADD*ZERO     WMLSVA           MGL Cash discou
     C                     Z-ADD*ZERO     WMLTVA           MGL Total taxab
     C                     Z-ADD*ZERO     WMLUVA           MGL Prepaid amo
     C                     Z-ADD*ZERO     WMW3A1           MGL Tax applica
     C                     Z-ADD*ZERO     WMANDX           MGL Delivery da
     C                     Z-ADD*ZERO     WMW4A1           MGL Geographica
     C                     Z-ADD*ZERO     WMW5A1           MGL Tax include
     C                     Z-ADD*ZERO     WMW6A1           MGL Original ye
     C                     Z-ADD*ZERO     WMW7A1           MGL Year
     C                     Z-ADD*ZERO     WMW8A1           MGL Partial val
     C                     Z-ADD*ZERO     WMAPDX           MGL ERP Process
     C                     Z-ADD*ZERO     WMB1TM           MGL ERP Process
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOWJA1           MGL Company
     C                     Z-ADD*ZERO     WOWOA1           MGL Invoice Bat
     C                     Z-ADD*ZERO     WOQ8CD           MGL AP Informat
     C                     Z-ADD*ZERO     WOW0A1           MGL AP Info seq
     C                     Z-ADD*ZERO     WOWHA1           MGL Text Identi
     C                     Z-ADD*ZERO     WOWZA1           MGL Timestamp
     C                     Z-ADD*ZERO     WOAGDX           MGL Entry Date
     C                     Z-ADD*ZERO     WOB0TM           MGL Entry Time
     C                     Z-ADD*ZERO     WOAHDX           MGL Change Date
     C                     Z-ADD*ZERO     WOWIA1           MGL Change Numb
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAEPR           DED Fixed Unit
     C                     Z-ADD*ZERO     WSOTNB           DED Ranking
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WSABDT           RS Date Added
     C                     Z-ADD*ZERO     WSABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WTBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WTBONB           BOL Load Number
     C                     Z-ADD*ZERO     WTCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WTB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WTAZVA           THD Unit Amt
     C                     Z-ADD*ZERO     WTA0VA           THD Ded/Add Amo
     C                     Z-ADD*ZERO     WTAQNB           THD Re-imbursem
     C                     Z-ADD*ZERO     WTAADT           RS Date Changed
     C                     Z-ADD*ZERO     WTAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WTABDT           RS Date Added
     C                     Z-ADD*ZERO     WTABTM           RS Time Added
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Date CDE USR
     C                     MOVEL*BLANK    YL0001 10
      * Define local work field Date From Convert USR
     C                     MOVEL*BLANK    YL0002 10
      * Define local work field Date To Convert USR
     C                     MOVEL*BLANK    YL0003 11
      * Define local work field Date To Format USR
     C                     MOVEL*BLANK    YL0004  8
      * Define local work field MGL Entry Date
     C                     Z-ADD*ZERO     YL0005  80
      * Define local work field Live with M3   USR
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field MGL Company
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field MGL Division
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field M3 Facility Usr
     C                     MOVEL*BLANK    YL0009  7
      * Define local work field MGL Authorized user
     C                     MOVEL*BLANK    YL0010 10
      * Define local work field MGL Voucher Number Series
     C                     MOVEL*BLANK    YL0011  3
      * Define local work field Date CDE USR
     C                     MOVEL*BLANK    YL0012 10
      * Define local work field Date From Convert USR
     C                     MOVEL*BLANK    YL0013 10
      * Define local work field Date To Convert USR
     C                     MOVEL*BLANK    YL0014 11
      * Define local work field Date To Format USR
     C                     MOVEL*BLANK    YL0015  8
      * Define local work field MGL Invoice Date
     C                     Z-ADD*ZERO     YL0016  80
      * Define local work field MGL Job Number
     C                     MOVEL*BLANK    YL0017  6
      * Define local work field MGL Description
     C                     MOVEL*BLANK    YL0018 40
      * Define local work field MGL Reference Number
     C                     MOVEL*BLANK    YL0019 45
      * Define local work field Held Over Record Ld
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field MGL Invoice Batch Number
     C                     Z-ADD*ZERO     YL0021 100
      * Define local work field M3 Voucher Next Number
     C                     Z-ADD*ZERO     YL0022  80
      * Define local work field MGL Voucher Number
     C                     Z-ADD*ZERO     YL0023  80
      * Define local work field TRK Name
     C                     MOVEL*BLANK    YL0024 40
      * Define local work field MGL Description
     C                     MOVEL*BLANK    YL0025 40
      * Define local work field MGL AP Additional Info
     C                     MOVEL*BLANK    YL0026 45
      * Define local work field Buy Order Number Alpha
     C                     MOVEL*BLANK    YL0027  7
      * Define local work field Buy Order Load 4 USR
     C                     Z-ADD*ZERO     YL0028  40
      * Define local work field Buy Order Load Alpha 4
     C                     MOVEL*BLANK    YL0029  4
      * Define local work field Text 8 USR
     C                     MOVEL*BLANK    YL0030  8
      * Define local work field Text 12 USR
     C                     MOVEL*BLANK    YL0031 12
      * Define local work field MGL Supplier Invoice Nbr
     C                     MOVEL*BLANK    YL0032 24
      * Define local work field Tattoo Nbr 4          USR
     C                     Z-ADD*ZERO     YL0033  40
      * Define local work field Tattoo Nbr Alpha 4    USR
     C                     MOVEL*BLANK    YL0034  4
      * Define local work field Buy Order Load Alpha
     C                     MOVEL*BLANK    YL0035  5
      * Define local work field Text 13 USR
     C                     MOVEL*BLANK    YL0036 13
      * Define local work field Text 17 USR
     C                     MOVEL*BLANK    YL0037 17
      * Define local work field M3 Supplier ID
     C                     MOVEL*BLANK    YL0038 10
      * Define local work field MGL Payee
     C                     MOVEL*BLANK    YL0039 10
      * Define local work field MGL Supplier
     C                     MOVEL*BLANK    YL0040 10
      * Define local work field PD Producer Code
     C                     MOVEL*BLANK    YL0041  6
      * Define null work field PD Name
     C                     MOVEL*BLANK    YN0001 40
      * Define local work field SR Source Code
     C                     MOVEL*BLANK    YL0042  3
      * Define local work field PD Name
     C                     MOVEL*BLANK    YL0043 40
      * Define local work field SR Source Contract Type
     C                     MOVEL*BLANK    YL0044  1
      * Define local work field TH Hog Class Type
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field Name USR
     C                     MOVEL*BLANK    YL0046 40
      * Define local work field Ded D/A Code 1 USR
     C                     MOVEL*BLANK    YL0047  5
      * Define local work field DED M3 Debit Note Reason
     C                     MOVEL*BLANK    YL0048  3
      * Define local work field DED M3 Debt Nt Rsn-Contra
     C                     MOVEL*BLANK    YL0049  3
      * Define local work field MGL Debit note reason
     C                     MOVEL*BLANK    YL0050  8
      * Define local work field CHR Description
     C                     MOVEL*BLANK    YL0051 15
      * Define local work field System Value Numeric  USR
     C                     Z-ADD*ZERO     YL0052 155
      * Define local work field Percent Decimal       USR
     C                     Z-ADD*ZERO     YL0053  74
      * Define local work field TH Head Killed
     C                     Z-ADD*ZERO     YL0054  50
      * Define local work field MGL Foreign Currency Amt
     C                     Z-ADD*ZERO     YL0055 152
      * Define local work field DED M3 Debit Note Reason
     C                     MOVEL*BLANK    YL0056  3
      * Define local work field DED M3 Debt Nt Rsn-Contra
     C                     MOVEL*BLANK    YL0057  3
      * Define local work field Text 6 USR
     C                     MOVEL*BLANK    YL0058  6
      * Define local work field MGL Supplier Invoice Nbr
     C                     MOVEL*BLANK    YL0059 24
      * Define local work field MGL Invoice Batch Number
     C                     Z-ADD*ZERO     YL0060 100
      * Define local work field MGL Voucher Number
     C                     Z-ADD*ZERO     YL0061  80
      * Define local work field PAD Transaction Amount
     C                     Z-ADD*ZERO     YL0062 152
      * Define local work field MGL Debit note reason
     C                     MOVEL*BLANK    YL0063  8
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 M3COMPANY
00002 M3DIVISION
00003 M3FACILITY
00004 M3HPEAUTH
00005 Y2U0005
