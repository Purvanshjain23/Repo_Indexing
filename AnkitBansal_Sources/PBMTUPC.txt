/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  SUBMITTED PROGRAM TO UPDATE CARRIER DESTINATION RATE*/
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PROCESSES AND UPDATES CARRIER DESTINATION RATE      */
/*                ADJUSTMENT                                        */
/*  DATE      - 05/19/2014                                          */
/*  PROGRAMMER- LARA BUSER                                          */
/*                                                                  */
/*  PARAMETERS:                                                     */
/*  &RETURN     -  RETURN CODE                                      */
/*  &CARRIER    -  CARRIER CODE                                     */
/*  &WHSE       -  WAREHOUSE CODE                                   */
/*  &DESTCITY   -  DESTINATION CITY                                 */
/*  &STATE      -  STATE CODE                                       */
/*  &ADJUSTN    -  RATE ADJUSTMENT AMOUNT 15.5                      */
/*  &ADJTYPE    -  RATE ADJUSTMENT TYPE - INCR, DECR, PERCENT       */
/*  &SELECT     -  SELECT REPORT TYPE - 1, 2, OR 3                  */
/********************************************************************/
/* 66/66/6666 XXX E666666  DESCRIPTION OF CHANGES                   */
/*                                                                  */
/********************************************************************/
 PBMTUPC:    PGM        PARM(&RETURN &CARRIER &WAREHOUSE &STATE +
                          &SELECT &ADJUSTN &ADJTYPE)

             DCL        VAR(&RETURN)    TYPE(*CHAR) LEN(7)
             DCL        VAR(&CARRIER)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&WAREHOUSE) TYPE(*CHAR) LEN(3)
             DCL        VAR(&STATE)     TYPE(*CHAR) LEN(3)
             DCL        VAR(&SELECT)    TYPE(*CHAR) LEN(1)
             DCL        VAR(&ADJUSTN)   TYPE(*DEC)
             DCL        VAR(&ADJUST)    TYPE(*DEC)  LEN(5 2)
             DCL        VAR(&ADJUSTA)   TYPE(*CHAR) LEN(5)
             DCL        VAR(&ADJTYPE)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&SEL)       TYPE(*CHAR) LEN(300)
/* ERROR MESSAGE FIELDS                                             */
             DCL        VAR(&MSG)       TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGID)     TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGL)      TYPE(*DEC)  LEN(5 0)
             DCL        VAR(&SUBJECT)   TYPE(*CHAR) LEN(80)

             MONMSG     MSGID(CPF0000)

/*** FOR TESTING ONLY        +
RMVLIBLE PRKDEVQRY           +
MONMSG CPF0000               +
ADDLIBLE PRKDEVQRY *LAST     +
MONMSG CPF0000               *****/

             CHGVAR     VAR(&RETURN) VALUE('       ')
             CHGVAR     VAR(&ADJUST) VALUE(&ADJUSTN)
             CHGVAR     VAR(&ADJUSTA) VALUE(&ADJUST)

             DLTF       FILE(QTEMP/PBBICPL0)
             MONMSG     MSGID(CPF0000)
             DLTF       FILE(QTEMP/PBBICPL1)
             MONMSG     MSGID(CPF0000)
             DLTF       FILE(QTEMP/PBBICPP)

             CRTDUPOBJ  OBJ(PBBICPP) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) CST(*NO) TRG(*NO)
             CHGPF      FILE(QTEMP/PBBICPP) LVLCHK(*NO)
             CRTDUPOBJ  OBJ(PBBICPL0) FROMLIB(*LIBL)     +
                          OBJTYPE(*FILE) TOLIB(QTEMP) CST(*NO) TRG(*NO)
             CHGLF      FILE(QTEMP/PBBICPL0) LVLCHK(*NO)
             CRTDUPOBJ  OBJ(PBBICPL1) FROMLIB(*LIBL)     +
                          OBJTYPE(*FILE) TOLIB(QTEMP) CST(*NO) TRG(*NO)
             CHGLF      FILE(QTEMP/PBBICPL1) LVLCHK(*NO)
/*********   CRTDUPOBJ  OBJ(PBBICPL2) FROMLIB(OMSDEVGEN) +
                       OBJTYPE(*FILE) TOLIB(QTEMP) CST(*NO) TRG(*NO)  +
             CHGLF      FILE(QTEMP/PBBICPL2) LVLCHK(*NO)      ********/

/*-------------------------------------------------------------------*/
/* BUILD THE RECORDS IN THE WORK FILE BASED ON USER SELECTION        */
/* CRITERIA                                                          */
/*-------------------------------------------------------------------*/

             IF         COND(&SELECT *EQ '1') THEN(EXECUTE +
                          VIEW(PDLECPL1_1) OUTFILE(QTEMP/PBBICPP) +
                          SETVAR((&CARRIER &CARRIER) (&WAREHOUSE +
                          &WAREHOUSE)))

             IF         COND(&SELECT *EQ '2') THEN(EXECUTE +
                          VIEW(PDLECPL3_2) OUTFILE(QTEMP/PBBICPP) +
                          SETVAR((&CARRIER &CARRIER) (&STATE &STATE)))

             IF         COND(&SELECT *EQ '3') THEN(EXECUTE +
                          VIEW(PDLECPL4_3) OUTFILE(QTEMP/PBBICPP) +
                          SETVAR((&CARRIER &CARRIER) (&WAREHOUSE +
                          &WAREHOUSE) (&STATE &STATE)))

             IF         COND(&SELECT *EQ '4') THEN(EXECUTE +
                          VIEW(PDLECPL1_4) OUTFILE(QTEMP/PBBICPP) +
                          SETVAR((&CARRIER &CARRIER)))

/*-------------------------------------------------------------------*/
/* CALL WF PROGRAM TO UPDATE THE RECORDS THAT MATCH THE SELECTION    */
/* OPTION.                                                           */
/*-------------------------------------------------------------------*/
             CALL       PGM(PBMUXFR) PARM(&RETURN &CARRIER +
                          &WAREHOUSE &STATE &ADJUST &ADJTYPE &SELECT)

             GOTO       CMDLBL(END)

/*-------------------------USER QUIT--------------------------------*/
 QFILERROR:  CHGVAR     VAR(&RETURN) VALUE('Y2U0005')
             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/
 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM
/*------------------------------------------------------------------*/
