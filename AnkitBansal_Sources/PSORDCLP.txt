/***************************************************************** */
/*  PROGRAM NUMBER:  PSORDCLP                                      */
/*  PROGRAM NAME:    Send the Order Detail and Kncpp               */
/*                   from a sequel into a email address            */
/*                   This will be going to Curt B                  */
/*                   for the Production Schedule reports           */
/*                   *** WILL Be used for the packaging request    */
/*                                                                 */
/*  PROGRAMMER:      Susan Mason                                   */
/*  CREATE DATE:     10/29/13                                      */
/*                                                                 */
/*  FUNCTION:        this cl was developed to perform a sequel     */
/*                   on the order detail and the kncpp into        */
/*                   a spread sheet for Curt to review if he       */
/*                   needs to see this information                 */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*                                                                 */
/*******************************************************************/
             PGM       PARM(&COALPHA &WHS &FDTEA)

             DCL        VAR(&COALPHA) TYPE(*CHAR) LEN(3)
             DCL        VAR(&CONUM) TYPE(*DEC) LEN(3 0) VALUE(000)
             DCL        VAR(&CO) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHS) TYPE(*CHAR) LEN(3)
             DCL        VAR(&FDTEA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FDATE) TYPE(*CHAR) LEN(8) /* CYYMMDD*/
             DCL        VAR(&FDTEN) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&TDTEA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TDATE) TYPE(*CHAR) LEN(8) /* CYYMMDD*/
             DCL        VAR(&FDTE) TYPE(*CHAR) LEN(7) /* CYYMMDD*/
             DCL        VAR(&TDTE) TYPE(*CHAR) LEN(7) /* CYYMMDD */

             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(25) VALUE(ISSMASO)

/* NUMERIC VALUES                                                  */

             DCL        VAR(&DTE0) TYPE(*DEC) LEN(7 0) /* CYYMMDD */
             DCL        VAR(&DTE1) TYPE(*DEC) LEN(7 0) /* CYYMMDD */
             DCL        VAR(&DTE2) TYPE(*DEC) LEN(7 0) /* CYYMMDD */
             DCL        VAR(&DTE3) TYPE(*DEC) LEN(7 0) /* CYYMMDD */
             DCL        VAR(&DTE4) TYPE(*DEC) LEN(7 0) /* CYYMMDD */

             DCL        VAR(&TEXT) TYPE(*CHAR) LEN(50) VALUE('PPS +
                          ORDER DTL SEQUEL               ')

             CHGVAR     VAR(&CONUM) VALUE(&COALPHA)
             CHGVAR     VAR(&CO) VALUE(&COALPHA)
             CHGVAR     VAR(&FDTEN) VALUE(&FDTEA)

             CALL       PGM(PBJYXFR) PARM(' ' &CONUM &FDTEN &DTE0 +
                          &DTE1 &DTE2 &DTE3 &DTE4)

             CHGVAR     VAR(&FDTE) VALUE(&DTE0)
             CHGVAR     VAR(&TDTE) VALUE(&DTE4)

             DMPCLPGM


/*****************************************************************/

             CVTDAT     DATE(&FDTE) TOVAR(&FDATE) FROMFMT(*CYMD) +
                          TOFMT(*MDY) TOSEP('/')
             CVTDAT     DATE(&TDTE) TOVAR(&TDATE) FROMFMT(*CYMD) +
                          TOFMT(*MDY) TOSEP('/')

             CHGVAR     VAR(&TEXT) VALUE('PPS ORDER FDATE TO TDATE ')

             EXECUTE    VIEW(*LIBL/ORDERSHORS) PCFMT(*XLS) +
                          REPLACE(*YES) RECIPIENT(&EMAIL) +
                          EMLMSG(&TEXT) SETVAR((&CO &COALPHA) (&WHS +
                          &WHS) (&FDATE &FDATE) (&TDATE &TDATE))

             DMPCLPGM

ENDPGM
