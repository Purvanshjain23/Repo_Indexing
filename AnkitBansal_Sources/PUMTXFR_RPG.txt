     H/TITLE Exc TRG OPBGWKP ProcessXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/19/19  Time  : 13:45:53
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUBFCPL0  IF A E           K DISK
      * UPD : BI Order Detail TRG       Update index
      *
      * Long constants
     D @CN#            S              6    DIM(01)CTDATA PERRCD(1)
     D @CN             S             25    DIM(01) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPUBF1        E DS                  EXTNAME(PUBFCPL0)
      * UPD : BI Order Detail TRG       Update index
      * Renamed input format fields
     D  WAAIC3       E                     EXTFLD(BFAIC3)
     D  WAC4NB       E                     EXTFLD(BFC4NB)
     D  WADPNB       E                     EXTFLD(BFDPNB)
     D  WAUENB       E                     EXTFLD(BFUENB)
     D  WAAZTS       E                     EXTFLD(BFAZTS)
     D  WAJLSC       E                     EXTFLD(BFJLSC)
     D  WAJMSC       E                     EXTFLD(BFJMSC)
     D  WABADX       E                     EXTFLD(BFBADX)
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  XDTSDL         S             26
     D  WL0001         S              3  0
     D  WL0002         S              7  0
     D  WL0003         S              3  0
     D  WL0004         S              3  0
     D  WL0005         S              1
     D  WL0006         S              2
     D  WL0007         S              8  0
     D  WN0001         S             26
     D  ##TMS          S             26
     D  ZADFMF         S             10
     D  YL0001         S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS           525
      * RCD: Order Detail              Retrieval index
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Order Number
     D  P1C4NB                 3      6P 0
      * I :  Order Sequence Number
     D  P1DPNB                 7      8P 0
      * I :  Order Secondary Line Seq
     D  P1UENB                 9     10P 0
      * I :  Item Code
     D  P1HGCD                11     14P 0
      * I :  Warehouse Code
     D  P1AJCD                15     17
      * I :  Ship To Customer
     D  P1BKC7                18     21P 0
      * I :  Order Group Code
     D  P1CFC7                22     25P 0
      * I :  Detail Line Status
     D  P1GMST                26     26
      * I :  Detail Line Status Last
     D  P1GNST                27     27
      * I :  Billing Detail Cost Dol.
     D  P1MAVA                28     33P 2
      * I :  Billing Detail Gross Dol.
     D  P1KDVA                34     39P 2
      * I :  Billing Detail Net Dol.
     D  P1L8VA                40     45P 2
      * I :  Quantity to Substitute
     D  P1L9VA                46     51P 2
      * I :  Comment Print Acknowledge
     D  P1GTST                52     52
      * I :  Comment Print Inv/Cr.Memo
     D  P1GVST                53     53
      * I :  Comment Print Pick Slip
     D  P1GUST                54     54
      * I :  Comment Print Ship Doc
     D  P1QFST                55     55
      * I :  Extended Amount
     D  P1AYVA                56     61P 2
      * I :  Market Pricing Date
     D  P1EXDT                62     65P 0
      * I :  Commodity Market Code
     D  P1LQCD                66     68
      * I :  Date Method Code
     D  P1RDCD                69     71
      * I :  Price Method Code
     D  P1Q7CD                72     74
      * I :  Price Overage Override
     D  P1BZPR                75     80P 4
      * I :  Contract Number
     D  P1L6NB                81     84P 0
      * I :  Price Status
     D  P1U1ST                85     85
      * I :  Pricing Date Used
     D  P1GIDT                86     89P 0
      * I :  U/M - Base Price
     D  P1CRCD                90     91
      * I :  U/M - Ordered
     D  P1AGCD                92     93
      * I :  Work Confirm Status
     D  P1RZST                94     94
      * I :  Work Over/Short Status
     D  P1R0ST                95     95
      * I :  OD Production Plan Sts
     D  P1R1ST                96     96
      * I :  Order Desc. Line One
     D  P1G7NA                97    126
      * I :  Order Desc. Line Two
     D  P1G8NA               127    156
      * I :  Age Code
     D  P1RPCD               157    157
      * I :  Palletize
     D  P1VEST               158    158
      * I :  Slip Sheet
     D  P1VGST               159    159
      * I :  Catch Weight Status
     D  P1AVST               160    160
      * I :  Price Audit
     D  P1U0ST               161    161
      * I :  Price Audit Reason Code
     D  P1RFCD               162    164
      * I :  Production Date Control
     D  P1FZST               165    165
      * I :  Rated Freight
     D  P1R1NB               166    171P 2
      * I :  Quantity Ordered
     D  P1AVQT               172    177P 2
      * I :  Weight Ordered
     D  P1D0WG               178    183P 2
      * I :  Quantity Scheduled
     D  P1CCQT               184    189P 2
      * I :  Weight Scheduled
     D  P1AUWG               190    195P 2
      * I :  Quantity Shipped Total
     D  P1CBQT               196    201P 2
      * I :  Weight Shipped Total
     D  P1ATWG               202    207P 2
      * I :  Unit Cost Pricing U/M
     D  P1AQCS               208    213P 4
      * I :  Unit Cost Per Pound
     D  P1AGCS               214    219P 4
      * I :  Unit Price
     D  P1AKPR               220    225P 4
      * I :  Unit Price - Credit
     D  P1ALPR               226    231P 4
      * I :  Unit Price Ordered U/M
     D  P1AUPR               232    237P 4
      * I :  Unit Weight Ordered U/M
     D  P1AVWG               238    243P 2
      * I :  Tare Weight Total
     D  P1A4WG               244    249P 2
      * I :  Requested Ship Date
     D  P1A5DT               250    253P 0
      * I :  Scheduled Ship Date
     D  P1AODT               254    257P 0
      * I :  Actual Shipped Date
     D  P1GNDT               258    261P 0
      * I :  Affect Inventory Status
     D  P1AMST               262    262
      * I :  Affect Sales Doll Status
     D  P1ANST               263    263
      * I :  Affect Sales Pnds Status
     D  P1VAST               264    264
      * I :  Item Structure Type Code
     D  P1RGNB               265    266P 0
      * I :  Item Structure Group Code
     D  P1RHNB               267    268P 0
      * I :  Item Structure Class Code
     D  P1RINB               269    270P 0
      * I :  Item Level
     D  P1RBCD               271    272
      * I :  Quality Level
     D  P1HICD               273    274
      * I :  Pricing Product Class Rep
     D  P1RNCD               275    276
      * I :  Season Product Class Repo
     D  P1ROCD               277    278
      * I :  Date of Original Entry
     D  P1CXDT               279    282P 0
      * I :  User Profile Name
     D  P1AJVN               283    292
      * I :  Country Code
     D  P1KXCD               293    298
      * I :  Event Code
     D  P1JPCD               299    300
      * I :  Reason Code
     D  P1CQCD               301    303
      * I :  Sales Route Code
     D  P1R4CD               304    306
      * I :  Modified Flag
     D  P1Z1ST               307    307
      * I :  Substituted Flag
     D  P1Z3ST               308    308
      * I :  OD Schedule Override Sts
     D  P1Z4ST               309    309
      * I :  Invoice Unit Price
     D  P1DUPR               310    315P 4
      * I :  Invoice Extended Amt
     D  P1B6VL               316    321P 2
      * I :  Ham Group Number
     D  P1A1AA               322    323P 0
      * I :  OD Adj Type Override
     D  P1FZSX               324    324
      * I :  Affect Trade Fund
     D  P1F0SX               325    325
      * I :  Affect Commission
     D  P1F1SX               326    326
      * I :  Affect Pricing
     D  P1F2SX               327    327
      * I :  Released by User Sts Y/N
     D  P1F3SX               328    328
      * I :  Ord TF Exempt Code
     D  P1F4SX               329    330
      * I :  OD Pallet Type
     D  P1F5SX               331    332
      * I :  Production Warehouse
     D  P1F6SX               333    335
      * I :  OD Price Type
     D  P1F7SX               336    338
      * I :  Warehouse Pallets Loaded
     D  P1NTDT               339    342P 0
      * I :  Consumed Item Code
     D  P1NUDT               343    346P 0
      * I :  Deadline Depart Date LH
     D  P1NVDT               347    350P 0
      * I :  OD Price Type Ref Num
     D  P1NWDT               351    354P 0
      * I :  OD Unused Date 5
     D  P1NXDT               355    358P 0
      * I :  Deadline Depart Time LH
     D  P1BUTM               359    362P 0
      * I :  Price Code
     D  P1BVTM               363    366P 0
      * I :  Maximum Net Weight
     D  P1BWTM               367    370P 0
      * I :  Substitution Line Number
     D  P1BXTM               371    374P 0
      * I :  Max Qty to sched per day
     D  P1BYTM               375    378P 0
      * I :  Warehouse Pallet Tare
     D  P1H5NX               379    384P 2
      * I :  Warehouse Avg Pallet Tare
     D  P1H6NX               385    390P 2
      * I :  OD Item Target Price
     D  P1H7NX               391    396P 2
      * I :  OD Estimated Gross Weight
     D  P1H8NX               397    402P 2
      * I :  OD Maximum Unit Weight
     D  P1H9NX               403    408P 2
      * I :  Order Gate/Final Price
     D  P1DVPR               409    414P 4
      * I :  OD Ceiling Price
     D  P1DWPR               415    420P 4
      * I :  OD Gate/Final Price Adj
     D  P1DXPR               421    426P 4
      * I :  OD Weighted Avg Price
     D  P1DYPR               427    432P 4
      * I :  OD Unused Prc 5
     D  P1DZPR               433    438P 4
      * I :  OD Unused Prc 6
     D  P1GSPR               439    444P 4
      * I :  OD Unused Prc 7
     D  P1GTPR               445    450P 4
      * I :  OD Unused Prc 8
     D  P1GUPR               451    456P 4
      * I :  OD MPR Sent to USDA Sts
     D  P1HOST               457    457
      * I :  OD MPR Prc Ready to Send
     D  P1HPST               458    458
      * I :  OD UnUsed Price Sts 3
     D  P1IOST               459    459
      * I :  Weight Amount Entered
     D  P1PEWG               460    465P 2
      * I :  Item Age Days
     D  P1RINY               466    468P 0
      * I :  Production Ovr AgeDte Fr
     D  P1TIDT               469    472P 0
      * I :  Production Ovr AgeDte To
     D  P1TJDT               473    476P 0
      * I :  OD UnUsed Status 1 @1POS
     D  P1H2ST               477    477
      * I :  OD Clm Full Return to Plt
     D  P1H0ST               478    479
      * I :  Order Line Error Type
     D  P1H1ST               480    482
      * I :  OD Market Begin Date
     D  P1TKDT               483    486P 0
      * I :  OD Market Ending Date
     D  P1TLDT               487    490P 0
      * I :  OD Atch to Ord ActShpDte
     D  P1TMDT               491    494P 0
      * I :  EDI Status 1
     D  P1UVST               495    495
      * I :  EDI Status 2
     D  P1UWST               496    496
      * I :  EDI Status 3
     D  P1UXST               497    497
      * I :  Job Time
     D  P1AATM               498    501P 0
      * I :  User Id
     D  P1AYNA               502    511
      * I :  Job Name
     D  P1A0NA               512    521
      * I :  Job Date
     D  P1AXDT               522    525P 0
     D P2PARM          DS           525
      * RCD: Order Detail              Retrieval index
      * I :  Company Number
     D  P2AIC3                 1      2P 0
      * I :  Order Number
     D  P2C4NB                 3      6P 0
      * I :  Order Sequence Number
     D  P2DPNB                 7      8P 0
      * I :  Order Secondary Line Seq
     D  P2UENB                 9     10P 0
      * I :  Item Code
     D  P2HGCD                11     14P 0
      * I :  Warehouse Code
     D  P2AJCD                15     17
      * I :  Ship To Customer
     D  P2BKC7                18     21P 0
      * I :  Order Group Code
     D  P2CFC7                22     25P 0
      * I :  Detail Line Status
     D  P2GMST                26     26
      * I :  Detail Line Status Last
     D  P2GNST                27     27
      * I :  Billing Detail Cost Dol.
     D  P2MAVA                28     33P 2
      * I :  Billing Detail Gross Dol.
     D  P2KDVA                34     39P 2
      * I :  Billing Detail Net Dol.
     D  P2L8VA                40     45P 2
      * I :  Quantity to Substitute
     D  P2L9VA                46     51P 2
      * I :  Comment Print Acknowledge
     D  P2GTST                52     52
      * I :  Comment Print Inv/Cr.Memo
     D  P2GVST                53     53
      * I :  Comment Print Pick Slip
     D  P2GUST                54     54
      * I :  Comment Print Ship Doc
     D  P2QFST                55     55
      * I :  Extended Amount
     D  P2AYVA                56     61P 2
      * I :  Market Pricing Date
     D  P2EXDT                62     65P 0
      * I :  Commodity Market Code
     D  P2LQCD                66     68
      * I :  Date Method Code
     D  P2RDCD                69     71
      * I :  Price Method Code
     D  P2Q7CD                72     74
      * I :  Price Overage Override
     D  P2BZPR                75     80P 4
      * I :  Contract Number
     D  P2L6NB                81     84P 0
      * I :  Price Status
     D  P2U1ST                85     85
      * I :  Pricing Date Used
     D  P2GIDT                86     89P 0
      * I :  U/M - Base Price
     D  P2CRCD                90     91
      * I :  U/M - Ordered
     D  P2AGCD                92     93
      * I :  Work Confirm Status
     D  P2RZST                94     94
      * I :  Work Over/Short Status
     D  P2R0ST                95     95
      * I :  OD Production Plan Sts
     D  P2R1ST                96     96
      * I :  Order Desc. Line One
     D  P2G7NA                97    126
      * I :  Order Desc. Line Two
     D  P2G8NA               127    156
      * I :  Age Code
     D  P2RPCD               157    157
      * I :  Palletize
     D  P2VEST               158    158
      * I :  Slip Sheet
     D  P2VGST               159    159
      * I :  Catch Weight Status
     D  P2AVST               160    160
      * I :  Price Audit
     D  P2U0ST               161    161
      * I :  Price Audit Reason Code
     D  P2RFCD               162    164
      * I :  Production Date Control
     D  P2FZST               165    165
      * I :  Rated Freight
     D  P2R1NB               166    171P 2
      * I :  Quantity Ordered
     D  P2AVQT               172    177P 2
      * I :  Weight Ordered
     D  P2D0WG               178    183P 2
      * I :  Quantity Scheduled
     D  P2CCQT               184    189P 2
      * I :  Weight Scheduled
     D  P2AUWG               190    195P 2
      * I :  Quantity Shipped Total
     D  P2CBQT               196    201P 2
      * I :  Weight Shipped Total
     D  P2ATWG               202    207P 2
      * I :  Unit Cost Pricing U/M
     D  P2AQCS               208    213P 4
      * I :  Unit Cost Per Pound
     D  P2AGCS               214    219P 4
      * I :  Unit Price
     D  P2AKPR               220    225P 4
      * I :  Unit Price - Credit
     D  P2ALPR               226    231P 4
      * I :  Unit Price Ordered U/M
     D  P2AUPR               232    237P 4
      * I :  Unit Weight Ordered U/M
     D  P2AVWG               238    243P 2
      * I :  Tare Weight Total
     D  P2A4WG               244    249P 2
      * I :  Requested Ship Date
     D  P2A5DT               250    253P 0
      * I :  Scheduled Ship Date
     D  P2AODT               254    257P 0
      * I :  Actual Shipped Date
     D  P2GNDT               258    261P 0
      * I :  Affect Inventory Status
     D  P2AMST               262    262
      * I :  Affect Sales Doll Status
     D  P2ANST               263    263
      * I :  Affect Sales Pnds Status
     D  P2VAST               264    264
      * I :  Item Structure Type Code
     D  P2RGNB               265    266P 0
      * I :  Item Structure Group Code
     D  P2RHNB               267    268P 0
      * I :  Item Structure Class Code
     D  P2RINB               269    270P 0
      * I :  Item Level
     D  P2RBCD               271    272
      * I :  Quality Level
     D  P2HICD               273    274
      * I :  Pricing Product Class Rep
     D  P2RNCD               275    276
      * I :  Season Product Class Repo
     D  P2ROCD               277    278
      * I :  Date of Original Entry
     D  P2CXDT               279    282P 0
      * I :  User Profile Name
     D  P2AJVN               283    292
      * I :  Country Code
     D  P2KXCD               293    298
      * I :  Event Code
     D  P2JPCD               299    300
      * I :  Reason Code
     D  P2CQCD               301    303
      * I :  Sales Route Code
     D  P2R4CD               304    306
      * I :  Modified Flag
     D  P2Z1ST               307    307
      * I :  Substituted Flag
     D  P2Z3ST               308    308
      * I :  OD Schedule Override Sts
     D  P2Z4ST               309    309
      * I :  Invoice Unit Price
     D  P2DUPR               310    315P 4
      * I :  Invoice Extended Amt
     D  P2B6VL               316    321P 2
      * I :  Ham Group Number
     D  P2A1AA               322    323P 0
      * I :  OD Adj Type Override
     D  P2FZSX               324    324
      * I :  Affect Trade Fund
     D  P2F0SX               325    325
      * I :  Affect Commission
     D  P2F1SX               326    326
      * I :  Affect Pricing
     D  P2F2SX               327    327
      * I :  Released by User Sts Y/N
     D  P2F3SX               328    328
      * I :  Ord TF Exempt Code
     D  P2F4SX               329    330
      * I :  OD Pallet Type
     D  P2F5SX               331    332
      * I :  Production Warehouse
     D  P2F6SX               333    335
      * I :  OD Price Type
     D  P2F7SX               336    338
      * I :  Warehouse Pallets Loaded
     D  P2NTDT               339    342P 0
      * I :  Consumed Item Code
     D  P2NUDT               343    346P 0
      * I :  Deadline Depart Date LH
     D  P2NVDT               347    350P 0
      * I :  OD Price Type Ref Num
     D  P2NWDT               351    354P 0
      * I :  OD Unused Date 5
     D  P2NXDT               355    358P 0
      * I :  Deadline Depart Time LH
     D  P2BUTM               359    362P 0
      * I :  Price Code
     D  P2BVTM               363    366P 0
      * I :  Maximum Net Weight
     D  P2BWTM               367    370P 0
      * I :  Substitution Line Number
     D  P2BXTM               371    374P 0
      * I :  Max Qty to sched per day
     D  P2BYTM               375    378P 0
      * I :  Warehouse Pallet Tare
     D  P2H5NX               379    384P 2
      * I :  Warehouse Avg Pallet Tare
     D  P2H6NX               385    390P 2
      * I :  OD Item Target Price
     D  P2H7NX               391    396P 2
      * I :  OD Estimated Gross Weight
     D  P2H8NX               397    402P 2
      * I :  OD Maximum Unit Weight
     D  P2H9NX               403    408P 2
      * I :  Order Gate/Final Price
     D  P2DVPR               409    414P 4
      * I :  OD Ceiling Price
     D  P2DWPR               415    420P 4
      * I :  OD Gate/Final Price Adj
     D  P2DXPR               421    426P 4
      * I :  OD Weighted Avg Price
     D  P2DYPR               427    432P 4
      * I :  OD Unused Prc 5
     D  P2DZPR               433    438P 4
      * I :  OD Unused Prc 6
     D  P2GSPR               439    444P 4
      * I :  OD Unused Prc 7
     D  P2GTPR               445    450P 4
      * I :  OD Unused Prc 8
     D  P2GUPR               451    456P 4
      * I :  OD MPR Sent to USDA Sts
     D  P2HOST               457    457
      * I :  OD MPR Prc Ready to Send
     D  P2HPST               458    458
      * I :  OD UnUsed Price Sts 3
     D  P2IOST               459    459
      * I :  Weight Amount Entered
     D  P2PEWG               460    465P 2
      * I :  Item Age Days
     D  P2RINY               466    468P 0
      * I :  Production Ovr AgeDte Fr
     D  P2TIDT               469    472P 0
      * I :  Production Ovr AgeDte To
     D  P2TJDT               473    476P 0
      * I :  OD UnUsed Status 1 @1POS
     D  P2H2ST               477    477
      * I :  OD Clm Full Return to Plt
     D  P2H0ST               478    479
      * I :  Order Line Error Type
     D  P2H1ST               480    482
      * I :  OD Market Begin Date
     D  P2TKDT               483    486P 0
      * I :  OD Market Ending Date
     D  P2TLDT               487    490P 0
      * I :  OD Atch to Ord ActShpDte
     D  P2TMDT               491    494P 0
      * I :  EDI Status 1
     D  P2UVST               495    495
      * I :  EDI Status 2
     D  P2UWST               496    496
      * I :  EDI Status 3
     D  P2UXST               497    497
      * I :  Job Time
     D  P2AATM               498    501P 0
      * I :  User Id
     D  P2AYNA               502    511
      * I :  Job Name
     D  P2A0NA               512    521
      * I :  Job Date
     D  P2AXDT               522    525P 0
     D P3PARM          DS
      * I :  TRG Database Event
     D  P3D8SC                 1      1
     D                 DS
     D  ZAMSDA                 1    132
     I@BFCPE0
      * BI Order Detail TRG       Update index
      * Renamed input format fields
     I              BFAIC3                      WAAIC3
     I              BFC4NB                      WAC4NB
     I              BFDPNB                      WADPNB
     I              BFUENB                      WAUENB
     I              BFAZTS                      WAAZTS
     I              BFJLSC                      WAJLSC
     I              BFJMSC                      WAJMSC
     I              BFBADX                      WABADX
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         RCD: Order Deta
     C                   PARM                    P2PARM                         RCD: Order Deta
     C     P3D8SC        PARM                    WP0001                         TRG Database Ev
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc TRG OPBGWKP ProcessXF
      * *****************************************************************
      * ** PR1 Parms Represent Old Record Fields (Will be blank for Inser
      * ** PR2 Parms Represent New Record Fields (Will be blank for Delet
      * *****************************************************************
      * Trigger Processing for Insert Event.
      * CASE: PR3.TRG Database Event is Insert
      * Crt BI Order Dtl TRG  CR - BI Order Detail TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '1'
     C                   Z-ADD     P2AIC3        WL0001                         Company Number
     C                   Z-ADD     P2C4NB        WL0002                         Order Number
     C                   Z-ADD     P2DPNB        WL0003                         Order Sequence
     C                   Z-ADD     P2UENB        WL0004                         Order Secondary
     C                   MOVEL(P)  P3D8SC        WL0005                         BIOD TRG Databa
     C                   MOVEL(P)  '0'           WL0006                         BIOD Process St
     C                   Z-ADD     0             WL0007                         BIOD Process Da
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      * Trigger Processing for Update Event.
      * CASE: PR3.TRG Database Event is Update
     C                   IF        P3D8SC = '3'
     C                   MOVEL     'N'           YL0001                         Update Record U
      * Set Update Flag If Any 1st 50 Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24ORc25ORc26OR
      *  - c27ORc28ORc29ORc30ORc31ORc32ORc33ORc34OR c35ORc36ORc37ORc38OR
      *  - c39ORc40ORc41ORc42ORc43ORc44ORc45ORc46ORc47ORc48ORc49ORc50
      *   |- c1    : PR1.Item Code NE PR2.Item Code
      *   |- c2    : PR1.Warehouse Code NE PR2.Warehouse Code
      *   |- c3    : PR1.Ship To Customer NE PR2.Ship To Customer
      *   |- c4    : PR1.Order Group Code NE PR2.Order Group Code
      *   |- c5    : PR1.Detail Line Status NE PR2.Detail Line Status
      *   |- c6    : PR1.Detail Line Status Last NE PR2.Detail Line Statu
      *   |- c7    : PR1.Billing Detail Cost Dol. NE PR2.Billing Detail C
      *   |- c8    : PR1.Billing Detail Gross Dol. NE PR2.Billing Detail
      *   |- c9    : PR1.Billing Detail Net Dol. NE PR2.Billing Detail Ne
      *   |- c10   : PR1.Quantity to Substitute NE PR2.Quantity to Substi
      *   |- c11   : PR1.Comment Print Acknowledge NE PR2.Comment Print A
      *   |- c12   : PR1.Comment Print Inv/Cr.Memo NE PR2.Comment Print I
      *   |- c13   : PR1.Comment Print Pick Slip NE PR2.Comment Print Pic
      *   |- c14   : PR1.Comment Print Ship Doc NE PR2.Comment Print Ship
      *   |- c15   : PR1.Extended Amount NE PR2.Extended Amount
      *   |- c16   : PR1.Market Pricing Date NE PR2.Market Pricing Date
      *   |- c17   : PR1.Commodity Market Code NE PR2.Commodity Market Co
      *   |- c18   : PR1.Date Method Code NE PR2.Date Method Code
      *   |- c19   : PR1.Price Method Code NE PR2.Price Method Code
      *   |- c20   : PR1.Price Overage Override NE PR2.Price Overage Over
      *   |- c21   : PR1.Contract Number NE PR2.Contract Number
      *   |- c22   : PR1.Price Status NE PR2.Price Status
      *   |- c23   : PR1.Pricing Date Used NE PR2.Pricing Date Used
      *   |- c24   : PR1.U/M - Base Price NE PR2.U/M - Base Price
      *   |- c25   : PR1.U/M - Ordered NE PR2.U/M - Ordered
      *   |- c26   : PR1.Work Confirm Status NE PR2.Work Confirm Status
      *   |- c27   : PR1.Work Over/Short Status NE PR2.Work Over/Short St
      *   |- c28   : PR1.OD Production Plan Sts NE PR2.OD Production Plan
      *   |- c29   : PR1.Order Desc. Line One NE PR2.Order Desc. Line One
      *   |- c30   : PR1.Order Desc. Line Two NE PR2.Order Desc. Line Two
      *   |- c31   : PR1.Age Code NE PR2.Age Code
      *   |- c32   : PR1.Palletize NE PR2.Palletize
      *   |- c33   : PR1.Slip Sheet NE PR2.Slip Sheet
      *   |- c34   : PR1.Catch Weight Status NE PR2.Catch Weight Status
      *   |- c35   : PR1.Price Audit NE PR2.Price Audit
      *   |- c36   : PR1.Price Audit Reason Code NE PR2.Price Audit Reaso
      *   |- c37   : PR1.Production Date Control NE PR2.Production Date C
      *   |- c38   : PR1.Rated Freight NE PR2.Rated Freight
      *   |- c39   : PR1.Quantity Ordered NE PR2.Quantity Ordered
      *   |- c40   : PR1.Weight Ordered NE PR2.Weight Ordered
      *   |- c41   : PR1.Quantity Scheduled NE PR2.Quantity Scheduled
      *   |- c42   : PR1.Weight Scheduled NE PR2.Weight Scheduled
      *   |- c43   : PR1.Quantity Shipped Total NE PR2.Quantity Shipped T
      *   |- c44   : PR1.Weight Shipped Total NE PR2.Weight Shipped Total
      *   |- c45   : PR1.Unit Cost Pricing U/M NE PR2.Unit Cost Pricing U
      *   |- c46   : PR1.Unit Cost Per Pound NE PR2.Unit Cost Per Pound
      *   |- c47   : PR1.Unit Price NE PR2.Unit Price
      *   |- c48   : PR1.Unit Price - Credit NE PR2.Unit Price - Credit
      *   |- c49   : PR1.Unit Price Ordered U/M NE PR2.Unit Price Ordered
      *   |- c50   : PR1.Unit Weight Ordered U/M NE PR2.Unit Weight Order
      *   '-
     C                   IF        P1HGCD <> P2HGCD OR
     C                             P1AJCD <> P2AJCD OR
     C                             P1BKC7 <> P2BKC7 OR
     C                             P1CFC7 <> P2CFC7 OR
     C                             P1GMST <> P2GMST OR
     C                             P1GNST <> P2GNST OR
     C                             P1MAVA <> P2MAVA OR
     C                             P1KDVA <> P2KDVA OR
     C                             P1L8VA <> P2L8VA OR
     C                             P1L9VA <> P2L9VA OR
     C                             P1GTST <> P2GTST OR
     C                             P1GVST <> P2GVST OR
     C                             P1GUST <> P2GUST OR
     C                             P1QFST <> P2QFST OR
     C                             P1AYVA <> P2AYVA OR
     C                             P1EXDT <> P2EXDT OR
     C                             P1LQCD <> P2LQCD OR
     C                             P1RDCD <> P2RDCD OR
     C                             P1Q7CD <> P2Q7CD OR
     C                             P1BZPR <> P2BZPR OR
     C                             P1L6NB <> P2L6NB OR
     C                             P1U1ST <> P2U1ST OR
     C                             P1GIDT <> P2GIDT OR
     C                             P1CRCD <> P2CRCD OR
     C                             P1AGCD <> P2AGCD OR
     C                             P1RZST <> P2RZST OR
     C                             P1R0ST <> P2R0ST OR
     C                             P1R1ST <> P2R1ST OR
     C                             P1G7NA <> P2G7NA OR
     C                             P1G8NA <> P2G8NA OR
     C                             P1RPCD <> P2RPCD OR
     C                             P1VEST <> P2VEST OR
     C                             P1VGST <> P2VGST OR
     C                             P1AVST <> P2AVST OR
     C                             P1U0ST <> P2U0ST OR
     C                             P1RFCD <> P2RFCD OR
     C                             P1FZST <> P2FZST OR
     C                             P1R1NB <> P2R1NB OR
     C                             P1AVQT <> P2AVQT OR
     C                             P1D0WG <> P2D0WG OR
     C                             P1CCQT <> P2CCQT OR
     C                             P1AUWG <> P2AUWG OR
     C                             P1CBQT <> P2CBQT OR
     C                             P1ATWG <> P2ATWG OR
     C                             P1AQCS <> P2AQCS OR
     C                             P1AGCS <> P2AGCS OR
     C                             P1AKPR <> P2AKPR OR
     C                             P1ALPR <> P2ALPR OR
     C                             P1AUPR <> P2AUPR OR
     C                             P1AVWG <> P2AVWG
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   END                                                    *FI
      * Set Update Flag If Next 50 Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24ORc25ORc26OR
      *  - c27ORc28ORc29ORc30ORc31ORc32ORc33ORc34OR c35ORc36ORc37ORc38OR
      *  - c39ORc40ORc41ORc42ORc43ORc44ORc45ORc46ORc47ORc48ORc49ORc50
      *   |- c1    : PR1.Tare Weight Total NE PR2.Tare Weight Total
      *   |- c2    : PR1.Requested Ship Date NE PR2.Requested Ship Date
      *   |- c3    : PR1.Scheduled Ship Date NE PR2.Scheduled Ship Date
      *   |- c4    : PR1.Actual Shipped Date NE PR2.Actual Shipped Date
      *   |- c5    : PR1.Affect Inventory Status NE PR2.Affect Inventory
      *   |- c6    : PR1.Affect Sales Doll Status NE PR2.Affect Sales Dol
      *   |- c7    : PR1.Affect Sales Pnds Status NE PR2.Affect Sales Pnd
      *   |- c8    : PR1.Item Structure Type Code NE PR2.Item Structure T
      *   |- c9    : PR1.Item Structure Group Code NE PR2.Item Structure
      *   |- c10   : PR1.Item Structure Class Code NE PR2.Item Structure
      *   |- c11   : PR1.Item Level NE PR2.Item Level
      *   |- c12   : PR1.Quality Level NE PR2.Quality Level
      *   |- c13   : PR1.Pricing Product Class Rep NE PR2.Pricing Product
      *   |- c14   : PR1.Season Product Class Repo NE PR2.Season Product
      *   |- c15   : PR1.Date of Original Entry NE PR2.Date of Original E
      *   |- c16   : PR1.User Profile Name NE PR2.User Profile Name
      *   |- c17   : PR1.Country Code NE PR2.Country Code
      *   |- c18   : PR1.Event Code NE PR2.Event Code
      *   |- c19   : PR1.Reason Code NE PR2.Reason Code
      *   |- c20   : PR1.Sales Route Code NE PR2.Sales Route Code
      *   |- c21   : PR1.Modified Flag NE PR2.Modified Flag
      *   |- c22   : PR1.Substituted Flag NE PR2.Substituted Flag
      *   |- c23   : PR1.OD Schedule Override Sts NE PR2.OD Schedule Over
      *   |- c24   : PR1.Invoice Unit Price NE PR2.Invoice Unit Price
      *   |- c25   : PR1.Invoice Extended Amt NE PR2.Invoice Extended Amt
      *   |- c26   : PR1.Ham Group Number NE PR2.Ham Group Number
      *   |- c27   : PR1.OD Adj Type Override NE PR2.OD Adj Type Override
      *   |- c28   : PR1.Affect Trade Fund NE PR2.Affect Trade Fund
      *   |- c29   : PR1.Affect Commission NE PR2.Affect Commission
      *   |- c30   : PR1.Affect Pricing NE PR2.Affect Pricing
      *   |- c31   : PR1.Released by User Sts Y/N NE PR2.Released by User
      *   |- c32   : PR1.Ord TF Exempt Code NE PR2.Ord TF Exempt Code
      *   |- c33   : PR1.OD Pallet Type NE PR2.OD Pallet Type
      *   |- c34   : PR1.Production Warehouse NE PR2.Production Warehouse
      *   |- c35   : PR1.OD Price Type NE PR2.OD Price Type
      *   |- c36   : PR1.Warehouse Pallets Loaded NE PR2.Warehouse Pallet
      *   |- c37   : PR1.Consumed Item Code NE PR2.Consumed Item Code
      *   |- c38   : PR1.Deadline Depart Date LH NE PR2.Deadline Depart D
      *   |- c39   : PR1.OD Price Type Ref Num NE PR2.OD Price Type Ref N
      *   |- c40   : PR1.OD Unused Date 5 NE PR2.OD Unused Date 5
      *   |- c41   : PR1.Deadline Depart Time LH NE PR2.Deadline Depart T
      *   |- c42   : PR1.Price Code NE PR2.Price Code
      *   |- c43   : PR1.Maximum Net Weight NE PR2.Maximum Net Weight
      *   |- c44   : PR1.Substitution Line Number NE PR2.Substitution Lin
      *   |- c45   : PR1.Max Qty to sched per day NE PR2.Max Qty to sched
      *   |- c46   : PR1.Warehouse Pallet Tare NE PR2.Warehouse Pallet Ta
      *   |- c47   : PR1.Warehouse Avg Pallet Tare NE PR2.Warehouse Avg P
      *   |- c48   : PR1.OD Item Target Price NE PR2.OD Item Target Price
      *   |- c49   : PR1.OD Estimated Gross Weight NE PR2.OD Estimated Gr
      *   |- c50   : PR1.OD Maximum Unit Weight NE PR2.OD Maximum Unit We
      *   '-
     C                   IF        P1A4WG <> P2A4WG OR
     C                             P1A5DT <> P2A5DT OR
     C                             P1AODT <> P2AODT OR
     C                             P1GNDT <> P2GNDT OR
     C                             P1AMST <> P2AMST OR
     C                             P1ANST <> P2ANST OR
     C                             P1VAST <> P2VAST OR
     C                             P1RGNB <> P2RGNB OR
     C                             P1RHNB <> P2RHNB OR
     C                             P1RINB <> P2RINB OR
     C                             P1RBCD <> P2RBCD OR
     C                             P1HICD <> P2HICD OR
     C                             P1RNCD <> P2RNCD OR
     C                             P1ROCD <> P2ROCD OR
     C                             P1CXDT <> P2CXDT OR
     C                             P1AJVN <> P2AJVN OR
     C                             P1KXCD <> P2KXCD OR
     C                             P1JPCD <> P2JPCD OR
     C                             P1CQCD <> P2CQCD OR
     C                             P1R4CD <> P2R4CD OR
     C                             P1Z1ST <> P2Z1ST OR
     C                             P1Z3ST <> P2Z3ST OR
     C                             P1Z4ST <> P2Z4ST OR
     C                             P1DUPR <> P2DUPR OR
     C                             P1B6VL <> P2B6VL OR
     C                             P1A1AA <> P2A1AA OR
     C                             P1FZSX <> P2FZSX OR
     C                             P1F0SX <> P2F0SX OR
     C                             P1F1SX <> P2F1SX OR
     C                             P1F2SX <> P2F2SX OR
     C                             P1F3SX <> P2F3SX OR
     C                             P1F4SX <> P2F4SX OR
     C                             P1F5SX <> P2F5SX OR
     C                             P1F6SX <> P2F6SX OR
     C                             P1F7SX <> P2F7SX OR
     C                             P1NTDT <> P2NTDT OR
     C                             P1NUDT <> P2NUDT OR
     C                             P1NVDT <> P2NVDT OR
     C                             P1NWDT <> P2NWDT OR
     C                             P1NXDT <> P2NXDT OR
     C                             P1BUTM <> P2BUTM OR
     C                             P1BVTM <> P2BVTM OR
     C                             P1BWTM <> P2BWTM OR
     C                             P1BXTM <> P2BXTM OR
     C                             P1BYTM <> P2BYTM OR
     C                             P1H5NX <> P2H5NX OR
     C                             P1H6NX <> P2H6NX OR
     C                             P1H7NX <> P2H7NX OR
     C                             P1H8NX <> P2H8NX OR
     C                             P1H9NX <> P2H9NX
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   END                                                    *FI
      * Set Update Flag If Any Remaining Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24
      *   |- c1    : PR1.Order Gate/Final Price NE PR2.Order Gate/Final P
      *   |- c2    : PR1.OD Ceiling Price NE PR2.OD Ceiling Price
      *   |- c3    : PR1.OD Gate/Final Price Adj NE PR2.OD Gate/Final Pri
      *   |- c4    : PR1.OD Weighted Avg Price NE PR2.OD Weighted Avg Pri
      *   |- c5    : PR1.OD Unused Prc 5 NE PR2.OD Unused Prc 5
      *   |- c6    : PR1.OD Unused Prc 6 NE PR2.OD Unused Prc 6
      *   |- c7    : PR1.OD Unused Prc 7 NE PR2.OD Unused Prc 7
      *   |- c8    : PR1.OD Unused Prc 8 NE PR2.OD Unused Prc 8
      *   |- c9    : PR1.OD MPR Sent to USDA Sts NE PR2.OD MPR Sent to US
      *   |- c10   : PR1.OD MPR Prc Ready to Send NE PR2.OD MPR Prc Ready
      *   |- c11   : PR1.OD UnUsed Price Sts 3 NE PR2.OD UnUsed Price Sts
      *   |- c12   : PR1.Weight Amount Entered NE PR2.Weight Amount Enter
      *   |- c13   : PR1.Item Age Days NE PR2.Item Age Days
      *   |- c14   : PR1.Production Ovr AgeDte Fr NE PR2.Production Ovr A
      *   |- c15   : PR1.Production Ovr AgeDte To NE PR2.Production Ovr A
      *   |- c16   : PR1.OD UnUsed Status 1 @1POS NE PR2.OD UnUsed Status
      *   |- c17   : PR1.OD Clm Full Return to Plt NE PR2.OD Clm Full Ret
      *   |- c18   : PR1.Order Line Error Type NE PR2.Order Line Error Ty
      *   |- c19   : PR1.OD Market Begin Date NE PR2.OD Market Begin Date
      *   |- c20   : PR1.OD Market Ending Date NE PR2.OD Market Ending Da
      *   |- c21   : PR1.OD Atch to Ord ActShpDte NE PR2.OD Atch to Ord A
      *   |- c22   : PR1.EDI Status 1 NE PR2.EDI Status 1
      *   |- c23   : PR1.EDI Status 2 NE PR2.EDI Status 2
      *   |- c24   : PR1.EDI Status 3 NE PR2.EDI Status 3
      *   '-
     C                   IF        P1DVPR <> P2DVPR OR
     C                             P1DWPR <> P2DWPR OR
     C                             P1DXPR <> P2DXPR OR
     C                             P1DYPR <> P2DYPR OR
     C                             P1DZPR <> P2DZPR OR
     C                             P1GSPR <> P2GSPR OR
     C                             P1GTPR <> P2GTPR OR
     C                             P1GUPR <> P2GUPR OR
     C                             P1HOST <> P2HOST OR
     C                             P1HPST <> P2HPST OR
     C                             P1IOST <> P2IOST OR
     C                             P1PEWG <> P2PEWG OR
     C                             P1RINY <> P2RINY OR
     C                             P1TIDT <> P2TIDT OR
     C                             P1TJDT <> P2TJDT OR
     C                             P1H2ST <> P2H2ST OR
     C                             P1H0ST <> P2H0ST OR
     C                             P1H1ST <> P2H1ST OR
     C                             P1TKDT <> P2TKDT OR
     C                             P1TLDT <> P2TLDT OR
     C                             P1TMDT <> P2TMDT OR
     C                             P1UVST <> P2UVST OR
     C                             P1UWST <> P2UWST OR
     C                             P1UXST <> P2UXST
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   END                                                    *FI
      * Update Record?
      * CASE: LCL.Update Record USR is Yes
      * Crt BI Order Dtl TRG  CR - BI Order Detail TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0001 = 'Y'
     C                   Z-ADD     P2AIC3        WL0001                         Company Number
     C                   Z-ADD     P2C4NB        WL0002                         Order Number
     C                   Z-ADD     P2DPNB        WL0003                         Order Sequence
     C                   Z-ADD     P2UENB        WL0004                         Order Secondary
     C                   MOVEL(P)  P3D8SC        WL0005                         BIOD TRG Databa
     C                   MOVEL(P)  '0'           WL0006                         BIOD Process St
     C                   Z-ADD     0             WL0007                         BIOD Process Da
     C                   EXSR      SACRRC
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Trigger Processing for Delete Event.
      * CASE: PR3.TRG Database Event is Delete
      * Crt BI Order Dtl TRG  CR - BI Order Detail TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '2'
     C                   Z-ADD     P1AIC3        WL0001                         Company Number
     C                   Z-ADD     P1C4NB        WL0002                         Order Number
     C                   Z-ADD     P1DPNB        WL0003                         Order Sequence
     C                   Z-ADD     P1UENB        WL0004                         Order Secondary
     C                   MOVEL(P)  P3D8SC        WL0005                         BIOD TRG Databa
     C                   MOVEL(P)  '0'           WL0006                         BIOD Process St
     C                   Z-ADD     0             WL0007                         BIOD Process Da
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SACRRC        BEGSR
      *================================================================
      * Crt BI Order Dtl TRG  CR - BI Order Detail TRG  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0001                         BIOD Timestamp
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @BFCPE0
     C                   Z-ADD     WL0001        WAAIC3                         Company Number
     C                   Z-ADD     WL0002        WAC4NB                         Order Number
     C                   Z-ADD     WL0003        WADPNB                         Order Sequence
     C                   Z-ADD     WL0004        WAUENB                         Order Secondary
     C                   MOVEL     WL0005        WAJLSC                         BIOD TRG Databa
     C                   MOVEL     WL0006        WAJMSC                         BIOD Process St
     C                   Z-ADD     WL0007        WABADX                         BIOD Process Da
      *
      * USER: Processing before Data update
      * Set Timestamp TS#     IF
      * PAR.@Timestamp TS# = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WAAZTS                         @Timestamp TS#
     C     KLCRSA        KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAC4NB                         Order Number
     C                   KFLD                    WADPNB                         Order Sequence
     C                   KFLD                    WAUENB                         Order Secondary
     C                   KFLD                    WAAZTS                         BIOD Timestamp
      * Check for duplicate primary key
     C     KLCRSA        SETLL     @BFCPE0                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5122'     W0RTN
      * Send message 'BI Order Detail TRG    EX'
     C                   MOVEL     'USR5122'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
     C                   WRITE     @BFCPE0                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   XSTMS         BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                   CALL      'Y2RTTSK'
     C                   PARM                    ##TMS                          System timestam
      *================================================================
     CSR   XSTMSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WADPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WAUENB                         Order Secondary
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
     C                   MOVEL     XDTSDL        WAAZTS                         BIOD Timestamp
     C                   Z-ADD     *ZERO         WABADX                         BIOD Process Da
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SACRRC.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   Z-ADD     *ZERO         WL0003
     C                   Z-ADD     *ZERO         WL0004
     C                   EVAL      WL0005 = ' '
     C                   EVAL      WL0006 = ' '
     C                   Z-ADD     *ZERO         WL0007
      * Define local work field Update Record USR
     C                   EVAL      YL0001 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
