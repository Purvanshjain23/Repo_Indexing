     H/TITLE Exc Prc From F0401    XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISRCENT
     H* Date          : 11/12/20  Time  : 08:19:33
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FEZ0401L2  IF   E           K DISK
      * RSQ : Supplier Master    F0401Z Sel Unprocessed
      *
     FE10401L1  IF   E           K DISK
      * RTV : Supplier Master    F0401  Retrieval index
      *
     FE10401L0  UF A E           K DISK
      * UPD : Supplier Master    F0401  Update index
      *
     FEZ0401L0  UF   E           K DISK
      * UPD : Supplier Master    F0401Z Update index
      *
      * Long constants
     D @CN#            S              6    DIM(01)CTDATA PERRCD(1)
     D @CN             S             25    DIM(01) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QE1041        E DS                  EXTNAME(E10401L0)
      * UPD : Supplier Master    F0401  Update index
      * Renamed input format fields
     D  WCAN8        E                     EXTFLD(A6AN8)
     D  WCAPC        E                     EXTFLD(A6APC)
     D  WCMCUP       E                     EXTFLD(A6MCUP)
     D  WCOBAP       E                     EXTFLD(A6OBAP)
     D  WCAIDP       E                     EXTFLD(A6AIDP)
     D  WCKCOP       E                     EXTFLD(A6KCOP)
     D  WCDCAP       E                     EXTFLD(A6DCAP)
     D  WCDTAP       E                     EXTFLD(A6DTAP)
     D  WCCRRP       E                     EXTFLD(A6CRRP)
     D  WCTXA2       E                     EXTFLD(A6TXA2)
     D  WCEXR2       E                     EXTFLD(A6EXR2)
     D  WCHDPY       E                     EXTFLD(A6HDPY)
     D  WCTXA3       E                     EXTFLD(A6TXA3)
     D  WCEXR3       E                     EXTFLD(A6EXR3)
     D  WCTAWH       E                     EXTFLD(A6TAWH)
     D  WCPCWH       E                     EXTFLD(A6PCWH)
     D  WCTRAP       E                     EXTFLD(A6TRAP)
     D  WCSCK        E                     EXTFLD(A6SCK)
     D  WCPYIN       E                     EXTFLD(A6PYIN)
     D  WCSNTO       E                     EXTFLD(A6SNTO)
     D  WCAB1        E                     EXTFLD(A6AB1)
     D  WCFLDP       E                     EXTFLD(A6FLDP)
     D  WCSQNL       E                     EXTFLD(A6SQNL)
     D  WCCRCA       E                     EXTFLD(A6CRCA)
     D  WCAYPD       E                     EXTFLD(A6AYPD)
     D  WCAPPD       E                     EXTFLD(A6APPD)
     D  WCABAM       E                     EXTFLD(A6ABAM)
     D  WCABA1       E                     EXTFLD(A6ABA1)
     D  WCAPRC       E                     EXTFLD(A6APRC)
     D  WCMINO       E                     EXTFLD(A6MINO)
     D  WCMAXO       E                     EXTFLD(A6MAXO)
     D  WCAN8R       E                     EXTFLD(A6AN8R)
     D  WCBADT       E                     EXTFLD(A6BADT)
     D  WCCPGP       E                     EXTFLD(A6CPGP)
     D  WCORTP       E                     EXTFLD(A6ORTP)
     D  WCINMG       E                     EXTFLD(A6INMG)
     D  WCHOLD       E                     EXTFLD(A6HOLD)
     D  WCROUT       E                     EXTFLD(A6ROUT)
     D  WCSTOP       E                     EXTFLD(A6STOP)
     D  WCZON        E                     EXTFLD(A6ZON)
     D  WCANCR       E                     EXTFLD(A6ANCR)
     D  WCCARS       E                     EXTFLD(A6CARS)
     D  WCDEL1       E                     EXTFLD(A6DEL1)
     D  WCDEL2       E                     EXTFLD(A6DEL2)
     D  WCLTDT       E                     EXTFLD(A6LTDT)
     D  WCFRTH       E                     EXTFLD(A6FRTH)
     D  WCINVC       E                     EXTFLD(A6INVC)
     D  WCPLST       E                     EXTFLD(A6PLST)
     D  WCWUMD       E                     EXTFLD(A6WUMD)
     D  WCVUMD       E                     EXTFLD(A6VUMD)
     D  WCPRP5       E                     EXTFLD(A6PRP5)
     D  WCEDPM       E                     EXTFLD(A6EDPM)
     D  WCEDCI       E                     EXTFLD(A6EDCI)
     D  WCEDII       E                     EXTFLD(A6EDII)
     D  WCEDQD       E                     EXTFLD(A6EDQD)
     D  WCEDAD       E                     EXTFLD(A6EDAD)
     D  WCEDF1       E                     EXTFLD(A6EDF1)
     D  WCEDF2       E                     EXTFLD(A6EDF2)
     D  WCVI01       E                     EXTFLD(A6VI01)
     D  WCVI02       E                     EXTFLD(A6VI02)
     D  WCVI03       E                     EXTFLD(A6VI03)
     D  WCVI04       E                     EXTFLD(A6VI04)
     D  WCVI05       E                     EXTFLD(A6VI05)
     D  WCMNSC       E                     EXTFLD(A6MNSC)
     D  WCATO        E                     EXTFLD(A6ATO)
     D  WCRVNT       E                     EXTFLD(A6RVNT)
     D  WCURCD       E                     EXTFLD(A6URCD)
     D  WCURDT       E                     EXTFLD(A6URDT)
     D  WCURAT       E                     EXTFLD(A6URAT)
     D  WCURAB       E                     EXTFLD(A6URAB)
     D  WCURRF       E                     EXTFLD(A6URRF)
     D  WCUSER       E                     EXTFLD(A6USER)
     D  WCPID        E                     EXTFLD(A6PID)
     D  WCJOBN       E                     EXTFLD(A6JOBN)
     D  WCUPMJ       E                     EXTFLD(A6UPMJ)
     D  WCUPMT       E                     EXTFLD(A6UPMT)
     D  WCASN        E                     EXTFLD(A6ASN)
     D  WCCRMD       E                     EXTFLD(A6CRMD)
     D  WCAVCH       E                     EXTFLD(A6AVCH)
     D  WCATRL       E                     EXTFLD(A6ATRL)
      *
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D YARDCS          DS           433
     D QEZ041        E DS                  EXTNAME(EZ0401L0)
      * UPD : Supplier Master    F0401Z Update index
      * Renamed input format fields
     D  WDAN8        E                     EXTFLD(A9AN8)
     D  WDACTS       E                     EXTFLD(A9ACTS)
     D  WDTNAC       E                     EXTFLD(A9TNAC)
     D  WDAPC        E                     EXTFLD(A9APC)
     D  WDMCUP       E                     EXTFLD(A9MCUP)
     D  WDOBAP       E                     EXTFLD(A9OBAP)
     D  WDAIDP       E                     EXTFLD(A9AIDP)
     D  WDKCOP       E                     EXTFLD(A9KCOP)
     D  WDDCAP       E                     EXTFLD(A9DCAP)
     D  WDDTAP       E                     EXTFLD(A9DTAP)
     D  WDCRRP       E                     EXTFLD(A9CRRP)
     D  WDTXA2       E                     EXTFLD(A9TXA2)
     D  WDEXR2       E                     EXTFLD(A9EXR2)
     D  WDHDPY       E                     EXTFLD(A9HDPY)
     D  WDTXA3       E                     EXTFLD(A9TXA3)
     D  WDEXR3       E                     EXTFLD(A9EXR3)
     D  WDTAWH       E                     EXTFLD(A9TAWH)
     D  WDPCWH       E                     EXTFLD(A9PCWH)
     D  WDTRAP       E                     EXTFLD(A9TRAP)
     D  WDSCK        E                     EXTFLD(A9SCK)
     D  WDPYIN       E                     EXTFLD(A9PYIN)
     D  WDKFNB       E                     EXTFLD(A9KFNB)
     D  WDAB1        E                     EXTFLD(A9AB1)
     D  WDFLDP       E                     EXTFLD(A9FLDP)
     D  WDSQNL       E                     EXTFLD(A9SQNL)
     D  WDCRCA       E                     EXTFLD(A9CRCA)
     D  WDAYPD       E                     EXTFLD(A9AYPD)
     D  WDAPPD       E                     EXTFLD(A9APPD)
     D  WDABAM       E                     EXTFLD(A9ABAM)
     D  WDABA1       E                     EXTFLD(A9ABA1)
     D  WDAPRC       E                     EXTFLD(A9APRC)
     D  WDMINO       E                     EXTFLD(A9MINO)
     D  WDMAXO       E                     EXTFLD(A9MAXO)
     D  WDAN8R       E                     EXTFLD(A9AN8R)
     D  WDBADT       E                     EXTFLD(A9BADT)
     D  WDCPGP       E                     EXTFLD(A9CPGP)
     D  WDORTP       E                     EXTFLD(A9ORTP)
     D  WDINMG       E                     EXTFLD(A9INMG)
     D  WDHOLD       E                     EXTFLD(A9HOLD)
     D  WDROUT       E                     EXTFLD(A9ROUT)
     D  WDSTOP       E                     EXTFLD(A9STOP)
     D  WDZON        E                     EXTFLD(A9ZON)
     D  WDANCR       E                     EXTFLD(A9ANCR)
     D  WDCARS       E                     EXTFLD(A9CARS)
     D  WDDEL1       E                     EXTFLD(A9DEL1)
     D  WDDEL2       E                     EXTFLD(A9DEL2)
     D  WDLTDT       E                     EXTFLD(A9LTDT)
     D  WDFRTH       E                     EXTFLD(A9FRTH)
     D  WDINVC       E                     EXTFLD(A9INVC)
     D  WDPLST       E                     EXTFLD(A9PLST)
     D  WDWUMD       E                     EXTFLD(A9WUMD)
     D  WDVUMD       E                     EXTFLD(A9VUMD)
     D  WDPRP5       E                     EXTFLD(A9PRP5)
     D  WDEDPM       E                     EXTFLD(A9EDPM)
     D  WDEDCI       E                     EXTFLD(A9EDCI)
     D  WDEDII       E                     EXTFLD(A9EDII)
     D  WDEDQD       E                     EXTFLD(A9EDQD)
     D  WDEDAD       E                     EXTFLD(A9EDAD)
     D  WDEDF1       E                     EXTFLD(A9EDF1)
     D  WDEDF2       E                     EXTFLD(A9EDF2)
     D  WDVI01       E                     EXTFLD(A9VI01)
     D  WDVI02       E                     EXTFLD(A9VI02)
     D  WDVI03       E                     EXTFLD(A9VI03)
     D  WDVI04       E                     EXTFLD(A9VI04)
     D  WDVI05       E                     EXTFLD(A9VI05)
     D  WDMNSC       E                     EXTFLD(A9MNSC)
     D  WDATO        E                     EXTFLD(A9ATO)
     D  WDRVNT       E                     EXTFLD(A9RVNT)
     D  WDURCD       E                     EXTFLD(A9URCD)
     D  WDURDT       E                     EXTFLD(A9URDT)
     D  WDURAT       E                     EXTFLD(A9URAT)
     D  WDURAB       E                     EXTFLD(A9URAB)
     D  WDURRF       E                     EXTFLD(A9URRF)
     D  WDUSER       E                     EXTFLD(A9USER)
     D  WDPID        E                     EXTFLD(A9PID)
     D  WDJOBN       E                     EXTFLD(A9JOBN)
     D  WDUPMJ       E                     EXTFLD(A9UPMJ)
     D  WDUPMT       E                     EXTFLD(A9UPMT)
     D  WDASN        E                     EXTFLD(A9ASN)
     D  WDCRMD       E                     EXTFLD(A9CRMD)
     D  WDAVCH       E                     EXTFLD(A9AVCH)
     D  WDATRL       E                     EXTFLD(A9ATRL)
     D  WDIEST       E                     EXTFLD(A9IEST)
     D  WDADDT       E                     EXTFLD(A9ADDT)
     D  WDADTM       E                     EXTFLD(A9ADTM)
      *
     D YBRDCS          DS           470
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  XDTSDL         S             26
     D  ZADFMF         S             10
     D  YARDC          S              1
     D  YBRDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
     D                 DS
     D  ZAMSDA                 1    132
     I@0401FG
      * Supplier Master    F0401Z Sel Unprocessed
      * Renamed input format fields
     I              A9AN8                       WAAN8
     I              A9ACTS                      WAACTS
     I              A9TNAC                      WATNAC
     I              A9APC                       WAAPC
     I              A9MCUP                      WAMCUP
     I              A9OBAP                      WAOBAP
     I              A9AIDP                      WAAIDP
     I              A9KCOP                      WAKCOP
     I              A9DCAP                      WADCAP
     I              A9DTAP                      WADTAP
     I              A9CRRP                      WACRRP
     I              A9TXA2                      WATXA2
     I              A9EXR2                      WAEXR2
     I              A9HDPY                      WAHDPY
     I              A9TXA3                      WATXA3
     I              A9EXR3                      WAEXR3
     I              A9TAWH                      WATAWH
     I              A9PCWH                      WAPCWH
     I              A9TRAP                      WATRAP
     I              A9SCK                       WASCK
     I              A9PYIN                      WAPYIN
     I              A9KFNB                      WAKFNB
     I              A9AB1                       WAAB1
     I              A9FLDP                      WAFLDP
     I              A9SQNL                      WASQNL
     I              A9CRCA                      WACRCA
     I              A9AYPD                      WAAYPD
     I              A9APPD                      WAAPPD
     I              A9ABAM                      WAABAM
     I              A9ABA1                      WAABA1
     I              A9APRC                      WAAPRC
     I              A9MINO                      WAMINO
     I              A9MAXO                      WAMAXO
     I              A9AN8R                      WAAN8R
     I              A9BADT                      WABADT
     I              A9CPGP                      WACPGP
     I              A9ORTP                      WAORTP
     I              A9INMG                      WAINMG
     I              A9HOLD                      WAHOLD
     I              A9ROUT                      WAROUT
     I              A9STOP                      WASTOP
     I              A9ZON                       WAZON
     I              A9ANCR                      WAANCR
     I              A9CARS                      WACARS
     I              A9DEL1                      WADEL1
     I              A9DEL2                      WADEL2
     I              A9LTDT                      WALTDT
     I              A9FRTH                      WAFRTH
     I              A9INVC                      WAINVC
     I              A9PLST                      WAPLST
     I              A9WUMD                      WAWUMD
     I              A9VUMD                      WAVUMD
     I              A9PRP5                      WAPRP5
     I              A9EDPM                      WAEDPM
     I              A9EDCI                      WAEDCI
     I              A9EDII                      WAEDII
     I              A9EDQD                      WAEDQD
     I              A9EDAD                      WAEDAD
     I              A9EDF1                      WAEDF1
     I              A9EDF2                      WAEDF2
     I              A9VI01                      WAVI01
     I              A9VI02                      WAVI02
     I              A9VI03                      WAVI03
     I              A9VI04                      WAVI04
     I              A9VI05                      WAVI05
     I              A9MNSC                      WAMNSC
     I              A9ATO                       WAATO
     I              A9RVNT                      WARVNT
     I              A9URCD                      WAURCD
     I              A9URDT                      WAURDT
     I              A9URAT                      WAURAT
     I              A9URAB                      WAURAB
     I              A9URRF                      WAURRF
     I              A9USER                      WAUSER
     I              A9PID                       WAPID
     I              A9JOBN                      WAJOBN
     I              A9UPMJ                      WAUPMJ
     I              A9UPMT                      WAUPMT
     I              A9ASN                       WAASN
     I              A9CRMD                      WACRMD
     I              A9AVCH                      WAAVCH
     I              A9ATRL                      WAATRL
     I              A9IEST                      WAIEST
     I              A9ADDT                      WAADDT
     I              A9ADTM                      WAADTM
      *
     II0401L1
      * Supplier Master    F0401  Retrieval index
      * Renamed input format fields
     I              A6AN8                       WBAN8
     I              A6APC                       WBAPC
     I              A6MCUP                      WBMCUP
     I              A6OBAP                      WBOBAP
     I              A6AIDP                      WBAIDP
     I              A6KCOP                      WBKCOP
     I              A6DCAP                      WBDCAP
     I              A6DTAP                      WBDTAP
     I              A6CRRP                      WBCRRP
     I              A6TXA2                      WBTXA2
     I              A6EXR2                      WBEXR2
     I              A6HDPY                      WBHDPY
     I              A6TXA3                      WBTXA3
     I              A6EXR3                      WBEXR3
     I              A6TAWH                      WBTAWH
     I              A6PCWH                      WBPCWH
     I              A6TRAP                      WBTRAP
     I              A6SCK                       WBSCK
     I              A6PYIN                      WBPYIN
     I              A6SNTO                      WBSNTO
     I              A6AB1                       WBAB1
     I              A6FLDP                      WBFLDP
     I              A6SQNL                      WBSQNL
     I              A6CRCA                      WBCRCA
     I              A6AYPD                      WBAYPD
     I              A6APPD                      WBAPPD
     I              A6ABAM                      WBABAM
     I              A6ABA1                      WBABA1
     I              A6APRC                      WBAPRC
     I              A6MINO                      WBMINO
     I              A6MAXO                      WBMAXO
     I              A6AN8R                      WBAN8R
     I              A6BADT                      WBBADT
     I              A6CPGP                      WBCPGP
     I              A6ORTP                      WBORTP
     I              A6INMG                      WBINMG
     I              A6HOLD                      WBHOLD
     I              A6ROUT                      WBROUT
     I              A6STOP                      WBSTOP
     I              A6ZON                       WBZON
     I              A6ANCR                      WBANCR
     I              A6CARS                      WBCARS
     I              A6DEL1                      WBDEL1
     I              A6DEL2                      WBDEL2
     I              A6LTDT                      WBLTDT
     I              A6FRTH                      WBFRTH
     I              A6INVC                      WBINVC
     I              A6PLST                      WBPLST
     I              A6WUMD                      WBWUMD
     I              A6VUMD                      WBVUMD
     I              A6PRP5                      WBPRP5
     I              A6EDPM                      WBEDPM
     I              A6EDCI                      WBEDCI
     I              A6EDII                      WBEDII
     I              A6EDQD                      WBEDQD
     I              A6EDAD                      WBEDAD
     I              A6EDF1                      WBEDF1
     I              A6EDF2                      WBEDF2
     I              A6VI01                      WBVI01
     I              A6VI02                      WBVI02
     I              A6VI03                      WBVI03
     I              A6VI04                      WBVI04
     I              A6VI05                      WBVI05
     I              A6MNSC                      WBMNSC
     I              A6ATO                       WBATO
     I              A6RVNT                      WBRVNT
     I              A6URCD                      WBURCD
     I              A6URDT                      WBURDT
     I              A6URAT                      WBURAT
     I              A6URAB                      WBURAB
     I              A6URRF                      WBURRF
     I              A6USER                      WBUSER
     I              A6PID                       WBPID
     I              A6JOBN                      WBJOBN
     I              A6UPMJ                      WBUPMJ
     I              A6UPMT                      WBUPMT
     I              A6ASN                       WBASN
     I              A6CRMD                      WBCRMD
     I              A6AVCH                      WBAVCH
     I              A6ATRL                      WBATRL
      *
     II0401L0
      * Supplier Master    F0401  Update index
      * Renamed input format fields
     I              A6AN8                       WCAN8
     I              A6APC                       WCAPC
     I              A6MCUP                      WCMCUP
     I              A6OBAP                      WCOBAP
     I              A6AIDP                      WCAIDP
     I              A6KCOP                      WCKCOP
     I              A6DCAP                      WCDCAP
     I              A6DTAP                      WCDTAP
     I              A6CRRP                      WCCRRP
     I              A6TXA2                      WCTXA2
     I              A6EXR2                      WCEXR2
     I              A6HDPY                      WCHDPY
     I              A6TXA3                      WCTXA3
     I              A6EXR3                      WCEXR3
     I              A6TAWH                      WCTAWH
     I              A6PCWH                      WCPCWH
     I              A6TRAP                      WCTRAP
     I              A6SCK                       WCSCK
     I              A6PYIN                      WCPYIN
     I              A6SNTO                      WCSNTO
     I              A6AB1                       WCAB1
     I              A6FLDP                      WCFLDP
     I              A6SQNL                      WCSQNL
     I              A6CRCA                      WCCRCA
     I              A6AYPD                      WCAYPD
     I              A6APPD                      WCAPPD
     I              A6ABAM                      WCABAM
     I              A6ABA1                      WCABA1
     I              A6APRC                      WCAPRC
     I              A6MINO                      WCMINO
     I              A6MAXO                      WCMAXO
     I              A6AN8R                      WCAN8R
     I              A6BADT                      WCBADT
     I              A6CPGP                      WCCPGP
     I              A6ORTP                      WCORTP
     I              A6INMG                      WCINMG
     I              A6HOLD                      WCHOLD
     I              A6ROUT                      WCROUT
     I              A6STOP                      WCSTOP
     I              A6ZON                       WCZON
     I              A6ANCR                      WCANCR
     I              A6CARS                      WCCARS
     I              A6DEL1                      WCDEL1
     I              A6DEL2                      WCDEL2
     I              A6LTDT                      WCLTDT
     I              A6FRTH                      WCFRTH
     I              A6INVC                      WCINVC
     I              A6PLST                      WCPLST
     I              A6WUMD                      WCWUMD
     I              A6VUMD                      WCVUMD
     I              A6PRP5                      WCPRP5
     I              A6EDPM                      WCEDPM
     I              A6EDCI                      WCEDCI
     I              A6EDII                      WCEDII
     I              A6EDQD                      WCEDQD
     I              A6EDAD                      WCEDAD
     I              A6EDF1                      WCEDF1
     I              A6EDF2                      WCEDF2
     I              A6VI01                      WCVI01
     I              A6VI02                      WCVI02
     I              A6VI03                      WCVI03
     I              A6VI04                      WCVI04
     I              A6VI05                      WCVI05
     I              A6MNSC                      WCMNSC
     I              A6ATO                       WCATO
     I              A6RVNT                      WCRVNT
     I              A6URCD                      WCURCD
     I              A6URDT                      WCURDT
     I              A6URAT                      WCURAT
     I              A6URAB                      WCURAB
     I              A6URRF                      WCURRF
     I              A6USER                      WCUSER
     I              A6PID                       WCPID
     I              A6JOBN                      WCJOBN
     I              A6UPMJ                      WCUPMJ
     I              A6UPMT                      WCUPMT
     I              A6ASN                       WCASN
     I              A6CRMD                      WCCRMD
     I              A6AVCH                      WCAVCH
     I              A6ATRL                      WCATRL
      *
     I@A9CPEQ
      * Supplier Master    F0401Z Update index
      * Renamed input format fields
     I              A9AN8                       WDAN8
     I              A9ACTS                      WDACTS
     I              A9TNAC                      WDTNAC
     I              A9APC                       WDAPC
     I              A9MCUP                      WDMCUP
     I              A9OBAP                      WDOBAP
     I              A9AIDP                      WDAIDP
     I              A9KCOP                      WDKCOP
     I              A9DCAP                      WDDCAP
     I              A9DTAP                      WDDTAP
     I              A9CRRP                      WDCRRP
     I              A9TXA2                      WDTXA2
     I              A9EXR2                      WDEXR2
     I              A9HDPY                      WDHDPY
     I              A9TXA3                      WDTXA3
     I              A9EXR3                      WDEXR3
     I              A9TAWH                      WDTAWH
     I              A9PCWH                      WDPCWH
     I              A9TRAP                      WDTRAP
     I              A9SCK                       WDSCK
     I              A9PYIN                      WDPYIN
     I              A9KFNB                      WDKFNB
     I              A9AB1                       WDAB1
     I              A9FLDP                      WDFLDP
     I              A9SQNL                      WDSQNL
     I              A9CRCA                      WDCRCA
     I              A9AYPD                      WDAYPD
     I              A9APPD                      WDAPPD
     I              A9ABAM                      WDABAM
     I              A9ABA1                      WDABA1
     I              A9APRC                      WDAPRC
     I              A9MINO                      WDMINO
     I              A9MAXO                      WDMAXO
     I              A9AN8R                      WDAN8R
     I              A9BADT                      WDBADT
     I              A9CPGP                      WDCPGP
     I              A9ORTP                      WDORTP
     I              A9INMG                      WDINMG
     I              A9HOLD                      WDHOLD
     I              A9ROUT                      WDROUT
     I              A9STOP                      WDSTOP
     I              A9ZON                       WDZON
     I              A9ANCR                      WDANCR
     I              A9CARS                      WDCARS
     I              A9DEL1                      WDDEL1
     I              A9DEL2                      WDDEL2
     I              A9LTDT                      WDLTDT
     I              A9FRTH                      WDFRTH
     I              A9INVC                      WDINVC
     I              A9PLST                      WDPLST
     I              A9WUMD                      WDWUMD
     I              A9VUMD                      WDVUMD
     I              A9PRP5                      WDPRP5
     I              A9EDPM                      WDEDPM
     I              A9EDCI                      WDEDCI
     I              A9EDII                      WDEDII
     I              A9EDQD                      WDEDQD
     I              A9EDAD                      WDEDAD
     I              A9EDF1                      WDEDF1
     I              A9EDF2                      WDEDF2
     I              A9VI01                      WDVI01
     I              A9VI02                      WDVI02
     I              A9VI03                      WDVI03
     I              A9VI04                      WDVI04
     I              A9VI05                      WDVI05
     I              A9MNSC                      WDMNSC
     I              A9ATO                       WDATO
     I              A9RVNT                      WDRVNT
     I              A9URCD                      WDURCD
     I              A9URDT                      WDURDT
     I              A9URAT                      WDURAT
     I              A9URAB                      WDURAB
     I              A9URRF                      WDURRF
     I              A9USER                      WDUSER
     I              A9PID                       WDPID
     I              A9JOBN                      WDJOBN
     I              A9UPMJ                      WDUPMJ
     I              A9UPMT                      WDUPMT
     I              A9ASN                       WDASN
     I              A9CRMD                      WDCRMD
     I              A9AVCH                      WDAVCH
     I              A9ATRL                      WDATRL
     I              A9IEST                      WDIEST
     I              A9ADDT                      WDADDT
     I              A9ADTM                      WDADTM
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc Prc From F0401    XF
      * SDN 465 JDE to E1 RMC 4/24/2020
      *   Read staged table from E1 for the address book and update E1IDE
      *    table E10401  - process ADDS and CHANGES
      * Rtv Prc From F0401    RT - Supplier Master    F0401Z  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv Prc From F0401    RT - Supplier Master    F0401Z  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KPSSA         KLIST
     C                   KFLD                    WAAN8                          Address Number
     C                   KFLD                    WAACTS                         Date Time Stamp
      * Initialize key list
     C                   MOVEL     *LOVAL        WAAN8                          Address Number
     C                   MOVEL     XDTSDL        WAACTS                         Date Time Stamp
      * Setup key
      * Establish starting position
     C     KPSSA         SETLL     @0401FG                                      *
     C                   READ      @0401FG                                90    *
      * Data record not found
     C   90              MOVEL     'E1I0147'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Transaction Action Z is Delete
     C                   DOW       NOT *IN90
      * Rtv Dlt from Ez       RT - Supplier Master    F0401  * 
     C                   IF        WATNAC = 'D'
     C                   EXSR      SBRVGN
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv CrtChg from Stage RT - Supplier Master    F0401  * 
     C                   EXSR      SDRVGN
     C                   END                                                    *FI
      * Change Supplier Master - Supplier Master    F0401Z  * 
     C                   EXSR      SGCHRC
     C                   READ      @0401FG                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv Dlt from Ez       RT - Supplier Master    F0401  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBAN8                          Address Number
      * Setup key
     C                   Z-ADD     WAAN8         WBAN8                          Address Number
      * Establish starting position
     C     KRSSB         CHAIN     I0401L1                            90        *
      * Data record not found
     C   90              MOVEL     'E1I0117'     W0RTN
      * USER: Process Data record
      * Del Supplier Master - Supplier Master    F0401  * 
     C                   IF        NOT *IN90
     C                   EXSR      SCDLRC
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCDLRC        BEGSR
      *================================================================
      * Del Supplier Master - Supplier Master    F0401  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move key fields to I0401L0
     C                   Z-ADD     WBAN8         WCAN8                          Address Number
      *
     C     KLDLSC        KLIST
     C                   KFLD                    WCAN8                          Address Number
     C     KLDLSC        CHAIN     I0401L0                            9091      *
      * Record already deleted
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'E10401L0'    MDACP
     C                   MOVEL     'I0401L0'     MDFMT
     C                   MOVEL     '*DLT'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      *................................................................
     C                   DELETE    I0401L0                              91      *
      * Delete error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Rtv CrtChg from Stage RT - Supplier Master    F0401  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WBAN8                          Address Number
      * Setup key
     C                   Z-ADD     WAAN8         WBAN8                          Address Number
      * Establish starting position
     C     KRSSD         CHAIN     I0401L1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'E1I0117'     W0RTN
      * USER: Processing if Data record not found
      * Crt Supplier Master - Supplier Master    F0401  * 
     C                   EXSR      SECRRC
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Chg Supplier Master - Supplier Master    F0401  * 
     C                   IF        NOT *IN90
     C                   EXSR      SFCHRC
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SECRRC        BEGSR
      *================================================================
      * Crt Supplier Master - Supplier Master    F0401  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to I0401L0
     C                   Z-ADD     WAAN8         WCAN8                          Address Number
     C                   MOVEL     WAAPC         WCAPC                          G/L Offset - A/
     C                   MOVEL     WAMCUP        WCMCUP                         Business Unit -
     C                   MOVEL     WAOBAP        WCOBAP                         Object - A/P De
     C                   MOVEL     WAAIDP        WCAIDP                         Subsidiary - A/
     C                   MOVEL     WAKCOP        WCKCOP                         Document Compan
     C                   Z-ADD     WADCAP        WCDCAP                         Document - A/P
     C                   MOVEL     WADTAP        WCDTAP                         Document Type -
     C                   MOVEL     WACRRP        WCCRRP                         Currency Code -
     C                   MOVEL     WATXA2        WCTXA2                         Tax Rate/Area 2
     C                   MOVEL     WAEXR2        WCEXR2                         Tax Expl Code 2
     C                   MOVEL     WAHDPY        WCHDPY                         Hold Payment Co
     C                   MOVEL     WATXA3        WCTXA3                         Tax Rate Area 3
     C                   MOVEL     WAEXR3        WCEXR3                         Tax Expl Code 3
     C                   Z-ADD     WATAWH        WCTAWH                         Tax Auth for A/
     C                   Z-ADD     WAPCWH        WCPCWH                         Withholding Per
     C                   MOVEL     WATRAP        WCTRAP                         Payment Terms -
     C                   MOVEL     WASCK         WCSCK                          Payment Creatio
     C                   MOVEL     WAPYIN        WCPYIN                         Payment Instrum
     C                   Z-ADD     WAKFNB        WCSNTO                         Address Number
     C                   MOVEL     WAAB1         WCAB1                          Pre-Note Code
     C                   Z-ADD     WAFLDP        WCFLDP                         Float Days for
     C                   MOVEL     WASQNL        WCSQNL                         Ledger Inquiry
     C                   MOVEL     WACRCA        WCCRCA                         Currency Code -
     C                   Z-ADD     WAAYPD        WCAYPD                         Amount - Vouche
     C                   Z-ADD     WAAPPD        WCAPPD                         Amount - Vouche
     C                   Z-ADD     WAABAM        WCABAM                         Amount - Addres
     C                   Z-ADD     WAABA1        WCABA1                         Amount - Addres
     C                   Z-ADD     WAAPRC        WCAPRC                         Amount - Open O
     C                   Z-ADD     WAMINO        WCMINO                         Order Value - M
     C                   Z-ADD     WAMAXO        WCMAXO                         Order Value - M
     C                   Z-ADD     WAAN8R        WCAN8R                         Address Number
     C                   MOVEL     WABADT        WCBADT                         Billing Address
     C                   MOVEL     WACPGP        WCCPGP                         Customer Price
     C                   MOVEL     WAORTP        WCORTP                         Order Template
     C                   MOVEL     WAINMG        WCINMG                         Print Message
     C                   MOVEL     WAHOLD        WCHOLD                         Hold Orders Cod
     C                   MOVEL     WAROUT        WCROUT                         Route Code
     C                   MOVEL     WASTOP        WCSTOP                         Stop Code
     C                   MOVEL     WAZON         WCZON                          Zone Number
     C                   Z-ADD     WAANCR        WCANCR                         Carrier Number
     C                   Z-ADD     WACARS        WCCARS                         Carrier Number
     C                   MOVEL     WADEL1        WCDEL1                         Delivery Instr
     C                   MOVEL     WADEL2        WCDEL2                         Delivery Instr
     C                   Z-ADD     WALTDT        WCLTDT                         Transit Days
     C                   MOVEL     WAFRTH        WCFRTH                         Freight Handlin
     C                   Z-ADD     WAINVC        WCINVC                         Invoice Copies
     C                   MOVEL     WAPLST        WCPLST                         Price Pick List
     C                   MOVEL     WAWUMD        WCWUMD                         Unit of Measure
     C                   MOVEL     WAVUMD        WCVUMD                         Unit of Measure
     C                   MOVEL     WAPRP5        WCPRP5                         Purchasing Cate
     C                   MOVEL     WAEDPM        WCEDPM                         Batch Processin
     C                   MOVEL     WAEDCI        WCEDCI                         Customer Type I
     C                   MOVEL     WAEDII        WCEDII                         Item Type Ident
     C                   Z-ADD     WAEDQD        WCEDQD                         Quantity Decima
     C                   Z-ADD     WAEDAD        WCEDAD                         Amount Decimals
     C                   MOVEL     WAEDF1        WCEDF1                         Delivery Note
     C                   MOVEL     WAEDF2        WCEDF2                         Item Restrictio
     C                   MOVEL     WAVI01        WCVI01                         Supplier/Parent
     C                   MOVEL     WAVI02        WCVI02                         Supplier Rebate
     C                   MOVEL     WAVI03        WCVI03                         Special Instruc
     C                   MOVEL     WAVI04        WCVI04                         Special Instruc
     C                   MOVEL     WAVI05        WCVI05                         Special Instruc
     C                   MOVEL     WAMNSC        WCMNSC                         Minimum Check A
     C                   MOVEL     WAATO         WCATO                          Address Type -
     C                   MOVEL     WARVNT        WCRVNT                         Revenue Netted
     C                   MOVEL     WAURCD        WCURCD                         User Reserved C
     C                   Z-ADD     WAURDT        WCURDT                         User Reserved D
     C                   Z-ADD     WAURAT        WCURAT                         User Reserved A
     C                   Z-ADD     WAURAB        WCURAB                         User Reserved N
     C                   MOVEL     WAURRF        WCURRF                         User Reserved R
     C                   MOVEL     WAUSER        WCUSER                         User ID
     C                   MOVEL     WAPID         WCPID                          Program ID
     C                   MOVEL     WAJOBN        WCJOBN                         Work Station ID
     C                   Z-ADD     WAUPMJ        WCUPMJ                         Date - Updated
     C                   Z-ADD     WAUPMT        WCUPMT                         Time - Last Upd
     C                   MOVEL     WAASN         WCASN                          Price and Adjus
     C                   MOVEL     WACRMD        WCCRMD                         Send Method
     C                   MOVEL     WAAVCH        WCAVCH                         Code - Eval Rcp
     C                   MOVEL     WAATRL        WCATRL                         Automation Rule
      *
     C     KLCRSE        KLIST
     C                   KFLD                    WCAN8                          Address Number
      * Check for duplicate primary key
     C     KLCRSE        SETLL     I0401L0                                90    *
     C                   IF        *IN90
     C                   MOVEL     'E1I0118'     W0RTN
      * Send message 'Supplier Master    F04 EX'
     C                   MOVEL     'E1I0118'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
     C                   WRITE     I0401L0                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFCHRC        BEGSR
      *================================================================
      * Chg Supplier Master - Supplier Master    F0401  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to I0401L0
     C                   Z-ADD     WBAN8         WCAN8                          Address Number
      *
     C     KLCHSF        KLIST
     C                   KFLD                    WCAN8                          Address Number
     C     KLCHSF        CHAIN     I0401L0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'E10401L0'    MDACP
     C                   MOVEL     'I0401L0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SFEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SFEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QE1041        YARDCS
      * Move non-key fields to I0401L0
     C                   MOVEL(P)  WAAPC         WCAPC                          G/L Offset - A/
     C                   MOVEL(P)  WAMCUP        WCMCUP                         Business Unit -
     C                   MOVEL(P)  WAOBAP        WCOBAP                         Object - A/P De
     C                   MOVEL(P)  WAAIDP        WCAIDP                         Subsidiary - A/
     C                   MOVEL(P)  WAKCOP        WCKCOP                         Document Compan
     C                   Z-ADD     WADCAP        WCDCAP                         Document - A/P
     C                   MOVEL(P)  WADTAP        WCDTAP                         Document Type -
     C                   MOVEL(P)  WACRRP        WCCRRP                         Currency Code -
     C                   MOVEL(P)  WATXA2        WCTXA2                         Tax Rate/Area 2
     C                   MOVEL(P)  WAEXR2        WCEXR2                         Tax Expl Code 2
     C                   MOVEL(P)  WAHDPY        WCHDPY                         Hold Payment Co
     C                   MOVEL(P)  WATXA3        WCTXA3                         Tax Rate Area 3
     C                   MOVEL(P)  WAEXR3        WCEXR3                         Tax Expl Code 3
     C                   Z-ADD     WATAWH        WCTAWH                         Tax Auth for A/
     C                   Z-ADD     WAPCWH        WCPCWH                         Withholding Per
     C                   MOVEL(P)  WATRAP        WCTRAP                         Payment Terms -
     C                   MOVEL(P)  WASCK         WCSCK                          Payment Creatio
     C                   MOVEL(P)  WAPYIN        WCPYIN                         Payment Instrum
     C                   Z-ADD     WAKFNB        WCSNTO                         Address Number
     C                   MOVEL(P)  WAAB1         WCAB1                          Pre-Note Code
     C                   Z-ADD     WAFLDP        WCFLDP                         Float Days for
     C                   MOVEL(P)  WASQNL        WCSQNL                         Ledger Inquiry
     C                   MOVEL(P)  WACRCA        WCCRCA                         Currency Code -
     C                   Z-ADD     WAAYPD        WCAYPD                         Amount - Vouche
     C                   Z-ADD     WAAPPD        WCAPPD                         Amount - Vouche
     C                   Z-ADD     WAABAM        WCABAM                         Amount - Addres
     C                   Z-ADD     WAABA1        WCABA1                         Amount - Addres
     C                   Z-ADD     WAAPRC        WCAPRC                         Amount - Open O
     C                   Z-ADD     WAMINO        WCMINO                         Order Value - M
     C                   Z-ADD     WAMAXO        WCMAXO                         Order Value - M
     C                   Z-ADD     WAAN8R        WCAN8R                         Address Number
     C                   MOVEL(P)  WABADT        WCBADT                         Billing Address
     C                   MOVEL(P)  WACPGP        WCCPGP                         Customer Price
     C                   MOVEL(P)  WAORTP        WCORTP                         Order Template
     C                   MOVEL(P)  WAINMG        WCINMG                         Print Message
     C                   MOVEL(P)  WAHOLD        WCHOLD                         Hold Orders Cod
     C                   MOVEL(P)  WAROUT        WCROUT                         Route Code
     C                   MOVEL(P)  WASTOP        WCSTOP                         Stop Code
     C                   MOVEL(P)  WAZON         WCZON                          Zone Number
     C                   Z-ADD     WAANCR        WCANCR                         Carrier Number
     C                   Z-ADD     WACARS        WCCARS                         Carrier Number
     C                   MOVEL(P)  WADEL1        WCDEL1                         Delivery Instr
     C                   MOVEL(P)  WADEL2        WCDEL2                         Delivery Instr
     C                   Z-ADD     WALTDT        WCLTDT                         Transit Days
     C                   MOVEL(P)  WAFRTH        WCFRTH                         Freight Handlin
     C                   Z-ADD     WAINVC        WCINVC                         Invoice Copies
     C                   MOVEL(P)  WAPLST        WCPLST                         Price Pick List
     C                   MOVEL(P)  WAWUMD        WCWUMD                         Unit of Measure
     C                   MOVEL(P)  WAVUMD        WCVUMD                         Unit of Measure
     C                   MOVEL(P)  WAPRP5        WCPRP5                         Purchasing Cate
     C                   MOVEL(P)  WAEDPM        WCEDPM                         Batch Processin
     C                   MOVEL(P)  WAEDCI        WCEDCI                         Customer Type I
     C                   MOVEL(P)  WAEDII        WCEDII                         Item Type Ident
     C                   Z-ADD     WAEDQD        WCEDQD                         Quantity Decima
     C                   Z-ADD     WAEDAD        WCEDAD                         Amount Decimals
     C                   MOVEL(P)  WAEDF1        WCEDF1                         Delivery Note
     C                   MOVEL(P)  WAEDF2        WCEDF2                         Item Restrictio
     C                   MOVEL(P)  WAVI01        WCVI01                         Supplier/Parent
     C                   MOVEL(P)  WAVI02        WCVI02                         Supplier Rebate
     C                   MOVEL(P)  WAVI03        WCVI03                         Special Instruc
     C                   MOVEL(P)  WAVI04        WCVI04                         Special Instruc
     C                   MOVEL(P)  WAVI05        WCVI05                         Special Instruc
     C                   MOVEL(P)  WAMNSC        WCMNSC                         Minimum Check A
     C                   MOVEL(P)  WAATO         WCATO                          Address Type -
     C                   MOVEL(P)  WARVNT        WCRVNT                         Revenue Netted
     C                   MOVEL(P)  WAURCD        WCURCD                         User Reserved C
     C                   Z-ADD     WAURDT        WCURDT                         User Reserved D
     C                   Z-ADD     WAURAT        WCURAT                         User Reserved A
     C                   Z-ADD     WAURAB        WCURAB                         User Reserved N
     C                   MOVEL(P)  WAURRF        WCURRF                         User Reserved R
     C                   MOVEL(P)  WAUSER        WCUSER                         User ID
     C                   MOVEL(P)  WAPID         WCPID                          Program ID
     C                   MOVEL(P)  WAJOBN        WCJOBN                         Work Station ID
     C                   Z-ADD     WAUPMJ        WCUPMJ                         Date - Updated
     C                   Z-ADD     WAUPMT        WCUPMT                         Time - Last Upd
     C                   MOVEL(P)  WAASN         WCASN                          Price and Adjus
     C                   MOVEL(P)  WACRMD        WCCRMD                         Send Method
     C                   MOVEL(P)  WAAVCH        WCAVCH                         Code - Eval Rcp
     C                   MOVEL(P)  WAATRL        WCATRL                         Automation Rule
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QE1041 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    I0401L0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    E10401L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGCHRC        BEGSR
      *================================================================
      * Change Supplier Master - Supplier Master    F0401Z  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @A9CPEQ
     C                   Z-ADD     WAAN8         WDAN8                          Address Number
     C                   MOVEL(P)  WAACTS        WDACTS                         Date Time Stamp
      *
     C     KLCHSG        KLIST
     C                   KFLD                    WDAN8                          Address Number
     C                   KFLD                    WDACTS                         Date Time Stamp
     C     KLCHSG        CHAIN     @A9CPEQ                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'EZ0401L0'    MDACP
     C                   MOVEL     '@A9CPEQ'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL003.
     C                   MOVEL     'LBL003'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SGEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SGEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QEZ041        YBRDCS
      * Move non-key fields to @A9CPEQ
     C                   MOVEL(P)  WATNAC        WDTNAC                         Transaction Act
     C                   MOVEL(P)  WAAPC         WDAPC                          G/L Offset - A/
     C                   MOVEL(P)  WAMCUP        WDMCUP                         Business Unit -
     C                   MOVEL(P)  WAOBAP        WDOBAP                         Object - A/P De
     C                   MOVEL(P)  WAAIDP        WDAIDP                         Subsidiary - A/
     C                   MOVEL(P)  WAKCOP        WDKCOP                         Document Compan
     C                   Z-ADD     WADCAP        WDDCAP                         Document - A/P
     C                   MOVEL(P)  WADTAP        WDDTAP                         Document Type -
     C                   MOVEL(P)  WACRRP        WDCRRP                         Currency Code -
     C                   MOVEL(P)  WATXA2        WDTXA2                         Tax Rate/Area 2
     C                   MOVEL(P)  WAEXR2        WDEXR2                         Tax Expl Code 2
     C                   MOVEL(P)  WAHDPY        WDHDPY                         Hold Payment Co
     C                   MOVEL(P)  WATXA3        WDTXA3                         Tax Rate Area 3
     C                   MOVEL(P)  WAEXR3        WDEXR3                         Tax Expl Code 3
     C                   Z-ADD     WATAWH        WDTAWH                         Tax Auth for A/
     C                   Z-ADD     WAPCWH        WDPCWH                         Withholding Per
     C                   MOVEL(P)  WATRAP        WDTRAP                         Payment Terms -
     C                   MOVEL(P)  WASCK         WDSCK                          Payment Creatio
     C                   MOVEL(P)  WAPYIN        WDPYIN                         Payment Instrum
     C                   Z-ADD     WAKFNB        WDKFNB                         Address Number
     C                   MOVEL(P)  WAAB1         WDAB1                          Pre-Note Code
     C                   Z-ADD     WAFLDP        WDFLDP                         Float Days for
     C                   MOVEL(P)  WASQNL        WDSQNL                         Ledger Inquiry
     C                   MOVEL(P)  WACRCA        WDCRCA                         Currency Code -
     C                   Z-ADD     WAAYPD        WDAYPD                         Amount - Vouche
     C                   Z-ADD     WAAPPD        WDAPPD                         Amount - Vouche
     C                   Z-ADD     WAABAM        WDABAM                         Amount - Addres
     C                   Z-ADD     WAABA1        WDABA1                         Amount - Addres
     C                   Z-ADD     WAAPRC        WDAPRC                         Amount - Open O
     C                   Z-ADD     WAMINO        WDMINO                         Order Value - M
     C                   Z-ADD     WAMAXO        WDMAXO                         Order Value - M
     C                   Z-ADD     WAAN8R        WDAN8R                         Address Number
     C                   MOVEL(P)  WABADT        WDBADT                         Billing Address
     C                   MOVEL(P)  WACPGP        WDCPGP                         Customer Price
     C                   MOVEL(P)  WAORTP        WDORTP                         Order Template
     C                   MOVEL(P)  WAINMG        WDINMG                         Print Message
     C                   MOVEL(P)  WAHOLD        WDHOLD                         Hold Orders Cod
     C                   MOVEL(P)  WAROUT        WDROUT                         Route Code
     C                   MOVEL(P)  WASTOP        WDSTOP                         Stop Code
     C                   MOVEL(P)  WAZON         WDZON                          Zone Number
     C                   Z-ADD     WAANCR        WDANCR                         Carrier Number
     C                   Z-ADD     WACARS        WDCARS                         Carrier Number
     C                   MOVEL(P)  WADEL1        WDDEL1                         Delivery Instr
     C                   MOVEL(P)  WADEL2        WDDEL2                         Delivery Instr
     C                   Z-ADD     WALTDT        WDLTDT                         Transit Days
     C                   MOVEL(P)  WAFRTH        WDFRTH                         Freight Handlin
     C                   Z-ADD     WAINVC        WDINVC                         Invoice Copies
     C                   MOVEL(P)  WAPLST        WDPLST                         Price Pick List
     C                   MOVEL(P)  WAWUMD        WDWUMD                         Unit of Measure
     C                   MOVEL(P)  WAVUMD        WDVUMD                         Unit of Measure
     C                   MOVEL(P)  WAPRP5        WDPRP5                         Purchasing Cate
     C                   MOVEL(P)  WAEDPM        WDEDPM                         Batch Processin
     C                   MOVEL(P)  WAEDCI        WDEDCI                         Customer Type I
     C                   MOVEL(P)  WAEDII        WDEDII                         Item Type Ident
     C                   Z-ADD     WAEDQD        WDEDQD                         Quantity Decima
     C                   Z-ADD     WAEDAD        WDEDAD                         Amount Decimals
     C                   MOVEL(P)  WAEDF1        WDEDF1                         Delivery Note
     C                   MOVEL(P)  WAEDF2        WDEDF2                         Item Restrictio
     C                   MOVEL(P)  WAVI01        WDVI01                         Supplier/Parent
     C                   MOVEL(P)  WAVI02        WDVI02                         Supplier Rebate
     C                   MOVEL(P)  WAVI03        WDVI03                         Special Instruc
     C                   MOVEL(P)  WAVI04        WDVI04                         Special Instruc
     C                   MOVEL(P)  WAVI05        WDVI05                         Special Instruc
     C                   MOVEL(P)  WAMNSC        WDMNSC                         Minimum Check A
     C                   MOVEL(P)  WAATO         WDATO                          Address Type -
     C                   MOVEL(P)  WARVNT        WDRVNT                         Revenue Netted
     C                   MOVEL(P)  WAURCD        WDURCD                         User Reserved C
     C                   Z-ADD     WAURDT        WDURDT                         User Reserved D
     C                   Z-ADD     WAURAT        WDURAT                         User Reserved A
     C                   Z-ADD     WAURAB        WDURAB                         User Reserved N
     C                   MOVEL(P)  WAURRF        WDURRF                         User Reserved R
     C                   MOVEL(P)  WAUSER        WDUSER                         User ID
     C                   MOVEL(P)  WAPID         WDPID                          Program ID
     C                   MOVEL(P)  WAJOBN        WDJOBN                         Work Station ID
     C                   Z-ADD     WAUPMJ        WDUPMJ                         Date - Updated
     C                   Z-ADD     WAUPMT        WDUPMT                         Time - Last Upd
     C                   MOVEL(P)  WAASN         WDASN                          Price and Adjus
     C                   MOVEL(P)  WACRMD        WDCRMD                         Send Method
     C                   MOVEL(P)  WAAVCH        WDAVCH                         Code - Eval Rcp
     C                   MOVEL(P)  WAATRL        WDATRL                         Automation Rule
     C                   MOVEL(P)  '1'           WDIEST                         OMS ERP Process
     C                   Z-ADD     ##JDT         WDADDT                         OMS ERP Process
     C                   Z-ADD     ##JTM         WDADTM                         OMS ERP Process
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QEZ041 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @A9CPEQ                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    EZ0401L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAN8                          Address Number
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
     C                   MOVEL     XDTSDL        WAACTS                         Date Time Stamp
     C                   Z-ADD     *ZERO         WADCAP                         Document - A/P
     C                   Z-ADD     *ZERO         WATAWH                         Tax Auth for A/
     C                   Z-ADD     *ZERO         WAPCWH                         Withholding Per
     C                   Z-ADD     *ZERO         WAKFNB                         Address Number
     C                   Z-ADD     *ZERO         WAFLDP                         Float Days for
     C                   Z-ADD     *ZERO         WAAYPD                         Amount - Vouche
     C                   Z-ADD     *ZERO         WAAPPD                         Amount - Vouche
     C                   Z-ADD     *ZERO         WAABAM                         Amount - Addres
     C                   Z-ADD     *ZERO         WAABA1                         Amount - Addres
     C                   Z-ADD     *ZERO         WAAPRC                         Amount - Open O
     C                   Z-ADD     *ZERO         WAMINO                         Order Value - M
     C                   Z-ADD     *ZERO         WAMAXO                         Order Value - M
     C                   Z-ADD     *ZERO         WAAN8R                         Address Number
     C                   Z-ADD     *ZERO         WAANCR                         Carrier Number
     C                   Z-ADD     *ZERO         WACARS                         Carrier Number
     C                   Z-ADD     *ZERO         WALTDT                         Transit Days
     C                   Z-ADD     *ZERO         WAINVC                         Invoice Copies
     C                   Z-ADD     *ZERO         WAEDQD                         Quantity Decima
     C                   Z-ADD     *ZERO         WAEDAD                         Amount Decimals
     C                   Z-ADD     *ZERO         WAURDT                         User Reserved D
     C                   Z-ADD     *ZERO         WAURAT                         User Reserved A
     C                   Z-ADD     *ZERO         WAURAB                         User Reserved N
     C                   Z-ADD     *ZERO         WAUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WAUPMT                         Time - Last Upd
     C                   Z-ADD     *ZERO         WAADDT                         OMS ERP Process
     C                   Z-ADD     *ZERO         WAADTM                         OMS ERP Process
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAN8                          Address Number
     C                   Z-ADD     *ZERO         WBDCAP                         Document - A/P
     C                   Z-ADD     *ZERO         WBTAWH                         Tax Auth for A/
     C                   Z-ADD     *ZERO         WBPCWH                         Withholding Per
     C                   Z-ADD     *ZERO         WBSNTO                         Address Number
     C                   Z-ADD     *ZERO         WBFLDP                         Float Days for
     C                   Z-ADD     *ZERO         WBAYPD                         Amount - Vouche
     C                   Z-ADD     *ZERO         WBAPPD                         Amount - Vouche
     C                   Z-ADD     *ZERO         WBABAM                         Amount - Addres
     C                   Z-ADD     *ZERO         WBABA1                         Amount - Addres
     C                   Z-ADD     *ZERO         WBAPRC                         Amount - Open O
     C                   Z-ADD     *ZERO         WBMINO                         Order Value - M
     C                   Z-ADD     *ZERO         WBMAXO                         Order Value - M
     C                   Z-ADD     *ZERO         WBAN8R                         Address Number
     C                   Z-ADD     *ZERO         WBANCR                         Carrier Number
     C                   Z-ADD     *ZERO         WBCARS                         Carrier Number
     C                   Z-ADD     *ZERO         WBLTDT                         Transit Days
     C                   Z-ADD     *ZERO         WBINVC                         Invoice Copies
     C                   Z-ADD     *ZERO         WBEDQD                         Quantity Decima
     C                   Z-ADD     *ZERO         WBEDAD                         Amount Decimals
     C                   Z-ADD     *ZERO         WBURDT                         User Reserved D
     C                   Z-ADD     *ZERO         WBURAT                         User Reserved A
     C                   Z-ADD     *ZERO         WBURAB                         User Reserved N
     C                   Z-ADD     *ZERO         WBUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WBUPMT                         Time - Last Upd
      * Obtain default message file
     C     *DTAARA       DEFINE    E1MGFLA       ZADFMF
     C                   IN        ZADFMF
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
