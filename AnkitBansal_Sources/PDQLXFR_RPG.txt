     H/TITLE Prc Production Trans   XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRBEND
     H* Date          : 05/30/07  Time  : 17:00:26
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : Application Profile       Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDJVCPL2IF  E           K        DISK
      * RSQ : AS Production
      *
     FCABZRELXIF  E           K        DISK
      * RSQ : Company Item              Active FinishGood/Wp
      *
     FCABZCPLVIF  E           K        DISK
      * RSQ : Company Item              Co/PrtlCd/Itm
      *
     FCABZREMBIF  E           K        DISK
      * RSQ : Company Item              Co/WIPReject/Itm
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPDJVCPL0UF  E           K        DISK
      * UPD : AS Production             Update index
      *
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1   6  6   @CN    25
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WAAJVN
     I              DRAUNA                          WAAUNA
     I              DRB8NA                          WAB8NA
     I              DRAHVN                          WAAHVN
     I              DRI6ST                          WAI6ST
     I              DRI7ST                          WAI7ST
     I              DRXMST                          WAXMST
     I              DRXNST                          WAXNST
     I              DRI8ST                          WAI8ST
     I              DRNLNB                          WANLNB
     I              DRMPNA                          WAMPNA
     I              DRBCCD                          WABCCD
     I              DRAIC3                          WAAIC3
     I              DRDQCD                          WADQCD
     I              DRDRCD                          WADRCD
     I              DRAJCD                          WAAJCD
     I              DRBUVN                          WABUVN
     I              DRUVST                          WAUVST
     I              DRUWST                          WAUWST
     I              DRUXST                          WAUXST
     I              DRAATM                          WAAATM
     I              DRAYNA                          WAAYNA
     I              DRA0NA                          WAA0NA
     I              DRAXDT                          WAAXDT
      *
     I@DTRETE
      * Application Profile       Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WBAJVN
     I              DTDNCD                          WBDNCD
     I              DTAIC3                          WBAIC3
     I              DTDQCD                          WBDQCD
     I              DTDRCD                          WBDRCD
     I              DTAJCD                          WBAJCD
     I              DTJFST                          WBJFST
     I              DTUVST                          WBUVST
     I              DTUWST                          WBUWST
     I              DTUXST                          WBUXST
     I              DTAATM                          WBAATM
     I              DTAYNA                          WBAYNA
     I              DTA0NA                          WBA0NA
     I              DTAXDT                          WBAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WCAIC3
     I              ABADTX                          WCADTX
     I              ABACNA                          WCACNA
     I              ABADNA                          WCADNA
     I              ABAENA                          WCAENA
     I              ABAJNA                          WCAJNA
     I              ABBTTX                          WCBTTX
     I              ABBVTX                          WCBVTX
     I              ABBWTX                          WCBWTX
     I              ABA2NA                          WCA2NA
     I              ABABTX                          WCABTX
     I              ABBGCD                          WCBGCD
     I              ABKXCD                          WCKXCD
     I              ABUVST                          WCUVST
     I              ABUWST                          WCUWST
     I              ABUXST                          WCUXST
     I              ABVSST                          WCVSST
     I              ABAATM                          WCAATM
     I              ABAYNA                          WCAYNA
     I              ABA0NA                          WCA0NA
     I              ABAXDT                          WCAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WDDNCD
     I              DNAUNA                          WDAUNA
     I              DNVKST                          WDVKST
     I              DNRSCD                          WDRSCD
     I              DNUVST                          WDUVST
     I              DNUWST                          WDUWST
     I              DNUXST                          WDUXST
     I              DNAATM                          WDAATM
     I              DNAYNA                          WDAYNA
     I              DNA0NA                          WDA0NA
     I              DNAXDT                          WDAXDT
      *
     I@JVCPFD
      * AS Production
      * Renamed input format fields
     I              JVASPD                          WEASPD
     I              JVHHDT                          WEHHDT
     I              JVZAST                          WEZAST
     I              JVASQY                          WEASQY
     I              JVEMWG                          WEEMWG
     I              JVZBST                          WEZBST
     I              JVZCST                          WEZCST
     I              JVZDST                          WEZDST
     I              JVZEST                          WEZEST
     I              JVXOCD                          WEXOCD
     I              JVXXCD                          WEXXCD
     I              JVTVCD                          WETVCD
      *
     I@BZREJR
      * Company Item              Active FinishGood/Wp
      * Renamed input format fields
     I              BZAIC3                          WFAIC3
     I              BZHGCD                          WFHGCD
     I              BZAVNA                          WFAVNA
     I              BZAWNA                          WFAWNA
     I              BZL7NA                          WFL7NA
     I              BZL8NA                          WFL8NA
     I              BZL6NA                          WFL6NA
     I              BZMFNA                          WFMFNA
     I              BZADCD                          WFADCD
     I              BZAWPC                          WFAWPC
     I              BZLXST                          WFLXST
     I              BZAECD                          WFAECD
     I              BZAXPC                          WFAXPC
     I              BZLYST                          WFLYST
     I              BZAFCD                          WFAFCD
     I              BZAICD                          WFAICD
     I              BZAIWG                          WFAIWG
     I              BZHICD                          WFHICD
     I              BZRBCD                          WFRBCD
     I              BZFZST                          WFFZST
     I              BZAVST                          WFAVST
     I              BZCZWG                          WFCZWG
     I              BZC0WG                          WFC0WG
     I              BZURTN                          WFURTN
     I              BZAJC8                          WFAJC8
     I              BZRINB                          WFRINB
     I              BZRHNB                          WFRHNB
     I              BZRGNB                          WFRGNB
     I              BZLNCD                          WFLNCD
     I              BZTFNB                          WFTFNB
     I              BZN0CD                          WFN0CD
     I              BZX4ST                          WFX4ST
     I              BZTMVA                          WFTMVA
     I              BZTNVA                          WFTNVA
     I              BZBLPR                          WFBLPR
     I              BZBMPR                          WFBMPR
     I              BZLRCD                          WFLRCD
     I              BZU9ST                          WFU9ST
     I              BZCMCO                          WFCMCO
     I              BZQ1CD                          WFQ1CD
     I              BZQ8CD                          WFQ8CD
     I              BZCHTM                          WFCHTM
     I              BZQZCD                          WFQZCD
     I              BZXWST                          WFXWST
     I              BZXXST                          WFXXST
     I              BZVMST                          WFVMST
     I              BZSWGH                          WFSWGH
     I              BZPPHE                          WFPPHE
     I              BZR3CD                          WFR3CD
     I              BZSDCD                          WFSDCD
     I              BZICN1                          WFICN1
     I              BZSVCD                          WFSVCD
     I              BZICN2                          WFICN2
     I              BZSWCD                          WFSWCD
     I              BZV2NB                          WFV2NB
     I              BZSXCD                          WFSXCD
     I              BZITCN                          WFITCN
     I              BZSYCD                          WFSYCD
     I              BZITC5                          WFITC5
     I              BZSZCD                          WFSZCD
     I              BZICN6                          WFICN6
     I              BZS0CD                          WFS0CD
     I              BZICN7                          WFICN7
     I              BZS1CD                          WFS1CD
     I              BZICN8                          WFICN8
     I              BZS2CD                          WFS2CD
     I              BZICN9                          WFICN9
     I              BZS3CD                          WFS3CD
     I              BZICN0                          WFICN0
     I              BZS4CD                          WFS4CD
     I              BZSFNB                          WFSFNB
     I              BZA3WG                          WFA3WG
     I              BZSJNB                          WFSJNB
     I              BZLLCD                          WFLLCD
     I              BZLMCD                          WFLMCD
     I              BZP3ST                          WFP3ST
     I              BZSKNB                          WFSKNB
     I              BZSLNB                          WFSLNB
     I              BZSMNB                          WFSMNB
     I              BZP4ST                          WFP4ST
     I              BZCFNB                          WFCFNB
     I              BZCGNB                          WFCGNB
     I              BZILNB                          WFILNB
     I              BZCHNB                          WFCHNB
     I              BZCINB                          WFCINB
     I              BZCJNB                          WFCJNB
     I              BZCMNB                          WFCMNB
     I              BZCNNB                          WFCNNB
     I              BZCRNB                          WFCRNB
     I              BZCSNB                          WFCSNB
     I              BZCVNB                          WFCVNB
     I              BZCWNB                          WFCWNB
     I              BZCXNB                          WFCXNB
     I              BZCZNB                          WFCZNB
     I              BZC0NB                          WFC0NB
     I              BZN1CD                          WFN1CD
     I              BZB4NB                          WFB4NB
     I              BZB5NB                          WFB5NB
     I              BZX5ST                          WFX5ST
     I              BZX6ST                          WFX6ST
     I              BZX7ST                          WFX7ST
     I              BZPCCT                          WFPCCT
     I              BZBDNB                          WFBDNB
     I              BZBJNB                          WFBJNB
     I              BZSUST                          WFSUST
     I              BZSVST                          WFSVST
     I              BZSYST                          WFSYST
     I              BZSZST                          WFSZST
     I              BZS1ST                          WFS1ST
     I              BZXRCD                          WFXRCD
     I              BZXTCD                          WFXTCD
     I              BZXUCD                          WFXUCD
     I              BZF5WG                          WFF5WG
     I              BZF6WG                          WFF6WG
     I              BZF7WG                          WFF7WG
     I              BZBLNB                          WFBLNB
     I              BZBNNB                          WFBNNB
     I              BZS2ST                          WFS2ST
     I              BZS4ST                          WFS4ST
     I              BZS5ST                          WFS5ST
     I              BZS6ST                          WFS6ST
     I              BZS8ST                          WFS8ST
     I              BZS9ST                          WFS9ST
     I              BZTCST                          WFTCST
     I              BZTDST                          WFTDST
     I              BZUVST                          WFUVST
     I              BZUWST                          WFUWST
     I              BZUXST                          WFUXST
     I              BZVSST                          WFVSST
     I              BZAATM                          WFAATM
     I              BZAYNA                          WFAYNA
     I              BZA0NA                          WFA0NA
     I              BZAXDT                          WFAXDT
      *
     I@BZREP4
      * Company Item              Co/PrtlCd/Itm
      * Renamed input format fields
     I              BZAIC3                          WGAIC3
     I              BZHGCD                          WGHGCD
     I              BZAVNA                          WGAVNA
     I              BZAWNA                          WGAWNA
     I              BZL7NA                          WGL7NA
     I              BZL8NA                          WGL8NA
     I              BZL6NA                          WGL6NA
     I              BZMFNA                          WGMFNA
     I              BZADCD                          WGADCD
     I              BZAWPC                          WGAWPC
     I              BZLXST                          WGLXST
     I              BZAECD                          WGAECD
     I              BZAXPC                          WGAXPC
     I              BZLYST                          WGLYST
     I              BZAFCD                          WGAFCD
     I              BZAICD                          WGAICD
     I              BZAIWG                          WGAIWG
     I              BZHICD                          WGHICD
     I              BZRBCD                          WGRBCD
     I              BZFZST                          WGFZST
     I              BZAVST                          WGAVST
     I              BZCZWG                          WGCZWG
     I              BZC0WG                          WGC0WG
     I              BZURTN                          WGURTN
     I              BZAJC8                          WGAJC8
     I              BZRINB                          WGRINB
     I              BZRHNB                          WGRHNB
     I              BZRGNB                          WGRGNB
     I              BZLNCD                          WGLNCD
     I              BZTFNB                          WGTFNB
     I              BZN0CD                          WGN0CD
     I              BZX4ST                          WGX4ST
     I              BZTMVA                          WGTMVA
     I              BZTNVA                          WGTNVA
     I              BZBLPR                          WGBLPR
     I              BZBMPR                          WGBMPR
     I              BZLRCD                          WGLRCD
     I              BZU9ST                          WGU9ST
     I              BZCMCO                          WGCMCO
     I              BZQ1CD                          WGQ1CD
     I              BZQ8CD                          WGQ8CD
     I              BZCHTM                          WGCHTM
     I              BZQZCD                          WGQZCD
     I              BZXWST                          WGXWST
     I              BZXXST                          WGXXST
     I              BZVMST                          WGVMST
     I              BZSWGH                          WGSWGH
     I              BZPPHE                          WGPPHE
     I              BZR3CD                          WGR3CD
     I              BZSDCD                          WGSDCD
     I              BZICN1                          WGICN1
     I              BZSVCD                          WGSVCD
     I              BZICN2                          WGICN2
     I              BZSWCD                          WGSWCD
     I              BZV2NB                          WGV2NB
     I              BZSXCD                          WGSXCD
     I              BZITCN                          WGITCN
     I              BZSYCD                          WGSYCD
     I              BZITC5                          WGITC5
     I              BZSZCD                          WGSZCD
     I              BZICN6                          WGICN6
     I              BZS0CD                          WGS0CD
     I              BZICN7                          WGICN7
     I              BZS1CD                          WGS1CD
     I              BZICN8                          WGICN8
     I              BZS2CD                          WGS2CD
     I              BZICN9                          WGICN9
     I              BZS3CD                          WGS3CD
     I              BZICN0                          WGICN0
     I              BZS4CD                          WGS4CD
     I              BZSFNB                          WGSFNB
     I              BZA3WG                          WGA3WG
     I              BZSJNB                          WGSJNB
     I              BZLLCD                          WGLLCD
     I              BZLMCD                          WGLMCD
     I              BZP3ST                          WGP3ST
     I              BZSKNB                          WGSKNB
     I              BZSLNB                          WGSLNB
     I              BZSMNB                          WGSMNB
     I              BZP4ST                          WGP4ST
     I              BZCFNB                          WGCFNB
     I              BZCGNB                          WGCGNB
     I              BZILNB                          WGILNB
     I              BZCHNB                          WGCHNB
     I              BZCINB                          WGCINB
     I              BZCJNB                          WGCJNB
     I              BZCMNB                          WGCMNB
     I              BZCNNB                          WGCNNB
     I              BZCRNB                          WGCRNB
     I              BZCSNB                          WGCSNB
     I              BZCVNB                          WGCVNB
     I              BZCWNB                          WGCWNB
     I              BZCXNB                          WGCXNB
     I              BZCZNB                          WGCZNB
     I              BZC0NB                          WGC0NB
     I              BZN1CD                          WGN1CD
     I              BZB4NB                          WGB4NB
     I              BZB5NB                          WGB5NB
     I              BZX5ST                          WGX5ST
     I              BZX6ST                          WGX6ST
     I              BZX7ST                          WGX7ST
     I              BZPCCT                          WGPCCT
     I              BZBDNB                          WGBDNB
     I              BZBJNB                          WGBJNB
     I              BZSUST                          WGSUST
     I              BZSVST                          WGSVST
     I              BZSYST                          WGSYST
     I              BZSZST                          WGSZST
     I              BZS1ST                          WGS1ST
     I              BZXRCD                          WGXRCD
     I              BZXTCD                          WGXTCD
     I              BZXUCD                          WGXUCD
     I              BZF5WG                          WGF5WG
     I              BZF6WG                          WGF6WG
     I              BZF7WG                          WGF7WG
     I              BZBLNB                          WGBLNB
     I              BZBNNB                          WGBNNB
     I              BZS2ST                          WGS2ST
     I              BZS4ST                          WGS4ST
     I              BZS5ST                          WGS5ST
     I              BZS6ST                          WGS6ST
     I              BZS8ST                          WGS8ST
     I              BZS9ST                          WGS9ST
     I              BZTCST                          WGTCST
     I              BZTDST                          WGTDST
     I              BZUVST                          WGUVST
     I              BZUWST                          WGUWST
     I              BZUXST                          WGUXST
     I              BZVSST                          WGVSST
     I              BZAATM                          WGAATM
     I              BZAYNA                          WGAYNA
     I              BZA0NA                          WGA0NA
     I              BZAXDT                          WGAXDT
      *
     I@BZRESI
      * Company Item              Co/WIPReject/Itm
      * Renamed input format fields
     I              BZAIC3                          WHAIC3
     I              BZHGCD                          WHHGCD
     I              BZAVNA                          WHAVNA
     I              BZAWNA                          WHAWNA
     I              BZL7NA                          WHL7NA
     I              BZL8NA                          WHL8NA
     I              BZL6NA                          WHL6NA
     I              BZMFNA                          WHMFNA
     I              BZADCD                          WHADCD
     I              BZAWPC                          WHAWPC
     I              BZLXST                          WHLXST
     I              BZAECD                          WHAECD
     I              BZAXPC                          WHAXPC
     I              BZLYST                          WHLYST
     I              BZAFCD                          WHAFCD
     I              BZAICD                          WHAICD
     I              BZAIWG                          WHAIWG
     I              BZHICD                          WHHICD
     I              BZRBCD                          WHRBCD
     I              BZFZST                          WHFZST
     I              BZAVST                          WHAVST
     I              BZCZWG                          WHCZWG
     I              BZC0WG                          WHC0WG
     I              BZURTN                          WHURTN
     I              BZAJC8                          WHAJC8
     I              BZRINB                          WHRINB
     I              BZRHNB                          WHRHNB
     I              BZRGNB                          WHRGNB
     I              BZLNCD                          WHLNCD
     I              BZTFNB                          WHTFNB
     I              BZN0CD                          WHN0CD
     I              BZX4ST                          WHX4ST
     I              BZTMVA                          WHTMVA
     I              BZTNVA                          WHTNVA
     I              BZBLPR                          WHBLPR
     I              BZBMPR                          WHBMPR
     I              BZLRCD                          WHLRCD
     I              BZU9ST                          WHU9ST
     I              BZCMCO                          WHCMCO
     I              BZQ1CD                          WHQ1CD
     I              BZQ8CD                          WHQ8CD
     I              BZCHTM                          WHCHTM
     I              BZQZCD                          WHQZCD
     I              BZXWST                          WHXWST
     I              BZXXST                          WHXXST
     I              BZVMST                          WHVMST
     I              BZSWGH                          WHSWGH
     I              BZPPHE                          WHPPHE
     I              BZR3CD                          WHR3CD
     I              BZSDCD                          WHSDCD
     I              BZICN1                          WHICN1
     I              BZSVCD                          WHSVCD
     I              BZICN2                          WHICN2
     I              BZSWCD                          WHSWCD
     I              BZV2NB                          WHV2NB
     I              BZSXCD                          WHSXCD
     I              BZITCN                          WHITCN
     I              BZSYCD                          WHSYCD
     I              BZITC5                          WHITC5
     I              BZSZCD                          WHSZCD
     I              BZICN6                          WHICN6
     I              BZS0CD                          WHS0CD
     I              BZICN7                          WHICN7
     I              BZS1CD                          WHS1CD
     I              BZICN8                          WHICN8
     I              BZS2CD                          WHS2CD
     I              BZICN9                          WHICN9
     I              BZS3CD                          WHS3CD
     I              BZICN0                          WHICN0
     I              BZS4CD                          WHS4CD
     I              BZSFNB                          WHSFNB
     I              BZA3WG                          WHA3WG
     I              BZSJNB                          WHSJNB
     I              BZLLCD                          WHLLCD
     I              BZLMCD                          WHLMCD
     I              BZP3ST                          WHP3ST
     I              BZSKNB                          WHSKNB
     I              BZSLNB                          WHSLNB
     I              BZSMNB                          WHSMNB
     I              BZP4ST                          WHP4ST
     I              BZCFNB                          WHCFNB
     I              BZCGNB                          WHCGNB
     I              BZILNB                          WHILNB
     I              BZCHNB                          WHCHNB
     I              BZCINB                          WHCINB
     I              BZCJNB                          WHCJNB
     I              BZCMNB                          WHCMNB
     I              BZCNNB                          WHCNNB
     I              BZCRNB                          WHCRNB
     I              BZCSNB                          WHCSNB
     I              BZCVNB                          WHCVNB
     I              BZCWNB                          WHCWNB
     I              BZCXNB                          WHCXNB
     I              BZCZNB                          WHCZNB
     I              BZC0NB                          WHC0NB
     I              BZN1CD                          WHN1CD
     I              BZB4NB                          WHB4NB
     I              BZB5NB                          WHB5NB
     I              BZX5ST                          WHX5ST
     I              BZX6ST                          WHX6ST
     I              BZX7ST                          WHX7ST
     I              BZPCCT                          WHPCCT
     I              BZBDNB                          WHBDNB
     I              BZBJNB                          WHBJNB
     I              BZSUST                          WHSUST
     I              BZSVST                          WHSVST
     I              BZSYST                          WHSYST
     I              BZSZST                          WHSZST
     I              BZS1ST                          WHS1ST
     I              BZXRCD                          WHXRCD
     I              BZXTCD                          WHXTCD
     I              BZXUCD                          WHXUCD
     I              BZF5WG                          WHF5WG
     I              BZF6WG                          WHF6WG
     I              BZF7WG                          WHF7WG
     I              BZBLNB                          WHBLNB
     I              BZBNNB                          WHBNNB
     I              BZS2ST                          WHS2ST
     I              BZS4ST                          WHS4ST
     I              BZS5ST                          WHS5ST
     I              BZS6ST                          WHS6ST
     I              BZS8ST                          WHS8ST
     I              BZS9ST                          WHS9ST
     I              BZTCST                          WHTCST
     I              BZTDST                          WHTDST
     I              BZUVST                          WHUVST
     I              BZUWST                          WHUWST
     I              BZUXST                          WHUXST
     I              BZVSST                          WHVSST
     I              BZAATM                          WHAATM
     I              BZAYNA                          WHAYNA
     I              BZA0NA                          WHA0NA
     I              BZAXDT                          WHAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WIAIC3
     I              AFBCDT                          WIBCDT
     I              AFCQNB                          WICQNB
     I              AFESNB                          WIESNB
     I              AFETNB                          WIETNB
     I              AFBZNB                          WIBZNB
     I              AFA9ST                          WIA9ST
     I              AFEINB                          WIEINB
     I              AFC5ST                          WIC5ST
     I              AFAQNB                          WIAQNB
     I              AFCMST                          WICMST
     I              AFV9ST                          WIV9ST
     I              AFWAST                          WIWAST
     I              AFX2ST                          WIX2ST
     I              AFOJDT                          WIOJDT
     I              AFNQNX                          WINQNX
     I              AFNRNX                          WINRNX
     I              AFI9SX                          WII9SX
     I              AFJASX                          WIJASX
     I              AFOKDT                          WIOKDT
     I              AFOLDT                          WIOLDT
     I              AFUVST                          WIUVST
     I              AFUWST                          WIUWST
     I              AFUXST                          WIUXST
     I              AFAATM                          WIAATM
     I              AFAYNA                          WIAYNA
     I              AFA0NA                          WIA0NA
     I              AFAXDT                          WIAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WJAJCD
     I              ADF8NA                          WJF8NA
     I              ADACNA                          WJACNA
     I              ADADNA                          WJADNA
     I              ADAENA                          WJAENA
     I              ADAJNA                          WJAJNA
     I              ADBTTX                          WJBTTX
     I              ADAOCD                          WJAOCD
     I              ADBGCD                          WJBGCD
     I              ADVHST                          WJVHST
     I              ADMPNA                          WJMPNA
     I              ADWPST                          WJWPST
     I              ADXUST                          WJXUST
     I              ADT0ST                          WJT0ST
     I              ADT1ST                          WJT1ST
     I              ADDBNB                          WJDBNB
     I              ADT2ST                          WJT2ST
     I              ADT3ST                          WJT3ST
     I              ADT4ST                          WJT4ST
     I              ADT6ST                          WJT6ST
     I              ADBWC3                          WJBWC3
     I              ADBTC3                          WJBTC3
     I              ADBUC3                          WJBUC3
     I              ADBVC3                          WJBVC3
     I              ADFCAA                          WJFCAA
     I              ADRQSX                          WJRQSX
     I              ADRRSX                          WJRRSX
     I              ADRSSX                          WJRSSX
     I              ADRTSX                          WJRTSX
     I              ADT7ST                          WJT7ST
     I              ADT8ST                          WJT8ST
     I              ADRNSX                          WJRNSX
     I              ADROSX                          WJROSX
     I              ADRPSX                          WJRPSX
     I              ADUVST                          WJUVST
     I              ADUWST                          WJUWST
     I              ADUXST                          WJUXST
     I              ADVSST                          WJVSST
     I              ADAATM                          WJAATM
     I              ADAYNA                          WJAYNA
     I              ADA0NA                          WJA0NA
     I              ADAXDT                          WJAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WKAIC3
     I              B0HGCD                          WKHGCD
     I              B0AJCD                          WKAJCD
     I              B0AGCS                          WKAGCS
     I              B0AECS                          WKAECS
     I              B0BACS                          WKBACS
     I              B0BBCS                          WKBBCS
     I              B0CBPR                          WKCBPR
     I              B0GUDT                          WKGUDT
     I              B0XYST                          WKXYST
     I              B0CTPR                          WKCTPR
     I              B0G4DT                          WKG4DT
     I              B0BOWG                          WKBOWG
     I              B0DDQT                          WKDDQT
     I              B0DEQT                          WKDEQT
     I              B0DFQT                          WKDFQT
     I              B0HDQT                          WKHDQT
     I              B0HEQT                          WKHEQT
     I              B0AJQT                          WKAJQT
     I              B0AQQT                          WKAQQT
     I              B0AUQT                          WKAUQT
     I              B0EMQT                          WKEMQT
     I              B0DOQT                          WKDOQT
     I              B0ATNA                          WKATNA
     I              B0AKDT                          WKAKDT
     I              B0ANDT                          WKANDT
     I              B0IDVA                          WKIDVA
     I              B0JVST                          WKJVST
     I              B0BZPC                          WKBZPC
     I              B0DGQT                          WKDGQT
     I              B0DIDT                          WKDIDT
     I              B0ALCD                          WKALCD
     I              B0BFDY                          WKBFDY
     I              B0DJDT                          WKDJDT
     I              B0BGDY                          WKBGDY
     I              B0DKDT                          WKDKDT
     I              B0J2ST                          WKJ2ST
     I              B0DJQT                          WKDJQT
     I              B0BNWG                          WKBNWG
     I              B0DLDT                          WKDLDT
     I              B0DPQT                          WKDPQT
     I              B0DQQT                          WKDQQT
     I              B0DMDT                          WKDMDT
     I              B0M0ST                          WKM0ST
     I              B0J9ST                          WKJ9ST
     I              B0KBST                          WKKBST
     I              B0AKC8                          WKAKC8
     I              B0RINB                          WKRINB
     I              B0RHNB                          WKRHNB
     I              B0RGNB                          WKRGNB
     I              B0UVST                          WKUVST
     I              B0UWST                          WKUWST
     I              B0UXST                          WKUXST
     I              B0VSST                          WKVSST
     I              B0AATM                          WKAATM
     I              B0AYNA                          WKAYNA
     I              B0A0NA                          WKA0NA
     I              B0AXDT                          WKAXDT
      *
     I@JVCPAY
      * AS Production             Update index
      * Renamed input format fields
     I              JVASPD                          WLASPD
     I              JVHHDT                          WLHHDT
     I              JVZAST                          WLZAST
     I              JVASQY                          WLASQY
     I              JVEMWG                          WLEMWG
     I              JVZBST                          WLZBST
     I              JVZCST                          WLZCST
     I              JVZDST                          WLZDST
     I              JVZEST                          WLZEST
     I              JVXOCD                          WLXOCD
     I              JVXXCD                          WLXXCD
     I              JVTVCD                          WLTVCD
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WMAIC3
     I              KMV8CD                          WMV8CD
     I              KMAUNA                          WMAUNA
     I              KMI5ST                          WMI5ST
     I              KMBXTX                          WMBXTX
     I              KMM8NB                          WMM8NB
     I              KMUVST                          WMUVST
     I              KMUWST                          WMUWST
     I              KMUXST                          WMUXST
     I              KMVSST                          WMVSST
     I              KMAATM                          WMAATM
     I              KMAYNA                          WMAYNA
     I              KMA0NA                          WMA0NA
     I              KMAXDT                          WMAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDJV1    E DSPDJVCPL0
      * UPD : AS Production             Update index
      * Renamed input format fields
     I              JVASPD                          WLASPD
     I              JVHHDT                          WLHHDT
     I              JVZAST                          WLZAST
     I              JVASQY                          WLASQY
     I              JVEMWG                          WLEMWG
     I              JVZBST                          WLZBST
     I              JVZCST                          WLZCST
     I              JVZDST                          WLZDST
     I              JVZEST                          WLZEST
     I              JVXOCD                          WLXOCD
     I              JVXXCD                          WLXXCD
     I              JVTVCD                          WLTVCD
      *
     IYARDCS      DS                             36
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'AS Production'
      * AS Product Code
     I                                        1   5 ZA0001
      * AS Label Date
     I                                        6  11 ZA0002
      * AS Inventory Process Code
     I                                       12  12 ZA0003
      * AS Box Quantity
     I                                       13  17 ZA0004
      * AS Total Net Weight
     I                                       18  24 ZA0005
      * AS OMS Process Code
     I                                       25  25 ZA0006
      * AS Error Code
     I                                       26  26 ZA0007
      * AS Process Code 4
     I                                       27  27 ZA0008
      * AS Process Code 5
     I                                       28  28 ZA0009
      * AS Shift Number
     I                                       29  29 ZA0010
      * AS Production Date
     I                                       30  35 ZA0011
      * AS Carriage Return
     I                                       36  36 ZA0012
      * Message data for 'AS Production Upload'
      * Count USR
     I                                    P   1   30ZA0013
      * Quantity 11.0
     I                                    P   4   90ZA0014
      * Weight 11.2 USR
     I                                    P  10  152ZA0015
      * *Job time
     I                                    P  16  190ZA0016
      * *Job date
     I                                    P  20  230ZA0017
      * *USER
     I                                       24  33 ZA0018
      * Message data for 'AS Production Upload ERR'
      * *Job time
     I                                    P   1   40ZA0019
      * *Job date
     I                                    P   5   80ZA0020
      * *USER
     I                                        9  18 ZA0021
      * Message data for 'SND Pager Message'
      * Pager Name USR
     I                                        1  10 ZA0022
      * Pager Msg USR
     I                                       11  90 ZA0023
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Production Trans   XF
      * RMC 5/23/06 Init error flag to no, write error log for lbl/prod d
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Int. Acc EXTNL IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Appl EXTERNAL IF
      * RTV Program Setup      RT - User Profile Control  * 
     C                     EXSR SARVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * Retrieve Appl. Profile - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0001    P      User Profile Na
     C                     MOVEL'OMS'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    WUAJCD    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0001    P      User Profile Na
     C                     MOVEL'OMS'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    WUAJCD    P      Warehouse Code
     C                     END                             *FI
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     Z-ADDWUAIC3    YL0001           Company Number
     C                     MOVELWUWVST    WUWVST           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
      * RTV Screen Heading     RT
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SDRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Text String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C                     MOVE 'N'       FLAG    1        FLAG
     C           UX        DOWGT0
     C           FLAG      ANDEQ'N'
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     MOVE 'Y'       FLAG
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
      *** ADDED FOR HPE, THERE HEADER FOOTER IS OFF   MEA 042494
     C                     SUB  1         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
     C                     MOVELWUDE40    WUBXTX           System Value Al
      * Prc Production Trans   RT - AS Production  * 
     C                     EXSR SFRVGN
      * Exc Upd Last Dt Cllctn XF - AS Last Data Collection  * 
     C                     CALL 'PDTCXFR'              90  Exc Upd Last Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0112  30       Company Number
     C                     PARM 'PROD'    WQ0113  6        AS Data Collect
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Program Setup      RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    WAAJVN           User Profile Na
      * Establish starting position
     C           KRSSA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAI6ST    WUI6ST           Allow Multi-Com
     C                     MOVELWAMPNA    WUMPNA           Default Printer
     C                     MOVELWABCCD    WUBCCD           Salesperson Cod
     C                     MOVELWABUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Retrieve Appl. Profile - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJVN           User Profile Na
     C                     KFLD           WBDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    WBAJVN           User Profile Na
     C                     MOVELWL0002    WBDNCD           Application Cod
      * Establish starting position
     C           KRSSB     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAIC3    WL0003           Company Number
     C                     MOVELWBAJCD    WL0004           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    WCAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUADTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCADTX    WUADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDDNCD    WQSD01           Application Cod
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSD01           Application Cod
     C                     MOVEL'OMS'     WQSD01           Application Cod
      * Establish starting position
     C           KRSSD     SETLL@DNRESF                    *
     C           KRSSD     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WDRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWDAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C           KRSSD     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDDNCD    WQSE01           Application Cod
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Application Cod
      * Setup key
     C                     MOVELWDRSCD    WQSE01           Application Cod
      * Establish starting position
     C           KRSSE     SETLL@DNRESF                    *
     C           KRSSE     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAUNA    WUAUNA           Description
     C           KRSSE     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Prc Production Trans   RT - AS Production  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0003  5        AS Product Code
     C                     MOVEL*BLANK    WN0004  1        AS Inventory Pr
     C                     MOVEL*BLANK    WN0005  1        AS Error Code
     C                     MOVEL*BLANK    WN0006  6        AS Label Date
     C                     MOVEL*BLANK    WN0007  6        AS Production D
     C                     MOVEL*BLANK    WN0008  1        Error Status
     C                     MOVEL*BLANK    WN0009 30        Description
     C                     Z-ADD*ZERO     WN0010 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0011 112       Transaction Wei
     C                     Z-ADD*ZERO     WN0012  70       Item Code
     C                     Z-ADD*ZERO     WN0013  70       Production Date
     C                     MOVEL*BLANK    WN0014  1        Shift Number
     C                     Z-ADD*ZERO     WN0015  70       Label Date
     C                     Z-ADD*ZERO     WN0016  90       USR Weight, 9.0
     C                     MOVEL*BLANK    WN0017  1        AS Inventory Pr
     C                     MOVEL*BLANK    WN0018  1        Production Date
     C                     MOVEL*BLANK    WN0019  3        Default Warehou
     C                     Z-ADD*ZERO     WN0020  50       Count USR
     C                     Z-ADD*ZERO     WN0021 110       Quantity 11.0
     C                     Z-ADD*ZERO     WN0022 112       Weight 11.2 USR
     C                     MOVEL*BLANK    WN0023  1        First Time Flag
     C                     MOVEL*BLANK    WN0024  6        AS Data Collect
     C                     Z-ADD*ZERO     WN0025  70       AS Transaction
     C                     Z-ADD*ZERO     WN0026  60       AS Transaction
     C                     Z-ADD*ZERO     WN0027  70       AS Sequence Num
     C                     MOVEL*BLANK    WN0028110        AS Error Record
     C                     MOVEL*BLANK    WN0029  1        AS Error Code
     C                     MOVEL*BLANK    WN0030 10        AS Notified Lis
     C                     MOVEL*BLANK    WN0031  1        AS Unused Sts 1
     C                     MOVEL*BLANK    WN0032  1        AS Unused Sts 2
     C                     MOVEL*BLANK    WN0033  1        AS Unused Sts 3
     C                     MOVEL*BLANK    WN0034  2        AS Unused Sts 4
     C                     MOVEL*BLANK    WN0035  2        AS Unused Sts 5
     C                     MOVEL*BLANK    WN0036  1        EDI Status 1
     C                     MOVEL*BLANK    WN0037  1        EDI Status 2
     C                     MOVEL*BLANK    WN0038  1        EDI Status 3
     C                     MOVEL*BLANK    WN0039  1        Record Status
     C                     Z-ADD*ZERO     WN0040  60       Job Time
     C                     MOVEL*BLANK    WN0041 10        User Id
     C                     MOVEL*BLANK    WN0042 10        Job Name
     C                     Z-ADD*ZERO     WN0043  70       Job Date
     C                     MOVEL*BLANK    WN0044  1        Partial Item St
     C                     Z-ADD*ZERO     WN0045  70       Item Code USR
     C                     MOVEL*BLANK    WN0046  2        Yld Inv Balance
     C                     MOVEL*BLANK    WN0047  1        Sold 100% Froze
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0010           Transaction Qua
     C                     Z-ADD*ZERO     WN0016           USR Weight, 9.0
     C                     Z-ADD*ZERO     WN0020           Count USR
     C                     Z-ADD*ZERO     WN0021           Quantity 11.0
     C                     Z-ADD*ZERO     WN0022           Weight 11.2 USR
     C                     MOVEL'N'       YL0002           Error Flag
      * *********************************************************
     C                     Z-ADD##JDT     WN0025           AS Transaction
     C                     Z-ADD##JTM     WN0026           AS Transaction
     C                     MOVEL*BLANK    WN0030           AS Notified Lis
     C                     MOVEL'ASPRDUPL'WN0030           AS Notified Lis
     C                     MOVEL*BLANK    WN0024           AS Data Collect
     C                     MOVEL'PROD'    WN0024           AS Data Collect
     C                     MOVEL'N'       YL0003           Upload Error US
      * *********************************************************
     C                     MOVELWUGSTX    WN0023           First Time Flag
      * *********************************************************
      * Establish starting position
     C           *LOVAL    SETLL@JVCPFD                    *
     C                     READ @JVCPFD                  90*
      * Data record not found
     C   90                MOVEL'USR1995' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'N'       YL0002           Error Flag
      * Check for Dec Data Errors
     C                     MOVELWEASPD    WUY7TX           Text USR 5
      * RPG TESTN for 5 pos.  US - /UT User Source  * 
     C                     TESTN          WUY7TX  5  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * VAL:  5 Position Numeric
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     WUHGCD           Item Code
     C                     MOVEL'Y'       YL0002           Error Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUHGCD           Item Code
     C                     MOVE WEASPD    WUHGCD           Item Code
     C                     END                             *FI
      * Validate and Process Record
      * CASE: LCL.Error Flag            USR is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0001  30       Company Number
     C                     PARM WN0024    WQ0002  6        AS Data Collect
     C                     PARM WN0025    WQ0003  70       AS Transaction
     C                     PARM WN0026    WQ0004  60       AS Transaction
     C                     PARM @CN,01    WQ0005110        AS Error Record
     C                     PARM @CN,02    WQ0006 10        AS Error Log Co
     C                     PARM WN0030    WQ0007 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'E'       WN0005           AS Error Code
     C                     MOVEL'Y'       YL0003           Upload Error US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0008           Error Status
      * Setup message data for message
     C                     MOVELWEASPD    ZA0001           AS Product Code
     C                     MOVELWEHHDT    ZA0002           AS Label Date
     C                     MOVELWEZAST    ZA0003           AS Inventory Pr
     C                     MOVELWEASQY    ZA0004           AS Box Quantity
     C                     MOVELWEEMWG    ZA0005           AS Total Net We
     C                     MOVELWEZBST    ZA0006           AS OMS Process
     C                     MOVELWEZCST    ZA0007           AS Error Code
     C                     MOVELWEZDST    ZA0008           AS Process Code
     C                     MOVELWEZEST    ZA0009           AS Process Code
     C                     MOVELWEXOCD    ZA0010           AS Shift Number
     C                     MOVELWEXXCD    ZA0011           AS Production D
     C                     MOVELWETVCD    ZA0012           AS Carriage Ret
      * Retrieve message AS Production
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3077' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WN0028    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Val Itm/Whs,PDC FG/WP RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0005           Company Number
     C                     Z-ADDWUHGCD    WL0006           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0018    P      Production Date
     C                     MOVELWL0008    WN0019    P      Default Warehou
     C                     MOVELWL0009    WN0047    P      Sold 100% Froze
      * If item is not valid, check if Partial or WIP Reject
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * ** Check Partial **
      * VAL Partial Code      RT - Company Item  * 
     C                     EXSR SHRVGN
      * VAL:  Partial/WIP Reject Item
      * CASE: LCL.Record Found USR is Record Found
     C           YL0005    IFEQ 'Y'                        *IF
     C                     MOVEL'PT'      YL0006           Yld Inv Balance
     C                     MOVEL'Y'       YL0007           Partial Item St
      * Val Itm/Whs,PDC FG/WP RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0005           Company Number
     C                     Z-ADDYL0004    WL0006           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0018    P      Production Date
     C                     MOVELWL0008    WN0019    P      Default Warehou
     C                     MOVELWL0009    WN0047    P      Sold 100% Froze
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Check WIP Reject **
      * VAL WIP Reject Code   RT - Company Item  * 
     C                     EXSR SIRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0005    IFEQ 'Y'                        *IF
     C                     MOVEL'RJ'      YL0006           Yld Inv Balance
     C                     MOVEL'Y'       YL0007           Partial Item St
      * Val Itm/Whs,PDC FG/WP RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0005           Company Number
     C                     Z-ADDYL0004    WL0006           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0018    P      Production Date
     C                     MOVELWL0008    WN0019    P      Default Warehou
     C                     MOVELWL0009    WN0047    P      Sold 100% Froze
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0008           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0008  30       Company Number
     C                     PARM WN0024    WQ0009  6        AS Data Collect
     C                     PARM WN0025    WQ0010  70       AS Transaction
     C                     PARM WN0026    WQ0011  60       AS Transaction
     C                     PARM WN0028    WQ0012110        AS Error Record
     C                     PARM 'ITEMCODE'WQ0013 10        AS Error Log Co
     C                     PARM WN0030    WQ0014 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0007           Partial Item St
     C                     Z-ADD*ZERO     YL0004           Item Code USR
     C                     END                             *FI
      * Validate label date if production date control is yes
      * CASE: PAR.Production Date Control is yes
     C           WN0018    IFEQ 'Y'                        *IF
     C                     MOVELWEHHDT    WUXLTX           Text USR 6
      * RPG TESTN for 6 pos.  US - /UT User Source  * 
     C                     TESTN          WUXLTX  6  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     WUMHNX           Label Date USR
     C                     MOVEL'Y'       YL0002           Error Flag
     C                     MOVEL'Y'       WN0008           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0015  30       Company Number
     C                     PARM WN0024    WQ0016  6        AS Data Collect
     C                     PARM WN0025    WQ0017  70       AS Transaction
     C                     PARM WN0026    WQ0018  60       AS Transaction
     C                     PARM WN0028    WQ0019110        AS Error Record
     C                     PARM 'LBLDEC'  WQ0020 10        AS Error Log Co
     C                     PARM WN0030    WQ0021 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WEHHDT    WUMHNX           Label Date USR
     C                     END                             *FI
      * WRK.Label Date = WRK.Label Date USR
     C                     Z-ADDWUMHNX    WUK7DT           Label Date
      * Set Century.
      * CASE: WRK.Label Date is < 410101
     C           WUK7DT    IFLT 410101                     *IF
     C                     ADD  1000000   WUK7DT           Label Date
     C                     END                             *FI
      * VAL Date               RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0010           Company Number
     C                     Z-ADDWUK7DT    WL0011           Post to G/L Dat
     C                     EXSR SJRVGN
      * If date is not valid then error = yes
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0008           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0022  30       Company Number
     C                     PARM WN0024    WQ0023  6        AS Data Collect
     C                     PARM WN0025    WQ0024  70       AS Transaction
     C                     PARM WN0026    WQ0025  60       AS Transaction
     C                     PARM WN0028    WQ0026110        AS Error Record
     C                     PARM @CN,03    WQ0027 10        AS Error Log Co
     C                     PARM WN0030    WQ0028 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Validate production date if production date control is yes
      * CASE: PAR.Production Date Control is yes
     C           WN0018    IFEQ 'Y'                        *IF
     C                     MOVELWEXXCD    WUXLTX           Text USR 6
      * RPG TESTN for 6 pos.  US - /UT User Source  * 
     C                     TESTN          WUXLTX  6  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     WUMGNX           Prod Date USR
     C                     MOVEL'Y'       YL0002           Error Flag
     C                     MOVEL'Y'       WN0008           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0029  30       Company Number
     C                     PARM WN0024    WQ0030  6        AS Data Collect
     C                     PARM WN0025    WQ0031  70       AS Transaction
     C                     PARM WN0026    WQ0032  60       AS Transaction
     C                     PARM WN0028    WQ0033110        AS Error Record
     C                     PARM 'PRDDEC'  WQ0034 10        AS Error Log Co
     C                     PARM WN0030    WQ0035 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WEXXCD    WUMGNX           Prod Date USR
     C                     END                             *FI
      * WRK.Production Date = WRK.Prod Date USR
     C                     Z-ADDWUMGNX    WUELDT           Production Date
      * Set Century.
      * CASE: WRK.Production Date is < 410101
     C           WUELDT    IFLT 410101                     *IF
     C                     ADD  1000000   WUELDT           Production Date
     C                     END                             *FI
      * VAL Date               RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0010           Company Number
     C                     Z-ADDWUELDT    WL0011           Post to G/L Dat
     C                     EXSR SJRVGN
      * If date is not valid then error = yes
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0008           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0036  30       Company Number
     C                     PARM WN0024    WQ0037  6        AS Data Collect
     C                     PARM WN0025    WQ0038  70       AS Transaction
     C                     PARM WN0026    WQ0039  60       AS Transaction
     C                     PARM WN0028    WQ0040110        AS Error Record
     C                     PARM 'PRODDATE'WQ0041 10        AS Error Log Co
     C                     PARM WN0030    WQ0042 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Validate that shift has been sent
      * CASE: DB1.AS Shift Number is Not Entered
     C           WEXOCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WN0008           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0043  30       Company Number
     C                     PARM WN0024    WQ0044  6        AS Data Collect
     C                     PARM WN0025    WQ0045  70       AS Transaction
     C                     PARM WN0026    WQ0046  60       AS Transaction
     C                     PARM WN0028    WQ0047110        AS Error Record
     C                     PARM 'SHIFT'   WQ0048 10        AS Error Log Co
     C                     PARM WN0030    WQ0049 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Validate Finished Goods & WIP Item Code Data
      * CASE: LCL.Partial Item Sts USR is no
     C           YL0007    IFEQ 'N'                        *IF
      * Val Accu-Sort Whse     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0019    WL0012    P      Warehouse Code
     C                     EXSR SKRVGN
      * If warehouse is not valid set error flag to yes
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0008           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0050  30       Company Number
     C                     PARM WN0024    WQ0051  6        AS Data Collect
     C                     PARM WN0025    WQ0052  70       AS Transaction
     C                     PARM WN0026    WQ0053  60       AS Transaction
     C                     PARM WN0028    WQ0054110        AS Error Record
     C                     PARM 'WHSCODE' WQ0055 10        AS Error Log Co
     C                     PARM WN0030    WQ0056 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Validate Unit Cost
      * CASE: PAR.Error Status is no
     C           WN0008    IFEQ 'N'                        *IF
      * RTV Unit Cost Active   RT - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0013           Company Number
     C                     Z-ADDWUHGCD    WL0014           Item Code
     C                     MOVELWN0019    WL0015    P      Warehouse Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    WUAGCS           Unit Cost Per P
      * CASE: WRK.Unit Cost Per Pound EQ WRK.ZERO
     C           WUAGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'Y'       WN0008           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0057  30       Company Number
     C                     PARM WN0024    WQ0058  6        AS Data Collect
     C                     PARM WN0025    WQ0059  70       AS Transaction
     C                     PARM WN0026    WQ0060  60       AS Transaction
     C                     PARM WN0028    WQ0061110        AS Error Record
     C                     PARM 'UNITCOST'WQ0062 10        AS Error Log Co
     C                     PARM WN0030    WQ0063 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process Record
      * CASE: PAR.Error Status is no
     C           WN0008    IFEQ 'N'                        *IF
      * Set up first time pass
      * CASE: PAR.First Time Flag EQ WRK.BLANK
     C           WN0023    IFEQ WUGSTX                     *IF
     C                     Z-ADDWUHGCD    WN0012           Item Code
     C                     MOVELWEASPD    WN0003           AS Product Code
     C                     MOVELWEHHDT    WN0006           AS Label Date
     C                     MOVELWEXXCD    WN0007           AS Production D
     C                     MOVELWEXOCD    WN0014           Shift Number
     C                     MOVEL'Y'       WN0023           First Time Flag
     C                     MOVEL*BLANK    WN0009           Description
     C                     MOVEL@CN,04    WN0009           Description
      * Partial Processing
     C                     MOVELYL0007    WN0044           Partial Item St
     C                     Z-ADDYL0004    WN0045           Item Code USR
     C                     MOVELYL0006    WN0046           Yld Inv Balance
     C                     END                             *FI
      * Check for product or prod date or shift change
      * CASE: CHG:  Item Code, Label Date, Shift Number
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.AS Product Code NE DB1.AS Product Code
      *   |- c2    : PAR.AS Label Date NE DB1.AS Label Date
      *   |- c3    : PAR.Shift Number NE DB1.AS Shift Number
      *   '-
     C           WN0003    IFNE WEASPD                     *IF
     C           WN0006    ORNE WEHHDT                     *OR
     C           WN0014    ORNE WEXOCD                     *OR
     C           WN0016    DIV  10        WN0011    H      Transaction Wei
      * CASE: PAR.Partial Item Sts USR is no
     C           WN0044    IFEQ 'N'                        *IF
      * Val Itm/Whs,PDC FG/WP RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0005           Company Number
     C                     Z-ADDWN0012    WL0006           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0018    P      Production Date
     C                     MOVELWL0008    WN0019    P      Default Warehou
     C                     MOVELWL0009    WN0047    P      Sold 100% Froze
      * Set up Label/Production dates by Production Date Control
      * CASE: PAR.Production Date Control is no
     C           WN0018    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WN0013           Production Date
     C                     Z-ADD*ZERO     WN0015           Label Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WN0006    YL0008           Label Date USR
      * PAR.Label Date = LCL.Label Date USR
     C                     Z-ADDYL0008    WN0015           Label Date
      * Set Century.
      * CASE: PAR.Label Date is < 410101
     C           WN0015    IFLT 410101                     *IF
     C                     ADD  1000000   WN0015           Label Date
     C                     END                             *FI
     C                     MOVE WN0007    YL0009           Prod Date USR
      * PAR.Production Date = LCL.Prod Date USR
     C                     Z-ADDYL0009    WN0013           Production Date
      * Set Century.
      * CASE: PAR.Production Date is < 410101
     C           WN0013    IFLT 410101                     *IF
     C                     ADD  1000000   WN0013           Production Date
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    WN0009           Description
     C                     MOVEL@CN,04    WN0009           Description
      * CASE: PAR.Sold 100% Frozen is yes
     C           WN0047    IFEQ 'Y'                        *IF
     C                     MOVEL'CF1'     WN0019           Default Warehou
     C                     END                             *FI
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0064  30       Company Number
     C                     PARM WN0012    WQ0065  70       Item Code
     C                     PARM WN0019    WQ0066  3        Warehouse Code
     C                     PARM 'R'       WQ0067  1        Inventory Trans
     C                     PARM 'RR'      WQ0068  2        Inventory Trans
     C                     PARM ##JDT     WQ0069  70       Transaction Dat
     C                     PARM WN0013    WQ0070  70       Production Date
     C                     PARM WN0009    WQ0071 30        Description
     C                     PARM WN0010    WQ0072 112       Transaction Qua
     C                     PARM WN0011    WQ0073 112       Transaction Wei
     C                     PARM 'PRD'     WQ0074  3        Reason Code
     C                     PARM WN0014    WQ0075  1        Shift Number
     C                     PARM WN0015    WQ0076  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Partial Item Sts USR is yes
     C           WN0044    IFEQ 'Y'                        *IF
      * Val Itm/Whs,PDC FG/WP RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0005           Company Number
     C                     Z-ADDWN0045    WL0006           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0018    P      Production Date
     C                     MOVELWL0008    WN0019    P      Default Warehou
     C                     MOVELWL0009    WN0047    P      Sold 100% Froze
      * Set up Label/Production dates by Production Date Control
      * CASE: PAR.Production Date Control is no
     C           WN0018    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WN0013           Production Date
     C                     Z-ADD*ZERO     WN0015           Label Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WN0006    YL0008           Label Date USR
      * PAR.Label Date = LCL.Label Date USR
     C                     Z-ADDYL0008    WN0015           Label Date
      * Set Century.
      * CASE: PAR.Label Date is < 410101
     C           WN0015    IFLT 410101                     *IF
     C                     ADD  1000000   WN0015           Label Date
     C                     END                             *FI
     C                     MOVE WN0007    YL0009           Prod Date USR
      * PAR.Production Date = LCL.Prod Date USR
     C                     Z-ADDYL0009    WN0013           Production Date
      * Set Century.
      * CASE: PAR.Production Date is < 410101
     C           WN0013    IFLT 410101                     *IF
     C                     ADD  1000000   WN0013           Production Date
     C                     END                             *FI
     C                     END                             *FI
      * **** Create Partial File ****
      * Prc Crt Partial Rcpt  XF - Yld Partial Transaction  * 
     C                     CALL 'POVAXFR'              90  Prc Crt Partial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0077  30       Company Number
     C                     PARM ##JDT     WQ0078  70       Transaction Dat
     C                     PARM WN0012    WQ0079  70       Partial Item Co
     C                     PARM WN0045    WQ0080  70       Item Code
     C                     PARM WN0013    WQ0081  70       Production Date
     C                     PARM WN0014    WQ0082  1        Production Shif
     C                     PARM WN0010    WQ0083  70       Yld Transaction
     C                     PARM WN0011    WQ0084 112       Yld Transaction
     C                     PARM WN0046    WQ0085  2        Yld Inv Balance
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUHGCD    WN0012           Item Code
     C                     MOVELWEASPD    WN0003           AS Product Code
     C                     MOVELWEHHDT    WN0006           AS Label Date
     C                     MOVELWEXXCD    WN0007           AS Production D
     C                     Z-ADD*ZERO     WN0010           Transaction Qua
     C                     MOVELWEXOCD    WN0014           Shift Number
     C                     Z-ADD*ZERO     WN0016           USR Weight, 9.0
      * Partial Processing
     C                     MOVELYL0007    WN0044           Partial Item St
     C                     Z-ADDYL0004    WN0045           Item Code USR
     C                     MOVELYL0006    WN0046           Yld Inv Balance
     C                     END                             *FI
      * Add up box quantity and weight
     C                     MOVE WEASQY    WUTSNB           Calc 5
     C                     ADD  WUTSNB    WN0010           Transaction Qua
     C                     MOVE WEEMWG    WUTVNB           Calc 7
     C                     ADD  WUTVNB    WN0016           USR Weight, 9.0
     C                     MOVEL*BLANK    WN0005           AS Error Code
      * Accum Qty/Wgt Uploaded and # of records processed.
     C                     EXSR UASUBR                     Accum Qty/Wgt U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WN0005           AS Error Code
     C                     MOVEL'Y'       YL0003           Upload Error US
     C                     END                             *FI
     C                     END                             *FI
      * Change inventory process flag
     C                     MOVEL'Y'       WN0017           AS Inventory Pr
      * Chg Inventory Proc. Cd CH - AS Production  * 
     C                     EXSR SMCHRC
     C                     READ @JVCPFD                  90*
     C                     ENDDO
      * USER: Exit processing
      * Write last  record if qty or wght is not zero
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Transaction Quantity is not equal zero
      *   |- c2    : PAR.Transaction Weight is Not equal zero
      *   '-
     C           WN0010    IFNE *ZERO                      *IF
     C           WN0011    ORNE *ZERO                      *OR
     C           WN0016    DIV  10        WN0011    H      Transaction Wei
      * CASE: PAR.Partial Item Sts USR is no
     C           WN0044    IFEQ 'N'                        *IF
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) WN0047' defaulted for 'Sold 100% Frozen'.
      * Val Itm/Whs,PDC FG/WP RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0005           Company Number
     C                     Z-ADDWN0012    WL0006           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0018    P      Production Date
     C                     MOVELWL0008    WN0019    P      Default Warehou
     C                     MOVELWL0009    WN0047    P      Sold 100% Froze
      * Set up Label/Production dates by Production Date Control
      * CASE: PAR.Production Date Control is no
     C           WN0018    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WN0013           Production Date
     C                     Z-ADD*ZERO     WN0015           Label Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WN0006    YL0008           Label Date USR
      * PAR.Label Date = LCL.Label Date USR
     C                     Z-ADDYL0008    WN0015           Label Date
      * Set Century.
      * CASE: PAR.Label Date is < 410101
     C           WN0015    IFLT 410101                     *IF
     C                     ADD  1000000   WN0015           Label Date
     C                     END                             *FI
     C                     MOVE WN0007    YL0009           Prod Date USR
      * PAR.Production Date = LCL.Prod Date USR
     C                     Z-ADDYL0009    WN0013           Production Date
      * Set Century.
      * CASE: PAR.Production Date is < 410101
     C           WN0013    IFLT 410101                     *IF
     C                     ADD  1000000   WN0013           Production Date
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    WN0009           Description
     C                     MOVEL@CN,04    WN0009           Description
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0086  30       Company Number
     C                     PARM WN0012    WQ0087  70       Item Code
     C                     PARM WN0019    WQ0088  3        Warehouse Code
     C                     PARM 'R'       WQ0089  1        Inventory Trans
     C                     PARM 'RR'      WQ0090  2        Inventory Trans
     C                     PARM ##JDT     WQ0091  70       Transaction Dat
     C                     PARM WN0013    WQ0092  70       Production Date
     C                     PARM WN0009    WQ0093 30        Description
     C                     PARM WN0010    WQ0094 112       Transaction Qua
     C                     PARM WN0011    WQ0095 112       Transaction Wei
     C                     PARM 'PRD'     WQ0096  3        Reason Code
     C                     PARM WN0014    WQ0097  1        Shift Number
     C                     PARM WN0015    WQ0098  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Partial Item Sts USR is yes
     C           WN0044    IFEQ 'Y'                        *IF
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) WN0047' defaulted for 'Sold 100% Frozen'.
      * Val Itm/Whs,PDC FG/WP RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0005           Company Number
     C                     Z-ADDWN0045    WL0006           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0018    P      Production Date
     C                     MOVELWL0008    WN0019    P      Default Warehou
     C                     MOVELWL0009    WN0047    P      Sold 100% Froze
      * Set up Label/Production dates by Production Date Control
      * CASE: PAR.Production Date Control is no
     C           WN0018    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WN0013           Production Date
     C                     Z-ADD*ZERO     WN0015           Label Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WN0006    YL0008           Label Date USR
      * PAR.Label Date = LCL.Label Date USR
     C                     Z-ADDYL0008    WN0015           Label Date
      * Set Century.
      * CASE: PAR.Label Date is < 410101
     C           WN0015    IFLT 410101                     *IF
     C                     ADD  1000000   WN0015           Label Date
     C                     END                             *FI
     C                     MOVE WN0007    YL0009           Prod Date USR
      * PAR.Production Date = LCL.Prod Date USR
     C                     Z-ADDYL0009    WN0013           Production Date
      * Set Century.
      * CASE: PAR.Production Date is < 410101
     C           WN0013    IFLT 410101                     *IF
     C                     ADD  1000000   WN0013           Production Date
     C                     END                             *FI
     C                     END                             *FI
      * **** Create Partial File ****
      * Prc Crt Partial Rcpt  XF - Yld Partial Transaction  * 
     C                     CALL 'POVAXFR'              90  Prc Crt Partial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0099  30       Company Number
     C                     PARM ##JDT     WQ0100  70       Transaction Dat
     C                     PARM WN0012    WQ0101  70       Partial Item Co
     C                     PARM WN0045    WQ0102  70       Item Code
     C                     PARM WN0013    WQ0103  70       Production Date
     C                     PARM WN0014    WQ0104  1        Production Shif
     C                     PARM WN0010    WQ0105  70       Yld Transaction
     C                     PARM WN0011    WQ0106 112       Yld Transaction
     C                     PARM WN0046    WQ0107  2        Yld Inv Balance
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Send Office Message
      * Setup message data for message
     C                     Z-ADDWN0020    ZA0013           Count USR
     C                     Z-ADDWN0021    ZA0014           Quantity 11.0
     C                     Z-ADDWN0022    ZA0015           Weight 11.2 USR
     C                     Z-ADD##JTM     ZA0016           *Job time
      * Convert *Job date to display format
      * Convert date
     C           1000000   ADD  ##JDT     XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0017
     C                     MOVEL##USR     ZA0018           *USER
      * Retrieve message AS Production Upload
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2796' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WUKRTX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM @CN,05    WQ0108 10        DL List ID
     C                     PARM WUKRTX    WQ0109132        Office Message
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Error Flag            USR is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD##JTM     ZA0019           *Job time
      * Convert *Job date to display format
      * Convert date
     C           1000000   ADD  ##JDT     XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0020
     C                     MOVEL##USR     ZA0021           *USER
      * Retrieve message AS Production Upload ERR
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3047' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WUKRTX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM 'PRKASERR'WQ0110 10        DL List ID
     C                     PARM WUKRTX    WQ0111132        Office Message
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ***********************************************************
      * CASE: LCL.Upload Error USR is yes
     C           YL0003    IFEQ 'Y'                        *IF
      *
     C                     MOVEL*BLANK    WN0054 40        System Value Al
     C                     MOVEL*BLANK    WN0055 10        Pager Name USR
      *
      * Snd Pager Message     IF
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SNRVGN
     C                     MOVELWN0054    WN0055           Pager Name USR
      * Setup message data for message
     C                     MOVELWN0055    ZA0022           Pager Name USR
     C                     MOVEL@CN,06    ZA0023           Pager Msg USR
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3006' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
      * ***********************************************************
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Val Itm/Whs,PDC FG/WP RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFHGCD    WQSG02           Item Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Item Code
      * Setup key
     C                     Z-ADDWL0005    WQSG01           Company Number
     C                     Z-ADDWL0006    WQSG02           Item Code
      * Establish starting position
     C           KRSSG     SETLL@BZREJR                    *
     C           KRSSG     READE@BZREJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Production Date
     C                     MOVEL*BLANK    WL0008           Default Warehou
     C                     MOVEL*BLANK    WL0009           Sold 100% Froze
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFFZST    WL0007           Production Date
     C                     MOVELWFQ1CD    WL0008           Default Warehou
     C                     MOVELWFS4ST    WL0009           Sold 100% Froze
     C           KRSSG     READE@BZREJR                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * VAL Partial Code      RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WGCMNB    WQSH02           Partial Item Co
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Partial Item Co
      * Setup key
     C                     Z-ADDYL0001    WQSH01           Company Number
     C                     Z-ADDWUHGCD    WQSH02           Partial Item Co
      * Establish starting position
     C           KRSSH     SETLL@BZREP4                    *
     C           KRSSH     READE@BZREP4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0005           Record Found US
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGHGCD    YL0004           Item Code
     C                     MOVEL'Y'       YL0005           Record Found US
     C           KRSSH     READE@BZREP4                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * VAL WIP Reject Code   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WHCRNB    WQSI02           WIP Reject Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           WIP Reject Code
      * Setup key
     C                     Z-ADDYL0001    WQSI01           Company Number
     C                     Z-ADDWUHGCD    WQSI02           WIP Reject Code
      * Establish starting position
     C           KRSSI     SETLL@BZRESI                    *
     C           KRSSI     READE@BZRESI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0005           Record Found US
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHHGCD    YL0004           Item Code
     C                     MOVEL'Y'       YL0005           Record Found US
     C           KRSSI     READE@BZRESI                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * VAL Date               RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0010    WIAIC3           Company Number
     C                     Z-ADDWL0011    WIBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSJ     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val Accu-Sort Whse     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0012    WJAJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Trans Contol AS400/Plant is Plant
     C           WJXUST    IFEQ 'P'                        *IF
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Unit Cost Active   RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0013    WKAIC3           Company Number
     C                     Z-ADDWL0014    WKHGCD           Item Code
     C                     MOVELWL0015    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0016           Unit Cost Per P
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKAGCS    WL0016           Unit Cost Per P
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg Inventory Proc. Cd CH - AS Production  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0048  5        AS Box Quantity
     C                     MOVEL*BLANK    WN0049  7        AS Total Net We
     C                     MOVEL*BLANK    WN0050  1        AS OMS Process
     C                     MOVEL*BLANK    WN0051  1        AS Process Code
     C                     MOVEL*BLANK    WN0052  1        AS Process Code
     C                     MOVEL*BLANK    WN0053  1        AS Carriage Ret
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @JVCPAY
     C                     MOVELWEASPD    WLASPD    P      AS Product Code
     C                     MOVELWEHHDT    WLHHDT    P      AS Label Date
     C                     MOVELWEZAST    WLZAST    P      AS Inventory Pr
      *
     C           KLCHSM    KLIST
     C                     KFLD           WLASPD           AS Product Code
     C                     KFLD           WLHHDT           AS Label Date
     C                     KFLD           WLZAST           AS Inventory Pr
     C           KLCHSM    CHAIN@JVCPAY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJVCPL0'MDACP
     C                     MOVEL'@JVCPAY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDJV1    YARDCS
      * Move non-key fields to @JVCPAY
     C                     MOVELWN0005    WLZCST    P      AS Error Code
     C                     MOVELWEXOCD    WLXOCD    P      AS Shift Number
     C                     MOVELWEXXCD    WLXXCD    P      AS Production D
      *
      * Set PGM.*Record Data Changed flag
     C           QPDJV1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVELWN0017    WLZAST           AS Inventory Pr
      * Set PGM.*Record Data Changed flag
     C           QPDJV1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@JVCPAY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDJVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMV8CD           Company Value C
      * Setup key
     C                     Z-ADDYL0001    WMAIC3           Company Number
     C                     MOVELWN0030    WMV8CD           Company Value C
      * Establish starting position
     C           KRSSN     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMBXTX    WN0054           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Accum Qty/Wgt Uploaded and # of records processed.
      *================================================================
     C                     ADD  1         WN0020           Count USR
     C                     MOVELWEASQY    WUY7TX           Text USR 5
      * RPG TESTN for 5 pos.  US - /UT User Source  * 
     C                     TESTN          WUY7TX  5  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     WUTSNB           Calc 5
     C                     MOVEL'Y'       YL0002           Error Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WEASQY    WUTSNB           Calc 5
     C                     END                             *FI
     C                     ADD  WUTSNB    WN0021           Quantity 11.0
     C                     MOVELWEEMWG    WUY8TX           Text USR 7
      * RPG TESTN for 7 pos.  US - /UT User Source  * 
     C                     TESTN          WUY8TX  7  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     WUTVNB           Calc 7
     C                     MOVEL'Y'       YL0002           Error Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WEEMWG    WUTVNB           Calc 7
     C                     END                             *FI
     C                     ADD  WUTVNB    WN0022           Weight 11.2 USR
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Allow Multi-Company
     C                     MOVEL*BLANK    WUI6ST  1
      * Define work field Default Printer
     C                     MOVEL*BLANK    WUMPNA 10
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field System Value Alpha
     C                     MOVEL*BLANK    WUBXTX 40
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WANLNB           Entity Number
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize renamed input format fields
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Text USR 5
     C                     MOVEL*BLANK    WUY7TX  5
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Define work field Item Code
     C                     Z-ADD*ZERO     WUHGCD  70
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAIWG           Unit Weight
     C                     Z-ADD*ZERO     WFCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WFC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WFURTN           Number Cases On
     C                     Z-ADD*ZERO     WFAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFTFNB           Transportation
     C                     Z-ADD*ZERO     WFTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WFTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WFBLPR           Market Overage
     C                     Z-ADD*ZERO     WFBMPR           Standard Overag
     C                     Z-ADD*ZERO     WFCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WFCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WFSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WFPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WFICN1           Item Category N
     C                     Z-ADD*ZERO     WFICN2           Item Category N
     C                     Z-ADD*ZERO     WFV2NB           Item Category N
     C                     Z-ADD*ZERO     WFITCN           Item Category N
     C                     Z-ADD*ZERO     WFITC5           Item Category N
     C                     Z-ADD*ZERO     WFICN6           Item Category N
     C                     Z-ADD*ZERO     WFICN7           Item Category N
     C                     Z-ADD*ZERO     WFICN8           Item Category N
     C                     Z-ADD*ZERO     WFICN9           Item Category N
     C                     Z-ADD*ZERO     WFICN0           Item Category N
     C                     Z-ADD*ZERO     WFSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WFA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WFSJNB           CI Unused Numbe
     C                     Z-ADD*ZERO     WFSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WFSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WFSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WFCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WFCGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WFILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WFCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WFCINB           PM Batch Size
     C                     Z-ADD*ZERO     WFCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WFCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WFCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WFCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WFCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WFCVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     WFCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WFCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WFCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WFC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WFB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WFB5NB           PM Line Number
     C                     Z-ADD*ZERO     WFBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WFBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WFF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WFF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WFF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WFBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WFBNNB           Production Qty
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Text USR 6
     C                     MOVEL*BLANK    WUXLTX  6
      * Define work field Label Date USR
     C                     Z-ADD*ZERO     WUMHNX  60
      * Define work field Label Date
     C                     Z-ADD*ZERO     WUK7DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WICQNB           Julian Date
     C                     Z-ADD*ZERO     WIESNB           Accounting Year
     C                     Z-ADD*ZERO     WIETNB           Accounting Peri
     C                     Z-ADD*ZERO     WIBZNB           OM Week
     C                     Z-ADD*ZERO     WIEINB           Week Number
     C                     Z-ADD*ZERO     WIAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WIOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WINQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WINRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WIOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WIOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Prod Date USR
     C                     Z-ADD*ZERO     WUMGNX  60
      * Define work field Production Date
     C                     Z-ADD*ZERO     WUELDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WJBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WJBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WJBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WJBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Unit Cost Per Pound
     C                     Z-ADD*ZERO     WUAGCS 114
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WKAECS           Last Cost
     C                     Z-ADD*ZERO     WKBACS           Cost per Primar
     C                     Z-ADD*ZERO     WKBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WKCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WKGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WKCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WKG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WKBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WKDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WKDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WKDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WKHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WKHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WKAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WKAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WKAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WKEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WKDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WKAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WKANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WKIDVA           Value of On Han
     C                     Z-ADD*ZERO     WKBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WKDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WKDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WKBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WKDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WKBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WKDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WKDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WKBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WKDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WKDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WKDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WKDMDT           Last Physical C
     C                     Z-ADD*ZERO     WKAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WKRINB           Item Structure
     C                     Z-ADD*ZERO     WKRHNB           Item Structure
     C                     Z-ADD*ZERO     WKRGNB           Item Structure
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Calc 5
     C                     Z-ADD*ZERO     WUTSNB  50
      * Define work field Calc 7
     C                     Z-ADD*ZERO     WUTVNB  70
      * Define work field Text USR 7
     C                     MOVEL*BLANK    WUY8TX  7
      * Define work field Office Message USR
     C                     MOVEL*BLANK    WUKRTX132
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMM8NB           System Value Nu
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  3
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  1
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
      * Define local variables for subroutine SKRVGN.
     C                     MOVEL*BLANK    WL0012  3
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  3
     C                     Z-ADD*ZERO     WL0016 114
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Error Flag            USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Upload Error USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Item Code USR
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Yld Inv Balance Type
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Partial Item Sts USR
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Label Date USR
     C                     Z-ADD*ZERO     YL0008  60
      * Define local work field Prod Date USR
     C                     Z-ADD*ZERO     YL0009  60
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Data Decimal Error
00002 ITMNOTNUM
00003 LABELDATE
00004 Plant Floor Production
00005 PRKASUPLM
00006 400-300-003
