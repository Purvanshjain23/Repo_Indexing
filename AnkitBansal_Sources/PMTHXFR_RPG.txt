     H/TITLE Exc Crt RIN Trans Rpt XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 09/28/10  Time  : 16:25:03
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMDACPL8IF  E           K        DISK
      * RSQ : COA Batch Header RIN      Co/Batch/TransDt/Partn/S
      *
     FPMCCCPL1IF  E           K        DISK
      * RTV : COA Batch Header          Retrieval index
      *
     FPMCAREL1IF  E           K        DISK
      * RTV : COA Property Define Hdr   Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPMDQCPL0IF  E           K        DISK                      A
      * UPD : RFS RIN Transaction Rpt   Update index
      *
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@DACPCY
      * COA Batch Header RIN      Co/Batch/TransDt/Partn/S
      * Renamed input format fields
     I              DAAIC3                          WAAIC3
     I              DAL6T1                          WAL6T1
     I              DAI3NY                          WAI3NY
     I              DAJYNY                          WAJYNY
     I              DAQ1NY                          WAQ1NY
     I              DAMUT1                          WAMUT1
     I              DAJZNY                          WAJZNY
     I              DAJ0NY                          WAJ0NY
     I              DAJ2NY                          WAJ2NY
     I              DARIDT                          WARIDT
     I              DAC5TM                          WAC5TM
     I              DAMVT1                          WAMVT1
     I              DAMWT1                          WAMWT1
     I              DARINT                          WARINT
     I              DARJDT                          WARJDT
     I              DAC6TM                          WAC6TM
     I              DAC4NB                          WAC4NB
     I              DADPNB                          WADPNB
     I              DAUENB                          WAUENB
     I              DARZNB                          WARZNB
     I              DANGT1                          WANGT1
     I              DARMNB                          WARMNB
     I              DARKDT                          WARKDT
     I              DAC7TM                          WAC7TM
     I              DARINS                          WARINS
     I              DAMXT1                          WAMXT1
     I              DAG3ST                          WAG3ST
     I              DAQWNY                          WAQWNY
     I              DAL0AA                          WAL0AA
     I              DAMAT1                          WAMAT1
     I              DATDNA                          WATDNA
     I              DACWC3                          WACWC3
     I              DAQXNY                          WAQXNY
     I              DAQZNY                          WAQZNY
     I              DAQ0NY                          WAQ0NY
     I              DALVTX                          WALVTX
     I              DANYT1                          WANYT1
     I              DAG5ST                          WAG5ST
     I              DAG7ST                          WAG7ST
     I              DATFDT                          WATFDT
     I              DATGDT                          WATGDT
     I              DAWIT1                          WAWIT1
     I              DAQYNY                          WAQYNY
     I              DAL7T1                          WAL7T1
     I              DAR8NY                          WAR8NY
     I              DAR0NY                          WAR0NY
     I              DAI7AA                          WAI7AA
     I              DAMXAA                          WAMXAA
     I              DAMSAA                          WAMSAA
     I              DAR7NY                          WAR7NY
     I              DAHEPR                          WAHEPR
     I              DAHFPR                          WAHFPR
     I              DAWVT1                          WAWVT1
     I              DAW0T1                          WAW0T1
     I              DAR5NY                          WAR5NY
     I              DAW1T1                          WAW1T1
     I              DAR6NY                          WAR6NY
     I              DAJ1ST                          WAJ1ST
     I              DAKHST                          WAKHST
     I              DATWDT                          WATWDT
     I              DADUTM                          WADUTM
     I              DAKGST                          WAKGST
     I              DATVDT                          WATVDT
     I              DADTTM                          WADTTM
     I              DAR9NY                          WAR9NY
     I              DASQNY                          WASQNY
     I              DABHR3                          WABHR3
     I              DASRNY                          WASRNY
     I              DAW7T1                          WAW7T1
     I              DAW8T1                          WAW8T1
     I              DAT2DT                          WAT2DT
     I              DASXNY                          WASXNY
     I              DASYNY                          WASYNY
     I              DASZNY                          WASZNY
     I              DAVSST                          WAVSST
     I              DAMJDT                          WAMJDT
     I              DABETM                          WABETM
     I              DACCVN                          WACCVN
     I              DACDVN                          WACDVN
     I              DAMKDT                          WAMKDT
     I              DABFTM                          WABFTM
     I              DACEVN                          WACEVN
     I              DACFVN                          WACFVN
      *
     I@DQCPR6
      * RFS RIN Transaction Rpt   Update index
      * Renamed input format fields
     I              DQNWT1                          WBNWT1
     I              DQLTTX                          WBLTTX
     I              DQLUTX                          WBLUTX
     I              DQNXT1                          WBNXT1
     I              DQNYT1                          WBNYT1
     I              DQI4AA                          WBI4AA
     I              DQNZT1                          WBNZT1
     I              DQLVTX                          WBLVTX
     I              DQI5AA                          WBI5AA
     I              DQI7AA                          WBI7AA
     I              DQLWTX                          WBLWTX
     I              DQN2T1                          WBN2T1
     I              DQN3T1                          WBN3T1
     I              DQN4T1                          WBN4T1
     I              DQN5T1                          WBN5T1
      *
     I@CCCPOH
      * COA Batch Header          Retrieval index
      * Renamed input format fields
     I              CCAIC3                          WCAIC3
     I              CCL6T1                          WCL6T1
     I              CCI3NY                          WCI3NY
     I              CCIKAA                          WCIKAA
     I              CCIDAA                          WCIDAA
     I              CCRFDT                          WCRFDT
     I              CCC2TM                          WCC2TM
     I              CCMHT1                          WCMHT1
     I              CCRGDT                          WCRGDT
     I              CCC3TM                          WCC3TM
     I              CCMKT1                          WCMKT1
     I              CCJHNY                          WCJHNY
     I              CCR1NA                          WCR1NA
     I              CCRHDT                          WCRHDT
     I              CCC4TM                          WCC4TM
     I              CCMIT1                          WCMIT1
     I              CCMJT1                          WCMJT1
     I              CCHXTX                          WCHXTX
     I              CCHJTX                          WCHJTX
     I              CCHYTX                          WCHYTX
     I              CCJENY                          WCJENY
     I              CCJVNY                          WCJVNY
     I              CCJWNY                          WCJWNY
     I              CCIMTX                          WCIMTX
     I              CCFEDS                          WCFEDS
     I              CCMTT1                          WCMTT1
     I              CCJXNY                          WCJXNY
     I              CCJ1NY                          WCJ1NY
     I              CCJCNY                          WCJCNY
     I              CCJDNY                          WCJDNY
     I              CCJ3NY                          WCJ3NY
     I              CCRLDT                          WCRLDT
     I              CCMSAA                          WCMSAA
     I              CCMTAA                          WCMTAA
     I              CCMUAA                          WCMUAA
     I              CCL8T1                          WCL8T1
     I              CCR0NY                          WCR0NY
     I              CCL7T1                          WCL7T1
     I              CCJQST                          WCJQST
     I              CCWUT1                          WCWUT1
     I              CCWVT1                          WCWVT1
     I              CCJZST                          WCJZST
     I              CCJ0ST                          WCJ0ST
     I              CCTTDT                          WCTTDT
     I              CCDRTM                          WCDRTM
     I              CCWYT1                          WCWYT1
     I              CCJUST                          WCJUST
     I              CCR4NY                          WCR4NY
     I              CCMZAA                          WCMZAA
     I              CCTUDT                          WCTUDT
     I              CCDSTM                          WCDSTM
     I              CCWZT1                          WCWZT1
     I              CCM0AA                          WCM0AA
     I              CCSANY                          WCSANY
     I              CCKJST                          WCKJST
     I              CCKKST                          WCKKST
     I              CCGZPC                          WCGZPC
     I              CCW2T1                          WCW2T1
     I              CCM1AA                          WCM1AA
     I              CCSBNY                          WCSBNY
     I              CCKLST                          WCKLST
     I              CCKPST                          WCKPST
     I              CCG0PC                          WCG0PC
     I              CCW3T1                          WCW3T1
     I              CCM2AA                          WCM2AA
     I              CCSCNY                          WCSCNY
     I              CCKQST                          WCKQST
     I              CCKRST                          WCKRST
     I              CCG1PC                          WCG1PC
     I              CCW4T1                          WCW4T1
     I              CCVSST                          WCVSST
     I              CCMJDT                          WCMJDT
     I              CCBETM                          WCBETM
     I              CCCCVN                          WCCCVN
     I              CCCDVN                          WCCDVN
     I              CCMKDT                          WCMKDT
     I              CCBFTM                          WCBFTM
     I              CCCEVN                          WCCEVN
     I              CCCFVN                          WCCFVN
      *
     I@CAREOB
      * COA Property Define Hdr   Retrieval index
      * Renamed input format fields
     I              CAAIC3                          WDAIC3
     I              CAIDAA                          WDIDAA
     I              CAR2NA                          WDR2NA
     I              CAL2T1                          WDL2T1
     I              CAL3T1                          WDL3T1
     I              CAL4T1                          WDL4T1
     I              CAL5T1                          WDL5T1
     I              CAL6T1                          WDL6T1
     I              CAL7T1                          WDL7T1
     I              CAL8T1                          WDL8T1
     I              CAL9T1                          WDL9T1
     I              CAMAT1                          WDMAT1
     I              CAJCNY                          WDJCNY
     I              CAJDNY                          WDJDNY
     I              CAJENY                          WDJENY
     I              CAJFNY                          WDJFNY
     I              CAGMPC                          WDGMPC
     I              CAMBT1                          WDMBT1
     I              CAIEAA                          WDIEAA
     I              CAIFAA                          WDIFAA
     I              CAIGAA                          WDIGAA
     I              CAIHAA                          WDIHAA
     I              CAIIAA                          WDIIAA
     I              CAIJAA                          WDIJAA
     I              CAJQNY                          WDJQNY
     I              CALXST                          WDLXST
     I              CAJRNY                          WDJRNY
     I              CALYST                          WDLYST
     I              CAIMTX                          WDIMTX
     I              CAFEDS                          WDFEDS
     I              CAIBAA                          WDIBAA
     I              CAI1NY                          WDI1NY
     I              CAHCTU                          WDHCTU
     I              CAMCT1                          WDMCT1
     I              CAVSST                          WDVSST
     I              CAMJDT                          WDMJDT
     I              CABETM                          WDBETM
     I              CACCVN                          WDCCVN
     I              CACDVN                          WDCDVN
     I              CAMKDT                          WDMKDT
     I              CABFTM                          WDBFTM
     I              CACEVN                          WDCEVN
     I              CACFVN                          WDCFVN
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WFBKC7
     I              BBAYTX                          WFAYTX
     I              BBACNA                          WFACNA
     I              BBADNA                          WFADNA
     I              BBAENA                          WFAENA
     I              BBAJNA                          WFAJNA
     I              BBBGCD                          WFBGCD
     I              BBG5CD                          WFG5CD
     I              BBBTTX                          WFBTTX
     I              BBBVTX                          WFBVTX
     I              BBBWTX                          WFBWTX
     I              BBABTX                          WFABTX
     I              BBA2NA                          WFA2NA
     I              BBCBST                          WFCBST
     I              BBB0NA                          WFB0NA
     I              BBP3NB                          WFP3NB
     I              BBAXNA                          WFAXNA
     I              BBI6DT                          WFI6DT
     I              BBAYDT                          WFAYDT
     I              BBANC7                          WFANC7
     I              BBBTC7                          WFBTC7
     I              BBK6ST                          WFK6ST
     I              BBUZST                          WFUZST
     I              BBKXCD                          WFKXCD
     I              BBLTCD                          WFLTCD
     I              BBQNST                          WFQNST
     I              BBS2NB                          WFS2NB
     I              BBVHVA                          WFVHVA
     I              BBI7DT                          WFI7DT
     I              BBRJST                          WFRJST
     I              BBRKST                          WFRKST
     I              BBQWST                          WFQWST
     I              BBQXST                          WFQXST
     I              BBQYST                          WFQYST
     I              BBUNCS                          WFUNCS
     I              BBUVST                          WFUVST
     I              BBUWST                          WFUWST
     I              BBUXST                          WFUXST
     I              BBVSST                          WFVSST
     I              BBAATM                          WFAATM
     I              BBAYNA                          WFAYNA
     I              BBA0NA                          WFA0NA
     I              BBAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
     IQPMDQ1    E DSPMDQCPL0
      * UPD : RFS RIN Transaction Rpt   Update index
      * Renamed input format fields
     I              DQNWT1                          WBNWT1
     I              DQLTTX                          WBLTTX
     I              DQLUTX                          WBLUTX
     I              DQNXT1                          WBNXT1
     I              DQNYT1                          WBNYT1
     I              DQI4AA                          WBI4AA
     I              DQNZT1                          WBNZT1
     I              DQLVTX                          WBLVTX
     I              DQI5AA                          WBI5AA
     I              DQI7AA                          WBI7AA
     I              DQLWTX                          WBLWTX
     I              DQN2T1                          WBN2T1
     I              DQN3T1                          WBN3T1
     I              DQN4T1                          WBN4T1
     I              DQN5T1                          WBN5T1
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * FLD: RFS RIN Transaction Rpt
      * N :  RFS Report Form ID
     I                                        1   7 P2NWT1
      * I :  RFS Report Type
     I                                        8   8 P2LTTX
      * N :  RFS CBI
     I                                        9   9 P2LUTX
      * N :  RFS Report Date
     I                                       10  19 P2NXT1
      * I :  RFS Report Year
     I                                       20  23 P2NYT1
      * O :  RFS Company ID
     I                                       24  27 P2I4AA
      * I :  RFS Compliance Period
     I                                       28  29 P2LVTX
     IP3PARM      DS
      * N :  Date From             USR
     I                                    P   1   40P3JEDT
     IP4PARM      DS
      * N :  Date To               USR
     I                                    P   1   40P4JFDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2LTTX    PARM           WP0002  1        RFS Report Type
     C           P2NYT1    PARM           WP0003  4        RFS Report Year
     C           P2I4AA    PARM P2I4AA    WP0004  4        RFS Company ID
     C           P2LVTX    PARM           WP0005  2        RFS Compliance
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Crt RIN Trans Rpt XF
      * E921 09/28/2010 EPA RFS2 Modifications -- Report RFS0200 is now R
      *    and reports only transactions made with RFS1 RINS during the Q
      * F1110 - EPA Quarterly Reporting -- Report RFS0200
      *      RFS RIN Transaction Report - send quarterly to the EPA
      * Q1 =  Jan - Mar (Due May 31)         Q2 = Apr - Jun (Due Aug 31)
      * Q3 =  Jul - Sep (Due Nov 30)         Q4 = Oct - Dec (Due Feb 28)
      * Set field values that wont change per batch:
     C                     MOVEL@CN,001   P2NWT1           RFS Report Form
     C                     MOVEL'N'       P2LUTX           RFS CBI
      * Format report date: MM/DD/YYYY
      *
     C                     MOVEL*BLANK    WN0001  7        Date 7A
      *
      * Clc Fmt Dt MM/DD/YYYY IF
      * Format input date as : MM/DD/YYYY
     C                     MOVEL*BLANK    WN0001           Date 7A
     C                     MOVEL##JDT     WN0001           Date 7A
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0001:ZQ WUT5TX    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0001:ZQ WUT8TX    P  90  Day (Alpha) USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * WRK.Year Code = PAR.Date In *YEAR
     C           ##JDT     ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
     C                     MOVELWUAYNX    WUNYTX           Year USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  '/':ZQ    WUN0TX    P      Month MM/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT8TX    CAT  '/':ZQ    WUN1TX    P      Day DD/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUN0TX    CAT  WUN1TX:ZQ WUN2TX    P      Month/Day MM/DD
     C                     Z-ADD*ZERO     ZQ      50
     C           WUN2TX    CAT  WUNYTX:ZQ P2NXT1    P      MMDDYYYY Usr
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP2NYT1:ZQ WUUATX    P  90  Year Alpha (YY)
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WUUATX:ZQ WUMLT1    P      Text 3 Length U
      * Set Compliance From and To Dates
      * CASE: PAR.RFS Compliance Period is Quarter 1 (Jan-Mar)
     C           P2LVTX    IFEQ 'Q1'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0101':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0331':ZQ WUV6CD    P      Date To Alpha
     C                     ELSE
      * CASE: PAR.RFS Compliance Period is Quarter 2 (Apr-Jun)
     C           P2LVTX    IFEQ 'Q2'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0401':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0630':ZQ WUV6CD    P      Date To Alpha
     C                     ELSE
      * CASE: PAR.RFS Compliance Period is Quarter 3 (Jly-Sep)
     C           P2LVTX    IFEQ 'Q3'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0701':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0930':ZQ WUV6CD    P      Date To Alpha
     C                     ELSE
      * CASE: PAR.RFS Compliance Period is Quarter 4 (Oct-Dec)
     C           P2LVTX    IFEQ 'Q4'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '1001':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '1231':ZQ WUV6CD    P      Date To Alpha
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVE WUV5CD    P3JEDT           Date From
     C                     MOVE WUV6CD    P4JFDT           Date To
      * Read COA Batch Header RIN file and create records - Lf selects rf
      * RTV Crt RFS RIN Trn FL RT - COA Batch Header RIN  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Crt RFS RIN Trn FL RT - COA Batch Header RIN  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  3        RFS Transaction
     C                     MOVEL*BLANK    WN0003  3        RFS Retired RIN
     C                     MOVEL*BLANK    WN0004 10        RFS Transaction
     C                     MOVEL*BLANK    WN0005  1        Break
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S00923 RMC 8/27/09 Use diff logical to get the seq nos. right
     C                     MOVEL'N'       YL0001           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@DACPCY                    *
     C           KRSSA     READE@DACPCY                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Force Break if Retired RIN
      * CASE: DB1.COA Retired RIN Reason Cd is *Blank
     C           WARINT    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WN0005           Break
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0005           Break
     C                     END                             *FI
      * Create 1 record for each batch/trans date/partner/sequential RINS
      * Break in Batch No or Trans Date or RET RIN Write Record
      * CASE:
      *  - c1ORc2ORc3ORc4ORc6ORc5ORc7
      *   |- c1    : DB1.COA Batch Number NE LCL.COA Batch Number
      *   |- c2    : DB1.COA RIN Transaction Date NE LCL.COA RIN Transact
      *   |- c3    : DB1.COA Retired RIN Reason Cd NE LCL.COA Retired RIN
      *   |- c4    : DB1.COA RIN Trans Partner Id NE LCL.COA RIN Trans Pa
      *   |- c6    : DB1.COA RIN SSSSSSSS NE LCL.Last COA RIN EEEEEEEE us
      *   |- c5    : PAR.Break is Yes
      *   |- c7    : DB1.COA ULSD Company # NE LCL.ULSD Comp ship to #
      *   '-
     C           WAI3NY    IFNE YL0002                     *IF
     C           WARIDT    ORNE YL0003                     *OR
     C           WARINT    ORNE YL0004                     *OR
     C           WAMWT1    ORNE YL0005                     *OR
     C           WAJZNY    ORNE YL0006                     *OR
     C           WN0005    OREQ 'Y'                        *OR
     C           WAL6T1    ORNE YL0007                     *OR
      * Write RCD if not 1st time and for every RET record
      * CASE: LCL.COA Batch Number is Not zero
     C           YL0002    IFNE *ZERO                      *IF
      * *Move-Right - /UT User Source  * 
     C                     MOVE YL0009    YL0008
      * ----------- Write 1 rcd per seq of RINs  -----------------
      * Crt RFS RIN Trans Rpt CR - RFS RIN Transaction Rpt  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2NWT1    WL0001    P      RFS Report Form
     C                     MOVELP2LTTX    WL0002    P      RFS Report Type
     C                     MOVELP2LUTX    WL0003    P      RFS CBI
     C                     MOVELP2NXT1    WL0004    P      RFS Report Date
     C                     MOVELP2NYT1    WL0005    P      RFS Report Year
     C                     MOVELYL0010    WL0006    P      RFS Company ID
     C                     MOVELYL0011    WL0007    P      RFS Company Nam
     C                     MOVELP2LVTX    WL0008    P      RFS Compliance
     C                     MOVELYL0012    WL0009    P      RFS Compliance
     C                     MOVELWN0002    WL0010    P      RFS Transaction
     C                     MOVELWN0003    WL0011    P      RFS Retired RIN
     C                     MOVELWN0004    WL0012    P      RFS Transaction
     C                     MOVELYL0013    WL0013    P      RFS Trans Partn
     C                     MOVELYL0005    WL0014    P      RFS Trans Partn
     C                     MOVELYL0008    WL0015    P      RFS RIN
     C                     EXSR SBCRRC
     C                     MOVEL'Y'       YL0001           Record Found US
     C                     MOVEL'Y'       YL0014           Status - Y or N
     C                     END                             *FI
      * If date in range- setup record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.COA RIN Transaction Date GE PAR.Date From
      *   |- c2    : DB1.COA RIN Transaction Date LE PAR.Date To
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WARIDT    IFGE P3JEDT                     *IF
     C           WARIDT    IFLE P4JFDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Fuel Code f/Batch  RT - COA Batch Header  * 
     C                     EXSR SCRVGN
      * RTV for RFS EPA Rpts  RT - COA Property Define Hdr  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0016           Company Number
     C                     MOVELYL0015    WL0017    P      COA Bio-diesel
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0018    YL0016    P      COA Bio-dsl Fue
     C                     MOVELWL0019    YL0017    P      COA Producer Re
     C                     MOVELWL0020    YL0018    P      COA Employer ID
     C                     MOVELWL0021    YL0011    P      COA Sold From N
     C                     MOVELWL0022    YL0010    P      COA ULSD Compan
     C                     MOVELWL0023    YL0012    P      COA ULSD Facili
     C                     MOVELWL0024    YL0019    P      COA RIN Equival
     C                     MOVELWL0025    YL0020    P      COA RIN Renewab
     C                     MOVELWL0026    YL0021    P      COA RIN Type Fl
     C                     Z-ADDWL0027    YL0022           COA Density Loa
     C                     Z-ADDWL0028    YL0023           COA BOL Percent
     C                     MOVELWL0029    YL0024    P      COA RFS Renew F
     C                     MOVELWL0030    YL0025    P      COA RFS Rnwbl F
      * Format Tran date as MM/DD/YYYY
      *
     C                     MOVEL*BLANK    WN0006  7        Date 7A
      *
      * Clc Fmt Dt MM/DD/YYYY IF
      * Format input date as : MM/DD/YYYY
     C                     MOVEL*BLANK    WN0006           Date 7A
     C                     MOVELWARIDT    WN0006           Date 7A
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0006:ZQ WUT5TX    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0006:ZQ WUT8TX    P  90  Day (Alpha) USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * WRK.Year Code = PAR.Date In *YEAR
     C           WARIDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
     C                     MOVELWUAYNX    WUNYTX           Year USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  '/':ZQ    WUN0TX    P      Month MM/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT8TX    CAT  '/':ZQ    WUN1TX    P      Day DD/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUN0TX    CAT  WUN1TX:ZQ WUN2TX    P      Month/Day MM/DD
     C                     Z-ADD*ZERO     ZQ      50
     C           WUN2TX    CAT  WUNYTX:ZQ WN0004    P      MMDDYYYY Usr
      * CASE: LCL.COA ULSD Facility # is Blanks
     C           YL0012    IFEQ *BLANK                     *IF
     C                     MOVEL'NOTOP'   YL0012           COA ULSD Facili
     C                     END                             *FI
     C                     Z-ADDWAI3NY    YL0002           COA Batch Numbe
     C                     Z-ADDWARIDT    YL0003           COA RIN Transac
     C                     MOVELWAMWT1    YL0005           COA RIN Trans P
     C                     MOVELWARINT    YL0004           COA Retired RIN
     C                     MOVELWAI7AA    WN0002           RFS Transaction
     C                     MOVELWAMUT1    YL0008           COA Batch Heade
     C                     MOVELWAL6T1    YL0007           ULSD Comp ship
     C                     MOVEL'N'       YL0014           Status - Y or N
     C                     MOVELWAMVT1    YL0013           COA RIN Trans P
      * Trans Partner Name & Ret Rin Reason
      * CASE: DB1.COA Retired RIN Reason Cd is *Blank
     C           WARINT    IFEQ *BLANK                     *IF
      * CASE: DB1.Order Number is Greater then zero
     C           WAC4NB    IFGT *ZERO                      *IF
      * we want the trans partner name to be the same per parent cust#.
      * Rtv Customer Number    RT - Order Header TRG  * 
     C                     EXSR SERVGN
      * RTV Parent Customer    RT - Customer  * 
     C                     EXSR SFRVGN
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SGRVGN
      * CASE: LCL.Customer Name is Not Blank
     C           YL0028    IFNE *BLANK                     *IF
     C                     MOVELYL0028    YL0013           COA RIN Trans P
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    WN0003           RFS Retired RIN
     C                     MOVEL'NA'      WN0003           RFS Retired RIN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0004    WN0003           RFS Retired RIN
      * 6/26/09 output NA here per instructions sent 6/25/09
     C                     MOVEL*BLANK    YL0013           COA RIN Trans P
     C                     MOVEL'NA'      YL0013           COA RIN Trans P
     C                     MOVEL*BLANK    YL0005           COA RIN Trans P
     C                     MOVEL'NA'      YL0005           COA RIN Trans P
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       WN0005           Break
     C                     END                             *FI
      * If date in range- get RIN EEEEEEEE number
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.COA RIN Transaction Date GE PAR.Date From
      *   |- c2    : DB1.COA RIN Transaction Date LE PAR.Date To
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WARIDT    IFGE P3JEDT                     *IF
     C           WARIDT    IFLE P4JFDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWAJ0NY    YL0009           COA RIN EEEEEEE
     C           WAJ0NY    ADD  1         YL0006           Last COA RIN EE
     C                     END                             *FI
     C           KRSSA     READE@DACPCY                  90*
     C                     ENDDO
      * USER: Exit processing
      * Write blank record if none are found / or write last rcd
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0001    IFEQ 'N'                        *IF
      * RTV for RFS EPA Rpts  RT - COA Property Define Hdr  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0016           Company Number
     C                     MOVEL'B99.9'   WL0017    P      COA Bio-diesel
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0018    YL0016    P      COA Bio-dsl Fue
     C                     MOVELWL0019    YL0017    P      COA Producer Re
     C                     MOVELWL0020    YL0018    P      COA Employer ID
     C                     MOVELWL0021    YL0011    P      COA Sold From N
     C                     MOVELWL0022    YL0010    P      COA ULSD Compan
     C                     MOVELWL0023    YL0012    P      COA ULSD Facili
     C                     MOVELWL0024    YL0019    P      COA RIN Equival
     C                     MOVELWL0025    YL0020    P      COA RIN Renewab
     C                     MOVELWL0026    YL0021    P      COA RIN Type Fl
     C                     Z-ADDWL0027    YL0022           COA Density Loa
     C                     Z-ADDWL0028    YL0023           COA BOL Percent
     C                     MOVELWL0029    YL0024    P      COA RFS Renew F
     C                     MOVELWL0030    YL0025    P      COA RFS Rnwbl F
      * ----------- Write 1 blank RIN Rcd ----------------
      * Crt RFS RIN Trans Rpt CR - RFS RIN Transaction Rpt  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2NWT1    WL0001    P      RFS Report Form
     C                     MOVELP2LTTX    WL0002    P      RFS Report Type
     C                     MOVELP2LUTX    WL0003    P      RFS CBI
     C                     MOVELP2NXT1    WL0004    P      RFS Report Date
     C                     MOVELP2NYT1    WL0005    P      RFS Report Year
     C                     MOVELYL0010    WL0006    P      RFS Company ID
     C                     MOVELYL0011    WL0007    P      RFS Company Nam
     C                     MOVELP2LVTX    WL0008    P      RFS Compliance
     C                     MOVELYL0012    WL0009    P      RFS Compliance
     C                     MOVELWUOTTX    WL0010    P      RFS Transaction
     C                     MOVEL'NA'      WL0011    P      RFS Retired RIN
     C                     MOVEL*BLANK    WL0012           RFS Transaction
     C                     MOVEL*BLANK    WL0013           RFS Trans Partn
     C                     MOVEL*BLANK    WL0014           RFS Trans Partn
     C                     MOVEL*BLANK    WL0015           RFS RIN
     C                     EXSR SBCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Write Last RCD if it wasnt written
      * CASE: LCL.Status - Y or N is no
     C           YL0014    IFEQ 'N'                        *IF
      * *Move-Right - /UT User Source  * 
     C                     MOVE YL0009    YL0008
      * Crt RFS RIN Trans Rpt CR - RFS RIN Transaction Rpt  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2NWT1    WL0001    P      RFS Report Form
     C                     MOVELP2LTTX    WL0002    P      RFS Report Type
     C                     MOVELP2LUTX    WL0003    P      RFS CBI
     C                     MOVELP2NXT1    WL0004    P      RFS Report Date
     C                     MOVELP2NYT1    WL0005    P      RFS Report Year
     C                     MOVELYL0010    WL0006    P      RFS Company ID
     C                     MOVELYL0011    WL0007    P      RFS Company Nam
     C                     MOVELP2LVTX    WL0008    P      RFS Compliance
     C                     MOVELYL0012    WL0009    P      RFS Compliance
     C                     MOVELWN0002    WL0010    P      RFS Transaction
     C                     MOVELWN0003    WL0011    P      RFS Retired RIN
     C                     MOVELWN0004    WL0012    P      RFS Transaction
     C                     MOVELYL0013    WL0013    P      RFS Trans Partn
     C                     MOVELYL0005    WL0014    P      RFS Trans Partn
     C                     MOVELYL0008    WL0015    P      RFS RIN
     C                     EXSR SBCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELYL0010    P2I4AA           RFS Company ID
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt RFS RIN Trans Rpt CR - RFS RIN Transaction Rpt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DQCPR6
     C                     MOVELWL0001    WBNWT1           RFS Report Form
     C                     MOVELWL0002    WBLTTX           RFS Report Type
     C                     MOVELWL0003    WBLUTX           RFS CBI
     C                     MOVELWL0004    WBNXT1           RFS Report Date
     C                     MOVELWL0005    WBNYT1           RFS Report Year
     C                     MOVELWL0006    WBI4AA           RFS Company ID
     C                     MOVELWL0007    WBNZT1           RFS Company Nam
     C                     MOVELWL0008    WBLVTX           RFS Compliance
     C                     MOVELWL0009    WBI5AA           RFS Compliance
     C                     MOVELWL0010    WBI7AA           RFS Transaction
     C                     MOVELWL0011    WBLWTX           RFS Retired RIN
     C                     MOVELWL0012    WBN2T1           RFS Transaction
     C                     MOVELWL0013    WBN3T1           RFS Trans Partn
     C                     MOVELWL0014    WBN4T1           RFS Trans Partn
     C                     MOVELWL0015    WBN5T1           RFS RIN
      *
     C           KLCRSB    KLIST
     C                     KFLD           WBNWT1           RFS Report Form
     C                     KFLD           WBLTTX           RFS Report Type
     C                     KFLD           WBLUTX           RFS CBI
     C                     KFLD           WBNXT1           RFS Report Date
     C                     KFLD           WBNYT1           RFS Report Year
     C                     KFLD           WBI4AA           RFS Company ID
     C                     KFLD           WBNZT1           RFS Company Nam
     C                     KFLD           WBLVTX           RFS Compliance
     C                     KFLD           WBI5AA           RFS Compliance
     C                     KFLD           WBI7AA           RFS Transaction
     C                     KFLD           WBLWTX           RFS Retired RIN
     C                     KFLD           WBN2T1           RFS Transaction
     C                     KFLD           WBN3T1           RFS Trans Partn
     C                     KFLD           WBN4T1           RFS Trans Partn
     C                     KFLD           WBN5T1           RFS RIN
      * Check for duplicate primary key
     C           KLCRSB    SETLL@DQCPR6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3918' W0RTN   7
      * Send message 'RFS RIN Transaction Rp EX'
     C                     MOVEL'USR3918' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@DQCPR6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Fuel Code f/Batch  RT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCL6T1           COA ULSD Compan
     C                     KFLD           WCI3NY           COA Batch Numbe
      * Setup key
     C                     Z-ADDWAAIC3    WCAIC3           Company Number
     C                     MOVELWAL6T1    WCL6T1           COA ULSD Compan
     C                     Z-ADDWAI3NY    WCI3NY           COA Batch Numbe
      * Establish starting position
     C           KRSSC     CHAIN@CCCPOH              90    *
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCIDAA    YL0015           COA Bio-diesel
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV for RFS EPA Rpts  RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0018           COA Bio-dsl Fue
     C                     MOVEL*BLANK    WL0019           COA Producer Re
     C                     MOVEL*BLANK    WL0020           COA Employer ID
     C                     MOVEL*BLANK    WL0021           COA Sold From N
     C                     MOVEL*BLANK    WL0022           COA ULSD Compan
     C                     MOVEL*BLANK    WL0023           COA ULSD Facili
     C                     MOVEL*BLANK    WL0024           COA RIN Equival
     C                     MOVEL*BLANK    WL0025           COA RIN Renewab
     C                     MOVEL*BLANK    WL0026           COA RIN Type Fl
     C                     Z-ADD*ZERO     WL0027           COA Density Loa
     C                     Z-ADD*ZERO     WL0028           COA BOL Percent
     C                     MOVEL*BLANK    WL0029           COA RFS Renew F
     C                     MOVEL*BLANK    WL0030           COA RFS Rnwbl F
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDIDAA           COA Bio-diesel
      * Setup key
     C                     Z-ADDWL0016    WDAIC3           Company Number
     C                     MOVELWL0017    WDIDAA           COA Bio-diesel
      * Establish starting position
     C           KRSSD     CHAIN@CAREOB              90    *
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDR2NA    WL0018           COA Bio-dsl Fue
     C                     MOVELWDL2T1    WL0019           COA Producer Re
     C                     MOVELWDL3T1    WL0020           COA Employer ID
     C                     MOVELWDL5T1    WL0021           COA Sold From N
     C                     MOVELWDL6T1    WL0022           COA ULSD Compan
     C                     MOVELWDL7T1    WL0023           COA ULSD Facili
     C                     MOVELWDL8T1    WL0024           COA RIN Equival
     C                     MOVELWDL9T1    WL0025           COA RIN Renewab
     C                     MOVELWDMAT1    WL0026           COA RIN Type Fl
     C                     Z-ADDWDJCNY    WL0027           COA Density Loa
     C                     Z-ADDWDGMPC    WL0028           COA BOL Percent
     C                     MOVELWDIMTX    WL0029           COA RFS Renew F
     C                     MOVELWDFEDS    WL0030           COA RFS Rnwbl F
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Customer Number    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WEAIC3           Company Number
     C                     Z-ADDWAC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0026           Ship To Custome
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBKC7    YL0026           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Parent Customer    RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDYL0026    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFBTC7    YL0027           Parent Customer
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDYL0027    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0028           Customer Name
     C                     MOVEL@CN,003   W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAYTX    YL0028           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2NWT1           RFS Report Form
     C                     MOVEL*BLANK    P2LUTX           RFS CBI
     C                     MOVEL*BLANK    P2NXT1           RFS Report Date
     C                     Z-ADD*ZERO     P3JEDT           Date From
     C                     Z-ADD*ZERO     P4JFDT           Date To
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Month (Char) USR
     C                     MOVEL*BLANK    WUT5TX  2
      * Define work field Day (Alpha) USR
     C                     MOVEL*BLANK    WUT8TX  2
      * Define work field Year Code
     C                     Z-ADD*ZERO     WUAYNX  40
      * Define work field Year USR
     C                     MOVEL*BLANK    WUNYTX  4
      * Define work field Month MM/  3A
     C                     MOVEL*BLANK    WUN0TX  3
      * Define work field Day DD/  3A
     C                     MOVEL*BLANK    WUN1TX  3
      * Define work field Month/Day MM/DD/
     C                     MOVEL*BLANK    WUN2TX  6
      * Define work field Year Alpha (YY) USR
     C                     MOVEL*BLANK    WUUATX  2
      * Define work field Text 3 Length USR
     C                     MOVEL*BLANK    WUMLT1  3
      * Define work field Date From Alpha       USR
     C                     MOVEL*BLANK    WUV5CD  7
      * Define work field Date To Alpha         USR
     C                     MOVEL*BLANK    WUV6CD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WAJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WAQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WAJZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WAJ0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WAJ2NY           COA RIN Volume
     C                     Z-ADD*ZERO     WARIDT           COA RIN Transac
     C                     Z-ADD*ZERO     WAC5TM           COA RIN Transac
     C                     Z-ADD*ZERO     WARJDT           COA Retired RIN
     C                     Z-ADD*ZERO     WAC6TM           COA Retired RIN
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WARZNB           Case Sequence N
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARKDT           COA Date of 1st
     C                     Z-ADD*ZERO     WAC7TM           COA RIN Unused
     C                     Z-ADD*ZERO     WAQWNY           COA RIN Gallons
     C                     Z-ADD*ZERO     WACWC3           COA Shipping Co
     C                     Z-ADD*ZERO     WAQXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     WAQZNY           COA Reference B
     C                     Z-ADD*ZERO     WAQ0NY           COA Reference B
     C                     Z-ADD*ZERO     WATFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     WATGDT           COA BHR Unused
     C                     Z-ADD*ZERO     WAQYNY           COA BHR Loadout
     C                     Z-ADD*ZERO     WAR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     WAR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WAR7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WAHEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     WAHFPR           COA BHR Gallon
     C                     Z-ADD*ZERO     WAR5NY           COA RIN Support
     C                     Z-ADD*ZERO     WAR6NY           COA RIN Support
     C                     Z-ADD*ZERO     WATWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     WADUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     WATVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     WADTTM           COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WAR9NY           COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WASQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     WASRNY           COA BHR Unused
     C                     Z-ADD*ZERO     WAT2DT           COA BHR Unused
     C                     Z-ADD*ZERO     WASXNY           COA BHR Equiv V
     C                     Z-ADD*ZERO     WASYNY           COA BHR RINs to
     C                     Z-ADD*ZERO     WASZNY           COA BHR Unused
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WCRFDT           COA Date Open f
     C                     Z-ADD*ZERO     WCC2TM           COA Time Open f
     C                     Z-ADD*ZERO     WCRGDT           COA Date Close
     C                     Z-ADD*ZERO     WCC3TM           COA Time Close
     C                     Z-ADD*ZERO     WCJHNY           COA Gallons Use
     C                     Z-ADD*ZERO     WCRHDT           COA Batch Produ
     C                     Z-ADD*ZERO     WCC4TM           COA Batch Unuse
     C                     Z-ADD*ZERO     WCJENY           COA Temperature
     C                     Z-ADD*ZERO     WCJVNY           COA Batch Volum
     C                     Z-ADD*ZERO     WCJWNY           COA Batch Denat
     C                     Z-ADD*ZERO     WCJXNY           COA Batch Expor
     C                     Z-ADD*ZERO     WCJ1NY           COA Last RIN EE
     C                     Z-ADD*ZERO     WCJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WCJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WCJ3NY           COA RIN Equival
     C                     Z-ADD*ZERO     WCRLDT           COA Batch Unuse
     C                     Z-ADD*ZERO     WCR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WCTTDT           COA BH EMTS Dat
     C                     Z-ADD*ZERO     WCDRTM           COA BH EMTS Tim
     C                     Z-ADD*ZERO     WCR4NY           COA BH Unused N
     C                     Z-ADD*ZERO     WCTUDT           COA BH Unused D
     C                     Z-ADD*ZERO     WCDSTM           COA BH Unused T
     C                     Z-ADD*ZERO     WCSANY           COA BH Feedstck
     C                     Z-ADD*ZERO     WCGZPC           COA BH Feedstck
     C                     Z-ADD*ZERO     WCSBNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WCG0PC           COA BH Feedstck
     C                     Z-ADD*ZERO     WCSCNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WCG1PC           cOA BH Feedstck
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WDJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WDJENY           COA Temperature
     C                     Z-ADD*ZERO     WDJFNY           COA Temperature
     C                     Z-ADD*ZERO     WDGMPC           COA BOL Percent
     C                     Z-ADD*ZERO     WDJQNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WDJRNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WDI1NY           Sold To Custome
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A/R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Unused Date
     C                     Z-ADD*ZERO     WENPDT           OH Unused Date
     C                     Z-ADD*ZERO     WENQDT           OH Unused Date
     C                     Z-ADD*ZERO     WENRDT           OH Unused Date
     C                     Z-ADD*ZERO     WENSDT           OH Unused Date
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           Time of Origina
     C                     Z-ADD*ZERO     WEBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WEH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WEH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WEH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WEH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WEH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFP3NB           D & B Number
     C                     Z-ADD*ZERO     WFI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WFAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFBTC7           Parent Customer
     C                     Z-ADD*ZERO     WFS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WFVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WFI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBCRRC.
     C                     MOVEL*BLANK    WL0001  7
     C                     MOVEL*BLANK    WL0002  1
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004 10
     C                     MOVEL*BLANK    WL0005  4
     C                     MOVEL*BLANK    WL0006  4
     C                     MOVEL*BLANK    WL0007 40
     C                     MOVEL*BLANK    WL0008  2
     C                     MOVEL*BLANK    WL0009  5
     C                     MOVEL*BLANK    WL0010  3
     C                     MOVEL*BLANK    WL0011  3
     C                     MOVEL*BLANK    WL0012 10
     C                     MOVEL*BLANK    WL0013 30
     C                     MOVEL*BLANK    WL0014  4
     C                     MOVEL*BLANK    WL0015 38
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0016  30
     C                     MOVEL*BLANK    WL0017  6
     C                     MOVEL*BLANK    WL0018 30
     C                     MOVEL*BLANK    WL0019 25
     C                     MOVEL*BLANK    WL0020 20
     C                     MOVEL*BLANK    WL0021 40
     C                     MOVEL*BLANK    WL0022  4
     C                     MOVEL*BLANK    WL0023  5
     C                     MOVEL*BLANK    WL0024  2
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     Z-ADD*ZERO     WL0027  75
     C                     Z-ADD*ZERO     WL0028  41
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  3
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field COA Batch Number
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field COA RIN Transaction Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field COA Retired RIN Reason Cd
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field COA RIN Trans Partner Id
     C                     MOVEL*BLANK    YL0005  4
      * Define local work field Last COA RIN EEEEEEEE usr
     C                     Z-ADD*ZERO     YL0006  80
      * Define local work field ULSD Comp ship to #
     C                     MOVEL*BLANK    YL0007  4
      * Define local work field COA Batch Header RIN
     C                     MOVEL*BLANK    YL0008 38
      * Define local work field COA RIN EEEEEEEE
     C                     Z-ADD*ZERO     YL0009  80
      * Define local work field COA ULSD Company #
     C                     MOVEL*BLANK    YL0010  4
      * Define local work field COA Sold From Name
     C                     MOVEL*BLANK    YL0011 40
      * Define local work field COA ULSD Facility #
     C                     MOVEL*BLANK    YL0012  5
      * Define local work field COA RIN Trans Partner Nm
     C                     MOVEL*BLANK    YL0013 30
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field COA Bio-diesel Fuel Code
     C                     MOVEL*BLANK    YL0015  6
      * Define local work field COA Bio-dsl Fuel Cd Descr
     C                     MOVEL*BLANK    YL0016 30
      * Define local work field COA Producer Regist Nbr
     C                     MOVEL*BLANK    YL0017 25
      * Define local work field COA Employer ID
     C                     MOVEL*BLANK    YL0018 20
      * Define local work field COA RIN Equivalence Valu
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field COA RIN Renewable Enrgy
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field COA RIN Type Flag
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field COA Density Loadout
     C                     Z-ADD*ZERO     YL0022  75
      * Define local work field COA BOL Percent
     C                     Z-ADD*ZERO     YL0023  41
      * Define local work field COA RFS Renew Fuel Code
     C                     MOVEL*BLANK    YL0024  3
      * Define local work field COA RFS Rnwbl Feedstock
     C                     MOVEL*BLANK    YL0025  3
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0026  70
      * Define local work field Parent Customer
     C                     Z-ADD*ZERO     YL0027  70
      * Define local work field Customer Name
     C                     MOVEL*BLANK    YL0028 30
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 RFS0201
00002 1111111
00003 Y2U0005
