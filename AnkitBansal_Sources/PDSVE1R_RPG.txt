     H/TITLE EDT Order Header More  E1 Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/01/19  Time  : 08:43:24
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDSVE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Order Header More  E1 Edit record(1 screen)
      *
     FOPBFCPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FCAEOREL2IF  E           K        DISK
      * RTV : Company Customer          Active Records         N
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FCAACREL2IF  E           K        DISK
      * RTV : State                     Active only
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAAOREL2IF  E           K        DISK
      * RTV : Terms                     Retrieve Active Records
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FPDLFREL2IF  E           K        DISK
      * RSQ : Mileage Between Cities    ToCty/ToSt/FrmCty/FrmSt
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FARBCREL1IF  E           K        DISK
      * RTV : A/R Summary               Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FARBCREL0UF  E           K        DISK                      A
      * UPD : A/R Summary               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPMAMREL0UF  E           K        DISK
      * UPD : Order Header Extension    Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   3 003  5 0A
     E                    W0END   3 003  5 0A
     E                    W0NAM   3 003 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 041  5 0A
     E                    W1END   7 041  5 0A
     E                    W1NAM   7 041 10
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@EOREUB
      * Company Customer          Active Records         N
      * Renamed input format fields
     I              EOAIC3                          WBAIC3
     I              EOBKC7                          WBBKC7
     I              EOAQCD                          WBAQCD
     I              EOR4CD                          WBR4CD
     I              EOBYNA                          WBBYNA
     I              EOB6NA                          WBB6NA
     I              EOBZNA                          WBBZNA
     I              EOLLST                          WBLLST
     I              EOPPST                          WBPPST
     I              EOR5NB                          WBR5NB
     I              EOR6NB                          WBR6NB
     I              EOQGST                          WBQGST
     I              EOBOCD                          WBBOCD
     I              EOTBNB                          WBTBNB
     I              EOMTCU                          WBMTCU
     I              EOW2NB                          WBW2NB
     I              EORPCD                          WBRPCD
     I              EOAJCD                          WBAJCD
     I              EOX9ST                          WBX9ST
     I              EOT9CD                          WBT9CD
     I              EOUBCD                          WBUBCD
     I              EOISTX                          WBISTX
     I              EOLQCD                          WBLQCD
     I              EONJNA                          WBNJNA
     I              EOI0TX                          WBI0TX
     I              EONKNA                          WBNKNA
     I              EOI1TX                          WBI1TX
     I              EOVLST                          WBVLST
     I              EORLST                          WBRLST
     I              EOMMTX                          WBMMTX
     I              EOOHNA                          WBOHNA
     I              EOQ6ST                          WBQ6ST
     I              EOQ8ST                          WBQ8ST
     I              EORBST                          WBRBST
     I              EOREST                          WBREST
     I              EOUVST                          WBUVST
     I              EOUWST                          WBUWST
     I              EOUXST                          WBUXST
     I              EOVSST                          WBVSST
     I              EOAATM                          WBAATM
     I              EOAYNA                          WBAYNA
     I              EOA0NA                          WBA0NA
     I              EOAXDT                          WBAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WCRMNB
     I              FLRUNB                          WCRUNB
     I              FLRVNB                          WCRVNB
     I              FLDQTX                          WCDQTX
     I              FLRWNB                          WCRWNB
     I              FLRXNB                          WCRXNB
     I              FLSQNB                          WCSQNB
     I              FLT0NB                          WCT0NB
     I              FLT1NB                          WCT1NB
     I              FLR1NB                          WCR1NB
     I              FLAIC3                          WCAIC3
     I              FLC4NB                          WCC4NB
     I              FLVCST                          WCVCST
     I              FLKEDT                          WCKEDT
     I              FLSXNB                          WCSXNB
     I              FLKFDT                          WCKFDT
     I              FLACTM                          WCACTM
     I              FLK5TX                          WCK5TX
     I              FLW5CD                          WCW5CD
     I              FLEJDT                          WCEJDT
     I              FLAGTM                          WCAGTM
     I              FLKJDT                          WCKJDT
     I              FLATTM                          WCATTM
     I              FLHDDT                          WCHDDT
     I              FLAUTM                          WCAUTM
     I              FLKKDT                          WCKKDT
     I              FLAVTM                          WCAVTM
     I              FLZ4NB                          WCZ4NB
     I              FLY7ST                          WCY7ST
     I              FLY2ST                          WCY2ST
     I              FLWHTX                          WCWHTX
     I              FLWITX                          WCWITX
     I              FLWJTX                          WCWJTX
     I              FLWKTX                          WCWKTX
     I              FLWLTX                          WCWLTX
     I              FLN7DT                          WCN7DT
     I              FLN8DT                          WCN8DT
     I              FLN9DT                          WCN9DT
     I              FLB3TM                          WCB3TM
     I              FLB4TM                          WCB4TM
     I              FLB5TM                          WCB5TM
     I              FLIASX                          WCIASX
     I              FLIBSX                          WCIBSX
     I              FLICSX                          WCICSX
     I              FLWVTX                          WCWVTX
     I              FLWWTX                          WCWWTX
     I              FLWXTX                          WCWXTX
     I              FLUVST                          WCUVST
     I              FLUWST                          WCUWST
     I              FLUXST                          WCUXST
     I              FLAATM                          WCAATM
     I              FLAYNA                          WCAYNA
     I              FLA0NA                          WCA0NA
     I              FLAXDT                          WCAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@BBREWG
      * Customer                  Active Only
      * Renamed input format fields
     I              BBBKC7                          WEBKC7
     I              BBAYTX                          WEAYTX
     I              BBACNA                          WEACNA
     I              BBADNA                          WEADNA
     I              BBAENA                          WEAENA
     I              BBAJNA                          WEAJNA
     I              BBBGCD                          WEBGCD
     I              BBG5CD                          WEG5CD
     I              BBBTTX                          WEBTTX
     I              BBBVTX                          WEBVTX
     I              BBBWTX                          WEBWTX
     I              BBABTX                          WEABTX
     I              BBA2NA                          WEA2NA
     I              BBCBST                          WECBST
     I              BBB0NA                          WEB0NA
     I              BBP3NB                          WEP3NB
     I              BBAXNA                          WEAXNA
     I              BBI6DT                          WEI6DT
     I              BBAYDT                          WEAYDT
     I              BBANC7                          WEANC7
     I              BBBTC7                          WEBTC7
     I              BBK6ST                          WEK6ST
     I              BBUZST                          WEUZST
     I              BBKXCD                          WEKXCD
     I              BBLTCD                          WELTCD
     I              BBQNST                          WEQNST
     I              BBS2NB                          WES2NB
     I              BBVHVA                          WEVHVA
     I              BBI7DT                          WEI7DT
     I              BBRJST                          WERJST
     I              BBRKST                          WERKST
     I              BBQWST                          WEQWST
     I              BBQXST                          WEQXST
     I              BBQYST                          WEQYST
     I              BBUNCS                          WEUNCS
     I              BBUVST                          WEUVST
     I              BBUWST                          WEUWST
     I              BBUXST                          WEUXST
     I              BBVSST                          WEVSST
     I              BBAATM                          WEAATM
     I              BBAYNA                          WEAYNA
     I              BBA0NA                          WEA0NA
     I              BBAXDT                          WEAXDT
      *
     I@BCREFD
      * A/R Summary               Update index
      * Renamed input format fields
     I              BCAIC3                          WFAIC3
     I              BCANC7                          WFANC7
     I              BCAGVA                          WFAGVA
     I              BCACVA                          WFACVA
     I              BCADVA                          WFADVA
     I              BCAEVA                          WFAEVA
     I              BCAFVA                          WFAFVA
     I              BCAHVA                          WFAHVA
     I              BCVIVA                          WFVIVA
     I              BCVJVA                          WFVJVA
     I              BCVKVA                          WFVKVA
     I              BCVLVA                          WFVLVA
     I              BCVMVA                          WFVMVA
     I              BCVNVA                          WFVNVA
     I              BCEEVA                          WFEEVA
     I              BCAKTM                          WFAKTM
     I              BCAHDT                          WFAHDT
     I              BCANDT                          WFANDT
     I              BCANVA                          WFANVA
     I              BCALDT                          WFALDT
     I              BCAMVA                          WFAMVA
     I              BCAIDT                          WFAIDT
     I              BCALVA                          WFALVA
     I              BCDJNB                          WFDJNB
     I              BCDLNB                          WFDLNB
     I              BCDDNB                          WFDDNB
     I              BCDMNB                          WFDMNB
     I              BCDUDT                          WFDUDT
     I              BCLYNO                          WFLYNO
     I              BCLYNC                          WFLYNC
     I              BCLYNP                          WFLYNP
     I              BCLYNI                          WFLYNI
     I              BCADPM                          WFADPM
     I              BCVOVA                          WFVOVA
     I              BCBTDY                          WFBTDY
     I              BCBUDY                          WFBUDY
     I              BCVPVA                          WFVPVA
     I              BCVQVA                          WFVQVA
     I              BCBCCD                          WFBCCD
     I              BCR4CD                          WFR4CD
     I              BCCUMO                          WFCUMO
     I              BCUVST                          WFUVST
     I              BCUWST                          WFUWST
     I              BCUXST                          WFUXST
     I              BCAATM                          WFAATM
     I              BCAYNA                          WFAYNA
     I              BCA0NA                          WFA0NA
     I              BCAXDT                          WFAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WIRMNB
     I              FJAIC3                          WIAIC3
     I              FJAODT                          WIAODT
     I              FJPJST                          WIPJST
     I              FJPKST                          WIPKST
     I              FJRNNB                          WIRNNB
     I              FJDMTX                          WIDMTX
     I              FJDNTX                          WIDNTX
     I              FJDOTX                          WIDOTX
     I              FJWTTX                          WIWTTX
     I              FJWUTX                          WIWUTX
     I              FJRPNB                          WIRPNB
     I              FJFLAM                          WIFLAM
     I              FJXQST                          WIXQST
     I              FJRRNB                          WIRRNB
     I              FJDXTX                          WIDXTX
     I              FJDYTX                          WIDYTX
     I              FJSBNB                          WISBNB
     I              FJBZNA                          WIBZNA
     I              FJRONB                          WIRONB
     I              FJSQNB                          WISQNB
     I              FJR1NB                          WIR1NB
     I              FJVCST                          WIVCST
     I              FJVDST                          WIVDST
     I              FJSDNB                          WISDNB
     I              FJPAOU                          WIPAOU
     I              FJDGWG                          WIDGWG
     I              FJSXNB                          WISXNB
     I              FJHADT                          WIHADT
     I              FJAART                          WIAART
     I              FJDHWG                          WIDHWG
     I              FJDIWG                          WIDIWG
     I              FJAQDT                          WIAQDT
     I              FJS6NB                          WIS6NB
     I              FJT4NB                          WIT4NB
     I              FJPRTM                          WIPRTM
     I              FJNPSV                          WINPSV
     I              FJJ8TX                          WIJ8TX
     I              FJTLMI                          WITLMI
     I              FJJ9TX                          WIJ9TX
     I              FJQ2CD                          WIQ2CD
     I              FJVPCD                          WIVPCD
     I              FJDBCD                          WIDBCD
     I              FJGRWE                          WIGRWE
     I              FJXCCD                          WIXCCD
     I              FJU2ST                          WIU2ST
     I              FJF9DT                          WIF9DT
     I              FJONTM                          WIONTM
     I              FJJ4DT                          WIJ4DT
     I              FJTRTM                          WITRTM
     I              FJJ5DT                          WIJ5DT
     I              FJSPTM                          WISPTM
     I              FJJ6DT                          WIJ6DT
     I              FJLFTM                          WILFTM
     I              FJJ7DT                          WIJ7DT
     I              FJBOTM                          WIBOTM
     I              FJJ8DT                          WIJ8DT
     I              FJBLTM                          WIBLTM
     I              FJKIDT                          WIKIDT
     I              FJASTM                          WIASTM
     I              FJKADT                          WIKADT
     I              FJAJCM                          WIAJCM
     I              FJXACD                          WIXACD
     I              FJOANA                          WIOANA
     I              FJK4TX                          WIK4TX
     I              FJVOAG                          WIVOAG
     I              FJKBDT                          WIKBDT
     I              FJNBBO                          WINBBO
     I              FJW4CD                          WIW4CD
     I              FJEFDT                          WIEFDT
     I              FJCNTN                          WICNTN
     I              FJKCDT                          WIKCDT
     I              FJTMIN                          WITMIN
     I              FJKDDT                          WIKDDT
     I              FJVMNB                          WIVMNB
     I              FJOCFR                          WIOCFR
     I              FJKJDT                          WIKJDT
     I              FJATTM                          WIATTM
     I              FJOTRS                          WIOTRS
     I              FJRNST                          WIRNST
     I              FJBRBK                          WIBRBK
     I              FJEIDT                          WIEIDT
     I              FJRMST                          WIRMST
     I              FJAJCD                          WIAJCD
     I              FJKKDT                          WIKKDT
     I              FJAVTM                          WIAVTM
     I              FJKZDT                          WIKZDT
     I              FJAXTM                          WIAXTM
     I              FJLHOS                          WILHOS
     I              FJLHOR                          WILHOR
     I              FJWNTX                          WIWNTX
     I              FJOITX                          WIOITX
     I              FJOJTX                          WIOJTX
     I              FJLLDT                          WILLDT
     I              FJLSHG                          WILSHG
     I              FJYPST                          WIYPST
     I              FJK0DT                          WIK0DT
     I              FJAYTM                          WIAYTM
     I              FJKNNX                          WIKNNX
     I              FJICWG                          WIICWG
     I              FJIDWG                          WIIDWG
     I              FJH9SX                          WIH9SX
     I              FJWOTX                          WIWOTX
     I              FJK1DT                          WIK1DT
     I              FJAZTM                          WIAZTM
     I              FJK2DT                          WIK2DT
     I              FJA0TM                          WIA0TM
     I              FJROST                          WIROST
     I              FJRPST                          WIRPST
     I              FJRQST                          WIRQST
     I              FJRRST                          WIRRST
     I              FJZBVA                          WIZBVA
     I              FJWPTX                          WIWPTX
     I              FJWQTX                          WIWQTX
     I              FJWRTX                          WIWRTX
     I              FJWSTX                          WIWSTX
     I              FJRVSX                          WIRVSX
     I              FJRUSX                          WIRUSX
     I              FJRWSX                          WIRWSX
     I              FJRXSX                          WIRXSX
     I              FJRYSX                          WIRYSX
     I              FJRZSX                          WIRZSX
     I              FJR0SX                          WIR0SX
     I              FJR1SX                          WIR1SX
     I              FJR2SX                          WIR2SX
     I              FJR3SX                          WIR3SX
     I              FJR4SX                          WIR4SX
     I              FJPYDT                          WIPYDT
     I              FJCKTM                          WICKTM
     I              FJPZDT                          WIPZDT
     I              FJCLTM                          WICLTM
     I              FJP0DT                          WIP0DT
     I              FJCMTM                          WICMTM
     I              FJP1DT                          WIP1DT
     I              FJCNTM                          WICNTM
     I              FJP2DT                          WIP2DT
     I              FJCOTM                          WICOTM
     I              FJP3DT                          WIP3DT
     I              FJCQTM                          WICQTM
     I              FJUVST                          WIUVST
     I              FJUWST                          WIUWST
     I              FJUXST                          WIUXST
     I              FJAATM                          WIAATM
     I              FJAYNA                          WIAYNA
     I              FJA0NA                          WIA0NA
     I              FJAXDT                          WIAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WJAIC3
     I              AMC4NB                          WJC4NB
     I              AMRMNB                          WJRMNB
     I              AMRUNB                          WJRUNB
     I              AMXACD                          WJXACD
     I              AMOANA                          WJOANA
     I              AMHBAA                          WJHBAA
     I              AMJ0T1                          WJJ0T1
     I              AMGENY                          WJGENY
     I              AMJ1T1                          WJJ1T1
     I              AMHCAA                          WJHCAA
     I              AMQWDT                          WJQWDT
     I              AMQXDT                          WJQXDT
     I              AMQYDT                          WJQYDT
     I              AMHDAA                          WJHDAA
     I              AMCCTX                          WJCCTX
     I              AMJ2T1                          WJJ2T1
     I              AMRLNA                          WJRLNA
     I              AMRMNA                          WJRMNA
     I              AMGINY                          WJGINY
     I              AMGFNY                          WJGFNY
     I              AMGGNY                          WJGGNY
     I              AMGHNY                          WJGHNY
     I              AMHEVL                          WJHEVL
     I              AMHFVL                          WJHFVL
     I              AMHGVL                          WJHGVL
     I              AMQZDT                          WJQZDT
     I              AMQ0DT                          WJQ0DT
     I              AMQ1DT                          WJQ1DT
     I              AMQ2DT                          WJQ2DT
     I              AMC2TX                          WJC2TX
     I              AMC3TX                          WJC3TX
     I              AMC6TX                          WJC6TX
     I              AMCHTX                          WJCHTX
     I              AMCITX                          WJCITX
     I              AMCLTX                          WJCLTX
     I              AMB4TX                          WJB4TX
     I              AMCUTX                          WJCUTX
     I              AMCVTX                          WJCVTX
     I              AMB9TX                          WJB9TX
     I              AMJWSC                          WJJWSC
     I              AMITNY                          WJITNY
     I              AMLMT1                          WJLMT1
     I              AMLWAA                          WJLWAA
     I              AMFVST                          WJFVST
     I              AMF0ST                          WJF0ST
     I              AMF2ST                          WJF2ST
     I              AMF3ST                          WJF3ST
     I              AMJUSC                          WJJUSC
     I              AMJVSC                          WJJVSC
     I              AMV3T1                          WJV3T1
     I              AMV4T1                          WJV4T1
     I              AMV5T1                          WJV5T1
     I              AMV6T1                          WJV6T1
     I              AMV7T1                          WJV7T1
     I              AMV8T1                          WJV8T1
     I              AMV9T1                          WJV9T1
     I              AMWAT1                          WJWAT1
     I              AMWBT1                          WJWBT1
     I              AMWCT1                          WJWCT1
     I              AMWDT1                          WJWDT1
     I              AMQJNY                          WJQJNY
     I              AMQKNY                          WJQKNY
     I              AMQLNY                          WJQLNY
     I              AMP8NY                          WJP8NY
     I              AMP9NY                          WJP9NY
     I              AMQANY                          WJQANY
     I              AMQCNY                          WJQCNY
     I              AMQDNY                          WJQDNY
     I              AMQENY                          WJQENY
     I              AMQFNY                          WJQFNY
     I              AMQGNY                          WJQGNY
     I              AMQHNY                          WJQHNY
     I              AMQINY                          WJQINY
     I              AMQMNY                          WJQMNY
     I              AMMYU1                          WJMYU1
     I              AMJXSC                          WJJXSC
     I              AMJYSC                          WJJYSC
     I              AMJZSC                          WJJZSC
     I              AMJ0SC                          WJJ0SC
     I              AMMZU1                          WJMZU1
     I              AMM0U1                          WJM0U1
     I              AMM1U1                          WJM1U1
     I              AMM2U1                          WJM2U1
     I              AMM3U1                          WJM3U1
     I              AMW5DT                          WJW5DT
     I              AMW6DT                          WJW6DT
     I              AMUVST                          WJUVST
     I              AMUWST                          WJUWST
     I              AMUXST                          WJUXST
     I              AMVSST                          WJVSST
     I              AMAATM                          WJAATM
     I              AMAYNA                          WJAYNA
     I              AMA0NA                          WJA0NA
     I              AMAXDT                          WJAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WKAIC3
     I              ABADTX                          WKADTX
     I              ABACNA                          WKACNA
     I              ABADNA                          WKADNA
     I              ABAENA                          WKAENA
     I              ABAJNA                          WKAJNA
     I              ABBTTX                          WKBTTX
     I              ABBVTX                          WKBVTX
     I              ABBWTX                          WKBWTX
     I              ABA2NA                          WKA2NA
     I              ABABTX                          WKABTX
     I              ABBGCD                          WKBGCD
     I              ABKXCD                          WKKXCD
     I              ABUVST                          WKUVST
     I              ABUWST                          WKUWST
     I              ABUXST                          WKUXST
     I              ABVSST                          WKVSST
     I              ABAATM                          WKAATM
     I              ABAYNA                          WKAYNA
     I              ABA0NA                          WKA0NA
     I              ABAXDT                          WKAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            779
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQARBC1    E DSARBCREL0
      * UPD : A/R Summary               Update index
      * Renamed input format fields
     I              BCAIC3                          WFAIC3
     I              BCANC7                          WFANC7
     I              BCAGVA                          WFAGVA
     I              BCACVA                          WFACVA
     I              BCADVA                          WFADVA
     I              BCAEVA                          WFAEVA
     I              BCAFVA                          WFAFVA
     I              BCAHVA                          WFAHVA
     I              BCVIVA                          WFVIVA
     I              BCVJVA                          WFVJVA
     I              BCVKVA                          WFVKVA
     I              BCVLVA                          WFVLVA
     I              BCVMVA                          WFVMVA
     I              BCVNVA                          WFVNVA
     I              BCEEVA                          WFEEVA
     I              BCAKTM                          WFAKTM
     I              BCAHDT                          WFAHDT
     I              BCANDT                          WFANDT
     I              BCANVA                          WFANVA
     I              BCALDT                          WFALDT
     I              BCAMVA                          WFAMVA
     I              BCAIDT                          WFAIDT
     I              BCALVA                          WFALVA
     I              BCDJNB                          WFDJNB
     I              BCDLNB                          WFDLNB
     I              BCDDNB                          WFDDNB
     I              BCDMNB                          WFDMNB
     I              BCDUDT                          WFDUDT
     I              BCLYNO                          WFLYNO
     I              BCLYNC                          WFLYNC
     I              BCLYNP                          WFLYNP
     I              BCLYNI                          WFLYNI
     I              BCADPM                          WFADPM
     I              BCVOVA                          WFVOVA
     I              BCBTDY                          WFBTDY
     I              BCBUDY                          WFBUDY
     I              BCVPVA                          WFVPVA
     I              BCVQVA                          WFVQVA
     I              BCBCCD                          WFBCCD
     I              BCR4CD                          WFR4CD
     I              BCCUMO                          WFCUMO
     I              BCUVST                          WFUVST
     I              BCUWST                          WFUWST
     I              BCUXST                          WFUXST
     I              BCAATM                          WFAATM
     I              BCAYNA                          WFAYNA
     I              BCA0NA                          WFA0NA
     I              BCAXDT                          WFAXDT
      *
     IYARDCS      DS                            213
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     IYCRDCS      DS                            525
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop/Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     IYDRDCS      DS                            793
     IYERDCS      DS                            793
     IYFRDCS      DS                            779
     IYGRDCS      DS                            793
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WJAIC3
     I              AMC4NB                          WJC4NB
     I              AMRMNB                          WJRMNB
     I              AMRUNB                          WJRUNB
     I              AMXACD                          WJXACD
     I              AMOANA                          WJOANA
     I              AMHBAA                          WJHBAA
     I              AMJ0T1                          WJJ0T1
     I              AMGENY                          WJGENY
     I              AMJ1T1                          WJJ1T1
     I              AMHCAA                          WJHCAA
     I              AMQWDT                          WJQWDT
     I              AMQXDT                          WJQXDT
     I              AMQYDT                          WJQYDT
     I              AMHDAA                          WJHDAA
     I              AMCCTX                          WJCCTX
     I              AMJ2T1                          WJJ2T1
     I              AMRLNA                          WJRLNA
     I              AMRMNA                          WJRMNA
     I              AMGINY                          WJGINY
     I              AMGFNY                          WJGFNY
     I              AMGGNY                          WJGGNY
     I              AMGHNY                          WJGHNY
     I              AMHEVL                          WJHEVL
     I              AMHFVL                          WJHFVL
     I              AMHGVL                          WJHGVL
     I              AMQZDT                          WJQZDT
     I              AMQ0DT                          WJQ0DT
     I              AMQ1DT                          WJQ1DT
     I              AMQ2DT                          WJQ2DT
     I              AMC2TX                          WJC2TX
     I              AMC3TX                          WJC3TX
     I              AMC6TX                          WJC6TX
     I              AMCHTX                          WJCHTX
     I              AMCITX                          WJCITX
     I              AMCLTX                          WJCLTX
     I              AMB4TX                          WJB4TX
     I              AMCUTX                          WJCUTX
     I              AMCVTX                          WJCVTX
     I              AMB9TX                          WJB9TX
     I              AMJWSC                          WJJWSC
     I              AMITNY                          WJITNY
     I              AMLMT1                          WJLMT1
     I              AMLWAA                          WJLWAA
     I              AMFVST                          WJFVST
     I              AMF0ST                          WJF0ST
     I              AMF2ST                          WJF2ST
     I              AMF3ST                          WJF3ST
     I              AMJUSC                          WJJUSC
     I              AMJVSC                          WJJVSC
     I              AMV3T1                          WJV3T1
     I              AMV4T1                          WJV4T1
     I              AMV5T1                          WJV5T1
     I              AMV6T1                          WJV6T1
     I              AMV7T1                          WJV7T1
     I              AMV8T1                          WJV8T1
     I              AMV9T1                          WJV9T1
     I              AMWAT1                          WJWAT1
     I              AMWBT1                          WJWBT1
     I              AMWCT1                          WJWCT1
     I              AMWDT1                          WJWDT1
     I              AMQJNY                          WJQJNY
     I              AMQKNY                          WJQKNY
     I              AMQLNY                          WJQLNY
     I              AMP8NY                          WJP8NY
     I              AMP9NY                          WJP9NY
     I              AMQANY                          WJQANY
     I              AMQCNY                          WJQCNY
     I              AMQDNY                          WJQDNY
     I              AMQENY                          WJQENY
     I              AMQFNY                          WJQFNY
     I              AMQGNY                          WJQGNY
     I              AMQHNY                          WJQHNY
     I              AMQINY                          WJQINY
     I              AMQMNY                          WJQMNY
     I              AMMYU1                          WJMYU1
     I              AMJXSC                          WJJXSC
     I              AMJYSC                          WJJYSC
     I              AMJZSC                          WJJZSC
     I              AMJ0SC                          WJJ0SC
     I              AMMZU1                          WJMZU1
     I              AMM0U1                          WJM0U1
     I              AMM1U1                          WJM1U1
     I              AMM2U1                          WJM2U1
     I              AMM3U1                          WJM3U1
     I              AMW5DT                          WJW5DT
     I              AMW6DT                          WJW6DT
     I              AMUVST                          WJUVST
     I              AMUWST                          WJUWST
     I              AMUXST                          WJUXST
     I              AMVSST                          WJVSST
     I              AMAATM                          WJAATM
     I              AMAYNA                          WJAYNA
     I              AMA0NA                          WJA0NA
     I              AMAXDT                          WJAXDT
      *
     IYHRDCS      DS                            894
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * B : MAP Order Number
     I                                    P   3   60P1C4NB
      * N :  A/R Customer Number
     I                                    P   7  100P1ANC7
      * B :  Ship To Customer
     I                                    P  11  140P1BKC7
      * N :  Customer Purchase Order #
     I                                       15  29 P1BCNA
      * N :  Requested Delivery Date
     I                                    P  30  330P1EIDT
      * N :  Requested Delivery Time
     I                                    P  34  360P1AFTM
      * N :  Load Type
     I                                       37  37 P1VDST
     IP2PARM      DS
      * B :  Next Program Name
     I                                        1  10 P2BYVN
     IP3PARM      DS
      * I :  USR Change existing order
     I                                        1   1 P3G6ST
     IP4PARM      DS
      * N : MAP Company Name
     I                                        1  30 P4APTX
     IP5PARM      DS
      * FLD: Company Defaults Internal
      * N :  Shipping Method Dft
     I                                        1   2 P5Z9ST
      * N :  Load Type Dft
     I                                        3   3 P5CSST
      * N :  LTL Flag Dft
     I                                        4   4 P5Z8ST
      * N :  Export Status Dft
     I                                        5   5 P5CXST
      * N :  Shrink Wrap Dft
     I                                        6   6 P5SWST
      * N :  Departure Time DFT
     I                                    P   7   90P5XXTM
      * N :  Export Code Dft
     I                                       10  15 P5UECD
      * N :  Allow Mult Whse to Order
     I                                       16  16 P5HSST
      * N :  Allow Multi Export On Ord
     I                                       17  17 P5AMEO
      * N :  Slip Sheet Dft
     I                                       18  18 P5SSDF
      * N :  Palletize Dft
     I                                       19  19 P5PDFT
      * N :  Company Organization
     I                                       20  20 P5YJSX
     IP6PARM      DS
      * FLD: Order Types
      * N :  Processing Cycle Type
     I                                        1   1 P6OAST
      * N :  Billing Activity Type
     I                                        2   2 P6OBST
      * N :  Affect Inventory Default
     I                                        3   3 P6OEST
     IP7PARM      DS
      * FLD: *Arrays
      * N :  USR Output Only Status
     I                                        1   1 P7E5ST
      * N :  USR Output Only Status 2
     I                                        2   2 P7STE7
      * N :  USR Output Only Status 3
     I                                        3   3 P7STE8
      * N :  USR Ship To Customer
     I                                    P   4   70P7BLC7
      * N :  P.O. Required Flag
     I                                        8   8 P7PPST
      * N :  USR Display field
     I                                        9   9 P7GGST
      * N :  Number of Orders on Load
     I                                    P  10  120P7NB01
      * N :  Number of Orders on Stop
     I                                    P  13  150P7NB02
      * N :  OHE Abs Rate Override Rsn
     I                                       16  25 P7V4T1
      * N :  Live with TPM
     I                                       26  26 P7O1ST
      * N :  Output Only 1 USR
     I                                       27  27 P7LISX
      * N :  Status - Y or N
     I                                       28  28 P7B8ST
      * N :  Status Flag 1  Y/N
     I                                       29  29 P7Q1ST
      * N :  MG Created Load
     I                                       30  30 P7RYSX
     IP8PARM      DS
      * FLD: Load Header
      * N :  Load ID
     I                                    P   1   40P8RMNB
      * N :  Allocate Pounds/Miles
     I                                        5   5 P8XQST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Ship to Customer Flag 'N''
      * Ship To Customer
     I                                        1   7 ZA0001
      * Message data for 'Tf Exempt -mix error Cust'
      * Message data for 'No Miles Between Cities'
      * Ship To City
     I                                        1  20 ZA0002
      * Message data for 'Cannot deliver on time'
      * Ship to Customer      USR
     I                                        1   7 ZA0003
      * Message data for 'Cannot arrive on time-Chg'
      * Requested Delivery Date
     I                                    P   1   40ZA0004
      * Message data for 'Company Customer       NF'
      * Message data for 'City Required'
      * City
     I                                        1  20 ZA0005
      * Message data for 'Zipcode not avail-dbl chk'
      * Zip/Postal Code
     I                                        1  11 ZA0006
      * Message data for 'No Miles Betw Cities'
      * Ship To City
     I                                        1  20 ZA0007
      * Ship To State Code
     I                                       21  22 ZA0008
      * Message data for 'Cannot deliver on time'
      * Ship to Customer      USR
     I                                        1   7 ZA0009
      * Message data for 'No Miles Betw Cities'
      * Ship To City
     I                                        1  20 ZA0010
      * Ship To State Code
     I                                       21  22 ZA0011
      * Message data for 'P.O. Required'
      * Customer Purchase Order #
     I                                        1  15 ZA0012
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0013
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0014
      * Message data for 'ABS Frt Ovr Rsn Must Exst'
      * Abs Frt Override Reason
     I                                        1   2 ZA0015
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM P1C4NB    WP0002  70       Order Number
     C           P1BKC7    PARM P1BKC7    WP0003  70       Ship To Custome
     C           P2BYVN    PARM P2BYVN    WP0004 10        Next Program Na
     C           P3G6ST    PARM           WP0005  1        USR Change exis
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1C4NB    OREQ *ZERO                      Order Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KRTV      CHAIN@BECPFK              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     9931  *
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * USER: Initialize detail screen (existing record)
      * **************************
      * Get # orders on load (Used to allow change to Load Type)
      * CASE: DB1.Load ID NE WRK.ZERO
     C           BERMNB    IFNE WUW0NB                     *IF
      * RTV Nbr of Orders/Load RT - Order Header TRG  * 
     C                     EXSR SARVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     P7NB01           Number of Order
     C                     END                             *FI
      * Get load status, if on a load
      * CASE: DB1.Load ID is NE Blank
     C           BERMNB    IFNE *ZERO                      *IF
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * RTV ld Accpt/Load Status - Load Header  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
      * **************************
      * If Buyers Truck or Rail zero out absorbed freight rate
      * CASE:
      *  - c1ORc2
      *   |- c1    : DTL.Shipping Method is Collect Rail
      *   |- c2    : DTL.Shipping Method is Collect Truck
      *   '-
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'                       *OR
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
      * R12926 DN 05/11/18-Set Abs Frt Override Reason to Blank.
     C                     MOVEL*BLANK    #DHSSC           Abs Frt Overrid
     C                     ELSE
      * CASE: *OTHERWISE
      * R12926 DN 05/02/18-Commented Out. At Order level, use AFR from OH
      * R12926 DN 05/08/18-Populate Customer ABS Freight Rate.
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0001           USR Display 13
      * RTV Abs Freight Rate   RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0001           Company Number
     C                     Z-ADDBEBKC7    WL0002           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    #DLMNY           Absorbed Freigh
      * Rtv Org ABS & Reason   RT - Order Header Extension  * Get AFO Rea
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0004           Company Number
     C                     Z-ADDBEC4NB    WL0005           Order Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    #DHSSC    P      OHE Abs Rate Ov
     C                     Z-ADDWL0007    YL0002           OHE Orig ABS Fr
      * Save ABS Freight Rate CWT & ABS Freight Override Reason.
      * CASE: *OTHERWISE
      * Save AFR from Order to LCL ctxt to Create Load Order Change Log.
     C                     Z-ADDBETBNB    YL0003           Absorbed Freigh
      * Save Orig Reason from Order to LCL ctxt to Create Load Order Chan
     C                     MOVEL#DHSSC    YL0004           Abs Frt Overrid
      * To Display 'Prior Order ABS Freight Rate' when ABS Frt Rate Chang
      * CASE: *OTHERWISE
      * Save Original AFR Value from Order Header.
     C                     Z-ADDYL0002    YL0005           Absorbed Freigh
      * If ABS Freight Rate Changes, Show Original ABS Frt Rate from OHE.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Absorbed Freight Rate CWT NE LCL.OHE Orig ABS Fr
      *   |- c2    : LCL.OHE Orig ABS Freight Rate is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BETBNB    IFNE YL0002                     *IF
     C           YL0002    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0002    #DLNNY           Absorbed Freigh
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #DLNNY           Absorbed Freigh
     C                     END                             *FI
      * CASE: DTL.Absorbed Freight Rate CWT NE DTL.Absorbed Freight Rate
     C           #1TBNB    IFNE #DLNNY                     *IF
     C                     MOVEL'Y'       YL0001           USR Display 13
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       YL0006           Crt Load Order
      * RTV Salesman Code      RT - PD Sales Route  * 
     C                     EXSR SERVGN
      * RTV Salesperson Name   RT - Salesperson  * 
     C                     EXSR SFRVGN
      * RTV P.O. Required Flag RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0008           Company Number
     C                     Z-ADDBEBKC7    WL0009           Ship To Custome
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    P7PPST    P      P.O. Required F
      * ** Miles to cust from comp/cust will normally be zeros.
      * Rtv Miles to Customer  RT - Company Customer  * 
     C                     EXSR SHRVGN
      * VAL Active Dtl exists  RT - PD Order Detail  * 
     C                     EXSR SIRVGN
      * Determine if Load Type should be output only
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * (active detail exists)
     C                     MOVEL'Y'       P7E5ST           USR Output Only
     C                     ELSE
      * CASE: DB1.Load ID NE WRK.ZERO
     C           BERMNB    IFNE WUW0NB                     *IF
      * Allow input if only 1 order on load
      * CASE: PAR.Number of Orders on Load is Greater Than 1
     C           P7NB01    IFGT 1                          *IF
     C                     MOVEL'Y'       P7E5ST           USR Output Only
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P7E5ST           USR Output Only
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P7E5ST           USR Output Only
     C                     END                             *FI
     C                     END                             *FI
      * Determine if Ship to Customer should be output only      E00102
      * CASE: PAR.Number of Orders on Load is Greater Than 1
     C           P7NB01    IFGT 1                          *IF
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * RTV Number Orders/Stop RT - Load Detail  * 
     C                     EXSR SJRVGN
      * Output only if >1 order on stop
      * CASE: PAR.Number of Orders on Stop is Greater Than 1
     C           P7NB02    IFGT 1                          *IF
     C                     MOVEL'Y'       P7STE8           USR Output Only
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P7STE8           USR Output Only
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Load Status is Locked thru Invoiced
     C           WUPKST    IFEQ 'I'                        *IF
     C           WUPKST    OREQ 'L'
     C           WUPKST    OREQ 'S'
      * ** Don't allow Cust# change if on a load and locked
     C                     MOVEL'Y'       P7STE8           USR Output Only
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P7STE8           USR Output Only
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELBEVDST    P1VDST           Load Type
     C                     Z-ADDBEBKC7    P7BLC7           USR Ship To Cus
     C                     Z-ADDBEANC7    P1ANC7           A/R Customer Nu
      * Rtv Customer TFEx     RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEBKC7    WL0011           Ship To Custome
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    #DP3SX    P      Customer TF Exe
      * RTV Country Code       RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEBKC7    WL0013           Ship To Custome
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUKXCD    P      Country Code
      * Format letter of credit for the screen
      * CASE: LCL.Letter of Credit Number is Entered
     C           YL0007    IFNE *BLANK                     *IF
     C                     MOVELYL0007    #DAKU1           String 30
     C                     END                             *FI
      * RTV Booking # f/ord   RT - Order Header Extension  * 
     C                     EXSR SNRVGN
      * ** Save PO# in case it is changed.     6/09/2008 LJB E00139
     C                     MOVEL#1BCNA    P1BCNA           Customer Purcha
     C                     Z-ADD#1RMNB    P8RMNB           Load ID
      * DEFAULT: Load Plan Order
      * CASE: PAR.Live with TPM is Yes
     C           P7O1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       P7STE7           USR Output Only
     C                     END                             *FI
      * Save Existing Data.
     C                     EXSR UASUBR                     Save Existing D
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #1C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check restriction within
     C                     EXSR VBCKRL
      * Order Number required
     C           #1C4NB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #1BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Air Freight Order
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1FTSX'  IFEQ YPMTFD
      * Air Freight Order
     C                     MOVEL#1FTSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHFTSX
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHFTSX
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHFTSX
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHFTSX
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD4         ZHFTSX
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD5         ZHFTSX
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD6         ZHFTSX
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD7         ZHFTSX
     C           W0INVL    WHEQ 'Z'                        Z
     C                     Z-ADD8         ZHFTSX
     C           W0INVL    WHEQ 'G'                        G
     C                     Z-ADD9         ZHFTSX
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD10        ZHFTSX
     C           W0INVL    WHEQ 'O'                        O
     C                     Z-ADD11        ZHFTSX
     C                     ENDSL
     C                     EXFMTZGFTSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHFTSX    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHFTSX    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHFTSX    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHFTSX    WHEQ 4
     C                     MOVEL'F'       W0INVL           F
     C           ZHFTSX    WHEQ 5
     C                     MOVEL'P'       W0INVL           P
     C           ZHFTSX    WHEQ 6
     C                     MOVEL'X'       W0INVL           X
     C           ZHFTSX    WHEQ 7
     C                     MOVEL'E'       W0INVL           E
     C           ZHFTSX    WHEQ 8
     C                     MOVEL'Z'       W0INVL           Z
     C           ZHFTSX    WHEQ 9
     C                     MOVEL'G'       W0INVL           G
     C           ZHFTSX    WHEQ 10
     C                     MOVEL'S'       W0INVL           S
     C           ZHFTSX    WHEQ 11
     C                     MOVEL'O'       W0INVL           O
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1FTSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Order Date
      * External date
     C                     Z-ADDV1A0DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     Z-ADDXDINDT    #1A0DT
      * Validate Load Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VDST'  IFEQ YPMTFD
      * Load Type
     C                     MOVEL#1VDST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVDST
     C                     SELEC
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD1         ZHVDST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD2         ZHVDST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHVDST
     C                     ENDSL
     C                     EXFMTZGVDST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVDST    WHEQ 1
     C                     MOVEL'B'       W0INVL           B
     C           ZHVDST    WHEQ 2
     C                     MOVEL'R'       W0INVL           R
     C           ZHVDST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VDST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Load Plan Order
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1U4ST'  IFEQ YPMTFD
      * Load Plan Order
     C                     MOVEL#1U4ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHU4ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHU4ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHU4ST
     C                     ENDSL
     C                     EXFMTZGU4ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHU4ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHU4ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1U4ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Print Pick Slip
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1U5ST'  IFEQ YPMTFD
      * Print Pick Slip
     C                     MOVEL#1U5ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHU5ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHU5ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHU5ST
     C                     ENDSL
     C                     EXFMTZGU5ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHU5ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHU5ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1U5ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Shrink Wrap
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VFST'  IFEQ YPMTFD
      * Shrink Wrap
     C                     MOVEL#1VFST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVFST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHVFST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHVFST
     C                     ENDSL
     C                     EXFMTZGVFST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVFST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHVFST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VFST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Abs Frt Override Reason
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DHSSC'  IFEQ YPMTFD
      * Abs Frt Override Reason
     C                     MOVEL#DHSSC    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHHSSC
     C                     SELEC
     C           W0INVL    WHEQ 'FT'                       FT
     C                     Z-ADD1         ZHHSSC
     C           W0INVL    WHEQ 'LT'                       LT
     C                     Z-ADD2         ZHHSSC
     C           W0INVL    WHEQ 'PO'                       PO
     C                     Z-ADD3         ZHHSSC
     C           W0INVL    WHEQ 'RR'                       RR
     C                     Z-ADD4         ZHHSSC
     C                     ENDSL
     C                     EXFMTZGHSSC
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHHSSC    WHEQ 1
     C                     MOVEL'FT'      W0INVL           FT
     C           ZHHSSC    WHEQ 2
     C                     MOVEL'LT'      W0INVL           LT
     C           ZHHSSC    WHEQ 3
     C                     MOVEL'PO'      W0INVL           PO
     C           ZHHSSC    WHEQ 4
     C                     MOVEL'RR'      W0INVL           RR
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DHSSC
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Slip Sheet
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VGST'  IFEQ YPMTFD
      * Slip Sheet
     C                     MOVEL#1VGST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVGST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHVGST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHVGST
     C                     ENDSL
     C                     EXFMTZGVGST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVGST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHVGST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VGST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Email Cust On Order Ship
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1FOSX'  IFEQ YPMTFD
      * Email Cust On Order Ship
     C                     MOVEL#1FOSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHFOSX
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHFOSX
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHFOSX
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHFOSX
     C                     ENDSL
     C                     EXFMTZGFOSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHFOSX    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHFOSX    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHFOSX    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1FOSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Block Order Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1BCST'  IFEQ YPMTFD
      * Block Order Flag
     C                     MOVEL#1BCST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHBCST
     C                     SELEC
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD1         ZHBCST
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD2         ZHBCST
     C                     ENDSL
     C                     EXFMTZGBCST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHBCST    WHEQ 1
     C                     MOVEL'B'       W0INVL           B
     C           ZHBCST    WHEQ 2
     C                     MOVEL'F'       W0INVL           F
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1BCST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * Prompt on Ship to Customer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V1BKC7'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Error if F4 on output only field/Else process F4
      * CASE: PAR.USR Output Only Status 3 is yes
     C           P7STE8    IFEQ 'Y'                        *IF
      * Send message 'Function not available'
     C                     MOVEL'USR1942' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0004  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If Buyers Truck or Rail do not allow absorbed freight rate
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : DTL.Shipping Method is Collect Rail
      *   |- c2    : DTL.Shipping Method is Collect Truck
      *   |- c3    : DTL.Absorbed Freight Rate is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'                       *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1TBNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Freight not allowed Buyer'
     C                     MOVEL'USR2256' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     END                             *FI
      * If not Buyers Truck/Rail & AFR=0 or Block Order Changed, Get AFR
      * CASE:
      *  - (c1 OR c2)
      *   |- c1    : DTL.Shipping Method is Prepaid Rail
      *   |- c2    : DTL.Shipping Method is Prepaid Truck
      *   '-
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'                       *OR
      * R12926 DN 6/21/18-Use Co Cust AFR when AFR=0.
      * CASE: DTL.Absorbed Freight Rate CWT is EQ Zeros
     C           #1TBNB    IFEQ *ZERO                      *IF
      * Must get AFR from Co Cust. Leave as is.
      * RTV Abs Freight Rate   RT - Company/Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1BKC7    WL0002           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    #1TBNB           Absorbed Freigh
      * Send message 'Freight Rqd no buyer trck'
     C                     MOVEL'USR1281' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * R12926 DN 6/21/18-Use Co Cust AFR when Block Order Chg from B to
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Block Order Flag is Block Order
      *   |- c2    : DTL.Block Order Flag is Firm Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ 'B'                        *IF
     C           #1BCST    IFEQ 'F'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Do NOT Create Load Order Change Log for ABSRTE & ABSRSN.
     C                     MOVEL'N'       YL0006           Crt Load Order
      * Must get AFR from Co Cust. Leave as is.
      * RTV Abs Freight Rate   RT - Company/Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1BKC7    WL0002           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    #1TBNB           Absorbed Freigh
     C                     MOVEL*BLANK    #DHSSC           Abs Frt Overrid
      * Send message 'Freight Rqd no buyer trck'
     C                     MOVEL'USR1281' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Ship to customer changed
      * CASE:
      *  - c1ORc2
      *   |- c1    : DTL.Ship To Customer NE PAR.USR Ship To Customer
      *   |- c2    : DTL.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C           #1BKC7    IFNE P7BLC7                     *IF
     C           #1BKC7    ORNE P1BKC7                     *OR
      * * change the saved field if it changes. 10.27.09 rmc
     C                     Z-ADD#1BKC7    P7BLC7           USR Ship To Cus
      * RTV P.O. Required Flag RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0008           Company Number
     C                     Z-ADD#1BKC7    WL0009           Ship To Custome
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    P7PPST    P      P.O. Required F
      * Validate company/customer
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUECST           Error Status
     C                     MOVEL*BLANK    YL0018           Must Ship Error
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     Z-ADD*ZERO     P1AFTM           Requested Deliv
      * RTV OE Hold/ShipTo FlagRT - Customer  * 
     C                     EXSR SORVGN
      * Error if customer on OE hold
      * CASE: WRK.Order Entry Hold is New Order Hold
     C           WUQNST    IFEQ 'Y'                        *IF
      * Send message 'Customer hold status'
     C                     MOVEL'USR1025' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Error if ship to customer is not a Ship to Type of cust.
      * CASE: WRK.Ship To Customer Flag is No Use as Ship to Cust
     C           WURJST    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Ship to Customer Flag 'N''
     C                     MOVEL'USR2482' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Ensure P.O Required not = blank
      * CASE: PAR.P.O. Required Flag EQ WRK.BLANK
     C           P7PPST    IFEQ WUGSTX                     *IF
     C                     MOVEL'N'       P7PPST           P.O. Required F
     C                     END                             *FI
      * Error if Cust TF Exempt code changes from EC to NE and mixed orde
      * CASE: DTL.OH TF Exempt Code is Blank or Pre Comm
     C           #1FYSX    IFEQ *BLANK                     *IF
     C           #1FYSX    OREQ 'PC'
      *      no line items exist yet or pre commencement from startup
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Customer TFEx     RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0011           Ship To Custome
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    WUP3SX    P      Customer TF Exe
     C                     MOVEL*BLANK    WUB8SX           Error Flag
      * CASE: DTL.Customer TF Exempt Code NE WRK.Customer TF Exempt Code
     C           #DP3SX    IFNE WUP3SX                     *IF
      * Error Status 2 = Yes, test for error condition
      * Exc Calc Ord ExemptCd XF - Order Header TRG  * 
     C                     CALL 'PPSLXFR'              90  Exc Calc Ord Ex
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0005  30       Company Number
     C                     PARM #1C4NB    WQ0006  70       Order Number
     C                     PARM #1BKC7    WQ0007  70       Ship To Custome
     C           #1FYSX    PARM #1FYSX    WQ0008  3        OH TF Exempt Co
     C           WUB8SX    PARM WUB8SX    WQ0009  1        Error Flag
     C                     PARM 'Y'       WQ0010  1        Error Status  2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPSLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: WRK.Error Flag            USR is Yes
     C           WUB8SX    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Tf Exempt -mix error Cust'
     C                     MOVEL'USR3589' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** If no order detail recs, get cust default warehouse
      * CASE: WRK.Warehouse Code is Warehouse Code Blank
     C           WUAJCD    IFEQ *BLANK                     *IF
      * RTV 1st Warehouse      RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0015           Company Number
     C                     Z-ADD#1C4NB    WL0016           Order Number
     C                     Z-ADD*ZERO     WL0017           Order Sequence
     C                     Z-ADD*ZERO     WL0018           Order Secondary
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    WUAJCD    P      Warehouse Code
      * CASE: WRK.Warehouse Code is Warehouse Code Blank
     C           WUAJCD    IFEQ *BLANK                     *IF
      * RTV Cust Ordering Dflt2RT - Company Customer  * slm 3/26/2010
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0020           Company Number
     C                     Z-ADD#1BKC7    WL0021           Ship To Custome
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    YN0001    P      Terms Code
     C                     MOVELWL0023    YN0002    P      Sales Route Cod
     C                     MOVELWL0024    YN0003    P      Special Instruc
     C                     MOVELWL0025    YN0004    P      Special Instruc
     C                     MOVELWL0026    YN0005    P      Carrier Code
     C                     MOVELWL0027    YN0006    P      P.O. Required F
     C                     Z-ADDWL0028    YN0007           Deliver after t
     C                     MOVELWL0029    YN0008    P      Type Code
     C                     Z-ADDWL0030    YN0009           Absorbed Freigh
     C                     Z-ADDWL0031    YN0010           Mileage To Cust
     C                     MOVELWL0032    WUAJCD    P      Warehouse Code
     C                     MOVELWL0033    YN0011    P      Outside Warehou
     C                     MOVELWL0034    YN0012    P      Customer Group
     C                     MOVELWL0035    YN0013    P      Customer Group
     C                     MOVELWL0036    YN0014    P      Ord Ent Default
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELWUAJCD    #DAJCD           Warehouse Code
      * ** Rtv address
      * RTV Cust Add,Ct-A/R CstRT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0037           Ship To Custome
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    #1BRTX    P      Customer Name
     C                     MOVELWL0039    #1HMNA    P      Address Line 1
     C                     MOVELWL0040    #1HONA    P      Address Line 2
     C                     MOVELWL0041    #1HPNA    P      Address Line 3
     C                     MOVELWL0042    #1HNNA    P      City
     C                     MOVELWL0043    #1DBCD    P      State Code
     C                     MOVELWL0044    #1CKTX    P      Zip/Postal Code
     C                     Z-ADDWL0045    #1ANC7           A/R Customer Nu
     C                     MOVELWL0046    WUKXCD    P      Country Code
      * ** Check for Must Ship date error, skip Hi Plns, Dailys, Collect
      * ** Change to use the XF so changes are encorporated properly E004
      * ** Change to use the XF without SSD test, cannot change here E004
      * E01523 5/02/2011 RMC USE Req delv dt/time always for ddt calc
     C                     Z-ADD#1EIDT    WUBQDT           USR Date - ATR
     C                     Z-ADD#1AFTM    WUHLNX           USR To Time 4.0
      * CLC Must Ship-Reqd Dlv XF - Order Header TRG  * 
     C                     CALL 'PNK0XFR'              90  CLC Must Ship-R
     C                     PARM *BLANK    W0RTN   7
     C           YL0018    PARM *BLANK    WQ0011  3        Must Ship Error
     C                     PARM #1C4NB    WQ0012  70       Order Number
     C                     PARM #1A5DT    WQ0013  70       Requested Ship
     C                     PARM #1HNNA    WQ0014 20        Ship To City
     C                     PARM #1DBCD    WQ0015  2        Ship To State C
     C                     PARM #1AIC3    WQ0016  30       Company Number
     C                     PARM WUHLNX    WQ0017  40       Requested Deliv
     C                     PARM WUBQDT    WQ0018  70       Requested Deliv
     C           WUAJCD    PARM WUAJCD    WQ0019  3        Warehouse Code
     C           YL0019    PARM YL0019    WQ0020  70       Must Ship Date
     C           YL0020    PARM YL0020    WQ0021  60       Must Ship Time
     C                     PARM *ZERO     WQ0022  70       USR Order Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNK0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993637*
     C                     END
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0023  30       Company Number
     C                     PARM *BLANK    WQ0024  1        Plant Company S
     C           P5YJSX    PARM *BLANK    WQ0025  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** No Miles error if international customer     E00452
      * CASE: DTL.Ship To State Code is International Accounts
     C           #1DBCD    IFEQ '.'                        *IF
     C                     MOVEL*BLANK    YL0018           Must Ship Error
     C                     END                             *FI
      * ** No Miles error if TMSLDP is Yes             E4119        8.08.
      * CASE: PAR.Live with TPM is Yes
     C           P7O1ST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0018           Must Ship Error
     C                     END                             *FI
      * Process date error or no "Miles Betw Cities" for must ship
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR (c5 AND c6)
      *   |- c1    : LCL.Must Ship Error is No Error
      *   |- c2    : PAR.Company Organization is Not Seaboard
      *   |- c3    : DTL.Shipping Method is Collect
      *   |- c4    : LCL.Must Ship Error is Req Ship should =Must Shp
      *   |- c5    : DTL.Export Status is yes
      *   |- c6    : DTL.Load ID is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0018    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P5YJSX    IFEQ 'D'                        *IF
     C           P5YJSX    OREQ 'H'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0018    IFEQ 'RSD'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1U2ST    IFEQ 'Y'                        *IF
     C           #1RMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * **  Do nothing if no error or if High Plains, Dailys, or Collect
      * **  Clear the error flag for HP, Dailys, and CT and CR
     C                     MOVEL*BLANK    YL0018           Must Ship Error
     C                     ELSE
      * CASE: *OTHERWISE
      * deleted
      * CASE: LCL.Must Ship Error is Miles to Next=Zeros
     C           YL0018    IFEQ 'MTN'                      *IF
      * ** Error if the Miles Between Cities does not exist
      * Setup message data for message
     C                     MOVEL#1HNNA    ZA0002           Ship To City
      * Send message 'No Miles Between Cities'
     C                     MOVEL'USR3853' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     MOVEL'N'       P7GGST           USR Display fie
     C                     ELSE
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : DTL.Load ID is NE Blank
      *   |- c2    : LCL.Must Ship Error is Must Ship before NOW
      *   |- c3    : LCL.Must Ship Error is Schd Shp not bef Must Shp
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RMNB    IFNE *ZERO                      *IF
     C                     MOVEL'0'       Y0CX02  1
     C           YL0018    IFEQ 'NOW'                      *IF
     C           YL0018    OREQ 'SSD'                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Cannot deliver on time to new cust#, Scheduling must chg dates
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Cannot deliver on time'
     C                     MOVEL'USR4184' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Error if assigned to a load and has an invalid date
      * PMT Must Ship Dt NotifyPV - Order Header TRG  * 
     C                     CALL 'PDKLPVR'              90  PMT Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1EIDT    WQ0026  70       Requested Deliv
     C                     PARM YL0019    WQ0027  70       Must Ship Date
     C                     PARM #1A5DT    WQ0028  70       Requested Ship
     C                     PARM YL0020    WQ0029  60       Must Ship Time
     C                     PARM #1AFTM    WQ0030  40       Requested Deliv
     C                     PARM YL0018    WQ0031  3        Must Ship Error
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKLPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0004
      * Send message 'Cannot arrive on time-Chg'
     C                     MOVEL'USR3934' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0018           Must Ship Error
     C                     END                             *FI
      * R12926 DN 05/11/18-Ship To Cust Changed, use AFR from Co Cust. Le
      * RTV Cust Ordering Dflt2RT - Company Customer  * slm 03/26/2010
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0020           Company Number
     C                     Z-ADD#1BKC7    WL0021           Ship To Custome
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    #1AQCD    P      Terms Code
     C                     MOVELWL0023    YN0002    P      Sales Route Cod
     C                     MOVELWL0024    #1BYNA    P      Special Instruc
     C                     MOVELWL0025    #1B6NA    P      Special Instruc
     C                     MOVELWL0026    YN0005    P      Carrier Code
     C                     MOVELWL0027    YN0006    P      P.O. Required F
     C                     Z-ADDWL0028    YN0007           Deliver after t
     C                     MOVELWL0029    YN0008    P      Type Code
     C                     Z-ADDWL0030    #1TBNB           Absorbed Freigh
     C                     Z-ADDWL0031    YN0010           Mileage To Cust
     C                     MOVELWL0032    YN0016    P      Warehouse Code
     C                     MOVELWL0033    YN0011    P      Outside Warehou
     C                     MOVELWL0034    YN0012    P      Customer Group
     C                     MOVELWL0035    YN0013    P      Customer Group
     C                     MOVELWL0036    YN0014    P      Ord Ent Default
      * R12926 DN 06/27/18-Do NOT Update AFR if Shipping Method is NOT Pr
      * CASE: *OTHERWISE
      * Do NOT Create Load Order Change Log (Type=ABSRTE) if Ship To Cust
     C                     MOVEL'N'       YL0006           Crt Load Order
      * Blank Out Abs Frt Overrride Reason.
     C                     MOVEL*BLANK    #DHSSC           Abs Frt Overrid
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.Shipping Method is Collect Rail
      *   |- c2    : DTL.Shipping Method is Collect Truck
      *   '-
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'                       *OR
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     ELSE
      * CASE: *OTHERWISE
      * R12926 DN 06/13/18-Display New Customer ABS Freight Rate &
      *   Save Orig ABS Freight Rate on Screen.
     C                     Z-ADD#1TBNB    #DLMNY           Absorbed Freigh
     C                     Z-ADD#1TBNB    YL0005           Absorbed Freigh
     C                     END                             *FI
      * Rtv Customer Air Frt  RT - Customer EXT  * rmc 8/9/6
     C                     EXSR SSRVGN
      * *----------------------------------------------------------------
      * RTV Cust Name/Addr     RT - Customer  * 
     C                     EXSR STRVGN
     C                     Z-ADD#1ANC7    #1B0C7           Bill to Custome
     C                     MOVEL'Y'       P7B8ST           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Company Customer       NF'
     C                     MOVEL'USR1007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Move addr lines up if ship to addr fields are blank
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : DTL.Ship To Address Line 3 is Blank
      *   |- c2    : DTL.Ship To Address Line 2 is Blank
      *   |- c3    : DTL.Ship To City is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HPNA    IFEQ *BLANK                     *IF
     C           #1HONA    IFEQ *BLANK                     *IF
     C           #1HNNA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL#DZKT1    #1HONA           Ship To Address
     C                     MOVEL#DZJT1    #1HMNA           Ship To Address
     C                     MOVEL#DZFT1    #1HNNA           Ship To City
     C                     MOVEL#DZET1    #1DBCD           Ship To State C
     C                     MOVEL*BLANK    #1CKTX           Ship To Zip/Pos
     C                     MOVEL#DZHT1    #1CKTX           Ship To Zip/Pos
      * if usa --> format zip
      * CASE: DTL.TPM Country Code is United States
     C           #DZDT1    IFEQ 'USA'                      *IF
      * *Move-Right - /UT User Source  * 
     C                     MOVE #DZHT1    YL0021
      * CASE: LCL.Text USR 4 is Entered
     C           YL0021    IFNE *BLANK                     *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           #DZHT1    CAT  '-':ZQ    YL0022    P      Text USR 6
     C                     MOVEL*BLANK    #1CKTX           Ship To Zip/Pos
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0022    CAT  YL0021:ZQ #1CKTX    P      Ship To Zip/Pos
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Test the city if not International and not on a load   E00228
      * CASE: DTL.Ship To City is Blank
     C           #1HNNA    IFEQ *BLANK                     *IF
      * CASE: Blank city is ok for International, not on load
      *  - c1 AND c2
      *   |- c1    : DTL.Export Status is yes
      *   |- c2    : DTL.Load ID is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U2ST    IFEQ 'Y'                        *IF
     C           #1RMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1HNNA    ZA0005           Ship To City
      * Send message 'City Required'
     C                     MOVEL'USR2336' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0032  30       Company Number
     C                     PARM *BLANK    WQ0033  1        Plant Company S
     C           P5YJSX    PARM *BLANK    WQ0034  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Prompt on Ship to City                      FP1251 11/27/2007
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Ship To City
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#1HNNA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL#1HNNA    YL0012           Ship To City
     C                     MOVEL#1DBCD    YL0013           Ship To State C
      * SEL Milge Ship To City SR - Mileage Between Cities  * 
     C                     CALL 'PDWMSRR'              90  SEL Milge Ship
     C                     PARM *BLANK    W0RTN   7
     C           YL0012    PARM YL0012    WQ0035 20        To City
     C           YL0013    PARM YL0013    WQ0036  2        To State State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0012    #1HNNA           Ship To City
     C                     MOVELYL0013    #1DBCD           Ship To State C
      * E00447
      * Setup message data for message
     C                     MOVEL#1CKTX    ZA0006           Ship To Zip/Pos
      * Send message 'Zipcode not avail-dbl chk'
     C                     MOVEL'USR4180' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * ** Only test Must Ship Error if previously existed
      * CASE: LCL.Must Ship Error NE WRK.Blank for 4           USR
     C           YL0018    IFNE WUOTTX                     *IF
     C                     MOVEL*BLANK    YL0018           Must Ship Error
      * ** Use wrk context for the warehouse code
     C                     MOVEL#DAJCD    WUAJCD           Warehouse Code
      * ** Rtv warehouse from order detail, if none, get defaults
      * CASE: WRK.Warehouse Code is Warehouse Code Blank
     C           WUAJCD    IFEQ *BLANK                     *IF
      * RTV 1st Warehouse      RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0015           Company Number
     C                     Z-ADD#1C4NB    WL0016           Order Number
     C                     Z-ADD*ZERO     WL0017           Order Sequence
     C                     Z-ADD*ZERO     WL0018           Order Secondary
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    WUAJCD    P      Warehouse Code
      * CASE: WRK.Warehouse Code is Warehouse Code Blank
     C           WUAJCD    IFEQ *BLANK                     *IF
      * RTV Cust Ordering Dflt2RT - Company Customer  * slm 03/26/2010
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0020           Company Number
     C                     Z-ADD#1BKC7    WL0021           Ship To Custome
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    YN0001    P      Terms Code
     C                     MOVELWL0023    YN0002    P      Sales Route Cod
     C                     MOVELWL0024    YN0003    P      Special Instruc
     C                     MOVELWL0025    YN0004    P      Special Instruc
     C                     MOVELWL0026    YN0005    P      Carrier Code
     C                     MOVELWL0027    YN0006    P      P.O. Required F
     C                     Z-ADDWL0028    YN0007           Deliver after t
     C                     MOVELWL0029    YN0008    P      Type Code
     C                     Z-ADDWL0030    YN0009           Absorbed Freigh
     C                     Z-ADDWL0031    YN0010           Mileage To Cust
     C                     MOVELWL0032    #DAJCD    P      Warehouse Code
     C                     MOVELWL0033    YN0011    P      Outside Warehou
     C                     MOVELWL0034    YN0012    P      Customer Group
     C                     MOVELWL0035    YN0013    P      Customer Group
     C                     MOVELWL0036    YN0014    P      Ord Ent Default
     C                     END                             *FI
     C                     END                             *FI
      * ** Use clc function with no ship date, not available here    E004
      * CLC Must Ship-Reqd Dlv XF - Order Header TRG  * 
     C                     CALL 'PNK0XFR'              90  CLC Must Ship-R
     C                     PARM *BLANK    W0RTN   7
     C           YL0018    PARM *BLANK    WQ0037  3        Must Ship Error
     C                     PARM #1C4NB    WQ0038  70       Order Number
     C                     PARM #1A5DT    WQ0039  70       Requested Ship
     C                     PARM #1HNNA    WQ0040 20        Ship To City
     C                     PARM #1DBCD    WQ0041  2        Ship To State C
     C                     PARM #1AIC3    WQ0042  30       Company Number
     C                     PARM #1AFTM    WQ0043  40       Requested Deliv
     C                     PARM #1EIDT    WQ0044  70       Requested Deliv
     C           WUAJCD    PARM WUAJCD    WQ0045  3        Warehouse Code
     C           YL0019    PARM YL0019    WQ0046  70       Must Ship Date
     C           YL0020    PARM YL0020    WQ0047  60       Must Ship Time
     C                     PARM *ZERO     WQ0048  70       USR Order Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNK0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993637*
     C                     END
      * Process date order error for must ship
      * CASE:
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : LCL.Must Ship Error is No Error
      *   |- c2    : PAR.Company Organization is Not Seaboard
      *   |- c3    : DTL.Shipping Method is Collect
      *   |- c4    : LCL.Must Ship Error is Req Ship should =Must Shp
      *   '-
     C           YL0018    IFEQ *BLANK                     *IF
     C           P5YJSX    OREQ 'D'                        *OR
     C           P5YJSX    OREQ 'H'
     C           #1Q2CD    OREQ 'CR'                       *OR
     C           #1Q2CD    OREQ 'CT'
     C           YL0018    OREQ 'RSD'                      *OR
      * **  Do nothing if no error or if High Plains, Dailys, or Collect
      * **  Clear the error flag for HP, Dailys, and CT and CR
     C                     MOVEL*BLANK    YL0018           Must Ship Error
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Must Ship Error is Miles to Next=Zeros
     C           YL0018    IFEQ 'MTN'                      *IF
      * ** Info Error if the Miles Between Cities does not exist
      * Setup message data for message
     C                     MOVEL#1HNNA    ZA0007           Ship To City
     C                     MOVEL#1DBCD    ZA0008           Ship To State C
      * Send message 'No Miles Betw Cities'
     C                     MOVEL'USR3854' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P7GGST           USR Display fie
     C                     MOVEL*BLANK    YL0018           Must Ship Error
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Load ID is NE Blank
      *   |- c2    : LCL.Must Ship Error is Error List
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RMNB    IFNE *ZERO                      *IF
     C           YL0018    IFEQ 'DDD'                      *IF
     C           YL0018    OREQ 'MTN'
     C           YL0018    OREQ 'NOW'
     C           YL0018    OREQ 'MSD'
     C           YL0018    OREQ 'RSD'
     C           YL0018    OREQ 'SSD'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Change the Customer Number. Dates cannot be changed here
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0009           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0009           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Cannot deliver on time'
     C                     MOVEL'USR4184' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0007           Letter of Credi
     C                     MOVEL#DAKU1    YL0007           Letter of Credi
      * ** Dates cannot be changed here so tests had to be changed E00447
     C                     END
      * Check relations
      * Check reference to Order Types
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9937  *
     C                     END
      * Check reference to Customer
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9940  *
     C                     END
      * Check reference to Terms
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * ** Get country code-skip miles between cities test if internation
      * RTV Country Code       RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0013           Ship To Custome
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUKXCD    P      Country Code
      * ** Validate, skip if Collect or not Seaboard or International
      * CASE:
      *  - c1 OR c2 OR c3 OR (c4 AND c5) OR c6
      *   |- c1    : DTL.Shipping Method is Collect Truck
      *   |- c2    : DTL.Shipping Method is Collect Rail
      *   |- c3    : PAR.Company Organization is Not Seaboard
      *   |- c4    : WRK.Country Code is Entered
      *   |- c5    : WRK.Country Code is Not USA
      *   |- c6    : DTL.Ship To State Code is International Accounts
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1Q2CD    IFEQ 'CT'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P5YJSX    IFEQ 'D'                        *IF
     C           P5YJSX    OREQ 'H'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WUKXCD    IFNE *BLANK                     *IF
     C           WUKXCD    IFNE 'USA'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1DBCD    IFEQ '.'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Country Code is USA
      *   |- c2    : WRK.Country Code is Blank
      *   '-
     C           WUKXCD    IFEQ 'USA'                      *IF
     C           WUKXCD    OREQ *BLANK                     *OR
      * ** Validate city and spelling of city          FP1251 11/27/2007
      * CASE: DTL.Ship To City is NE Blanks
     C           #1HNNA    IFNE *BLANK                     *IF
      * ** Convert City and State to caps before testing existance
      * ** skip periods and commas when converting (none in miles btwn ci
      * CVT to Upper Alpha 2   XF - /UT User Source  * 
     C                     CALL 'PNK2XFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HNNA    WQ0055 30        Case Sensitive
     C           WUHNNA    PARM *BLANK    WQ0056 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNK2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
      * CVT to Upper w/SpclChr XF - /UT User Source  * 
     C                     CALL 'PMREXFR'              90  CVT to Upper w/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1DBCD    WQ0057 30        Case Sensitive
     C           WUDBCD    PARM *BLANK    WQ0058 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMREXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
      * ** Only test intern'l orders if port city is entered   E00452
      * CASE: WRK.Ship To State Code is International Accounts
     C           WUDBCD    IFEQ '.'                        *IF
      * RTV OHE Ship fields    RT - Order Header Extension  * 
     C                     EXSR SURVGN
      * CASE: WRK.Shipping Line is entered
     C           WUXACD    IFNE *BLANK                     *IF
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
     C                     EXSR SVRVGN
      * Val Mileage Existance RT - Mileage Between Cities  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWUHNNA    WL0047    P      To City
     C                     MOVELWUDBCD    WL0048    P      To State State
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0049    WUWXST    P      Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If intern'l and no port entered yet, force to normal condition
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Mileage Existance RT - Mileage Between Cities  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWUHNNA    WL0047    P      To City
     C                     MOVELWUDBCD    WL0048    P      To State State
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0049    WUWXST    P      Record Found US
     C                     END                             *FI
      * ** Check spelling of entered city against Miles Between Cities fi
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
      * ** Send info message for now, maybe change to error message
      * ** later if this problem isn't corrected.
      * Skip Miles betw cities test if Live with TPM          E004119
      * CASE: PAR.Live with TPM is Yes
     C           P7O1ST    IFEQ 'Y'                        *IF
     C                     ADD  1         YL0023           USR Count
     C                     END                             *FI
      * ** Only send error message once                       FP1251 LJB
      * CASE: LCL.USR Count is EQ 0
     C           YL0023    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#1HNNA    ZA0010           Ship To City
     C                     MOVEL#1DBCD    ZA0011           Ship To State C
      * Send message 'No Miles Betw Cities'
     C                     MOVEL'USR3854' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ADD  1         YL0023           USR Count
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Purchase order may be required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.P.O. Required Flag is yes
      *   |- c2    : DTL.Customer Purchase Order # EQ WRK.BLANK
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P7PPST    IFEQ 'Y'                        *IF
     C           #1BCNA    IFEQ WUGSTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.Block Order Flag is Block Order
     C           #1BCST    IFEQ 'B'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1BCNA    ZA0012           Customer Purcha
      * Send message 'P.O. Required'
     C                     MOVEL'USR1243' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If country is CAN or US, zip code is required
      * CASE: US or Canada
      *  - c1 OR c2 OR c3
      *   |- c1    : WRK.Country Code is Blank
      *   |- c2    : WRK.Country Code is USA
      *   |- c3    : WRK.Country Code is Canada
      *   '-
     C           WUKXCD    IFEQ *BLANK                     *IF
     C           WUKXCD    OREQ 'USA'                      *OR
     C           WUKXCD    OREQ 'CAN'                      *OR
      * CASE: DTL.Ship To Zip/Postal Code EQ WRK.BLANK
     C           #1CKTX    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1CKTX    ZA0013           Ship To Zip/Pos
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If Buyers Truck or Rail don't allow ABS Frt Override Rsn-R12926 D
      * CASE:
      *  - (c1 OR c2) AND NOTc3
      *   |- c1    : DTL.Shipping Method is Collect Rail
      *   |- c2    : DTL.Shipping Method is Collect Truck
      *   |- c3    : DTL.Abs Frt Override Reason is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'                       *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #DHSSC    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,002   CAT  @CN,003:ZQYL0024    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0024    ZA0014           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL*BLANK    #DHSSC           Abs Frt Overrid
     C                     END                             *FI
      * If not Buyers Truck or Rail, Validate ABS Frt O/R Rsn-R12926 DN 6
      * CASE:
      *  - (c1 OR c2) AND c3 AND c4 ANDc5
      *   |- c1    : DTL.Shipping Method is Prepaid Rail
      *   |- c2    : DTL.Shipping Method is Prepaid Truck
      *   |- c3    : DTL.Abs Frt Override Reason is Not Entered
      *   |- c4    : DTL.Absorbed Freight Rate CWT NE LCL.Absorbed Freigh
      *   |- c5    : DTL.Absorbed Freight Rate 1 NE DTL.Absorbed Freight
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'                       *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #DHSSC    IFEQ *BLANK                     *IF
     C           #1TBNB    IFNE YL0005                     *IF
     C           #DLMNY    IFNE #1TBNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If Order ABS Freight Rate was changed, then ABS Frt Override Reas
      * is required. (Compared to Orig. ABS Freight Rate)
      * Setup message data for message
     C                     MOVEL#DHSSC    ZA0015           Abs Frt Overrid
      * Send message 'ABS Frt Ovr Rsn Must Exst'
     C                     MOVEL'USR5084' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END
      * Ship To Name required
     C           #1BRTX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Ship To State Code required
     C           #1DBCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9937  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Date required
     C           #1A0DT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9940  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Load Type required
     C           #1VDST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9941  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Load Plan Order required
     C           #1U4ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9943  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Print Pick Slip required
     C           #1U5ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9944  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Shrink Wrap required
     C           #1VFST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9945  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Slip Sheet required
     C           #1VGST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9947  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Email Cust On Order Ship required
     C           #1FOSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9949  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * Customer change
      * CASE: PAR.Ship To Customer NE DTL.Ship To Customer
     C           P1BKC7    IFNE #1BKC7                     *IF
      * * above was comparing to usr ship to customer  10.27.09 rmc
      * Update A/R Summary if A/R Customer changed
      * CASE: DTL.A/R Customer Number NE PAR.A/R Customer Number
     C           #1ANC7    IFNE P1ANC7                     *IF
      * subtract order's A/R value (old customer) from OLD customer's Val
     C           *ZERO     SUB  #1VRVA    WUVRVA           A/R order Value
      * 12/07/06 PKD PK0040 Use Accounting Company.  if there
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
     C                     EXSR SXRVGN
      * CASE: LCL.Accounting Company is Equal to zero
     C           YL0026    IFEQ *ZERO                      *IF
      * UPD Chg Val Open Ord   RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0050           Company Number
     C                     Z-ADDP1ANC7    WL0051           A/R Customer Nu
     C                     Z-ADDWUVRVA    WL0052           A/R order Value
     C                     EXSR SZRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Chg Val Open Ord   RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0026    WL0050           Company Number
     C                     Z-ADDP1ANC7    WL0051           A/R Customer Nu
     C                     Z-ADDWUVRVA    WL0052           A/R order Value
     C                     EXSR SZRVGN
     C                     END                             *FI
      * subtract order value from value of open orders in A/R Summ; then
      *    make order A/R value = 0
      * CHG A/R Order Value    CH - PD Order Header  * 
     C                     EXSR TCCHRC
     C                     END                             *FI
      * R12926 DN 05/11/18-Absorbed Freight Rate is now input. Commented
     C                     Z-ADD#1BKC7    P7BLC7           USR Ship To Cus
     C                     Z-ADD#1ANC7    P1ANC7           A/R Customer Nu
      * update detail ship to customer         ALSO 8/25/05 Ord TF Exempt
      * CHG All Ship Customer  RT - Order Detail  * 
     C                     EXSR TDRVGN
      * Update Load/Order Change Log if in change mode
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'SHPCST'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUMNTX           Change Log Prio
     C                     MOVELP1BKC7    WUMNTX           Change Log Prio
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVEL#1BKC7    WUMOTX           Change Log New
      * CASE: DTL.Load ID is NE Blank
     C           #1RMNB    IFNE *ZERO                      *IF
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWUMNTX    PBMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0059  70       Load ID
     C                     PARM WURVST    WQ0060  6        Load Change Typ
     C                     PARM WUUJST    WQ0061  3        Department Cont
     C                     PARM WUMNTX    WQ0062 12        Change Log Prio
     C                     PARM WUMOTX    WQ0063 12        Change Log New
     C                     PARM #1AIC3    WQ0064  30       Company Number
     C                     PARM #1C4NB    WQ0065  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1BKC7    P1BKC7           Ship To Custome
      * Upd load header if load type has changed.
      * CASE: PAR.Load Type NE DTL.Load Type
     C           P1VDST    IFNE #1VDST                     *IF
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * OMS132:  Dflt Bulk Loads to Pounds, regular loads to Miles
      * CASE: DTL.Load Type is Regular
     C           #1VDST    IFEQ 'R'                        *IF
     C                     MOVEL'M'       P8XQST           Allocate Pounds
     C                     ELSE
      * CASE: DTL.Load Type is Bulk
     C           #1VDST    IFEQ 'B'                        *IF
     C                     MOVEL'T'       P8XQST           Allocate Pounds
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       P8XQST           Allocate Pounds
     C                     END                             *FI
     C                     END                             *FI
      * CHG Ld Typ/Shp Mth/Alc CH - Load Header  * 
     C                     EXSR TGCHRC
      * Update Load/Order Change Log if in change mode
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'LODTYP'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELP1VDST    PBMNTX    P      Change Log Prio
     C                     MOVEL#1VDST    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     END                             *FI
     C                     MOVEL#1VDST    P1VDST           Load Type
     C                     END                             *FI
      * ** PO# chgd, order is on a load, write log and unaccept  E00139
      * CASE:
      *  - c1 AND c3
      *   |- c1    : DTL.Customer Purchase Order # NE PAR.Customer Purcha
      *   |- c3    : PAR.Load ID is NE Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BCNA    IFNE P1BCNA                     *IF
     C           P8RMNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Always write a log record if the PO# changes    E00139
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'PO#CHG'  YL0028           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDP8RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELYL0028    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELP1BCNA    PBMNTX    P      Change Log Prio
     C                     MOVEL#1BCNA    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9948  *
     C                     END
      * RTV Load Acceptance Sw RT - Load Header  * 
     C                     EXSR THRVGN
      * ** Only unaccept if load has already been accepted.
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Load Acceptance Flag is Load Accepted
      *   |- c2    : PAR.MG Created Load is Not MG Created Load
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'A'                        *IF
     C           P7RYSX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Unaccept load if PO# chg on any of the orders
      * CHG Load Acceptance Sw CH - Load Header  * 
     C                     EXSR TICHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#1BCNA    P1BCNA           Customer Purcha
      * R12926 DN 05/10/18-Create Load Order Change Log for Chg Type=ABSR
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * Absorbed Freight Rate Changed & Crt Load Order Chg Log=Yes.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Absorbed Freight Rate CWT NE LCL.Absorbed Freigh
      *   |- c2    : LCL.Crt Load Order Chg Log is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1TBNB    IFNE YL0003                     *IF
     C           YL0006    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ABSRTE'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * Format Prior Absorbed Freight Rate with Decimal.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0030           Text USR 5
     C                     MOVELYL0003    YL0030           Text USR 5
     C                     Z-ADD3         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0030:ZQ YL0031    P  90  USR Text 3  3a
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0030:ZQ YL0032    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0031    CAT  '.':ZQ    YL0033    P      Absorbed Freigh
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0033    CAT  YL0032:ZQ YL0033    P      Absorbed Freigh
     C                     MOVEL*BLANK    WUMNTX           Change Log Prio
     C                     MOVELYL0033    WUMNTX           Change Log Prio
      * Format New Absorbed Freight Rate with Decimal.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0030           Text USR 5
     C                     MOVEL#1TBNB    YL0030           Text USR 5
     C                     Z-ADD3         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0030:ZQ YL0031    P  90  USR Text 3  3a
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0030:ZQ YL0032    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0031    CAT  '.':ZQ    YL0033    P      Absorbed Freigh
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0033    CAT  YL0032:ZQ YL0033    P      Absorbed Freigh
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVELYL0033    WUMOTX           Change Log New
      * Append Abs Frt Override Reason to Last 2 Pos. for Change Log New
      * CASE:
      *  - NOTc1
      *   |- c1    : DTL.Abs Frt Override Reason is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DHSSC    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SET Abs Frt Ovr Rsn    US - /UT User Source  * 
      ** APPEND ABS FRT OVERRIDE REASON TO LAST 2 POS.
     C                     MOVE #DHSSC    WUMOTX
     C                     END                             *FI
      * CASE: DTL.Load ID is NE Blank
     C           #1RMNB    IFNE *ZERO                      *IF
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWUMNTX    PBMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT Load/OrderChg n/ld2XF - Load Order Change Log  * 
     C                     CALL 'PUIAXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0066  70       Load ID
     C                     PARM WURVST    WQ0067  6        Load Change Typ
     C                     PARM WUUJST    WQ0068  3        Department Cont
     C                     PARM WUMNTX    WQ0069 12        Change Log Prio
     C                     PARM WUMOTX    WQ0070 12        Change Log New
     C                     PARM ##USR     WQ0071 10        User Id
     C                     PARM ##PGM     WQ0072 10        Job Name
     C                     PARM #1AIC3    WQ0073  30       Company Number
     C                     PARM #1C4NB    WQ0074  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUIAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit Header
      * CASE: DTL.*CMD key is *Order Header
     C           *IN15     IFEQ '1'                        *IF
     C                     MOVEL@CN,004   P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Details
      * CASE: DTL.*CMD key is *Order Details
     C           *IN18     IFEQ '1'                        *IF
     C                     MOVEL@CN,005   P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Order Header & Ext CH - Order Header TRG  * 
     C                     EXSR TJCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YFRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1AIC3    IFEQ *ZERO                      Company Number
     C           P1C4NB    OREQ *ZERO                      Order Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           P7STE8    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P7E5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C                     MOVEL'0'       *IN76
     C           P7STE7    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           YL0001    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #DP3SX           Customer TF Exe
     C                     MOVEL*BLANK    #DJUNA           USR Description
     C                     MOVEL*BLANK    #DPFTX           Text 1 Length U
     C                     MOVEL*BLANK    #DZJT1           TPM Address 1
     C                     MOVEL*BLANK    #DZKT1           TPM Address 2
     C                     MOVEL*BLANK    #DZFT1           TPM City
     C                     MOVEL*BLANK    #DZET1           TPM Region/Stat
     C                     MOVEL*BLANK    #DZHT1           TPM Zip Code
     C                     MOVEL*BLANK    #DZDT1           TPM Country Cod
     C                     Z-ADD*ZERO     #1A5DT           Requested Ship
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
     C                     MOVEL*BLANK    #DAJCD           Warehouse Code
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     Z-ADD*ZERO     #1ANC7           A/R Customer Nu
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     MOVEL*BLANK    #DKXCD           Country Code
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     Z-ADD*ZERO     #1ACDT           Cancel Date
     C                     MOVEL*BLANK    #1B6NA           Special Instruc
     C                     MOVEL*BLANK    #1BYNA           Special Instruc
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #1GTST           Comment Print A
     C                     MOVEL*BLANK    #1GVST           Comment Print I
     C                     MOVEL*BLANK    #1QFST           Comment Print S
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1GJST           Order in Use
     C                     MOVEL*BLANK    #1GWST           Header Status
     C                     MOVEL*BLANK    #1GXST           Header Status L
     C                     MOVEL*BLANK    #1GYST           Order Type Prin
     C                     MOVEL*BLANK    #1AIVN           User Original E
     C                     Z-ADD*ZERO     #1CXDT           Date of Origina
     C                     Z-ADD*ZERO     #1JZVA           Order Value Tot
     C                     Z-ADD*ZERO     #1A1WG           Order Weight To
     C                     MOVEL*BLANK    #1XIST           Credit Hold
     C                     MOVEL*BLANK    #1XJST           Production Hold
     C                     MOVEL*BLANK    #1XKST           New Customer Ho
     C                     MOVEL*BLANK    #1E8CD           Accounts Receiv
     C                     MOVEL*BLANK    #1E9CD           Accounts Receiv
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1U0ST           Price Audit
     C                     MOVEL*BLANK    #1U1ST           Price Status
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     Z-ADD*ZERO     #1ATIN           Attach to Invoi
     C                     MOVEL*BLANK    #DV4T1           OHE Abs Rate Ov
     C                     MOVEL*BLANK    #1GUST           Comment Print P
     C                     Z-ADD*ZERO     #1RSRN           Resell Referenc
     C                     MOVEL*BLANK    #1MINA           Special Comment
     C                     MOVEL*BLANK    #1WBST           Affect Auto Acc
     C                     MOVEL*BLANK    #DJ1T1           OHE Booking Num
     C                     MOVEL*BLANK    #DAKU1           String 30
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
     C                     Z-ADD*ZERO     #1AFTM           Requested Deliv
     C                     MOVEL*BLANK    #1MHNA           Special Comment
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1BFCD           Manager Level C
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     Z-ADD*ZERO     #1T3NB           Attach to Order
     C                     MOVEL*BLANK    #1SICD           Reason for Pric
     C                     Z-ADD*ZERO     #1CONB           Invoice Number
     C                     MOVEL*BLANK    #1CEST           Invoice Suffix
     C                     Z-ADD*ZERO     #1AWDT           Invoice Date
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     MOVEL*BLANK    #1XUST           Trans Contol AS
     C                     MOVEL*BLANK    #1Z1ST           Modified Flag
     C                     Z-ADD*ZERO     #1VRVA           A/R order Value
     C                     MOVEL*BLANK    #1OBST           Billing Activit
     C                     MOVEL*BLANK    #1BDST           Order Certifica
     C                     Z-ADD*ZERO     #1B7VL           Invoice Order V
     C                     MOVEL*BLANK    #1GASX           Process Sts for
     C                     MOVEL*BLANK    #1GBSX           Order Conf Fax
     C                     MOVEL*BLANK    #1GCSX           Manifest Fax St
     C                     MOVEL*BLANK    #1GDSX           Invoice Fax Sts
     C                     MOVEL*BLANK    #1FNSX           Transfer in Sto
     C                     MOVEL*BLANK    #1FPSX           Order Emailed
     C                     MOVEL*BLANK    #1FQSX           Export Docs Go
     C                     MOVEL*BLANK    #1FRSX           Shipping Temp C
     C                     MOVEL*BLANK    #1FSSX           Broker Order St
     C                     MOVEL*BLANK    #1FUSX           Order Requires
     C                     MOVEL*BLANK    #1FVSX           OH Load Plan Re
     C                     MOVEL*BLANK    #1FWSX           Export USDA App
     C                     MOVEL*BLANK    #1FXSX           HPB Ship to War
     C                     MOVEL*BLANK    #1FYSX           OH TF Exempt Co
     C                     Z-ADD*ZERO     #1NODT           OH Appt Confirm
     C                     Z-ADD*ZERO     #1NPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     #1NQDT           Load Actual Shi
     C                     Z-ADD*ZERO     #1NRDT           Load BOL Comple
     C                     Z-ADD*ZERO     #1NSDT           Load Truck Depa
     C                     Z-ADD*ZERO     #1BQTM           Time of Origina
     C                     Z-ADD*ZERO     #1BRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     #1BSTM           Load BOL Comple
     C                     Z-ADD*ZERO     #1BTTM           Load Truck Depa
     C                     Z-ADD*ZERO     #1H0NX           Act Frt Referen
     C                     Z-ADD*ZERO     #1H1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     #1H2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     #1H3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     #1H4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     #1C0C7           Claim Number
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     Z-ADD*ZERO     #1B0C7           Bill to Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1B0C7
     C                     MOVEL*BLANK    #1BRTX           Ship To Name
     C                     MOVEL*BLANK    #1AETX           Bill to Name
     C                     MOVEL*BLANK    #1HMNA           Ship To Address
     C                     MOVEL*BLANK    #1B1NA           Bill to Address
     C                     MOVEL*BLANK    #1HONA           Ship To Address
     C                     MOVEL*BLANK    #1B3NA           Bill to Address
     C                     MOVEL*BLANK    #1HPNA           Ship To Address
     C                     MOVEL*BLANK    #1B4NA           Bill to Address
     C                     MOVEL*BLANK    #1HNNA           Ship To City
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     MOVEL*BLANK    #1CKTX           Ship To Zip/Pos
     C                     MOVEL*BLANK    #1B2NA           Bill to City
     C                     MOVEL*BLANK    #1BHCD           Bill to State C
     C                     MOVEL*BLANK    #1C8TX           Bill to Zip/Pos
     C                     MOVEL*BLANK    #1JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     MOVEL*BLANK    #DBCCD           Salesperson Cod
     C                     MOVEL*BLANK    #DALTX           Salesperson Nam
     C                     Z-ADD*ZERO     #DMTCU           Mileage To Cust
     C                     MOVEL*BLANK    #1AQCD           Terms Code
     C                     MOVEL*BLANK    #1FTSX           Air Freight Ord
     C                     Z-ADD*ZERO     #DLMNY           Absorbed Freigh
     C                     Z-ADD*ZERO     #1A0DT           Order Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1A0DT
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     MOVEL*BLANK    #1U4ST           Load Plan Order
     C                     MOVEL*BLANK    #1VEST           Palletize
     C                     Z-ADD*ZERO     #DLNNY           Absorbed Freigh
     C                     MOVEL*BLANK    #1U5ST           Print Pick Slip
     C                     MOVEL*BLANK    #1VFST           Shrink Wrap
     C                     MOVEL*BLANK    #DHSSC           Abs Frt Overrid
     C                     MOVEL*BLANK    #1VGST           Slip Sheet
     C                     MOVEL*BLANK    #1BCNA           Customer Purcha
     C                     MOVEL*BLANK    #1FOSX           Email Cust On O
     C                     Z-ADD*ZERO     #1BPTM           Maximum Gross W
     C                     MOVEL*BLANK    #1BCST           Block Order Fla
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BECPFK fields to screen
      *================================================================
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     MOVELBEBCST    #1BCST           Block Order Fla
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELP4APTX    #PAPTX           Company Name
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
      * Check restriction within
     C                     EXSR VICKRL
      * USER: Initialize key screen
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR TMRVGN
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1B0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1B0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1B0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  #1A0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A0DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Nbr of Orders/Load RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         P7NB01           Number of Order
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSA02           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           Load ID
      * Setup key
     C                     Z-ADDBERMNB    WQSA02           Load ID
      * Establish starting position
     C           KRSSA     SETLL@BFCPRQ                    *
     C           KRSSA     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         P7NB01           Number of Order
     C           KRSSA     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV ld Accpt/Load Status - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WUPKST           Load Status
     C                     MOVEL*BLANK    WURMST           Load Acceptance
     C                     MOVEL*BLANK    P7RYSX           MG Created Load
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJRMNB    WQSB02           Load ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB02           Load ID
      * Setup key
     C                     Z-ADDBERMNB    WQSB02           Load ID
      * Establish starting position
     C           KRSSB     SETLL@FJCPSB                    *
     C           KRSSB     READE@FJCPSB                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    WUPKST           Load Status
     C                     MOVELFJRMST    WURMST           Load Acceptance
     C                     MOVELFJRYSX    P7RYSX           MG Created Load
     C           KRSSB     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Abs Freight Rate   RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    EOAIC3           Company Number
     C                     Z-ADDWL0002    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0003           Absorbed Freigh
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEOTBNB    WL0003           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Org ABS & Reason   RT - Order Header Extension  * Get AFO Re
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           OHE Abs Rate Ov
     C                     Z-ADD*ZERO     WL0007           OHE Orig ABS Fr
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0004    AMAIC3           Company Number
     C                     Z-ADDWL0005    AMC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@AMREJF              90    *
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMV4T1    WL0006           OHE Abs Rate Ov
     C                     Z-ADDAMQMNY    WL0007           OHE Orig ABS Fr
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - PD Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELBER4CD    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSE     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBCCD           Salesperson Cod
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEBCCD    #DBCCD           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVEL#DBCCD    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSF     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBCCD           Salesperson Cod
     C                     MOVEL*BLANK    #DALTX           Salesperson Nam
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPBCCD    #DBCCD           Salesperson Cod
     C                     MOVELAPALTX    #DALTX           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV P.O. Required Flag RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0008    WBAIC3           Company Number
     C                     Z-ADDWL0009    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@EOREUB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           P.O. Required F
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBPPST    WL0010           P.O. Required F
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Miles to Customer  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDBEAIC3    EOAIC3           Company Number
     C                     Z-ADDBEBKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@EOREXM              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEOMTCU    #DMTCU           Mileage To Cust
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * VAL Active Dtl exists  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSI01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSI02           Order Number
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSI01           Company Number
     C                     Z-ADDBEC4NB    WQSI02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSI     SETLL@BGWKAE                    *
     C           KRSSI     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Number Orders/Stop RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSJ02           Load ID
     C           *LIKE     DEFN FLC4NB    WQSJ03           Order Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ02           Load ID
     C                     KFLD           WQSJ03           Order Number
      * Setup key
     C                     Z-ADDBERMNB    WQSJ02           Load ID
     C                     Z-ADDBEC4NB    WQSJ03           Order Number
      * Establish starting position
     C           KRSSJ     SETLL@FLCPKF                    *
     C           KRSSJ     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Sum Orders on Stop RT - Load Detail  * 
     C                     EXSR SKRVGN
     C           KRSSJ     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Sum Orders on Stop RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         P7NB02           Number of Order
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSK02           Load ID
     C           *LIKE     DEFN WCRVNB    WQSK03           Stop/Drop
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK02           Load ID
     C                     KFLD           WQSK03           Stop/Drop
      * Setup key
     C                     Z-ADDFLRMNB    WQSK02           Load ID
     C                     Z-ADDFLRVNB    WQSK03           Stop/Drop
      * Establish starting position
     C           KRSSK     SETLL@FLCPEB                    *
     C           KRSSK     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         P7NB02           Number of Order
     C           KRSSK     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Customer TFEx     RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVELWUGSTX    WL0012           Customer TF Exe
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0011    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSL     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUGSTX    WL0012           Customer TF Exe
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELNEP3SX    WL0012           Customer TF Exe
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Country Code       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0013    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSM     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBKXCD    WL0014           Country Code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Booking # f/ord   RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSN     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DJ1T1           OHE Booking Num
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMJ1T1    #DJ1T1           OHE Booking Num
     C                     GOTO SNEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV OE Hold/ShipTo FlagRT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSO     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUQNST           Order Entry Hol
     C                     MOVEL*BLANK    WURJST           Ship To Custome
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBQNST    WUQNST           Order Entry Hol
     C                     MOVELBBRJST    WURJST           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSP02           Order Number
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADDWL0015    WQSP01           Company Number
     C                     Z-ADDWL0016    WQSP02           Order Number
     C                     Z-ADDWL0017    WDDPNB           Order Sequence
     C                     Z-ADDWL0018    WDUENB           Order Secondary
      * Establish starting position
     C           KPSSP     SETLL@BGWKL1                    *
     C           KRSSP     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWDAJCD    WL0019           Warehouse Code
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Cust Ordering Dflt2RT - Company Customer  * slm 3/26/2010
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0020    WBAIC3           Company Number
     C                     Z-ADDWL0021    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSQ     CHAIN@EOREUB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0022           Terms Code
     C                     MOVEL*BLANK    WL0023           Sales Route Cod
     C                     MOVEL*BLANK    WL0024           Special Instruc
     C                     MOVEL*BLANK    WL0025           Special Instruc
     C                     MOVEL*BLANK    WL0026           Carrier Code
     C                     MOVEL*BLANK    WL0027           P.O. Required F
     C                     Z-ADD*ZERO     WL0028           Deliver after t
     C                     MOVEL*BLANK    WL0029           Type Code
     C                     Z-ADD*ZERO     WL0030           Absorbed Freigh
     C                     Z-ADD*ZERO     WL0031           Mileage To Cust
     C                     MOVEL*BLANK    WL0032           Warehouse Code
     C                     MOVEL*BLANK    WL0033           Outside Warehou
     C                     MOVEL*BLANK    WL0034           Customer Group
     C                     MOVEL*BLANK    WL0035           Customer Group
     C                     MOVEL*BLANK    WL0036           Ord Ent Default
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAQCD    WL0022           Terms Code
     C                     MOVELWBR4CD    WL0023           Sales Route Cod
     C                     MOVELWBBYNA    WL0024           Special Instruc
     C                     MOVELWBB6NA    WL0025           Special Instruc
     C                     MOVELWBBZNA    WL0026           Carrier Code
     C                     MOVELWBPPST    WL0027           P.O. Required F
     C                     Z-ADDWBR5NB    WL0028           Deliver after t
     C                     MOVELWBBOCD    WL0029           Type Code
     C                     Z-ADDWBTBNB    WL0030           Absorbed Freigh
     C                     Z-ADDWBMTCU    WL0031           Mileage To Cust
     C                     MOVELWBAJCD    WL0032           Warehouse Code
     C                     MOVELWBX9ST    WL0033           Outside Warehou
     C                     MOVELWBT9CD    WL0034           Customer Group
     C                     MOVELWBUBCD    WL0035           Customer Group
     C                     MOVELWBRBST    WL0036           Ord Ent Default
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Cust Add,Ct-A/R CstRT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0037    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSR     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    WL0038           Customer Name
     C                     MOVELBBACNA    WL0039           Address Line 1
     C                     MOVELBBADNA    WL0040           Address Line 2
     C                     MOVELBBAENA    WL0041           Address Line 3
     C                     MOVELBBAJNA    WL0042           City
     C                     MOVELBBBGCD    WL0043           State Code
     C                     MOVELBBBTTX    WL0044           Zip/Postal Code
     C                     Z-ADDBBANC7    WL0045           A/R Customer Nu
     C                     MOVELBBKXCD    WL0046           Country Code
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Customer Air Frt  RT - Customer EXT  * rmc 8/9/6
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSS     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1FTSX           Air Freight Ord
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNEP0SX    #1FTSX           Air Freight Ord
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Cust Name/Addr     RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1ANC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSST     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    #1AETX           Customer Name
     C                     MOVELBBACNA    #1B1NA           Address Line 1
     C                     MOVELBBADNA    #1B3NA           Address Line 2
     C                     MOVELBBAENA    #1B4NA           Address Line 3
     C                     MOVELBBAJNA    #1B2NA           City
     C                     MOVELBBBGCD    #1BHCD           State Code
     C                     MOVELBBBTTX    #1C8TX           Zip/Postal Code
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV OHE Ship fields    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSU     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXACD           Shipping Line
     C                     MOVEL*BLANK    WUOANA           Port Delv Termi
     C                     MOVEL*BLANK    WUHBAA           OHE City
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMXACD    WUXACD           Shipping Line
     C                     MOVELAMOANA    WUOANA           Port Delv Termi
     C                     MOVELAMHBAA    WUHBAA           OHE City
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           LCXACD           Shipping Line
     C                     KFLD           LCOANA           Port Delv Termi
      * Setup key
     C                     MOVELWUXACD    LCXACD           Shipping Line
     C                     MOVELWUOANA    LCOANA           Port Delv Termi
      * Establish starting position
     C           KRSSV     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUHNNA           Port City
     C                     MOVEL*BLANK    WUDBCD           Sail Port State
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLCOKTX    WUHNNA           Port City
     C                     MOVELLCXBCD    WUDBCD           Sail Port State
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Val Mileage Existance RT - Mileage Between Cities  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN LFXGCD    WQSW01           To City
     C           *LIKE     DEFN LFXHCD    WQSW02           To State State
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           To City
     C                     KFLD           WQSW02           To State State
      * Setup key
     C                     MOVELWL0047    WQSW01           To City
     C                     MOVELWL0048    WQSW02           To State State
      * Establish starting position
     C           KRSSW     SETLL@LFREY8                    *
     C           KRSSW     READE@LFREY8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2457' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0049           Record Found US
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0049           Record Found US
     C                     GOTO SWEXIT                     *QUIT
     C           KRSSW     READE@LFREY8                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSX01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSX02           Order Number
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSX01           Company Number
     C                     Z-ADD#1C4NB    WQSX02           Order Number
      * Establish starting position
     C           KRSSX     SETLL@BGWKL1                    *
     C           KRSSX     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WDGMST    IFEQ 'L'                        *IF
     C           WDGMST    OREQ 'A'
     C           WDGMST    OREQ 'C'
     C           WDGMST    OREQ 'R'
     C           WDGMST    OREQ 'E'
     C           WDGMST    OREQ 'H'
     C           WDGMST    OREQ 'I'
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
     C                     EXSR SYRVGN
     C                     MOVELWDAJCD    YN0016           Warehouse Code
     C                     GOTO SXEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSX     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWDAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSY     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0025           Shipping Compan
     C                     Z-ADD*ZERO     YL0026           Accounting Comp
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBWC3    YL0025           Shipping Compan
     C                     Z-ADDADBTC3    YL0026           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * UPD Chg Val Open Ord   RT - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       Value of Open O
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           BCAIC3           Company Number
     C                     KFLD           BCANC7           A/R Customer Nu
      * Setup key
     C                     Z-ADDWL0050    BCAIC3           Company Number
     C                     Z-ADDWL0051    BCANC7           A/R Customer Nu
      * Establish starting position
     C           KRSSZ     CHAIN@BCREFE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0172' W0RTN   7
      * USER: Processing if Data record not found
      * This shouldn't be used here--A/R Summary is created when an order
      * is created
      * CRT A/R Summary        CR - A/R Summary  * 
     C                     EXSR TACRRC
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           BCEEVA    ADD  WL0052    WN0001           Value of Open O
      * CHG Value Open Orders  CH - A/R Summary  * 
     C                     EXSR TBCHRC
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * CRT A/R Summary        CR - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  60       Job Time
     C                     MOVEL*BLANK    WN0003 10        User Id
     C                     MOVEL*BLANK    WN0004 10        Job Name
     C                     Z-ADD*ZERO     WN0005  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCREFD
     C                     Z-ADDWL0050    WFAIC3           Company Number
     C                     Z-ADDWL0051    WFANC7           A/R Customer Nu
     C                     Z-ADD0         WFAGVA           Age $ Due - Cur
     C                     Z-ADD0         WFACVA           Age $ Due - Agi
     C                     Z-ADD0         WFADVA           Age $ Due - Agi
     C                     Z-ADD0         WFAEVA           Age $ Due - Agi
     C                     Z-ADD0         WFAFVA           Age $ Due - Agi
     C                     Z-ADD0         WFAHVA           Age $ Due - Agi
     C                     Z-ADD0         WFVIVA           Age $ Due-Curre
     C                     Z-ADD0         WFVJVA           Age $ Due-Aging
     C                     Z-ADD0         WFVKVA           Age $ Due-Aging
     C                     Z-ADD0         WFVLVA           Age $ Due-Aging
     C                     Z-ADD0         WFVMVA           Age $ Due-Aging
     C                     Z-ADD0         WFVNVA           Age $ Due-Aging
     C                     Z-ADDWL0052    WFEEVA           Value of Open O
     C                     Z-ADD0         WFAKTM           Time of Last Ag
     C                     Z-ADD0         WFAHDT           Date of First S
     C                     Z-ADD0         WFANDT           Date of Last Sh
     C                     Z-ADD0         WFANVA           Amount of Last
     C                     Z-ADD0         WFALDT           Date of Last Pa
     C                     Z-ADD0         WFAMVA           Amount of Last
     C                     Z-ADD0         WFAIDT           Date of Highest
     C                     Z-ADD0         WFALVA           Amount of Highe
     C                     Z-ADD0         WFDJNB           Number of Invoi
     C                     Z-ADD1         WFDLNB           Number of Order
     C                     Z-ADD0         WFDDNB           Number of Credi
     C                     Z-ADD0         WFDMNB           Number of Payme
     C                     Z-ADD0         WFDUDT           Date of Last Ag
     C                     Z-ADD0         WFLYNO           Last YTD Nbr of
     C                     Z-ADD0         WFLYNC           Last YTD Nbr of
     C                     Z-ADD0         WFLYNP           Last YTD Nbr of
     C                     Z-ADD0         WFLYNI           Last YTD Nbr of
     C                     Z-ADD0         WFADPM           MTD Invoices Pa
     C                     Z-ADD0         WFVOVA           YTD Invoices Pa
     C                     Z-ADD0         WFBTDY           MTD Days Paid
     C                     Z-ADD0         WFBUDY           YTD Days Paid
     C                     Z-ADD0         WFVPVA           YTD Sales Invoi
     C                     Z-ADD0         WFVQVA           Last Year Sales
     C                     MOVEL*BLANK    WFBCCD           Salesperson Cod
     C                     MOVEL*BLANK    WFR4CD           Sales Route Cod
     C                     Z-ADD0         WFCUMO           Current Month
     C                     MOVEL*BLANK    WFUVST           EDI Status 1
     C                     MOVEL*BLANK    WFUWST           EDI Status 2
     C                     MOVEL*BLANK    WFUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRTA    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFANC7           A/R Customer Nu
      * Check for duplicate primary key
     C           KLCRTA    SETLL@BCREFD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0173' W0RTN   7
      * Send message 'A/R Summary            EX'
     C                     MOVEL'USR0173' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C                     WRITE@BCREFD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * CHG Value Open Orders  CH - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0006 112       Age $ Due - Cur
     C                     Z-ADD*ZERO     WN0007 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0008 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0009 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0010 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0011 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0012 112       Age $ Due-Curre
     C                     Z-ADD*ZERO     WN0013 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0014 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0015 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0016 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0017 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0018  60       Time of Last Ag
     C                     Z-ADD*ZERO     WN0019  70       Date of First S
     C                     Z-ADD*ZERO     WN0020  70       Date of Last Sh
     C                     Z-ADD*ZERO     WN0021 112       Amount of Last
     C                     Z-ADD*ZERO     WN0022  70       Date of Last Pa
     C                     Z-ADD*ZERO     WN0023 112       Amount of Last
     C                     Z-ADD*ZERO     WN0024  70       Date of Highest
     C                     Z-ADD*ZERO     WN0025 112       Amount of Highe
     C                     Z-ADD*ZERO     WN0026  50       Number of Invoi
     C                     Z-ADD*ZERO     WN0027  50       Number of Order
     C                     Z-ADD*ZERO     WN0028  50       Number of Credi
     C                     Z-ADD*ZERO     WN0029  50       Number of Payme
     C                     Z-ADD*ZERO     WN0030  70       Date of Last Ag
     C                     Z-ADD*ZERO     WN0031  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0032  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0033  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0034  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0035  50       MTD Invoices Pa
     C                     Z-ADD*ZERO     WN0036  50       YTD Invoices Pa
     C                     Z-ADD*ZERO     WN0037  50       MTD Days Paid
     C                     Z-ADD*ZERO     WN0038  50       YTD Days Paid
     C                     Z-ADD*ZERO     WN0039 112       YTD Sales Invoi
     C                     Z-ADD*ZERO     WN0040 112       Last Year Sales
     C                     MOVEL*BLANK    WN0041  3        Salesperson Cod
     C                     MOVEL*BLANK    WN0042  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0043  20       Current Month
     C                     MOVEL*BLANK    WN0044  1        EDI Status 1
     C                     MOVEL*BLANK    WN0045  1        EDI Status 2
     C                     MOVEL*BLANK    WN0046  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0047  60       Job Time
     C                     MOVEL*BLANK    WN0048 10        User Id
     C                     MOVEL*BLANK    WN0049 10        Job Name
     C                     Z-ADD*ZERO     WN0050  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BCREFD
     C                     Z-ADDBCAIC3    WFAIC3           Company Number
     C                     Z-ADDBCANC7    WFANC7           A/R Customer Nu
      *
     C           KLCHTB    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFANC7           A/R Customer Nu
     C           KLCHTB    CHAIN@BCREFD              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBCREL0'MDACP
     C                     MOVEL'@BCREFD' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBC1    YARDCS
      * Move non-key fields to @BCREFD
     C                     Z-ADDWN0001    WFEEVA           Value of Open O
      *
      * Set PGM.*Record Data Changed flag
     C           QARBC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QARBC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BCREFD                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBCREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * CHG A/R Order Value    CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0051  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0052  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0053  70       Ship To Custome
     C                     MOVEL*BLANK    WN0054 30        Ship To Name
     C                     MOVEL*BLANK    WN0055 30        Ship To Address
     C                     MOVEL*BLANK    WN0056 30        Ship To Address
     C                     MOVEL*BLANK    WN0057 30        Ship To Address
     C                     MOVEL*BLANK    WN0058 20        Ship To City
     C                     MOVEL*BLANK    WN0059  2        Ship To State C
     C                     MOVEL*BLANK    WN0060 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0061  70       Bill to Custome
     C                     MOVEL*BLANK    WN0062 30        Bill to Name
     C                     MOVEL*BLANK    WN0063 30        Bill to Address
     C                     MOVEL*BLANK    WN0064 30        Bill to Address
     C                     MOVEL*BLANK    WN0065 30        Bill to Address
     C                     MOVEL*BLANK    WN0066 20        Bill to City
     C                     MOVEL*BLANK    WN0067  2        Bill to State C
     C                     MOVEL*BLANK    WN0068 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0069 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0070  70       Order Date
     C                     Z-ADD*ZERO     WN0071  70       Requested Ship
     C                     Z-ADD*ZERO     WN0072  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0073  70       Cancel Date
     C                     MOVEL*BLANK    WN0074  2        Terms Code
     C                     MOVEL*BLANK    WN0075 40        Special Instruc
     C                     MOVEL*BLANK    WN0076 40        Special Instruc
     C                     MOVEL*BLANK    WN0077  3        Carrier Code
     C                     MOVEL*BLANK    WN0078  1        Comment Print A
     C                     MOVEL*BLANK    WN0079  1        Comment Print I
     C                     MOVEL*BLANK    WN0080  1        Comment Print P
     C                     MOVEL*BLANK    WN0081  1        Comment Print S
     C                     MOVEL*BLANK    WN0082  3        Reason Code
     C                     MOVEL*BLANK    WN0083  1        Order in Use
     C                     MOVEL*BLANK    WN0084  1        Header Status
     C                     MOVEL*BLANK    WN0085  1        Header Status L
     C                     MOVEL*BLANK    WN0086  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0087  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0088 10        User Original E
     C                     Z-ADD*ZERO     WN0089  70       Date of Origina
     C                     Z-ADD*ZERO     WN0090 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0091 112       Order Weight To
     C                     MOVEL*BLANK    WN0092  1        Credit Hold
     C                     MOVEL*BLANK    WN0093  1        Production Hold
     C                     MOVEL*BLANK    WN0094  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0095  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0096  40       Requested Deliv
     C                     MOVEL*BLANK    WN0097  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0098 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0099  70       Load ID
     C                     Z-ADD*ZERO     WN0100  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0101 112       Rated Freight
     C                     MOVEL*BLANK    WN0102  1        LTL Flag
     C                     MOVEL*BLANK    WN0103  1        Price Audit
     C                     MOVEL*BLANK    WN0104  1        Price Status
     C                     MOVEL*BLANK    WN0105  2        Shipping Method
     C                     MOVEL*BLANK    WN0106  1        Export Status
     C                     MOVEL*BLANK    WN0107  1        Palletize
     C                     MOVEL*BLANK    WN0108  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0109  1        Slip Sheet
     C                     MOVEL*BLANK    WN0110  1        Age Code
     C                     Z-ADD*ZERO     WN0111  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0112  1        Load Type
     C                     Z-ADD*ZERO     WN0113  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0114  1        Load Plan Order
     C                     MOVEL*BLANK    WN0115  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0116  70       Resell Referenc
     C                     MOVEL*BLANK    WN0117 30        Special Comment
     C                     MOVEL*BLANK    WN0118 30        Special Comment
     C                     MOVEL*BLANK    WN0119  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0120  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0121  2        Manager Level C
     C                     MOVEL*BLANK    WN0122  3        VP Level Code
     C                     Z-ADD*ZERO     WN0123  70       Attach to Order
     C                     MOVEL*BLANK    WN0124  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0125  70       Invoice Number
     C                     MOVEL*BLANK    WN0126  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0127  70       Invoice Date
     C                     MOVEL*BLANK    WN0128  2        Event Code
     C                     MOVEL*BLANK    WN0129  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0130  1        Modified Flag
     C                     MOVEL*BLANK    WN0131  1        Billing Activit
     C                     MOVEL*BLANK    WN0132  1        Block Order Fla
     C                     MOVEL*BLANK    WN0133  1        Order Certifica
     C                     Z-ADD*ZERO     WN0134 112       Invoice Order V
     C                     MOVEL*BLANK    WN0135  1        Process Sts for
     C                     MOVEL*BLANK    WN0136  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0137  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0138  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0139  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0140  1        Email Cust On O
     C                     MOVEL*BLANK    WN0141  1        Order Emailed
     C                     MOVEL*BLANK    WN0142  1        Export Docs Go
     C                     MOVEL*BLANK    WN0143  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0144  1        Broker Order St
     C                     MOVEL*BLANK    WN0145  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0146  2        Order Requires
     C                     MOVEL*BLANK    WN0147  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0148  2        Export USDA App
     C                     MOVEL*BLANK    WN0149  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0150  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0151  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0152  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0153  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0154  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0155  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0156  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0157  60       Time of Origina
     C                     Z-ADD*ZERO     WN0158  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0159  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0160  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0161 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0162 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0163 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0164 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0165 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0166  70       Claim Number
     C                     MOVEL*BLANK    WN0167  1        EDI Status 1
     C                     MOVEL*BLANK    WN0168  1        EDI Status 2
     C                     MOVEL*BLANK    WN0169  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0170  60       Job Time
     C                     MOVEL*BLANK    WN0171 10        User Id
     C                     MOVEL*BLANK    WN0172 10        Job Name
     C                     Z-ADD*ZERO     WN0173  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      *
     C           KLCHTC    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHTC    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YBRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     BEVRVA           A/R order Value
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##PGM     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDBEAIC3    PAAIC3           Company Number
     C                     Z-ADDBEC4NB    PAC4NB           Order Number
     C                     MOVELBEJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDBEANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    PABKC7           Ship To Custome
     C                     MOVELBEBRTX    PABRTX    P      Ship To Name
     C                     MOVELBEHMNA    PAHMNA    P      Ship To Address
     C                     MOVELBEHONA    PAHONA    P      Ship To Address
     C                     MOVELBEHPNA    PAHPNA    P      Ship To Address
     C                     MOVELBEHNNA    PAHNNA    P      Ship To City
     C                     MOVELBEDBCD    PADBCD    P      Ship To State C
     C                     MOVELBECKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDBEB0C7    PAB0C7           Bill to Custome
     C                     MOVELBEAETX    PAAETX    P      Bill to Name
     C                     MOVELBEB1NA    PAB1NA    P      Bill to Address
     C                     MOVELBEB3NA    PAB3NA    P      Bill to Address
     C                     MOVELBEB4NA    PAB4NA    P      Bill to Address
     C                     MOVELBEB2NA    PAB2NA    P      Bill to City
     C                     MOVELBEBHCD    PABHCD    P      Bill to State C
     C                     MOVELBEC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELBEBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDBEA0DT    PAA0DT           Order Date
     C                     Z-ADDBEA5DT    PAA5DT           Requested Ship
     C                     Z-ADDBEGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDBEACDT    PAACDT           Cancel Date
     C                     MOVELBEAQCD    PAAQCD    P      Terms Code
     C                     MOVELBEB6NA    PAB6NA    P      Special Instruc
     C                     MOVELBEBYNA    PABYNA    P      Special Instruc
     C                     MOVELBEBZNA    PABZNA    P      Carrier Code
     C                     MOVELBEGTST    PAGTST    P      Comment Print A
     C                     MOVELBEGVST    PAGVST    P      Comment Print I
     C                     MOVELBEGUST    PAGUST    P      Comment Print P
     C                     MOVELBEQFST    PAQFST    P      Comment Print S
     C                     MOVELBECQCD    PACQCD    P      Reason Code
     C                     MOVELBEGJST    PAGJST    P      Order in Use
     C                     MOVELBEGWST    PAGWST    P      Header Status
     C                     MOVELBEGXST    PAGXST    P      Header Status L
     C                     MOVELBEGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDBEAODT    PAAODT           Scheduled Ship
     C                     MOVELBEAIVN    PAAIVN    P      User Original E
     C                     Z-ADDBECXDT    PACXDT           Date of Origina
     C                     Z-ADDBEJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    PAA1WG           Order Weight To
     C                     MOVELBEXIST    PAXIST    P      Credit Hold
     C                     MOVELBEXJST    PAXJST    P      Production Hold
     C                     MOVELBEXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDBEEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    PAAFTM           Requested Deliv
     C                     MOVELBEE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELBEE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDBERMNB    PARMNB           Load ID
     C                     Z-ADDBETBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    PAR1NB           Rated Freight
     C                     MOVELBEPJST    PAPJST    P      LTL Flag
     C                     MOVELBEU0ST    PAU0ST    P      Price Audit
     C                     MOVELBEU1ST    PAU1ST    P      Price Status
     C                     MOVELBEQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELBEU2ST    PAU2ST    P      Export Status
     C                     MOVELBEVEST    PAVEST    P      Palletize
     C                     MOVELBEVFST    PAVFST    P      Shrink Wrap
     C                     MOVELBEVGST    PAVGST    P      Slip Sheet
     C                     MOVELBERPCD    PARPCD    P      Age Code
     C                     Z-ADDBERNNB    PARNNB           Reefer Temperat
     C                     MOVELBEVDST    PAVDST    P      Load Type
     C                     Z-ADDBEATIN    PAATIN           Attach to Invoi
     C                     MOVELBEU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELBEU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDBERSRN    PARSRN           Resell Referenc
     C                     MOVELBEMHNA    PAMHNA    P      Special Comment
     C                     MOVELBEMINA    PAMINA    P      Special Comment
     C                     MOVELBEWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELBER4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELBEBFCD    PABFCD    P      Manager Level C
     C                     MOVELBEQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDBET3NB    PAT3NB           Attach to Order
     C                     MOVELBESICD    PASICD    P      Reason for Pric
     C                     Z-ADDBECONB    PACONB           Invoice Number
     C                     MOVELBECEST    PACEST    P      Invoice Suffix
     C                     Z-ADDBEAWDT    PAAWDT           Invoice Date
     C                     MOVELBEJPCD    PAJPCD    P      Event Code
     C                     MOVELBEXUST    PAXUST    P      Trans Contol AS
     C                     MOVELBEZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDBEVRVA    PAVRVA           A/R order Value
     C                     MOVELBEOBST    PAOBST    P      Billing Activit
     C                     MOVELBEBCST    PABCST    P      Block Order Fla
     C                     MOVELBEBDST    PABDST    P      Order Certifica
     C                     Z-ADDBEB7VL    PAB7VL           Invoice Order V
     C                     MOVELBEGASX    PAGASX    P      Process Sts for
     C                     MOVELBEGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELBEGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELBEGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELBEFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELBEFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELBEFPSX    PAFPSX    P      Order Emailed
     C                     MOVELBEFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELBEFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELBEFSSX    PAFSSX    P      Broker Order St
     C                     MOVELBEFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELBEFUSX    PAFUSX    P      Order Requires
     C                     MOVELBEFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELBEFWSX    PAFWSX    P      Export USDA App
     C                     MOVELBEFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELBEFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDBENODT    PANODT           OH Appt Confirm
     C                     Z-ADDBENPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    PANQDT           Load Actual Shi
     C                     Z-ADDBENRDT    PANRDT           Load BOL Comple
     C                     Z-ADDBENSDT    PANSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    PABQTM           Time of Origina
     C                     Z-ADDBEBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    PAC0C7           Claim Number
     C                     MOVELBEUVST    PAUVST    P      EDI Status 1
     C                     MOVELBEUWST    PAUWST    P      EDI Status 2
     C                     MOVELBEUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDBEAATM    PAAATM           Job Time
     C                     MOVELBEAYNA    PAAYNA    P      User Id
     C                     MOVELBEA0NA    PAA0NA    P      Job Name
     C                     Z-ADDBEAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * CHG All Ship Customer  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQTD01           Company Number
     C           *LIKE     DEFN WDC4NB    WQTD02           Order Number
      * Define keylist
     C           KPSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WQTD02           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WQTD02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTD01           Company Number
     C                     Z-ADD#1C4NB    WQTD02           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
      * Establish starting position
     C           KPSTD     SETLL@BGWKL1                    *
     C           KRSTD     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WDGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Ord TF Exempt Code is Pre Commencement
     C           WDF4SX    IFEQ 'PC'                       *IF
     C                     MOVELWDF4SX    YL0027           Ord TF Exempt C
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Item Def/TFExp    RT - Item Default  * 
     C                     EXSR TERVGN
      * * 8/25/05   Determine Ord Tf Exempt code
      * CASE: PAR.OH TF Exempt Code is Not Exempt
     C           #1FYSX    IFEQ 'NE'                       *IF
     C                     ELSE
      * CASE: PAR.OH TF Exempt Code is Exempt Customer
     C           #1FYSX    IFEQ 'EC'                       *IF
      * CASE: LCL.Ord TF Exempt Code is Not Exempt
     C           YL0027    IFEQ 'NE'                       *IF
     C                     MOVEL'EC'      YL0027           Ord TF Exempt C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EP'      YL0027           Ord TF Exempt C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CHG Ship to Customer   CH - Order Detail  * 
     C                     EXSR TFCHRC
     C                     END                             *FI
     C           KRSTD     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Item Def/TFExp    RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADDWDHGCD    BYHGCD           Item Code
      * Establish starting position
     C           KRSTE     CHAIN@BYREA1              90    *
      * Data record not found
     C   90                MOVEL'USR1160' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYS9ST    YL0027           Item TF Exempt
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * CHG Ship to Customer   CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0174  70       Item Code
     C                     MOVEL*BLANK    WN0175  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0176  70       Order Group Cod
     C                     MOVEL*BLANK    WN0177  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0178  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0179 112       Billing Detail
     C                     Z-ADD*ZERO     WN0180 112       Billing Detail
     C                     Z-ADD*ZERO     WN0181 112       Billing Detail
     C                     Z-ADD*ZERO     WN0182 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0183  1        Comment Print A
     C                     MOVEL*BLANK    WN0184  1        Comment Print I
     C                     MOVEL*BLANK    WN0185  1        Comment Print P
     C                     MOVEL*BLANK    WN0186  1        Comment Print S
     C                     Z-ADD*ZERO     WN0187 112       Extended Amount
     C                     Z-ADD*ZERO     WN0188  70       Market Pricing
     C                     MOVEL*BLANK    WN0189  3        Commodity Marke
     C                     MOVEL*BLANK    WN0190  3        Date Method Cod
     C                     MOVEL*BLANK    WN0191  3        Price Method Co
     C                     Z-ADD*ZERO     WN0192 114       Price Overage O
     C                     Z-ADD*ZERO     WN0193  70       Contract Number
     C                     MOVEL*BLANK    WN0194  1        Price Status
     C                     Z-ADD*ZERO     WN0195  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0196  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0197  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0198  1        Work Confirm St
     C                     MOVEL*BLANK    WN0199  1        Work Over/Short
     C                     MOVEL*BLANK    WN0200  1        OD Production P
     C                     MOVEL*BLANK    WN0201 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0202 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0203  1        Age Code
     C                     MOVEL*BLANK    WN0204  1        Palletize
     C                     MOVEL*BLANK    WN0205  1        Slip Sheet
     C                     MOVEL*BLANK    WN0206  1        Catch Weight St
     C                     MOVEL*BLANK    WN0207  1        Price Audit
     C                     MOVEL*BLANK    WN0208  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0209  1        Production Date
     C                     Z-ADD*ZERO     WN0210 112       Rated Freight
     C                     Z-ADD*ZERO     WN0211 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0212 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0213 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0214 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0215 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0216 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0217 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0218 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0219 114       Unit Price
     C                     Z-ADD*ZERO     WN0220 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0221 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0222 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0223 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0224  70       Requested Ship
     C                     Z-ADD*ZERO     WN0225  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0226  70       Actual Shipped
     C                     MOVEL*BLANK    WN0227  1        Affect Inventor
     C                     MOVEL*BLANK    WN0228  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0229  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0230  30       Item Structure
     C                     Z-ADD*ZERO     WN0231  30       Item Structure
     C                     Z-ADD*ZERO     WN0232  30       Item Structure
     C                     MOVEL*BLANK    WN0233  2        Item Level
     C                     MOVEL*BLANK    WN0234  2        Quality Level
     C                     MOVEL*BLANK    WN0235  2        Pricing Product
     C                     MOVEL*BLANK    WN0236  2        Season Product
     C                     Z-ADD*ZERO     WN0237  70       Date of Origina
     C                     MOVEL*BLANK    WN0238 10        User Profile Na
     C                     MOVEL*BLANK    WN0239  6        Country Code
     C                     MOVEL*BLANK    WN0240  2        Event Code
     C                     MOVEL*BLANK    WN0241  3        Reason Code
     C                     MOVEL*BLANK    WN0242  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0243  1        Modified Flag
     C                     MOVEL*BLANK    WN0244  1        Substituted Fla
     C                     MOVEL*BLANK    WN0245  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0246 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0247 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0248  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0249  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0250  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0251  1        Affect Commissi
     C                     MOVEL*BLANK    WN0252  1        Affect Pricing
     C                     MOVEL*BLANK    WN0253  1        Released by Use
     C                     MOVEL*BLANK    WN0254  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0255  3        Production Ware
     C                     MOVEL*BLANK    WN0256  3        OD Price Type
     C                     Z-ADD*ZERO     WN0257  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0258  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0259  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0260  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0261  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0262  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0263  60       Price Code
     C                     Z-ADD*ZERO     WN0264  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0265  60       Substitution Li
     C                     Z-ADD*ZERO     WN0266  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0267 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0268 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0269 112       OD Item Target
     C                     Z-ADD*ZERO     WN0270 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0271 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0272 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0273 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0274 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0275 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0276 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0277 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0278 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0279 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0280  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0281  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0282  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0283 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0284  40       Item Age Days
     C                     Z-ADD*ZERO     WN0285  70       Production Ovr
     C                     Z-ADD*ZERO     WN0286  70       Production Ovr
     C                     MOVEL*BLANK    WN0287  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0288  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0289  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0290  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0291  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0292  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0293  1        EDI Status 1
     C                     MOVEL*BLANK    WN0294  1        EDI Status 2
     C                     MOVEL*BLANK    WN0295  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0296  60       Job Time
     C                     MOVEL*BLANK    WN0297 10        User Id
     C                     MOVEL*BLANK    WN0298 10        Job Name
     C                     Z-ADD*ZERO     WN0299  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWDAIC3    WGAIC3           Company Number
     C                     Z-ADDWDC4NB    WGC4NB           Order Number
     C                     Z-ADDWDDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWDUENB    WGUENB           Order Secondary
      *
     C           KLCHTF    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C           KLCHTF    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YCRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#1BKC7    WGBKC7           Ship To Custome
     C                     MOVELYL0027    WGF4SX    P      Ord TF Exempt C
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * CHG Ld Typ/Shp Mth/Alc CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0300  30       Company Number
     C                     Z-ADD*ZERO     WN0301  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0302  1        LTL Flag
     C                     MOVEL*BLANK    WN0303  1        Load Status
     C                     Z-ADD*ZERO     WN0304  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0305 15        Seal 1
     C                     MOVEL*BLANK    WN0306 15        Seal 2
     C                     MOVEL*BLANK    WN0307 15        Seal 3
     C                     MOVEL*BLANK    WN0308 15        Seal 4
     C                     MOVEL*BLANK    WN0309 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0310  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0311 112       Flat Amount
     C                     Z-ADD*ZERO     WN0312  50       Total Stops
     C                     MOVEL*BLANK    WN0313 20        Trailer Id
     C                     MOVEL*BLANK    WN0314  3        Transloader Car
     C                     Z-ADD*ZERO     WN0315  40       BOL Time
     C                     MOVEL*BLANK    WN0316  7        Truck Size
     C                     Z-ADD*ZERO     WN0317  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0318 112       Rated Freight
     C                     MOVEL*BLANK    WN0319  1        Ship Status
     C                     Z-ADD*ZERO     WN0320  50       Number Pallets
     C                     Z-ADD*ZERO     WN0321  50       Number Pallets
     C                     Z-ADD*ZERO     WN0322 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0323  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0324  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0325  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0326 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0327 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0328  70       Actual Departur
     C                     Z-ADD*ZERO     WN0329  40       Departure Time
     C                     Z-ADD*ZERO     WN0330  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0331  52       Product Tempera
     C                     Z-ADD*ZERO     WN0332  50       Number Spacers
     C                     MOVEL*BLANK    WN0333 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0334  70       Total Load Mile
     C                     MOVEL*BLANK    WN0335 12        Recorder ID
     C                     MOVEL*BLANK    WN0336  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0337  2        Ship To State C
     C                     Z-ADD*ZERO     WN0338  70       Gross Weight
     C                     MOVEL*BLANK    WN0339  3        Carrier Broker
     C                     MOVEL*BLANK    WN0340  1        Export Status
     C                     Z-ADD*ZERO     WN0341  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0342  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0343  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0344  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0345  70       Spotted Date
     C                     Z-ADD*ZERO     WN0346  60       Spotted Time
     C                     Z-ADD*ZERO     WN0347  70       Load Finished D
     C                     Z-ADD*ZERO     WN0348  60       Load Finished T
     C                     Z-ADD*ZERO     WN0349  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0350  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0351  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0352  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0353  70       Truck Departure
     C                     Z-ADD*ZERO     WN0354  60       Truck Departure
     C                     Z-ADD*ZERO     WN0355  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0356  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0357  3        Shipping Line
     C                     MOVEL*BLANK    WN0358 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0359 30        Vessel Name
     C                     Z-ADD*ZERO     WN0360  50       Voyage
     C                     Z-ADD*ZERO     WN0361  70       Sail Date
     C                     MOVEL*BLANK    WN0362 12        Booking Number
     C                     MOVEL*BLANK    WN0363 20        Discharge Port
     C                     Z-ADD*ZERO     WN0364  70       Arrival Date
     C                     MOVEL*BLANK    WN0365 12        Container Numbe
     C                     Z-ADD*ZERO     WN0366  70       Date In
     C                     Z-ADD*ZERO     WN0367  60       Time In
     C                     Z-ADD*ZERO     WN0368  70       Date Out
     C                     Z-ADD*ZERO     WN0369  60       Time Out
     C                     Z-ADD*ZERO     WN0370 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0371  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0372  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0373  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0374  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0375  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0376  70       Requested Deliv
     C                     MOVEL*BLANK    WN0377  1        Load Acceptance
     C                     MOVEL*BLANK    WN0378  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0379  70       On Yard Date
     C                     Z-ADD*ZERO     WN0380  60       On Yard Time
     C                     Z-ADD*ZERO     WN0381  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0382  60       Deadline Depart
     C                     MOVEL*BLANK    WN0383  1        Load Held Over
     C                     MOVEL*BLANK    WN0384  1        Load Held Over
     C                     MOVEL*BLANK    WN0385 15        Load Held Over
     C                     MOVEL*BLANK    WN0386 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0387 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0388  70       Express Mail Da
     C                     MOVEL*BLANK    WN0389  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0390  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0391  70       Product Complet
     C                     Z-ADD*ZERO     WN0392  60       Product Complet
     C                     Z-ADD*ZERO     WN0393  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0394  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0395  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0396  1        Load Confirmed
     C                     MOVEL*BLANK    WN0397 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0398  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0399  60       Load Door 1
     C                     Z-ADD*ZERO     WN0400  70       Override Total
     C                     Z-ADD*ZERO     WN0401  60       Load Door 2
     C                     MOVEL*BLANK    WN0402  1        Partial Load
     C                     MOVEL*BLANK    WN0403  1        Load Confirmati
     C                     MOVEL*BLANK    WN0404  1        Export Load USD
     C                     MOVEL*BLANK    WN0405  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0406 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0407 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0408 15        Late Billing Em
     C                     MOVEL*BLANK    WN0409 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0410 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0411  1        Multi Company L
     C                     MOVEL*BLANK    WN0412  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0413  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0414  1        LH Power Only L
     C                     MOVEL*BLANK    WN0415  1        MG Created Load
     C                     MOVEL*BLANK    WN0416  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0417  2        Load U/M
     C                     MOVEL*BLANK    WN0418  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0419  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0420  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0421  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0422  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0423  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0424  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0425  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0426  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0427  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0428  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0429  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0430  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0431  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0432  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0433  60       LH Unused Time
     C                     MOVEL*BLANK    WN0434  1        EDI Status 1
     C                     MOVEL*BLANK    WN0435  1        EDI Status 2
     C                     MOVEL*BLANK    WN0436  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0437  60       Job Time
     C                     MOVEL*BLANK    WN0438 10        User Id
     C                     MOVEL*BLANK    WN0439 10        Job Name
     C                     Z-ADD*ZERO     WN0440  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WHRMNB           Load ID
      *
     C           KLCHTG    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHTG    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YDRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELP8XQST    WHXQST    P      Allocate Pounds
     C                     MOVEL#1BZNA    WHBZNA    P      Carrier Code
     C                     MOVEL#1VDST    WHVDST    P      Load Type
     C                     MOVEL#1Q2CD    WHQ2CD    P      Shipping Method
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Load Acceptance Sw RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WIRMNB           Load ID
      * Setup key
     C                     Z-ADDP8RMNB    WIRMNB           Load ID
      * Establish starting position
     C           KRSTH     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0029           Load Acceptance
     C                     MOVEL*BLANK    P7RYSX           MG Created Load
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIRMST    YL0029           Load Acceptance
     C                     MOVELWIRYSX    P7RYSX           MG Created Load
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * CHG Load Acceptance Sw CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0441  30       Company Number
     C                     Z-ADD*ZERO     WN0442  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0443  1        LTL Flag
     C                     MOVEL*BLANK    WN0444  1        Load Status
     C                     Z-ADD*ZERO     WN0445  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0446 15        Seal 1
     C                     MOVEL*BLANK    WN0447 15        Seal 2
     C                     MOVEL*BLANK    WN0448 15        Seal 3
     C                     MOVEL*BLANK    WN0449 15        Seal 4
     C                     MOVEL*BLANK    WN0450 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0451  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0452 112       Flat Amount
     C                     MOVEL*BLANK    WN0453  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0454  50       Total Stops
     C                     MOVEL*BLANK    WN0455 20        Trailer Id
     C                     MOVEL*BLANK    WN0456  3        Transloader Car
     C                     Z-ADD*ZERO     WN0457  40       BOL Time
     C                     MOVEL*BLANK    WN0458  3        Carrier Code
     C                     MOVEL*BLANK    WN0459  7        Truck Size
     C                     Z-ADD*ZERO     WN0460  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0461 112       Rated Freight
     C                     MOVEL*BLANK    WN0462  1        Ship Status
     C                     MOVEL*BLANK    WN0463  1        Load Type
     C                     Z-ADD*ZERO     WN0464  50       Number Pallets
     C                     Z-ADD*ZERO     WN0465  50       Number Pallets
     C                     Z-ADD*ZERO     WN0466 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0467  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0468  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0469  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0470 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0471 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0472  70       Actual Departur
     C                     Z-ADD*ZERO     WN0473  40       Departure Time
     C                     Z-ADD*ZERO     WN0474  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0475  52       Product Tempera
     C                     Z-ADD*ZERO     WN0476  50       Number Spacers
     C                     MOVEL*BLANK    WN0477 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0478  70       Total Load Mile
     C                     MOVEL*BLANK    WN0479 12        Recorder ID
     C                     MOVEL*BLANK    WN0480  2        Shipping Method
     C                     MOVEL*BLANK    WN0481  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0482  2        Ship To State C
     C                     Z-ADD*ZERO     WN0483  70       Gross Weight
     C                     MOVEL*BLANK    WN0484  3        Carrier Broker
     C                     MOVEL*BLANK    WN0485  1        Export Status
     C                     Z-ADD*ZERO     WN0486  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0487  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0488  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0489  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0490  70       Spotted Date
     C                     Z-ADD*ZERO     WN0491  60       Spotted Time
     C                     Z-ADD*ZERO     WN0492  70       Load Finished D
     C                     Z-ADD*ZERO     WN0493  60       Load Finished T
     C                     Z-ADD*ZERO     WN0494  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0495  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0496  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0497  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0498  70       Truck Departure
     C                     Z-ADD*ZERO     WN0499  60       Truck Departure
     C                     Z-ADD*ZERO     WN0500  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0501  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0502  3        Shipping Line
     C                     MOVEL*BLANK    WN0503 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0504 30        Vessel Name
     C                     Z-ADD*ZERO     WN0505  50       Voyage
     C                     Z-ADD*ZERO     WN0506  70       Sail Date
     C                     MOVEL*BLANK    WN0507 12        Booking Number
     C                     MOVEL*BLANK    WN0508 20        Discharge Port
     C                     Z-ADD*ZERO     WN0509  70       Arrival Date
     C                     MOVEL*BLANK    WN0510 12        Container Numbe
     C                     Z-ADD*ZERO     WN0511  70       Date In
     C                     Z-ADD*ZERO     WN0512  60       Time In
     C                     Z-ADD*ZERO     WN0513  70       Date Out
     C                     Z-ADD*ZERO     WN0514  60       Time Out
     C                     Z-ADD*ZERO     WN0515 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0516  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0517  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0518  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0519  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0520  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0521  70       Requested Deliv
     C                     MOVEL*BLANK    WN0522  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0523  70       On Yard Date
     C                     Z-ADD*ZERO     WN0524  60       On Yard Time
     C                     Z-ADD*ZERO     WN0525  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0526  60       Deadline Depart
     C                     MOVEL*BLANK    WN0527  1        Load Held Over
     C                     MOVEL*BLANK    WN0528  1        Load Held Over
     C                     MOVEL*BLANK    WN0529 15        Load Held Over
     C                     MOVEL*BLANK    WN0530 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0531 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0532  70       Express Mail Da
     C                     MOVEL*BLANK    WN0533  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0534  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0535  70       Product Complet
     C                     Z-ADD*ZERO     WN0536  60       Product Complet
     C                     Z-ADD*ZERO     WN0537  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0538  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0539  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0540  1        Load Confirmed
     C                     MOVEL*BLANK    WN0541 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0542  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0543  60       Load Door 1
     C                     Z-ADD*ZERO     WN0544  70       Override Total
     C                     Z-ADD*ZERO     WN0545  60       Load Door 2
     C                     MOVEL*BLANK    WN0546  1        Partial Load
     C                     MOVEL*BLANK    WN0547  1        Load Confirmati
     C                     MOVEL*BLANK    WN0548  1        Export Load USD
     C                     MOVEL*BLANK    WN0549  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0550 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0551 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0552 15        Late Billing Em
     C                     MOVEL*BLANK    WN0553 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0554 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0555  1        Multi Company L
     C                     MOVEL*BLANK    WN0556  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0557  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0558  1        LH Power Only L
     C                     MOVEL*BLANK    WN0559  1        MG Created Load
     C                     MOVEL*BLANK    WN0560  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0561  2        Load U/M
     C                     MOVEL*BLANK    WN0562  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0563  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0564  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0565  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0566  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0567  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0568  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0569  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0570  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0571  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0572  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0573  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0574  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0575  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0576  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0577  60       LH Unused Time
     C                     MOVEL*BLANK    WN0578  1        EDI Status 1
     C                     MOVEL*BLANK    WN0579  1        EDI Status 2
     C                     MOVEL*BLANK    WN0580  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0581  60       Job Time
     C                     MOVEL*BLANK    WN0582 10        User Id
     C                     MOVEL*BLANK    WN0583 10        Job Name
     C                     Z-ADD*ZERO     WN0584  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDP8RMNB    WHRMNB           Load ID
      *
     C           KLCHTI    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHTI    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YERDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WHRMST    P      Load Acceptance
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCHRC    BEGSR
      *================================================================
      * Chg Order Header & Ext CH - Order Header TRG  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0585  60       Job Time
     C                     MOVEL*BLANK    WN0586 10        User Id
     C                     MOVEL*BLANK    WN0587 10        Job Name
     C                     Z-ADD*ZERO     WN0588  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      *
     C           KLCHTJ    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHTJ    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     GOTO TJEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YFRDCS
      * USER: Processing after Data read
      * 01/22/09 RMC  move here from "before Data update" spot
      * 06/23/00 PKD Added the update of the Export Status on the Load
      *              if the Export Status on the Order is changed to Y,
      * Change the Export Status.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Export Status NE DB1.Export Status
      *   |- c2    : PAR.Export Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U2ST    IFNE BEU2ST                     *IF
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Load ID is NE Blank
     C           BERMNB    IFNE 0                          *IF
      * Chg Export Status     CH - Load Header  * 
     C                     EXSR TKCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       YL0035           Status Flag 1
      * Email Requested Delv Change msg is changed and Appt exists.
      * CASE:
      *  - (c1ORc2) AND c3
      *   |- c1    : PAR.Requested Delivery Date NE DB1.Requested Deliver
      *   |- c2    : PAR.Requested Delivery Time NE DB1.Requested Deliver
      *   |- c3    : DB1.OH Appt Confirmation Dt is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1EIDT    IFNE BEEIDT                     *IF
     C           #1AFTM    ORNE BEAFTM                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           BENODT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0035           Status Flag 1
     C                     END                             *FI
      * R12926 DN 06/11/18-Update Orig ABS Freight Rate in OHE file.
      * CASE: *OTHERWISE
      * Rtv Org ABS & Reason   RT - Order Header Extension  * Get Orig AF
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0004           Company Number
     C                     Z-ADDBEC4NB    WL0005           Order Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YN0034    P      OHE Abs Rate Ov
     C                     Z-ADDWL0007    YL0036           OHE Orig ABS Fr
      * Ship To Customer Changed.
      * CASE: PAR.Ship To Customer NE DB1.Ship To Customer
     C           #1BKC7    IFNE BEBKC7                     *IF
     C                     Z-ADD#1TBNB    YL0036           OHE Orig ABS Fr
     C                     END                             *FI
      * Block Order Changed from Block (B) to Firm (F).
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Block Order Flag is Block Order
      *   |- c2    : PAR.Block Order Flag is Firm Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEBCST    IFEQ 'B'                        *IF
     C           #1BCST    IFEQ 'F'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD#1TBNB    YL0036           OHE Orig ABS Fr
     C                     END                             *FI
      * Move non-key fields to @BECPFJ
     C                     MOVEL#1JNCD    BEJNCD    P      Order Type - Sa
     C                     Z-ADD#1ANC7    BEANC7           A/R Customer Nu
     C                     Z-ADD#1BKC7    BEBKC7           Ship To Custome
     C                     MOVEL#1BRTX    BEBRTX    P      Ship To Name
     C                     MOVEL#1HMNA    BEHMNA    P      Ship To Address
     C                     MOVEL#1HONA    BEHONA    P      Ship To Address
     C                     MOVEL#1HPNA    BEHPNA    P      Ship To Address
     C                     MOVEL#1HNNA    BEHNNA    P      Ship To City
     C                     MOVEL#1DBCD    BEDBCD    P      Ship To State C
     C                     MOVEL#1CKTX    BECKTX    P      Ship To Zip/Pos
     C                     Z-ADD#1B0C7    BEB0C7           Bill to Custome
     C                     MOVEL#1AETX    BEAETX    P      Bill to Name
     C                     MOVEL#1B1NA    BEB1NA    P      Bill to Address
     C                     MOVEL#1B3NA    BEB3NA    P      Bill to Address
     C                     MOVEL#1B4NA    BEB4NA    P      Bill to Address
     C                     MOVEL#1B2NA    BEB2NA    P      Bill to City
     C                     MOVEL#1BHCD    BEBHCD    P      Bill to State C
     C                     MOVEL#1C8TX    BEC8TX    P      Bill to Zip/Pos
     C                     MOVEL#1BCNA    BEBCNA    P      Customer Purcha
     C                     Z-ADD#1A0DT    BEA0DT           Order Date
     C                     Z-ADD#1A5DT    BEA5DT           Requested Ship
     C                     Z-ADD#1GNDT    BEGNDT           Actual Shipped
     C                     Z-ADD#1ACDT    BEACDT           Cancel Date
     C                     MOVEL#1AQCD    BEAQCD    P      Terms Code
     C                     MOVEL#1B6NA    BEB6NA    P      Special Instruc
     C                     MOVEL#1BYNA    BEBYNA    P      Special Instruc
     C                     MOVEL#1BZNA    BEBZNA    P      Carrier Code
     C                     MOVEL#1GTST    BEGTST    P      Comment Print A
     C                     MOVEL#1GVST    BEGVST    P      Comment Print I
     C                     MOVEL#1GUST    BEGUST    P      Comment Print P
     C                     MOVEL#1QFST    BEQFST    P      Comment Print S
     C                     MOVEL#1CQCD    BECQCD    P      Reason Code
     C                     MOVEL#1GJST    BEGJST    P      Order in Use
     C                     MOVEL#1GWST    BEGWST    P      Header Status
     C                     MOVEL#1GXST    BEGXST    P      Header Status L
     C                     MOVEL#1GYST    BEGYST    P      Order Type Prin
     C                     Z-ADD#1AODT    BEAODT           Scheduled Ship
     C                     MOVEL#1AIVN    BEAIVN    P      User Original E
     C                     Z-ADD#1CXDT    BECXDT           Date of Origina
     C                     Z-ADD#1JZVA    BEJZVA           Order Value Tot
     C                     Z-ADD#1A1WG    BEA1WG           Order Weight To
     C                     MOVEL#1XIST    BEXIST    P      Credit Hold
     C                     MOVEL#1XJST    BEXJST    P      Production Hold
     C                     MOVEL#1XKST    BEXKST    P      New Customer Ho
     C                     Z-ADD#1EIDT    BEEIDT           Requested Deliv
     C                     Z-ADD#1AFTM    BEAFTM           Requested Deliv
     C                     MOVEL#1E8CD    BEE8CD    P      Accounts Receiv
     C                     MOVEL#1E9CD    BEE9CD    P      Accounts Receiv
     C                     Z-ADD#1RMNB    BERMNB           Load ID
     C                     Z-ADD#1TBNB    BETBNB           Absorbed Freigh
     C                     Z-ADD#1R1NB    BER1NB           Rated Freight
     C                     MOVEL#1PJST    BEPJST    P      LTL Flag
     C                     MOVEL#1U0ST    BEU0ST    P      Price Audit
     C                     MOVEL#1U1ST    BEU1ST    P      Price Status
     C                     MOVEL#1Q2CD    BEQ2CD    P      Shipping Method
     C                     MOVEL#1U2ST    BEU2ST    P      Export Status
     C                     MOVEL#1VEST    BEVEST    P      Palletize
     C                     MOVEL#1VFST    BEVFST    P      Shrink Wrap
     C                     MOVEL#1VGST    BEVGST    P      Slip Sheet
     C                     MOVEL#1RPCD    BERPCD    P      Age Code
     C                     Z-ADD#1RNNB    BERNNB           Reefer Temperat
     C                     MOVEL#1VDST    BEVDST    P      Load Type
     C                     Z-ADD#1ATIN    BEATIN           Attach to Invoi
     C                     MOVEL#1U4ST    BEU4ST    P      Load Plan Order
     C                     MOVEL#1U5ST    BEU5ST    P      Print Pick Slip
     C                     Z-ADD#1RSRN    BERSRN           Resell Referenc
     C                     MOVEL#1MHNA    BEMHNA    P      Special Comment
     C                     MOVEL#1MINA    BEMINA    P      Special Comment
     C                     MOVEL#1WBST    BEWBST    P      Affect Auto Acc
     C                     MOVEL#1R4CD    BER4CD    P      Sales Route Cod
     C                     MOVEL#1BFCD    BEBFCD    P      Manager Level C
     C                     MOVEL#1Q4CD    BEQ4CD    P      VP Level Code
     C                     Z-ADD#1T3NB    BET3NB           Attach to Order
     C                     MOVEL#1SICD    BESICD    P      Reason for Pric
     C                     Z-ADD#1CONB    BECONB           Invoice Number
     C                     MOVEL#1CEST    BECEST    P      Invoice Suffix
     C                     Z-ADD#1AWDT    BEAWDT           Invoice Date
     C                     MOVEL#1JPCD    BEJPCD    P      Event Code
     C                     MOVEL#1XUST    BEXUST    P      Trans Contol AS
     C                     MOVEL#1Z1ST    BEZ1ST    P      Modified Flag
     C                     Z-ADD#1VRVA    BEVRVA           A/R order Value
     C                     MOVEL#1OBST    BEOBST    P      Billing Activit
     C                     MOVEL#1BCST    BEBCST    P      Block Order Fla
     C                     MOVEL#1BDST    BEBDST    P      Order Certifica
     C                     Z-ADD#1B7VL    BEB7VL           Invoice Order V
     C                     MOVEL#1GASX    BEGASX    P      Process Sts for
     C                     MOVEL#1GBSX    BEGBSX    P      Order Conf Fax
     C                     MOVEL#1GCSX    BEGCSX    P      Manifest Fax St
     C                     MOVEL#1GDSX    BEGDSX    P      Invoice Fax Sts
     C                     MOVEL#1FNSX    BEFNSX    P      Transfer in Sto
     C                     MOVEL#1FOSX    BEFOSX    P      Email Cust On O
     C                     MOVEL#1FPSX    BEFPSX    P      Order Emailed
     C                     MOVEL#1FQSX    BEFQSX    P      Export Docs Go
     C                     MOVEL#1FRSX    BEFRSX    P      Shipping Temp C
     C                     MOVEL#1FSSX    BEFSSX    P      Broker Order St
     C                     MOVEL#1FTSX    BEFTSX    P      Air Freight Ord
     C                     MOVEL#1FUSX    BEFUSX    P      Order Requires
     C                     MOVEL#1FVSX    BEFVSX    P      OH Load Plan Re
     C                     MOVEL#1FWSX    BEFWSX    P      Export USDA App
     C                     MOVEL#1FXSX    BEFXSX    P      HPB Ship to War
     C                     MOVEL#1FYSX    BEFYSX    P      OH TF Exempt Co
     C                     Z-ADD#1NODT    BENODT           OH Appt Confirm
     C                     Z-ADD#1NPDT    BENPDT           JPN Invoice Iss
     C                     Z-ADD#1NQDT    BENQDT           Load Actual Shi
     C                     Z-ADD#1NRDT    BENRDT           Load BOL Comple
     C                     Z-ADD#1NSDT    BENSDT           Load Truck Depa
     C                     Z-ADD#1BPTM    BEBPTM           Maximum Gross W
     C                     Z-ADD#1BQTM    BEBQTM           Time of Origina
     C                     Z-ADD#1BRTM    BEBRTM           OH Appt Confirm
     C                     Z-ADD#1BSTM    BEBSTM           Load BOL Comple
     C                     Z-ADD#1BTTM    BEBTTM           Load Truck Depa
     C                     Z-ADD#1H0NX    BEH0NX           Act Frt Referen
     C                     Z-ADD#1H1NX    BEH1NX           Act Non-Ref Frt
     C                     Z-ADD#1H2NX    BEH2NX           OH Fuel Surchar
     C                     Z-ADD#1H3NX    BEH3NX           OH Total Non-Re
     C                     Z-ADD#1H4NX    BEH4NX           OH Total Ref Fr
     C                     Z-ADD#1C0C7    BEC0C7           Claim Number
     C                     MOVEL#1UVST    BEUVST    P      EDI Status 1
     C                     MOVEL#1UWST    BEUWST    P      EDI Status 2
     C                     MOVEL#1UXST    BEUXST    P      EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##PGM     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDBEAIC3    PAAIC3           Company Number
     C                     Z-ADDBEC4NB    PAC4NB           Order Number
     C                     MOVELBEJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDBEANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    PABKC7           Ship To Custome
     C                     MOVELBEBRTX    PABRTX    P      Ship To Name
     C                     MOVELBEHMNA    PAHMNA    P      Ship To Address
     C                     MOVELBEHONA    PAHONA    P      Ship To Address
     C                     MOVELBEHPNA    PAHPNA    P      Ship To Address
     C                     MOVELBEHNNA    PAHNNA    P      Ship To City
     C                     MOVELBEDBCD    PADBCD    P      Ship To State C
     C                     MOVELBECKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDBEB0C7    PAB0C7           Bill to Custome
     C                     MOVELBEAETX    PAAETX    P      Bill to Name
     C                     MOVELBEB1NA    PAB1NA    P      Bill to Address
     C                     MOVELBEB3NA    PAB3NA    P      Bill to Address
     C                     MOVELBEB4NA    PAB4NA    P      Bill to Address
     C                     MOVELBEB2NA    PAB2NA    P      Bill to City
     C                     MOVELBEBHCD    PABHCD    P      Bill to State C
     C                     MOVELBEC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELBEBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDBEA0DT    PAA0DT           Order Date
     C                     Z-ADDBEA5DT    PAA5DT           Requested Ship
     C                     Z-ADDBEGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDBEACDT    PAACDT           Cancel Date
     C                     MOVELBEAQCD    PAAQCD    P      Terms Code
     C                     MOVELBEB6NA    PAB6NA    P      Special Instruc
     C                     MOVELBEBYNA    PABYNA    P      Special Instruc
     C                     MOVELBEBZNA    PABZNA    P      Carrier Code
     C                     MOVELBEGTST    PAGTST    P      Comment Print A
     C                     MOVELBEGVST    PAGVST    P      Comment Print I
     C                     MOVELBEGUST    PAGUST    P      Comment Print P
     C                     MOVELBEQFST    PAQFST    P      Comment Print S
     C                     MOVELBECQCD    PACQCD    P      Reason Code
     C                     MOVELBEGJST    PAGJST    P      Order in Use
     C                     MOVELBEGWST    PAGWST    P      Header Status
     C                     MOVELBEGXST    PAGXST    P      Header Status L
     C                     MOVELBEGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDBEAODT    PAAODT           Scheduled Ship
     C                     MOVELBEAIVN    PAAIVN    P      User Original E
     C                     Z-ADDBECXDT    PACXDT           Date of Origina
     C                     Z-ADDBEJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    PAA1WG           Order Weight To
     C                     MOVELBEXIST    PAXIST    P      Credit Hold
     C                     MOVELBEXJST    PAXJST    P      Production Hold
     C                     MOVELBEXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDBEEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    PAAFTM           Requested Deliv
     C                     MOVELBEE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELBEE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDBERMNB    PARMNB           Load ID
     C                     Z-ADDBETBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    PAR1NB           Rated Freight
     C                     MOVELBEPJST    PAPJST    P      LTL Flag
     C                     MOVELBEU0ST    PAU0ST    P      Price Audit
     C                     MOVELBEU1ST    PAU1ST    P      Price Status
     C                     MOVELBEQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELBEU2ST    PAU2ST    P      Export Status
     C                     MOVELBEVEST    PAVEST    P      Palletize
     C                     MOVELBEVFST    PAVFST    P      Shrink Wrap
     C                     MOVELBEVGST    PAVGST    P      Slip Sheet
     C                     MOVELBERPCD    PARPCD    P      Age Code
     C                     Z-ADDBERNNB    PARNNB           Reefer Temperat
     C                     MOVELBEVDST    PAVDST    P      Load Type
     C                     Z-ADDBEATIN    PAATIN           Attach to Invoi
     C                     MOVELBEU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELBEU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDBERSRN    PARSRN           Resell Referenc
     C                     MOVELBEMHNA    PAMHNA    P      Special Comment
     C                     MOVELBEMINA    PAMINA    P      Special Comment
     C                     MOVELBEWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELBER4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELBEBFCD    PABFCD    P      Manager Level C
     C                     MOVELBEQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDBET3NB    PAT3NB           Attach to Order
     C                     MOVELBESICD    PASICD    P      Reason for Pric
     C                     Z-ADDBECONB    PACONB           Invoice Number
     C                     MOVELBECEST    PACEST    P      Invoice Suffix
     C                     Z-ADDBEAWDT    PAAWDT           Invoice Date
     C                     MOVELBEJPCD    PAJPCD    P      Event Code
     C                     MOVELBEXUST    PAXUST    P      Trans Contol AS
     C                     MOVELBEZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDBEVRVA    PAVRVA           A/R order Value
     C                     MOVELBEOBST    PAOBST    P      Billing Activit
     C                     MOVELBEBCST    PABCST    P      Block Order Fla
     C                     MOVELBEBDST    PABDST    P      Order Certifica
     C                     Z-ADDBEB7VL    PAB7VL           Invoice Order V
     C                     MOVELBEGASX    PAGASX    P      Process Sts for
     C                     MOVELBEGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELBEGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELBEGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELBEFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELBEFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELBEFPSX    PAFPSX    P      Order Emailed
     C                     MOVELBEFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELBEFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELBEFSSX    PAFSSX    P      Broker Order St
     C                     MOVELBEFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELBEFUSX    PAFUSX    P      Order Requires
     C                     MOVELBEFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELBEFWSX    PAFWSX    P      Export USDA App
     C                     MOVELBEFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELBEFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDBENODT    PANODT           OH Appt Confirm
     C                     Z-ADDBENPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    PANQDT           Load Actual Shi
     C                     Z-ADDBENRDT    PANRDT           Load BOL Comple
     C                     Z-ADDBENSDT    PANSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    PABQTM           Time of Origina
     C                     Z-ADDBEBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    PAC0C7           Claim Number
     C                     MOVELBEUVST    PAUVST    P      EDI Status 1
     C                     MOVELBEUWST    PAUWST    P      EDI Status 2
     C                     MOVELBEUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDBEAATM    PAAATM           Job Time
     C                     MOVELBEAYNA    PAAYNA    P      User Id
     C                     MOVELBEA0NA    PAA0NA    P      Job Name
     C                     Z-ADDBEAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * -----------------------------------------------------------------
      * -----------------------------------------------------------------
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * Email Requested Delv Change msg is changed and Appt exists.
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0035    IFEQ 'Y'                        *IF
      * Exc Email Ord RqDtChg XF - Order Header TRG  * 
     C                     CALL 'PBEPXFR'              90  Exc Email Ord R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEAIC3    WQ0075  30       Company Number
     C                     PARM BEC4NB    WQ0076  70       Order Number
     C                     PARM BER4CD    WQ0077  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBEPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * R12926 DN 05/10/18-Replaced to Update Abs Rate Override Rsn &
      *   Orig AFR if Ship To Customer Changed.
      * CHG OHE fm OH More Scr CH - Order Header Extension  * 
     C                     EXSR TLCHRC
      * CRT: TMS Order Header Trigger
      * CASE: PAR.Pricing Event Called From is TMS Update for Select
     C           YL0034    IFEQ 'OE'                       *IF
     C           YL0034    OREQ 'SWP'
     C           YL0034    OREQ 'CEO'
     C           YL0034    OREQ 'UWT'
      * CASE: PAR.OH Load Plan Ready is Yes
     C           #1FVSX    IFEQ 'Y'                        *IF
      * Rtv Crt OH Trigger    XF - TMS Order Header Trigger  * 
     C                     CALL 'PBWVXFR'              90  Rtv Crt OH Trig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C4NB    WQ0078  70       Order Number
     C                     PARM #1AIC3    WQ0079  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * Chg Export Status     CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0589  30       Company Number
     C                     Z-ADD*ZERO     WN0590  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0591  1        LTL Flag
     C                     MOVEL*BLANK    WN0592  1        Load Status
     C                     Z-ADD*ZERO     WN0593  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0594 15        Seal 1
     C                     MOVEL*BLANK    WN0595 15        Seal 2
     C                     MOVEL*BLANK    WN0596 15        Seal 3
     C                     MOVEL*BLANK    WN0597 15        Seal 4
     C                     MOVEL*BLANK    WN0598 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0599  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0600 112       Flat Amount
     C                     MOVEL*BLANK    WN0601  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0602  50       Total Stops
     C                     MOVEL*BLANK    WN0603 20        Trailer Id
     C                     MOVEL*BLANK    WN0604  3        Transloader Car
     C                     Z-ADD*ZERO     WN0605  40       BOL Time
     C                     MOVEL*BLANK    WN0606  3        Carrier Code
     C                     MOVEL*BLANK    WN0607  7        Truck Size
     C                     Z-ADD*ZERO     WN0608  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0609 112       Rated Freight
     C                     MOVEL*BLANK    WN0610  1        Ship Status
     C                     MOVEL*BLANK    WN0611  1        Load Type
     C                     Z-ADD*ZERO     WN0612  50       Number Pallets
     C                     Z-ADD*ZERO     WN0613  50       Number Pallets
     C                     Z-ADD*ZERO     WN0614 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0615  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0616  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0617  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0618 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0619 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0620  70       Actual Departur
     C                     Z-ADD*ZERO     WN0621  40       Departure Time
     C                     Z-ADD*ZERO     WN0622  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0623  52       Product Tempera
     C                     Z-ADD*ZERO     WN0624  50       Number Spacers
     C                     MOVEL*BLANK    WN0625 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0626  70       Total Load Mile
     C                     MOVEL*BLANK    WN0627 12        Recorder ID
     C                     MOVEL*BLANK    WN0628  2        Shipping Method
     C                     MOVEL*BLANK    WN0629  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0630  2        Ship To State C
     C                     Z-ADD*ZERO     WN0631  70       Gross Weight
     C                     MOVEL*BLANK    WN0632  3        Carrier Broker
     C                     Z-ADD*ZERO     WN0633  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0634  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0635  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0636  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0637  70       Spotted Date
     C                     Z-ADD*ZERO     WN0638  60       Spotted Time
     C                     Z-ADD*ZERO     WN0639  70       Load Finished D
     C                     Z-ADD*ZERO     WN0640  60       Load Finished T
     C                     Z-ADD*ZERO     WN0641  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0642  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0643  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0644  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0645  70       Truck Departure
     C                     Z-ADD*ZERO     WN0646  60       Truck Departure
     C                     Z-ADD*ZERO     WN0647  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0648  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0649  3        Shipping Line
     C                     MOVEL*BLANK    WN0650 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0651 30        Vessel Name
     C                     Z-ADD*ZERO     WN0652  50       Voyage
     C                     Z-ADD*ZERO     WN0653  70       Sail Date
     C                     MOVEL*BLANK    WN0654 12        Booking Number
     C                     MOVEL*BLANK    WN0655 20        Discharge Port
     C                     Z-ADD*ZERO     WN0656  70       Arrival Date
     C                     MOVEL*BLANK    WN0657 12        Container Numbe
     C                     Z-ADD*ZERO     WN0658  70       Date In
     C                     Z-ADD*ZERO     WN0659  60       Time In
     C                     Z-ADD*ZERO     WN0660  70       Date Out
     C                     Z-ADD*ZERO     WN0661  60       Time Out
     C                     Z-ADD*ZERO     WN0662 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0663  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0664  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0665  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0666  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0667  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0668  70       Requested Deliv
     C                     MOVEL*BLANK    WN0669  1        Load Acceptance
     C                     MOVEL*BLANK    WN0670  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0671  70       On Yard Date
     C                     Z-ADD*ZERO     WN0672  60       On Yard Time
     C                     Z-ADD*ZERO     WN0673  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0674  60       Deadline Depart
     C                     MOVEL*BLANK    WN0675  1        Load Held Over
     C                     MOVEL*BLANK    WN0676  1        Load Held Over
     C                     MOVEL*BLANK    WN0677 15        Load Held Over
     C                     MOVEL*BLANK    WN0678 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0679 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0680  70       Express Mail Da
     C                     MOVEL*BLANK    WN0681  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0682  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0683  70       Product Complet
     C                     Z-ADD*ZERO     WN0684  60       Product Complet
     C                     Z-ADD*ZERO     WN0685  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0686  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0687  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0688  1        Load Confirmed
     C                     MOVEL*BLANK    WN0689 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0690  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0691  60       Load Door 1
     C                     Z-ADD*ZERO     WN0692  70       Override Total
     C                     Z-ADD*ZERO     WN0693  60       Load Door 2
     C                     MOVEL*BLANK    WN0694  1        Partial Load
     C                     MOVEL*BLANK    WN0695  1        Load Confirmati
     C                     MOVEL*BLANK    WN0696  1        Export Load USD
     C                     MOVEL*BLANK    WN0697  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0698 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0699 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0700 15        Late Billing Em
     C                     MOVEL*BLANK    WN0701 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0702 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0703  1        Multi Company L
     C                     MOVEL*BLANK    WN0704  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0705  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0706  1        LH Power Only L
     C                     MOVEL*BLANK    WN0707  1        MG Created Load
     C                     MOVEL*BLANK    WN0708  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0709  2        Load U/M
     C                     MOVEL*BLANK    WN0710  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0711  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0712  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0713  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0714  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0715  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0716  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0717  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0718  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0719  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0720  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0721  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0722  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0723  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0724  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0725  60       LH Unused Time
     C                     MOVEL*BLANK    WN0726  1        EDI Status 1
     C                     MOVEL*BLANK    WN0727  1        EDI Status 2
     C                     MOVEL*BLANK    WN0728  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0729  60       Job Time
     C                     MOVEL*BLANK    WN0730 10        User Id
     C                     MOVEL*BLANK    WN0731 10        Job Name
     C                     Z-ADD*ZERO     WN0732  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDBERMNB    WHRMNB           Load ID
      *
     C           KLCHTK    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHTK    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YGRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL#1U2ST    WHU2ST    P      Export Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * CHG OHE fm OH More Scr CH - Order Header Extension  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0733  70       Load ID
     C                     Z-ADD*ZERO     WN0734  50       Stop/Drop Seque
     C                     MOVEL*BLANK    WN0735  3        Shipping Line
     C                     MOVEL*BLANK    WN0736 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0737 25        OHE City
     C                     MOVEL*BLANK    WN0738 30        OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0739 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0740 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0741  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0742  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0743  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0744  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0745  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0746 12        OHE Container N
     C                     MOVEL*BLANK    WN0747 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0748 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0749 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0750 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0751 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0752 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0753 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0754 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0755 112       Transload Termi
     C                     Z-ADD*ZERO     WN0756  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0757  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0758  70       OHE Port/Pier P
     C                     Z-ADD*ZERO     WN0759  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0760  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0761  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0762  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0763  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0764  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0765  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0766  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0767  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0768  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0769  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0770  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0771  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0772 38        Delivery P.O. N
     C                     MOVEL*BLANK    WN0773  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0774  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0775  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0776  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0777  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0778  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0779  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0780 10        OHE Transload S
     C                     MOVEL*BLANK    WN0781 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0782 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0783 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0784 15        OHE Transload C
     C                     MOVEL*BLANK    WN0785 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0786 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0787 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0788 50        OHE Backhaul Co
     C                     Z-ADD*ZERO     WN0789  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0790  30       LD Stop/Drop
     C                     Z-ADD*ZERO     WN0791  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0792  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0793  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0794  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0795  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0796  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0797  60       Original Appoin
     C                     Z-ADD*ZERO     WN0798  60       Original Appoin
     C                     Z-ADD*ZERO     WN0799  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0800  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0801  90       OHE Unused Nume
     C                     MOVEL*BLANK    WN0802 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0803  1        OHE Unused Stat
     C                     MOVEL*BLANK    WN0804  1        OHE Unused Stat
     C                     MOVEL*BLANK    WN0805  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0806  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0807  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0808  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0809 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0810 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0811 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0812  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0813  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0814  1        EDI Status 1
     C                     MOVEL*BLANK    WN0815  1        EDI Status 2
     C                     MOVEL*BLANK    WN0816  1        EDI Status 3
     C                     MOVEL*BLANK    WN0817  1        Record Status
     C                     Z-ADD*ZERO     WN0818  60       Job Time
     C                     MOVEL*BLANK    WN0819 10        User Id
     C                     MOVEL*BLANK    WN0820 10        Job Name
     C                     Z-ADD*ZERO     WN0821  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDBEAIC3    WJAIC3           Company Number
     C                     Z-ADDBEC4NB    WJC4NB           Order Number
      *
     C           KLCHTL    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHTL    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YHRDCS
      * Move non-key fields to @AMREJE
     C                     MOVEL#DJ1T1    WJJ1T1    P      OHE Booking Num
     C                     MOVEL#DHSSC    WJV4T1    P      OHE Abs Rate Ov
     C                     MOVELYL0007    WJWDT1    P      Letter of Credi
     C                     Z-ADDYL0036    WJQMNY           OHE Orig ABS Fr
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     Z-ADD##JDT     WJAXDT           Job Date
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     MOVEL##USR     WJAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WKAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WKAIC3           Company Number
      * Establish starting position
     C           KRSTM     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #PAPTX           Name
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKADTX    #PAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTN01           Application Cod
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTN01           Application Cod
     C                     MOVEL'OMS'     WQTN01           Application Cod
      * Establish starting position
     C           KRSTN     SETLL@DNRESF                    *
     C           KRSTN     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TORVGN
     C                     END                             *FI
     C           KRSTN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTO01           Application Cod
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTO01           Application Cod
      * Establish starting position
     C           KRSTO     SETLL@DNRESF                    *
     C           KRSTO     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTO     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Save Existing Data.
      *================================================================
     C                     Z-ADDBEBKC7    YL0008           Ship To Custome
     C                     MOVELBEHMNA    YL0009           Ship To Address
     C                     MOVELBEHONA    YL0010           Ship To Address
     C                     MOVELBEHPNA    YL0011           Ship To Address
     C                     MOVELBEHNNA    YL0012           Ship To City
     C                     MOVELBEDBCD    YL0013           Ship To State C
     C                     MOVELBECKTX    YL0014           Ship To Zip/Pos
     C                     MOVELBEBCNA    YL0015           Customer Purcha
     C                     MOVELBEFTSX    YL0016           Air Freight Ord
     C                     MOVELBEBCST    YL0017           Block Order Fla
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X02    IFEQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0001  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0002  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0003  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VB999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVBAB    KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    ABAIC3
     C           KLVBAB    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
     C           VB999     TAG
      * Restrictor relation not satisfied
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Order Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Order Type - Sa
     C           YPMTFD    OREQ '#1JNCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JNCD' defaulted for 'Order Type - Sales'.
     C                     CALL 'PDZ2SRR'              90  SEL OP Order Ty
     C                     PARM *BLANK    W0RTN   7
     C           #1JNCD    PARM #1JNCD    WQ0049  2        Order Type - Sa
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZ2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1JNCD    IFNE *BLANK                     Order Type - Sa
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JNCD    IFEQ *BLANK                     Order Type - Sa
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCEX    KLIST
     C                     KFLD           EXJNCD           Order Type - Sa
      * Setup key
     C                     MOVEL#1JNCD    EXJNCD
     C           KLVCEX    CHAIN@EXRETY              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Order Types            NF'
     C                     MOVEL'USR1063' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1063' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1ANC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ANC7' defaulted for 'A/R Customer Number'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1ANC7    PARM #1ANC7    WQ0050  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ANC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ANC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWE    KLIST
     C                     KFLD           WEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1ANC7    WEBKC7
     C           KLVDWE    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1DBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1DBCD' defaulted for 'Ship To State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1DBCD    PARM #1DBCD    WQ0051  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9937  *
     C                     END
      *
     C           #1DBCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DBCD    IFEQ *BLANK                     State Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1DBCD    ACBGCD
     C           KLVEAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1B0C7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Ship To Custome
     C           YPMTFD    OREQ '#1B0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1B0C7' defaulted for 'Bill to Customer'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1B0C7    PARM #1B0C7    WQ0052  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1B0C7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1B0C7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWE    KLIST
     C                     KFLD           WEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1B0C7    WEBKC7
     C           KLVFWE    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A0DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A0DT    AFBCDT
     C           KLVGAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Terms
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AQCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Terms Code
     C           YPMTFD    OREQ '#1AQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1AQCD' defaulted for 'Terms Code'.
     C                     CALL 'PDDMSRR'              90  SEL Active Term
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0053  30       Company Number
     C           #1AQCD    PARM #1AQCD    WQ0054  2        Terms Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AQCD    IFNE *BLANK                     Terms Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AQCD    IFEQ *BLANK                     Terms Code
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHAO    KLIST
     C                     KFLD           AOAIC3           Company Number
     C                     KFLD           AOAQCD           Terms Code
      * Setup key
     C                     Z-ADD#1AIC3    AOAIC3
     C                     MOVEL#1AQCD    AOAQCD
     C           KLVHAO    CHAIN@AOREU1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Terms                  NF'
     C                     MOVEL'USR0037' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0037' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0080  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VI999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVIAB    KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    ABAIC3
     C           KLVIAB    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
     C           VI999     TAG
      * Restrictor relation not satisfied
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDGE019
     C           ZHCSCL    ANDLE025
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1C4NB'  YPMTFD           Order Number
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDGE046
     C           ZHCSCL    ANDLE047
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1DBCD'  YPMTFD           Ship To State C
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ086
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1FTSX'  YPMTFD           Air Freight Ord
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDEQ086
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN78     ANDEQ'0'
     C                     MOVEL'#1VDST'  YPMTFD           Load Type
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN77     ANDEQ'0'
     C                     MOVEL'#1U4ST'  YPMTFD           Load Plan Order
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1U5ST'  YPMTFD           Print Pick Slip
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ086
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1VFST'  YPMTFD           Shrink Wrap
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDGE116
     C           ZHCSCL    ANDLE117
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DHSSC'  YPMTFD           Abs Frt Overrid
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ086
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1VGST'  YPMTFD           Slip Sheet
     C                     END
      *
     C           ZHCSRW    IFEQ 020
     C           ZHCSCL    ANDEQ086
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1FOSX'  YPMTFD           Email Cust On O
     C                     END
      *
     C           ZHCSRW    IFEQ 021
     C           ZHCSCL    ANDEQ086
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1BCST'  YPMTFD           Block Order Fla
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO ZXEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1ANC7           A/R Customer Nu
     C                     MOVEL*BLANK    P1BCNA           Customer Purcha
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     Z-ADD*ZERO     P1AFTM           Requested Deliv
     C                     MOVEL*BLANK    P1VDST           Load Type
     C                     MOVEL*BLANK    P4APTX           Company Name
     C                     MOVEL*BLANK    P5Z9ST           Shipping Method
     C                     MOVEL*BLANK    P5CSST           Load Type Dft
     C                     MOVEL*BLANK    P5Z8ST           LTL Flag Dft
     C                     MOVEL*BLANK    P5CXST           Export Status D
     C                     MOVEL*BLANK    P5SWST           Shrink Wrap Dft
     C                     Z-ADD*ZERO     P5XXTM           Departure Time
     C                     MOVEL*BLANK    P5UECD           Export Code Dft
     C                     MOVEL*BLANK    P5HSST           Allow Mult Whse
     C                     MOVEL*BLANK    P5AMEO           Allow Multi Exp
     C                     MOVEL*BLANK    P5SSDF           Slip Sheet Dft
     C                     MOVEL*BLANK    P5PDFT           Palletize Dft
     C                     MOVEL*BLANK    P5YJSX           Company Organiz
     C                     MOVEL*BLANK    P6OAST           Processing Cycl
     C                     MOVEL*BLANK    P6OBST           Billing Activit
     C                     MOVEL*BLANK    P6OEST           Affect Inventor
     C                     MOVEL*BLANK    P7E5ST           USR Output Only
     C                     MOVEL*BLANK    P7STE7           USR Output Only
     C                     MOVEL*BLANK    P7STE8           USR Output Only
     C                     Z-ADD*ZERO     P7BLC7           USR Ship To Cus
     C                     MOVEL*BLANK    P7PPST           P.O. Required F
     C                     MOVEL*BLANK    P7GGST           USR Display fie
     C                     Z-ADD*ZERO     P7NB01           Number of Order
     C                     Z-ADD*ZERO     P7NB02           Number of Order
     C                     MOVEL*BLANK    P7V4T1           OHE Abs Rate Ov
     C                     MOVEL*BLANK    P7O1ST           Live with TPM
     C                     MOVEL*BLANK    P7LISX           Output Only 1 U
     C                     MOVEL*BLANK    P7B8ST           Status - Y or N
     C                     MOVEL*BLANK    P7Q1ST           Status Flag 1
     C                     MOVEL*BLANK    P7RYSX           MG Created Load
     C                     Z-ADD*ZERO     P8RMNB           Load ID
     C                     MOVEL*BLANK    P8XQST           Allocate Pounds
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Define work field Load Acceptance Flag
     C                     MOVEL*BLANK    WURMST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBR5NB           Deliver after t
     C                     Z-ADD*ZERO     WBR6NB           Deliver before
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WBW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WCRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WCRWNB           Miles to next s
     C                     Z-ADD*ZERO     WCRXNB           Freight Charge
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WCT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCKFDT           Appointment Con
     C                     Z-ADD*ZERO     WCACTM           Appointment Con
     C                     Z-ADD*ZERO     WCEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WCAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WCN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WCN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WCB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WCB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WCB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Country Code
     C                     MOVEL*BLANK    WUKXCD  6
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field Order Entry Hold
     C                     MOVEL*BLANK    WUQNST  1
      * Define work field Ship To Customer Flag
     C                     MOVEL*BLANK    WURJST  1
      * Define work field Customer TF Exempt Code
     C                     MOVEL*BLANK    WUP3SX  2
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WDGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field USR Date - ATR
     C                     Z-ADD*ZERO     WUBQDT  70
      * Define work field USR To Time 4.0
     C                     Z-ADD*ZERO     WUHLNX  40
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEP3NB           D & B Number
     C                     Z-ADD*ZERO     WEI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WEAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WES2NB           Parent Credit L
     C                     Z-ADD*ZERO     WEVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WEI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Shipping Line
     C                     MOVEL*BLANK    WUXACD  3
      * Define work field Port Delv Terminal
     C                     MOVEL*BLANK    WUOANA 20
      * Define work field OHE City
     C                     MOVEL*BLANK    WUHBAA 25
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field A/R order Value Total
     C                     Z-ADD*ZERO     WUVRVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WFACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WFADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WFAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WFAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WFAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WFVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WFVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WFVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WFVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WFVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WFVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WFEEVA           Value of Open O
     C                     Z-ADD*ZERO     WFAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WFAHDT           Date of First S
     C                     Z-ADD*ZERO     WFANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WFANVA           Amount of Last
     C                     Z-ADD*ZERO     WFALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WFAMVA           Amount of Last
     C                     Z-ADD*ZERO     WFAIDT           Date of Highest
     C                     Z-ADD*ZERO     WFALVA           Amount of Highe
     C                     Z-ADD*ZERO     WFDJNB           Number of Invoi
     C                     Z-ADD*ZERO     WFDLNB           Number of Order
     C                     Z-ADD*ZERO     WFDDNB           Number of Credi
     C                     Z-ADD*ZERO     WFDMNB           Number of Payme
     C                     Z-ADD*ZERO     WFDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WFLYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WFLYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WFLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WFLYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WFADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WFVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WFBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WFBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WFVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WFVQVA           Last Year Sales
     C                     Z-ADD*ZERO     WFCUMO           Current Month
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Change Log Prior Value
     C                     MOVEL*BLANK    WUMNTX 12
      * Define work field Change Log New Value
     C                     MOVEL*BLANK    WUMOTX 12
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WHRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WHFLAM           Flat Amount
     C                     Z-ADD*ZERO     WHRRNB           Total Stops
     C                     Z-ADD*ZERO     WHSBNB           BOL Time
     C                     Z-ADD*ZERO     WHSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHSDNB           Number Pallets
     C                     Z-ADD*ZERO     WHPAOU           Number Pallets
     C                     Z-ADD*ZERO     WHDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WHSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WHHADT           Actual Arrival
     C                     Z-ADD*ZERO     WHAART           Actual Arrival
     C                     Z-ADD*ZERO     WHDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WHDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WHAQDT           Actual Departur
     C                     Z-ADD*ZERO     WHS6NB           Departure Time
     C                     Z-ADD*ZERO     WHT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WHPRTM           Product Tempera
     C                     Z-ADD*ZERO     WHNPSV           Number Spacers
     C                     Z-ADD*ZERO     WHTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WHGRWE           Gross Weight
     C                     Z-ADD*ZERO     WHF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WHJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WHTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WHJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WHSPTM           Spotted Time
     C                     Z-ADD*ZERO     WHJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WHLFTM           Load Finished T
     C                     Z-ADD*ZERO     WHJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WHBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WHJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WHBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WHKIDT           Truck Departure
     C                     Z-ADD*ZERO     WHASTM           Truck Departure
     C                     Z-ADD*ZERO     WHKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WHAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WHVOAG           Voyage
     C                     Z-ADD*ZERO     WHKBDT           Sail Date
     C                     Z-ADD*ZERO     WHEFDT           Arrival Date
     C                     Z-ADD*ZERO     WHKCDT           Date In
     C                     Z-ADD*ZERO     WHTMIN           Time In
     C                     Z-ADD*ZERO     WHKDDT           Date Out
     C                     Z-ADD*ZERO     WHVMNB           Time Out
     C                     Z-ADD*ZERO     WHOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WHKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WHATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WHBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WHEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WHKKDT           On Yard Date
     C                     Z-ADD*ZERO     WHAVTM           On Yard Time
     C                     Z-ADD*ZERO     WHKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WHAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WHLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WHK0DT           Product Complet
     C                     Z-ADD*ZERO     WHAYTM           Product Complet
     C                     Z-ADD*ZERO     WHKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WHICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WHIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WHK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WHAZTM           Load Door 1
     C                     Z-ADD*ZERO     WHK2DT           Override Total
     C                     Z-ADD*ZERO     WHA0TM           Load Door 2
     C                     Z-ADD*ZERO     WHZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WHPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WHCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WHPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WHCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WHP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WHCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WHP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WHCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WHP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WHCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WHP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WHCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJRMNB           Load ID
     C                     Z-ADD*ZERO     WJRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WJQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WJQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WJQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WJGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WJGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WJGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WJGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WJHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WJHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WJHGVL           Transload Termi
     C                     Z-ADD*ZERO     WJQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WJQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WJQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WJQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WJITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WJQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WJQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WJQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WJP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WJP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WJQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WJQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WJQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WJQENY           Original Appoin
     C                     Z-ADD*ZERO     WJQFNY           Original Appoin
     C                     Z-ADD*ZERO     WJQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WJQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WJQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WJQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WJW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WJW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  52
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006 10
     C                     Z-ADD*ZERO     WL0007  96
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  2
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014  6
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  30
     C                     MOVEL*BLANK    WL0019  3
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0020  30
     C                     Z-ADD*ZERO     WL0021  70
     C                     MOVEL*BLANK    WL0022  2
     C                     MOVEL*BLANK    WL0023  3
     C                     MOVEL*BLANK    WL0024 40
     C                     MOVEL*BLANK    WL0025 40
     C                     MOVEL*BLANK    WL0026  3
     C                     MOVEL*BLANK    WL0027  1
     C                     Z-ADD*ZERO     WL0028  40
     C                     MOVEL*BLANK    WL0029  2
     C                     Z-ADD*ZERO     WL0030  52
     C                     Z-ADD*ZERO     WL0031  92
     C                     MOVEL*BLANK    WL0032  3
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  3
     C                     MOVEL*BLANK    WL0035  3
     C                     MOVEL*BLANK    WL0036  1
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0037  70
     C                     MOVEL*BLANK    WL0038 30
     C                     MOVEL*BLANK    WL0039 30
     C                     MOVEL*BLANK    WL0040 30
     C                     MOVEL*BLANK    WL0041 30
     C                     MOVEL*BLANK    WL0042 20
     C                     MOVEL*BLANK    WL0043  2
     C                     MOVEL*BLANK    WL0044 11
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046  6
      * Define local variables for subroutine SWRVGN.
     C                     MOVEL*BLANK    WL0047 20
     C                     MOVEL*BLANK    WL0048  2
     C                     MOVEL*BLANK    WL0049  1
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0050  30
     C                     Z-ADD*ZERO     WL0051  70
     C                     Z-ADD*ZERO     WL0052 112
      * Define local work field USR Display 13
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field OHE Orig ABS Freight Rate
     C                     Z-ADD*ZERO     YL0002  96
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0003  52
      * Define local work field Abs Frt Override Reason
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field Absorbed Freight Rate 2
     C                     Z-ADD*ZERO     YL0005  52
      * Define local work field Crt Load Order Chg Log
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Letter of Credit Number
     C                     MOVEL*BLANK    YL0007 50
      * Define local work field Ship To Customer SavUsr
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0009 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0010 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0011 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0012 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YL0014 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0015 15
      * Define local work field Air Freight Order
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Must Ship Error
     C                     MOVEL*BLANK    YL0018  3
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0001  2
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0003 40
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0004 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0005  3
      * Define null work field P.O. Required Flag
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field Deliver after time
     C                     Z-ADD*ZERO     YN0007  40
      * Define null work field Type Code
     C                     MOVEL*BLANK    YN0008  2
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0009  52
      * Define null work field Mileage To Customer
     C                     Z-ADD*ZERO     YN0010  92
      * Define null work field Outside Warehouse Flag
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Customer Group Code
     C                     MOVEL*BLANK    YN0012  3
      * Define null work field Customer Group Code 2
     C                     MOVEL*BLANK    YN0013  3
      * Define null work field Ord Ent Default Sls Rte
     C                     MOVEL*BLANK    YN0014  1
      * Define local work field Must Ship Date        USR
     C                     Z-ADD*ZERO     YL0019  70
      * Define local work field Must Ship Time        USR
     C                     Z-ADD*ZERO     YL0020  60
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0016  3
      * Define local work field Text USR 4
     C                     MOVEL*BLANK    YL0021  4
      * Define local work field Text USR 6
     C                     MOVEL*BLANK    YL0022  6
      * Define null work field OHE Vessel/Airline
     C                     MOVEL*BLANK    YN0017 30
      * Define null work field OHE Voyage/Flight
     C                     MOVEL*BLANK    YN0018 15
      * Define null work field OHE Booking Number
     C                     MOVEL*BLANK    YN0019 15
      * Define null work field OHE Discharge Port/Airprt
     C                     MOVEL*BLANK    YN0020 20
      * Define null work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YN0021  70
      * Define null work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YN0022  70
      * Define null work field OHE Arrival Date
     C                     Z-ADD*ZERO     YN0023  70
      * Define null work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YN0024  3
      * Define null work field OHE Ship Status
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field OHE Container Number
     C                     MOVEL*BLANK    YN0026 12
      * Define null work field OHE Comment 1
     C                     MOVEL*BLANK    YN0027 35
      * Define null work field OHE Comment 2
     C                     MOVEL*BLANK    YN0028 75
      * Define null work field Port Address Line 1
     C                     MOVEL*BLANK    YN0029 25
      * Define null work field Port Address Line 2
     C                     MOVEL*BLANK    YN0030 25
      * Define null work field Port Zip/Postal Code
     C                     MOVEL*BLANK    YN0031 11
      * Define null work field Port Phone Number
     C                     Z-ADD*ZERO     YN0032 110
      * Define null work field Port Fax Number
     C                     MOVEL*BLANK    YN0033 25
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0023  30
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0024 80
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0025  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0026  30
      * Define local work field Ord TF Exempt Code
     C                     MOVEL*BLANK    YL0027  2
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0028  6
      * Define local work field Load Acceptance Flag
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field Text USR 5
     C                     MOVEL*BLANK    YL0030  5
      * Define local work field USR Text 3  3a
     C                     MOVEL*BLANK    YL0031  3
      * Define local work field Text 2
     C                     MOVEL*BLANK    YL0032  2
      * Define local work field Absorbed Freight 6A USR
     C                     MOVEL*BLANK    YL0033  6
      * Define local work field Pricing Event Called From
     C                     MOVEL*BLANK    YL0034  3
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0035  1
      * Define null work field OHE Abs Rate Override Rsn
     C                     MOVEL*BLANK    YN0034 10
      * Define local work field OHE Orig ABS Freight Rate
     C                     Z-ADD*ZERO     YL0036  96
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TNRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL@CN,006   P2BYVN           Next Program Na
     C                     MOVEL*BLANK    YL0034           Pricing Event C
     C                     MOVEL'OE'      YL0034           Pricing Event C
      * EXC Rtv Status        XF - PFS Interface  * 
     C                     CALL 'PBXNXFR'              90  EXC Rtv Status
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0081  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0082  6        PFS Interface C
     C           P7O1ST    PARM *BLANK    WQ0083  1        PFS Carlisle Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
010430104801299
** W0END
010450107701305
** W0NAM
V1AIC3    #PAPTX    V1C4NB
** W1BEG
01047010520130301366015590162201815
01878020710213402327023900258302606
02611026460266702670030890309803127
03345033490342103872039260395604128
04182042120438404438044680464004694
047240495005152052060540805462
** W1END
01049010810130901372015880165101844
01907021000216302356024190260202607
02621026650266802680030950309903133
03347033680343003873039260396104135
04182042170438404438044730464004694
047250495005166052060541405462
** W1NAM
V1AIC3    #PAPTX    V1BKC7    V1B0C7    #1BRTX    #1AETX    #1HMNA
#1B1NA    #1HONA    #1B3NA    #1HPNA    #1B4NA    #1HNNA    #1DBCD
#1CKTX    #1B2NA    #1BHCD    #1C8TX    V1C4NB    #1JNCD    #1RMNB
#DBCCD    #DALTX    #DMTCU    #1AQCD    #1FTSX    #DLMNY    V1A0DT
#1VDST    #1TBNB    #1U4ST    #1VEST    #DLNNY    #1U5ST    #1VFST
#DHSSC    #1VGST    #1BCNA    #1FOSX    #1BPTM    #1BCST
** @CN
00001 USR0752
00002 Abs Frt Override Rsn not
00003 allowed if Buyers Truck.
00004 PMGFE2R
00005 PDN9EFR
00006 PDSVE1R
