     H/TITLE Crt Hog Pop Dtl Shell XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : SYNON/2  Version:  1035
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISPPATE
     H* Date          : 03/01/99  Time  : 11:45:03
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKC9CPL0IF  E           K        DISK                      A
      * UPD : Hog Population Rpt Dtl    Update index
      *
     I@C9CPQS
      * Hog Population Rpt Dtl    Update index
      * Renamed input format fields
     I              C9K1ST                          WAK1ST
     I              C9JCTX                          WAJCTX
     I              C9QUNB                          WAQUNB
     I              C9QVNB                          WAQVNB
     I              C9QWNB                          WAQWNB
     I              C9QXNB                          WAQXNB
     I              C9QZNB                          WAQZNB
     I              C9Q0NB                          WAQ0NB
     I              C9Q1NB                          WAQ1NB
     I              C9Q2NB                          WAQ2NB
     I              C9Q3NB                          WAQ3NB
     I              C9Q4NB                          WAQ4NB
     I              C9Q5NB                          WAQ5NB
     I              C9Q6NB                          WAQ6NB
     I              C9Q7NB                          WAQ7NB
     I              C9Q8NB                          WAQ8NB
     I              C9Q9NB                          WAQ9NB
     I              C9RANB                          WARANB
     I              C9RBNB                          WARBNB
     I              C9RCNB                          WARCNB
     I              C9RDNB                          WARDNB
     I              C9RENB                          WARENB
     I              C9RFNB                          WARFNB
     I              C9RGNB                          WARGNB
     I              C9RHNB                          WARHNB
     I              C9RINB                          WARINB
     I              C9RJNB                          WARJNB
     I              C9LMPR                          WALMPR
     I              C9LNPR                          WALNPR
     I              C9LOPR                          WALOPR
     I              C9LPPR                          WALPPR
     I              C9LQPR                          WALQPR
     I              C9LRPR                          WALRPR
     I              C9LSPR                          WALSPR
     I              C9LTPR                          WALTPR
     I              C9LUPR                          WALUPR
     I              C9L0PR                          WAL0PR
     I              C9LVPR                          WALVPR
     I              C9LWPR                          WALWPR
     I              C9LXPR                          WALXPR
     I              C9LYPR                          WALYPR
     I              C9LZPR                          WALZPR
     I              C9L1PR                          WAL1PR
     I              C9L2PR                          WAL2PR
     I              C9L3PR                          WAL3PR
     I              C9L4PR                          WAL4PR
     I              C9L5PR                          WAL5PR
     I              C9AAVN                          WAAAVN
     I              C9AADT                          WAAADT
     I              C9AMTM                          WAAMTM
     I              C9AJST                          WAAJST
     I              C9AHVN                          WAAHVN
     I              C9AGVN                          WAAGVN
     I              C9ABVN                          WAABVN
     I              C9ABDT                          WAABDT
     I              C9ABTM                          WAABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKC91    E DSPKC9CPL0
      * UPD : Hog Population Rpt Dtl    Update index
      * Renamed input format fields
     I              C9K1ST                          WAK1ST
     I              C9JCTX                          WAJCTX
     I              C9QUNB                          WAQUNB
     I              C9QVNB                          WAQVNB
     I              C9QWNB                          WAQWNB
     I              C9QXNB                          WAQXNB
     I              C9QZNB                          WAQZNB
     I              C9Q0NB                          WAQ0NB
     I              C9Q1NB                          WAQ1NB
     I              C9Q2NB                          WAQ2NB
     I              C9Q3NB                          WAQ3NB
     I              C9Q4NB                          WAQ4NB
     I              C9Q5NB                          WAQ5NB
     I              C9Q6NB                          WAQ6NB
     I              C9Q7NB                          WAQ7NB
     I              C9Q8NB                          WAQ8NB
     I              C9Q9NB                          WAQ9NB
     I              C9RANB                          WARANB
     I              C9RBNB                          WARBNB
     I              C9RCNB                          WARCNB
     I              C9RDNB                          WARDNB
     I              C9RENB                          WARENB
     I              C9RFNB                          WARFNB
     I              C9RGNB                          WARGNB
     I              C9RHNB                          WARHNB
     I              C9RINB                          WARINB
     I              C9RJNB                          WARJNB
     I              C9LMPR                          WALMPR
     I              C9LNPR                          WALNPR
     I              C9LOPR                          WALOPR
     I              C9LPPR                          WALPPR
     I              C9LQPR                          WALQPR
     I              C9LRPR                          WALRPR
     I              C9LSPR                          WALSPR
     I              C9LTPR                          WALTPR
     I              C9LUPR                          WALUPR
     I              C9L0PR                          WAL0PR
     I              C9LVPR                          WALVPR
     I              C9LWPR                          WALWPR
     I              C9LXPR                          WALXPR
     I              C9LYPR                          WALYPR
     I              C9LZPR                          WALZPR
     I              C9L1PR                          WAL1PR
     I              C9L2PR                          WAL2PR
     I              C9L3PR                          WAL3PR
     I              C9L4PR                          WAL4PR
     I              C9L5PR                          WAL5PR
     I              C9AAVN                          WAAAVN
     I              C9AADT                          WAAADT
     I              C9AMTM                          WAAMTM
     I              C9AJST                          WAAJST
     I              C9AHVN                          WAAHVN
     I              C9AGVN                          WAAGVN
     I              C9ABVN                          WAABVN
     I              C9ABDT                          WAABDT
     I              C9ABTM                          WAABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Hog Population Rpt Dtl
      * I :  HRH Type Of Distribution
     I                                        1   1 P1K1ST
      * I :  HRH Report Break
     I                                        2  26 P1JCTX
      * I :  HRD Min Carcass Weight
     I                                    P  27  290P1QUNB
      * I :  HRD Max Carcass Weight
     I                                    P  30  320P1QVNB
      * I :  HRD Min Live Weight
     I                                    P  33  350P1QWNB
      * I :  HRD Max Live Weight
     I                                    P  36  380P1QXNB
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1K1ST    PARM           WP0001  1        HRH Type Of Dis
     C           P1JCTX    PARM           WP0002 25        HRH Report Brea
     C           P1QUNB    PARM           WP0003  50       HRD Min Carcass
     C           P1QVNB    PARM           WP0004  50       HRD Max Carcass
     C           P1QWNB    PARM           WP0005  50       HRD Min Live We
     C           P1QXNB    PARM           WP0006  50       HRD Max Live We
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt Hog Pop Dtl Shell XF
      * HPE085
      * Hog Pop by farm site
      *  -- Init new fields in Hog Pop Dtl to zero
      * Crt Hog Population Rpt CR - Hog Population Rpt Dtl  * 
     C                     EXSR SACRRC
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SACRRC    BEGSR
      *================================================================
      * Crt Hog Population Rpt CR - Hog Population Rpt Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C9CPQS
     C                     MOVELP1K1ST    WAK1ST           HRH Type Of Dis
     C                     MOVELP1JCTX    WAJCTX           HRH Report Brea
     C                     Z-ADDP1QUNB    WAQUNB           HRD Min Carcass
     C                     Z-ADDP1QVNB    WAQVNB           HRD Max Carcass
     C                     Z-ADDP1QWNB    WAQWNB           HRD Min Live We
     C                     Z-ADDP1QXNB    WAQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WAQZNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ0NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ1NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ2NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ3NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ4NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ5NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ6NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ7NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ8NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ9NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WARANB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WARBNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WARCNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WARDNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WARENB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WARFNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WARGNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WARHNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WARINB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WARJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WALMPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALNPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALOPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALPPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALQPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALRPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALSPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALTPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALUPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL0PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALVPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALWPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALXPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALYPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALZPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL1PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL2PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL3PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL4PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL5PR           HRD Dist Hot Wt
     C                     MOVEL*BLANK    WAAAVN           RS User Changed
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL*BLANK    WAAHVN           RS Job
     C                     MOVEL*BLANK    WAAGVN           RS Program
     C                     MOVEL*BLANK    WAABVN           RS User Added
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRSA    KLIST
     C                     KFLD           WAK1ST           HRH Type Of Dis
     C                     KFLD           WAJCTX           HRH Report Brea
     C                     KFLD           WAQUNB           HRD Min Carcass
     C                     KFLD           WAQVNB           HRD Max Carcass
      * Check for duplicate primary key
     C           KLCRSA    SETLL@C9CPQS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0477' W0RTN   7
      * Send message 'Hog Population Rpt Dtl EX'
     C                     MOVEL'PRK0477' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C                     WRITE@C9CPQS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAQUNB  50       HRD Min Carcass
     C                     Z-ADD*ZERO     WAQVNB  50       HRD Max Carcass
     C                     Z-ADD*ZERO     WAQWNB  50       HRD Min Live We
     C                     Z-ADD*ZERO     WAQXNB  50       HRD Max Live We
     C                     Z-ADD*ZERO     WAQZNB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ0NB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ1NB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ2NB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ3NB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ4NB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ5NB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ6NB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ7NB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ8NB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WAQ9NB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WARANB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WARBNB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WARCNB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WARDNB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WARENB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WARFNB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WARGNB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WARHNB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WARINB  70       HRD Dist Carcas
     C                     Z-ADD*ZERO     WARJNB  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WALMPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALNPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALOPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALPPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALQPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALRPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALSPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALTPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALUPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL0PR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALVPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALWPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALXPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALYPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WALZPR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL1PR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL2PR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL3PR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL4PR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAL5PR 152       HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WAAADT  70       RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM  60       RS Time Changed
     C                     Z-ADD*ZERO     WAABDT  70       RS Date Added
     C                     Z-ADD*ZERO     WAABTM  60       RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
