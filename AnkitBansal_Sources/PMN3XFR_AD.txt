// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMN3XFR
// ?Date: 14.08.2025 Time: 03:43:33
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(RTV & Fix Item Values  RT) TYPE(RTVOBJ) FILE(PDKZCPP)          AC1849360;
{
 //?USER: Process Data record

 CASE;

 // IF DB1.Job Name is ICUOE2R
 IF DB1.Job_Name = 'ICUOE2R';

 // WRK.Date (Alpha) USR = CON.*BLANK
 WRK.Date_Alpha_USR = *BLANK;

 // WRK.Date Component Alpha  USR = CON.*BLANK
 WRK.Date_Component_Alpha_USR = *BLANK;

 // WRK.Revaluation Eff. Date = CON.*ZERO
 WRK.Revaluation_Eff_Date = *ZERO;

 // WRK.Revaluation Eff. Time = CON.*ZERO
 WRK.Revaluation_Eff_Time = *ZERO;

 //?** Convert the Revaluation Eff. Time to Revaluation Eff. Date
 // WRK.Date (Char-6) USR = CVTVAR(DB1.Revaluation Eff. Time)
 WRK.Date_Char_6_USR = CVTVAR(DB1.Revaluation_Eff_Time);

 // WRK.Date Component Alpha  USR = SUBSTRING(WRK.Date (Char-6) USR,CON.1,CON.2)
 WRK.Date_Component_Alpha_USR = SUBSTRING(WRK.Date_Char_6_USR:1:2);

 // WRK.DD   numeric USR = CVTVAR(WRK.Date Component Alpha  USR)
 WRK.DD_numeric_USR = CVTVAR(WRK.Date_Component_Alpha_USR);

 //?** Convert date for last century
 CASE;

 // IF WRK.DD   numeric USR is LAST YEAR
 IF WRK.DD_numeric_USR >= 50;
 AND WRK.DD_numeric_USR <= 99;

 // WRK.Revaluation Eff. Date = CVTVAR(WRK.Date (Char-6) USR)
 WRK.Revaluation_Eff_Date = CVTVAR(WRK.Date_Char_6_USR);

 ENDIF;

 //?** Convert date for this century - add the 1 to the date
 CASE;

 // IF WRK.DD   numeric USR is THIS YEAR
 IF WRK.DD_numeric_USR >= 00;
 AND WRK.DD_numeric_USR <= 49;

 // WRK.Date (Alpha) USR = CONCAT(CON.1,WRK.Date (Char-6) USR,CON.*ZERO)
 WRK.Date_Alpha_USR = '1' + WRK.Date_Char_6_USR (*ZERO);

 // WRK.Revaluation Eff. Date = CVTVAR(WRK.Date (Alpha) USR)
 WRK.Revaluation_Eff_Date = CVTVAR(WRK.Date_Alpha_USR);

 ENDIF;

 //?** Convert the Revaluation Eff. Date to Revaluation Eff. Time
 // WRK.Revaluation Eff. Time = CVTVAR(DB1.Revaluation Eff. Date)
 WRK.Revaluation_Eff_Time = CVTVAR(DB1.Revaluation_Eff_Date);

 //?** Update the file with the transfered fields
 EXECUTE FUNCTION(CHG PD Item Values     CH) TYPE(CHGOBJ) FILE(PDKZCPP)          AC1414721;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.Warehouse_Code);
 PARAMETER(DB1.Revaluation_Eff_Date);
 PARAMETER(DB1.Revaluation_Eff_Time);
 PARAMETER(DB1.Unit_Cost_Per_Pound);
 PARAMETER(DB1.Pricing_Date_Used);
 PARAMETER(DB1.Revaluation_Cost_Type);
 PARAMETER(DB1.Revaluation_Date);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 PARAMETER(DB1.Record_Status);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*JOB
   PAR.Job_Name = JOB.*JOB;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

  // DB1.Job Name = JOB.*PROGRAM
  DB1.Job_Name = JOB.*PROGRAM;

  // DB1.Revaluation Eff. Date = WRK.Revaluation Eff. Date
  DB1.Revaluation_Eff_Date = WRK.Revaluation_Eff_Date;

  // DB1.Revaluation Eff. Time = WRK.Revaluation Eff. Time
  DB1.Revaluation_Eff_Time = WRK.Revaluation_Eff_Time;

 }

 ENDIF;

}


