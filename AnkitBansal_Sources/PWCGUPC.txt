 /*******************************************************************/
 /*                                                                 */
 /* Program  . . : PWCGUPC                                          */
 /* Programmer . : Brad Baden                                       */
 /* Date . . . . :  5/01/2017                                       */
 /* Description  : This driver program determines what library in   */
 /*                the library list the Producer Std D/A file       */
 /*                exists in, and then calls a program to update    */
 /*                the company number in that file based on the     */
 /*                library name.                                    */
 /*                                                                 */
 /*******************************************************************/
             PGM

             DCL        VAR(&LIBRARY) TYPE(*CHAR) LEN(10)
             DCL        VAR(&RETURN)  TYPE(*CHAR) LEN(7)

             /* Retrive Library that the file exists in             */
             RTVOBJD    OBJ(PKBEREP) OBJTYPE(*FILE) RTNLIB(&LIBRARY)

             /* If library not blank, call program to populate Company# */
             IF         COND(&LIBRARY *NE '          ') THEN(DO)

             CALL       PGM(PWCHXFR) PARM(&RETURN &LIBRARY)
             IF         COND(&RETURN = 'ERROR ') THEN(GOTO +
                          CMDLBL(ERROR))

             /* Remove deleted records from the file                */
             RGZPFM     FILE(*LIBL/PKBEREP)
             MONMSG     MSGID(CPF0000)

             SNDPGMMSG  MSG('Company Number successfully updated in +
                          Producer Std D/A file PKBEREP.')

             GOTO       CMDLBL(ENDIT)
             ENDDO

 ERROR:      SNDPGMMSG  MSG('Unable to determine company number.')

 ENDIT:      ENDPGM
