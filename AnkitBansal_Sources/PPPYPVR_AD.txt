// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPPYPVR
// ?Date: 14.08.2025 Time: 03:41:34
// ?------------------------------------------------------------------------------------------------

//?USER: Load screen

// DTL.Days = CON.30
DTL.Days = 30;

// DTL.Status - Y or N = CND.yes
DTL.Status_Y_or_N = 'Y';

// DTL.Status Flag 2  Y/N = CND.No
DTL.Status_Flag_2_Y_N = 'N';

//?USER: User defined action

// PAR.PRT Night Queue Run Sts = CND.no
PAR.PRT_Night_Queue_Run_Sts = 'N';

// Call program PMT Prt Opt w/PSz SHR  PV.
CALL PROGRAM(PMT Prt Opt w/PSz SHR  PV) ('PDV8PVR');
PARAMETER('Inventory Value Exc Rpt');
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.PRT_Number_of_Copies);
PARAMETER(PAR.PRT_Night_Queue_Run_Sts);
PARAMETER(PAR.PRT_Night_Queue);
PARAMETER('I/C');
PARAMETER(*MISSING);
PARAMETER(1);

CASE;

// IF PGM.*Return code is *User QUIT requested
IF PGM.*Return_code = 'Y2U9999';

// IF *OTHERWISE
IF *OTHERWISE;

// PAR.System Value Numeric = PAR.PRT Number of Copies
PAR.System_Value_Numeric = PAR.PRT_Number_of_Copies;

// WRK.Text USR 5 = DTL.Days
WRK.Text_USR_5 = DTL.Days;

//?R9083 06/26/17 DN-Update date conversion due to Synon version difference.
// LCL.Date Out (8,0) USR = DTL.IVF Week Ending Date
LCL.Date_Out_80_USR = DTL.IVF_Week_Ending_Date;

// WRK.Date (Char-8) USR = CVTVAR(LCL.Date Out (8,0) USR)
WRK.Date_Char_8_USR = CVTVAR(LCL.Date_Out_80_USR);

//?R9083 02/16/17 DN-Added Inv Valuation Grouping & Desc to Parm.
// Call program Prt Inv Value Rpt-Exc UP.
SBMJOB;
CALL PROGRAM(Prt Inv Value Rpt-Exc UP) ('PPPZUPC');
PARAMETER(WRK.Return_Code_Usr);
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.System_Value_Numeric);
PARAMETER(DTL.Status_Y_or_N);
PARAMETER(WRK.Date_Char_8_USR);
PARAMETER(WRK.Text_USR_5);
PARAMETER(DTL.Status_Flag_2_Y_N);
PARAMETER(DTL.IVF_Valuation_Grouping);
PARAMETER(DTL.Inv_Valuation_Group_Desc);
SBMJOBOVR JOB(PRT_EXCEPT);
SBMJOBOVR JOBD(*USRPRF);
SBMJOBEND;

ENDIF;

//?USER: Exit program processing

//?R9083 03/03/17 DN-Set Return Code.
CASE;

// IF DTL.*CMD key is *Exit
IF DTL.*CMD_key = '03';

PGM.*Return_code = 'Y2U9999';

RETURN;

ENDIF;

